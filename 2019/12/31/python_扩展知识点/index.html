<!-- build time:Tue Apr 14 2020 17:15:41 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-Hans"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><script></script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/img/favicon.ico?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="Python,"><link rel="alternate" href="/atom.xml" title="个人博客" type="application/atom+xml"><meta name="description" content="GIL（全局解释器锁）GIL面试题如下描述Python GIL的概念， 以及它对python多线程的影响？编写一个多线程抓取网页的程序，并阐明多线程抓取程序是否可比单线程性能有提升，并解释原因。Guido的声明：http://www.artima.com/forums/flat.jsp?forum=106&amp;amp;thread=214235he language doesn’t require t"><meta name="keywords" content="Python"><meta property="og:type" content="article"><meta property="og:title" content="python_扩展知识点"><meta property="og:url" content="https://yongnights.github.io/2019/12/31/python_扩展知识点/index.html"><meta property="og:site_name" content="个人博客"><meta property="og:description" content="GIL（全局解释器锁）GIL面试题如下描述Python GIL的概念， 以及它对python多线程的影响？编写一个多线程抓取网页的程序，并阐明多线程抓取程序是否可比单线程性能有提升，并解释原因。Guido的声明：http://www.artima.com/forums/flat.jsp?forum=106&amp;amp;thread=214235he language doesn’t require t"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="https://yongnights.github.io/images_copy/001.png"><meta property="og:image" content="https://yongnights.github.io/images_copy/002.png"><meta property="og:image" content="https://yongnights.github.io/images_copy/003.png"><meta property="og:image" content="https://yongnights.github.io/images_copy/004.png"><meta property="og:image" content="https://yongnights.github.io/images_copy/005.png"><meta property="og:image" content="https://yongnights.github.io/images_copy/006.png"><meta property="og:image" content="https://yongnights.github.io/images_copy/007.png"><meta property="og:image" content="https://yongnights.github.io/images_copy/008.png"><meta property="og:image" content="https://yongnights.github.io/images_copy/009.png"><meta property="og:image" content="https://yongnights.github.io/images_copy/010.png"><meta property="og:image" content="https://yongnights.github.io/images_copy/011.png"><meta property="og:image" content="https://yongnights.github.io/images_copy/012.png"><meta property="og:image" content="https://yongnights.github.io/images_copy/013.png"><meta property="og:image" content="https://yongnights.github.io/2019/12/31/python_扩展知识点/images_import/001.png"><meta property="og:image" content="https://yongnights.github.io/2019/12/31/python_扩展知识点/images_import/002.png"><meta property="og:image" content="https://yongnights.github.io/2019/12/31/python_扩展知识点/images_import/003.png"><meta property="og:image" content="https://yongnights.github.io/2019/12/31/python_扩展知识点/images_import/004.png"><meta property="og:image" content="https://yongnights.github.io/2019/12/31/python_扩展知识点/images_import/005.png"><meta property="og:image" content="https://yongnights.github.io/2019/12/31/python_扩展知识点/images_import/006.png"><meta property="og:image" content="https://yongnights.github.io/2019/12/31/python_扩展知识点/images_import/007.png"><meta property="og:image" content="https://yongnights.github.io/images_duixiang/001.png"><meta property="og:image" content="https://yongnights.github.io/images_duixiang/002.png"><meta property="og:image" content="https://yongnights.github.io/images_duixiang/003.png"><meta property="og:image" content="https://yongnights.github.io/images_duixiang/004.png"><meta property="og:image" content="https://yongnights.github.io/images_duixiang/005.png"><meta property="og:image" content="https://yongnights.github.io/images_duixiang/006.png"><meta property="og:updated_time" content="2019-12-31T04:00:48.267Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="python_扩展知识点"><meta name="twitter:description" content="GIL（全局解释器锁）GIL面试题如下描述Python GIL的概念， 以及它对python多线程的影响？编写一个多线程抓取网页的程序，并阐明多线程抓取程序是否可比单线程性能有提升，并解释原因。Guido的声明：http://www.artima.com/forums/flat.jsp?forum=106&amp;amp;thread=214235he language doesn’t require t"><meta name="twitter:image" content="https://yongnights.github.io/images_copy/001.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"5.1.4",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!1,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://yongnights.github.io/2019/12/31/python_扩展知识点/"><title>python_扩展知识点 | 个人博客</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><a href="https://your-url" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">个人博客</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">记录工作中的点点滴滴</p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://yongnights.github.io/2019/12/31/python_扩展知识点/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="永夜初晗凝碧天"><meta itemprop="description" content><meta itemprop="image" content="/img/avatar.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="个人博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">python_扩展知识点</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-12-31T12:00:48+08:00">2019-12-31 </time><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于&#58;</span> <time title="更新于" itemprop="dateModified" datetime="2019-12-31T12:00:48+08:00">2019-12-31 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span> </a></span></span><span class="post-meta-divider">|</span> <span class="page-pv"><i class="fa fa-file-o"></i>本文总阅读量 <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>次</span><div class="post-wordcount"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">13.8k 字 </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">59 分钟</span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="GIL（全局解释器锁）"><a href="#GIL（全局解释器锁）" class="headerlink" title="GIL（全局解释器锁）"></a>GIL（全局解释器锁）</h1><h2 id="GIL面试题如下"><a href="#GIL面试题如下" class="headerlink" title="GIL面试题如下"></a>GIL面试题如下</h2><blockquote><p>描述Python GIL的概念， 以及它对python多线程的影响？编写一个多线程抓取网页的程序，并阐明多线程抓取程序是否可比单线程性能有提升，并解释原因。</p></blockquote><p>Guido的声明：<a href="http://www.artima.com/forums/flat.jsp?forum=106&amp;thread=214235" target="_blank" rel="noopener">http://www.artima.com/forums/flat.jsp?forum=106&amp;thread=214235</a><br>he language doesn’t require the GIL – it’s only the CPython virtual machine that has historically been unable to shed it.</p><h2 id="单线程死循环"><a href="#单线程死循环" class="headerlink" title="单线程死循环"></a>单线程死循环</h2><p>单独执行该文件会占满一个CPU核心数(相当于单进程单线程)，两个窗口执行该文件会占满两个CPU核心数(相当于两进程两线程)<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#-*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 主线程死循环，占满CPU</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">pass</span> <span class="comment"># 占位符，空语句，还是要执行的</span></span><br></pre></td></tr></table></figure><p></p><h2 id="两个线程死循环"><a href="#两个线程死循环" class="headerlink" title="两个线程死循环"></a>两个线程死循环</h2><p>单独执行该文件每个CPU核心会占一半(单进程两线程)<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#-*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"></span><br><span class="line"><span class="comment"># 子线程死循环</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">a</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">t = Thread(target=a)</span><br><span class="line">t.start()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 主线程死循环</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p></p><h2 id="两个进程死循环"><a href="#两个进程死循环" class="headerlink" title="两个进程死循环"></a>两个进程死循环</h2><p>单独执行该文件会占满二个CPU核心数<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#-*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"></span><br><span class="line"><span class="comment"># 子进程死循环</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">a</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    t = Process(target=a)</span><br><span class="line">    t.start()</span><br><span class="line">    <span class="comment"># 主进程死循环</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p></p><p>总结：多线程并不是真正的并行，而是伪并行，也就是并发。原因就是因为线程有GIL全局解释器锁。只有进程才是真正的并行</p><h2 id="参考答案"><a href="#参考答案" class="headerlink" title="参考答案"></a>参考答案</h2><blockquote><ol><li>Python语言和GIL没有半毛钱关系。仅仅是由于历史原因在Cpython虚拟机(C语言解释器)中难以移除GIL。(其他python解释器没有GIL，比如java语言写的jpython解释器)</li><li>GIL：全局解释器锁。每个线程在执行的过程都需要先获取GIL，保证同一时刻只有一个线程可以执行代码。</li><li>线程释放GIL锁的情况： 在IO操作等可能会引起阻塞的system call之前,可以暂时释放GIL,但在执行完毕后,必须重新获取GIL Python 3.x使用计时器（执行时间达到阈值后，当前线程释放GIL）或Python 2.x，tickets计数达到100<blockquote><p>计算密集型：程序没有延时，一直在计算数据；IO密集型：输入输出，读写操作<br>线程和协程适用于IO密集型，计算密集型考虑使用进程。</p></blockquote></li><li>Python使用多进程是可以利用多核的CPU资源的。</li><li>多线程爬取比单线程性能有提升，因为遇到IO阻塞会自动释放GIL锁</li></ol></blockquote><h2 id="使用c语言来解决GIL问题"><a href="#使用c语言来解决GIL问题" class="headerlink" title="使用c语言来解决GIL问题"></a>使用c语言来解决GIL问题</h2><p>子线程使用的是c语言的函数，此时单独执行该文件，会占满两个CPU核心<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载动态库</span></span><br><span class="line"><span class="comment"># 把一个C语言编译成一个动态库文件的命令(linux平台)</span></span><br><span class="line"><span class="comment"># gcc libdead_loop.c -shared -o libdead_loop.so</span></span><br><span class="line">lib = cdll.LoadLibrary(<span class="string">"./libdead_loop.so"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个子线程，让其执行c语言编写的函数(DeadLoop)，此函数是一个死循环</span></span><br><span class="line">t = Thread(target=lib.DeadLoop)</span><br><span class="line">t.start()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 主线程</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p></p><h2 id="如何解决GIL"><a href="#如何解决GIL" class="headerlink" title="如何解决GIL"></a>如何解决GIL</h2><ol><li>换python解释器，不使用Cpython解释器，使用jpython解释器等</li><li>用其他语言来替代线程中的代码，不如上例中的c语言，(胶水语言)</li></ol><a id="more"></a><h1 id="深拷贝、浅拷贝"><a href="#深拷贝、浅拷贝" class="headerlink" title="深拷贝、浅拷贝"></a>深拷贝、浅拷贝</h1><h2 id="1-浅拷贝"><a href="#1-浅拷贝" class="headerlink" title="1. 浅拷贝"></a>1. 浅拷贝</h2><ul><li>浅拷贝是对于一个对象的顶层拷贝<br>通俗的理解是：拷贝了引用，并没有拷贝内容</li></ul><p><img src="/images_copy/001.png" alt></p><p><img src="/images_copy/002.png" alt></p><h2 id="2-深拷贝"><a href="#2-深拷贝" class="headerlink" title="2. 深拷贝"></a>2. 深拷贝</h2><ul><li>深拷贝是对于一个对象所有层次的拷贝(递归)</li></ul><p><img src="/images_copy/003.png" alt></p><h3 id="进一步理解深拷贝"><a href="#进一步理解深拷贝" class="headerlink" title="进一步理解深拷贝"></a>进一步理解深拷贝</h3><p><img src="/images_copy/004.png" alt></p><p><img src="/images_copy/005.png" alt></p><h2 id="3-拷贝的其他方式"><a href="#3-拷贝的其他方式" class="headerlink" title="3. 拷贝的其他方式"></a>3. 拷贝的其他方式</h2><ul><li>分片表达式可以赋值一个序列</li></ul><p><img src="/images_copy/006.png" alt></p><ul><li>字典的copy方法可以拷贝一个字典</li></ul><p><img src="/images_copy/007.png" alt></p><h2 id="4-注意点"><a href="#4-注意点" class="headerlink" title="4. 注意点"></a>4. 注意点</h2><h3 id="浅拷贝对不可变类型和可变类型的copy不同"><a href="#浅拷贝对不可变类型和可变类型的copy不同" class="headerlink" title="浅拷贝对不可变类型和可变类型的copy不同"></a>浅拷贝对不可变类型和可变类型的copy不同</h3><ol><li>copy.copy对于可变类型，会进行浅拷贝</li><li>copy.copy对于不可变类型，不会拷贝，仅仅是指向<br>比如：如果copy.copy拷贝的是元组，那么它不会进行浅拷贝，仅仅是指向<br>原因：因为元组是不可变类型，那么意味着数据一定不能修改，因此用copy.copy的时候它会自动判断，如果是元组它就指向了它</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">88</span>]: a = [<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>]</span><br><span class="line">In [<span class="number">89</span>]: b = copy.copy(a)</span><br><span class="line">In [<span class="number">90</span>]: id(a)</span><br><span class="line">Out[<span class="number">90</span>]: <span class="number">59275144</span></span><br><span class="line">In [<span class="number">91</span>]: id(b)</span><br><span class="line">Out[<span class="number">91</span>]: <span class="number">59525600</span></span><br><span class="line">In [<span class="number">92</span>]: a.append(<span class="number">44</span>)</span><br><span class="line">In [<span class="number">93</span>]: a</span><br><span class="line">Out[<span class="number">93</span>]: [<span class="number">11</span>, <span class="number">22</span>, <span class="number">33</span>, <span class="number">44</span>]</span><br><span class="line">In [<span class="number">94</span>]: b</span><br><span class="line">Out[<span class="number">94</span>]: [<span class="number">11</span>, <span class="number">22</span>, <span class="number">33</span>]</span><br><span class="line"></span><br><span class="line">In [<span class="number">95</span>]: a = (<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>)</span><br><span class="line">In [<span class="number">96</span>]: b = copy.copy(a)</span><br><span class="line">In [<span class="number">97</span>]: id(a)</span><br><span class="line">Out[<span class="number">97</span>]: <span class="number">58890680</span></span><br><span class="line">In [<span class="number">98</span>]: id(b)</span><br><span class="line">Out[<span class="number">98</span>]: <span class="number">58890680</span></span><br></pre></td></tr></table></figure><p><img src="/images_copy/008.png" alt></p><p>如果用copy.copy或者copy.deepcopy对一个全部都是不可变类型的数据进行拷贝，那么他们结果相同的，都是引用指向<br>如果拷贝的是一个拥有可变类型的数据，即使元组是最顶层，copy.deepcopy依然是深拷贝，而copy.copy还是指向。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">In[<span class="number">37</span>]: a = [<span class="number">11</span>,<span class="number">22</span>]</span><br><span class="line">In[<span class="number">38</span>]: b = [<span class="number">33</span>,<span class="number">44</span>]</span><br><span class="line">In[<span class="number">39</span>]: c = (a,b)</span><br><span class="line">In[<span class="number">40</span>]: <span class="keyword">import</span> copy</span><br><span class="line">In[<span class="number">41</span>]: d = copy.copy(c)</span><br><span class="line">In[<span class="number">42</span>]: id(c)</span><br><span class="line">Out[<span class="number">42</span>]: <span class="number">86387080</span></span><br><span class="line">In[<span class="number">43</span>]: id(d)</span><br><span class="line">Out[<span class="number">43</span>]: <span class="number">86387080</span></span><br><span class="line">In[<span class="number">44</span>]: e = copy.deepcopy(c)</span><br><span class="line">In[<span class="number">45</span>]: id(e)</span><br><span class="line">Out[<span class="number">45</span>]: <span class="number">87301192</span></span><br><span class="line">In[<span class="number">46</span>]: c</span><br><span class="line">Out[<span class="number">46</span>]: ([<span class="number">11</span>, <span class="number">22</span>], [<span class="number">33</span>, <span class="number">44</span>])</span><br><span class="line">In[<span class="number">47</span>]: e</span><br><span class="line">Out[<span class="number">47</span>]: ([<span class="number">11</span>, <span class="number">22</span>], [<span class="number">33</span>, <span class="number">44</span>])</span><br><span class="line">In[<span class="number">48</span>]: a.append(<span class="number">55</span>)</span><br><span class="line">In[<span class="number">49</span>]: c</span><br><span class="line">Out[<span class="number">49</span>]: ([<span class="number">11</span>, <span class="number">22</span>, <span class="number">55</span>], [<span class="number">33</span>, <span class="number">44</span>])</span><br><span class="line">In[<span class="number">50</span>]: e</span><br><span class="line">Out[<span class="number">50</span>]: ([<span class="number">11</span>, <span class="number">22</span>], [<span class="number">33</span>, <span class="number">44</span>])</span><br></pre></td></tr></table></figure><h3 id="copy-copy和copy-deepcopy的区别"><a href="#copy-copy和copy-deepcopy的区别" class="headerlink" title="copy.copy和copy.deepcopy的区别"></a>copy.copy和copy.deepcopy的区别</h3><blockquote><p>copy.copy<br><img src="/images_copy/009.png" alt></p></blockquote><p><img src="/images_copy/010.png" alt></p><blockquote><p>copy.deepcopy<br><img src="/images_copy/011.png" alt></p></blockquote><p><img src="/images_copy/012.png" alt></p><p><img src="/images_copy/013.png" alt></p><h1 id="私有化"><a href="#私有化" class="headerlink" title="私有化"></a>私有化</h1><ul><li>xx: 公有变量</li><li><code>_x</code>: 单前置下划线,私有化属性或方法，from module import * 禁止导入,类对象和子类可以访问</li><li><code>__xx</code>：双前置下划线,避免与子类中的属性命名冲突，无法在外部直接访问(名字重整所以访问不到)</li><li><code>__xx__</code>:双前后下划线,用户名字空间的魔法对象或属性。例如:<code>__init__</code> , __ 不要自己发明这样的名字</li><li><code>xx_</code>:单后置下划线,用于避免与Python关键词的冲突</li></ul><p>通过name mangling（名字重整(目的就是以防子类意外重写基类的方法或者属性)如：_Classobject）机制就可以访问private了。(在 名称 前面加上 _类名 =&gt; _类名名称)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, taste)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self._age = age </span><br><span class="line">        self.__taste = taste</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showperson</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(self.name)</span><br><span class="line">        print(self._age)</span><br><span class="line">        print(self.__taste)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">dowork</span><span class="params">(self)</span>:</span></span><br><span class="line">        self._work()</span><br><span class="line">        self.__away()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_work</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'my _work'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__away</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'my __away'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(Person)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">construction</span><span class="params">(self, name, age, taste)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self._age = age </span><br><span class="line">        self.__taste = taste</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showstudent</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(self.name)</span><br><span class="line">        print(self._age)</span><br><span class="line">        print(self.__taste)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">testbug</span><span class="params">()</span>:</span></span><br><span class="line">        _Bug.showbug()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 模块内可以访问，当from  cur_module import *时，不导入</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_Bug</span><span class="params">(object)</span>:</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showbug</span><span class="params">()</span>:</span></span><br><span class="line">        print(<span class="string">"showbug"</span>)</span><br><span class="line"></span><br><span class="line">s1 = Student(<span class="string">'jack'</span>, <span class="number">25</span>, <span class="string">'football'</span>)</span><br><span class="line">s1.showperson()</span><br><span class="line">print(<span class="string">'*'</span>*<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 无法访问__taste,导致报错</span></span><br><span class="line"><span class="comment"># s1.showstudent() </span></span><br><span class="line">s1.construction(<span class="string">'rose'</span>, <span class="number">30</span>, <span class="string">'basketball'</span>)</span><br><span class="line">s1.showperson()</span><br><span class="line">print(<span class="string">'*'</span>*<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">s1.showstudent()</span><br><span class="line">print(<span class="string">'*'</span>*<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">Student.testbug()总结</span><br></pre></td></tr></table></figure><ul><li><code>_名</code>的变量、函数、类在使用<code>from xxx import *</code>时都不会被导入，类对象和子类可以访问</li><li>父类中属性名为<code>__名字</code>的，子类不继承，子类不能访问，子类可以通过父类中的其他方法间接访问</li><li>如果在子类中向<code>__名字</code>赋值，那么会在子类中定义一个与父类相同名字的属性</li></ul><h1 id="import导入模块"><a href="#import导入模块" class="headerlink" title="import导入模块"></a>import导入模块</h1><h2 id="1-import-搜索路径"><a href="#1-import-搜索路径" class="headerlink" title="1. import 搜索路径"></a>1. import 搜索路径</h2><p><img src="images_import/001.png" alt></p><h3 id="路径搜索"><a href="#路径搜索" class="headerlink" title="路径搜索"></a>路径搜索</h3><ul><li>从上面列出的目录里依次查找要导入的模块文件</li><li>开头的第一个‘’ 表示当前路径</li><li>列表中的路径的先后顺序代表了python解释器在搜索模块时的先后顺序</li></ul><h3 id="程序执行时添加新的模块路径"><a href="#程序执行时添加新的模块路径" class="headerlink" title="程序执行时添加新的模块路径"></a>程序执行时添加新的模块路径</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">sys.path.append(<span class="string">'/home/itcast/xxx'</span>)</span><br><span class="line">sys.path.insert(<span class="number">0</span>, <span class="string">'/home/itcast/xxx'</span>)  <span class="comment"># 可以确保先搜索这个路径</span></span><br><span class="line">In [<span class="number">37</span>]: sys.path.insert(<span class="number">0</span>,<span class="string">"/home/python/xxxx"</span>)</span><br><span class="line">In [<span class="number">38</span>]: sys.path</span><br><span class="line">Out[<span class="number">38</span>]: </span><br><span class="line">[<span class="string">'/home/python/xxxx'</span>,</span><br><span class="line"> <span class="string">''</span>,</span><br><span class="line"> <span class="string">'/usr/bin'</span>,</span><br><span class="line"> <span class="string">'/usr/lib/python35.zip'</span>,</span><br><span class="line"> <span class="string">'/usr/lib/python3.5'</span>,</span><br><span class="line"> <span class="string">'/usr/lib/python3.5/plat-x86_64-linux-gnu'</span>,</span><br><span class="line"> <span class="string">'/usr/lib/python3.5/lib-dynload'</span>,</span><br><span class="line"> <span class="string">'/usr/local/lib/python3.5/dist-packages'</span>,</span><br><span class="line"> <span class="string">'/usr/lib/python3/dist-packages'</span>,</span><br><span class="line"> <span class="string">'/usr/lib/python3/dist-packages/IPython/extensions'</span>,</span><br><span class="line"> <span class="string">'/home/python/.ipython'</span>]</span><br></pre></td></tr></table></figure><h2 id="2-重新导入模块"><a href="#2-重新导入模块" class="headerlink" title="2. 重新导入模块"></a>2. 重新导入模块</h2><p>模块被导入后，<code>import module</code>不能重新导入模块，重新导入需用<code>reload</code></p><p><img src="images_import/002.png" alt></p><p><img src="images_import/003.png" alt></p><p><img src="images_import/004.png" alt></p><p><img src="images_import/005.png" alt></p><h2 id="3-多模块开发时的注意点"><a href="#3-多模块开发时的注意点" class="headerlink" title="3. 多模块开发时的注意点"></a>3. 多模块开发时的注意点</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">recv_msg.py模块</span><br><span class="line">from common import RECV_DATA_LIST</span><br><span class="line"># from common import HANDLE_FLAG</span><br><span class="line">import common</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def recv_msg():</span><br><span class="line">    &quot;&quot;&quot;模拟接收到数据，然后添加到common模块中的列表中&quot;&quot;&quot;</span><br><span class="line">    print(&quot;---&gt;recv_msg&quot;)</span><br><span class="line">    for i in range(5):</span><br><span class="line">        RECV_DATA_LIST.append(i)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def test_recv_data():</span><br><span class="line">    &quot;&quot;&quot;测试接收到的数据&quot;&quot;&quot;</span><br><span class="line">    print(&quot;---&gt;test_recv_data&quot;)</span><br><span class="line">    print(RECV_DATA_LIST)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def recv_msg_next():</span><br><span class="line">    &quot;&quot;&quot;已经处理完成后，再接收另外的其他数据&quot;&quot;&quot;</span><br><span class="line">    print(&quot;---&gt;recv_msg_next&quot;)</span><br><span class="line">    # if HANDLE_FLAG:</span><br><span class="line">    if common.HANDLE_FLAG:</span><br><span class="line">        print(&quot;------发现之前的数据已经处理完成，这里进行接收其他的数据(模拟过程...)----&quot;)</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;------发现之前的数据未处理完，等待中....------&quot;)</span><br><span class="line">handle_msg.py模块</span><br><span class="line">from common import RECV_DATA_LIST</span><br><span class="line"># from common import HANDLE_FLAG</span><br><span class="line">import common</span><br><span class="line"></span><br><span class="line">def handle_data():</span><br><span class="line">    &quot;&quot;&quot;模拟处理recv_msg模块接收的数据&quot;&quot;&quot;</span><br><span class="line">    print(&quot;---&gt;handle_data&quot;)</span><br><span class="line">    for i in RECV_DATA_LIST:</span><br><span class="line">        print(i)</span><br><span class="line"></span><br><span class="line">    # 既然处理完成了，那么将变量HANDLE_FLAG设置为True，意味着处理完成</span><br><span class="line">    # global HANDLE_FLAG</span><br><span class="line">    # HANDLE_FLAG = True</span><br><span class="line">    common.HANDLE_FLAG = True</span><br><span class="line"></span><br><span class="line">def test_handle_data():</span><br><span class="line">    &quot;&quot;&quot;测试处理是否完成，变量是否设置为True&quot;&quot;&quot;</span><br><span class="line">    print(&quot;---&gt;test_handle_data&quot;)</span><br><span class="line">    # if HANDLE_FLAG:</span><br><span class="line">    if common.HANDLE_FLAG:</span><br><span class="line">        print(&quot;=====已经处理完成====&quot;)</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;=====未处理完成====&quot;)</span><br><span class="line">main.py模块</span><br><span class="line">from recv_msg import *</span><br><span class="line">from handle_msg import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    # 1. 接收数据</span><br><span class="line">    recv_msg()</span><br><span class="line">    # 2. 测试是否接收完毕</span><br><span class="line">    test_recv_data()</span><br><span class="line">    # 3. 判断如果处理完成，则接收其它数据</span><br><span class="line">    recv_msg_next()</span><br><span class="line">    # 4. 处理数据</span><br><span class="line">    handle_data()</span><br><span class="line">    # 5. 测试是否处理完毕</span><br><span class="line">    test_handle_data()</span><br><span class="line">    # 6. 判断如果处理完成，则接收其它数据</span><br><span class="line">    recv_msg_next()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p><img src="images_import/006.png" alt></p><p><img src="images_import/007.png" alt></p><h1 id="再议-封装、继承、多态"><a href="#再议-封装、继承、多态" class="headerlink" title="再议 封装、继承、多态"></a>再议 封装、继承、多态</h1><p>封装、继承、多态 是面向对象的3大特性</p><h2 id="为啥要封装"><a href="#为啥要封装" class="headerlink" title="为啥要封装"></a>为啥要封装</h2><p><img src="/images_duixiang/001.png" alt></p><p><img src="/images_duixiang/002.png" alt></p><h2 id="好处"><a href="#好处" class="headerlink" title="好处"></a>好处</h2><blockquote><ol><li>在使用面向过程编程时，当需要对数据处理时，需要考虑用哪个模板中哪个函数来进行操作，但是当用面向对象编程时，因为已经将数据存储到了这个独立的空间中，这个独立的空间（即对象）中通过一个特殊的变量（<strong>class</strong>）能够获取到类（模板），而且这个类中的方法是有一定数量的，与此类无关的将不会出现在本类中，因此需要对数据处理时，可以很快速的定位到需要的方法是谁 这样更方便</li><li>全局变量是只能有1份的，多很多个函数需要多个备份时，往往需要利用其它的变量来进行储存；而通过封装 会将用来存储数据的这个变量 变为了对象中的一个“全局”变量，只要对象不一样那么这个变量就可以再有1份，所以这样更方便</li><li>代码划分更清晰</li></ol></blockquote><p>面向过程</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">全局变量<span class="number">1</span></span><br><span class="line">全局变量<span class="number">2</span></span><br><span class="line">全局变量<span class="number">3</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> 函数1<span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> 函数2<span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> 函数3<span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> 函数4<span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> 函数5<span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>面向对象</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> 类<span class="params">(object)</span>:</span></span><br><span class="line">    属性<span class="number">1</span></span><br><span class="line">    属性<span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> 方法1<span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> 方法2<span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> 类2<span class="params">(object)</span>:</span></span><br><span class="line">    属性<span class="number">3</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> 方法3<span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> 方法4<span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> 方法5<span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><h2 id="为啥要继承"><a href="#为啥要继承" class="headerlink" title="为啥要继承"></a>为啥要继承</h2><p><img src="/images_duixiang/003.png" alt></p><h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><blockquote><ol><li>能够提升代码的重用率，即开发一个类，可以在多个子功能中直接使用</li><li>继承能够有效的进行代码的管理，当某个类有问题只要修改这个类就行，而其继承这个类的子类往往不需要就修改</li></ol></blockquote><h2 id="怎样理解多态"><a href="#怎样理解多态" class="headerlink" title="怎样理解多态"></a>怎样理解多态</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MiniOS</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">"""MiniOS 操作系统类 """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.apps = []  <span class="comment"># 安装的应用程序名称列表</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"%s 安装的软件列表为 %s"</span> % (self.name, str(self.apps))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">install_app</span><span class="params">(self, app)</span>:</span></span><br><span class="line">        <span class="comment"># 判断是否已经安装了软件</span></span><br><span class="line">        <span class="keyword">if</span> app.name <span class="keyword">in</span> self.apps:</span><br><span class="line">            print(<span class="string">"已经安装了 %s，无需再次安装"</span> % app.name)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            app.install()</span><br><span class="line">            self.apps.append(app.name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, version, desc)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.version = version</span><br><span class="line">        self.desc = desc</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"%s 的当前版本是 %s - %s"</span> % (self.name, self.version, self.desc)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">install</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"将 %s [%s] 的执行程序复制到程序目录..."</span> % (self.name, self.version))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PyCharm</span><span class="params">(App)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Chrome</span><span class="params">(App)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">install</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"正在解压缩安装程序..."</span>)</span><br><span class="line">        super().install()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">linux = MiniOS(<span class="string">"Linux"</span>)</span><br><span class="line">print(linux)</span><br><span class="line"></span><br><span class="line">pycharm = PyCharm(<span class="string">"PyCharm"</span>, <span class="string">"1.0"</span>, <span class="string">"python 开发的 IDE 环境"</span>)</span><br><span class="line">chrome = Chrome(<span class="string">"Chrome"</span>, <span class="string">"2.0"</span>, <span class="string">"谷歌浏览器"</span>)</span><br><span class="line"></span><br><span class="line">linux.install_app(pycharm)</span><br><span class="line">linux.install_app(chrome)</span><br><span class="line">linux.install_app(chrome)</span><br><span class="line"></span><br><span class="line">print(linux)</span><br></pre></td></tr></table></figure><p>运行结果<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Linux 安装的软件列表为 []</span><br><span class="line">将 PyCharm [1.0] 的执行程序复制到程序目录...</span><br><span class="line">正在解压缩安装程序...</span><br><span class="line">将 Chrome [2.0] 的执行程序复制到程序目录...</span><br><span class="line">已经安装了 Chrome，无需再次安装</span><br><span class="line">Linux 安装的软件列表为 [&apos;PyCharm&apos;, &apos;Chrome&apos;]</span><br></pre></td></tr></table></figure><p></p><h1 id="多继承以及MRO顺序"><a href="#多继承以及MRO顺序" class="headerlink" title="多继承以及MRO顺序"></a>多继承以及MRO顺序</h1><h2 id="1-单独调用父类的方法"><a href="#1-单独调用父类的方法" class="headerlink" title="1. 单独调用父类的方法"></a>1. 单独调用父类的方法</h2><p>父类被调用多次<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">"******多继承使用类名.__init__ 发生的状态******"</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></span><br><span class="line">        print(<span class="string">'parent的init开始被调用'</span>)</span><br><span class="line">        self.name = name</span><br><span class="line">        print(<span class="string">'parent的init结束被调用'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Son1</span><span class="params">(Parent)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age)</span>:</span></span><br><span class="line">        print(<span class="string">'Son1的init开始被调用'</span>)</span><br><span class="line">        self.age = age</span><br><span class="line">        Parent.__init__(self, name)</span><br><span class="line">        print(<span class="string">'Son1的init结束被调用'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Son2</span><span class="params">(Parent)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, gender)</span>:</span></span><br><span class="line">        print(<span class="string">'Son2的init开始被调用'</span>)</span><br><span class="line">        self.gender = gender</span><br><span class="line">        Parent.__init__(self, name)</span><br><span class="line">        print(<span class="string">'Son2的init结束被调用'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Grandson</span><span class="params">(Son1, Son2)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, gender)</span>:</span></span><br><span class="line">        print(<span class="string">'Grandson的init开始被调用'</span>)</span><br><span class="line">        Son1.__init__(self, name, age)  <span class="comment"># 单独调用父类的初始化方法</span></span><br><span class="line">        Son2.__init__(self, name, gender)</span><br><span class="line">        print(<span class="string">'Grandson的init结束被调用'</span>)</span><br><span class="line"></span><br><span class="line">gs = Grandson(<span class="string">'grandson'</span>, <span class="number">12</span>, <span class="string">'男'</span>)</span><br><span class="line">print(<span class="string">'姓名：'</span>, gs.name)</span><br><span class="line">print(<span class="string">'年龄：'</span>, gs.age)</span><br><span class="line">print(<span class="string">'性别：'</span>, gs.gender)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"******多继承使用类名.__init__ 发生的状态******\n\n"</span>)</span><br></pre></td></tr></table></figure><p></p><p>运行结果:<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">******多继承使用类名.__init__ 发生的状态******</span><br><span class="line">Grandson的init开始被调用</span><br><span class="line">Son1的init开始被调用</span><br><span class="line">parent的init开始被调用</span><br><span class="line">parent的init结束被调用</span><br><span class="line">Son1的init结束被调用</span><br><span class="line">Son2的init开始被调用</span><br><span class="line">parent的init开始被调用</span><br><span class="line">parent的init结束被调用</span><br><span class="line">Son2的init结束被调用</span><br><span class="line">Grandson的init结束被调用</span><br><span class="line">姓名： grandson</span><br><span class="line">年龄： 12</span><br><span class="line">性别： 男</span><br><span class="line">******多继承使用类名.__init__ 发生的状态******</span><br></pre></td></tr></table></figure><p></p><h2 id="2-多继承中super调用有所父类的被重写的方法"><a href="#2-多继承中super调用有所父类的被重写的方法" class="headerlink" title="2. 多继承中super调用有所父类的被重写的方法"></a>2. 多继承中super调用有所父类的被重写的方法</h2><p>使用super方法父类被调用一次<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">"******多继承使用super().__init__ 发生的状态******"</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, *args, **kwargs)</span>:</span>  <span class="comment"># 为避免多继承报错，使用不定长参数，接受参数</span></span><br><span class="line">        print(<span class="string">'parent的init开始被调用'</span>)</span><br><span class="line">        self.name = name</span><br><span class="line">        print(<span class="string">'parent的init结束被调用'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Son1</span><span class="params">(Parent)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, *args, **kwargs)</span>:</span>  <span class="comment"># 为避免多继承报错，使用不定长参数，接受参数</span></span><br><span class="line">        print(<span class="string">'Son1的init开始被调用'</span>)</span><br><span class="line">        self.age = age</span><br><span class="line">        super().__init__(name, *args, **kwargs)  <span class="comment"># 为避免多继承报错，使用不定长参数，接受参数</span></span><br><span class="line">        print(<span class="string">'Son1的init结束被调用'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Son2</span><span class="params">(Parent)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, gender, *args, **kwargs)</span>:</span>  <span class="comment"># 为避免多继承报错，使用不定长参数，接受参数</span></span><br><span class="line">        print(<span class="string">'Son2的init开始被调用'</span>)</span><br><span class="line">        self.gender = gender</span><br><span class="line">        super().__init__(name, *args, **kwargs)  <span class="comment"># 为避免多继承报错，使用不定长参数，接受参数</span></span><br><span class="line">        print(<span class="string">'Son2的init结束被调用'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Grandson</span><span class="params">(Son1, Son2)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, gender)</span>:</span></span><br><span class="line">        print(<span class="string">'Grandson的init开始被调用'</span>)</span><br><span class="line">        <span class="comment"># 多继承时，相对于使用类名.__init__方法，要把每个父类全部写一遍</span></span><br><span class="line">        <span class="comment"># 而super只用一句话，执行了全部父类的方法，这也是为何多继承需要全部传参的一个原因</span></span><br><span class="line">        <span class="comment"># super(Grandson, self).__init__(name, age, gender)</span></span><br><span class="line">        super().__init__(name, age, gender)</span><br><span class="line">        print(<span class="string">'Grandson的init结束被调用'</span>)</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string"># 以下两种写法结果是一样的</span></span><br><span class="line"><span class="string">super(Grandson, self).__init__(name, age, gender) # 调用指定类的下一个类</span></span><br><span class="line"><span class="string">super().__init__(name, age, gender) # 不指定类的话则默认是当前使用的类的下一个类</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 指定类的调用</span></span><br><span class="line"><span class="string">super(Son2, self).__init__(name, age, gender) # 指定Son1类的下一个类调用，也就是Son2类</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">        </span><br><span class="line">print(Grandson.__mro__) <span class="comment"># 输出一个元组，父类调用的顺序 # python解释器的C3算法计算出来的结果</span></span><br><span class="line"></span><br><span class="line">gs = Grandson(<span class="string">'grandson'</span>, <span class="number">12</span>, <span class="string">'男'</span>)</span><br><span class="line">print(<span class="string">'姓名：'</span>, gs.name)</span><br><span class="line">print(<span class="string">'年龄：'</span>, gs.age)</span><br><span class="line">print(<span class="string">'性别：'</span>, gs.gender)</span><br><span class="line">print(<span class="string">"******多继承使用super().__init__ 发生的状态******\n\n"</span>)</span><br></pre></td></tr></table></figure><p></p><p>运行结果：<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">******多继承使用super().__init__ 发生的状态******</span><br><span class="line">(&lt;class '__main__.Grandson'&gt;, &lt;class '__main__.Son1'&gt;, &lt;class '__main__.Son2'&gt;, &lt;class '__main__.Parent'&gt;, &lt;class 'object'&gt;)</span><br><span class="line">Grandson的init开始被调用</span><br><span class="line">Son1的init开始被调用</span><br><span class="line">Son2的init开始被调用</span><br><span class="line">parent的init开始被调用</span><br><span class="line">parent的init结束被调用</span><br><span class="line">Son2的init结束被调用</span><br><span class="line">Son1的init结束被调用</span><br><span class="line">Grandson的init结束被调用</span><br><span class="line">姓名： grandson</span><br><span class="line">年龄： <span class="number">12</span></span><br><span class="line">性别： 男</span><br><span class="line">******多继承使用super().__init__ 发生的状态******</span><br></pre></td></tr></table></figure><p></p><p>注意：</p><blockquote><ol><li>以上2个代码执行的结果不同</li><li>如果2个子类中都继承了父类，当在子类中通过父类名调用时，parent被执行了2次</li><li>如果2个子类中都继承了父类，当在子类中通过super调用时，parent被执行了1次</li></ol></blockquote><h2 id="3-单继承中super"><a href="#3-单继承中super" class="headerlink" title="3. 单继承中super"></a>3. 单继承中super</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">"******单继承使用super().__init__ 发生的状态******"</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></span><br><span class="line">        print(<span class="string">'parent的init开始被调用'</span>)</span><br><span class="line">        self.name = name</span><br><span class="line">        print(<span class="string">'parent的init结束被调用'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Son1</span><span class="params">(Parent)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age)</span>:</span></span><br><span class="line">        print(<span class="string">'Son1的init开始被调用'</span>)</span><br><span class="line">        self.age = age</span><br><span class="line">        super().__init__(name)  <span class="comment"># 单继承不能提供全部参数</span></span><br><span class="line">        print(<span class="string">'Son1的init结束被调用'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Grandson</span><span class="params">(Son1)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, gender)</span>:</span></span><br><span class="line">        print(<span class="string">'Grandson的init开始被调用'</span>)</span><br><span class="line">        super().__init__(name, age)  <span class="comment"># 单继承不能提供全部参数</span></span><br><span class="line">        print(<span class="string">'Grandson的init结束被调用'</span>)</span><br><span class="line"></span><br><span class="line">print(Grandson.__mro__)</span><br><span class="line"></span><br><span class="line">gs = Grandson(<span class="string">'grandson'</span>, <span class="number">12</span>, <span class="string">'男'</span>)</span><br><span class="line">print(<span class="string">'姓名：'</span>, gs.name)</span><br><span class="line">print(<span class="string">'年龄：'</span>, gs.age)</span><br><span class="line"><span class="comment">#print('性别：', gs.gender)</span></span><br><span class="line">print(<span class="string">"******单继承使用super().__init__ 发生的状态******\n\n"</span>)</span><br></pre></td></tr></table></figure><p>运行结果：<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">******单继承使用super().__init__ 发生的状态******</span><br><span class="line">(&lt;class '__main__.Grandson'&gt;, &lt;class '__main__.Son1'&gt;, &lt;class '__main__.Parent'&gt;, &lt;class 'object'&gt;)</span><br><span class="line">Grandson的init开始被调用</span><br><span class="line">Son1的init开始被调用</span><br><span class="line">parent的init开始被调用</span><br><span class="line">parent的init结束被调用</span><br><span class="line">Son1的init结束被调用</span><br><span class="line">Grandson的init结束被调用</span><br><span class="line">姓名： grandson</span><br><span class="line">年龄： <span class="number">12</span></span><br><span class="line">******单继承使用super().__init__ 发生的状态******</span><br></pre></td></tr></table></figure><p></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ol><li>super().<strong>init</strong>相对于类名.<strong>init</strong>，在单继承上用法基本无差</li><li>但在多继承上有区别，super方法能保证每个父类的方法只会执行一次，而使用类名的方法会导致方法被执行多次，具体看前面的输出结果</li><li>多继承时，使用super方法，对父类的传参数，应该是由于python中super的算法导致的原因，必须把参数全部传递，否则会报错</li><li>单继承时，使用super方法，则不能全部传递，只能传父类方法所需的参数，否则会报错</li><li>多继承时，相对于使用类名.<strong>init</strong>方法，要把每个父类全部写一遍, 而使用super方法，只需写一句话便执行了全部父类的方法，这也是为何多继承需要全部传参的一个原因</li></ol><h2 id="小试牛刀-以下为面试题"><a href="#小试牛刀-以下为面试题" class="headerlink" title="小试牛刀(以下为面试题)"></a>小试牛刀(以下为面试题)</h2><blockquote><p>以下的代码的输出将是什么? 说出你的答案并解释。<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span><span class="params">(object)</span>:</span></span><br><span class="line">    x = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child1</span><span class="params">(Parent)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child2</span><span class="params">(Parent)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">print(Parent.x, Child1.x, Child2.x)</span><br><span class="line">Child1.x = <span class="number">2</span></span><br><span class="line">print(Parent.x, Child1.x, Child2.x)</span><br><span class="line">Parent.x = <span class="number">3</span></span><br><span class="line">print(Parent.x, Child1.x, Child2.x)</span><br></pre></td></tr></table></figure><p></p></blockquote><p>答案, 以上代码的输出是：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1 1 1</span><br><span class="line">1 2 1</span><br><span class="line">3 2 3</span><br></pre></td></tr></table></figure><p></p><p>使你困惑或是惊奇的是关于最后一行的输出是 3 2 3 而不是 3 2 1。为什么改变了 Parent.x 的值还会改变 Child2.x 的值，但是同时 Child1.x 值却没有改变？</p><p>这个答案的关键是，在 Python 中，类变量在内部是作为字典处理的。如果一个变量的名字没有在当前类的字典中发现，将搜索祖先类（比如父类）直到被引用的变量名被找到（如果这个被引用的变量名既没有在自己所在的类又没有在祖先类中找到，会引发一个 AttributeError 异常 ）。</p><p>因此，在父类中设置 x = 1 会使得类变量 x 在引用该类和其任何子类中的值为 1。这就是因为第一个 print 语句的输出是 1 1 1。</p><p>随后，如果任何它的子类重写了该值（例如，我们执行语句 Child1.x = 2），然后，该值仅仅在子类中被改变。这就是为什么第二个 print 语句的输出是 1 2 1。</p><p>最后，如果该值在父类中被改变（例如，我们执行语句 Parent.x = 3），这个改变会影响到任何未重写该值的子类当中的值（在这个示例中被影响的子类是 Child2）。这就是为什么第三个 print 输出是 3 2 3。</p><p>自己的想法，按顺序解析<br>print(Parent.x, Child1.x, Child2.x)，其中Parent.x是调用Parent类中的x属性，输出结果是1；Child1.x是输出Child1类中的x属性，本类没有的话则到父类中查找，父类Parent中有，则输出结果是1；Child2.x同理。<br>Child1.x = 2相当于给Child1类添加一个类属性。<br>print(Parent.x, Child1.x, Child2.x)，其中Parent.x是调用Parent类中的x属性，输出结果是1；Child1.x是输出Child1类中的x属性，本类中有这个属性则直接输出，不用到父类中查找，输出的结果是2；Child2.x还是从父类中查找，输出结果是1。<br>Parent.x = 3相当于修改父类Parent中x类属性的值。<br>print(Parent.x, Child1.x, Child2.x)，其中Parent.x是调用Parent类中的x属性，输出结果是3；Child1.x是输出Child1类中的x属性，本类中有这个属性则直接输出，不用到父类中查找，输出的结果是2；Child2.x还是从父类中查找，输出结果是3。</p><h1 id="再论静态方法和类方法"><a href="#再论静态方法和类方法" class="headerlink" title="再论静态方法和类方法"></a>再论静态方法和类方法</h1><h2 id="1-类属性、实例属性"><a href="#1-类属性、实例属性" class="headerlink" title="1. 类属性、实例属性"></a>1. 类属性、实例属性</h2><p>它们在定义和使用中有所区别，而最本质的区别是内存中保存的位置不同，</p><ul><li>实例属性属于对象</li><li>类属性属于类</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Province</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="comment"># 类属性</span></span><br><span class="line">    country = <span class="string">'中国'</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></span><br><span class="line">        <span class="comment"># 实例属性</span></span><br><span class="line">        self.name = name</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个实例对象</span></span><br><span class="line">obj = Province(<span class="string">'山东省'</span>)</span><br><span class="line"><span class="comment"># 直接访问实例属性</span></span><br><span class="line">print(obj.name)</span><br><span class="line"><span class="comment"># 直接访问类属性</span></span><br><span class="line">Province.country</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过实例对象访问类属性 obj.__class__.country</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Province('山东省')做如下两件事情：</span></span><br><span class="line"><span class="comment"># 1. 调用__new__方法，创建对象，通俗点说是创建一个内存空间</span></span><br><span class="line"><span class="comment"># 2. 调用__init__方法，对刚才申请的空间进行初始化</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># __class__指向类对象</span></span><br></pre></td></tr></table></figure><p>由上述代码可以看出【实例属性需要通过对象来访问】【类属性通过类访问】，在使用上可以看出实例属性和类属性的归属是不同的。</p><p>其在内容的存储方式类似如下图：<br><img src="/images_duixiang/004.png" alt></p><p>由上图看出：</p><ul><li>类属性在内存中只保存一份</li><li>实例属性在每个对象中都要保存一份</li></ul><p>应用场景：</p><ul><li>通过类创建实例对象时，如果每个对象需要具有相同名字的属性，那么就使用类属性，用一份即可</li></ul><h2 id="2-实例方法、静态方法和类方法"><a href="#2-实例方法、静态方法和类方法" class="headerlink" title="2. 实例方法、静态方法和类方法"></a>2. 实例方法、静态方法和类方法</h2><p>方法包括：实例方法、静态方法和类方法，三种方法在内存中都归属于类，区别在于调用方式不同。</p><ul><li>实例方法：由对象调用；至少一个self参数；执行实例方法时，自动将调用该方法的对象赋值给self；</li><li>类方法：由类调用； 至少一个cls参数；执行类方法时，自动将调用该方法的类赋值给cls；</li><li>静态方法：由类调用；无默认参数；</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">ord_func</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">""" 定义实例方法，至少有一个self参数，传递的是实例对象的引用 """</span></span><br><span class="line">        <span class="comment"># print(self.name)</span></span><br><span class="line">        <span class="comment"># 实例方法可以修改实例对象的属性</span></span><br><span class="line">        print(<span class="string">'实例方法'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">class_func</span><span class="params">(cls)</span>:</span></span><br><span class="line">        <span class="string">""" 定义类方法，至少有一个cls参数 ，传递的是类对象的引用"""</span></span><br><span class="line">        <span class="comment"># 类方法可以修改类对象的属性</span></span><br><span class="line">        print(<span class="string">'类方法'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">static_func</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="string">""" 定义静态方法 ，无默认参数"""</span></span><br><span class="line">        print(<span class="string">'静态方法'</span>)</span><br><span class="line"></span><br><span class="line">f = Foo(<span class="string">"中国"</span>)</span><br><span class="line"><span class="comment"># 调用实例方法</span></span><br><span class="line">f.ord_func()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用类方法</span></span><br><span class="line">Foo.class_func()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用静态方法</span></span><br><span class="line">Foo.static_func()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过实例对象调用类方法</span></span><br><span class="line">f.__class__.class_func()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过实例对象调用静态方法</span></span><br><span class="line">f.__class__.static_func()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 总结</span></span><br><span class="line"><span class="comment"># 1.实例对象可以调用类方法，实例方法和静态方法</span></span><br><span class="line"><span class="comment"># 2.类对象可以调用类方法和静态方法，不能调用实例方法</span></span><br></pre></td></tr></table></figure><p><img src="/images_duixiang/005.png" alt></p><p>对比</p><ul><li>相同点：对于所有的方法而言，均属于类，所以在内存中也只保存一份</li><li>不同点：方法调用者不同、调用方法时自动传入的参数不同</li></ul><h1 id="property属性"><a href="#property属性" class="headerlink" title="property属性"></a>property属性</h1><h2 id="1-什么是property属性"><a href="#1-什么是property属性" class="headerlink" title="1. 什么是property属性"></a>1. 什么是property属性</h2><p>一种用起来像是使用的实例属性一样的特殊属性，可以对应于某个方法</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ######## 定义 ########</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 定义property属性，把实例方法装饰成一个实例属性</span></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">prop</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""返回一个值"""</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ######## 调用 ########</span></span><br><span class="line">foo_obj = Foo()</span><br><span class="line">foo_obj.func()  <span class="comment"># 调用实例方法</span></span><br><span class="line">foo_obj.prop  <span class="comment"># 调用property属性</span></span><br></pre></td></tr></table></figure><p><img src="/images_duixiang/006.png" alt></p><p>property属性的定义和调用要注意一下几点：</p><ul><li>定义时，在实例方法的基础上添加 @property 装饰器；并且仅有一个self参数</li><li>调用时，无需括号</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">方法：foo_obj.func()</span><br><span class="line">property属性：foo_obj.prop</span><br></pre></td></tr></table></figure><h2 id="2-简单的实例"><a href="#2-简单的实例" class="headerlink" title="2. 简单的实例"></a>2. 简单的实例</h2><blockquote><p>对于京东商城中显示电脑主机的列表页面，每次请求不可能把数据库中的所有内容都显示到页面上，而是通过分页的功能局部显示，所以在向数据库中请求数据时就要显示的指定获取从第m条到第n条的所有数据 这个分页的功能包括：</p><blockquote><ul><li>根据用户请求的当前页和总数据条数计算出 m 和 n</li><li>根据m 和 n 去数据库中请求数据</li></ul></blockquote></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ######## 定义 ########</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pager</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, current_page)</span>:</span></span><br><span class="line">        <span class="comment"># 用户当前请求的页码（第一页、第二页...）</span></span><br><span class="line">        self.current_page = current_page</span><br><span class="line">        <span class="comment"># 每页默认显示10条数据</span></span><br><span class="line">        self.per_items = <span class="number">10</span> </span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start</span><span class="params">(self)</span>:</span></span><br><span class="line">        val = (self.current_page - <span class="number">1</span>) * self.per_items</span><br><span class="line">        <span class="keyword">return</span> val</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">end</span><span class="params">(self)</span>:</span></span><br><span class="line">        val = self.current_page * self.per_items</span><br><span class="line">        <span class="keyword">return</span> val</span><br><span class="line"></span><br><span class="line"><span class="comment"># ######## 调用 ########</span></span><br><span class="line">p = Pager(<span class="number">1</span>)</span><br><span class="line">p.start  <span class="comment"># 就是起始值，即：m</span></span><br><span class="line">p.end  <span class="comment"># 就是结束值，即：n</span></span><br></pre></td></tr></table></figure><p>从上述可见</p><ul><li>Python的property属性的功能是：property属性内部进行一系列的逻辑计算，最终将计算结果返回。</li></ul><h2 id="3-property属性的有两种方式"><a href="#3-property属性的有两种方式" class="headerlink" title="3. property属性的有两种方式"></a>3. property属性的有两种方式</h2><ul><li>装饰器 即：在方法上应用装饰器</li><li>类属性 即：在类中定义值为property对象的类属性</li></ul><h3 id="3-1-装饰器方式"><a href="#3-1-装饰器方式" class="headerlink" title="3.1 装饰器方式"></a>3.1 装饰器方式</h3><p>在类的实例方法上应用@property装饰器</p><p>Python中的类有<code>经典类</code>和<code>新式类</code>，<code>新式类</code>的属性比<code>经典类</code>的属性丰富。（ 如果类继object，那么该类是新式类 ）</p><h4 id="3-1-1经典类，具有一种-property装饰器"><a href="#3-1-1经典类，具有一种-property装饰器" class="headerlink" title="3.1.1经典类，具有一种@property装饰器"></a>3.1.1经典类，具有一种@property装饰器</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">########## 定义 ########    </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Goods</span>:</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">price</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"laowang"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">########## 调用 ########</span></span><br><span class="line">obj = Goods()</span><br><span class="line">result = obj.price  <span class="comment"># 自动执行 @property 修饰的 price 方法，并获取方法的返回值</span></span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure><h4 id="3-1-2-新式类，具有三种-property装饰器"><a href="#3-1-2-新式类，具有三种-property装饰器" class="headerlink" title="3.1.2 新式类，具有三种@property装饰器"></a>3.1.2 新式类，具有三种@property装饰器</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment"># ######## 定义 ########</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Goods</span>:</span></span><br><span class="line">    <span class="string">"""python3中默认继承object类</span></span><br><span class="line"><span class="string">       以python2、3执行此程序的结果不同，因为只有在python3中才有@xxx.setter  @xxx.deleter</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">price</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'@property'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @price.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">price</span><span class="params">(self, value)</span>:</span></span><br><span class="line">        print(<span class="string">'@price.setter'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @price.deleter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">price</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'@price.deleter'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ######## 调用 ########</span></span><br><span class="line">obj = Goods()</span><br><span class="line">obj.price          <span class="comment"># 自动执行 @property 修饰的 price 方法，并获取方法的返回值</span></span><br><span class="line">obj.price = <span class="number">123</span>    <span class="comment"># 自动执行 @price.setter 修饰的 price 方法，并将  123 赋值给方法的参数</span></span><br><span class="line"><span class="keyword">del</span> obj.price      <span class="comment"># 自动执行 @price.deleter 修饰的 price 方法</span></span><br></pre></td></tr></table></figure><p>注意</p><ul><li>经典类中的属性只有一种访问方式，其对应被 @property 修饰的方法</li><li>新式类中的属性有三种访问方式，并分别对应了三个被@property、@方法名.setter、@方法名.deleter修饰的方法</li></ul><p>由于新式类中具有三种访问方式，我们可以根据它们几个属性的访问特点，分别将三个方法定义为对同一个属性：获取、修改、删除</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Goods</span><span class="params">(object)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># 原价</span></span><br><span class="line">        self.original_price = <span class="number">100</span></span><br><span class="line">        <span class="comment"># 折扣</span></span><br><span class="line">        self.discount = <span class="number">0.8</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">price</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># 实际价格 = 原价 * 折扣</span></span><br><span class="line">        new_price = self.original_price * self.discount</span><br><span class="line">        <span class="keyword">return</span> new_price</span><br><span class="line"></span><br><span class="line"><span class="meta">    @price.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">price</span><span class="params">(self, value)</span>:</span></span><br><span class="line">        self.original_price = value</span><br><span class="line"></span><br><span class="line"><span class="meta">    @price.deleter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">price</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">del</span> self.original_price</span><br><span class="line"></span><br><span class="line">obj = Goods()</span><br><span class="line">obj.price         <span class="comment"># 获取商品价格</span></span><br><span class="line">obj.price = <span class="number">200</span>   <span class="comment"># 修改商品原价</span></span><br><span class="line"><span class="keyword">del</span> obj.price     <span class="comment"># 删除商品原价</span></span><br></pre></td></tr></table></figure><h3 id="3-2-类属性方式"><a href="#3-2-类属性方式" class="headerlink" title="3.2 类属性方式"></a>3.2 类属性方式</h3><ul><li>当使用类属性的方式创建property属性时，<code>经典类</code>和<code>新式类</code>无区别<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_bar</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'laowang'</span></span><br><span class="line"></span><br><span class="line">    BAR = property(get_bar)</span><br><span class="line"></span><br><span class="line">obj = Foo()</span><br><span class="line">reuslt = obj.BAR  <span class="comment"># 自动调用get_bar方法，并获取方法的返回值</span></span><br><span class="line">print(reuslt)</span><br></pre></td></tr></table></figure></li></ul><p>property方法中有个四个参数</p><ul><li>第一个参数是方法名，调用 对象.属性 时自动触发执行方法</li><li>第二个参数是方法名，调用 对象.属性 ＝ XXX 时自动触发执行方法</li><li>第三个参数是方法名，调用 del 对象.属性 时自动触发执行方法</li><li>第四个参数是字符串，调用 对象.属性.<strong>doc</strong> ，此参数是该属性的描述信息</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_bar</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"getter..."</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'laowang'</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_bar</span><span class="params">(self, value)</span>:</span> </span><br><span class="line">        <span class="string">"""必须两个参数"""</span></span><br><span class="line">        print(<span class="string">"setter..."</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'set value'</span> + value</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">del_bar</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"deleter..."</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'laowang'</span></span><br><span class="line"></span><br><span class="line">    BAR = property(get_bar, set_bar, del_bar, <span class="string">"description..."</span>)</span><br><span class="line"></span><br><span class="line">obj = Foo()</span><br><span class="line"></span><br><span class="line">obj.BAR  <span class="comment"># 自动调用第一个参数中定义的方法：get_bar</span></span><br><span class="line">obj.BAR = <span class="string">"alex"</span>  <span class="comment"># 自动调用第二个参数中定义的方法：set_bar方法，并将“alex”当作参数传入</span></span><br><span class="line">desc = Foo.BAR.__doc__  <span class="comment"># 自动获取第四个参数中设置的值：description...</span></span><br><span class="line">print(desc)</span><br><span class="line"><span class="keyword">del</span> obj.BAR  <span class="comment"># 自动调用第三个参数中定义的方法：del_bar方法</span></span><br></pre></td></tr></table></figure><p>由于<code>类属性方式</code>创建property属性具有3种访问方式，我们可以根据它们几个属性的访问特点，分别将三个方法定义为对同一个属性：获取、修改、删除</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Goods</span><span class="params">(object)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># 原价</span></span><br><span class="line">        self.original_price = <span class="number">100</span></span><br><span class="line">        <span class="comment"># 折扣</span></span><br><span class="line">        self.discount = <span class="number">0.8</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_price</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># 实际价格 = 原价 * 折扣</span></span><br><span class="line">        new_price = self.original_price * self.discount</span><br><span class="line">        <span class="keyword">return</span> new_price</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_price</span><span class="params">(self, value)</span>:</span></span><br><span class="line">        self.original_price = value</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">del_price</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">del</span> self.original_price</span><br><span class="line"></span><br><span class="line">    PRICE = property(get_price, set_price, del_price, <span class="string">'价格属性描述...'</span>)</span><br><span class="line"></span><br><span class="line">obj = Goods()</span><br><span class="line">obj.PRICE         <span class="comment"># 获取商品价格</span></span><br><span class="line">obj.PRICE = <span class="number">200</span>   <span class="comment"># 修改商品原价</span></span><br><span class="line"><span class="keyword">del</span> obj.PRICE     <span class="comment"># 删除商品原价</span></span><br></pre></td></tr></table></figure><h2 id="4-Django框架中应用了property属性（了解）"><a href="#4-Django框架中应用了property属性（了解）" class="headerlink" title="4. Django框架中应用了property属性（了解）"></a>4. Django框架中应用了property属性（了解）</h2><p>WEB框架 Django 的视图中 request.POST 就是使用的类属性的方式创建的属性</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WSGIRequest</span><span class="params">(http.HttpRequest)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, environ)</span>:</span></span><br><span class="line">        script_name = get_script_name(environ)</span><br><span class="line">        path_info = get_path_info(environ)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> path_info:</span><br><span class="line">            <span class="comment"># Sometimes PATH_INFO exists, but is empty (e.g. accessing</span></span><br><span class="line">            <span class="comment"># the SCRIPT_NAME URL without a trailing slash). We really need to</span></span><br><span class="line">            <span class="comment"># operate as if they'd requested '/'. Not amazingly nice to force</span></span><br><span class="line">            <span class="comment"># the path like this, but should be harmless.</span></span><br><span class="line">            path_info = <span class="string">'/'</span></span><br><span class="line">        self.environ = environ</span><br><span class="line">        self.path_info = path_info</span><br><span class="line">        self.path = <span class="string">'%s/%s'</span> % (script_name.rstrip(<span class="string">'/'</span>), path_info.lstrip(<span class="string">'/'</span>))</span><br><span class="line">        self.META = environ</span><br><span class="line">        self.META[<span class="string">'PATH_INFO'</span>] = path_info</span><br><span class="line">        self.META[<span class="string">'SCRIPT_NAME'</span>] = script_name</span><br><span class="line">        self.method = environ[<span class="string">'REQUEST_METHOD'</span>].upper()</span><br><span class="line">        _, content_params = cgi.parse_header(environ.get(<span class="string">'CONTENT_TYPE'</span>, <span class="string">''</span>))</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'charset'</span> <span class="keyword">in</span> content_params:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                codecs.lookup(content_params[<span class="string">'charset'</span>])</span><br><span class="line">            <span class="keyword">except</span> LookupError:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.encoding = content_params[<span class="string">'charset'</span>]</span><br><span class="line">        self._post_parse_error = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            content_length = int(environ.get(<span class="string">'CONTENT_LENGTH'</span>))</span><br><span class="line">        <span class="keyword">except</span> (ValueError, TypeError):</span><br><span class="line">            content_length = <span class="number">0</span></span><br><span class="line">        self._stream = LimitedStream(self.environ[<span class="string">'wsgi.input'</span>], content_length)</span><br><span class="line">        self._read_started = <span class="literal">False</span></span><br><span class="line">        self.resolver_match = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_get_scheme</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.environ.get(<span class="string">'wsgi.url_scheme'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_get_request</span><span class="params">(self)</span>:</span></span><br><span class="line">        warnings.warn(<span class="string">'`request.REQUEST` is deprecated, use `request.GET` or '</span></span><br><span class="line">                      <span class="string">'`request.POST` instead.'</span>, RemovedInDjango19Warning, <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> hasattr(self, <span class="string">'_request'</span>):</span><br><span class="line">            self._request = datastructures.MergeDict(self.POST, self.GET)</span><br><span class="line">        <span class="keyword">return</span> self._request</span><br><span class="line"></span><br><span class="line"><span class="meta">    @cached_property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">GET</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># The WSGI spec says 'QUERY_STRING' may be absent.</span></span><br><span class="line">        raw_query_string = get_bytes_from_wsgi(self.environ, <span class="string">'QUERY_STRING'</span>, <span class="string">''</span>)</span><br><span class="line">        <span class="keyword">return</span> http.QueryDict(raw_query_string, encoding=self._encoding)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ######## 看这里看这里  ########</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_get_post</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> hasattr(self, <span class="string">'_post'</span>):</span><br><span class="line">            self._load_post_and_files()</span><br><span class="line">        <span class="keyword">return</span> self._post</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ######## 看这里看这里  ########</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_set_post</span><span class="params">(self, post)</span>:</span></span><br><span class="line">        self._post = post</span><br><span class="line"></span><br><span class="line"><span class="meta">    @cached_property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">COOKIES</span><span class="params">(self)</span>:</span></span><br><span class="line">        raw_cookie = get_str_from_wsgi(self.environ, <span class="string">'HTTP_COOKIE'</span>, <span class="string">''</span>)</span><br><span class="line">        <span class="keyword">return</span> http.parse_cookie(raw_cookie)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_get_files</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> hasattr(self, <span class="string">'_files'</span>):</span><br><span class="line">            self._load_post_and_files()</span><br><span class="line">        <span class="keyword">return</span> self._files</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ######## 看这里看这里  ########</span></span><br><span class="line">    POST = property(_get_post, _set_post)</span><br><span class="line"></span><br><span class="line">    FILES = property(_get_files)</span><br><span class="line">    REQUEST = property(_get_request)</span><br></pre></td></tr></table></figure><h2 id="5-总结"><a href="#5-总结" class="headerlink" title="5. 总结"></a>5. 总结</h2><ul><li>定义property属性共有两种方式，分别是【装饰器】和【类属性】，而【装饰器】方式针对经典类和新式类又有所不同。</li><li>通过使用property属性，能够简化调用者在获取数据的流程</li></ul><h1 id="property属性-应用"><a href="#property属性-应用" class="headerlink" title="property属性-应用"></a>property属性-应用</h1><h2 id="1-私有属性添加getter和setter方法"><a href="#1-私有属性添加getter和setter方法" class="headerlink" title="1. 私有属性添加getter和setter方法"></a>1. 私有属性添加getter和setter方法</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Money</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.__money = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getMoney</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.__money</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setMoney</span><span class="params">(self, value)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> isinstance(value, int):</span><br><span class="line">            self.__money = value</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">"error:不是整型数字"</span>)</span><br></pre></td></tr></table></figure><h2 id="2-使用property升级getter和setter方法"><a href="#2-使用property升级getter和setter方法" class="headerlink" title="2. 使用property升级getter和setter方法"></a>2. 使用property升级getter和setter方法</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Money</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.__money = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getMoney</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.__money</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setMoney</span><span class="params">(self, value)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> isinstance(value, int):</span><br><span class="line">            self.__money = value</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">"error:不是整型数字"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 定义一个属性，当对这个money设置值时调用setMoney,当获取值时调用getMoney</span></span><br><span class="line">    money = property(getMoney, setMoney)  </span><br><span class="line"></span><br><span class="line">a = Money()</span><br><span class="line">a.money = <span class="number">100</span>  <span class="comment"># 调用setMoney方法</span></span><br><span class="line">print(a.money)  <span class="comment"># 调用getMoney方法</span></span><br><span class="line"><span class="comment">#100</span></span><br></pre></td></tr></table></figure><h2 id="3-使用property取代getter和setter方法"><a href="#3-使用property取代getter和setter方法" class="headerlink" title="3. 使用property取代getter和setter方法"></a>3. 使用property取代getter和setter方法</h2><ul><li>重新实现一个属性的设置和读取方法,可做边界判定<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Money</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.__money = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 使用装饰器对money进行装饰，那么会自动添加一个叫money的属性，当调用获取money的值时，调用装饰的方法</span></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">money</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.__money</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 使用装饰器对money进行装饰，当对money设置值时，调用装饰的方法</span></span><br><span class="line"><span class="meta">    @money.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">money</span><span class="params">(self, value)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> isinstance(value, int):</span><br><span class="line">            self.__money = value</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">"error:不是整型数字"</span>)</span><br><span class="line"></span><br><span class="line">a = Money()</span><br><span class="line">a.money = <span class="number">100</span></span><br><span class="line">print(a.money)</span><br></pre></td></tr></table></figure></li></ul><h1 id="魔法属性"><a href="#魔法属性" class="headerlink" title="魔法属性"></a>魔法属性</h1><p>无论人或事物往往都有不按套路出牌的情况，Python的类属性也是如此，存在着一些具有特殊含义的属性，详情如下：</p><h2 id="1-doc"><a href="#1-doc" class="headerlink" title="1. __doc__"></a>1. <code>__doc__</code></h2><ul><li>表示类的描述信息<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>:</span></span><br><span class="line">    <span class="string">""" 描述类信息，这是用于看片的神奇 """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">print(Foo.__doc__)</span><br><span class="line"><span class="comment">#输出：类的描述信息</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="2-module-和-class"><a href="#2-module-和-class" class="headerlink" title="2. __module__ 和  __class__"></a>2. <code>__module__</code> 和 <code>__class__</code></h2><ul><li><code>__module__</code> 表示当前操作的对象在那个模块</li><li><code>__class__</code> 表示当前操作的对象的类是什么<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">test.py</span><br><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line"></span><br><span class="line">class Person(object):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.name = &apos;laowang&apos;</span><br><span class="line">main.py</span><br><span class="line">from test import Person</span><br><span class="line"></span><br><span class="line">obj = Person()</span><br><span class="line">print(obj.__module__)  # 输出 test 即：输出模块</span><br><span class="line">print(obj.__class__)  # 输出 test.Person 即：输出类</span><br></pre></td></tr></table></figure></li></ul><h2 id="3-init"><a href="#3-init" class="headerlink" title="3. __init__"></a>3. <code>__init__</code></h2><ul><li>初始化方法，通过类创建对象时，自动触发执行<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = <span class="number">18</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">obj = Person(<span class="string">'laowang'</span>)  <span class="comment"># 自动执行类中的 __init__ 方法</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="4-del"><a href="#4-del" class="headerlink" title="4. __del__"></a>4. <code>__del__</code></h2><ul><li>当对象在内存中被释放时，自动触发执行。<br>注：此方法一般无须定义，因为Python是一门高级语言，程序员在使用时无需关心内存的分配和释放，因为此工作都是交给Python解释器来执行，所以，<strong>del</strong>的调用是由解释器在进行垃圾回收时自动触发执行的。<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__del__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="5-call"><a href="#5-call" class="headerlink" title="5. __call__"></a>5. <code>__call__</code></h2><ul><li>对象后面加括号，触发执行。<br>注：<code>__init__</code>方法的执行是由创建对象触发的，即：<code>对象 = 类名()</code> ；而对于<code>__call__</code>方法的执行是由对象后加括号触发的，即：<code>对象()</code> 或者 <code>类()()</code></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span><span class="params">(self, *args, **kwargs)</span>:</span></span><br><span class="line">        print(<span class="string">'__call__'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">obj = Foo()  <span class="comment"># 执行 __init__</span></span><br><span class="line">obj()  <span class="comment"># 执行 __call__</span></span><br></pre></td></tr></table></figure><h2 id="6-dict"><a href="#6-dict" class="headerlink" title="6. __dict__"></a>6. <code>__dict__</code></h2><ul><li>类或对象中的所有属性<br>类的实例属性属于对象；类中的类属性和方法等属于类，即：</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Province</span><span class="params">(object)</span>:</span></span><br><span class="line">    country = <span class="string">'China'</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, count)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.count = count</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(self, *args, **kwargs)</span>:</span></span><br><span class="line">        print(<span class="string">'func'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取类的属性，即：类属性、方法、</span></span><br><span class="line">print(Province.__dict__)</span><br><span class="line"><span class="comment"># 输出：&#123;'__dict__': &lt;attribute '__dict__' of 'Province' objects&gt;, '__module__': '__main__', 'country': 'China', '__doc__': None, '__weakref__': &lt;attribute '__weakref__' of 'Province' objects&gt;, 'func': &lt;function Province.func at 0x101897950&gt;, '__init__': &lt;function Province.__init__ at 0x1018978c8&gt;&#125;</span></span><br><span class="line"></span><br><span class="line">obj1 = Province(<span class="string">'山东'</span>, <span class="number">10000</span>)</span><br><span class="line">print(obj1.__dict__)</span><br><span class="line"><span class="comment"># 获取 对象obj1 的属性</span></span><br><span class="line"><span class="comment"># 输出：&#123;'count': 10000, 'name': '山东'&#125;</span></span><br><span class="line"></span><br><span class="line">obj2 = Province(<span class="string">'山西'</span>, <span class="number">20000</span>)</span><br><span class="line">print(obj2.__dict__)</span><br><span class="line"><span class="comment"># 获取 对象obj1 的属性</span></span><br><span class="line"><span class="comment"># 输出：&#123;'count': 20000, 'name': '山西'&#125;</span></span><br></pre></td></tr></table></figure><h2 id="7-str"><a href="#7-str" class="headerlink" title="7. __str__"></a>7. <code>__str__</code></h2><ul><li>如果一个类中定义了<code>__str__</code>方法，那么在打印 对象 时，默认输出该方法的返回值。<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'laowang'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">obj = Foo()</span><br><span class="line">print(obj)</span><br><span class="line"><span class="comment"># 输出：laowang</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="8、-getitem-、-setitem-、-delitem"><a href="#8、-getitem-、-setitem-、-delitem" class="headerlink" title="8、__getitem__、__setitem__、__delitem__"></a>8、<code>__getitem__</code>、<code>__setitem__</code>、<code>__delitem__</code></h2><ul><li>用于索引操作，如字典。以上分别表示获取、设置、删除数据<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span><span class="params">(object)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getitem__</span><span class="params">(self, key)</span>:</span></span><br><span class="line">        print(<span class="string">'__getitem__'</span>, key)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__setitem__</span><span class="params">(self, key, value)</span>:</span></span><br><span class="line">        print(<span class="string">'__setitem__'</span>, key, value)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__delitem__</span><span class="params">(self, key)</span>:</span></span><br><span class="line">        print(<span class="string">'__delitem__'</span>, key)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">obj = Foo()</span><br><span class="line"></span><br><span class="line">result = obj[<span class="string">'k1'</span>]      <span class="comment"># 自动触发执行 __getitem__</span></span><br><span class="line">obj[<span class="string">'k2'</span>] = <span class="string">'laowang'</span>   <span class="comment"># 自动触发执行 __setitem__</span></span><br><span class="line"><span class="keyword">del</span> obj[<span class="string">'k1'</span>]           <span class="comment"># 自动触发执行 __delitem__</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="9、-getslice-、-setslice-、-delslice"><a href="#9、-getslice-、-setslice-、-delslice" class="headerlink" title="9、__getslice__、__setslice__、__delslice__"></a>9、<code>__getslice__</code>、<code>__setslice__</code>、<code>__delslice__</code></h2><ul><li>该三个方法用于分片操作，如：列表<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span><span class="params">(object)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getslice__</span><span class="params">(self, i, j)</span>:</span></span><br><span class="line">        print(<span class="string">'__getslice__'</span>, i, j)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__setslice__</span><span class="params">(self, i, j, sequence)</span>:</span></span><br><span class="line">        print(<span class="string">'__setslice__'</span>, i, j)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__delslice__</span><span class="params">(self, i, j)</span>:</span></span><br><span class="line">        print(<span class="string">'__delslice__'</span>, i, j)</span><br><span class="line"></span><br><span class="line">obj = Foo()</span><br><span class="line"></span><br><span class="line">obj[<span class="number">-1</span>:<span class="number">1</span>]                   <span class="comment"># 自动触发执行 __getslice__</span></span><br><span class="line">obj[<span class="number">0</span>:<span class="number">1</span>] = [<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">44</span>]    <span class="comment"># 自动触发执行 __setslice__</span></span><br><span class="line"><span class="keyword">del</span> obj[<span class="number">0</span>:<span class="number">2</span>]                <span class="comment"># 自动触发执行 __delslice__</span></span><br></pre></td></tr></table></figure></li></ul><h1 id="面向对象设计"><a href="#面向对象设计" class="headerlink" title="面向对象设计"></a>面向对象设计</h1><ul><li>继承 - 是基于Python中的属性查找(如X.name)</li><li>多态 - 在X.method方法中，method的意义取决于X的类型</li><li>封装 - 方法和运算符实现行为，数据隐藏默认是一种惯例</li></ul><h2 id="参考实例"><a href="#参考实例" class="headerlink" title="参考实例"></a>参考实例</h2><p>腾讯即时通信模块,初级封装<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Message</span><span class="params">(object)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, msgarr=[], toacc=<span class="string">''</span>)</span>:</span></span><br><span class="line">        self.msgbody = msgarr <span class="comment"># 此处为MsgDict对象实例的列表或者空列表</span></span><br><span class="line">        self.toacc = toacc <span class="comment"># toacc为字符串(单发)或者列表(批量发)</span></span><br><span class="line">        self.msgrandom = random.randint(<span class="number">1</span>, <span class="number">1000000000</span>)</span><br><span class="line">        self.msgrequest = &#123;</span><br><span class="line">            <span class="string">'To_Account'</span>: toacc, <span class="comment"># 消息接收方账号</span></span><br><span class="line">            <span class="string">'MsgRandom'</span>: self.msgrandom, <span class="comment"># 消息随机数，由随机函数产生</span></span><br><span class="line">            <span class="string">'MsgBody'</span>: [t.msg <span class="keyword">for</span> t <span class="keyword">in</span> msgarr]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">del_option</span><span class="params">(self, option)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> option <span class="keyword">in</span> (set(self.msgrequest)-set([<span class="string">'To_Account'</span>, <span class="string">'MsgRandom'</span>, <span class="string">'MsgBody'</span>])):</span><br><span class="line">            self.__dict__.pop(option)</span><br><span class="line">            self.msgrequest.pop(option)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">append_msg</span><span class="params">(self, msg)</span>:</span></span><br><span class="line">        self.msgbody.append(msg)</span><br><span class="line">        self.msgrequest[<span class="string">'MsgBody'</span>].append(msg.msg)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">insert_msg</span><span class="params">(self, index, msg)</span>:</span></span><br><span class="line">        self.msgbody.insert(index, msg)</span><br><span class="line">        self.msgrequest[<span class="string">'MsgBody'</span>].insert(msg.msg)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">del_msg</span><span class="params">(self, index)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> index <span class="keyword">in</span> range(len(self.msgbody)):</span><br><span class="line">            <span class="keyword">del</span> self.msgbody[index]</span><br><span class="line">            <span class="keyword">del</span> sel.msgrequest[<span class="string">'MsgBody'</span>][index]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_from</span><span class="params">(self, fromacc)</span>:</span></span><br><span class="line">        <span class="comment"># 指定消息的发送方，默认为服务器发送</span></span><br><span class="line">        self.fromacc = fromacc</span><br><span class="line">        self.msgrequest[<span class="string">'From_Account'</span>] = fromacc</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_to</span><span class="params">(self, toacc)</span>:</span></span><br><span class="line">        <span class="comment"># 指定消息的接收方，可以为String(单发),可以为List(批量发送)</span></span><br><span class="line">        self.toacc = toacc</span><br><span class="line">        self.msgrequest[<span class="string">'To_Account'</span>] = toacc</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">refresh_random</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.msgrandom = random.randint(<span class="number">1</span>, <span class="number">1000000000</span>)</span><br><span class="line">        self.msgrequest[<span class="string">'MsgRandom'</span>] = self.msgrandom, <span class="comment"># 消息随机数，由随机函数产生</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_sync</span><span class="params">(self, sync)</span>:</span></span><br><span class="line">        <span class="comment"># 同步选项：1, 把消息同步到From_Account在线终端和漫游上</span></span><br><span class="line">        <span class="comment">#           2, 消息不同步至From_Account</span></span><br><span class="line">        <span class="comment">#           若不填写，默认情况下会将消息同步</span></span><br><span class="line">        <span class="comment">#           仅在单发单聊消息中可调用</span></span><br><span class="line">        self.sync = sync</span><br><span class="line">        self.msgrequest[<span class="string">'SyncOtherMachine'</span>] = sync</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_timestamp</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># 设置消息时间戳，unix时间, 仅在单发单聊消息中可以调用</span></span><br><span class="line">        self.timestamp = int(time.time())</span><br><span class="line">        self.msgrequest[<span class="string">'MsgTimeStamp'</span>] = self.timestamp</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_offlinepush</span><span class="params">(self, pushflag=<span class="number">0</span>, desc=<span class="string">''</span>, ext=<span class="string">''</span>, sound=<span class="string">''</span>)</span>:</span></span><br><span class="line">        <span class="comment"># 仅适用于APNa推送，不适用于安卓厂商推送</span></span><br><span class="line">        self.msgrequest[<span class="string">'OfflinePushInfo'</span>] = &#123;</span><br><span class="line">            <span class="string">'PushFlag'</span>: pushflag,</span><br><span class="line">            <span class="string">'Desc'</span>: desc,</span><br><span class="line">            <span class="string">'Ext'</span>: ext,</span><br><span class="line">            <span class="string">'Sound'</span>: sound</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MsgDict</span><span class="params">(object)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, msgtype=<span class="string">''</span>, msgcontent=&#123;&#125;)</span>:</span></span><br><span class="line">        self.msgtype = msgtype</span><br><span class="line">        self.msgcontent = msgcontent</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">msg</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">'MsgType'</span>: self.msgtype,</span><br><span class="line">            <span class="string">'MsgContent'</span>: self.msgcontent</span><br><span class="line">        &#125; </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_content</span><span class="params">(self, content)</span>:</span></span><br><span class="line">        self.msgcontent = content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TextMsg</span><span class="params">(MsgDict)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, text=<span class="string">''</span>, msgtype=<span class="string">'TIMTextElem'</span>)</span>:</span> </span><br><span class="line">        self.text = text</span><br><span class="line">        content = &#123;<span class="string">'Text'</span>: text&#125;</span><br><span class="line">        super(TextMsg, self).__init__(msgtype=msgtype, msgcontent=content)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_text</span><span class="params">(self, text)</span>:</span></span><br><span class="line">        self.text = text</span><br><span class="line">        self.msgcontent[<span class="string">'Text'</span>] = text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LocationMsg</span><span class="params">(MsgDict)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, desc=<span class="string">''</span>, latitude=<span class="number">0</span>, longitude=<span class="number">0</span>, msgtype=<span class="string">'TIMLocationElem'</span>)</span>:</span> </span><br><span class="line">        self.desc = desc</span><br><span class="line">        self.latitude = latitude</span><br><span class="line">        self.longitude = longitude</span><br><span class="line">        content = &#123;</span><br><span class="line">            <span class="string">'Desc'</span>: desc,  <span class="comment"># 地理位置描述信息, String</span></span><br><span class="line">            <span class="string">'Latitude'</span>: latitude, <span class="comment"># 纬度, Number</span></span><br><span class="line">            <span class="string">'Longitude'</span>: longitude <span class="comment"># 经度, Number</span></span><br><span class="line">        &#125;</span><br><span class="line">        super(LocationMsg, self).__init__(msgtype=msgtype, msgcontent=content)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_desc</span><span class="params">(self, desc)</span>:</span></span><br><span class="line">        self.desc = desc</span><br><span class="line">        self.msgcontent[<span class="string">'Desc'</span>] = desc</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_location</span><span class="params">(self, latitude, longitude)</span>:</span></span><br><span class="line">        self.latitude = latitude</span><br><span class="line">        self.longitude = longitude</span><br><span class="line">        self.msgcontent[<span class="string">'Latitude'</span>] = latitude</span><br><span class="line">        self.msgcontent[<span class="string">'Longitude'</span>] = longitude</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_latitude</span><span class="params">(self, latitude)</span>:</span></span><br><span class="line">        self.latitude = latitude</span><br><span class="line">        self.msgcontent[<span class="string">'Latitude'</span>] = latitude</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_longitude</span><span class="params">(self, longitude)</span>:</span></span><br><span class="line">        self.longitude = longitude</span><br><span class="line">        self.msgcontent[<span class="string">'Longitude'</span>] = longitude</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FaceMsg</span><span class="params">(MsgDict)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, index=<span class="number">1</span>, data=<span class="string">''</span>, msgtype=<span class="string">'TIMFaceElem'</span>)</span>:</span> </span><br><span class="line">        self.index = index </span><br><span class="line">        self.data = data</span><br><span class="line">        content = &#123;</span><br><span class="line">            <span class="string">'Index'</span>: index, <span class="comment"># 表情索引，用户自定义, Number</span></span><br><span class="line">            <span class="string">'Data'</span>: data <span class="comment"># 额外数据, String</span></span><br><span class="line">        &#125;</span><br><span class="line">        super(TextMsg, self).__init__(msgtype=msgtype, msgcontent=content)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_index</span><span class="params">(self, index)</span>:</span></span><br><span class="line">        self.index = index</span><br><span class="line">        self.msgcontent[<span class="string">'Index'</span>] = index</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_data</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        self.data = data</span><br><span class="line">        self.msgcontent[<span class="string">'Data'</span>] = data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomMsg</span><span class="params">(MsgDict)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, data=<span class="string">''</span>, desc=<span class="string">''</span>, ext=<span class="string">''</span>, sound=<span class="string">''</span>, msgtype=<span class="string">'TIMCustomElem'</span>)</span>:</span> </span><br><span class="line">        self.data = data</span><br><span class="line">        self.desc = desc</span><br><span class="line">        self.ext = ext</span><br><span class="line">        self.sound = sound</span><br><span class="line">        content = &#123;</span><br><span class="line">            <span class="string">'Data'</span>: data, <span class="comment"># 自定义消息数据。不作为APNS的payload中字段下发，故从payload中无法获取Data字段, String</span></span><br><span class="line">            <span class="string">'Desc'</span>: desc, <span class="comment"># 自定义消息描述，当接收方为iphone后台在线时，做ios离线Push时文本展示</span></span><br><span class="line">            <span class="string">'Ext'</span>: ext, <span class="comment"># 扩展字段，当接收方为ios系统且应用处在后台时，此字段作为APNS请求包Payloads中的ext键值下发，Ext的协议格式由业务方确定，APNS只做透传</span></span><br><span class="line">            <span class="string">'Sound'</span>: sound <span class="comment"># 自定义APNS推送铃声</span></span><br><span class="line">        &#125;</span><br><span class="line">        super(CustomMsg, self).__init__(msgtype=msgtype, msgcontent=content)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_data</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        self.data = data</span><br><span class="line">        self.msgcontent[<span class="string">'Data'</span>] = data</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_desc</span><span class="params">(self, desc)</span>:</span></span><br><span class="line">        self.desc = desc</span><br><span class="line">        self.msgcontent[<span class="string">'Desc'</span>] = desc</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_ext</span><span class="params">(self, ext)</span>:</span></span><br><span class="line">        self.ext = ext</span><br><span class="line">        self.msgcontent[<span class="string">'Ext'</span>] = ext</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_sound</span><span class="params">(self, sound)</span>:</span></span><br><span class="line">        self.sound = sound</span><br><span class="line">        self.msgcontent[<span class="string">'Sound'</span>] = sound</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SoundMsg</span><span class="params">(MsgDict)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, uuid=<span class="string">''</span>, size=<span class="number">0</span>, second=<span class="number">0</span>, msgtype=<span class="string">'TIMSoundElem'</span>)</span>:</span> </span><br><span class="line">        self.uuid = uuid </span><br><span class="line">        self.size = size </span><br><span class="line">        self.second = second</span><br><span class="line">        content = &#123;</span><br><span class="line">            <span class="string">'UUID'</span>: uuid, <span class="comment"># 语音序列号，后台用于索引语音的键值，String</span></span><br><span class="line">            <span class="string">'Size'</span>: size, <span class="comment"># 语音数据大小, Number </span></span><br><span class="line">            <span class="string">'Second'</span>: second <span class="comment"># 语音时长，单位秒 Number </span></span><br><span class="line">        &#125;</span><br><span class="line">        super(SoundMsg, self).__init__(msgtype=msgtype, msgcontent=content)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_uuid</span><span class="params">(self, uuid)</span>:</span></span><br><span class="line">        self.uuid = uuid</span><br><span class="line">        self.msgcontent[<span class="string">'UUID'</span>] = uuid</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_size</span><span class="params">(self, size)</span>:</span></span><br><span class="line">        self.size = size</span><br><span class="line">        self.msgcontent[<span class="string">'Size'</span>] = size</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_second</span><span class="params">(self, second)</span>:</span></span><br><span class="line">        self.second = second</span><br><span class="line">        self.msgcontent[<span class="string">'Second'</span>] = second</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ImageMsg</span><span class="params">(MsgDict)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, uuid=<span class="string">''</span>, imgformat=<span class="number">0</span>, imginfo=[], msgtype=<span class="string">'TIMImageElem'</span>)</span>:</span> </span><br><span class="line">        self.uuid = uuid </span><br><span class="line">        self.imgformat = imgformat </span><br><span class="line">        self.imginfo = imginfo </span><br><span class="line">        content = &#123;</span><br><span class="line">            <span class="string">'UUID'</span>: uuid, <span class="comment"># 图片序列号，后台用于索引语音的键值，String</span></span><br><span class="line">            <span class="string">'ImageFormat'</span>: imgformat, <span class="comment"># 图片格式， BMP=1, JPG=2, GIF=3, 其他=0, Number </span></span><br><span class="line">            <span class="string">'ImageInfoArray'</span>: [t.info <span class="keyword">for</span> t <span class="keyword">in</span> imginfo] <span class="comment"># 原图，缩略图或者大图下载信息, Array</span></span><br><span class="line">        &#125;</span><br><span class="line">        super(ImageMsg, self).__init__(msgtype=msgtype, msgcontent=content)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_uuid</span><span class="params">(self, uuid)</span>:</span></span><br><span class="line">        self.uuid = uuid</span><br><span class="line">        self.msgcontent[<span class="string">'UUID'</span>] = uuid</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_format</span><span class="params">(self, imgformat)</span>:</span></span><br><span class="line">        self.imgformat = imgformat</span><br><span class="line">        self.msgcontent[<span class="string">'ImageFormat'</span>] = imgformat</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">append_info</span><span class="params">(self, info)</span>:</span></span><br><span class="line">        <span class="comment"># info 为ImageInfo对象实例</span></span><br><span class="line">        self.imginfo.append(info)</span><br><span class="line">        self.msgcontnet[<span class="string">'ImageInfoArray'</span>].append(info.info)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">insert_info</span><span class="params">(self, index, info)</span>:</span></span><br><span class="line">        self.imginfo.insert(index, info)</span><br><span class="line">        self.msgcontent[<span class="string">'ImageInfoArray'</span>].insert(index, info.info)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">del_info</span><span class="params">(self, index)</span>:</span></span><br><span class="line">        <span class="keyword">del</span> self.imginfo[index]</span><br><span class="line">        <span class="keyword">del</span> self.msgcontent[<span class="string">'ImageInfoArray'</span>][index]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileMsg</span><span class="params">(MsgDict)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, uuid=<span class="string">''</span>, size=<span class="number">0</span>, name=<span class="string">''</span>, msgtype=<span class="string">'TIMFileElem'</span>)</span>:</span> </span><br><span class="line">        self.uuid = uuid </span><br><span class="line">        self.size = size </span><br><span class="line">        self.name = name</span><br><span class="line">        content = &#123;</span><br><span class="line">            <span class="string">'UUID'</span>: uuid, <span class="comment"># 文件序列号，后台用于索引语音的键值，String</span></span><br><span class="line">            <span class="string">'FileSize'</span>: size, <span class="comment"># 文件数据大小, Number </span></span><br><span class="line">            <span class="string">'FileName'</span>: name <span class="comment"># 文件名称/路径， String</span></span><br><span class="line">        &#125;</span><br><span class="line">        super(FileMsg, self).__init__(msgtype=msgtype, msgcontent=content)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_uuid</span><span class="params">(self, uuid)</span>:</span></span><br><span class="line">        self.uuid = uuid</span><br><span class="line">        self.msgcontent[<span class="string">'UUID'</span>] = UUID</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_size</span><span class="params">(self, size)</span>:</span></span><br><span class="line">        self.size = size</span><br><span class="line">        self.msgcontent[<span class="string">'FileSize'</span>] = size</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_name</span><span class="params">(self, name)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.msgcontent[<span class="string">'FileName'</span>] = name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ImageInfo</span><span class="params">(object)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, itype=<span class="number">1</span>, size=<span class="number">0</span>, width=<span class="number">0</span>, height=<span class="number">0</span>, url=<span class="string">''</span>)</span>:</span></span><br><span class="line">        <span class="comment">#图片类型， 1-原图， 2-大图， 3-缩略图, 0-其他</span></span><br><span class="line">        self.itype = itype </span><br><span class="line">        <span class="comment"># 图片数据大小,Number</span></span><br><span class="line">        self.size = size</span><br><span class="line">        <span class="comment"># 图片宽度,Number</span></span><br><span class="line">        self.width = width</span><br><span class="line">        <span class="comment"># 图片高度, Number</span></span><br><span class="line">        self.height = height</span><br><span class="line">        <span class="comment"># 图片下载地址,String</span></span><br><span class="line">        self.url = url</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">info</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">'Type'</span>: self.itype, </span><br><span class="line">            <span class="string">'Size'</span>: self.size,  </span><br><span class="line">            <span class="string">'Width'</span>: self.width,  </span><br><span class="line">            <span class="string">'Height'</span>: self.height, </span><br><span class="line">            <span class="string">'URL'</span>: self.url </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_type</span><span class="params">(self, itype)</span>:</span></span><br><span class="line">        self.itype = itype</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_size</span><span class="params">(self, size)</span>:</span></span><br><span class="line">        self.size = size</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_width</span><span class="params">(self, width)</span>:</span></span><br><span class="line">        self.width = width</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_height</span><span class="params">(self, height)</span>:</span></span><br><span class="line">        self.height = height</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_url</span><span class="params">(self, url)</span>:</span></span><br><span class="line">        self.url = url</span><br></pre></td></tr></table></figure><p></p><h2 id="微信开发包，python实现-wechat-sdk开发"><a href="#微信开发包，python实现-wechat-sdk开发" class="headerlink" title="微信开发包，python实现, wechat_sdk开发"></a>微信开发包，python实现, wechat_sdk开发</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://wechat-python-sdk.com/</span><br></pre></td></tr></table></figure><p>截取部分代码，学习类的设计</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> unicode_literals</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> wechat_sdk.lib.crypto <span class="keyword">import</span> BasicCrypto</span><br><span class="line"><span class="keyword">from</span> wechat_sdk.lib.request <span class="keyword">import</span> WechatRequest</span><br><span class="line"><span class="keyword">from</span> wechat_sdk.exceptions <span class="keyword">import</span> NeedParamError</span><br><span class="line"><span class="keyword">from</span> wechat_sdk.utils <span class="keyword">import</span> disable_urllib3_warning</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WechatConf</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">""" WechatConf 配置类</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    该类将会存储所有和微信开发相关的配置信息, 同时也会维护配置信息的有效性.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, **kwargs)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :param kwargs: 配置信息字典, 可用字典 key 值及对应解释如下:</span></span><br><span class="line"><span class="string">                       'token': 微信 Token</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                       'appid': App ID</span></span><br><span class="line"><span class="string">                       'appsecret': App Secret</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                       'encrypt_mode': 加解密模式 ('normal': 明文模式, 'compatible': 兼容模式, 'safe': 安全模式(默认))</span></span><br><span class="line"><span class="string">                       'encoding_aes_key': EncodingAESKey 值 (传入此值必须保证同时传入 token, appid, 否则抛出异常)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                       'access_token_getfunc': access token 获取函数 (用于单机及分布式环境下, 具体格式参见文档)</span></span><br><span class="line"><span class="string">                       'access_token_setfunc': access token 写入函数 (用于单机及分布式环境下, 具体格式参见文档)</span></span><br><span class="line"><span class="string">                       'access_token_refreshfunc': access token 刷新函数 (用于单机及分布式环境下, 具体格式参见文档)</span></span><br><span class="line"><span class="string">                       'access_token': 直接导入的 access token 值, 该值需要在上一次该类实例化之后手动进行缓存并在此处传入, 如果不</span></span><br><span class="line"><span class="string">                                       传入, 将会在需要时自动重新获取 (传入 access_token_getfunc 和 access_token_setfunc 函数</span></span><br><span class="line"><span class="string">                                       后将会自动忽略此处的传入值)</span></span><br><span class="line"><span class="string">                       'access_token_expires_at': 直接导入的 access token 的过期日期, 该值需要在上一次该类实例化之后手动进行缓存</span></span><br><span class="line"><span class="string">                                                  并在此处传入, 如果不传入, 将会在需要时自动重新获取 (传入 access_token_getfunc</span></span><br><span class="line"><span class="string">                                                  和 access_token_setfunc 函数后将会自动忽略此处的传入值)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                       'jsapi_ticket_getfunc': jsapi ticket 获取函数 (用于单机及分布式环境下, 具体格式参见文档)</span></span><br><span class="line"><span class="string">                       'jsapi_ticket_setfunc': jsapi ticket 写入函数 (用于单机及分布式环境下, 具体格式参见文档)</span></span><br><span class="line"><span class="string">                       'jsapi_ticket_refreshfunc': jsapi ticket 刷新函数 (用于单机及分布式环境下, 具体格式参见文档)</span></span><br><span class="line"><span class="string">                       'jsapi_ticket': 直接导入的 jsapi ticket 值, 该值需要在上一次该类实例化之后手动进行缓存并在此处传入, 如果不</span></span><br><span class="line"><span class="string">                                       传入, 将会在需要时自动重新获取 (传入 jsapi_ticket_getfunc 和 jsapi_ticket_setfunc 函数</span></span><br><span class="line"><span class="string">                                       后将会自动忽略此处的传入值)</span></span><br><span class="line"><span class="string">                       'jsapi_ticket_expires_at': 直接导入的 jsapi ticket 的过期日期, 该值需要在上一次该类实例化之后手动进行缓存</span></span><br><span class="line"><span class="string">                                                  并在此处传入, 如果不传入, 将会在需要时自动重新获取 (传入 jsapi_ticket_getfunc</span></span><br><span class="line"><span class="string">                                                  和 jsapi_ticket_setfunc 函数后将会自动忽略此处的传入值)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                       'partnerid': 财付通商户身份标识, 支付权限专用</span></span><br><span class="line"><span class="string">                       'partnerkey': 财付通商户权限密钥 Key, 支付权限专用</span></span><br><span class="line"><span class="string">                       'paysignkey': 商户签名密钥 Key, 支付权限专用</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                       'checkssl': 是否检查 SSL, 默认不检查 (False), 可避免 urllib3 的 InsecurePlatformWarning 警告</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line"></span><br><span class="line">        self.__request = WechatRequest()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> kwargs.get(<span class="string">'checkssl'</span>) <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">True</span>:</span><br><span class="line">            disable_urllib3_warning()  <span class="comment"># 可解决 InsecurePlatformWarning 警告</span></span><br><span class="line"></span><br><span class="line">        self.__token = kwargs.get(<span class="string">'token'</span>)</span><br><span class="line"></span><br><span class="line">        self.__appid = kwargs.get(<span class="string">'appid'</span>)</span><br><span class="line">        self.__appsecret = kwargs.get(<span class="string">'appsecret'</span>)</span><br><span class="line"></span><br><span class="line">        self.__encrypt_mode = kwargs.get(<span class="string">'encrypt_mode'</span>, <span class="string">'safe'</span>)</span><br><span class="line">        self.__encoding_aes_key = kwargs.get(<span class="string">'encoding_aes_key'</span>)</span><br><span class="line">        self.__crypto = <span class="literal">None</span></span><br><span class="line">        self._update_crypto()</span><br><span class="line"></span><br><span class="line">        self.__access_token_getfunc = kwargs.get(<span class="string">'access_token_getfunc'</span>)</span><br><span class="line">        self.__access_token_setfunc = kwargs.get(<span class="string">'access_token_setfunc'</span>)</span><br><span class="line">        self.__access_token_refreshfunc = kwargs.get(<span class="string">'access_token_refreshfunc'</span>)</span><br><span class="line">        self.__access_token = kwargs.get(<span class="string">'access_token'</span>)</span><br><span class="line">        self.__access_token_expires_at = kwargs.get(<span class="string">'access_token_expires_at'</span>)</span><br><span class="line"></span><br><span class="line">        self.__jsapi_ticket_getfunc = kwargs.get(<span class="string">'jsapi_ticket_getfunc'</span>)</span><br><span class="line">        self.__jsapi_ticket_setfunc = kwargs.get(<span class="string">'jsapi_ticket_setfunc'</span>)</span><br><span class="line">        self.__jsapi_ticket_refreshfunc = kwargs.get(<span class="string">'jsapi_ticket_refreshfunc'</span>)</span><br><span class="line">        self.__jsapi_ticket = kwargs.get(<span class="string">'jsapi_ticket'</span>)</span><br><span class="line">        self.__jsapi_ticket_expires_at = kwargs.get(<span class="string">'jsapi_ticket_expires_at'</span>)</span><br><span class="line"></span><br><span class="line">        self.__partnerid = kwargs.get(<span class="string">'partnerid'</span>)</span><br><span class="line">        self.__partnerkey = kwargs.get(<span class="string">'partnerkey'</span>)</span><br><span class="line">        self.__paysignkey = kwargs.get(<span class="string">'paysignkey'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">token</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">""" 获取当前 Token """</span></span><br><span class="line">        self._check_token()</span><br><span class="line">        <span class="keyword">return</span> self.__token</span><br><span class="line"></span><br><span class="line"><span class="meta">    @token.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">token</span><span class="params">(self, token)</span>:</span></span><br><span class="line">        <span class="string">""" 设置当前 Token """</span></span><br><span class="line">        self.__token = token</span><br><span class="line">        self._update_crypto()  <span class="comment"># 改动 Token 需要重新更新 Crypto</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">appid</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">""" 获取当前 App ID """</span></span><br><span class="line">        <span class="keyword">return</span> self.__appid</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">appsecret</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">""" 获取当前 App Secret """</span></span><br><span class="line">        <span class="keyword">return</span> self.__appsecret</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_appid_appsecret</span><span class="params">(self, appid, appsecret)</span>:</span></span><br><span class="line">        <span class="string">""" 设置当前 App ID 及 App Secret"""</span></span><br><span class="line">        self.__appid = appid</span><br><span class="line">        self.__appsecret = appsecret</span><br><span class="line">        self._update_crypto()  <span class="comment"># 改动 App ID 后需要重新更新 Crypto</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encoding_aes_key</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">""" 获取当前 EncodingAESKey """</span></span><br><span class="line">        <span class="keyword">return</span> self.__encoding_aes_key</span><br><span class="line"></span><br><span class="line"><span class="meta">    @encoding_aes_key.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encoding_aes_key</span><span class="params">(self, encoding_aes_key)</span>:</span></span><br><span class="line">        <span class="string">""" 设置当前 EncodingAESKey """</span></span><br><span class="line">        self.__encoding_aes_key = encoding_aes_key</span><br><span class="line">        self._update_crypto()  <span class="comment"># 改动 EncodingAESKey 需要重新更新 Crypto</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt_mode</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.__encrypt_mode</span><br><span class="line"></span><br><span class="line"><span class="meta">    @encrypt_mode.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt_mode</span><span class="params">(self, encrypt_mode)</span>:</span></span><br><span class="line">        <span class="string">""" 设置当前加密模式 """</span></span><br><span class="line">        self.__encrypt_mode = encrypt_mode</span><br><span class="line">        self._update_crypto()</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">crypto</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">""" 获取当前 Crypto 实例 """</span></span><br><span class="line">        <span class="keyword">return</span> self.__crypto</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">access_token</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">""" 获取当前 access token 值, 本方法会自行维护 access token 有效性 """</span></span><br><span class="line">        self._check_appid_appsecret()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> callable(self.__access_token_getfunc):</span><br><span class="line">            self.__access_token, self.__access_token_expires_at = self.__access_token_getfunc()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.__access_token:</span><br><span class="line">            now = time.time()</span><br><span class="line">            <span class="keyword">if</span> self.__access_token_expires_at - now &gt; <span class="number">60</span>:</span><br><span class="line">                <span class="keyword">return</span> self.__access_token</span><br><span class="line"></span><br><span class="line">        self.grant_access_token()  <span class="comment"># 从腾讯服务器获取 access token 并更新</span></span><br><span class="line">        <span class="keyword">return</span> self.__access_token</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">jsapi_ticket</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">""" 获取当前 jsapi ticket 值, 本方法会自行维护 jsapi ticket 有效性 """</span></span><br><span class="line">        self._check_appid_appsecret()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> callable(self.__jsapi_ticket_getfunc):</span><br><span class="line">            self.__jsapi_ticket, self.__jsapi_ticket_expires_at = self.__jsapi_ticket_getfunc()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.__jsapi_ticket:</span><br><span class="line">            now = time.time()</span><br><span class="line">            <span class="keyword">if</span> self.__jsapi_ticket_expires_at - now &gt; <span class="number">60</span>:</span><br><span class="line">                <span class="keyword">return</span> self.__jsapi_ticket</span><br><span class="line"></span><br><span class="line">        self.grant_jsapi_ticket()  <span class="comment"># 从腾讯服务器获取 jsapi ticket 并更新</span></span><br><span class="line">        <span class="keyword">return</span> self.__jsapi_ticket</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">partnerid</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">""" 获取当前财付通商户身份标识 """</span></span><br><span class="line">        <span class="keyword">return</span> self.__partnerid</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">partnerkey</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">""" 获取当前财付通商户权限密钥 Key """</span></span><br><span class="line">        <span class="keyword">return</span> self.__partnerkey</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">paysignkey</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">""" 获取商户签名密钥 Key """</span></span><br><span class="line">        <span class="keyword">return</span> self.__paysignkey</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">grant_access_token</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        获取 access token 并更新当前配置</span></span><br><span class="line"><span class="string">        :return: 返回的 JSON 数据包 (传入 access_token_refreshfunc 参数后返回 None)</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        self._check_appid_appsecret()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> callable(self.__access_token_refreshfunc):</span><br><span class="line">            self.__access_token, self.__access_token_expires_at = self.__access_token_refreshfunc()</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        response_json = self.__request.get(</span><br><span class="line">            url=<span class="string">"https://api.weixin.qq.com/cgi-bin/token"</span>,</span><br><span class="line">            params=&#123;</span><br><span class="line">                <span class="string">"grant_type"</span>: <span class="string">"client_credential"</span>,</span><br><span class="line">                <span class="string">"appid"</span>: self.__appid,</span><br><span class="line">                <span class="string">"secret"</span>: self.__appsecret,</span><br><span class="line">            &#125;,</span><br><span class="line">            access_token=self.__access_token</span><br><span class="line">        )</span><br><span class="line">        self.__access_token = response_json[<span class="string">'access_token'</span>]</span><br><span class="line">        self.__access_token_expires_at = int(time.time()) + response_json[<span class="string">'expires_in'</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> callable(self.__access_token_setfunc):</span><br><span class="line">            self.__access_token_setfunc(self.__access_token, self.__access_token_expires_at)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> response_json</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">grant_jsapi_ticket</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        获取 jsapi ticket 并更新当前配置</span></span><br><span class="line"><span class="string">        :return: 返回的 JSON 数据包 (传入 jsapi_ticket_refreshfunc 参数后返回 None)</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        self._check_appid_appsecret()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> callable(self.__jsapi_ticket_refreshfunc):</span><br><span class="line">            self.__jsapi_ticket, self.__jsapi_ticket_expires_at = self.__jsapi_ticket_refreshfunc()</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        response_json = self.__request.get(</span><br><span class="line">            url=<span class="string">"https://api.weixin.qq.com/cgi-bin/ticket/getticket"</span>,</span><br><span class="line">            params=&#123;</span><br><span class="line">                <span class="string">"type"</span>: <span class="string">"jsapi"</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">            access_token=self.access_token,</span><br><span class="line">        )</span><br><span class="line">        self.__jsapi_ticket = response_json[<span class="string">'ticket'</span>]</span><br><span class="line">        self.__jsapi_ticket_expires_at = int(time.time()) + response_json[<span class="string">'expires_in'</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> callable(self.__jsapi_ticket_setfunc):</span><br><span class="line">            self.__jsapi_ticket_setfunc(self.__jsapi_ticket, self.__jsapi_ticket_expires_at)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> response_json</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_access_token</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        获取 Access Token 及 Access Token 过期日期, 仅供缓存使用, 如果希望得到原生的 Access Token 请求数据请使用 :func:`grant_token`</span></span><br><span class="line"><span class="string">        **仅为兼容 v0.6.0 以前版本使用, 自行维护 access_token 请使用 access_token_setfunc 和 access_token_getfunc 进行操作**</span></span><br><span class="line"><span class="string">        :return: dict 对象, key 包括 `access_token` 及 `access_token_expires_at`</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        self._check_appid_appsecret()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">'access_token'</span>: self.access_token,</span><br><span class="line">            <span class="string">'access_token_expires_at'</span>: self.__access_token_expires_at,</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_jsapi_ticket</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        获取 Jsapi Ticket 及 Jsapi Ticket 过期日期, 仅供缓存使用, 如果希望得到原生的 Jsapi Ticket 请求数据请使用 :func:`grant_jsapi_ticket`</span></span><br><span class="line"><span class="string">        **仅为兼容 v0.6.0 以前版本使用, 自行维护 jsapi_ticket 请使用 jsapi_ticket_setfunc 和 jsapi_ticket_getfunc 进行操作**</span></span><br><span class="line"><span class="string">        :return: dict 对象, key 包括 `jsapi_ticket` 及 `jsapi_ticket_expires_at`</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        self._check_appid_appsecret()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">'jsapi_ticket'</span>: self.jsapi_ticket,</span><br><span class="line">            <span class="string">'jsapi_ticket_expires_at'</span>: self.__jsapi_ticket_expires_at,</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_check_token</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        检查 Token 是否存在</span></span><br><span class="line"><span class="string">        :raises NeedParamError: Token 参数没有在初始化的时候提供</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.__token:</span><br><span class="line">            <span class="keyword">raise</span> NeedParamError(<span class="string">'Please provide Token parameter in the construction of class.'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_check_appid_appsecret</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        检查 AppID 和 AppSecret 是否存在</span></span><br><span class="line"><span class="string">        :raises NeedParamError: AppID 或 AppSecret 参数没有在初始化的时候完整提供</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.__appid <span class="keyword">or</span> <span class="keyword">not</span> self.__appsecret:</span><br><span class="line">            <span class="keyword">raise</span> NeedParamError(<span class="string">'Please provide app_id and app_secret parameters in the construction of class.'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_update_crypto</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        根据当前配置内容更新 Crypto 类</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">if</span> self.__encrypt_mode <span class="keyword">in</span> [<span class="string">'compatible'</span>, <span class="string">'safe'</span>] <span class="keyword">and</span> self.__encoding_aes_key <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">if</span> self.__token <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> self.__appid <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">raise</span> NeedParamError(<span class="string">'Please provide token and appid parameters in the construction of class.'</span>)</span><br><span class="line">            self.__crypto = BasicCrypto(self.__token, self.__encoding_aes_key, self.__appid)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.__crypto = <span class="literal">None</span></span><br></pre></td></tr></table></figure><h2 id="思维锻炼"><a href="#思维锻炼" class="headerlink" title="思维锻炼"></a>思维锻炼</h2><ol><li>设计讲师和学生类，讲师有上课，备课等方法，学生有听课，做练习等方法，均有姓名、性别、年龄等基本属性</li><li>设计聊天Message类</li></ol><h1 id="with与“上下文管理器”"><a href="#with与“上下文管理器”" class="headerlink" title="with与“上下文管理器”"></a>with与“上下文管理器”</h1><p>如果你有阅读源码的习惯，可能会看到一些优秀的代码经常出现带有 “with” 关键字的语句，它通常用在什么场景呢？</p><p>对于系统资源如文件、数据库连接、socket 而言，应用程序打开这些资源并执行完业务逻辑之后，必须做的一件事就是要关闭（断开）该资源。</p><p>比如 Python 程序打开一个文件，往文件中写内容，写完之后，就要关闭该文件，否则会出现什么情况呢？极端情况下会出现 “Too many open files” 的错误，因为系统允许你打开的最大文件数量是有限的。</p><p>同样，对于数据库，如果连接数过多而没有及时关闭的话，就可能会出现 “Can not connect to MySQL server Too many connections”，因为数据库连接是一种非常昂贵的资源，不可能无限制的被创建。</p><p>来看看如何正确关闭一个文件。</p><h2 id="1-普通版"><a href="#1-普通版" class="headerlink" title="1. 普通版"></a>1. 普通版</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">m1</span><span class="params">()</span>:</span></span><br><span class="line">    f = open(<span class="string">"output.txt"</span>, <span class="string">"w"</span>)</span><br><span class="line">    f.write(<span class="string">"python之禅"</span>)</span><br><span class="line">    f.close()</span><br></pre></td></tr></table></figure><p>这样写有一个潜在的问题，如果在调用 write 的过程中，出现了异常进而导致后续代码无法继续执行，close 方法无法被正常调用，因此资源就会一直被该程序占用者释放。那么该如何改进代码呢？</p><h2 id="2-进阶版"><a href="#2-进阶版" class="headerlink" title="2. 进阶版"></a>2. 进阶版</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">m2</span><span class="params">()</span>:</span></span><br><span class="line">    f = open(<span class="string">"output.txt"</span>, <span class="string">"w"</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        f.write(<span class="string">"python之禅"</span>)</span><br><span class="line">    <span class="keyword">except</span> IOError:</span><br><span class="line">        print(<span class="string">"oops error"</span>)</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        f.close()</span><br></pre></td></tr></table></figure><p>改良版本的程序是对可能发生异常的代码处进行 try 捕获，使用 try/finally 语句，该语句表示如果在 try 代码块中程序出现了异常，后续代码就不再执行，而直接跳转到 except 代码块。而无论如何，finally 块的代码最终都会被执行。因此，只要把 close 放在 finally 代码中，文件就一定会关闭。</p><h2 id="3-高级版"><a href="#3-高级版" class="headerlink" title="3. 高级版"></a>3. 高级版</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">m3</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">"output.txt"</span>, <span class="string">"r"</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="string">"Python之禅"</span>)</span><br></pre></td></tr></table></figure><p>一种更加简洁、优雅的方式就是用 with 关键字。open 方法的返回值赋值给变量 f，当离开 with 代码块的时候，系统会自动调用 f.close() 方法， with 的作用和使用 try/finally 语句是一样的。那么它的实现原理是什么？在讲 with 的原理前要涉及到另外一个概念，就是上下文管理器（Context Manager）。</p><h2 id="什么是上下文-context"><a href="#什么是上下文-context" class="headerlink" title="什么是上下文(context)"></a>什么是上下文(context)</h2><blockquote><p>上下文在不同的地方表示不同的含义，要感性理解。context其实说白了，和文章的上下文是一个意思，在通俗一点，我觉得叫环境更好。….</p><p>林冲大叫一声“啊也！”….</p><p>问:这句话林冲的“啊也”表达了林冲怎样的心里？</p><p>答:啊你妈个头啊！</p><p>看，一篇文章，给你摘录一段，没前没后，你读不懂，因为有语境，就是语言环境存在，一段话说了什么，要通过上下文(文章的上下文)来推断。</p><p>app点击一个按钮进入一个新的界面，也要保存你是在哪个屏幕跳过来的等等信息，以便你点击返回的时候能正确跳回，如果不存肯定就无法正确跳回了。</p><p>看这些都是上下文的典型例子，理解成环境就可以，(而且上下文虽然叫上下文，但是程序里面一般都只有上文而已，只是叫的好听叫上下文。。进程中断在操作系统中是有上有下的，不过不这个高深的问题就不要深究了。。。)</p></blockquote><h2 id="上下文管理器"><a href="#上下文管理器" class="headerlink" title="上下文管理器"></a>上下文管理器</h2><p>任何实现了 <code>__enter__()</code> 和 <code>__exit__()</code> 方法的对象都可称之为上下文管理器，上下文管理器对象可以使用 with 关键字。显然，文件（file）对象也实现了上下文管理器。</p><p>那么文件对象是如何实现这两个方法的呢？我们可以模拟实现一个自己的文件类，让该类实现 <code>__enter__()</code> 和 <code>__exit__()</code> 方法。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span><span class="params">()</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, filename, mode)</span>:</span></span><br><span class="line">        self.filename = filename</span><br><span class="line">        self.mode = mode</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__enter__</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"entering"</span>)</span><br><span class="line">        self.f = open(self.filename, self.mode)</span><br><span class="line">        <span class="keyword">return</span> self.f</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__exit__</span><span class="params">(self, *args)</span>:</span></span><br><span class="line">        print(<span class="string">"will exit"</span>)</span><br><span class="line">        self.f.close()</span><br></pre></td></tr></table></figure><p><code>__enter__()</code> 方法返回资源对象，这里就是你将要打开的那个文件对象，<code>__exit__()</code> 方法处理一些清除工作。</p><p>因为 File 类实现了上下文管理器，现在就可以使用 with 语句了。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> File(<span class="string">'out.txt'</span>, <span class="string">'w'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    print(<span class="string">"writing"</span>)</span><br><span class="line">    f.write(<span class="string">'hello, python'</span>)</span><br></pre></td></tr></table></figure><p>这样，你就无需显示地调用 close 方法了，由系统自动去调用，哪怕中间遇到异常 close 方法也会被调用。</p><h2 id="实现上下文管理器的另外方式"><a href="#实现上下文管理器的另外方式" class="headerlink" title="实现上下文管理器的另外方式"></a>实现上下文管理器的另外方式</h2><p>Python 还提供了一个 contextmanager 的装饰器，更进一步简化了上下文管理器的实现方式。通过 yield 将函数分割成两部分，yield 之前的语句在 <strong>enter</strong> 方法中执行，yield 之后的语句在 <strong>exit</strong> 方法中执行。紧跟在 yield 后面的值是函数的返回值。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> contextlib <span class="keyword">import</span> contextmanager</span><br><span class="line"></span><br><span class="line"><span class="meta">@contextmanager</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_open</span><span class="params">(path, mode)</span>:</span></span><br><span class="line">    f = open(path, mode)</span><br><span class="line">    <span class="keyword">yield</span> f</span><br><span class="line">    f.close()</span><br></pre></td></tr></table></figure><p>调用<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> my_open(<span class="string">'out.txt'</span>, <span class="string">'w'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">"hello , the simplest context manager"</span>)</span><br></pre></td></tr></table></figure><p></p><h2 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h2><p>Python 提供了 with 语法用于简化资源操作的后续清除操作，是 try/finally 的替代方法，实现原理建立在上下文管理器之上。此外，Python 还提供了一个 contextmanager 装饰器，更进一步简化上下管理器的实现方式。</p><h1 id="※args、※※kwargs的另外用处拆包"><a href="#※args、※※kwargs的另外用处拆包" class="headerlink" title="※args、※※kwargs的另外用处拆包"></a>※args、※※kwargs的另外用处拆包</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test1</span><span class="params">(a,b,*args,**kwargs)</span>:</span></span><br><span class="line">    print(a)</span><br><span class="line">    print(b)</span><br><span class="line">    print(args) <span class="comment"># 以元组形式输出结果</span></span><br><span class="line">    print(kwargs) <span class="comment"># 以字典形式输出结果</span></span><br><span class="line"></span><br><span class="line">test1(<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">44</span>,<span class="number">55</span>,name=<span class="string">'haha'</span>,age=<span class="number">34</span>)</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">输出结果</span></span><br><span class="line"><span class="string">11</span></span><br><span class="line"><span class="string">22</span></span><br><span class="line"><span class="string">(33, 44, 55)</span></span><br><span class="line"><span class="string">&#123;'name': 'haha', 'age': 34&#125;</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test2</span><span class="params">(a,b,*args,**kwargs)</span>:</span></span><br><span class="line">    print(a)</span><br><span class="line">    print(b)</span><br><span class="line">    print(args) <span class="comment"># 以元组形式输出结果</span></span><br><span class="line">    print(kwargs) <span class="comment"># 以字典形式输出结果</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test1</span><span class="params">(a,b,*args,**kwargs)</span>:</span></span><br><span class="line">    print(a)</span><br><span class="line">    print(b)</span><br><span class="line">    print(args) <span class="comment"># 以元组形式输出结果</span></span><br><span class="line">    print(kwargs) <span class="comment"># 以字典形式输出结果</span></span><br><span class="line">    print(<span class="string">'---'</span> * <span class="number">10</span>)</span><br><span class="line">    test2(a,b)</span><br><span class="line"></span><br><span class="line">test1(<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">44</span>,<span class="number">55</span>,name=<span class="string">'haha'</span>,age=<span class="number">34</span>)</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">11</span></span><br><span class="line"><span class="string">22</span></span><br><span class="line"><span class="string">(33, 44, 55)</span></span><br><span class="line"><span class="string">&#123;'name': 'haha', 'age': 34&#125;</span></span><br><span class="line"><span class="string">`------------------------------`</span></span><br><span class="line"><span class="string">11</span></span><br><span class="line"><span class="string">22</span></span><br><span class="line"><span class="string">()</span></span><br><span class="line"><span class="string">&#123;&#125;</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test2</span><span class="params">(a,b,*args,**kwargs)</span>:</span></span><br><span class="line">    print(a)</span><br><span class="line">    print(b)</span><br><span class="line">    print(args) <span class="comment"># 以元组形式输出结果</span></span><br><span class="line">    print(kwargs) <span class="comment"># 以字典形式输出结果</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test1</span><span class="params">(a,b,*args,**kwargs)</span>:</span></span><br><span class="line">    print(a)</span><br><span class="line">    print(b)</span><br><span class="line">    print(args) <span class="comment"># 以元组形式输出结果</span></span><br><span class="line">    print(kwargs) <span class="comment"># 以字典形式输出结果</span></span><br><span class="line">    print(<span class="string">'---'</span> * <span class="number">10</span>)</span><br><span class="line">    test2(a,b,args,kwargs) <span class="comment"># 相当于test2(11,22,(33, 44, 55),&#123;'name': 'haha', 'age': 34&#125;)</span></span><br><span class="line">    <span class="comment"># 注意这样写的结果如下：((33, 44, 55), &#123;'name': 'haha', 'age': 34&#125;)</span></span><br><span class="line">    <span class="comment"># 为什么会是这样的一个结果呢？</span></span><br><span class="line">    <span class="comment"># 是因为在函数test1中，args和kwargs已经是一个变量值了，然后传递给test2函数，被*args接收过去。</span></span><br><span class="line"></span><br><span class="line">test1(<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">44</span>,<span class="number">55</span>,name=<span class="string">'haha'</span>,age=<span class="number">34</span>)</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">11</span></span><br><span class="line"><span class="string">22</span></span><br><span class="line"><span class="string">(33, 44, 55)</span></span><br><span class="line"><span class="string">&#123;'name': 'haha', 'age': 34&#125;</span></span><br><span class="line"><span class="string">`------------------------------`</span></span><br><span class="line"><span class="string">11</span></span><br><span class="line"><span class="string">22</span></span><br><span class="line"><span class="string">((33, 44, 55), &#123;'name': 'haha', 'age': 34&#125;)</span></span><br><span class="line"><span class="string">&#123;&#125;</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test2</span><span class="params">(a,b,*args,**kwargs)</span>:</span></span><br><span class="line">    print(a)</span><br><span class="line">    print(b)</span><br><span class="line">    print(args) <span class="comment"># 以元组形式输出结果</span></span><br><span class="line">    print(kwargs) <span class="comment"># 以字典形式输出结果</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test1</span><span class="params">(a,b,*args,**kwargs)</span>:</span></span><br><span class="line">    print(a)</span><br><span class="line">    print(b)</span><br><span class="line">    print(args) <span class="comment"># 以元组形式输出结果</span></span><br><span class="line">    print(kwargs) <span class="comment"># 以字典形式输出结果</span></span><br><span class="line">    print(<span class="string">'---'</span> * <span class="number">10</span>)</span><br><span class="line">    <span class="comment"># test2(a,b,args,kwargs)  # 相当于test2(11,22,(33, 44, 55),&#123;'name': 'haha', 'age': 34&#125;)</span></span><br><span class="line">    <span class="comment"># test2(a,b,*args,kwargs) # 相当于test2(11,22,33,44,55,&#123;'name': 'haha', 'age': 34&#125;)</span></span><br><span class="line">    test2(a,b,*args,**kwargs) <span class="comment"># 注意这样的写法，相当于test2(11,22,33,44,55,name='haha',age=34)</span></span><br><span class="line">    <span class="comment"># 结果是：</span></span><br><span class="line">    <span class="comment"># (33, 44, 55)</span></span><br><span class="line">    <span class="comment"># &#123;'name': 'haha', 'age': 34&#125;</span></span><br><span class="line"></span><br><span class="line">test1(<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">44</span>,<span class="number">55</span>,name=<span class="string">'haha'</span>,age=<span class="number">34</span>)</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">11</span></span><br><span class="line"><span class="string">22</span></span><br><span class="line"><span class="string">(33, 44, 55)</span></span><br><span class="line"><span class="string">&#123;'name': 'haha', 'age': 34&#125;</span></span><br><span class="line"><span class="string">`------------------------------`</span></span><br><span class="line"><span class="string">11</span></span><br><span class="line"><span class="string">22</span></span><br><span class="line"><span class="string">(33, 44, 55)</span></span><br><span class="line"><span class="string">&#123;'name': 'haha', 'age': 34&#125;</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束 <i class="fa fa-paw"></i> 感谢您的阅读-------------</div></div></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>如果觉得我的文章对您有用,请随意打赏.您的支持将鼓励我继续创作!</div><br><button id="rewardButton" disable="enable" onclick='var e=document.getElementById("QR");"none"===e.style.display?e.style.display="block":e.style.display="none"'><span>打赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"><img id="wechat_qr" src="/img/wechat.jpg" alt="永夜初晗凝碧天 微信支付"><p>微信支付</p></div><div id="alipay" style="display:inline-block"><img id="alipay_qr" src="/img/alipay.jpg" alt="永夜初晗凝碧天 支付宝"><p>支付宝</p></div></div></div></div><div><div class="post-copyright"><li class="post-copyright-title"><strong>本文标题：</strong> python_扩展知识点</li><li class="post-copyright-author"><strong>文章作者：</strong> 永夜初晗凝碧天</li><li class="post-copyright-author"><strong>发布时间：</strong> 2019年12月31日 - 12:12:26</li><li class="post-copyright-author"><strong>更新时间：</strong> 2019年12月31日 - 12:12:26</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="/2019/12/31/python_扩展知识点/" title="python_扩展知识点">https://yongnights.github.io/2019/12/31/python_扩展知识点/</a> <span class="copy-path" title="点击复制文章链接"><i class="fa fa-clipboard" data-clipboard-text="https://yongnights.github.io/2019/12/31/python_扩展知识点/" aria-label="复制成功！"></i></span></li><li class="post-copyright-license"><strong>版权声明： </strong><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</li></div><script>var clipboard=new Clipboard(".fa-clipboard");$(".fa-clipboard").click(function(){clipboard.on("success",function(){swal({title:"",text:"复制成功",icon:"success",showConfirmButton:!0})})})</script></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Python/" rel="tag"><i class="fa fa-tag"></i> Python</a></div><div class="post-widgets"><div id="needsharebutton-postbottom"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2019/12/31/python_异常/" rel="next" title="python_异常"><i class="fa fa-chevron-left"></i> python_异常</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/2019/12/31/python_模块和包/" rel="prev" title="python_模块和包">python_模块和包 <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"><div class="jiathis_style"><span class="jiathis_txt">分享到：</span> <a class="jiathis_button_fav">收藏夹</a> <a class="jiathis_button_copy">复制网址</a> <a class="jiathis_button_email">邮件</a> <a class="jiathis_button_weixin">微信</a> <a class="jiathis_button_qzone">QQ空间</a> <a class="jiathis_button_tqq">腾讯微博</a> <a class="jiathis_button_douban">豆瓣</a> <a class="jiathis_button_share">一键分享</a> <a href="http://www.jiathis.com/share?uid=2140465" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a> <a class="jiathis_counter_style"></a></div><script type="text/javascript">var jiathis_config={data_track_clickback:!0,summary:"",shortUrl:!1,hideMore:!1}</script><script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=" charset="utf-8"></script></div></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/img/avatar.png" alt="永夜初晗凝碧天"><p class="site-author-name" itemprop="name">永夜初晗凝碧天</p><p class="site-description motion-element" itemprop="description">Linux,Python,MySQL,ELK Stack,K8S,Docker</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">134</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">52</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">58</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="tencent://message/?Menu=yes&uin=1103324414" target="_blank" title="QQ"><i class="fa fa-fw fa-qq"></i>QQ</a> </span><span class="links-of-author-item"><a href="mailto:sandu12345@msn.cn" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i>E-Mail</a></span></div><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1333220817&auto=0&height=66"></iframe><div class="links-of-blogroll motion-element links-of-blogroll-inline"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> 友情链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="http://www.cnblogs.com/sanduzxcvbnm/" title="博客园" target="_blank">博客园</a></li><li class="links-of-blogroll-item"><a href="https://www.baidu.com/" title="百度" target="_blank">百度</a></li></ul></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-history fa-" aria-hidden="true"></i> 近期文章</div><ul class="links-of-blogroll-list"><li><a href="/2020/04/14/EFK-5：ES集群开启用户认证 /" title="EFK-5 ES集群开启用户认证" target="_blank">EFK-5 ES集群开启用户认证</a></li><li><a href="/2020/04/14/EFK-4：ElasticSearch集群TLS加密通讯 /" title="EFK-4 ElasticSearch集群TLS加密通讯" target="_blank">EFK-4 ElasticSearch集群TLS加密通讯</a></li><li><a href="/2020/04/14/EFK-3： ES多实例部署 /" title="EFK-3 ES多实例部署" target="_blank">EFK-3 ES多实例部署</a></li><li><a href="/2020/04/14/EFK-2：ElasticSearch高性能高可用架构/" title="EFK-2 ElasticSearch高性能高可用架构" target="_blank">EFK-2 ElasticSearch高性能高可用架构</a></li><li><a href="/2020/04/14/EFK-1：快速指南/" title="EFK-1 快速指南" target="_blank">EFK-1 快速指南</a></li></ul></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#GIL（全局解释器锁）"><span class="nav-text">GIL（全局解释器锁）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#GIL面试题如下"><span class="nav-text">GIL面试题如下</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#单线程死循环"><span class="nav-text">单线程死循环</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#两个线程死循环"><span class="nav-text">两个线程死循环</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#两个进程死循环"><span class="nav-text">两个进程死循环</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考答案"><span class="nav-text">参考答案</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用c语言来解决GIL问题"><span class="nav-text">使用c语言来解决GIL问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#如何解决GIL"><span class="nav-text">如何解决GIL</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#深拷贝、浅拷贝"><span class="nav-text">深拷贝、浅拷贝</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-浅拷贝"><span class="nav-text">1. 浅拷贝</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-深拷贝"><span class="nav-text">2. 深拷贝</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#进一步理解深拷贝"><span class="nav-text">进一步理解深拷贝</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-拷贝的其他方式"><span class="nav-text">3. 拷贝的其他方式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-注意点"><span class="nav-text">4. 注意点</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#浅拷贝对不可变类型和可变类型的copy不同"><span class="nav-text">浅拷贝对不可变类型和可变类型的copy不同</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#copy-copy和copy-deepcopy的区别"><span class="nav-text">copy.copy和copy.deepcopy的区别</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#私有化"><span class="nav-text">私有化</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#import导入模块"><span class="nav-text">import导入模块</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-import-搜索路径"><span class="nav-text">1. import 搜索路径</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#路径搜索"><span class="nav-text">路径搜索</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#程序执行时添加新的模块路径"><span class="nav-text">程序执行时添加新的模块路径</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-重新导入模块"><span class="nav-text">2. 重新导入模块</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-多模块开发时的注意点"><span class="nav-text">3. 多模块开发时的注意点</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#再议-封装、继承、多态"><span class="nav-text">再议 封装、继承、多态</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#为啥要封装"><span class="nav-text">为啥要封装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#好处"><span class="nav-text">好处</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#为啥要继承"><span class="nav-text">为啥要继承</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#说明"><span class="nav-text">说明</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#怎样理解多态"><span class="nav-text">怎样理解多态</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#多继承以及MRO顺序"><span class="nav-text">多继承以及MRO顺序</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-单独调用父类的方法"><span class="nav-text">1. 单独调用父类的方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-多继承中super调用有所父类的被重写的方法"><span class="nav-text">2. 多继承中super调用有所父类的被重写的方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-单继承中super"><span class="nav-text">3. 单继承中super</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#总结"><span class="nav-text">总结</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#小试牛刀-以下为面试题"><span class="nav-text">小试牛刀(以下为面试题)</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#再论静态方法和类方法"><span class="nav-text">再论静态方法和类方法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-类属性、实例属性"><span class="nav-text">1. 类属性、实例属性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-实例方法、静态方法和类方法"><span class="nav-text">2. 实例方法、静态方法和类方法</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#property属性"><span class="nav-text">property属性</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-什么是property属性"><span class="nav-text">1. 什么是property属性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-简单的实例"><span class="nav-text">2. 简单的实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-property属性的有两种方式"><span class="nav-text">3. property属性的有两种方式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-装饰器方式"><span class="nav-text">3.1 装饰器方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-1经典类，具有一种-property装饰器"><span class="nav-text">3.1.1经典类，具有一种@property装饰器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-2-新式类，具有三种-property装饰器"><span class="nav-text">3.1.2 新式类，具有三种@property装饰器</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-类属性方式"><span class="nav-text">3.2 类属性方式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-Django框架中应用了property属性（了解）"><span class="nav-text">4. Django框架中应用了property属性（了解）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-总结"><span class="nav-text">5. 总结</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#property属性-应用"><span class="nav-text">property属性-应用</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-私有属性添加getter和setter方法"><span class="nav-text">1. 私有属性添加getter和setter方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-使用property升级getter和setter方法"><span class="nav-text">2. 使用property升级getter和setter方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-使用property取代getter和setter方法"><span class="nav-text">3. 使用property取代getter和setter方法</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#魔法属性"><span class="nav-text">魔法属性</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-doc"><span class="nav-text">1. __doc__</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-module-和-class"><span class="nav-text">2. __module__ 和 __class__</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-init"><span class="nav-text">3. __init__</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-del"><span class="nav-text">4. __del__</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-call"><span class="nav-text">5. __call__</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-dict"><span class="nav-text">6. __dict__</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-str"><span class="nav-text">7. __str__</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8、-getitem-、-setitem-、-delitem"><span class="nav-text">8、__getitem__、__setitem__、__delitem__</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9、-getslice-、-setslice-、-delslice"><span class="nav-text">9、__getslice__、__setslice__、__delslice__</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#面向对象设计"><span class="nav-text">面向对象设计</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#参考实例"><span class="nav-text">参考实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#微信开发包，python实现-wechat-sdk开发"><span class="nav-text">微信开发包，python实现, wechat_sdk开发</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#思维锻炼"><span class="nav-text">思维锻炼</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#with与“上下文管理器”"><span class="nav-text">with与“上下文管理器”</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-普通版"><span class="nav-text">1. 普通版</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-进阶版"><span class="nav-text">2. 进阶版</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-高级版"><span class="nav-text">3. 高级版</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#什么是上下文-context"><span class="nav-text">什么是上下文(context)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#上下文管理器"><span class="nav-text">上下文管理器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实现上下文管理器的另外方式"><span class="nav-text">实现上下文管理器的另外方式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#总结-1"><span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#※args、※※kwargs的另外用处拆包"><span class="nav-text">※args、※※kwargs的另外用处拆包</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; 2019 &mdash; <span itemprop="copyrightYear">2020</span> <span class="with-love"><i class="fa fa-star"></i> </span><span class="author" itemprop="copyrightHolder">永夜初晗凝碧天</span><br></div><div><span class="post-meta-item-icon"><i class="fa fa-area-chart"></i> </span><span class="post-meta-item-text">博客全站字数统计 </span><span title="博客全站字数统计">: 399.2k 字</span> <span class="post-meta-divider">||</span><span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span><script>function createtime(){var n=new Date("03/01/2019 00:00:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="博客已运行 "+dnum+" 天 ",document.getElementById("times").innerHTML=hnum+" 小时 "+mnum+" 分钟 "+snum+" 秒"}var now=new Date;setInterval("createtime()",250)</script></div><div class="busuanzi-count"><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i> 本文总阅读量<span id="busuanzi_value_page_pv"></span>次 </span><span class="post-meta-divider">||</span> <span id="busuanzi_container_site_uv"><i class="fa fa-user"></i> 本站访客数<span id="busuanzi_value_site_uv"></span>人次 </span><span class="post-meta-divider">||</span> <span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i> 本站总访问量<span id="busuanzi_value_site_pv"></span>次</span></div><div id="nowDate"><script type="text/javascript">window.onload=function(){function e(){var e=new Date,r=e.getFullYear(),u=e.getMonth()+1,a=e.getDate(),g=e.getDay(),i=e.getHours(),c=e.getMinutes(),d=e.getSeconds(),l="当前时间是："+r+"年"+u+"月"+a+"日 "+t(g)+" "+n(i)+":"+n(c)+":"+n(d);o.innerHTML=l}function t(e){return 0==e?"星期日":1==e?"星期一":2==e?"星期二":3==e?"星期三":4==e?"星期四":5==e?"星期五":"星期六"}function n(e){return e<10?"0"+e:e}var o=document.getElementById("nowDate");e(),setInterval(e,1e3)}</script></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div><div id="needsharebutton-float"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><script type="text/javascript">function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")},searchFunc=function(t,e,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,r=document.getElementById(e),s=document.getElementById(o),a=function(){var t=r.value.trim().toLowerCase(),e=t.split(/[\s\-]+/);e.length>1&&e.push(t);var o=[];if(t.length>0&&n.forEach(function(n){function r(e,o,n,r){for(var s=r[r.length-1],a=s.position,i=s.word,l=[],h=0;a+i.length<=n&&0!=r.length;){i===t&&h++,l.push({position:a,length:i.length});var p=a+i.length;for(r.pop();0!=r.length&&(s=r[r.length-1],a=s.position,i=s.word,p>a);)r.pop()}return c+=h,{hits:l,start:o,end:n,searchTextCount:h}}function s(t,e){var o="",n=e.start;return e.hits.forEach(function(e){o+=t.substring(n,e.position);var r=e.position+e.length;o+='<b class="search-keyword">'+t.substring(e.position,r)+"</b>",n=r}),o+=t.substring(n,e.end)}var a=!1,i=0,c=0,l=n.title.trim(),h=l.toLowerCase(),p=n.content.trim().replace(/<[^>]+>/g,""),u=p.toLowerCase(),f=decodeURIComponent(n.url),d=[],g=[];if(""!=l&&(e.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());(s=e.indexOf(t,r))>-1;)a.push({position:s,word:t}),r=s+n;return a}d=d.concat(e(t,h,!1)),g=g.concat(e(t,u,!1))}),(d.length>0||g.length>0)&&(a=!0,i=d.length+g.length)),a){[d,g].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});var v=[];0!=d.length&&v.push(r(l,0,l.length,d));for(var $=[];0!=g.length;){var C=g[g.length-1],m=C.position,x=C.word,w=m-20,y=m+80;w<0&&(w=0),y<m+x.length&&(y=m+x.length),y>p.length&&(y=p.length),$.push(r(p,w,y,g))}$.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});var T=parseInt("1");T>=0&&($=$.slice(0,T));var b="";b+=0!=v.length?"<li><a href='"+f+"' class='search-result-title'>"+s(l,v[0])+"</a>":"<li><a href='"+f+"' class='search-result-title'>"+l+"</a>",$.forEach(function(t){b+="<a href='"+f+'\'><p class="search-result">'+s(p,t)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:c,hitCount:i,id:o.length})}}),1===e.length&&""===e[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>';else{o.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id});var a='<ul class="search-result-list">';o.forEach(function(t){a+=t.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),isfetched===!1?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){var e=27===t.which&&$(".search-popup").is(":visible");e&&onPopupClose()})</script><script>!function(){var t=document.createElement("script"),s=window.location.protocol.split(":")[0];"https"===s?t.src="https://zz.bdstatic.com/linksubmit/push.js":t.src="http://push.zhanzhang.baidu.com/push.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script><link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css"><script src="/lib/needsharebutton/needsharebutton.js"></script><script>pbOptions={},pbOptions.iconStyle="box",pbOptions.boxForm="horizontal",pbOptions.position="bottomCenter",pbOptions.networks="Weibo,Wechat,Douban,QQZone",new needShareButton("#needsharebutton-postbottom",pbOptions),flOptions={},flOptions.iconStyle="box",flOptions.boxForm="horizontal",flOptions.position="middleRight",flOptions.networks="Weibo,Wechat,Douban,QQZone",new needShareButton("#needsharebutton-float",flOptions)</script><script type="text/javascript" src="/js/src/love.js"></script><canvas class="fireworks" style="position:fixed;left:0;top:0;z-index:1;pointer-events:none"></canvas><script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script><script type="text/javascript" src="/js/src/fireworks.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({log:!1,pluginJsPath:"lib/",pluginModelPath:"assets/",pluginRootPath:"live2dw/",tagMode:!1})</script></body></html><!-- rebuild by neat -->