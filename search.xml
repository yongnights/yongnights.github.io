<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Elasticsearch ç†è§£mappingä¸­çš„storeå±žæ€§]]></title>
    <url>%2F2020%2F01%2F06%2FElasticsearch%20%E7%90%86%E8%A7%A3mapping%E4%B8%AD%E7%9A%84store%E5%B1%9E%E6%80%A7%2F</url>
    <content type="text"><![CDATA[é»˜è®¤æƒ…å†µä¸‹ï¼Œå¯¹å­—æ®µå€¼è¿›è¡Œç´¢å¼•ä»¥ä½¿å…¶å¯æœç´¢ï¼Œä½†ä¸å­˜å‚¨å®ƒä»¬ (store)ã€‚ è¿™æ„å‘³ç€å¯ä»¥æŸ¥è¯¢è¯¥å­—æ®µï¼Œä½†æ˜¯æ— æ³•æ£€ç´¢åŽŸå§‹å­—æ®µå€¼ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬å¿…é¡»ç†è§£çš„ä¸€ç‚¹æ˜¯: å¦‚æžœä¸€ä¸ªå­—æ®µçš„mappingä¸­å«æœ‰storeå±žæ€§ä¸ºtrueï¼Œé‚£ä¹ˆæœ‰ä¸€ä¸ªå•ç‹¬çš„å­˜å‚¨ç©ºé—´ä¸ºè¿™ä¸ªå­—æ®µåšå­˜å‚¨ï¼Œè€Œä¸”è¿™ä¸ªå­˜å‚¨æ˜¯ç‹¬ç«‹äºŽ_sourceçš„å­˜å‚¨çš„ã€‚å®ƒå…·æœ‰æ›´å¿«çš„æŸ¥è¯¢ã€‚å­˜å‚¨è¯¥å­—æ®µä¼šå ç”¨ç£ç›˜ç©ºé—´ã€‚å¦‚æžœéœ€è¦ä»Žæ–‡æ¡£ä¸­æå–ï¼ˆå³åœ¨è„šæœ¬ä¸­å’Œèšåˆï¼‰ï¼Œå®ƒä¼šå¸®åŠ©å‡å°‘è®¡ç®—ã€‚åœ¨èšåˆæ—¶ï¼Œå…·æœ‰storeå±žæ€§çš„å­—æ®µä¼šæ¯”ä¸å…·æœ‰è¿™ä¸ªå±žæ€§çš„å­—æ®µå¿«ã€‚ æ­¤é€‰é¡¹çš„å¯èƒ½å€¼ä¸ºfalseå’Œtrueã€‚é€šå¸¸è¿™æ— å…³ç´§è¦ã€‚ è¯¥å­—æ®µå€¼å·²ç»æ˜¯_sourceå­—æ®µçš„ä¸€éƒ¨åˆ†ï¼Œé»˜è®¤æƒ…å†µä¸‹å·²å­˜å‚¨ã€‚ å¦‚æžœæ‚¨åªæƒ³æ£€ç´¢å•ä¸ªå­—æ®µæˆ–å‡ ä¸ªå­—æ®µçš„å€¼ï¼Œè€Œä¸æ˜¯æ•´ä¸ª_sourceçš„å€¼ï¼Œåˆ™å¯ä»¥ä½¿ç”¨source filteringæ¥å®žçŽ°ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå­˜å‚¨å­—æ®µå¯èƒ½å¾ˆæœ‰æ„ä¹‰ã€‚ ä¾‹å¦‚ï¼Œå¦‚æžœæ‚¨æœ‰ä¸€ä¸ªå¸¦æœ‰æ ‡é¢˜ï¼Œæ—¥æœŸå’Œå¾ˆå¤§çš„å†…å®¹å­—æ®µçš„æ–‡æ¡£ï¼Œåˆ™å¯èƒ½åªæƒ³æ£€ç´¢æ ‡é¢˜å’Œæ—¥æœŸï¼Œè€Œä¸å¿…ä»Žè¾ƒå¤§çš„_sourceå­—æ®µä¸­æå–è¿™äº›å­—æ®µã€‚æŽ¥ä¸‹æ¥æˆ‘ä»¬è¿˜æ˜¯é€šè¿‡ä¸€ä¸ªå…·ä½“çš„ä¾‹å­æ¥è§£é‡Šè¿™ä¸ªï¼Œè™½ç„¶ä¸Šé¢çš„æè¿°æœ‰ç‚¹ç»•å£ã€‚é¦–å…ˆæˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªå«åšmy_indexçš„ç´¢å¼•ï¼š123456789101112131415161718PUT my_index&#123; &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;title&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;store&quot;: true &#125;, &quot;date&quot;: &#123; &quot;type&quot;: &quot;date&quot;, &quot;store&quot;: true &#125;, &quot;content&quot;: &#123; &quot;type&quot;: &quot;text&quot; &#125; &#125; &#125;&#125;åœ¨ä¸Šé¢çš„mappingä¸­ï¼Œæˆ‘ä»¬æŠŠtitleåŠdateå­—æ®µé‡Œçš„storeå±žæ€§è®¾ç½®ä¸ºtrueï¼Œè¡¨æ˜Žæœ‰ä¸€ä¸ªå•ç‹¬çš„index fragementæ˜¯ä¸ºå®ƒä»¬è€Œé…å¤‡çš„ï¼Œå¹¶å­˜å‚¨å®ƒä»¬çš„å€¼ã€‚æˆ‘ä»¬æ¥å†™å…¥ä¸€ä¸ªæ–‡æ¡£åˆ°my_indexç´¢å¼•ä¸­ï¼š123456PUT my_index/_doc/1&#123; &quot;title&quot;: &quot;Some short title&quot;, &quot;date&quot;: &quot;2015-01-01&quot;, &quot;content&quot;: &quot;A very long content field...&quot;&#125;æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥åšä¸€ä¸ªæœç´¢ï¼š1GET my_index/_searchæ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š1234567891011121314151617181920&quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 1, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 1.0, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;my_index&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 1.0, &quot;_source&quot; : &#123; &quot;title&quot; : &quot;Some short title&quot;, &quot;date&quot; : &quot;2015-01-01&quot;, &quot;content&quot; : &quot;A very long content field...&quot; &#125; &#125; ]&#125;åœ¨ä¸Šé¢æˆ‘ä»¬å¯ä»¥åœ¨_sourceä¸­çœ‹åˆ°è¿™ä¸ªæ–‡æ¡£çš„titleï¼ŒdateåŠcontentå­—æ®µã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡source filteringçš„æ–¹æ³•æå‰æˆ‘ä»¬æƒ³è¦çš„å­—æ®µï¼š1234GET my_index/_search&#123; &quot;_source&quot;: [&quot;title&quot;, &quot;date&quot;]&#125;æ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š12345678910111213141516171819&quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 1, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 1.0, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;my_index&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 1.0, &quot;_source&quot; : &#123; &quot;date&quot; : &quot;2015-01-01&quot;, &quot;title&quot; : &quot;Some short title&quot; &#125; &#125; ]&#125;æ˜¾ç„¶ä¸Šé¢çš„ç»“æžœæ˜¾ç¤ºæˆ‘ä»¬æƒ³è¦çš„å­—æ®µdateåŠtitleæ˜¯å¯ä»¥ä»Ž_sourceé‡ŒèŽ·å–çš„ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹æ³•æ¥èŽ·å–è¿™ä¸¤ä¸ªå­—æ®µçš„å€¼ï¼š1234567GET my_index/_search&#123; &quot;stored_fields&quot;: [ &quot;title&quot;, &quot;date&quot; ]&#125;è¿”å›žçš„ç»“æžœæ˜¯ï¼š1234567891011121314151617181920212223&quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 1, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 1.0, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;my_index&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 1.0, &quot;fields&quot; : &#123; &quot;date&quot; : [ &quot;2015-01-01T00:00:00.000Z&quot; ], &quot;title&quot; : [ &quot;Some short title&quot; ] &#125; &#125; ]&#125;åœ¨ä¸Šé¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥åœ¨fieldsé‡Œæœ‰ä¸€ä¸ªdateåŠtitleçš„æ•°ç»„è¿”å›žæŸ¥è¯¢çš„ç»“æžœã€‚ä¹Ÿè®¸æˆ‘ä»¬å¾ˆå¤šäººæƒ³çŸ¥é“åˆ°åº•è¿™ä¸ªstoreåˆ°åº•æœ‰ä»€ä¹ˆç”¨é€”å‘¢ï¼Ÿå¦‚æžœéƒ½èƒ½ä»Ž_sourceé‡Œå¾—åˆ°å­—æ®µçš„å€¼ã€‚æœ‰ä¸€ç§å°±æ˜¯æˆ‘ä»¬åœ¨å¼€å¤´æˆ‘ä»¬å·²ç»è¯´æ˜Žçš„æƒ…å†µï¼šæˆ‘ä»¬æœ‰æ—¶å€™å¹¶ä¸æƒ³å­˜ä¸‹æ‰€æœ‰çš„å­—æ®µåœ¨_sourceé‡Œï¼Œå› ä¸ºè¯¥å­—æ®µçš„å†…å®¹å¾ˆå¤§ï¼Œæˆ–è€…æˆ‘ä»¬æ ¹æœ¬å°±ä¸æƒ³å­˜_sourceï¼Œä½†æ˜¯æœ‰äº›å­—æ®µï¼Œæˆ‘ä»¬è¿˜æ˜¯æƒ³è¦èŽ·å–å®ƒä»¬çš„å†…å®¹ã€‚é‚£ä¹ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨storeæ¥å®žçŽ°ã€‚æˆ‘ä»¬è¿˜æ˜¯ç”¨ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜Žã€‚é¦–å…ˆåˆ›å»ºä¸€ä¸ªå«åšmy_index1çš„ç´¢å¼•ï¼š12345678910111213141516171819202122PUT my_index1&#123; &quot;mappings&quot;: &#123; &quot;_source&quot;: &#123; &quot;enabled&quot;: false &#125;, &quot;properties&quot;: &#123; &quot;title&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;store&quot;: true &#125;, &quot;date&quot;: &#123; &quot;type&quot;: &quot;date&quot;, &quot;store&quot;: true &#125;, &quot;content&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;store&quot;: false &#125; &#125; &#125;&#125;å› ä¸ºæˆ‘ä»¬è®¤ä¸ºcontentå­—æ®µçš„å†…å®¹å¯èƒ½ä¼šå¾ˆå¤§ï¼Œé‚£ä¹ˆæˆ‘ä¸æƒ³å­˜è¿™ä¸ªå­—æ®µã€‚åœ¨ä¸Šé¢ï¼Œæˆ‘ä»¬ä¹ŸæŠŠ_sourceçš„enabledå¼€å…³è®¾ç½®ä¸ºfalseï¼Œè¡¨æ˜Žå°†ä¸å­˜å‚¨ä»»ä½•çš„sourceå­—æ®µã€‚æŽ¥ä¸‹æ¥å†™å…¥ä¸€ä¸ªæ–‡æ¡£åˆ°my_index1é‡ŒåŽ»ï¼š123456PUT my_index1/_doc/1&#123; &quot;title&quot;: &quot;Some short title&quot;, &quot;date&quot;: &quot;2015-01-01&quot;, &quot;content&quot;: &quot;A very long content field...&quot;&#125;åŒæ ·æˆ‘ä»¬æ¥åšä¸€ä¸ªæœç´¢ï¼š12345678GET my_index1/_search&#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;content&quot;: &quot;content&quot; &#125; &#125;&#125;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœç´¢çš„ç»“æžœï¼š123456789101112131415&quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 1, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 0.2876821, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;my_index1&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 0.2876821 &#125; ]&#125;åœ¨è¿™æ¬¡çš„æ˜¾ç¤ºä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰çœ‹åˆ°_sourceå­—æ®µï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬å·²ç»æŠŠå®ƒç»™disabledäº†ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹æ³•æ¥èŽ·å–é‚£äº›store å­—æ®µï¼š123456789101112GET my_index1/_search&#123; &quot;stored_fields&quot;: [ &quot;title&quot;, &quot;date&quot; ], &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;content&quot;: &quot;content&quot; &#125; &#125;&#125;è¿”å›žç»“æžœæ˜¯ï¼š1234567891011121314151617181920212223&quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 1, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 0.2876821, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;my_index1&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 0.2876821, &quot;fields&quot; : &#123; &quot;date&quot; : [ &quot;2015-01-01T00:00:00.000Z&quot; ], &quot;title&quot; : [ &quot;Some short title&quot; ] &#125; &#125; ]&#125;æˆ‘ä»¬å¯ä»¥åœ¨è¿”å›žç»“æžœé‡ŒæŸ¥çœ‹åˆ°dateåŠtitleçš„å€¼ã€‚å¯ä»¥åˆç†åœ°å­˜å‚¨å­—æ®µçš„å¦ä¸€ç§æƒ…å†µæ˜¯ï¼Œå¯¹äºŽé‚£äº›æœªå‡ºçŽ°åœ¨_sourceå­—æ®µï¼ˆä¾‹å¦‚copy_toå­—æ®µï¼‰ä¸­çš„å­—æ®µã€‚æ‚¨å¯ä»¥å‚é˜…æˆ‘çš„å¦å¤–ä¸€ç¯‡æ–‡ç« â€œå¦‚ä½•ä½¿ç”¨Elasticsearchä¸­çš„copy_toæ¥æé«˜æœç´¢æ•ˆçŽ‡â€ã€‚å¦‚æžœä½ æƒ³äº†è§£æ›´å¤šå…³äºŽElasticsearchçš„å­˜å‚¨ï¼Œå¯ä»¥é˜…è¯»æ–‡ç« â€œElasticsearchï¼šinverted indexï¼Œdoc_valuesåŠsourceâ€ã€‚å‚è€ƒï¼šhttps://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-store.htmlhttps://stackoverflow.com/questions/17103047/why-do-i-need-storeyes-in-elasticsearchç‰ˆæƒå£°æ˜Žï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€ŒElastic ä¸­å›½ç¤¾åŒºå®˜æ–¹åšå®¢ã€çš„åŽŸåˆ›æ–‡ç« ï¼Œéµå¾ª CC 4.0 BY-SA ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŽŸæ–‡å‡ºå¤„é“¾æŽ¥åŠæœ¬å£°æ˜Žã€‚åŽŸæ–‡é“¾æŽ¥ï¼šhttps://blog.csdn.net/UbuntuTouch/article/details/103810863]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticï¼šä½¿ç”¨ElastAlertå‘é€é€šçŸ¥]]></title>
    <url>%2F2020%2F01%2F06%2FElastic%EF%BC%9A%E4%BD%BF%E7%94%A8ElastAlert%E5%8F%91%E9%80%81%E9%80%9A%E7%9F%A5%2F</url>
    <content type="text"><![CDATA[ElastAlertæ˜¯ä¸€ä¸ªç®€å•çš„æ¡†æž¶ï¼Œç”¨äºŽä»ŽElasticsearchä¸­çš„æ•°æ®ä¸­å‘å‡ºå¼‚å¸¸ï¼Œå°–å³°æˆ–å…¶ä»–æ„Ÿå…´è¶£æ¨¡å¼çš„è­¦æŠ¥ã€‚æˆ‘ä»¬å¯ä»¥åœ¨åœ°å€https://elastalert.readthedocs.io/en/latest/elastalert.htmlæ‰¾åˆ°å®ƒçš„ä½¿ç”¨è¯´æ˜Žã€‚åœ¨ä»Šå¤©çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†ä¸€æ­¥ä¸€æ­¥åœ°ä»‹ç»å¦‚ä½•æ­é…çŽ¯å¢ƒï¼Œå¹¶ä»ŽElasticsearchå‘é€é€šçŸ¥ç»™Slackã€‚ä¸ºäº†è¯´æ˜Žé—®é¢˜çš„æ–¹ä¾¿ï¼Œæˆ‘çš„çŽ¯å¢ƒå¦‚ä¸‹ï¼šåœ¨æˆ‘çš„çŽ¯å¢ƒä¸­ï¼Œæˆ‘ä½¿ç”¨iMacç”µè„‘è¿è¡ŒElasticsearchåŠKibanaï¼Œè€Œåœ¨å¦å¤–ä¸€ä¸ªè™šæ‹Ÿæœºä¸Šè¿è¡Œæˆ‘ä»¬çš„filebeatã€‚filebeatæŠŠUbuntuæœºå™¨é‡Œçš„syslogä¼ å…¥åˆ°Elasticsearchä¸­ä¾›åˆ†æžï¼ŒåŒæ—¶ElastAlertå‘¨æœŸæ€§åœ°ä»ŽElasticsearchä¸­èŽ·å–æ•°æ®ï¼Œå¹¶ä¾æ®åˆ¶å®šçš„è§„åˆ™æ¥å‘é€é€šçŸ¥ã€‚å‡†å¤‡å·¥ä½œåˆ›å»ºSlackè´¦å·æˆ‘ä»¬é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªè‡ªå·±çš„Slackè´¦å·ï¼Œå¹¶å…·æœ‰è‡ªå·±çš„ç®¡ç†å‘˜æƒé™ã€‚ä½ å¯ä»¥å‚è€ƒé“¾æŽ¥ â€œConfiguring Slack Accountâ€æ¥é…ç½®è‡ªå·±çš„Slackè´¦å·ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªç›¸åº”çš„ä¸€ä¸ªWebhook URLã€‚è¿™ä¸ªURLå°†ä¼šåœ¨Elasticsearché‡Œè¿›è¡Œä½¿ç”¨ã€‚æˆ‘ä»¬å…ˆæŠŠä¸Šé¢åˆ›å»ºçš„webhook urlè®°ä¸‹æ¥ä¾›ä¸‹é¢çš„é…ç½®ä½¿ç”¨ã€‚å®‰è£…Elasticsearchæˆ‘ä»¬å¯ä»¥æŒ‰ç…§â€œå¦‚ä½•åœ¨Linuxï¼ŒMacOSåŠWindowsä¸Šè¿›è¡Œå®‰è£…Elasticsearchâ€ä»‹ç»çš„é‚£æ ·å®‰è£…å¥½æˆ‘ä»¬çš„Elasticsearchã€‚ä¸è¿‡ç”±äºŽæˆ‘ä»¬éœ€è¦ä½¿æˆ‘ä»¬çš„Elasticsearchè¢«å¦å¤–ä¸€ä¸ªè™šæ‹Ÿæœºæ‰€è§ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬éœ€è¦å¯¹æˆ‘ä»¬çš„Elasticsearchè¿›è¡Œé…ç½®ã€‚é¦–å…ˆä½¿ç”¨ä¸€ä¸ªç¼–è¾‘å™¨æ‰“å¼€åœ¨configç›®å½•ä¸‹çš„elasticsearch.ymlé…ç½®æ–‡ä»¶ã€‚æˆ‘ä»¬éœ€è¦ä¿®æ”¹network.hostçš„IPåœ°å€ã€‚åœ¨ä½ çš„MacåŠLinuxæœºå™¨ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨:$ ifconfigæ¥æŸ¥çœ‹åˆ°æˆ‘ä»¬çš„æœºå™¨çš„IPåœ°å€ã€‚é’ˆå¯¹æˆ‘çš„æƒ…å†µï¼Œæˆ‘çš„æœºå™¨çš„IPåœ°å€æ˜¯ï¼š10.211.55.2ã€‚ç­‰ä¿®æ”¹å®Œæˆ‘ä»¬çš„IPåœ°å€åŽï¼Œæˆ‘ä»¬ä¿å­˜elasticsearch.ymlæ–‡ä»¶ã€‚ç„¶åŽé‡æ–°è¿è¡Œæˆ‘ä»¬çš„elasticsearchã€‚æˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªæµè§ˆå™¨ä¸­è¾“å…¥åˆšæ‰è¾“å…¥çš„IPåœ°å€å¹¶åŠ ä¸Šç«¯å£å·9200ã€‚è¿™æ ·å¯ä»¥æŸ¥çœ‹ä¸€ä¸‹æˆ‘ä»¬çš„elasticsearchæ˜¯å¦å·²ç»æ­£å¸¸è¿è¡Œäº†ã€‚å®‰è£…Kibanaæˆ‘ä»¬å¯ä»¥æŒ‰ç…§â€œå¦‚ä½•åœ¨Linuxï¼ŒMacOSåŠWindowsä¸Šå®‰è£…Elasticæ ˆä¸­çš„Kibanaâ€ä¸­ä»‹ç»çš„é‚£æ ·æ¥å®‰è£…æˆ‘ä»¬çš„Kibanaã€‚ç”±äºŽæˆ‘ä»¬çš„Elasticsearchçš„IPåœ°å€å·²ç»æ”¹å˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»ä¿®æ”¹æˆ‘ä»¬çš„Kibanaçš„é…ç½®æ–‡ä»¶ã€‚æˆ‘ä»¬ä½¿ç”¨è‡ªå·±å–œæ¬¢çš„ç¼–è¾‘å™¨æ‰“å¼€åœ¨configç›®å½•ä¸‹çš„kibana.ymlæ–‡ä»¶ï¼Œå¹¶æ‰¾åˆ°server.hostã€‚æŠŠå®ƒçš„å€¼ä¿®æ”¹ä¸ºè‡ªå·±çš„ç”µè„‘çš„IPåœ°å€ã€‚é’ˆå¯¹æˆ‘çš„æƒ…å†µæ˜¯ï¼šåŒæ—¶æ‰¾åˆ°elasticsearch.hostsï¼Œå¹¶æŠŠè‡ªå·±çš„IPåœ°å€è¾“å…¥è¿›åŽ»ï¼šä¿å­˜æˆ‘ä»¬çš„kibana.ymlæ–‡ä»¶ï¼Œå¹¶è¿è¡Œæˆ‘ä»¬çš„Kibanaã€‚åŒæ—¶åœ¨æµè§ˆå™¨çš„åœ°å€ä¸­è¾“å…¥è‡ªå·±çš„IPåœ°å€åŠ5601ç«¯å£ï¼šå¦‚æžœé…ç½®æˆåŠŸçš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„ç”»é¢ã€‚å®‰è£…Ubuntuè™šæ‹Ÿæœºè¿™ä¸ªä¸åœ¨æˆ‘çš„è¿™ä¸ªæ•™ç¨‹ä¹‹å†…ã€‚åœ¨ç½‘ä¸Šæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è®¸å¤šçš„æ•™ç¨‹æ•™æˆ‘ä»¬å¦‚ä½•å®‰è£…Ubuntuè™šæ‹Ÿæœºã€‚å®‰è£…filebeatæˆ‘ä»¬æƒ³åœ¨Ubuntuæœºå™¨ä¸Šå®‰è£…æˆ‘ä»¬çš„filebeatæ¥æ‰‹æœºsystem logä¿¡æ¯ã€‚æˆ‘ä»¬é¦–å…ˆæ‰“å¼€æˆ‘ä»¬çš„Kibanaã€‚ç‚¹å‡»å·¦ä¸Šè§’çš„Kibanaå›¾æ ‡ï¼šç‚¹å‡»â€œAdd log dataâ€æŒ‰é’®ï¼šç„¶åŽç‚¹å‡»â€œSystem logsâ€ç”±äºŽUbuntuæ˜¯debianç³»ç»Ÿï¼Œæˆ‘ä»¬é€‰æ‹©DEBã€‚å®‰è£…ä¸Šé¢çš„æ­¥éª¤ä¸€æ­¥ä¸€æ­¥åœ°è¿›è¡Œå®‰è£…ã€‚åœ¨é…ç½®filebeat.ymlæ—¶ï¼Œæˆ‘ä»¬éœ€è¦æŠŠæˆ‘ä»¬çš„IPåœ°å€è¾“å…¥åˆ°ç›¸åº”çš„åœ°æ–¹ï¼š123456output.elasticsearch: hosts: [&quot;http://10.211.55.2:9200&quot;] username: &quot;elastic&quot; password: &quot;123456&quot;setup.kibana: host: &quot;10.211.55.2:5601&quot;ä¸Šé¢æ˜¯æˆ‘çš„é…ç½®æƒ…å†µã€‚ä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„å®žé™…çš„IPåœ°å€è¿›è¡Œé…ç½®ã€‚å½“æˆ‘ä»¬æˆåŠŸåœ°å¯åŠ¨filebeatæœåŠ¡åŽï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥æ£€æŸ¥æˆ‘ä»¬çš„æœåŠ¡æ˜¯å¦å·²ç»æˆåŠŸè¿è¡Œï¼šsudo systemctl status filebeatå®‰è£…ElastAlertæˆ‘ä»¬å¯ä»¥å‚è€ƒé“¾æŽ¥https://elastalert.readthedocs.io/en/latest/running_elastalert.htmlæ¥å®‰è£…æˆ‘ä»¬çš„ElastAlertã€‚åœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨python3æ¥è¿è¡ŒElastAlertã€‚é¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨æˆ‘ä»¬çš„Ubuntuä¸Šå®‰è£…python3ã€‚æˆ‘ä»¬å®‰è£…å¦‚ä¸‹çš„æ­¥éª¤è¿›è¡Œå®‰è£…ï¼š1ï¼‰ ä¸‹è½½elastalertæºç ï¼šgit clone https://github.com/Yelp/elastalert.git2ï¼‰å®‰è£…æ¨¡å—ï¼š123sudo pip3 install &quot;setuptools&gt;=11.3&quot;sudo python3 setup.py installsudo pip3 install -U PyYAMLæ ¹æ®Elasticsearchçš„ç‰ˆæœ¬ï¼Œæ‚¨å¯èƒ½éœ€è¦æ‰‹åŠ¨å®‰è£…æ­£ç¡®ç‰ˆæœ¬çš„elasticsearch-pyã€‚Elasticsearch 5.0+:sudo pip3 install &quot;elasticsearch&gt;=5.0.0&quot;Elasticsearch 2.X:sudo pip3 install &quot;elasticsearch&lt;3.0.0&quot;è¿™æ ·æˆ‘ä»¬çš„å®‰è£…å·¥ä½œå°±å®Œæˆäº†ã€‚é…ç½®ElastAlerté…ç½®æ–‡ä»¶æˆ‘ä»¬å¯ä»¥åœ¨ElastAlertæºç æ–‡ä»¶çš„æ ¹ç›®å½•ä¸‹æ‰¾åˆ°ä¸€ä¸ªå«åšconfig.yaml.exampleçš„æ–‡ä»¶ï¼šæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªæ–‡ä»¶ä¿®æ”¹ä¸ºconfig.yamlæ–‡ä»¶ï¼šmv config.yaml.example config.yamlæˆ‘ä»¬ä½¿ç”¨æˆ‘ä»¬å–œæ¬¢çš„ç¼–è¾‘å™¨æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶ï¼šæˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„IPåœ°å€æ¥è¿›è¡Œä¿®æ”¹ã€‚å¦‚æžœæˆ‘ä»¬å¯¹Elasticsearchåšäº†å®‰å…¨è®¾ç½®ï¼Œæˆ‘ä»¬åŒæ—¶ä¹Ÿéœ€è¦å¡«å†™ç”¨æˆ·ååŠå¯†ç ï¼šåšå®Œä¸Šé¢çš„ä¿®æ”¹åŽï¼Œæˆ‘ä»¬ä¿å­˜config.yamlæ–‡ä»¶ã€‚é…ç½®ElasticsearchElastAlertå°†æœ‰å…³å…¶æŸ¥è¯¢å’Œè­¦æŠ¥çš„ä¿¡æ¯å’Œå…ƒæ•°æ®ä¿å­˜å›žElasticsearchã€‚ è¿™å¯¹äºŽå®¡æ ¸å’Œè°ƒè¯•å¾ˆæœ‰ç”¨ï¼Œå®ƒä½¿ElastAlertå¯ä»¥é‡æ–°å¯åŠ¨å¹¶å®Œå…¨ä»Žä¸­æ–­å¤„æ¢å¤ã€‚ ElastAlertä¸éœ€è¦è¿è¡Œï¼Œä½†å¼ºçƒˆå»ºè®®ä½¿ç”¨ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡è¿è¡Œelastalert-create-indexå¹¶æŒ‰ç…§è¯´æ˜Žä¸ºElastAlertåˆ›å»ºè¦å†™å…¥çš„ç´¢å¼•ã€‚æˆ‘ä»¬è¿›å…¥åˆ°ElastAlertçš„æºç æ ¹ç›®å½•ï¼Œå¹¶æ‰“å…¥å¦‚ä¸‹çš„å‘½ä»¤ï¼šelastalert-create-indexåˆ›å»ºruleæ¯ä¸ªè§„åˆ™éƒ½å®šä¹‰è¦æ‰§è¡Œçš„æŸ¥è¯¢ï¼Œè§¦å‘åŒ¹é…çš„å‚æ•°ä»¥åŠæ¯ä¸ªåŒ¹é…è¦è§¦å‘çš„è­¦æŠ¥åˆ—è¡¨ã€‚ æˆ‘ä»¬å°†ä½¿ç”¨example_rules/example_frequency.yamlä½œä¸ºæ¨¡æ¿ã€‚æˆ‘ä»¬åˆ é™¤å…¶ä¸­ä¸€äº›ä¸éœ€è¦çš„é¡¹ç›®ï¼Œæœ€ç»ˆçš„æ–‡ä»¶æ˜¯è¿™æ ·çš„ï¼šexample_frequency.yaml12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455# Alert when the rate of events exceeds a threshold # Elasticsearch hostes_host: 10.211.55.2 # Elasticsearch portes_port: 9200 # (OptionaL) Connect with SSL to Elasticsearch#use_ssl: True # (Optional) basic-auth username and password for Elasticsearches_username: &quot;elastic&quot;es_password: &quot;123456&quot; # (Required)# Rule name, must be uniquename: Slack demo # (Required)# Type of alert.# the frequency rule type alerts when num_events events occur with timeframe timetype: frequency # (Required)# Index to search, wildcard supportedindex: filebeat-* # (Required, frequency specific)# Alert when this many documents matching the query occur within a timeframenum_events: 3 # (Required, frequency specific)# num_events must occur within this amount of time to trigger an alerttimeframe: hours: 1 # (Required)# A list of Elasticsearch filters used for find events# These filters are joined with AND and nested in a filtered query# For more info: http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/query-dsl.htmlfilter:- term: process.name: &quot;JUSTME&quot; # (Required)# The alert is use when a match is foundalert:- &quot;slack&quot; # (required, email specific)# a list of email addresses to send alerts toslack:slack_webhook_url: Your_Webhook_Urlslack_username_override: &quot;liuxg&quot;åœ¨ä¸Šé¢è¯·ä¿®æ”¹es_hostä¸ºè‡ªå·±çš„IPåœ°å€ï¼ŒåŒæ—¶ä¹Ÿéœ€è¦æŠŠè‡ªå·±çš„webhook urlå†™å…¥åˆ°slack_webhook_urlä¸­åŽ»ã€‚åœ¨ä¸Šé¢æˆ‘ä»¬ä½¿ç”¨indexä¸ºfilebeat-*ä½œä¸ºæŸ¥è¯¢çš„ç´¢å¼•ï¼ŒåŒæ—¶æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªfilterã€‚å®ƒæ£€æŸ¥process.nameæ˜¯å¦ä¸ºJUSTMEå­—ç¬¦ä¸²ã€‚å¦‚æžœæ˜¯ï¼Œå¹¶ä¸”åœ¨1ä¸ªå°æ—¶ï¼ˆtimeframeï¼‰é‡Œå‡ºçŽ°3æ¬¡ï¼ˆnum_eventsï¼‰ï¼Œé‚£ä¹ˆå°†è§¦å‘é€šçŸ¥ã€‚æµ‹è¯•ruleè¿è¡Œelastalert-test-ruleå·¥å…·å°†æµ‹è¯•æ‚¨çš„é…ç½®æ–‡ä»¶æ˜¯å¦æˆåŠŸåŠ è½½å¹¶åœ¨è¿‡åŽ»çš„24å°æ—¶å†…ä»¥è°ƒè¯•æ¨¡å¼è¿è¡Œå®ƒï¼šelastalert-test-rule example_rules/example_frequency.yamlè¿è¡ŒElastAlertæˆ‘ä»¬ä½¿ç”¨Pythonæ¥ç›´æŽ¥è¿è¡ŒElastalertï¼špython3 -m elastalert.elastalert --verbose --rule example_frequency.yamlè¿™æ ·æˆ‘ä»¬çš„Elastalertå·²ç»è¢«æˆåŠŸè¿è¡Œèµ·æ¥äº†ã€‚æˆ‘ä»¬åœ¨è¿™ä¸ªæ—¶å€™å¯ä»¥æ‰“å¼€æˆ‘ä»¬çš„Kibanaæ¥ç›‘è§†filebeat-*ç´¢å¼•ï¼Œå¦‚æžœåœ¨ä¸€ä¸ªå°æ—¶å†…æœ‰ä¸‰æ¬¡process.nameä¿¡æ¯æœ‰JUSTMEå­—æ ·ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¼šåœ¨æˆ‘ä»¬çš„Slacké‡Œæ”¶åˆ°ä¸€ä¸ªé€šçŸ¥ã€‚æˆ‘ä»¬åœ¨Ubuntuä¸­æ‰“å¼€å¦å¤–çš„ä¸€ä¸ªterminalï¼Œå¹¶è¾“å…¥å¦‚ä¸‹çš„å‘½ä»¤ï¼š123sudo logger -t JUSTME this is message 1sudo logger -t JUSTME this is message 2sudo logger -t JUSTME this is message 3é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ‰“å¼€KibanaæŸ¥çœ‹è¿™äº›æ¶ˆæ¯ï¼šé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼Œåœ¨æˆ‘ä»¬çš„Slackä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„æ¶ˆæ¯ï¼šæˆ‘ä»¬æ”¶åˆ°äº†æˆ‘ä»¬æ‰€éœ€è¦çš„é€šçŸ¥ä¿¡æ¯ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠé€šçŸ¥å†™å…¥åˆ°æˆ‘ä»¬çš„é‚®ä»¶ä¸­åŽ»ã€‚è¿™ä¸ªç”±ä½ ä»¬è‡ªå·±æ¥å®žè·µäº†ã€‚åœ¨Elastalertçš„å®˜æ–¹ç½‘ç«™ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¾ˆå¤šçš„é€šçŸ¥ç±»åž‹ã€‚è¯¦ç»†åœ°å€ä¸ºhttps://elastalert.readthedocs.io/en/latest/ruletypes.htmlâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ç‰ˆæƒå£°æ˜Žï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€ŒElastic ä¸­å›½ç¤¾åŒºå®˜æ–¹åšå®¢ã€çš„åŽŸåˆ›æ–‡ç« ï¼Œéµå¾ª CC 4.0 BY-SA ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŽŸæ–‡å‡ºå¤„é“¾æŽ¥åŠæœ¬å£°æ˜Žã€‚åŽŸæ–‡é“¾æŽ¥ï¼šhttps://blog.csdn.net/UbuntuTouch/article/details/103820572]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸ç»™å­—æ®µåˆ›å»ºç´¢å¼•ï¼Œå­—æ®µä¸å­˜æ”¾åœ¨sourceä¸­ï¼Œå­—æ®µæ— æ³•èšåˆæŸ¥è¯¢ç­‰]]></title>
    <url>%2F2020%2F01%2F06%2F%E4%B8%8D%E7%BB%99%E5%AD%97%E6%AE%B5%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95%EF%BC%8C%E5%AD%97%E6%AE%B5%E4%B8%8D%E5%AD%98%E6%94%BE%E5%9C%A8source%E4%B8%AD%EF%BC%8C%E5%AD%97%E6%AE%B5%E6%97%A0%E6%B3%95%E8%81%9A%E5%90%88%E6%9F%A5%E8%AF%A2%E7%AD%89%2F</url>
    <content type="text"><![CDATA[æŸä¸ªå­—æ®µä¸è¢«æœç´¢ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸æƒ³ä¸ºè¿™ä¸ªå­—æ®µå»ºç«‹inverted index(åå‘ç´¢å¼•)ï¼Œå¯ä»¥è¿™ä¹ˆåšï¼š12345678910111213PUT twitter&#123; &quot;mappings&quot;: &#123; &quot;uid&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;user&quot;: &#123; &quot;type&quot;: &quot;object&quot;, &quot;enabled&quot;: false &#125; &#125; &#125;&#125;é€šè¿‡mappingå¯¹userå­—æ®µè¿›è¡Œäº†ä¿®æ”¹ï¼š1234&quot;user&quot;: &#123; &quot;type&quot;: &quot;object&quot;, &quot;enabled&quot;: false &#125;ä¸æƒ³æˆ‘ä»¬çš„æ•´ä¸ªæ–‡æ¡£è¢«æœç´¢:1234567PUT twitter &#123; &quot;mappings&quot;: &#123; &quot;enabled&quot;: false &#125;&#125;ä¸æƒ³å­˜å‚¨ä»»ä½•çš„å­—æ®µ,ä¹Ÿå°±æ˜¯è¯´ä¸åœ¨sourceä¸­å­˜å‚¨æ•°æ®,å®ƒæœ‰å®Œå¥½çš„inverted indexä¾›æŸ¥è¯¢ï¼Œè™½ç„¶å®ƒæ²¡æœ‰å­—çš„sourceã€‚12345678PUT twitter&#123; &quot;mappings&quot;: &#123; &quot;_source&quot;: &#123; &quot;enabled&quot;: false &#125; &#125;&#125;æƒ³èŠ‚çœè‡ªå·±çš„å­˜å‚¨ç©ºé—´ï¼Œåªå­˜å‚¨é‚£äº›éœ€è¦çš„å­—æ®µåˆ°sourceé‡ŒåŽ»ä½¿ç”¨includeæ¥åŒ…å«æˆ‘ä»¬æƒ³è¦çš„å­—æ®µï¼ŒåŒæ—¶æˆ‘ä»¬é€šè¿‡excludeæ¥åŽ»é™¤é‚£äº›ä¸éœ€è¦çš„å­—æ®µ123456789101112131415PUT twitter&#123; &quot;mappings&quot;: &#123; &quot;_source&quot;: &#123; &quot;includes&quot;: [ &quot;*.lat&quot;, &quot;address&quot;, &quot;name.*&quot; ], &quot;excludes&quot;: [ &quot;name.surname&quot; ] &#125; &#125;&#125;é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰æ”¯æŒdocå€¼çš„å­—æ®µå‡å·²å¯ç”¨å®ƒä»¬ã€‚å¦‚æžœæ‚¨ç¡®å®šä¸éœ€è¦å¯¹å­—æ®µè¿›è¡ŒæŽ’åºæˆ–æ±‡æ€»ï¼Œä¹Ÿä¸éœ€è¦é€šè¿‡è„šæœ¬è®¿é—®å­—æ®µå€¼ï¼Œåˆ™å¯ä»¥ç¦ç”¨docå€¼ä»¥èŠ‚çœç£ç›˜ç©ºé—´ï¼š123456789101112131415161718192021222324PUT twitter&#123; &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;city&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;doc_values&quot;: false, &quot;ignore_above&quot;: 256 &#125;, &quot;address&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125;, &quot;age&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125; &#125; &#125;&#125;æŠŠcityå­—æ®µçš„doc_valuesè®¾ç½®ä¸ºfalse]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[X-Packï¼šåˆ›å»ºé˜ˆå€¼æ£€æŸ¥è­¦æŠ¥]]></title>
    <url>%2F2020%2F01%2F02%2FX-Pack%EF%BC%9A%E5%88%9B%E5%BB%BA%E9%98%88%E5%80%BC%E6%A3%80%E6%9F%A5%E8%AD%A6%E6%8A%A5%2F</url>
    <content type="text"><![CDATA[ç®€å•çš„äº‹æƒ…åº”è¯¥ç®€å•(Simple things should be simple)ï¼Œè¿™æ˜¯Elastic {ON} â€˜17çš„ä¸»é¢˜ä¹‹ä¸€ï¼ŒElasticsæ”¶åˆ°äº†è®¸å¤šå…³äºŽä½¿ç”¨ç®€å•æ˜“ç”¨çš„UIåˆ›å»ºè­¦æŠ¥çš„è¯·æ±‚ã€‚äº‹å®žè¯æ˜Žï¼Œåˆ›å»ºå•ä¸ªUIä»¥å¯¹æ‰€æœ‰ç±»åž‹çš„è­¦æŠ¥å‡æœ‰æ•ˆåœ°å·¥ä½œéžå¸¸å›°éš¾ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥åœ¨å¹³å‡CPUä½¿ç”¨çŽ‡è¶…è¿‡50ï¼…æ—¶åˆ›å»ºè­¦æŠ¥çš„UIä¸Žå¯ä»¥åœ¨åŒä¸€IPåœ°å€ä¸Šæœ‰è®¸å¤šå¹¶å‘ç™»å½•çš„æƒ…å†µä¸‹åˆ›å»ºè­¦æŠ¥çš„UIçœ‹èµ·æ¥æˆªç„¶ä¸åŒã€‚ç”±äºŽå¾ˆéš¾ä¸ºæ‰€æœ‰ç±»åž‹çš„è­¦æŠ¥æž„å»ºé€šç”¨çš„UIï¼Œå› æ­¤Elasticå†³å®šé¦–å…ˆé’ˆå¯¹æœ€å¸¸è¯·æ±‚çš„è­¦æŠ¥å¤„ç†UIï¼šå½“æŒ‡æ ‡è¶…è¿‡æˆ–ä½ŽäºŽç»™å®šé˜ˆå€¼æ—¶è§¦å‘çš„ç®€å•é˜ˆå€¼è­¦æŠ¥ã€‚åœ¨å¼€å§‹ç¤ºä¾‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨å…·æœ‰æœ€ä½Žç‰ˆæœ¬çš„Elasticsearchå’ŒKibanaçš„6.0.0ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä¸¤è€…éƒ½å®‰è£…äº†X-Packã€‚åœ¨æœ€æ–°çš„7.xç‰ˆæœ¬é‡Œï¼ŒX-Packå·²ç»æ˜¯å‘å¸ƒç‰ˆçš„ä¸€éƒ¨åˆ†ï¼Œä¸éœ€è¦å®‰è£…ã€‚å¦å¤–ï¼Œè¯·ç¡®ä¿æ‚¨ä¸ºElasticsearché…ç½®äº†å…·æœ‰è¶³å¤Ÿæƒé™çš„ç”¨æˆ·ã€‚çŽ°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›æœ‰è¶£çš„æ•°æ®æ¥æž„å»ºè­¦æŠ¥ã€‚ Metricbeatæ˜¯ç›‘è§†æœºå™¨ä¸Šçš„ç³»ç»Ÿå’Œç”¨æˆ·è¿›ç¨‹çš„ç»ä½³æ‹å­ã€‚åœ¨ä»Šå¤©çš„ç»ƒä¹ é‡Œï¼Œæˆ‘ä»¬æ¥å±•ç¤ºå¦‚ä½•é€šè¿‡é˜ˆå€¼æ£€æŸ¥ï¼Œå¹¶å‘é€é€šçŸ¥åˆ°Slackã€‚å¤§å®¶ä¹Ÿå¯ä»¥å°è¯•å‘é€åˆ°ç”µå­é‚®ä»¶ç­‰æ–¹å¼ã€‚åˆ›å»ºSlackè´¦å·æˆ‘ä»¬é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªè‡ªå·±çš„Slackè´¦å·(https://slack.com/)ï¼Œå¹¶å…·æœ‰è‡ªå·±çš„ç®¡ç†å‘˜æƒé™ã€‚ä½ å¯ä»¥å‚è€ƒé“¾æŽ¥ â€œConfiguring Slack Accountâ€(https://www.elastic.co/guide/en/elasticsearch/reference/7.5/actions-slack.html#configuring-slack)æ¥é…ç½®è‡ªå·±çš„Slackè´¦å·ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªç›¸åº”çš„ä¸€ä¸ªWebhook URLã€‚è¿™ä¸ªURLå°†ä¼šåœ¨Elasticsearché‡Œè¿›è¡Œä½¿ç”¨ã€‚é…ç½®elasticsearch.ymlé¦–å…ˆwatcherå¿…é¡»æ˜¯åœ¨æœ‰è´¦å·çš„æƒ…å†µä¸‹æ‰å¯ä»¥å·¥ä½œçš„ã€‚å¦‚æžœä½ è¿˜ä¸çŸ¥é“å¦‚ä½•å¼€é€šä¸€ä¸ªElasticsearchçš„å®‰å…¨ï¼Œé‚£ä¹ˆè¯·å‚é˜…æˆ‘ä¹‹å‰çš„æ–‡ç« â€œElasticsearchï¼šè®¾ç½®Elasticè´¦æˆ·å®‰å…¨â€ã€‚å› ä¸ºè¿™æ˜¯ä¸€ä¸ªä»˜è´¹çš„åŠŸèƒ½ï¼Œä½ éœ€è¦æŽ¥å—30å¤©è¯•ç”¨çš„æ¡ä»¶æ‰å¯ä»¥çœ‹åˆ°è¿™ä¸ªåŠŸèƒ½ã€‚ä¸ºäº†èƒ½å¤Ÿä½¿å¾—watcherèƒ½å¤Ÿæ­£å¸¸å·¥ä½œï¼Œæˆ‘ä»¬å¿…é¡»é…ç½®elasticsearch.ymlæ–‡ä»¶ã€‚æ‰“å¼€elasticsearchå®‰è£…ç›®å½•ä¸‹çš„config/elasticsearch.ymlæ–‡ä»¶ï¼Œå¹¶åŠ å…¥å¦‚ä¸‹çš„é…ç½®ï¼š1234567891011121314151617xpack.security.enabled: truediscovery.type: single-node xpack.notification.slack: account: monitoring: message_defaults: from: x-pack to: notifications icon: http://example.com/images/watcher-icon.jpg attachment: fallback: &quot;X-Pack Notification&quot; color: &quot;#36a64f&quot; title: &quot;X-Pack Notification&quot; title_link: &quot;https://www.elastic.co/guide/en/x-pack/current/index.html&quot; text: &quot;One of your watches generated this notification.&quot; mrkdwn_in: &quot;pretext, text&quot;å‰é¢çš„ä¸¤è¡Œæ˜¯ä¸ºäº†å¯åŠ¨å®‰å…¨åŠŸèƒ½æ‰è¿›è¡ŒåŠ å…¥çš„ã€‚åŽé¢çš„å…³äºŽxpackçš„é…ç½®æ‰æ˜¯ä¸ºwatcherè€Œè®¾ç½®çš„ã€‚é…ç½®å¥½æˆ‘ä»¬çš„elasticsearch.ymlæ–‡ä»¶åŽï¼Œæˆ‘ä»¬åœ¨å‘½ä»¤è¡Œä¸­æ‰“å…¥å¦‚ä¸‹çš„å‘½ä»¤ï¼š1./bin/elasticsearch-keystore add xpack.notification.slack.account.monitoring.secure_urlåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é€‰æ‹©yã€‚å¦‚æžœä½ æ˜¯ç¬¬ä¸€æ¬¡è¿è¡Œè¿™ä¸ªå‘½ä»¤çš„è¯ï¼Œå°±ä¸ä¼šæœ‰è¿™æ ·çš„ä¸€ä¸ªæç¤ºäº†ã€‚ä½ å¯ä»¥æŠŠä½ ä»ŽSlackä¸­é…ç½®çš„é‚£ä¸ªWebhook URLå¤åˆ¶å¹¶ç²˜è´´åˆ°è¿™é‡Œã€‚è¿™æ ·æˆ‘ä»¬çš„é…ç½®å°±å®Œæˆäº†ã€‚ç„¶åŽï¼Œæˆ‘ä»¬å¯åŠ¨Elasticsearchã€‚å®‰è£…åŠé…ç½®Metricbeatåªå¯åŠ¨systemæ¨¡å—å³å¯ã€‚ç­‰å®‰è£…å¥½MetricbeatåŽï¼Œå°±å¯å¯åŠ¨æˆ‘ä»¬çš„metricbeatäº†ã€‚é…ç½®Watcheræ‰“å¼€æµè§ˆå™¨å¹¶å¯¼èˆªåˆ°Kibanaã€‚å•å‡»ä¾§é¢å¯¼èˆªæ ä¸­çš„â€œManagementâ€åº”ç”¨ç¨‹åºï¼Œç„¶åŽå•å‡»Elasticsearchæ ‡é¢˜ä¸‹çš„Watcherã€‚æˆ‘ä»¬ç‚¹å‡»Createï¼Œç„¶åŽï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹é…ç½®æˆ‘ä»¬çš„ä¸€ä¸ªwatcheräº†ã€‚æˆ‘ä»¬é€‰æ‹©Create threashold alert:ç„¶åŽï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§ä¸Šé¢çš„é…ç½®è¿›è¡Œè®¾ç½®ã€‚å†ç‚¹å‡»â€œAdd actionâ€ï¼šæˆ‘ä»¬é€‰æ‹©Slackä½œä¸ºæˆ‘ä»¬çš„é€šçŸ¥æ–¹æ³•ã€‚é‡Œé¢è¿˜æœ‰å…¶å®ƒçš„å‡ ç§æ–¹å¼ï¼Œä½ ä»¬å¯ä»¥è‡ªå·±åŽ»å°è¯•ã€‚æˆ‘ä»¬å¯ä»¥é€‰æ‹©Send a sample messageæŒ‰é’®æ¥æµ‹è¯•ä¸€ä¸‹æˆ‘ä»¬çš„Slacké…ç½®æ˜¯å¦æˆåŠŸã€‚æœ€åŽï¼Œæˆ‘ä»¬é€‰æ‹©Create alertã€‚è¿™æ ·å°±åˆ›å»ºäº†ä¸€ä¸ªWatcherã€‚æˆ‘ä»¬å¯ä»¥åœ¨Watcheré¡µé¢çœ‹åˆ°æˆ‘ä»¬é…ç½®çš„æ¯ä¸ªWatcherã€‚ä¸Šé¢æ˜¾ç¤ºæˆ‘ä»¬çš„å…¶ä¸­çš„ä¸€ä¸ªwatcherå·²ç»å‘é€é€šçŸ¥äº†ï¼Œè€Œä¸”æ˜¯4åˆ†é’Ÿä¹‹å‰å‘é€çš„ã€‚æˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬çš„Slackç•Œé¢çœ‹åˆ°å¦‚ä¸‹çš„æ¶ˆæ¯ï¼šæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è®¸å¤šçš„é€šçŸ¥ä¿¡æ¯ä¸æ–­åœ°è¿›æ¥ã€‚å®ƒè¡¨æ˜Žæˆ‘ä»¬çš„é…ç½®æ˜¯å·²ç»æˆåŠŸäº†ã€‚ä¸Šé¢æˆ‘ä»¬é€šè¿‡Kibanaçš„ç•Œé¢é…ç½®äº†Watcherã€‚äº‹å®žä¸Šï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡APIçš„æ–¹å¼æ¥é…ç½®ã€‚è¯·è¯¦ç»†é˜…è¯»æˆ‘ä»¬çš„æ–‡æ¡£(https://www.elastic.co/guide/en/elasticsearch/reference/7.5/how-watcher-works.html)ã€‚å‚è€ƒï¼šã€1ã€‘https://www.elastic.co/guide/en/elasticsearch/reference/7.5/how-watcher-works.html]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Solutionsï¼šå¦‚ä½•è¿ç”¨Elastic App Searchå¿«é€Ÿå»ºç«‹å‡ºè‰²çš„Reactæœç´¢ä½“éªŒ]]></title>
    <url>%2F2020%2F01%2F02%2FSolutions%EF%BC%9A%E5%A6%82%E4%BD%95%E8%BF%90%E7%94%A8Elastic%20App%20Search%E5%BF%AB%E9%80%9F%E5%BB%BA%E7%AB%8B%E5%87%BA%E8%89%B2%E7%9A%84React%E6%90%9C%E7%B4%A2%E4%BD%93%E9%AA%8C%2F</url>
    <content type="text"><![CDATA[å»ºç«‹æœç´¢ä½“éªŒæ˜¯ä¸€é¡¹è‰°è‹¦çš„å·¥ä½œã€‚ ä¹ä¸€çœ‹ä¼¼ä¹Žå¾ˆå®¹æ˜“ï¼šå»ºç«‹ä¸€ä¸ªæœç´¢æ ï¼Œå°†æ•°æ®æ”¾å…¥æ•°æ®åº“ï¼Œç„¶åŽè®©ç”¨æˆ·è¾“å…¥å¯¹è¯¥æ•°æ®åº“çš„æŸ¥è¯¢ã€‚ ä½†æ˜¯ï¼Œåœ¨æ•°æ®å»ºæ¨¡ï¼Œåº•å±‚é€»è¾‘ä»¥åŠï¼ˆå½“ç„¶ï¼‰æ€»ä½“è®¾è®¡å’Œç”¨æˆ·ä½“éªŒæ–¹é¢ï¼Œæœ‰å¾ˆå¤šäº‹æƒ…è¦è€ƒè™‘ã€‚æˆ‘ä»¬å°†é€æ­¥ä»‹ç»å¦‚ä½•ä½¿ç”¨Elasticçš„å¼€æºSearch UIåº“æž„å»ºå‡ºè‰²çš„åŸºäºŽReactçš„æœç´¢ä½“éªŒã€‚ å¤§çº¦éœ€è¦30åˆ†é’Ÿï¼Œç„¶åŽæ‚¨ä¾¿å¯ä»¥å°†æœç´¢å¸¦åˆ°éœ€è¦å®ƒçš„ä»»ä½•åº”ç”¨ç¨‹åºä¸­ã€‚ä½†æ˜¯é¦–å…ˆï¼Œæ˜¯ä»€ä¹ˆä½¿åˆ›å»ºæœç´¢å¦‚æ­¤å…·æœ‰æŒ‘æˆ˜æ€§ï¼Ÿæœç´¢æ˜¯å¾ˆéš¾åˆ›å»ºçš„å¼€å‘äººå‘˜åœ¨æœç´¢å¼€å‘ä¸­é‡‡ç”¨è®¸å¤šé”™è¯¯çš„å‡è®¾ã€‚æ¯”å¦‚è®¸å¤šç›¸ä¿¡çš„å‡è®¾ï¼šâ€œçŸ¥é“ä»–ä»¬è¦å¯»æ‰¾çš„å®¢æˆ·å°†æŒ‰ç…§æ‚¨æœŸæœ›çš„æ–¹å¼è¿›è¡Œæœç´¢ã€‚â€â€œæ‚¨å¯ä»¥ç¼–å†™ä¸€ä¸ªæŸ¥è¯¢è§£æžå™¨ï¼Œè¯¥è§£æžå™¨å°†å§‹ç»ˆæˆåŠŸè§£æžæŸ¥è¯¢ã€‚â€â€œä¸€æ—¦è®¾ç½®ï¼Œä¸‹å‘¨æœç´¢å°†ä»¥ç›¸åŒçš„æ–¹å¼è¿›è¡Œã€‚â€â€œåŒä¹‰è¯å¾ˆå®¹æ˜“ã€‚â€â€¦å¾—å‡ºçš„ç»“è®ºæ˜¯ï¼Œæœç´¢é¢ä¸´è®¸å¤šæŒ‘æˆ˜â€“è€Œä¸”è¿™äº›æŒ‘æˆ˜å¹¶ä¸ç®€å•ã€‚ æ‚¨éœ€è¦è€ƒè™‘å¦‚ä½•ç®¡ç†çŠ¶æ€ï¼Œæž„å»ºç”¨äºŽè¿‡æ»¤ï¼Œæž„é¢ï¼ŒæŽ’åºï¼Œåˆ†é¡µï¼ŒåŒä¹‰è¯ï¼Œè¯­è¨€å¤„ç†ç­‰ç­‰çš„ç»„ä»¶ï¼Œç­‰ç­‰ã€‚ ä½†æ˜¯ï¼Œæ€»è€Œè¨€ä¹‹ï¼šå»ºç«‹å‡ºè‰²çš„æœç´¢éœ€è¦ä¸¤ä¸ªå¤æ‚çš„éƒ¨åˆ†ï¼š(1)æœç´¢å¼•æ“Žï¼Œå®ƒæä¾›ç”¨äºŽå¢žå¼ºæœç´¢åŠŸèƒ½çš„API(2)æœç´¢åº“ï¼Œå®ƒæç»˜äº†æœç´¢ä½“éªŒã€‚å¯¹äºŽæœç´¢å¼•æ“Žï¼Œæˆ‘ä»¬å°†æŸ¥çœ‹Elastic App Searchã€‚ä¸ºäº†èŽ·å¾—æœç´¢ä½“éªŒï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸€ä¸ªæ“ä½œç³»ç»Ÿæœç´¢åº“ï¼šSearch UIã€‚å®ŒæˆåŽï¼Œå°†å¦‚ä¸‹æ‰€ç¤ºã€‚æ‚¨ä¹Ÿå¯ä»¥åœ¨åœ°å€(https://codesandbox.io/embed/happy-wilbur-hwzsh?view=preview&amp;initialpath=%3Fq%3Dfinal%20fantasy)ä¸Šè¿›è¡Œåœ¨çº¿ä½“éªŒã€‚æœç´¢å¼•æ“Ž: Elastic App SearchApp Searchå¯ä½œä¸ºä»˜è´¹æ‰˜ç®¡æœåŠ¡æˆ–å…è´¹çš„è‡ªåŠ©æ‰˜ç®¡å‘è¡Œç‰ˆ(https://www.elastic.co/downloads/app-search?ultron=searchui-howto-react&amp;blade=codeburst&amp;hulk=content)æä¾›ã€‚ æˆ‘ä»¬å°†åœ¨æœ¬æ•™ç¨‹ä¸­ä½¿ç”¨æ‰˜ç®¡æœåŠ¡ï¼Œä½†æ˜¯è¯·è®°ä½ï¼Œå¦‚æžœæ‚¨è‡ªå·±æ‰˜ç®¡ï¼Œæ‚¨çš„å›¢é˜Ÿå¯ä»¥å…è´¹ä½¿ç”¨å¸¦æœ‰åŸºæœ¬è®¸å¯çš„Search UIå’ŒApp Searchã€‚è®¡åˆ’ï¼šå°†ä»£è¡¨æœ‰å²ä»¥æ¥æœ€å¥½çš„è§†é¢‘æ¸¸æˆçš„æ–‡æ¡£ç¼–å…¥æœç´¢å¼•æ“Žï¼Œç„¶åŽè®¾è®¡å’Œä¼˜åŒ–æœç´¢ä½“éªŒä»¥å¯¹å…¶è¿›è¡Œæœç´¢ã€‚é¦–å…ˆï¼Œæ³¨å†Œ14å¤©çš„è¯•ç”¨æœŸ(https://www.elastic.co/products/app-search/service?ultron=searchui-howto-react&amp;blade=codeburst&amp;hulk=content)-æ— éœ€ä¿¡ç”¨å¡ã€‚åˆ›å»ºä¸€ä¸ªå¼•æ“Žã€‚ æ‚¨å¯ä»¥é€‰æ‹©13ç§ä¸åŒçš„è¯­è¨€ã€‚æˆ‘ä»¬å°†å…¶å‘½åä¸ºvideo-gamesï¼Œå¹¶å°†è¯­è¨€è®¾ç½®ä¸ºè‹±è¯­ã€‚ä¸‹è½½æœ€ä½³è§†é¢‘æ¸¸æˆæ•°æ®é›†(https://drive.google.com/file/d/14-3wzemyLzJh6XHVUotFsdl0tZ7K2v1E/view)ï¼Œç„¶åŽä½¿ç”¨å¯¼å…¥ç¨‹åºå°†å…¶ä¸Šä¼ åˆ°App Searchã€‚æŽ¥ä¸‹æ¥ï¼Œå•å‡»è¿›å…¥å¼•æ“Žï¼Œç„¶åŽé€‰æ‹©â€œCredentialsâ€é€‰é¡¹å¡ã€‚ä½¿ç”¨ä»…å¯¹video-gameså¼•æ“Žå…·æœ‰Limited Engine Accessçš„æ–¹å¼åˆ›å»ºæ–°çš„Public Search Keyã€‚æˆ‘ä»¬å¯ä»¥è®°ä¸‹æˆ‘ä»¬åˆšåˆ›å»ºçš„Public Search KeyåŠHost Indentifierä»¥ä¾¿ä¸‹é¢ä¹‹ç”¨ã€‚å°½ç®¡çœ‹èµ·æ¥æˆ‘ä»¬ç›®å‰åšçš„å¹¶ä¸å¤šï¼Œä½†æˆ‘ä»¬çŽ°åœ¨æ‹¥æœ‰åŠŸèƒ½å…¨é¢çš„æœç´¢å¼•æ“Žï¼Œå¯ä»¥ä½¿ç”¨å®Œå–„çš„æœç´¢APIæ¥æœç´¢æˆ‘ä»¬çš„è§†é¢‘æ¸¸æˆæ•°æ®ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿™æ˜¯æˆ‘ä»¬æ‰€åšçš„ï¼šåˆ›å»ºäº†ä¸€ä¸ªæœç´¢å¼•æ“Žå»ºç«‹äº†ç´¢å¼•æ–‡æ¡£åˆ›å»ºä¸€ä¸ªé»˜è®¤çš„ç´¢å¼•schemaåˆ›å»ºäº†ä¸€ä¸ªæœ‰é™çš„å¯ä»¥ç”¨äºŽå¤–ç•Œè®¿é—®çš„å‡­è¯ï¼ˆcredentialï¼‰è®©æˆ‘ä»¬å¼€å§‹ä½¿ç”¨â€œSearch UIâ€æ¥å»ºç«‹æˆ‘ä»¬çš„æœç´¢ä½“éªŒã€‚æœç´¢åº“ï¼šSearch UIæˆ‘ä»¬å°†ä½¿ç”¨create-react-app(https://github.com/facebook/create-react-app)è„šæ‰‹æž¶å®žç”¨ç¨‹åºåˆ›å»ºä¸€ä¸ªReactåº”ç”¨ï¼š123npm install -g create-react-appcreate-react-app video-game-search --use-npmcd video-game-searchåœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å°†å®‰è£…Search UIå’ŒApp Searchè¿žæŽ¥å™¨ï¼š1npm install --save @elastic/react-search-ui @elastic/search-ui-app-search-connectorå¹¶ä»¥å¼€å‘æ¨¡å¼å¯åŠ¨è¯¥åº”ç”¨ç¨‹åºï¼š1npm startåœ¨æ‚¨å–œæ¬¢çš„æ–‡æœ¬ç¼–è¾‘å™¨ä¸­æ‰“å¼€src/App.jsæˆ‘ä»¬å°†ä»Žä¸€äº›æ ·æ¿ä»£ç å¼€å§‹ï¼Œæ³¨æ„è¯„è®ºéƒ¨åˆ†ï¼12345678910111213141516171819202122232425262728293031// Step #1, import statementsimport React from &quot;react&quot;;import AppSearchAPIConnector from &quot;@elastic/search-ui-app-search-connector&quot;;import &#123; SearchProvider, Results, SearchBox &#125; from &quot;@elastic/react-search-ui&quot;;import &#123; Layout &#125; from &quot;@elastic/react-search-ui-views&quot;;import &quot;@elastic/react-search-ui-views/lib/styles/styles.css&quot;;// Step #2, The connectorconst connector = new AppSearchAPIConnector(&#123; searchKey: &quot;[YOUR_SEARCH_KEY]&quot;, engineName: &quot;video-games&quot;, hostIdentifier: &quot;[YOUR_HOST_IDENTIFIER]&quot;&#125;); // Step #3: Configuration optionsconst configurationOptions = &#123; apiConnector: connector // Let&apos;s fill this in together.&#125;; // Step #4, SearchProvider: The finishing touchesexport default function App() &#123; return ( &lt;SearchProvider config=&#123;configurationOptions&#125;&gt; &lt;div className=&quot;App&quot;&gt; &lt;Layout // Let&apos;s fill this in together. /&gt; &lt;/div&gt; &lt;/SearchProvider&gt; );&#125;Step 1: å¯¼å…¥å£°æ˜Žæˆ‘ä»¬éœ€è¦å¯¼å…¥æˆ‘ä»¬çš„Search UIä¾èµ–å…³ç³»å’ŒReactã€‚æ ¸å¿ƒç»„ä»¶ï¼Œè¿žæŽ¥å™¨å’Œè§†å›¾ç»„ä»¶åŒ…å«åœ¨ä¸‰ä¸ªä¸åŒçš„ç¨‹åºåŒ…ä¸­ï¼š123@elastic/search-ui-app-search-connector@elastic/react-search-ui@elastic/react-search-ui-viewsç»§ç»­è¿›è¡Œæ—¶ï¼Œæˆ‘ä»¬å°†è¯¦ç»†äº†è§£å®ƒä»¬1234import React from &quot;react&quot;;import AppSearchAPIConnector from &quot;@elastic/search-ui-app-search-connector&quot;;import &#123; SearchProvider, Results, SearchBox &#125; from &quot;@elastic/react-search-ui&quot;;import &#123; Layout &#125; from &quot;@elastic/react-search-ui-views&quot;;æˆ‘ä»¬è¿˜å°†ä¸ºè¯¥é¡¹ç›®å¯¼å…¥é»˜è®¤æ ·å¼è¡¨ï¼Œè¿™å°†ä½¿æˆ‘ä»¬æ‹¥æœ‰è‰¯å¥½çš„å¤–è§‚ï¼Œè€Œæ— éœ€ç¼–å†™æˆ‘ä»¬è‡ªå·±çš„CSSè¡Œï¼š1import &quot;@elastic/react-search-ui-views/lib/styles/styles.css&quot;;Step 2: è¿žæŽ¥å™¨æˆ‘ä»¬æœ‰æ¥è‡ªApp Searchçš„Public Search Keyå’ŒHost Identifierã€‚æ˜¯æ—¶å€™è®©ä»–ä»¬å·¥ä½œäº†ï¼Search UIä¸­çš„è¿žæŽ¥å™¨å¯¹è±¡ä½¿ç”¨credentialsè¿žæŽ¥åˆ°App Searchå’Œè¶…çº§æœç´¢ï¼š12345const connector = new AppSearchAPIConnector(&#123; searchKey: &quot;[YOUR_SEARCH_KEY]&quot;, engineName: &quot;video-games&quot;, hostIdentifier: &quot;[YOUR_HOST_IDENTIFIER]&quot;&#125;);æœç´¢ç”¨æˆ·ç•Œé¢å¯ä¸Žä»»ä½•æœç´¢APIé…åˆä½¿ç”¨ã€‚ ä½†æ˜¯é€šè¿‡è¿žæŽ¥å™¨å¯ä»¥ä½¿æœç´¢APIæ­£å¸¸å·¥ä½œï¼Œè€Œæ— éœ€è¿›è¡Œä»»ä½•æ›´æ·±å…¥çš„é…ç½®ã€‚Step 3: configurationOptionsåœ¨æ·±å…¥æŽ¢è®¨configurationOptionsä¹‹å‰ï¼Œè®©æˆ‘ä»¬èŠ±ç‚¹æ—¶é—´è¿›è¡Œåæ€ã€‚æˆ‘ä»¬å°†ä¸€ç»„æ•°æ®å¯¼å…¥äº†æœç´¢å¼•æ“Žã€‚ ä½†æ˜¯ï¼Œå®ƒæ˜¯ä»€ä¹ˆæ ·çš„æ•°æ®ï¼Ÿæˆ‘ä»¬å¯¹æ•°æ®äº†è§£çš„è¶Šå¤šï¼Œæˆ‘ä»¬å°±ä¼šè¶Šäº†è§£å¦‚ä½•å°†æ•°æ®å‘ˆçŽ°ç»™æœç´¢è€…ã€‚ è¿™æ ·ä¸€æ¥ï¼Œæ‚¨ä¾¿å¯ä»¥äº†è§£å¦‚ä½•é…ç½®æœç´¢ä½“éªŒã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™æ˜¯è¯¥æ•°æ®é›†ä¸­æ‰€æœ‰å¯¹è±¡ä¸­çš„ä¸€ä¸ªï¼š12345678910111213&#123; &quot;id&quot;:&quot;final-fantasy-vii-ps-1997&quot;, &quot;name&quot;:&quot;Final Fantasy VII&quot;, &quot;year&quot;:1997, &quot;platform&quot;:&quot;PS&quot;, &quot;genre&quot;:&quot;Role-Playing&quot;, &quot;publisher&quot;:&quot;Sony Computer Entertainment&quot;, &quot;global_sales&quot;:9.72, &quot;critic_score&quot;:92, &quot;user_score&quot;:9, &quot;developer&quot;:&quot;SquareSoft&quot;, &quot;image_url&quot;:&quot;https://r.hswstatic.com/w_907/gif/finalfantasyvii-MAIN.jpg&quot;&#125;æˆ‘ä»¬çœ‹åˆ°å®ƒæœ‰å‡ ä¸ªæ–‡æœ¬å­—æ®µï¼Œä¾‹å¦‚nameï¼Œyearï¼Œplatformç­‰ç­‰ï¼Œè¿˜æœ‰ä¸€äº›æ•°å­—å­—æ®µï¼Œä¾‹å¦‚critic_scoreï¼Œglobal_saleså’Œuser_scoreã€‚å¦‚æžœæˆ‘ä»¬æå‡ºä¸‰ä¸ªå…³é”®é—®é¢˜ï¼Œæˆ‘ä»¬å°†è¶³å¤Ÿäº†è§£ï¼Œä»¥æä¾›æ‰Žå®žçš„æœç´¢ä½“éªŒï¼šå¤§å¤šæ•°äººå°†å¦‚ä½•æœç´¢ï¼Ÿ ä»¥è§†é¢‘æ¸¸æˆçš„åç§°å‘½åã€‚å¤§å¤šæ•°äººæƒ³è¦çœ‹åˆ°çš„ç»“æžœæ˜¯ä»€ä¹ˆï¼Ÿ è§†é¢‘æ¸¸æˆçš„åç§°ï¼Œç±»åž‹ï¼Œå‘è¡Œå•†ï¼Œå¾—åˆ†å’Œå¹³å°ã€‚å¤§å¤šæ•°äººå°†å¦‚ä½•è¿‡æ»¤ï¼ŒæŽ’åºå’Œæž„é¢ï¼Ÿ æŒ‰å¾—åˆ†ï¼Œä½“è£ï¼Œå‘å¸ƒè€…å’Œå¹³å°åˆ†ç±»ã€‚ç„¶åŽï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™äº›ç­”æ¡ˆè½¬æ¢ä¸ºæˆ‘ä»¬çš„configurationOptionsï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071const configurationOptions = &#123; apiConnector: connector, searchQuery: &#123; search_fields: &#123; // 1. Search by name of video game. name: &#123;&#125; &#125;, // 2. Results: name, genre, publisher, scores, and platform. result_fields: &#123; name: &#123; // A snippet means that matching search terms will be wrapped in &lt;em&gt; tags. snippet: &#123; size: 75, // Limit the snippet to 75 characters. fallback: true // Fallback to a &quot;raw&quot; result. &#125; &#125;, genre: &#123; snippet: &#123; size: 50, fallback: true &#125; &#125;, publisher: &#123; snippet: &#123; size: 50, fallback: true &#125; &#125;, critic_score: &#123; // Scores are numeric, so we won&apos;t snippet. raw: &#123;&#125; &#125;, user_score: &#123; raw: &#123;&#125; &#125;, platform: &#123; snippet: &#123; size: 50, fallback: true &#125; &#125;, image_url: &#123; raw: &#123;&#125; &#125; &#125;, // 3. Facet by scores, genre, publisher, and platform, which we&apos;ll use to build filters later. facets: &#123; user_score: &#123; type: &quot;range&quot;, ranges: [ &#123; from: 0, to: 5, name: &quot;Not good&quot; &#125;, &#123; from: 5, to: 7, name: &quot;Not bad&quot; &#125;, &#123; from: 7, to: 9, name: &quot;Pretty good&quot; &#125;, &#123; from: 9, to: 10, name: &quot;Must play!&quot; &#125; ] &#125;, critic_score: &#123; type: &quot;range&quot;, ranges: [ &#123; from: 0, to: 50, name: &quot;Not good&quot; &#125;, &#123; from: 50, to: 70, name: &quot;Not bad&quot; &#125;, &#123; from: 70, to: 90, name: &quot;Pretty good&quot; &#125;, &#123; from: 90, to: 100, name: &quot;Must play!&quot; &#125; ] &#125;, genre: &#123; type: &quot;value&quot;, size: 100 &#125;, publisher: &#123; type: &quot;value&quot;, size: 100 &#125;, platform: &#123; type: &quot;value&quot;, size: 100 &#125; &#125; &#125;&#125;;æˆ‘ä»¬å·²ç»å°†Search UIè¿žæŽ¥åˆ°æˆ‘ä»¬çš„æœç´¢å¼•æ“Žï¼ŒçŽ°åœ¨æˆ‘ä»¬æœ‰ä¸€äº›é€‰é¡¹å¯ä»¥æŽ§åˆ¶æˆ‘ä»¬å¦‚ä½•æœç´¢æ•°æ®ï¼Œæ˜¾ç¤ºç»“æžœå¹¶æŽ¢ç´¢è¿™äº›ç»“æžœã€‚ ä½†æ˜¯æˆ‘ä»¬éœ€è¦ä¸€äº›ä¸œè¥¿æ¥å°†æ‰€æœ‰å†…å®¹ç»‘å®šåˆ°Search UIçš„åŠ¨æ€å‰ç«¯ç»„ä»¶ã€‚Step 4: SearchProviderè¿™æ˜¯ç»Ÿæ²»æ‰€æœ‰å¯¹è±¡çš„å¯¹è±¡ã€‚ SearchProvideræ˜¯æ‰€æœ‰å…¶ä»–ç»„ä»¶åµŒå¥—çš„åœ°æ–¹ã€‚Search UIæä¾›äº†ä¸€ä¸ªLayoutç»„ä»¶ï¼Œç”¨äºŽç»˜åˆ¶å…¸åž‹çš„æœç´¢å¸ƒå±€ã€‚ æœ‰å¾ˆæ·±çš„è‡ªå®šä¹‰é€‰é¡¹ï¼Œä½†æˆ‘ä»¬ä¸ä¼šåœ¨æœ¬æ•™ç¨‹ä¸­ä»‹ç»ã€‚æˆ‘ä»¬å°†åšä¸¤ä»¶äº‹ï¼šå°†configurationOptionsä¼ é€’ç»™SearchProviderã€‚å°†ä¸€äº›ç»“æž„æ€§æž„å»ºåŸºå—æ”¾å…¥Layoutä¸­ï¼Œå¹¶æ·»åŠ ä¸¤ä¸ªåŸºæœ¬ç»„ä»¶ï¼šSearchBoxå’ŒResultsã€‚12345678910111213export default function App() &#123; return ( &lt;SearchProvider config=&#123;configurationOptions&#125;&gt; &lt;div className=&quot;App&quot;&gt; &lt;Layout header=&#123;&lt;SearchBox /&gt;&#125; // titleField is the most prominent field within a result: the result header. bodyContent=&#123;&lt;Results titleField=&quot;name&quot; urlField=&quot;image_url&quot; /&gt;&#125; /&gt; &lt;/div&gt; &lt;/SearchProvider&gt; );&#125;è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»åœ¨å‰ç«¯å»ºç«‹äº†åŸºç¡€ã€‚ åœ¨è¿è¡Œæ­¤åŽç«¯ä¹‹å‰ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–ç»†èŠ‚éœ€è¦åœ¨åŽç«¯è§£å†³ã€‚ æˆ‘ä»¬è¿˜åº”è¯¥ç ”ç©¶ç›¸å…³æ€§æ¨¡åž‹ï¼Œä»¥ä¾¿é’ˆå¯¹è¯¥é¡¹ç›®çš„ç‹¬ç‰¹éœ€æ±‚å¾®è°ƒæœç´¢ã€‚é‡æ–°è¿›å…¥æœç´¢å¹³å°App Searchå…·æœ‰å¼ºå¤§ä¸”å®Œå–„çš„æœç´¢å¼•æ“ŽåŠŸèƒ½ã€‚ å®ƒä½¿æ›¾ç»å¤æ‚çš„è°ƒä¼˜å˜å¾—æ›´åŠ æœ‰è¶£ã€‚ åªéœ€å•å‡»å‡ ä¸‹ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥è¿›è¡Œç»†ç²’åº¦çš„ç›¸å…³æ€§è°ƒæ•´å’Œæ— ç¼çš„æ¨¡å¼æ›´æ”¹ã€‚æˆ‘ä»¬å°†é¦–å…ˆè°ƒæ•´schemaä»¥ä½¿å…¶å®žé™…è¿è¡Œã€‚ç™»å½•åˆ°App Searchï¼Œè¾“å…¥video-gameså¼•æ“Žï¼Œç„¶åŽå•å‡»â€œManageâ€éƒ¨åˆ†ä¸‹çš„â€œSchemaâ€ã€‚å‡ºçŽ°æž¶æž„ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™11ä¸ªå­—æ®µä¸­çš„æ¯ä¸€ä¸ªå‡è¢«è§†ä¸ºæ–‡æœ¬ã€‚åœ¨configurationOptionså¯¹è±¡ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªèŒƒå›´æž„é¢æ¥å¸®åŠ©æˆ‘ä»¬æœç´¢æ•°å­—ï¼šuser_scoreå’Œcritic_scoreã€‚ ä¸ºäº†ä½¿range facetæŒ‰é¢„æœŸå·¥ä½œï¼Œå­—æ®µç±»åž‹å¿…é¡»ä¸ºæ•°å­—(number)ã€‚å•å‡»æ¯ä¸ªå­—æ®µæ—è¾¹çš„ä¸‹æ‹‰èœå•ï¼Œå°†å…¶æ›´æ”¹ä¸ºæ•°å­—ï¼Œç„¶åŽå•å‡»â€œUpdate Typesâ€ã€‚å¼•æ“Žä¼šå³æ—¶é‡æ–°æ›´æ–°ç´¢å¼•ã€‚ ç„¶åŽï¼Œå½“æˆ‘ä»¬å°†æž„é¢ï¼ˆfacetï¼‰ç»„ä»¶æ·»åŠ åˆ°å¸ƒå±€ä¸­æ—¶ï¼ŒèŒƒå›´è¿‡æ»¤å™¨å°†æŒ‰é¢„æœŸè¿è¡Œã€‚ çŽ°åœ¨ï¼Œè¿›å…¥çœŸæ­£çš„æ¼‚äº®ä¸œè¥¿ã€‚ä¸‹é¢çš„éƒ¨åˆ†æ˜¯é«˜åº¦ç›¸å…³çš„å…·æœ‰ä¸‰ä¸ªå…³é”®çš„ç›¸å…³åŠŸèƒ½ï¼šSynonymsï¼ŒCurationså’ŒRelevance Tuningã€‚åœ¨è¾¹æ ä¸­çš„â€œSearch Settingsâ€éƒ¨åˆ†ä¸‹é€‰æ‹©æ¯ä¸ªåŠŸèƒ½ï¼šSynonymsä¸–ç•Œå„åœ°çš„äººä»¬ä½¿ç”¨ä¸åŒçš„è¯æ¥å½¢å®¹äº‹ç‰©ã€‚ åŒä¹‰è¯å¯å¸®åŠ©æ‚¨åˆ›å»ºè¢«è§†ä¸ºä¸€ä¸ªæˆ–ä¸€ç»„ç›¸åŒçš„æœ¯è¯­é›†ã€‚å°±video gameæœç´¢å¼•æ“Žè€Œè¨€ï¼Œæˆ‘ä»¬çŸ¥é“äººä»¬ä¼šå¸Œæœ›æ‰¾åˆ°Final Fantasyã€‚ ä½†æ˜¯ä¹Ÿè®¸ä»–ä»¬ä¼šæ”¹ç”¨FFã€‚å•å‡»è¿›å…¥åŒä¹‰è¯ï¼Œç„¶åŽé€‰æ‹©åˆ›å»ºåŒä¹‰è¯é›†å¹¶è¾“å…¥æœ¯è¯­ï¼šå•å‡»Saveã€‚ æ‚¨å¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ ä»»æ„å¤šä¸ªåŒä¹‰è¯é›†ã€‚çŽ°åœ¨ï¼Œæœç´¢FFä¸Žæœç´¢Final Fantasyçš„æƒé‡ç›¸åŒã€‚CurationsCurationsæ˜¯æœ€æœ€è®©äººå–œæ¬¢çš„ã€‚ å¦‚æžœæœ‰äººæœç´¢Final Fantasyæˆ–FFï¼Œè¯¥æ€Žä¹ˆåŠžï¼Ÿ ç³»åˆ—èµ›ä¸­æœ‰å¾ˆå¤šæ¸¸æˆ-ä»–ä»¬ä¼šå¾—åˆ°å“ªäº›ï¼Ÿé»˜è®¤æƒ…å†µä¸‹ï¼Œå‰äº”ä¸ªç»“æžœå¦‚ä¸‹æ‰€ç¤ºï¼š1.æœ€ç»ˆå¹»æƒ³VIII2.æœ€ç»ˆå¹»æƒ³X3.æœ€ç»ˆå¹»æƒ³ç­–ç•¥4.æœ€ç»ˆå¹»æƒ³IX5.æœ€ç»ˆå¹»æƒ³XIIIè¿™ä¼¼ä¹Žä¸æ­£ç¡®â€¦â€¦Final Fantasy VIIæ˜¯æ‰€æœ‰æ¸¸æˆä¸­æœ€å¥½çš„Final Fantasyæ¸¸æˆã€‚ è€Œä¸”Final Fantasy XIIIä¸æ˜¯å¾ˆå¥½ï¼ ðŸ˜œæˆ‘ä»¬å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼Œä»¥ä¾¿æœç´¢Final Fantasyçš„äººä¼šæ”¶åˆ°Final Fantasy VIIä½œä¸ºç¬¬ä¸€ç»“æžœå—ï¼Ÿ æˆ‘ä»¬å¯ä»¥ä»Žæœç´¢ç»“æžœä¸­åˆ é™¤Final Fnatasy XIIIå—ï¼Ÿæˆ‘ä»¬å¯ä»¥ï¼å•å‡»â€œCurationsâ€ï¼Œç„¶åŽè¾“å…¥æŸ¥è¯¢ï¼šâ€œFinal Fantasyâ€ã€‚æŽ¥ä¸‹æ¥ï¼Œé€šè¿‡æŠ“ä½è¡¨æ ¼æœ€å·¦ä¾§çš„æŠŠæ‰‹å°†â€œFinal FantasyVIIâ€æ–‡æ¡£æ‹–åˆ°â€œPromoted Documentsâ€éƒ¨åˆ†ã€‚ ç„¶åŽå•å‡»â€œFinal Fantasy XIIIâ€æ–‡æ¡£ä¸Šçš„â€œHide Resultâ€æŒ‰é’®ï¼ˆé‚£ä¸ªæœ‰ä¸€æ¡çº¿ç©¿è¿‡çœ¼ç›çš„å›¾æ ‡ï¼Œä¸‹å›¾åˆ—è¡¨ä¸­ç¬¬ä¸‰ä¸ªå›¾æ ‡ï¼‰ï¼šçŽ°åœ¨ï¼Œæ‰§è¡Œâ€œFinal Fantasyâ€æˆ–â€œFFâ€æœç´¢çš„ä»»ä½•äººéƒ½å°†é¦–å…ˆçœ‹åˆ°â€œFinal Fantasy VIIâ€ã€‚ä»–ä»¬æ ¹æœ¬çœ‹ä¸åˆ°Final Fantasy XIIIã€‚ å“ˆï¼æˆ‘ä»¬å¯ä»¥å‡çº§å’Œéšè—è®¸å¤šæ–‡æ¡£ã€‚ æˆ‘ä»¬ç”šè‡³å¯ä»¥å¯¹å‡çº§åŽçš„æ–‡æ¡£è¿›è¡ŒæŽ’åºï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å®Œå…¨æŽ§åˆ¶æ¯ä¸ªæŸ¥è¯¢é¡¶éƒ¨æ˜¾ç¤ºçš„å†…å®¹ã€‚Relevance tuningå•å‡»è¾¹æ ä¸­çš„â€œRelevance Tuningâ€ã€‚æˆ‘ä»¬æœç´¢ä¸€ä¸ªæ–‡æœ¬å­—æ®µï¼šnameå­—æ®µã€‚ ä½†æ˜¯ï¼Œå¦‚æžœæˆ‘ä»¬æœ‰å¤šä¸ªæ–‡æœ¬å­—æ®µå¯ä¾›äººä»¬æœç´¢ï¼Œä¾‹å¦‚nameå­—æ®µå’Œdescriptionå­—æ®µï¼Œè¯¥æ€Žä¹ˆåŠžï¼Ÿ æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨çš„video gameæ•°æ®é›†ä¸åŒ…å«descriptionå­—æ®µï¼Œå› æ­¤æˆ‘ä»¬å‡æƒ³ä¸€äº›æ–‡æ¡£ä»¥è¿›è¡Œä»”ç»†è€ƒè™‘ã€‚è¯´æˆ‘ä»¬çš„æ–‡æ¡£çœ‹èµ·æ¥åƒè¿™æ ·ï¼š12345678&#123; &quot;name&quot;:&quot;Magical Quest&quot;, &quot;description&quot;: &quot;A dangerous journey through caves and such.&quot; &#125;,&#123; &quot;name&quot;:&quot;Dangerous Quest&quot;, &quot;description&quot;: &quot;A magical journey filled with magical magic. Highly magic.&quot; &#125;å¦‚æžœæœ‰äººæƒ³æ‰¾åˆ°æ¸¸æˆMagical Questï¼Œä»–ä»¬ä¼šè¾“å…¥è¯¥å†…å®¹ä½œä¸ºæŸ¥è¯¢ã€‚ ä½†æ˜¯ç¬¬ä¸€ä¸ªç»“æžœå°†æ˜¯Dangerous Questï¼šä¸ºä»€ä¹ˆï¼Ÿ å› ä¸ºåœ¨â€œDangerousâ€çš„descriptionä¸­â€œMagicalâ€ä¸€è¯å‡ºçŽ°äº†3æ¬¡ï¼Œæ‰€ä»¥æœç´¢å¼•æ“Žä¸ä¼šçŸ¥é“ä¸€ä¸ªå­—æ®µæ¯”å¦ä¸€ä¸ªå­—æ®µæ›´é‡è¦ã€‚ ç„¶åŽï¼Œå®ƒå°†ä½¿â€œDangerous Questâ€çš„æŽ’åæ›´é«˜ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå­˜åœ¨ç›¸å…³æ€§è°ƒæ•´çš„éš¾é¢˜ã€‚æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä¸€ä¸ªå­—æ®µï¼Œé™¤å…¶ä»–å¤–ï¼Œè¿˜å¯ä»¥å¢žåŠ å…¶ç›¸å…³æ€§çš„æƒé‡ï¼šæˆ‘ä»¬çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬å¢žåŠ æƒé‡æ—¶ï¼Œæ­£ç¡®çš„é¡¹ç›®â€œ Magical Questâ€ä¸Šå‡åˆ°é¡¶éƒ¨ï¼Œå› ä¸ºnameå­—æ®µå˜å¾—æ›´é‡è¦ã€‚ æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯å°†æ»‘å—æ‹–åŠ¨åˆ°æ›´é«˜çš„å€¼ï¼Œç„¶åŽå•å‡»â€œSaveâ€ã€‚çŽ°åœ¨ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨App Searchå®žçŽ°äº†å¦‚ä¸‹çš„ä»»åŠ¡ï¼šè°ƒæ•´schemaï¼Œå¹¶å°†user_scoreå’Œcritic_scoreæ›´æ”¹ä¸ºæ•°å­—å­—æ®µã€‚å¾®è°ƒå…³è”ï¼ˆrelevanceï¼‰æ¨¡åž‹ã€‚è¿™æ ·å°±æ€»ç»“å‡ºäº†ç²¾ç¾Žçš„â€œä»ªè¡¨æ¿â€åŠŸèƒ½-æ¯ä¸ªåŠŸèƒ½éƒ½æœ‰ä¸€ä¸ªåŒ¹é…çš„APIç«¯ç‚¹ï¼Œå¦‚æžœæ‚¨ä¸æ˜¯GUIçš„ç”¨æˆ·ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å®ƒä»¬ä½¿ç¨‹åºä»¥ç¼–ç¨‹æ–¹å¼å·¥ä½œã€‚çŽ°åœ¨ï¼Œè®©æˆ‘ä»¬ç»“æŸUIã€‚æœ€åŽåŠ å·¥æ­¤æ—¶ï¼Œæ‚¨çš„UIåº”è¯¥å¯ä»¥æ­£å¸¸å·¥ä½œäº†ã€‚ å°è¯•ä¸€äº›æŸ¥è¯¢ã€‚ é¦–å…ˆè¦è¯´çš„æ˜¯ï¼Œæˆ‘ä»¬ç¼ºå°‘æŽ¢ç´¢ç»“æžœçš„å·¥å…·ï¼Œä¾‹å¦‚è¿‡æ»¤ï¼Œåˆ†é¢(facet)ï¼ŒæŽ’åºç­‰ï¼Œä½†æ˜¯æœç´¢æœ‰æ•ˆã€‚ æˆ‘ä»¬éœ€è¦å®Œå–„ç”¨æˆ·ç•Œé¢ã€‚åœ¨åˆå§‹çš„src/App.jsæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯¼å…¥äº†ä¸‰ä¸ªåŸºæœ¬ç»„ä»¶ï¼š1import &#123; SearchProvider, Results, SearchBox &#125; from &quot;@elastic/react-search-ui&quot;;æ ¹æ®æˆ‘ä»¬ä¸ºé…ç½®é€‰é¡¹å®šä¹‰çš„å†…å®¹ï¼Œè®©æˆ‘ä»¬æ·»åŠ æ›´å¤šå†…å®¹ã€‚å¯¼å…¥ä»¥ä¸‹ç»„ä»¶å°†å¯ç”¨UIä¸­ç¼ºå°‘çš„åŠŸèƒ½ï¼šPagingInfoï¼šåœ¨å½“å‰é¡µé¢ä¸Šæ˜¾ç¤ºä¿¡æ¯ã€‚ResultsPerPageï¼šé…ç½®æ¯é¡µä¸Šæ˜¾ç¤ºå¤šå°‘ä¸ªç»“æžœã€‚Pagingï¼šæµè§ˆä¸åŒçš„é¡µé¢ã€‚Facetï¼šä»¥æ•°æ®ç±»åž‹ç‹¬æœ‰çš„æ–¹å¼è¿‡æ»¤å’Œæµè§ˆæ•°æ®ã€‚Sortï¼šé‡æ–°å®šå‘ç»™å®šå­—æ®µçš„ç»“æžœã€‚12345678910import &#123; PagingInfo, ResultsPerPage, Paging, Facet, SearchProvider, Results, SearchBox, Sorting&#125; from &quot;@elastic/react-search-ui&quot;;å¯¼å…¥åŽï¼Œå¯ä»¥å°†ç»„ä»¶æ”¾ç½®åˆ°å¸ƒå±€ä¸­ã€‚å¸ƒå±€ç»„ä»¶å°†é¡µé¢åˆ†ä¸ºå¤šä¸ªéƒ¨åˆ†ï¼Œå¯ä»¥é€šè¿‡propå°†ç»„ä»¶æ”¾ç½®åœ¨è¿™äº›éƒ¨åˆ†ä¸­ã€‚å®ƒåŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼šheaderï¼šæœç´¢æ¡†/æ bodyContentï¼šç»“æžœå®¹å™¨sideContentï¼šä¾§è¾¹æ ï¼Œå…¶ä¸­åŒ…å«æž„é¢å’ŒæŽ’åºé€‰é¡¹bodyHeaderï¼šå›´ç»•ç»“æžœçš„â€œåŒ…è£…å™¨â€ï¼Œå…¶ä¸­åŒ…å«ä¸Šä¸‹æ–‡ä¸°å¯Œçš„ä¿¡æ¯ï¼Œä¾‹å¦‚å½“å‰é¡µé¢å’Œæ¯é¡µç»“æžœæ•°bodyFooterï¼šç”¨äºŽåœ¨é¡µé¢ä¹‹é—´å¿«é€Ÿå¯¼èˆªçš„åˆ†é¡µé€‰é¡¹ç»„ä»¶å‘ˆçŽ°æ•°æ®ã€‚æ ¹æ®æˆ‘ä»¬åœ¨configurationOptionsä¸­æä¾›çš„æœç´¢è®¾ç½®èŽ·å–æ•°æ®ã€‚çŽ°åœ¨ï¼Œæˆ‘ä»¬å°†æ¯ä¸ªç»„ä»¶æ”¾ç½®åœ¨é€‚å½“çš„å¸ƒå±€éƒ¨åˆ†ä¸­ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬åœ¨configurationOptionsä¸­æè¿°äº†äº”ä¸ªæ–¹é¢çš„ç»´åº¦ï¼Œå› æ­¤æˆ‘ä»¬å°†åˆ›å»ºäº”ä¸ªæ–¹é¢çš„ç»„ä»¶ã€‚æ¯ä¸ªFacetç»„ä»¶éƒ½å°†ä½¿ç”¨â€œå­—æ®µâ€å±žæ€§ä½œä¸ºè¿”å›žæ•°æ®çš„é”®ã€‚æˆ‘ä»¬å°†å®ƒä»¬ä¸Žæˆ‘ä»¬çš„Sortingç»„ä»¶ä¸€èµ·æ”¾åœ¨sideContentéƒ¨åˆ†ä¸­ï¼Œç„¶åŽå°†Pagingï¼ŒPagingInfoå’ŒResultsPerPageç»„ä»¶æ”¾åœ¨æœ€é€‚åˆå®ƒä»¬çš„éƒ¨åˆ†ä¸­ï¼š1234567891011121314151617181920212223242526272829303132333435&lt;Layout header=&#123;&lt;SearchBox /&gt;&#125; bodyContent=&#123;&lt;Results titleField=&quot;name&quot; urlField=&quot;image_url&quot; /&gt;&#125; sideContent=&#123; &lt;div&gt; &lt;Sorting label=&#123;&quot;Sort by&quot;&#125; sortOptions=&#123;[ &#123; name: &quot;Relevance&quot;, value: &quot;&quot;, direction: &quot;&quot; &#125;, &#123; name: &quot;Name&quot;, value: &quot;name&quot;, direction: &quot;asc&quot; &#125; ]&#125; /&gt; &lt;Facet field=&quot;user_score&quot; label=&quot;User Score&quot; /&gt; &lt;Facet field=&quot;critic_score&quot; label=&quot;Critic Score&quot; /&gt; &lt;Facet field=&quot;genre&quot; label=&quot;Genre&quot; /&gt; &lt;Facet field=&quot;publisher&quot; label=&quot;Publisher&quot; isFilterable=&#123;true&#125; /&gt; &lt;Facet field=&quot;platform&quot; label=&quot;Platform&quot; /&gt; &lt;/div&gt; &#125; bodyHeader=&#123; &lt;&gt; &lt;PagingInfo /&gt; &lt;ResultsPerPage /&gt; &lt;/&gt; &#125; bodyFooter=&#123;&lt;Paging /&gt;&#125;/&gt;çŽ°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æœ¬åœ°å¼€å‘çŽ¯å¢ƒä¸­çš„æœç´¢ä½“éªŒã€‚å¥½å¤šäº†ï¼ æˆ‘ä»¬æä¾›äº†ä¸°å¯Œçš„é€‰é¡¹æ¥æŽ¢ç´¢æœç´¢ç»“æžœã€‚æˆ‘ä»¬å¼•å…¥äº†ä¸€äº›é¢å¤–çš„å¥½å¤„ï¼Œä¾‹å¦‚å¤šç§æŽ’åºé€‰é¡¹ï¼Œå¹¶ä¸”é€šè¿‡æ·»åŠ å•ä¸ªæ ‡å¿—ä½¿å‘å¸ƒè€…çš„é¢å¯è¿‡æ»¤ã€‚ å°è¯•ä½¿ç”¨ç©ºç™½æŸ¥è¯¢è¿›è¡Œæœç´¢å¹¶æµè§ˆæ‰€æœ‰é€‰é¡¹ã€‚æœ€åŽï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æœç´¢ä½“éªŒçš„æœ€åŽä¸€é¡¹åŠŸèƒ½ã€‚ è¿™æ˜¯ä¸€ä¸ªå—æ¬¢è¿Žçš„â€¦è‡ªåŠ¨å®Œæˆ (Autocomplete)æœç´¢è€…å–œæ¬¢è‡ªåŠ¨å®ŒæˆåŠŸèƒ½ï¼Œå› ä¸ºå®ƒå¯ä»¥æä¾›å³æ—¶åé¦ˆã€‚ å®ƒçš„å»ºè®®æœ‰ä¸¤ç§å½¢å¼ï¼šç»“æžœå’ŒæŸ¥è¯¢ã€‚ å–å†³äºŽå“ªç§å£å‘³ï¼Œæœç´¢è€…å°†æ”¶åˆ°ç›¸å…³ç»“æžœæˆ–å¯èƒ½å¯¼è‡´ç»“æžœçš„æ½œåœ¨æŸ¥è¯¢ã€‚æˆ‘ä»¬å°†é‡ç‚¹å…³æ³¨è‡ªåŠ¨å¡«å……ä½œä¸ºä¸€ç§æŸ¥è¯¢å»ºè®®å½¢å¼ã€‚è¿™éœ€è¦ä¸¤ä¸ªå¿«é€Ÿæ›´æ”¹ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å°†è‡ªåŠ¨å®ŒæˆåŠŸèƒ½æ·»åŠ åˆ°configurationOptionså¯¹è±¡ä¸­ï¼š123456789101112131415const configurationOptions = &#123; autocompleteQuery: &#123; suggestions: &#123; types: &#123; documents: &#123; // Which fields to search for suggestions fields: [&quot;name&quot;] &#125; &#125;, // How many suggestions appear size: 5 &#125; &#125;, ...&#125;;å…¶æ¬¡ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®SearchBoxå¯ç”¨è‡ªåŠ¨å¡«å……åŠŸèƒ½ï¼š123456... &lt;Layout ... header=&#123;&lt;SearchBox autocompleteSuggestions=&#123;true&#125; /&gt;&#125;/&gt;...æ˜¯çš„ï¼Œå°±æ˜¯è¿™æ ·ã€‚å°è¯•æœç´¢-é”®å…¥æ—¶ï¼Œå°†æ˜¾ç¤ºè‡ªåŠ¨å®ŒæˆæŸ¥è¯¢å»ºè®®ã€‚æ€»ç»“çŽ°åœ¨ï¼Œæˆ‘ä»¬æ‹¥æœ‰ç¾Žè§‚çš„åŠŸèƒ½æ€§æœç´¢ä½“éªŒã€‚ è€Œä¸”ï¼Œæˆ‘ä»¬é¿å…äº†äººä»¬åœ¨å°è¯•å®žæ–½æœç´¢æ—¶ç»å¸¸ä¼šé‡åˆ°çš„ä¸€å †é™·é˜±ã€‚ 30åˆ†é’Ÿè¿˜ä¸é”™ï¼Œä½ ä¸æ˜¯è¯´å—ï¼Ÿä½ å¯ä»¥åœ¨åœ°å€è¿›è¡Œä¸€ä¸ªå®Œç¾Žçš„ä½“éªŒã€‚å¦‚æžœä½ æƒ³è¿›ä¸€æ­¥åŠ¨æ€ç”Ÿæˆæ•°æ®é›†ï¼Œè¯·å‚é˜…æ–‡ç« https://swiftype.com/documentation/app-search/api/documents#createä½ å¯ä»¥åœ¨å¦‚ä¸‹åœ°å€æ‰¾åˆ°è¿™ä¸ªé¡¹ç›®çš„æºç ï¼šhttps://github.com/liu-xiao-guo/swiftype-video-game-searchå‚è€ƒï¼šã€1ã€‘How to Build Great React Search Experiences Quicklyâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ç‰ˆæƒå£°æ˜Žï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€ŒElasticå®˜æ–¹åšå®¢ã€çš„åŽŸåˆ›æ–‡ç« ï¼Œéµå¾ª CC 4.0 BY-SA ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŽŸæ–‡å‡ºå¤„é“¾æŽ¥åŠæœ¬å£°æ˜Žã€‚åŽŸæ–‡é“¾æŽ¥ï¼šhttps://blog.csdn.net/UbuntuTouch/article/details/103101698]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Logstash å¯åŠ¨ç›‘æŽ§åŠé›†ä¸­ç®¡ç†]]></title>
    <url>%2F2020%2F01%2F02%2FLogstash%20%E5%90%AF%E5%8A%A8%E7%9B%91%E6%8E%A7%E5%8F%8A%E9%9B%86%E4%B8%AD%E7%AE%A1%E7%90%86%2F</url>
    <content type="text"><![CDATA[åœ¨æœ¬ç¯‡æ–‡ç« é‡Œï¼Œæˆ‘å°†è¯¦ç»†ä»‹ç»å¦‚æžœå¯åŠ¨Logstashçš„ç›‘æŽ§åŠé›†ä¸­ç®¡ç†ã€‚å‰ææ¡ä»¶å®‰è£…å¥½Logstashï¼Œè®¾ç½®ElasticsearchåŠKibanaçš„å®‰å…¨å¯†ç ã€‚å¦‚ä½•ç›‘æŽ§Logstash?æˆ‘ä»¬å®‰è£…å¦‚ä¸‹çš„æ­¥éª¤æ¥å®žçŽ°ç›‘æŽ§Logstashçš„ç›®çš„ï¼šStep 1: åœ¨Kibanaä¸­å¯åŠ¨ç›‘æŽ§ï¼šç„¶åŽï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„ç”»é¢ï¼šStep 2ï¼šé…ç½®Logstashå¦‚æžœæˆ‘ä»¬åœ¨æ²¡æœ‰é…ç½®Logstashçš„æƒ…å†µä¸‹ç›´æŽ¥è¿è¡ŒLogstashï¼Œæˆ‘ä»¬ä¼šå‘çŽ°å¦‚ä¸‹çš„é”™è¯¯ï¼š123456789101112131415161718liuxg-2:logstash-7.5.0 liuxg$ ./bin/logstashJava HotSpot(TM) 64-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated in version 9.0 and will likely be removed in a future release.WARNING: An illegal reflective access operation has occurredWARNING: Illegal reflective access by com.headius.backport9.modules.Modules (file:/Users/liuxg/elastic5/logstash-7.5.0/logstash-core/lib/jars/jruby-complete-9.2.8.0.jar) to field java.io.FileDescriptor.fdWARNING: Please consider reporting this to the maintainers of com.headius.backport9.modules.ModulesWARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operationsWARNING: All illegal access operations will be denied in a future releaseThread.exclusive is deprecated, use Thread::MutexSending Logstash logs to /Users/liuxg/elastic5/logstash-7.5.0/logs which is now configured via log4j2.propertiesERROR: Pipelines YAML file is empty. Location: /Users/liuxg/elastic5/logstash-7.5.0/config/pipelines.ymlusage: bin/logstash -f CONFIG_PATH [-t] [-r] [] [-w COUNT] [-l LOG] bin/logstash --modules MODULE_NAME [-M &quot;MODULE_NAME.var.PLUGIN_TYPE.PLUGIN_NAME.VARIABLE_NAME=VALUE&quot;] [-t] [-w COUNT] [-l LOG] bin/logstash -e CONFIG_STR [-t] [--log.level fatal|error|warn|info|debug|trace] [-w COUNT] [-l LOG] bin/logstash -i SHELL [--log.level fatal|error|warn|info|debug|trace] bin/logstash -V [--log.level fatal|error|warn|info|debug|trace] bin/logstash --help[2019-12-30T15:32:49,899][ERROR][org.logstash.Logstash ] java.lang.IllegalStateException: Logstash stopped processing because of an error: (SystemExit) exité¦–å…ˆåœ¨Logstashçš„å®‰è£…ç›®å½•ä¸­æ‰¾åˆ°logstashçš„é…ç½®æ–‡ä»¶logstash.ymlï¼šæˆ‘ä»¬å¯ä»¥åœ¨Logstashçš„æ ¹ç›®å½•ä¸‹è¿è¡Œä¸€ä¸‹çš„å‘½ä»¤ï¼š1./bin/logstash-keystore createä¸Šé¢çš„å‘½ä»¤å°†åˆ›å»ºä¸€ä¸ªCreated Logstash keystoreï¼šæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¦‚ä¸‹çš„å‘½ä»¤æ¥åˆ›å»ºä¸€äº›key: ES_HOSTåŠES_PWDã€‚1./bin/logstash-keystore add ES_HOSTå½“æˆ‘ä»¬è¿è¡Œæ—¶ï¼Œå¯ä»¥æŠŠæˆ‘ä»¬çš„Elasticsearchçš„hoståœ°å€ç²˜è´´è¿‡æ¥ï¼šæ¯”å¦‚é’ˆå¯¹æˆ‘ä»¬çš„æƒ…å†µï¼Œæˆ‘ä»¬ç²˜è´´çš„åœ°å€æ˜¯http://localhost:9200/ã€‚æŒ‰ç…§åŒæ ·çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºå¦å¤–ä¸€ä¸ªES_PWD keyï¼š1./bin/logstash-keystore add ES_PWDè¿™äº›keyå¯ä»¥åœ¨logstashçš„é…ç½®æ–‡ä»¶ä¸­æ‰€ä½¿ç”¨ã€‚è¿™æ ·æˆ‘ä»¬å¯ä»¥ä¸æš´éœ²æˆ‘ä»¬çš„å¯†ç ç»™åˆ«äººçœ‹åˆ°ã€‚æˆ‘ä»¬æ‰“å¼€logstash.ymlæ–‡ä»¶ï¼Œå¹¶åŒæ—¶ä½¿ç”¨å¦‚ä¸‹çš„é…ç½®ï¼š1234xpack.monitoring.enabled: truexpack.monitoring.elasticsearch.username: logstash_systemxpack.monitoring.elasticsearch.password: &quot;$&#123;ES_PWD&#125;&quot;xpack.monitoring.elasticsearch.hosts: [&quot;$&#123;ES_HOST&#125;&quot;]è¿™é‡Œï¼Œæˆ‘ä»¬æ‰“å¼€monitoringçš„å¼€å…³ï¼Œå¹¶åŒæ—¶ä½¿ç”¨æˆ‘ä»¬åœ¨åˆ›å»ºå®‰å…¨è´¦æˆ·å·²ç»åˆ›å»ºå¥½çš„ç”¨æˆ·ålogstash_system:çŽ°åœ¨æˆ‘ä»¬ä¸‹è½½ä¸€ä¸ªæˆ‘ä¹‹å‰åšä¸ªçš„ä¸€ä¸ªç»ƒä¹ ï¼š1git clone https://github.com/liu-xiao-guo/logstash_multi-pipelineæˆ‘ä»¬å¯ä»¥ä¸‹è½½åˆ°æˆ‘ä»¬æŒ‡å®šçš„ç›®å½•é‡Œã€‚ä½†æ˜¯è®°å¾—ä¿®æ”¹åœ¨apache.confä¸­çš„pathè·¯å¾„ï¼Œå¦åˆ™æˆ‘ä»¬ä¼šé”™çš„ã€‚123456789101112131415161718192021222324252627282930313233343536apache.confinput &#123; file &#123; path =&gt; &quot;/Users/liuxg/data/multi-pipeline/apache.log&quot; start_position =&gt; &quot;beginning&quot; sincedb_path =&gt; &quot;/dev/null&quot; # ignore_older =&gt; 100000 type =&gt; &quot;apache&quot; &#125;&#125;filter &#123; grok &#123; match =&gt; &#123; &quot;message&quot; =&gt; &apos;%&#123;IPORHOST:clientip&#125; %&#123;USER:ident&#125; %&#123;USER:auth&#125; \[%&#123;HTTPDATE:timestamp&#125;\] &quot;%&#123;WORD:verb&#125; %&#123;DATA:request&#125; HTTP/%&#123;NUMBER:httpversion&#125;&quot; %&#123;NUMBER:response:int&#125; (?:-|%&#123;NUMBER:bytes:int&#125;) %&#123;QS:referrer&#125; %&#123;QS:agent&#125;&apos; &#125; &#125;&#125;output &#123; stdout &#123; codec =&gt; rubydebug &#125; elasticsearch &#123; hosts =&gt; [&quot;$&#123;ES_HOST&#125;&quot;] user =&gt; &quot;elastic&quot; password =&gt; &quot;$&#123;ES_PWD&#125;&quot; index =&gt; &quot;apache_log&quot; template =&gt; &quot;/Users/liuxg/data/multi-pipeline/apache_template.json&quot; template_name =&gt; &quot;apache_elastic_example&quot; template_overwrite =&gt; true &#125; &#125;åŒæ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ hosts, useråŠpasswordçš„å®šä¹‰ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬çŽ°åœ¨æˆ‘ä»¬æ˜¯éœ€è¦æœ‰ç”¨æˆ·ååŠå¯†ç æ‰å¯ä»¥è¿žæŽ¥åˆ°Elasticsearchã€‚è¿™ä¸ªå’Œä¹‹å‰çš„ç»ƒä¹ æ˜¯ä¸ä¸€æ ·çš„ã€‚åŒæ—¶æˆ‘ä»¬å¯ä»¥åˆ›å»ºè‡ªå·±çš„ç”¨æˆ·ååŠå¯†ç ã€‚æˆ‘ä»¬å¯ä»¥å‚è€ƒâ€œElasticsearchï¼šç”¨æˆ·å®‰å…¨è®¾ç½®â€æ¥åˆ›å»ºè‡ªå·±å–œæ¬¢çš„è´¦å·ã€‚åœ¨è¿™é‡Œï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬ä½¿ç”¨elasticè´¦å·ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ˜¯ç”¨${ES_HOST}åŠ${ES_PWD}æ¥ä»£è¡¨æˆ‘ä»¬çš„Elasticsearchåœ°å€åŠå¯†ç ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯æˆ‘ä»¬ä¸æš´éœ²æˆ‘ä»¬çš„å¯†ç åœ¨é…ç½®æ–‡ä»¶ä¸­ã€‚ä¸€æ—¦ä¸Šé¢çš„é…ç½®å·²ç»åšå¥½äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„å‘½ä»¤æ¥æŠŠæˆ‘ä»¬çš„apache logæ–‡ä»¶ä¸Šä¼ åˆ°Elasticsearchä¹‹ä¸­ï¼š1sudo ./bin/logstash -f ~/data/multi-pipeline/apache.confStep3ï¼šæ‰“å¼€Stack Monitoring UIæˆ‘ä»¬å®‰è£…å¦‚ä¸‹çš„æ­¥éª¤æ¥æŸ¥çœ‹Logstashçš„monitoringï¼šæˆ‘ä»¬ä¼šå‘çŽ°åœ¨Logstashè¿è¡Œçš„æƒ…å†µä¸‹ï¼Œæœ‰ä¸€ä¸ªLogstashçš„ç±»åˆ«å‡ºçŽ°äº†ã€‚è¿™åœ¨ä¹‹å‰æ˜¯æ²¡æœ‰çš„ã€‚æˆ‘ä»¬ç‚¹å‡»Nodes 1ï¼šæˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ªLogstashçš„è¿è¡Œå®žä¾‹ã€‚å®ƒæ˜¾ç¤ºäº†ç›®å‰CPUçš„ä½¿ç”¨æƒ…å†µå’ŒLoad AverageåŠJVM headçš„ä½¿ç”¨æƒ…å†µã€‚ç‚¹å‡»ä¸Šé¢çš„è¶…é“¾æŽ¥ï¼šæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ›´åŠ è¯¦ç»†çš„ä½¿ç”¨æƒ…å†µã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æŸ¥çœ‹pipelineçš„çŠ¶å†µï¼šLogstashé›†ä¸­ç®¡ç†é¦–å…ˆæˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªå«åšlogstash_writerçš„role:ç‚¹å‡»â€œCreate roleâ€æ¥åˆ›å»ºæˆ‘ä»¬çš„roleã€‚é¦–å…ˆè®©æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªå…·æœ‰logstash_userçš„ç”¨æˆ·è´¦å·ï¼šç‚¹å‡»ä¸Šé¢çš„â€œCreate userâ€æŒ‰é’®æ¥åˆ›å»ºä¸€ä¸ªç”¨æˆ·ï¼šç‚¹å‡»â€œCreate userâ€æ¥åˆ›å»ºä¸€ä¸ªå«åšlogstash_userçš„è´¦å·ã€‚å®ƒå…·æœ‰logstash_adminåŠlogstash_systemçš„æƒé™ã€‚ä¸ºäº†å¯åŠ¨é›†ä¸­ç®¡ç†ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨logstash.ymlæ–‡ä»¶é‡Œåšç›¸åº”çš„é…ç½®ï¼š12345xpack.management.enabled: truexpack.management.pipeline.id: [&quot;main&quot;, &quot;apache_logs&quot;, &quot;my_apache_logs&quot;]xpack.management.elasticsearch.username: &quot;logstash_user&quot;xpack.management.elasticsearch.password: &quot;123456&quot;xpack.management.elasticsearch.hosts: [&quot;$&#123;ES_HOST&#125;&quot;]æˆ‘ä»¬å¯ä»¥åœ¨é“¾æŽ¥https://www.elastic.co/guide/en/logstash/current/logstash-centralized-pipeline-management.htmlæ‰¾åˆ°æ›´å¤šçš„æè¿°ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯åŠ¨logstashçš„ç®¡ç†ï¼ŒåŒæ—¶ä¹ŸæŠŠæˆ‘ä»¬åˆšæ‰åˆ›å»ºçš„logstash_userçš„è´¦å·å¡«å…¥è¿›æ¥ï¼Œå¹¶åŒæ—¶å–äº†ä¸€ä¸ªå«åšmy_apache_logsçš„pipeline idã€‚ä¸€æ—¦å¯åŠ¨äº†logstashçš„é›†ä¸­ç®¡ç†ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æŽ¥å¯åŠ¨logstashï¼Œè€Œä¸ç”¨è·Ÿä»»ä½•çš„å‚æ•°ï¼š1sudo ./bin/logstashè¿™æ ·æˆ‘ä»¬çš„logstashå·²ç»è¢«æˆåŠŸè¿è¡Œèµ·æ¥äº†ã€‚æˆ‘ä»¬æŽ¥ä¸‹æ¥å¯ä»¥åœ¨Kibanaä¸­åˆ›å»ºè‡ªå·±çš„pipelineã€‚ç‚¹å‡»ä¸Šé¢çš„â€œCreate pipelineâ€æŒ‰é’®ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„ç”»é¢ï¼šæŽ¥ä¸‹æ¥æˆ‘ä»¬ç‚¹å‡»â€œCreate and Deployâ€æŒ‰é’®ï¼šè¿™æ ·æˆ‘ä»¬çš„my_apache_logså°±è¢«åˆ›å»ºå¥½äº†ï¼Œè€Œä¸”å·²ç»è¢«æˆåŠŸæ‰§è¡Œäº†ã€‚æˆ‘ä»¬å¯ä»¥åœ¨Kibanaä¸­åˆ›å»ºä¸€ä¸ªå«apache_logçš„index patternï¼Œç„¶åŽæ‰“å¼€Discoverï¼Œä½ å¯ä»¥çœ‹åˆ°åˆšåˆšè¢«Logstashå¯¼å…¥çš„æ•°æ®ï¼šå¥½äº†åˆ°æ­¤ï¼Œæˆ‘ä»¬å…³äºŽå¦‚ä½•å¯åŠ¨Logstashçš„ç›‘æŽ§åŠé›†ä¸­ç®¡ç†è®²å®Œäº†ã€‚â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ç‰ˆæƒå£°æ˜Žï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€ŒElastic ä¸­å›½ç¤¾åŒºå®˜æ–¹åšå®¢ã€çš„åŽŸåˆ›æ–‡ç« ï¼Œéµå¾ª CC 4.0 BY-SA ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŽŸæ–‡å‡ºå¤„é“¾æŽ¥åŠæœ¬å£°æ˜Žã€‚åŽŸæ–‡é“¾æŽ¥ï¼šhttps://blog.csdn.net/UbuntuTouch/article/details/103767088]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[lasticsearchï¼šIndex alias]]></title>
    <url>%2F2020%2F01%2F02%2Flasticsearch%EF%BC%9AIndex%20alias%2F</url>
    <content type="text"><![CDATA[çŽ°åœ¨è®©æˆ‘ä»¬æ¥è°ˆè°ˆElasticsearchæœ€ç®€å•å’Œæœ€æœ‰ç”¨çš„åŠŸèƒ½ä¹‹ä¸€ï¼šåˆ«å ï¼ˆalias)ã€‚ä¸ºäº†åŒºåˆ†è¿™é‡Œaliaså’Œæ–‡ç« â€œElasticsearch : aliasæ•°æ®ç±»åž‹â€ï¼Œè¿™é‡Œçš„åˆ«åï¼ˆaliasï¼‰æŒ‡çš„æ˜¯indexçš„åˆ«åã€‚ åˆ«åæ­£æ˜¯ä»–ä»¬å¬èµ·æ¥çš„æ ·å­; å®ƒä»¬æ˜¯æ‚¨å¯ä»¥ä½¿ç”¨çš„æŒ‡é’ˆæˆ–åç§°ï¼Œå¯¹åº”äºŽä¸€ä¸ªæˆ–å¤šä¸ªå…·ä½“ç´¢å¼•ã€‚ äº‹å®žè¯æ˜Žè¿™éžå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒåœ¨æ‰©å±•é›†ç¾¤å’Œç®¡ç†æ•°æ®åœ¨ç´¢å¼•ä¸­çš„å¸ƒå±€æ–¹å¼æ—¶æä¾›äº†çµæ´»æ€§ã€‚ å³ä½¿ä½¿ç”¨Elasticsearch åªæœ‰ä¸€ä¸ªç´¢å¼•çš„é›†ç¾¤ï¼Œä½¿ç”¨åˆ«åã€‚ æ‚¨å°†åœ¨ä»¥åŽæ„Ÿè°¢æˆ‘ä»¬ç»™äºˆæ‚¨çš„çµæ´»æ€§ã€‚åˆ«ååˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿæ‚¨å¯èƒ½æƒ³çŸ¥é“åˆ«åç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Œä»¥åŠElasticsearchåœ¨åˆ›å»ºåˆ«åæ—¶æ¶‰åŠä½•ç§å¼€é”€ã€‚ åˆ«åå°†å…¶ç”Ÿå‘½ç½®äºŽç¾¤é›†çŠ¶æ€å†…ï¼Œç”±ä¸»èŠ‚ç‚¹ï¼ˆmaster node)ç®¡ç†; è¿™æ„å‘³ç€å¦‚æžœä½ æœ‰ä¸€ä¸ªåä¸ºidahoçš„åˆ«åæŒ‡å‘ä¸€ä¸ªåä¸ºpotatoçš„ç´¢å¼•ï¼Œé‚£ä¹ˆå¼€é”€å°±æ˜¯ç¾¤é›†çŠ¶æ€æ˜ å°„ä¸­çš„ä¸€ä¸ªé¢å¤–é”®ï¼Œå®ƒå°†åç§°idahoæ˜ å°„åˆ°å…·ä½“çš„ç´¢å¼•å­—ç¬¦ä¸²ã€‚ è¿™æ„å‘³ç€ä¸Žå…¶ä»–æŒ‡æ•°ç›¸æ¯”ï¼Œåˆ«åçš„é‡é‡è¦è½»å¾—å¤š; å¯ä»¥ç»´æŠ¤æ•°åƒä¸ªè€Œä¸ä¼šå¯¹é›†ç¾¤äº§ç”Ÿè´Ÿé¢å½±å“ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä¼šè­¦å‘Šä¸è¦åˆ›å»ºæ•°åä¸‡æˆ–æ•°ç™¾ä¸‡ä¸ªåˆ«åï¼Œå› ä¸ºåœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œå³ä½¿æ˜ å°„ä¸­å•ä¸ªæ¡ç›®çš„æœ€å°å¼€é”€ä¹Ÿä¼šå¯¼è‡´é›†ç¾¤çŠ¶æ€å¢žé•¿åˆ°å¤§å°ã€‚ è¿™æ„å‘³ç€åˆ›å»ºæ–°ç¾¤é›†çŠ¶æ€çš„æ“ä½œå°†èŠ±è´¹æ›´é•¿æ—¶é—´ï¼Œå› ä¸ºæ¯æ¬¡æ›´æ”¹æ—¶éƒ½ä¼šå°†æ•´ä¸ªç¾¤é›†çŠ¶æ€å‘é€åˆ°æ¯ä¸ªèŠ‚ç‚¹ã€‚ä¸ºä»€ä¹ˆåˆ«åæ˜¯æœ‰ç”¨çš„ï¼Ÿæˆ‘ä»¬å»ºè®®æ¯ä¸ªäººéƒ½ä¸ºä»–ä»¬çš„Elasticsearchç´¢å¼•ä½¿ç”¨åˆ«åï¼Œå› ä¸ºåœ¨é‡æ–°ç´¢å¼•æ—¶ï¼Œå®ƒå°†åœ¨æœªæ¥æä¾›æ›´å¤§çš„çµæ´»æ€§ã€‚ å‡è®¾æ‚¨é¦–å…ˆåˆ›å»ºä¸€ä¸ªåŒ…å«å•ä¸ªä¸»åˆ†ç‰‡çš„ç´¢å¼•ï¼Œç„¶åŽå†å†³å®šæ˜¯å¦éœ€è¦æ›´å¤šç´¢å¼•å®¹é‡ã€‚ å¦‚æžœæ‚¨ä½¿ç”¨åŽŸå§‹åˆ«åindexï¼Œæ‚¨çŽ°åœ¨å¯ä»¥å°†è¯¥åˆ«åæ›´æ”¹ä¸ºæŒ‡å‘å¦å¤–åˆ›å»ºçš„ç´¢å¼•ï¼Œè€Œæ— éœ€æ›´æ”¹æ‚¨æ­£åœ¨æœç´¢çš„ç´¢å¼•çš„åç§°ï¼ˆå‡è®¾æ‚¨ä»Žå¤´å¼€å§‹ä½¿ç”¨åˆ«åè¿›è¡Œæœç´¢ï¼‰ã€‚ å¦ä¸€ä¸ªæœ‰ç”¨çš„åŠŸèƒ½æ˜¯å¯ä»¥åˆ›å»ºä¸åŒç´¢å¼•çš„çª—å£; ä¾‹å¦‚ï¼Œå¦‚æžœæ‚¨ä¸ºæ•°æ®åˆ›å»ºæ¯æ—¥ç´¢å¼•ï¼Œåˆ™å¯èƒ½éœ€è¦åˆ›å»ºä¸€ä¸ªåä¸ºlast-7-daysçš„åˆ«åçš„ä¸Šå‘¨æ•°æ®çš„æ»‘åŠ¨çª—å£; ç„¶åŽæ¯å¤©åˆ›å»ºæ–°çš„æ¯æ—¥ç´¢å¼•æ—¶ï¼Œå¯ä»¥å°†å…¶æ·»åŠ åˆ°åˆ«åä¸­ï¼ŒåŒæ—¶åˆ é™¤8å¤©çš„ç´¢å¼•ã€‚å¦å¤–çš„ä¸€ç§åœºæ™¯æ˜¯ï¼Œå½“æˆ‘ä»¬ä¿®æ”¹äº†æˆ‘ä»¬çš„indexçš„mappingï¼Œè®©åŽé€šè¿‡reindex APIæ¥æŠŠæˆ‘ä»¬çš„çŽ°æœ‰çš„indexè½¬ç§»åˆ°æ–°çš„indexä¸Šï¼Œé‚£ä¹ˆå¦‚æžœåœ¨æˆ‘ä»¬çš„åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨aliaså°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°åšè¿™é—´äº‹ã€‚åœ¨æˆ‘ä»¬æˆåŠŸè½¬ç§»åˆ°æ–°çš„indexä¹‹åŽï¼Œæˆ‘ä»¬åªéœ€è¦é‡æ–°å®šä¹‰æˆ‘ä»¬çš„aliasæŒ‡å‘æ–°çš„indexï¼Œè€Œåœ¨æˆ‘ä»¬çš„å®¢æˆ·ç«¯ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä¸€ç›´ä½¿ç”¨aliasæ¥è®¿é—®æˆ‘ä»¬çš„indexï¼Œè¿™æ ·æˆ‘ä»¬çš„ä»£ç ä¸éœ€è¦ä»»ä½•çš„æ”¹åŠ¨ã€‚å»ºç«‹indexä¸ºäº†éªŒè¯æˆ‘ä»¬çš„APIï¼Œæˆ‘ä»¬å…ˆå»ºç«‹ä¸€äº›æ•°æ®ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647PUT twitter/_doc/1&#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125;&#125; PUT twitter/_doc/2&#123; &quot;user&quot; : &quot;ä¸œåŸŽåŒº-è€åˆ˜&quot;, &quot;message&quot; : &quot;å‡ºå‘ï¼Œä¸‹ä¸€ç«™äº‘å—ï¼&quot;, &quot;uid&quot; : 3, &quot;age&quot; : 30, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚ä¸œåŸŽåŒºå°åŸºåŽ‚ä¸‰æ¡3å·&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.904313&quot;, &quot;lon&quot; : &quot;116.412754&quot; &#125;&#125; PUT twitter/_doc/3&#123; &quot;user&quot; : &quot;è™¹æ¡¥-è€å´&quot;, &quot;message&quot; : &quot;å¥½å‹æ¥äº†éƒ½ä»Šå¤©æˆ‘ç”Ÿæ—¥ï¼Œå¥½å‹æ¥äº†,ä»€ä¹ˆ birthday happy å°±æˆ!&quot;, &quot;uid&quot; : 7, &quot;age&quot; : 90, &quot;city&quot; : &quot;ä¸Šæµ·&quot;, &quot;province&quot; : &quot;ä¸Šæµ·&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½ä¸Šæµ·å¸‚é—µè¡ŒåŒº&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;31.175927&quot;, &quot;lon&quot; : &quot;121.383328&quot; &#125;&#125;è¿™æ ·ï¼Œæˆ‘ä»¬å»ºç«‹äº†ä¸‰ä¸ªæ–‡æ¡£çš„twitterç´¢å¼•ã€‚ç®¡ç†åˆ«åæ·»åŠ ä¸€ä¸ªindex aliasä¸€ä¸ªindexåˆ«åå°±æ˜¯ä¸€ä¸ªç”¨æ¥å¼•ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªå·²ç»å­˜åœ¨çš„ç´¢å¼•çš„å¦å¤–ä¸€ä¸ªåå­—ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹çš„æ–¹æ³•æ¥åˆ›å»º1PUT /twitter/_alias/alias1è¯·æ±‚çš„æ ¼å¼ï¼š1234PUT /&lt;index&gt;/_alias/&lt;alias&gt;POST /&lt;index&gt;/_alias/&lt;alias&gt;PUT /&lt;index&gt;/_aliases/&lt;alias&gt;POST /&lt;index&gt;/_aliases/&lt;alias&gt;è·¯å¾„å‚æ•°ï¼š123&lt;index&gt;:è¦æ·»åŠ åˆ°åˆ«åçš„ç´¢å¼•åç§°çš„é€—å·åˆ†éš”åˆ—è¡¨æˆ–é€šé…ç¬¦è¡¨è¾¾å¼ã€‚ è¦å°†ç¾¤é›†ä¸­çš„æ‰€æœ‰ç´¢å¼•æ·»åŠ åˆ°åˆ«åï¼Œè¯·ä½¿ç”¨_allå€¼ã€‚&lt;alias&gt;:(å¿…éœ€,å­—ç¬¦ä¸²)è¦åˆ›å»ºæˆ–æ›´æ–°çš„ç´¢å¼•åˆ«åçš„åç§°ã€‚æ¯”å¦‚ç»è¿‡ä¸Šé¢çš„REST è¯·æ±‚ï¼Œæˆ‘ä»¬ä¸ºtwitteråˆ›å»ºäº†å¦å¤–ä¸€ä¸ªåˆ«åalias1ã€‚æˆ‘ä»¬ä»¥åŽå¯ä»¥é€šè¿‡alias1æ¥è®¿é—®è¿™ä¸ªindex:1GET alias1/_searchæ˜¾ç¤ºçš„ç»“æžœï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677&#123; &quot;took&quot; : 0, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 3, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 1.0, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;4&quot;, &quot;_score&quot; : 1.0, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;æœé˜³åŒº-è€è´¾&quot;, &quot;message&quot; : &quot;123,gogogo&quot;, &quot;uid&quot; : 5, &quot;age&quot; : 35, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æœé˜³åŒºå»ºå›½é—¨&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.718256&quot;, &quot;lon&quot; : &quot;116.367910&quot; &#125; &#125; &#125;, &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;5&quot;, &quot;_score&quot; : 1.0, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;æœé˜³åŒº-è€çŽ‹&quot;, &quot;message&quot; : &quot;Happy BirthDay My Friend!&quot;, &quot;uid&quot; : 6, &quot;age&quot; : 50, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æœé˜³åŒºå›½è´¸&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.918256&quot;, &quot;lon&quot; : &quot;116.467910&quot; &#125; &#125; &#125;, &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;6&quot;, &quot;_score&quot; : 1.0, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;è™¹æ¡¥-è€å´&quot;, &quot;message&quot; : &quot;å¥½å‹æ¥äº†éƒ½ä»Šå¤©æˆ‘ç”Ÿæ—¥ï¼Œå¥½å‹æ¥äº†,ä»€ä¹ˆ birthday happy å°±æˆ!&quot;, &quot;uid&quot; : 7, &quot;age&quot; : 90, &quot;city&quot; : &quot;ä¸Šæµ·&quot;, &quot;province&quot; : &quot;ä¸Šæµ·&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½ä¸Šæµ·å¸‚é—µè¡ŒåŒº&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;31.175927&quot;, &quot;lon&quot; : &quot;121.383328&quot; &#125; &#125; &#125;, ...æ˜¾ç„¶è¿™æ ·åšçš„å¥½å¤„æ˜¯éžå¸¸æ˜Žæ˜¾çš„ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæˆ‘ä»¬æƒ³è¦çš„è¿›è¡Œæœç´¢çš„indexå–ä¸€ä¸ªå’Œæˆ‘ä»¬æœç´¢æ–¹æ³•é‡Œä¸€æ ·çš„åˆ«åå°±å¯ä»¥äº†ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥ä¸ä¿®æ”¹æˆ‘ä»¬çš„æœç´¢æ–¹æ³•ï¼Œå°±å¯ä»¥åˆ†åˆ«å¯¹ä¸åŒçš„indexè¿›è¡Œæœç´¢ã€‚æ¯”å¦‚æˆ‘ä»¬å¯ä»¥ç”¨åŒæ ·çš„æœç´¢æ–¹æ³•å¯¹æ¯å¤©çš„logè¿›è¡Œåˆ†æžã€‚åªæœ‰æŠŠæ¯å¤©çš„logçš„indexçš„åå­—éƒ½æ”¹æˆä¸€æ ·çš„aliaså°±å¯ä»¥äº†ã€‚åˆ›å»ºä¸€ä¸ªåŸºäºŽåŸŽå¸‚çš„aliasï¼š12345678PUT twitter/_alias/city_beijing&#123; &quot;filter&quot;: &#123; &quot;term&quot;: &#123; &quot;city&quot;: &quot;åŒ—äº¬&quot; &#125; &#125;&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåç§°ä¸ºcity_beijingçš„aliasã€‚å¦‚æžœæˆ‘ä»¬è¿è¡Œå¦‚ä¸‹çš„æœç´¢ï¼š1GET city_beijing/_searchå®ƒå°†è¿”å›žæ‰€æœ‰å…³äºŽåŸŽå¸‚ä¸ºåŒ—äº¬çš„æœç´¢ç»“æžœï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455&#123; &quot;took&quot; : 1, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 4, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 1.0, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;4&quot;, &quot;_score&quot; : 1.0, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;æœé˜³åŒº-è€è´¾&quot;, &quot;message&quot; : &quot;123,gogogo&quot;, &quot;uid&quot; : 5, &quot;age&quot; : 35, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æœé˜³åŒºå»ºå›½é—¨&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.718256&quot;, &quot;lon&quot; : &quot;116.367910&quot; &#125; &#125; &#125;, &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;5&quot;, &quot;_score&quot; : 1.0, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;æœé˜³åŒº-è€çŽ‹&quot;, &quot;message&quot; : &quot;Happy BirthDay My Friend!&quot;, &quot;uid&quot; : 6, &quot;age&quot; : 50, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æœé˜³åŒºå›½è´¸&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.918256&quot;, &quot;lon&quot; : &quot;116.467910&quot; &#125;...aliasä¹Ÿå¯ä»¥åœ¨åˆ›å»ºindexæ—¶è¢«åˆ›å»ºï¼Œæ¯”å¦‚ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778DELETE twitter PUT twitter&#123; &quot;mappings&quot; : &#123; &quot;properties&quot; : &#123; &quot;address&quot; : &#123; &quot;type&quot; : &quot;text&quot;, &quot;fields&quot; : &#123; &quot;keyword&quot; : &#123; &quot;type&quot; : &quot;keyword&quot;, &quot;ignore_above&quot; : 256 &#125; &#125; &#125;, &quot;age&quot; : &#123; &quot;type&quot; : &quot;long&quot; &#125;, &quot;city&quot; : &#123; &quot;type&quot; : &quot;keyword&quot;, &quot;copy_to&quot; : [ &quot;region&quot; ] &#125;, &quot;country&quot; : &#123; &quot;type&quot; : &quot;keyword&quot;, &quot;copy_to&quot; : [ &quot;region&quot; ] &#125;, &quot;explain&quot; : &#123; &quot;type&quot; : &quot;boolean&quot; &#125;, &quot;location&quot; : &#123; &quot;type&quot; : &quot;geo_point&quot; &#125;, &quot;message&quot; : &#123; &quot;type&quot; : &quot;text&quot;, &quot;fields&quot; : &#123; &quot;keyword&quot; : &#123; &quot;type&quot; : &quot;keyword&quot;, &quot;ignore_above&quot; : 256 &#125; &#125; &#125;, &quot;province&quot; : &#123; &quot;type&quot; : &quot;keyword&quot;, &quot;copy_to&quot; : [ &quot;region&quot; ] &#125;, &quot;region&quot; : &#123; &quot;type&quot; : &quot;text&quot; &#125;, &quot;uid&quot; : &#123; &quot;type&quot; : &quot;long&quot; &#125;, &quot;user&quot; : &#123; &quot;type&quot; : &quot;text&quot;, &quot;fields&quot; : &#123; &quot;keyword&quot; : &#123; &quot;type&quot; : &quot;keyword&quot;, &quot;ignore_above&quot; : 256 &#125; &#125; &#125; &#125; &#125;, &quot;aliases&quot;: &#123; &quot;city_beijing&quot;: &#123; &quot;filter&quot;: &#123; &quot;term&quot;: &#123; &quot;city&quot;: &quot;åŒ—äº¬&quot; &#125; &#125; &#125; &#125;&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åˆ é™¤äº†twitterç´¢å¼•ï¼ŒåŒæ—¶æˆ‘ä»¬é‡æ–°å®šä¹‰twitterç´¢å¼•çš„mappingï¼Œå¹¶åŒæ—¶å®šä¹‰äº†city_beijingä½ åˆ«åã€‚é‡æ–°indexæˆ‘ä»¬ä¸Šé¢çš„ä¸‰ä¸ªæ–‡æ¡£ï¼Œé‚£ä¹ˆæˆ‘ä»¬å†æ¬¡æœç´¢æˆ‘ä»¬çš„æ•°æ®ï¼š1GET city_beijing/_searchæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªåŸŽå¸‚ä¸ºåŒ—äº¬çš„æœç´¢ç»“æžœï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859&#123; &quot;took&quot; : 0, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 2, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 1.0, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 1.0, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125; &#125; &#125;, &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;2&quot;, &quot;_score&quot; : 1.0, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;ä¸œåŸŽåŒº-è€åˆ˜&quot;, &quot;message&quot; : &quot;å‡ºå‘ï¼Œä¸‹ä¸€ç«™äº‘å—ï¼&quot;, &quot;uid&quot; : 3, &quot;age&quot; : 30, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚ä¸œåŸŽåŒºå°åŸºåŽ‚ä¸‰æ¡3å·&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.904313&quot;, &quot;lon&quot; : &quot;116.412754&quot; &#125; &#125; &#125; ] &#125;&#125;èŽ·å–aliasæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„APIæ¥èŽ·å–å½“å‰ä»¥åŠå®šä¹‰å¥½çš„alias:123GET /_aliasGET /_alias/&lt;alias&gt;GET /&lt;index&gt;/_alias/&lt;alias&gt;æ¯”å¦‚ï¼š1GET /twitter/_alias/alias1è¿™é‡ŒèŽ·å–åœ¨twitterä¸‹çš„åå­—å«åšalias1çš„åˆ«åã€‚é’ˆå¯¹æˆ‘ä»¬çš„æƒ…å†µï¼Œæˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹çš„æŽ¥å£ï¼š1GET /twitter/_alias/city_beijingæˆ‘ä»¬èŽ·å–æˆ‘ä»¬ä¹‹å‰å¾—åˆ°çš„city_beijingçš„aliasã€‚æ˜¾ç¤ºçš„ç»“æžœå¦‚ä¸‹ï¼š12345678910111213&#123; &quot;twitter&quot; : &#123; &quot;aliases&quot; : &#123; &quot;city_beijing&quot; : &#123; &quot;filter&quot; : &#123; &quot;term&quot; : &#123; &quot;city&quot; : &quot;åŒ—äº¬&quot; &#125; &#125; &#125; &#125; &#125;&#125;ä½ ä¹Ÿå¯ä»¥é€šè¿‡å¦‚ä¸‹çš„wild cardæ–¹å¼æ¥èŽ·å–æ‰€æœ‰çš„alias:1GET /twitter/_alias/*æ¯”å¦‚ï¼Œæˆ‘ä»¬æ–°å¢žåŠ ä¸€ä¸ªalias1çš„åˆ«åï¼š1PUT /twitter/_alias/alias1ä¸Šé¢çš„wild cardæ–¹å¼è¿”å›žæ¥å¾—ç»“æžœä¸ºï¼š1234567891011121314&#123; &quot;twitter&quot; : &#123; &quot;aliases&quot; : &#123; &quot;alias1&quot; : &#123; &#125;, &quot;city_beijing&quot; : &#123; &quot;filter&quot; : &#123; &quot;term&quot; : &#123; &quot;city&quot; : &quot;åŒ—äº¬&quot; &#125; &#125; &#125; &#125; &#125;&#125;æ˜¾ç„¶è¿™é‡Œæœ‰ä¸¤ä¸ªåˆ«åï¼šalias1åŠcity_beijingã€‚ä½ å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹å¼æ¥æœå¯»ä½ çš„alias:1GET /_alias/city_*å®ƒå°†æ˜¾ç¤ºåå­—ä»¥cityå¼€å§‹çš„æ‰€æœ‰çš„aliasã€‚æ£€æŸ¥ä¸€ä¸ªaliasæ˜¯å¦å­˜åœ¨æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹å¼æ¥æ£€æŸ¥ä¸€ä¸ªaliasæ˜¯å¦å­˜åœ¨ï¼š12HEAD /_alias/&lt;alias&gt;HEAD /&lt;index&gt;/_alias/&lt;alias&gt;æ¯”å¦‚ï¼š1HEAD /_alias/alias1å®ƒæ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š1200 - OKåŒæ ·ä½ ä¹Ÿå¯é€šè¿‡wild cardæ–¹å¼æ¥æŸ¥è¯¢ï¼š1HEAD /_alias/city*è¿™ä¸ªç”¨æ¥æ£€æŸ¥æ‰€æœ‰ä»¥cityä¸ºå¼€å¤´çš„aliasã€‚æ›´æ–°aliasæˆ‘ä»¬è¿™é‡Œæ‰€è¯´çš„æ›´æ–°åŒ…æ‹¬ï¼šæ·»åŠ åŠåˆ é™¤æŽ¥å£ä¸ºï¼š1POST /_aliasesæ¯”å¦‚ï¼š123456POST /_aliases&#123; &quot;actions&quot; : [ &#123; &quot;add&quot; : &#123; &quot;index&quot; : &quot;twitter&quot;, &quot;alias&quot; : &quot;alias2&quot; &#125; &#125; ]&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¸ºtwitterç´¢å¼•æ·»åŠ äº†ä¸€ä¸ªå«åšalias2çš„åˆ«åã€‚è¿è¡ŒåŽï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡alias2æ¥é‡æ–°æœç´¢æˆ‘ä»¬çš„twitter1GET /alias2/_searchæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æžœï¼š1234567891011121314151617181920212223242526272829303132333435363738&#123; &quot;took&quot; : 0, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 3, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 1.0, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 1.0, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125; &#125; &#125;, ...åœ¨actioné‡Œï¼Œæˆ‘ä»¬å¯ä»¥æœ‰å¦‚ä¸‹çš„å‡ ç§ï¼š123add: æ·»åŠ ä¸€ä¸ªåˆ«åremove: åˆ é™¤ä¸€ä¸ªåˆ«åremove_index: åˆ é™¤ä¸€ä¸ªindexæˆ–å®ƒçš„åˆ«åæ¯”å¦‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹æ³•æ¥åˆ é™¤ä¸€ä¸ªalias123456POST /_aliases&#123; &quot;actions&quot; : [ &#123; &quot;remove&quot;: &#123; &quot;index&quot; : &quot;twitter&quot;, &quot;alias&quot; : &quot;alias2&quot; &#125; &#125; ]&#125;ä¸€æ—¦åˆ é™¤åŽï¼Œä¹‹å‰çš„å®šä¹‰çš„alias2å°±ä¸å¯ä»¥ç”¨äº†ã€‚é‡æ–°å‘½åä¸€ä¸ªaliasé‡å‘½ååˆ«åæ˜¯ä¸€ä¸ªç®€å•çš„åˆ é™¤ç„¶åŽåœ¨åŒä¸€APIä¸­æ·»åŠ æ“ä½œã€‚ æ­¤æ“ä½œæ˜¯åŽŸå­æ“ä½œï¼Œæ— éœ€æ‹…å¿ƒåˆ«åæœªæŒ‡å‘ç´¢å¼•çš„çŸ­æ—¶é—´æ®µï¼š1234567POST /_aliases&#123; &quot;actions&quot; : [ &#123; &quot;remove&quot; : &#123; &quot;index&quot; : &quot;twitter&quot;, &quot;alias&quot; : &quot;alias1&quot; &#125; &#125;, &#123; &quot;add&quot; : &#123; &quot;index&quot; : &quot;twitter&quot;, &quot;alias&quot; : &quot;alias2&quot; &#125; &#125; ]&#125;ä¸Šé¢çš„æ“ä½œï¼Œåˆ é™¤alias1ï¼ŒåŒæ—¶åˆ›å»ºä¸€ä¸ªæ–°çš„å«åšalias2çš„åˆ«åã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠåŒä¸€ä¸ªaliasåœ¨æŒ‡å‘ä¸åŒæ—¶æœŸçš„indexï¼Œæ¯”å¦‚æˆ‘ä»¬çš„log indexæ»šåŠ¨ä¸‹ä¸€ä¸ªæœˆï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹æˆ‘ä»¬çš„aliasæ€»æ˜¯æŒ‡å‘æœ€æ–°çš„indexã€‚ä¸ºå¤šä¸ªç´¢å¼•æ·»åŠ åŒæ ·ä¸€ä¸ªaliaså°†åˆ«åä¸Žå¤šä¸ªç´¢å¼•ç›¸å…³è”åªéœ€å‡ ä¸ªæ·»åŠ æ“ä½œï¼š1234567POST /_aliases&#123; &quot;actions&quot; : [ &#123; &quot;add&quot; : &#123; &quot;index&quot; : &quot;test1&quot;, &quot;alias&quot; : &quot;alias1&quot; &#125; &#125;, &#123; &quot;add&quot; : &#123; &quot;index&quot; : &quot;test2&quot;, &quot;alias&quot; : &quot;alias1&quot; &#125; &#125; ]&#125;ä½ ä¹Ÿå¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹å¼ï¼Œé€šè¿‡ä¸€ä¸ªaddå‘½ä»¤æ¥å®Œæˆï¼š123456POST /_aliases&#123; &quot;actions&quot; : [ &#123; &quot;add&quot; : &#123; &quot;indices&quot; : [&quot;test1&quot;, &quot;test2&quot;], &quot;alias&quot; : &quot;alias1&quot; &#125; &#125; ]&#125;ç”šè‡³ï¼š123456POST /_aliases&#123; &quot;actions&quot; : [ &#123; &quot;add&quot; : &#123; &quot;index&quot; : &quot;test*&quot;, &quot;alias&quot; : &quot;all_test_indices&quot; &#125; &#125; ]&#125;è¿™æ ·æ‰€æœ‰ä»¥test*ä¸ºå¼€å¤´çš„ç´¢å¼•éƒ½å…±åŒä¸€ä¸ªåˆ«åã€‚å½“æˆ‘ä»¬indexæˆ‘ä»¬çš„æ–‡æ¡£æ—¶ï¼Œå¯¹ä¸€ä¸ªæŒ‡å‘å¤šä¸ªindexçš„åˆ«åè¿›è¡Œç´¢å¼•æ˜¯é”™è¯¯çš„ã€‚ä¹Ÿå¯ä»¥åœ¨ä¸€ä¸ªæ“ä½œä¸­ä½¿ç”¨åˆ«åäº¤æ¢ç´¢å¼•ï¼š123456789PUT test PUT test_2 POST /_aliases&#123; &quot;actions&quot; : [ &#123; &quot;add&quot;: &#123; &quot;index&quot;: &quot;test_2&quot;, &quot;alias&quot;: &quot;test&quot; &#125; &#125;, &#123; &quot;remove_index&quot;: &#123; &quot;index&quot;: &quot;test&quot; &#125; &#125; ]&#125;åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå‡å¦‚æˆ‘ä»¬åœ°æ·»åŠ äº†ä¸€ä¸ªå«åštestçš„indexï¼Œè€Œtest_2æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚æˆ‘ä»¬ç›´æŽ¥å¯ä»¥é€šè¿‡ä¸Šé¢çš„æ–¹æ³•å§testä¸­çš„æ•°æ®äº¤æ¢åˆ°test_2ä¸­ï¼Œå¹¶åŒæ—¶æŠŠtestç´¢å¼•åˆ é™¤ã€‚Filtered aliaså¸¦æœ‰è¿‡æ»¤å™¨çš„åˆ«åæä¾›äº†ä¸€ç§åˆ›å»ºåŒä¸€ç´¢å¼•çš„ä¸åŒâ€œè§†å›¾â€çš„ç®€ä¾¿æ–¹æ³•ã€‚ å¯ä»¥ä½¿ç”¨Query DSLå®šä¹‰è¿‡æ»¤å™¨ï¼Œå¹¶ä½¿ç”¨æ­¤åˆ«åå°†å…¶åº”ç”¨äºŽæ‰€æœ‰â€œæœç´¢â€ï¼Œâ€œè®¡æ•°â€ï¼Œâ€œæŒ‰æŸ¥è¯¢åˆ é™¤â€å’Œâ€œæ›´å¤šæ­¤ç±»æ“ä½œâ€ã€‚è¦åˆ›å»ºè¿‡æ»¤åŽçš„åˆ«åï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦ç¡®ä¿æ˜ å°„ä¸­å·²å­˜åœ¨è¿™äº›å­—æ®µï¼š12345678910PUT /test1&#123; &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;user&quot; : &#123; &quot;type&quot;: &quot;keyword&quot; &#125; &#125; &#125;&#125;çŽ°åœ¨æˆ‘ä»¬å¯ä»¥åˆ©ç”¨filteræ¥åˆ›å»ºä¸€ä¸ªaliasï¼Œæ˜¯åŸºäºŽuserå­—æ®µ123456789101112POST /_aliases&#123; &quot;actions&quot; : [ &#123; &quot;add&quot; : &#123; &quot;index&quot; : &quot;test1&quot;, &quot;alias&quot; : &quot;alias2&quot;, &quot;filter&quot; : &#123; &quot;term&quot; : &#123; &quot;user&quot; : &quot;kimchy&quot; &#125; &#125; &#125; &#125; ]&#125;Write indexå¯ä»¥å°†åˆ«åæŒ‡å‘çš„ç´¢å¼•å…³è”ä¸ºwriteç´¢å¼•ã€‚ æŒ‡å®šåŽï¼Œé’ˆå¯¹æŒ‡å‘å¤šä¸ªç´¢å¼•çš„åˆ«åçš„æ‰€æœ‰ç´¢å¼•å’Œæ›´æ–°è¯·æ±‚å°†å°è¯•è§£æžä¸ºwriteç´¢å¼•çš„ä¸€ä¸ªç´¢å¼•ã€‚ æ¯ä¸ªåˆ«ååªèƒ½å°†ä¸€ä¸ªç´¢å¼•åˆ†é…ä¸ºä¸€æ¬¡writeç´¢å¼•ã€‚ å¦‚æžœæœªæŒ‡å®šwriteç´¢å¼•ä¸”åˆ«åå¼•ç”¨äº†å¤šä¸ªç´¢å¼•ï¼Œåˆ™ä¸å…è®¸å†™å…¥ã€‚å¯ä»¥ä½¿ç”¨åˆ«åAPIå’Œç´¢å¼•åˆ›å»ºAPIå°†ä¸Žåˆ«åå…³è”çš„ç´¢å¼•æŒ‡å®šä¸ºwriteç´¢å¼•ã€‚123456789101112131415161718POST /_aliases&#123; &quot;actions&quot; : [ &#123; &quot;add&quot; : &#123; &quot;index&quot; : &quot;test&quot;, &quot;alias&quot; : &quot;alias1&quot;, &quot;is_write_index&quot; : true &#125; &#125;, &#123; &quot;add&quot; : &#123; &quot;index&quot; : &quot;test2&quot;, &quot;alias&quot; : &quot;alias1&quot; &#125; &#125; ]&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å®šä¹‰äº†alias1åŒæ—¶æŒ‡å‘teståŠtest2ä¸¤ä¸ªç´¢å¼•ã€‚å…¶ä¸­testä¸­ï¼Œæ³¨æ˜Žäº†is_write_indexï¼Œé‚£ä¹ˆï¼Œå¦‚ä¸‹çš„æ“ä½œï¼š1234PUT /alias1/_doc/1&#123; &quot;foo&quot;: &quot;bar&quot;&#125;ç›¸å½“äºŽå¦‚ä¸‹çš„æ“ä½œï¼š1PUT /test/_doc/1ä¹Ÿå°±æ˜¯å†™å…¥åˆ°testç´¢å¼•ä¸­ï¼Œè€Œä¸ä¼šå†™å…¥åˆ°test2ä¸­ã€‚è¦äº¤æ¢å“ªä¸ªç´¢å¼•æ˜¯åˆ«åçš„å†™å…¥ç´¢å¼•ï¼Œå¯ä»¥åˆ©ç”¨åˆ«åAPIè¿›è¡ŒåŽŸå­äº¤æ¢ã€‚ äº¤æ¢ä¸ä¾èµ–äºŽæ“ä½œçš„é¡ºåºã€‚123456789101112131415161718POST /_aliases&#123; &quot;actions&quot; : [ &#123; &quot;add&quot; : &#123; &quot;index&quot; : &quot;test&quot;, &quot;alias&quot; : &quot;alias1&quot;, &quot;is_write_index&quot; : false &#125; &#125;, &#123; &quot;add&quot; : &#123; &quot;index&quot; : &quot;test2&quot;, &quot;alias&quot; : &quot;alias1&quot;, &quot;is_write_index&quot; : true &#125; &#125; ]&#125;å‚è€ƒï¼šã€1ã€‘https://www.elastic.co/guide/en/elasticsearch/reference/7.3/indices-aliases.htmlã€2ã€‘https://www.elastic.co/guide/en/elasticsearch/reference/7.3/indices-get-alias.htmlã€3ã€‘https://www.elastic.co/guide/en/elasticsearch/reference/7.3/indices-add-alias.html]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[lasticsearchï¼šIKä¸­æ–‡åˆ†è¯å™¨]]></title>
    <url>%2F2020%2F01%2F02%2Flasticsearch%EF%BC%9AIK%E4%B8%AD%E6%96%87%E5%88%86%E8%AF%8D%E5%99%A8%2F</url>
    <content type="text"><![CDATA[Elasticsearchå†…ç½®çš„åˆ†è¯å™¨å¯¹ä¸­æ–‡ä¸å‹å¥½ï¼Œåªä¼šä¸€ä¸ªå­—ä¸€ä¸ªå­—çš„åˆ†ï¼Œæ— æ³•å½¢æˆè¯è¯­ï¼Œæ¯”å¦‚ï¼š12345POST /_analyze&#123; &quot;text&quot;: &quot;æˆ‘çˆ±åŒ—äº¬å¤©å®‰é—¨&quot;, &quot;analyzer&quot;: &quot;standard&quot;&#125;å¦‚æžœæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯standardçš„åˆ†è¯å™¨ï¼Œé‚£ä¹ˆç»“æžœå°±æ˜¯ï¼š1234567891011121314151617181920212223242526&#123; &quot;tokens&quot; : [ &#123; &quot;token&quot; : &quot;æˆ‘&quot;, &quot;start_offset&quot; : 0, &quot;end_offset&quot; : 1, &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;, &quot;position&quot; : 0 &#125;, &#123; &quot;token&quot; : &quot;çˆ±&quot;, &quot;start_offset&quot; : 1, &quot;end_offset&quot; : 2, &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;, &quot;position&quot; : 1 &#125;, ... &#123; &quot;token&quot; : &quot;é—¨&quot;, &quot;start_offset&quot; : 6, &quot;end_offset&quot; : 7, &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;, &quot;position&quot; : 6 &#125; ]&#125;æ˜¾ç„¶è¿™å¯¹ä¸­æ–‡æ¥è¯´å¹¶ä¸å‹å¥½ï¼Œå®ƒæ˜¾ç¤ºçš„æ¯ä¸€ä¸ªæ±‰å­—ã€‚å¥½åœ¨Elasticçš„å¤§æ‹¿medclå·²ç»ä¸ºæˆ‘ä»¬åšå¥½IKä¸­æ–‡åˆ†è¯å™¨ã€‚ä¸‹é¢æˆ‘ä»¬æ¥è¯¦ç»†ä»‹ç»å¦‚ä½•å®‰è£…å¹¶ä½¿ç”¨ä¸­æ–‡åˆ†è¯å™¨ã€‚å…·ä½“çš„å®‰è£…æ­¥éª¤å¯ä»¥åœ¨åœ°å€https://github.com/medcl/elasticsearch-analysis-ikæ‰¾åˆ°ã€‚å®‰è£…é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥åˆ°å¦‚ä¸‹çš„åœ°å€æŸ¥çœ‹ä¸€ä¸‹æ˜¯å¦æœ‰æœ€æ–°çš„ç‰ˆæœ¬å¯¹åº”ä½ çš„Elasticsearchçš„å‘è¡Œç‰ˆï¼šhttps://github.com/medcl/elasticsearch-analysis-ik/releasesåˆ°ç›®å‰æˆªæ­¢æ—¥æœŸï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰æœ€æ–°çš„v7.3.1å‘è¡Œç‰ˆã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬ç›´æŽ¥è¿›å…¥åˆ°æˆ‘ä»¬çš„Elasticsearchçš„å®‰è£…ç›®å½•ä¸‹ï¼Œå¹¶æ‰“å…¥å¦‚ä¸‹çš„å‘½ä»¤ï¼š1./bin/elasticsearch-plugin nstall https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.3.1/elasticsearch-analysis-ik-7.3.1.zipæ›¿ä»£ä¸Šé¢çš„7.3.1å®‰è£…ä½ è‡ªå·±æƒ³è¦çš„ç‰ˆæœ¬ï¼šå®‰è£…å¥½åŽï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥æ£€æŸ¥æ˜¯å¦å·²ç»å®‰è£…å¥½ï¼š12localhost:elasticsearch-7.3.0 liuxg$ ./bin/elasticsearch-plugin listanalysis-ikä¸Šé¢çš„å‘½ä»¤æ˜¾ç¤ºæˆ‘ä»¬çš„IKå·²ç»å®‰è£…æˆåŠŸäº†ã€‚è¿™ä¸ªæ—¶å€™éœ€è¦æˆ‘ä»¬é‡æ–°å¯åŠ¨ä¸€ä¸‹æˆ‘ä»¬çš„Elasticsearchï¼Œä»¥ä¾¿è¿™ä¸ªpluginèƒ½è£…è¢«åŠ è½½ã€‚ä½¿ç”¨IKåˆ†è¯å™¨é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªindex:1PUT chineseæŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥ä¸ºè¿™ä¸ªindex åˆ›å»ºä¸€ä¸ªmapping12345678910PUT /chinese/_mapping&#123; &quot;properties&quot;: &#123; &quot;content&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;analyzer&quot;: &quot;ik_max_word&quot;, &quot;search_analyzer&quot;: &quot;ik_smart&quot; &#125; &#125;&#125;è¿è¡Œä¸Šé¢çš„å‘½ä»¤åŽï¼Œå¦‚æžœå‡ºçŽ°å¦‚ä¸‹çš„ä¿¡æ¯ï¼š123&#123; &quot;acknowledged&quot; : true&#125;å®ƒè¡¨æ˜Žæˆ‘ä»¬çš„å®‰è£…æ—¶æˆåŠŸçš„ã€‚æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥indexä¸€äº›æ–‡æ¡£ï¼š12345GET /chinese/_analyze&#123; &quot;text&quot;: &quot;æˆ‘çˆ±åŒ—äº¬å¤©å®‰é—¨&quot;, &quot;analyzer&quot;: &quot;ik_max_word&quot;&#125;æ˜¾ç¤ºçš„ç»“æžœä¸ºï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546&#123; &quot;tokens&quot; : [ &#123; &quot;token&quot; : &quot;æˆ‘&quot;, &quot;start_offset&quot; : 0, &quot;end_offset&quot; : 1, &quot;type&quot; : &quot;CN_CHAR&quot;, &quot;position&quot; : 0 &#125;, &#123; &quot;token&quot; : &quot;çˆ±&quot;, &quot;start_offset&quot; : 1, &quot;end_offset&quot; : 2, &quot;type&quot; : &quot;CN_CHAR&quot;, &quot;position&quot; : 1 &#125;, &#123; &quot;token&quot; : &quot;åŒ—äº¬&quot;, &quot;start_offset&quot; : 2, &quot;end_offset&quot; : 4, &quot;type&quot; : &quot;CN_WORD&quot;, &quot;position&quot; : 2 &#125;, &#123; &quot;token&quot; : &quot;å¤©å®‰é—¨&quot;, &quot;start_offset&quot; : 4, &quot;end_offset&quot; : 7, &quot;type&quot; : &quot;CN_WORD&quot;, &quot;position&quot; : 3 &#125;, &#123; &quot;token&quot; : &quot;å¤©å®‰&quot;, &quot;start_offset&quot; : 4, &quot;end_offset&quot; : 6, &quot;type&quot; : &quot;CN_WORD&quot;, &quot;position&quot; : 4 &#125;, &#123; &quot;token&quot; : &quot;é—¨&quot;, &quot;start_offset&quot; : 6, &quot;end_offset&quot; : 7, &quot;type&quot; : &quot;CN_CHAR&quot;, &quot;position&quot; : 5 &#125; ]&#125;ä»Žä¸Šé¢çš„ç»“æžœæˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ï¼Œåœ¨æˆ‘ä»¬çš„tokenä¸­æ˜¾ç¤ºâ€œåŒ—äº¬â€ï¼Œâ€œå¤©å®‰â€åŠâ€œå¤©å®‰é—¨â€ã€‚è¿™ä¸ªå’Œæˆ‘ä»¬ä¹‹å‰çš„æ˜¯ä¸ä¸€æ ·çš„ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬è¾“å…¥ä¸¤ä¸ªæ–‡æ¡£ï¼š123456789PUT /chinese/_doc/1&#123; &quot;content&quot;:&quot;æˆ‘çˆ±åŒ—äº¬å¤©å®‰é—¨&quot;&#125; PUT /chinese/_doc/2&#123; &quot;content&quot;: &quot;åŒ—äº¬ï¼Œä½ å¥½&quot;&#125;é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ï¼Œé€šè¿‡å¦‚ä¸‹çš„æ–¹å¼æ¥è¿›è¡Œæœç´¢ï¼š12345678GET /chinese/_search&#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;content&quot;: &quot;åŒ—äº¬&quot; &#125; &#125;&#125;æˆ‘ä»¬æ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š12345678910111213141516171819202122232425262728293031323334353637&#123; &quot;took&quot; : 1, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 2, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 0.15965709, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;chinese&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;2&quot;, &quot;_score&quot; : 0.15965709, &quot;_source&quot; : &#123; &quot;content&quot; : &quot;åŒ—äº¬ï¼Œä½ å¥½&quot; &#125; &#125;, &#123; &quot;_index&quot; : &quot;chinese&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 0.100605845, &quot;_source&quot; : &#123; &quot;content&quot; : &quot;æˆ‘çˆ±åŒ—äº¬å¤©å®‰é—¨&quot; &#125; &#125; ] &#125;&#125;å› ä¸ºä¸¤ä¸ªæ–‡æ¡£é‡Œéƒ½å«æœ‰â€œåŒ—äº¬â€ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ä¸¤ä¸ªæ–‡æ¡£éƒ½è¢«æ˜¾ç¤ºå‡ºæ¥äº†ã€‚æˆ‘ä»¬åŒæ—¶åšå¦å¤–ä¸€ä¸ªæœç´¢ï¼š12345678GET /chinese/_search&#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;content&quot;: &quot;å¤©å®‰é—¨&quot; &#125; &#125;&#125;é‚£ä¹ˆæ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š12345678910111213141516171819202122232425262728&#123; &quot;took&quot; : 0, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 1, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 0.73898095, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;chinese&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 0.73898095, &quot;_source&quot; : &#123; &quot;content&quot; : &quot;æˆ‘çˆ±åŒ—äº¬å¤©å®‰é—¨&quot; &#125; &#125; ] &#125;&#125;å› ä¸ºâ€œå¤©å®‰é—¨â€åªå‡ºçŽ°åœ¨ç¬¬äºŒä¸ªæ–‡æ¡£é‡Œï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥åªæœ‰ä¸€ä¸ªç»“æžœã€‚æˆ‘ä»¬ä¹ŸåŒæ—¶åšå¦å¤–ä¸€ä¸ªæœç´¢ï¼š12345678GET /chinese/_search&#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;content&quot;: &quot;åŒ—äº¬å¤©å®‰é—¨&quot; &#125; &#125;&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ¥æœç´¢â€œåŒ—äº¬å¤©å®‰é—¨â€ã€‚è¯·æ³¨æ„æˆ‘ä»¬åœ¨mappingä¸­ä½¿ç”¨äº†1&quot;search_analyzer&quot;: &quot;ik_smart&quot;ä¹Ÿå°±æ˜¯è¯´ï¼Œsearch_analyzerä¼šæŠŠæˆ‘ä»¬çš„â€œåŒ—äº¬å¤©å®‰é—¨â€ï¼Œåˆ†è§£æˆä¸¤ä¸ªè¯â€œåŒ—äº¬â€åŠâ€œå¤©å®‰é—¨â€ã€‚è¿™ä¸¤ä¸ªè¯å°†è¢«ç”¨äºŽæœç´¢ã€‚é€šå¸¸å¯¹äºŽmatchæ¥è¯´æ˜¯ORå…³ç³»ï¼Œä¹Ÿå°±æ˜¯è¯´åªè¦åŒ¹é…åˆ°â€œåŒ—äº¬â€æˆ–â€œå¤©å®‰é—¨â€ï¼Œè¿™ä¸¤ä¸ªä¹‹ä¸­çš„ä»»ä½•ä¸€ä¸ªï¼Œé‚£ä¹ˆå°±æ˜¯åŒ¹é…ï¼š12345678910111213141516171819202122232425262728293031323334353637&#123; &quot;took&quot; : 3, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 2, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 0.7268042, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;chinese&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 0.7268042, &quot;_source&quot; : &#123; &quot;content&quot; : &quot;æˆ‘çˆ±åŒ—äº¬å¤©å®‰é—¨&quot; &#125; &#125;, &#123; &quot;_index&quot; : &quot;chinese&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;2&quot;, &quot;_score&quot; : 0.22920427, &quot;_source&quot; : &#123; &quot;content&quot; : &quot;åŒ—äº¬ï¼Œä½ å¥½&quot; &#125; &#125; ] &#125;&#125;ä¸Šé¢æ˜¾ç¤ºçš„ç»“æžœæ˜¾ç¤ºâ€œæˆ‘çˆ±åŒ—äº¬å¤©å®‰é—¨â€æ˜¯æœ€è´´åˆ‡çš„æœç´¢ç»“æžœã€‚å‚è€ƒï¼šã€1ã€‘https://github.com/medcl/elasticsearch-analysis-ik]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[lasticsearchï¼šICUåˆ†è¯å™¨ä»‹ç»]]></title>
    <url>%2F2020%2F01%2F02%2Flasticsearch%EF%BC%9AICU%E5%88%86%E8%AF%8D%E5%99%A8%E4%BB%8B%E7%BB%8D%2F</url>
    <content type="text"><![CDATA[ICU Analysisæ’ä»¶æ˜¯ä¸€ç»„å°†Lucene ICUæ¨¡å—é›†æˆåˆ°Elasticsearchä¸­çš„åº“ã€‚ æœ¬è´¨ä¸Šï¼ŒICUçš„ç›®çš„æ˜¯å¢žåŠ å¯¹Unicodeå’Œå…¨çƒåŒ–çš„æ”¯æŒï¼Œä»¥æä¾›å¯¹äºšæ´²è¯­è¨€æ›´å¥½çš„æ–‡æœ¬åˆ†å‰²åˆ†æžã€‚ ä»ŽElasticsearchçš„è§’åº¦æ¥çœ‹ï¼Œæ­¤æ’ä»¶æä¾›äº†æ–‡æœ¬åˆ†æžä¸­çš„æ–°ç»„ä»¶ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤º:å®‰è£…æˆ‘ä»¬å¯ä»¥é¦–å…ˆåˆ°Elasticsearchçš„å®‰è£…ç›®å½•æ‰“å…¥å¦‚ä¸‹çš„å‘½ä»¤ï¼š123456$ pwd/Users/liuxg/elastic/elasticsearch-7.3.0(base) localhost:elasticsearch-7.3.0 liuxg$ ./bin/elasticsearch-plugin listanalysis-icuanalysis-ikpinyinä¸Šé¢æ˜¾ç¤ºæˆ‘å·²ç»å®‰è£…å¥½äº†ä¸‰ä¸ªæ’ä»¶ã€‚ä¸Šé¢çš„analysis-ikåŠpinyinéƒ½æ˜¯ä¸ºä¸­æ–‡è€Œå‡†å¤‡çš„ã€‚æ³¨æ„ï¼šå¦‚æžœä½ ä»¬åœ¨ä½¿ç”¨ä¸Šé¢çš„elasticsearch-plug listå‘½åå‡ºçŽ°å¦‚ä¸‹çš„é”™è¯¯çš„è¯ï¼šé‚£ä¹ˆè¯·ä½¿ç”¨å¦‚ä¸‹çš„å‘½ä»¤æ¥åˆ é™¤åœ¨å½“å‰ç›®å½•ä¸‹çš„.DS_Storeç›®å½•ï¼š1sudo find /Path/to/your/elasticsearch-folder -name &quot;.DS_Store&quot; -depth -exec rm &#123;&#125; \;ç„¶åŽé‡æ–°è¿è¡Œä¸Šé¢çš„å‘½ä»¤å°±ä¸ä¼šæœ‰é—®é¢˜äº†ã€‚ä¸Šé¢æ˜¾ç¤ºæˆ‘å·²ç»å®‰è£…å¥½äº†ã€‚å¦‚æžœåœ¨ä½ çš„ç”µè„‘é‡Œæ²¡æœ‰å®‰è£…å¥½ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„å‘½ä»¤æ¥è¿›è¡Œå®‰è£…ï¼š1./bin/elasticsearch-plugin install analysis-icuä¸Šé¢çš„å‘½ä»¤åœ¨Elasticsearchçš„å®‰è£…ç›®å½•é‡Œè¿›è¡Œè¿è¡Œã€‚ç­‰å®‰è£…å¥½åŽï¼Œæˆ‘ä»¬éœ€è¦é‡æ–°å¯åŠ¨Elasticsearchè®©å®ƒèµ·ä½œç”¨ã€‚é‡æ–°è¿è¡Œï¼š1./bin/elasticsearch-plugin listæ¥æ£€æŸ¥analysis-icuæ˜¯å¦å·²ç»è¢«æˆåŠŸå®‰è£…å¥½äº†ã€‚ä¾‹å­ç­‰æˆ‘ä»¬å®Œå…¨å®‰è£…å¥½äº†analysis_icuï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„ä¾‹å­åœ¨Kibanaä¸­æ¥åšä¸€ä¸ªå®žéªŒï¼š12345POST _analyze &#123; &quot;text&quot;: &quot;æˆ‘çˆ±åŒ—äº¬å¤©å®‰é—¨&quot;, &quot;analyzer&quot;: &quot;icu_analyzer&quot;&#125;é‚£ä¹ˆæ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼šä¸Šé¢æ˜¾ç¤ºï¼Œæˆ‘ä»¬analysiså¯ä»¥æ­£ç¡®åœ°å¸®æˆ‘ä»¬æŠŠä¸­æ–‡è¯è¯­å®‰è£…ä¸­æ–‡çš„åˆ†è¯æ–¹æ³•æ­£ç¡®åœ°è¿›è¡Œåˆ†è¯ã€‚æˆ‘ä»¬å¯ä»¥å’Œstandardåˆ†è¯å™¨æ¥è¿›è¡Œä¸€ä¸ªæ¯”è¾ƒï¼šæˆ‘ä»¬ä»Žä¸Šé¢å¯ä»¥çœ‹å‡ºæ¥ï¼Œåœ¨é»˜è®¤çš„æƒ…å†µä¸‹ï¼Œicu_analyzeré€šå¸¸æ˜¯ä¸€ä¸ªåŠä»¥ä¸Šçš„å­—ç¬¦çš„tokenï¼Œè€Œstandardçš„analyzeråªæœ‰ä¸€ä¸ªå­—ç¬¦ã€‚é€šè¿‡æ›´æ”¹å­—ç¬¦è¿‡æ»¤å™¨å’Œtokençš„æ–¹æ³•å’Œæ¨¡å¼å‚æ•°ï¼ŒICUåˆ†æžå™¨å¯ä»¥å…·æœ‰å¤šç§è‡ªå®šä¹‰å˜é‡ç±»åž‹ã€‚ ä¸‹è¡¨æè¿°äº†ä¸åŒç±»åž‹çš„ICUåˆ†æžä»ªçš„ç»„åˆï¼šè®©æˆ‘ä»¬å°è¯•nfkd_normalizedåˆ†æžå™¨ã€‚ éµå¾ªå®šä¹‰å¹¶åœ¨Kibana Dev ToolsæŽ§åˆ¶å°ä¸­å¯¹å…¶è¿›è¡Œæµ‹è¯•ã€‚ å“åº”æ˜¾ç¤ºåœ¨ä»¥ä¸‹å±å¹•æˆªå›¾ä¸­ã€‚ ä½†æ˜¯ï¼Œç”±äºŽä½¿ç”¨nfkd_normalizedåˆ†æžå™¨å’Œicu_analyzeråˆ†æžå™¨ï¼Œæˆ‘ä»¬æ— æ³•åœ¨ç»“æžœä¸­æ‰¾åˆ°ä»»ä½•å·®å¼‚ï¼š123456POST _analyze &#123; &quot;text&quot;: &quot;è‚¡å¸‚æŠ•èµ„ç¨³èµšä¸èµ”å¿…ä¿®è¯¾ï¼šå¦‚ä½•åšå¥½ä»“ä½ç®¡ç†å’Œæƒ…ç»ªç®¡ç†&quot;, &quot;char_filter&quot;: [&#123;&quot;type&quot;: &quot;icu_normalizer&quot;, &quot;name&quot;: &quot;nfkc&quot;, &quot;mode&quot;:&quot;decompose&quot;&#125;], &quot;tokenizer&quot;: &quot;icu_tokenizer&quot;&#125;è¿è¡Œç»“æžœï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109&#123; &quot;tokens&quot; : [ &#123; &quot;token&quot; : &quot;è‚¡å¸‚&quot;, &quot;start_offset&quot; : 0, &quot;end_offset&quot; : 2, &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;, &quot;position&quot; : 0 &#125;, &#123; &quot;token&quot; : &quot;æŠ•èµ„&quot;, &quot;start_offset&quot; : 2, &quot;end_offset&quot; : 4, &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;, &quot;position&quot; : 1 &#125;, &#123; &quot;token&quot; : &quot;ç¨³èµš&quot;, &quot;start_offset&quot; : 4, &quot;end_offset&quot; : 6, &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;, &quot;position&quot; : 2 &#125;, &#123; &quot;token&quot; : &quot;ä¸&quot;, &quot;start_offset&quot; : 6, &quot;end_offset&quot; : 7, &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;, &quot;position&quot; : 3 &#125;, &#123; &quot;token&quot; : &quot;èµ”&quot;, &quot;start_offset&quot; : 7, &quot;end_offset&quot; : 8, &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;, &quot;position&quot; : 4 &#125;, &#123; &quot;token&quot; : &quot;å¿…ä¿®&quot;, &quot;start_offset&quot; : 8, &quot;end_offset&quot; : 10, &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;, &quot;position&quot; : 5 &#125;, &#123; &quot;token&quot; : &quot;è¯¾&quot;, &quot;start_offset&quot; : 10, &quot;end_offset&quot; : 11, &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;, &quot;position&quot; : 6 &#125;, &#123; &quot;token&quot; : &quot;å¦‚ä½•&quot;, &quot;start_offset&quot; : 12, &quot;end_offset&quot; : 14, &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;, &quot;position&quot; : 7 &#125;, &#123; &quot;token&quot; : &quot;åšå¥½&quot;, &quot;start_offset&quot; : 14, &quot;end_offset&quot; : 16, &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;, &quot;position&quot; : 8 &#125;, &#123; &quot;token&quot; : &quot;ä»“&quot;, &quot;start_offset&quot; : 16, &quot;end_offset&quot; : 17, &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;, &quot;position&quot; : 9 &#125;, &#123; &quot;token&quot; : &quot;ä½&quot;, &quot;start_offset&quot; : 17, &quot;end_offset&quot; : 18, &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;, &quot;position&quot; : 10 &#125;, &#123; &quot;token&quot; : &quot;ç®¡ç†&quot;, &quot;start_offset&quot; : 18, &quot;end_offset&quot; : 20, &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;, &quot;position&quot; : 11 &#125;, &#123; &quot;token&quot; : &quot;å’Œ&quot;, &quot;start_offset&quot; : 20, &quot;end_offset&quot; : 21, &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;, &quot;position&quot; : 12 &#125;, &#123; &quot;token&quot; : &quot;æƒ…ç»ª&quot;, &quot;start_offset&quot; : 21, &quot;end_offset&quot; : 23, &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;, &quot;position&quot; : 13 &#125;, &#123; &quot;token&quot; : &quot;ç®¡ç†&quot;, &quot;start_offset&quot; : 23, &quot;end_offset&quot; : 25, &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;, &quot;position&quot; : 14 &#125; ]&#125;è¦ä½¿ç”¨æ–°å®šä¹‰çš„åˆ†æžå™¨ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨Index settingä¸­å¯¹å…¶è¿›è¡Œå®šä¹‰ã€‚è¯·å‚é˜…æˆ‘ä¹‹å‰çš„æ–‡ç« â€œElasticsearch: analyzerâ€ã€‚]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[lasticsearchï¼šfuzzy æœç´¢(æ¨¡ç³Šæœç´¢)]]></title>
    <url>%2F2020%2F01%2F02%2Flasticsearch%EF%BC%9Afuzzy%20%E6%90%9C%E7%B4%A2%20%EF%BC%88%E6%A8%A1%E7%B3%8A%E6%90%9C%E7%B4%A2)%2F</url>
    <content type="text"><![CDATA[åœ¨å®žé™…çš„æœç´¢ä¸­ï¼Œæˆ‘ä»¬æœ‰æ—¶å€™ä¼šæ‰“é”™å­—ï¼Œä»Žè€Œå¯¼è‡´æœç´¢ä¸åˆ°ã€‚åœ¨Elasticsearchä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨fuzzinesså±žæ€§æ¥è¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢ï¼Œä»Žè€Œè¾¾åˆ°æœç´¢æœ‰é”™åˆ«å­—çš„æƒ…å½¢ã€‚matchæŸ¥è¯¢å…·æœ‰â€œfuzinessâ€å±žæ€§ã€‚å®ƒå¯ä»¥è¢«è®¾ç½®ä¸ºâ€œ0â€ï¼Œ â€œ1â€ï¼Œ â€œ2â€æˆ–â€œautoâ€ã€‚â€œautoâ€æ˜¯æŽ¨èçš„é€‰é¡¹ï¼Œå®ƒä¼šæ ¹æ®æŸ¥è¯¢è¯çš„é•¿åº¦å®šä¹‰è·ç¦»ã€‚Fuzzy queryè¿”å›žåŒ…å«ä¸Žæœç´¢è¯ç›¸ä¼¼çš„è¯çš„æ–‡æ¡£ï¼Œä»¥Levenshteinç¼–è¾‘è·ç¦»æµ‹é‡ã€‚ç¼–è¾‘è·ç¦»æ˜¯å°†ä¸€ä¸ªæœ¯è¯­è½¬æ¢ä¸ºå¦ä¸€ä¸ªæœ¯è¯­æ‰€éœ€çš„ä¸€ä¸ªå­—ç¬¦æ›´æ”¹çš„æ¬¡æ•°ã€‚ è¿™äº›æ›´æ”¹å¯ä»¥åŒ…æ‹¬ï¼šæ›´æ”¹å­—ç¬¦ï¼ˆboxâ†’foxï¼‰åˆ é™¤å­—ç¬¦ï¼ˆblackâ†’lackï¼‰æ’å…¥å­—ç¬¦ï¼ˆsicâ†’sickï¼‰è½¬ç½®ä¸¤ä¸ªç›¸é‚»å­—ç¬¦ï¼ˆactâ†’catï¼‰ä¸ºäº†æ‰¾åˆ°ç›¸ä¼¼çš„è¯ï¼Œæ¨¡ç³ŠæŸ¥è¯¢ä¼šåœ¨æŒ‡å®šçš„ç¼–è¾‘è·ç¦»å†…åˆ›å»ºæœç´¢è¯çš„æ‰€æœ‰å¯èƒ½å˜åŒ–æˆ–æ‰©å±•çš„é›†åˆã€‚ æŸ¥è¯¢ç„¶åŽè¿”å›žæ¯ä¸ªæ‰©å±•çš„å®Œå…¨åŒ¹é…ã€‚ä¾‹å­æˆ‘ä»¬é¦–å…ˆè¾“å…¥å¦‚ä¸‹çš„ä¸€ä¸ªæ–‡æ¡£åˆ°fuzzyindexç´¢å¼•ä¸­ï¼š1234PUT fuzzyindex/_doc/1&#123; &quot;content&quot;: &quot;I like blue sky&quot;&#125;å¦‚æžœè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬è¿›è¡Œå¦‚ä¸‹çš„æœç´¢ï¼š12345678GET fuzzyindex/_search&#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;content&quot;: &quot;ski&quot; &#125; &#125;&#125;é‚£ä¹ˆæ˜¯æ²¡æœ‰ä»»ä½•è¢«æœç´¢åˆ°çš„ç»“æžœï¼Œè¿™æ˜¯å› ä¸ºâ€œI like blue skyâ€ é‡Œåˆ†è¯åŽæ²¡æœ‰skiè¿™ä¸ªè¯ã€‚123456789101112131415161718&#123; &quot;took&quot; : 0, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 0, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : null, &quot;hits&quot; : [ ] &#125;&#125;è¿™ä¸ªæ—¶å€™ï¼Œå¦‚æžœæˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹çš„æœç´¢ï¼š1234567891011GET fuzzyindex/_search&#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;content&quot;: &#123; &quot;query&quot;: &quot;ski&quot;, &quot;fuzziness&quot;: &quot;1&quot; &#125; &#125; &#125;&#125;é‚£ä¹ˆæ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š12345678910111213141516171819202122232425262728&#123; &quot;took&quot; : 18, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 1, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 0.19178805, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;fuzzyindex&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 0.19178805, &quot;_source&quot; : &#123; &quot;content&quot; : &quot;I like blue sky&quot; &#125; &#125; ] &#125;&#125;æ˜¾ç„¶æ˜¯æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„ç»“æžœäº†ã€‚è¿™æ˜¯å› ä¸ºskyå’Œskiæ—¶é—´ä¸Šæ˜¯åªå·®åˆ«ä¸€ä¸ªå­—æ¯ã€‚åŒæ ·ï¼Œå¦‚æžœæˆ‘ä»¬é€‰ç”¨â€œautoâ€é€‰é¡¹çœ‹çœ‹ï¼š1234567891011GET fuzzyindex/_search&#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;content&quot;: &#123; &quot;query&quot;: &quot;ski&quot;, &quot;fuzziness&quot;: &quot;auto&quot; &#125; &#125; &#125;&#125;å®ƒæ˜¾ç¤ºçš„ç»“æžœå’Œä¸Šé¢çš„æ˜¯ä¸€æ ·çš„ã€‚ä¹Ÿå¯ä»¥è¿›è¡ŒåŒ¹é…ã€‚å¦‚æžœæˆ‘ä»¬è¿›è¡Œå¦‚ä¸‹çš„åŒ¹é…ï¼š1234567891011GET fuzzyindex/_search&#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;content&quot;: &#123; &quot;query&quot;: &quot;bxxe&quot;, &quot;fuzziness&quot;: &quot;auto&quot; &#125; &#125; &#125;&#125;é‚£ä¹ˆå®ƒä¸èƒ½åŒ¹é…ä»»ä½•çš„ç»“æžœï¼Œä½†æ˜¯ï¼Œå¦‚æžœæˆ‘ä»¬è¿›è¡Œå¦‚ä¸‹çš„æœç´¢ï¼š1234567891011GET fuzzyindex/_search&#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;content&quot;: &#123; &quot;query&quot;: &quot;bxxe&quot;, &quot;fuzziness&quot;: &quot;2&quot; &#125; &#125; &#125;&#125;æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æ ¼å¼ï¼š1234567891011GET /_search&#123; &quot;query&quot;: &#123; &quot;fuzzy&quot;: &#123; &quot;content&quot;: &#123; &quot;value&quot;: &quot;bxxe&quot;, &quot;fuzziness&quot;: &quot;2&quot; &#125; &#125; &#125;&#125;é‚£ä¹ˆå®ƒå¯ä»¥æ˜¾ç¤ºæœç´¢çš„ç»“æžœï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬èƒ½å¤Ÿå®¹è®¸ä¸¤ä¸ªç¼–è¾‘çš„é”™è¯¯ã€‚æ¨¡ç³Šæ€§æ˜¯æ‹¼å†™é”™è¯¯çš„ç®€å•è§£å†³æ–¹æ¡ˆï¼Œä½†å…·æœ‰å¾ˆé«˜çš„CPUå¼€é”€å’Œéžå¸¸ä½Žçš„ç²¾åº¦ã€‚å‚è€ƒï¼šã€1ã€‘https://www.elastic.co/guide/en/elasticsearch/reference/7.4/query-dsl-fuzzy-query.html]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearchï¼šè¿ç”¨shard filteringæ¥æŽ§åˆ¶ç´¢å¼•åˆ†é…ç»™å“ªä¸ªèŠ‚ç‚¹]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%EF%BC%9A%E8%BF%90%E7%94%A8shard%20filtering%E6%9D%A5%E6%8E%A7%E5%88%B6%E7%B4%A2%E5%BC%95%E5%88%86%E9%85%8D%E7%BB%99%E5%93%AA%E4%B8%AA%E8%8A%82%E7%82%B9%2F</url>
    <content type="text"><![CDATA[åœ¨æˆ‘ä»¬çš„å®žé™…éƒ¨ç½²ä¸­ï¼Œæˆ‘ä»¬çš„å„ä¸ªnodeï¼ˆèŠ‚ç‚¹ï¼‰çš„èƒ½åŠ›æ˜¯ä¸ä¸€æ ·çš„ã€‚æ¯”å¦‚æœ‰çš„èŠ‚ç‚¹çš„è®¡ç®—èƒ½åŠ›æ¯”è¾ƒå¼ºï¼Œè€Œä¸”é…æœ‰é«˜æ€§èƒ½çš„å­˜å‚¨ï¼Œé€Ÿåº¦ä¹Ÿæ¯”è¾ƒå¿«ï¼ŒåŒæ—¶æˆ‘ä»¬å¯èƒ½æœ‰ä¸€äº›nodeçš„èƒ½åŠ›ç¨å¾®å·®ä¸€ç‚¹ï¼Œæ¯”å¦‚è®¡ç®—èƒ½åŠ›åŠå­˜å‚¨å™¨çš„é€Ÿåº¦éƒ½æ¯”è¾ƒå·®ä¸€ç‚¹ã€‚é’ˆå¯¹è¿™ä¸¤ç§æƒ…å†µï¼Œæˆ‘ä»¬å…¶å®žå¯ä»¥æŠŠè¿™ä¸¤ç§èŠ‚ç‚¹ç”¨æ¥åšä¸åŒçš„ç”¨é€”ï¼šè¿ç®—èƒ½åŠ›è¾ƒå¼ºçš„èŠ‚ç‚¹å¯ä»¥ç”¨æ¥åšindexingï¼ˆå»ºç«‹ç´¢å¼•è¡¨æ ¼ï¼‰çš„å·¥ä½œï¼Œè€Œé‚£äº›èƒ½åŠ›è¾ƒå·®ä¸€ç‚¹çš„èŠ‚ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ¥åšæœç´¢ç”¨é€”ã€‚æˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸¤ç§èŠ‚ç‚¹åˆ†åˆ«å«åšï¼šhot nodeï¼šç”¨äºŽæ”¯æŒç´¢å¼•å¹¶å†™å…¥æ–°æ–‡æ¡£warm nodeï¼šç”¨äºŽå¤„ç†ä¸å¤ªé¢‘ç¹æŸ¥è¯¢çš„åªè¯»ç´¢å¼•è¿™ç§æž¶æž„åœ¨Elasticsearchä¸­ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºhot/warmæž¶æž„ã€‚Hot nodeæˆ‘ä»¬å¯ä»¥ä½¿ç”¨hot nodeæ¥åšindexingï¼šindexingæ˜¯CPUå’ŒIOçš„å¯†é›†æ“ä½œï¼Œå› æ­¤çƒ­èŠ‚ç‚¹åº”è¯¥æ˜¯åŠŸèƒ½å¼ºå¤§çš„æœåŠ¡å™¨æ¯”warm nodeæ›´å¿«çš„å­˜å‚¨Warm nodeå¯¹è¾ƒæ—§çš„åªè¯»ç´¢å¼•ä½¿ç”¨çƒ­èŠ‚ç‚¹ï¼šå€¾å‘äºŽåˆ©ç”¨å¤§åž‹é™„åŠ ç£ç›˜ï¼ˆé€šå¸¸æ˜¯æ—‹è½¬ç£ç›˜ï¼‰å¤§é‡æ•°æ®å¯èƒ½éœ€è¦å…¶ä»–èŠ‚ç‚¹æ‰èƒ½æ»¡è¶³æ€§èƒ½è¦æ±‚Shard filteringShard filteringåœ¨Elasticsearchä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªèƒ½åŠ›æ¥æŠŠæˆ‘ä»¬æƒ³è¦çš„indexæ”¾å…¥åˆ°æˆ‘ä»¬æƒ³è¦çš„nodeé‡Œã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åœ¨elasticsearch.ymlé…ç½®æ–‡ä»¶ä¸­çš„ï¼šnode.attræ¥æŒ‡å®šæˆ‘ä»¬nodeå±žæ€§ï¼šhotæˆ–æ˜¯warmã€‚åœ¨indexçš„settingsé‡Œé€šè¿‡index.routing.allocationæ¥æŒ‡å®šç´¢å¼•ï¼ˆindex)åˆ°ä¸€ä¸ªæ»¡è¶³è¦æ±‚çš„nodeä¸ºèŠ‚ç‚¹åˆ†é…ç´¢å¼•æœ‰ä¸‰ç§è§„åˆ™ï¼šå°±åƒä¸Šé¢çš„è¡¨æ ¼è¯´æ˜Žçš„ä¸€æ ·ï¼šincludeæŒ‡çš„æ˜¯è‡³å°‘åŒ…å«å…¶ä¸­çš„ä¸€ä¸ªå€¼ï¼›excludeæŒ‡çš„æ˜¯ä¸åŒ…å«ä»»ä½•å€¼ï¼›requireæŒ‡çš„æ˜¯å¿…é¡»åŒ…å«é‡Œé¢ç´¢å¼•çš„å€¼ã€‚è¿™äº›å€¼å®žé™…ä¸Šæˆ‘ä»¬ç”¨æ¥æ ‡è¯†nodeçš„tagã€‚é’ˆå¯¹è‡ªå·±çš„é…ç½®è¿™äº›tagå¯ä»¥ç”±åŽ‚å•†è‡ªå·±æ ‡è¯†ã€‚æ ‡è¯†nodeåœ¨ä¸Šé¢çš„å›¾ä¸­ï¼Œæˆ‘ä»¬æ ‡è¯†my_tempå±žæ€§ä¸ºhotæˆ–æ˜¯warmï¼Œè¡¨æ˜Žæˆ‘ä»¬çš„clusterä¸­åˆ†ä¸ºä¸¤ç±»ï¼šhotæˆ–æ˜¯warmã€‚åœ¨è¿™é‡Œç‰¹åˆ«æŒ‡å‡ºï¼šè¿™é‡Œçš„my_tempï¼ŒhotåŠwarméƒ½æ˜¯æˆ‘ä»¬ä»»æ„å–çš„å¯ä»¥è®©æˆ‘ä»¬è®°ä½çš„å±žæ€§åŠåç§°ã€‚åªè¦åœ¨ä½¿ç”¨æ—¶å’Œindex.routing.allocation.include index.routing.allocation.excludeåŠindex.routing.allocation.requireä¸­çš„å€¼ç›¸å¯¹åº”å³å¯ã€‚é…ç½®indexçš„settingsæˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½®åœ¨Indexä¸­çš„settingsæ¥åˆ†é…æˆ‘ä»¬çš„indexåˆ°ç›¸åº”çš„å…·æœ‰å“ªäº›å±žæ€§çš„nodeé‡Œï¼Œæ¯”å¦‚ï¼š123456PUT logs-2019-03&#123; &quot;settings&quot;: &#123; &quot;index.routing.allocation.require.my_temp&quot;: &quot;hot&quot; &#125;&#125;åœ¨ä¸Šé¢æˆ‘ä»¬é€šè¿‡logs-2019-03çš„è¿™ä¸ªindexçš„settingsæ¥æŽ§åˆ¶è¿™ä¸ªindexå¿…é¡»åˆ†é…åˆ°å…·æœ‰hotå±žæ€§çš„nodeé‡Œã€‚å‡å¦‚æˆ‘ä»¬ä¸Šé¢çš„index logs-2019-03ç”±äºŽä¸€äº›åŽŸå› ä¸å†æ˜¯å½“å‰çš„ç”¨æ¥åšindexingçš„indexï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥é€šè¿‡rollover APIæŽ¥å£æ¥è‡ªåŠ¨æ»šåŠ¨æˆ‘ä»¬çš„indexåå­—ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æŠŠè¯¥indexç§»åŠ¨åˆ°warm nodeé‡Œï¼š123456PUT logs-2019-03&#123; &quot;settings&quot;: &#123; &quot;index.routing.allocation.require.my_temp&quot;: &quot;warm&quot; &#125;&#125;è¿™æ ·Elasticsearchä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬æŠŠlogs-2019-03ç´¢å¼•ç§»åŠ¨åˆ°warm nodeä¸­ï¼Œä»¥ä¾¿ç›´ä¾›æœç´¢ä¹‹ç”¨ã€‚ä¾‹å­é¦–å…ˆï¼Œæˆ‘ä»¬æˆ‘ä»¬æŒ‰ç…§å¦‚ä¸‹çš„æ–¹å¼æ¥åšä¸€ä¸ªå®žéªŒï¼Œè™½ç„¶ä¸èƒ½åº”ç”¨äºŽå®žé™…çš„ç”Ÿäº§çŽ¯å¢ƒä¸­ï¼šæŒ‰ç…§â€œå¦‚ä½•åœ¨Linuxï¼ŒMacOSåŠWindowsä¸Šè¿›è¡Œå®‰è£…Elasticsearchâ€å®‰è£…å¥½è‡ªå·±çš„Elasticsearhï¼Œä½†æ˜¯ä¸è¦è¿è¡ŒElasticsearchæŒ‰ç…§â€œå¦‚ä½•åœ¨LinuxåŠMacOSä¸Šå®‰è£…Elasticæ ˆä¸­çš„Kibanaâ€å®‰è£…å¥½è‡ªå·±çš„Kibanaåœ¨æˆ‘ä»¬å®Œæˆä¸Šé¢çš„ä¸¤ä¸ªå®‰è£…åŽï¼Œæˆ‘ä»¬åˆ†åˆ«æ‰“å¼€ä¸¤ä¸ªterminalï¼Œç„¶åŽåˆ†åˆ«åœ¨ä¸¤ä¸ªterminalä¸­è¿è¡Œå¦‚ä¸‹çš„æŒ‡ä»¤ï¼š1./bin/elasticsearch -E node.name=node1 -E node.attr.data=hot -Enode.max_local_storage_nodes=2ä¸Šé¢çš„æŒ‡ä»¤è¿è¡Œä¸€ä¸ªåå­—å«åšnode1çš„ï¼Œdataå±žæ€§ä¸ºhotçš„nodeã€‚1./bin/elasticsearch -E node.name=node2 -E node.attr.data=warm -Enode.max_local_storage_nodes=2ä¸Šé¢çš„æŒ‡ä»¤è¿è¡Œä¸€ä¸ªåå­—å«åšnode2çš„ï¼Œdataå±žæ€§ä¸ºhotçš„warmã€‚æˆ‘ä»¬å¯ä»¥åœ¨Kibanaé‡ŒæŸ¥çœ‹æˆ‘ä»¬çš„nodesï¼šæˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥æœ‰ä¸¤ä¸ªnodeæ­£åœ¨è¿è¡Œï¼šnode1åŠnode2ã€‚å¦‚æžœæˆ‘ä»¬æƒ³äº†è§£è¿™ä¸¤ä¸ªnodeçš„æ›´å¤šå±žæ€§ï¼Œæˆ‘ä»¬å¯ä»¥æ‰“å…¥å¦‚ä¸‹çš„å‘½ä»¤ï¼š1GET _cat/nodeattrs?v&amp;s=nameæ˜¾ç¤ºçš„ç»“æžœä¸ºï¼šæˆ‘ä»¬å¯ä»¥çœ‹åˆ°nodeè¢«æ ‡è¯†ä¸ºhot nodeï¼Œè€Œnode2è¢«æ ‡è¯†ä¸ºwarm nodeã€‚æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¿ç”¨æˆ‘ä»¬ä¸Šé¢å‘½ä»¤æ¥æŠŠæˆ‘ä»¬çš„logs-2019-03ç½®äºŽæˆ‘ä»¬çš„hot nodeé‡Œã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤ï¼š12345678PUT logs-2019-03&#123; &quot;settings&quot;: &#123; &quot;number_of_shards&quot;: 1, &quot;number_of_replicas&quot;: 0, &quot;index.routing.allocation.require.data&quot;: &quot;hot&quot; &#125;&#125;è¿è¡Œä¸Šé¢çš„ç»“æžœåŽï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥æŸ¥çœ‹ï¼š1GET _cat/shards/logs-*?v&amp;h=index,shard,prirep,state,node&amp;s=index,shard,prirepæ˜¾ç¤ºçš„ç»“æžœä¸ºï¼šä»Žä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥æˆ‘ä»¬çš„logs-2019-03æ˜¯åˆ†é…åˆ°node1ä¸Šé¢çš„ã€‚å‡å¦‚æˆ‘ä»¬ç”±äºŽæŸç§åŽŸå› ï¼Œæƒ³æŠŠlogs-2019-03åˆ†é…åˆ°node2ä¸Šé¢ï¼Œé‚£ä¹ˆè¯¥æ€Žä¹ˆåšå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥å®žçŽ°ï¼š1234PUT logs-2019-03/_settings&#123; &quot;index.routing.allocation.require.data&quot;: &quot;warm&quot;&#125;è¿è¡Œä¸Šé¢çš„æŒ‡ä»¤æ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼šæ˜¾ç„¶æˆ‘ä»¬logs-2019-03å·²ç»æˆåŠŸåœ°ç§»åˆ°node2äº†ã€‚é’ˆå¯¹ç¡¬ä»¶çš„shard filteringä¸Šé¢æˆ‘ä»¬è¯´äº†ï¼Œå¯¹äºŽnode.attræ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ ä»»æ„çš„å±žæ€§ã€‚åœ¨ä¸Šé¢çš„æˆ‘ä»¬å·²ç»ä½¿ç”¨hot/warmæ¥æ ‡è¯†æˆ‘ä»¬çš„my_tempå±žæ€§ã€‚å…¶å®žæˆ‘ä»¬ä¹Ÿå¯ä»¥åŒæ—¶å®šä¹‰ä¸€äº›èƒ½æ ‡è¯†ç¡¬ä»¶çš„å±žæ€§my_serverï¼Œè¿™ä¸ªå±žæ€§å€¼å¯ä»¥ä¸ºsmallï¼ŒmediumåŠlargeã€‚æœ‰å¤šä¸ªå±žæ€§ç»„æˆçš„é›†ç¾¤å°±åƒæ˜¯å¦‚ä¸‹çš„ç»“æž„ï¼šé‚£ä¹ˆè¿™æ ·çš„é›†ç¾¤é‡Œçš„æ¯ä¸ªnodeå¯èƒ½å…·æœ‰ä¸åŒçš„å±žæ€§ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹æ³•æ¥åˆ†é…indexåˆ°åŒæ—¶å…·æœ‰ä¸¤ä¸ªæˆ–ä»¥ä¸Šå±žæ€§çš„nodeé‡Œ:123456789PUT my_index1 &#123; &quot;settings&quot;: &#123; &quot;number_of_shards&quot;: 2, &quot;number_of_replicas&quot;: 1, &quot;index.routing.allocation.include.my_server&quot;: &quot;medium&quot;, &quot;index.routing.allocation.require.my_temp&quot;: &quot;hot&quot; &#125;&#125;å¦‚ä¸Šæ‰€ç¤ºï¼Œæˆ‘ä»¬æŠŠæˆ‘ä»¬çš„my_index1åˆ†é…åˆ°è¿™ä¹ˆä¸€ä¸ªnodeï¼šè¿™ä¸ªnodeå¿…é¡»å…·æœ‰hotå±žæ€§ï¼ŒåŒæ—¶ä¹Ÿå…·æœ‰mediumçš„å±žæ€§ã€‚é’ˆå¯¹æˆ‘ä»¬ä¸Šé¢æ˜¾ç¤ºçš„å›¾ç‰‡ï¼Œåªæœ‰node1æ»¡è¶³æˆ‘ä»¬çš„è¦æ±‚ã€‚æ€»ç»“ï¼šåœ¨ä»Šå¤©çš„è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨shard filteringæ¥æŽ§åˆ¶æˆ‘ä»¬çš„indexçš„åˆ†é…ã€‚åœ¨å®žé™…çš„æ“ä½œä¸­ï¼Œå¯èƒ½å¤§å®¶ä¼šè§‰å¾—éº»çƒ¦ä¸€ç‚¹ï¼Œå› ä¸ºè¿™ä¸ªæ¯”è¾ƒéœ€è¦æˆ‘ä»¬è‡ªå·±æ¥ç®¡ç†è¿™ä¸ªã€‚è¿™ä¸ªæŠ€æœ¯å¯ä»¥å’Œæˆ‘ä¹‹å‰çš„æ–‡ç« â€œElasticsearch: rollover APIâ€ä¸€èµ·é…åˆä½¿ç”¨ã€‚Elasticsearchå®žé™…å·²ç»å¸®æˆ‘åšå¥½äº†ã€‚åœ¨æŽ¥ä¸‹æ¥çš„æ–‡ç« é‡Œï¼Œæˆ‘ä¼šæ¥ä»‹ç»å¦‚ä½•ä½¿ç”¨Index life cycle policyæ¥è‡ªåŠ¨ç®¡ç†æˆ‘ä»¬çš„Indexã€‚]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearchï¼šè¿ç”¨search_afteræ¥è¿›è¡Œæ·±åº¦åˆ†é¡µ]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%EF%BC%9A%E8%BF%90%E7%94%A8search_after%E6%9D%A5%E8%BF%9B%E8%A1%8C%E6%B7%B1%E5%BA%A6%E5%88%86%E9%A1%B5%2F</url>
    <content type="text"><![CDATA[åœ¨ä¸Šä¸€ç¯‡æ–‡ç«  â€œElasticsearchï¼šè¿ç”¨scrollæŽ¥å£å¯¹å¤§é‡æ•°æ®å®žçŽ°æ›´å¥½çš„åˆ†é¡µâ€ï¼Œæˆ‘ä»¬è®²è¿°äº†å¦‚ä½•è¿ç”¨scrollæŽ¥å£æ¥å¯¹å¤§é‡æ•°æ®æ¥è¿›è¡Œæœ‰æ•ˆåœ°åˆ†é¡µã€‚åœ¨é‚£ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è®²è¿°äº†ä¸¤ç§æ–¹æ³•ï¼šfromåŠ ä¸Šsizeçš„æ–¹æ³•æ¥è¿›è¡Œåˆ†é¡µè¿ç”¨scrollæŽ¥å£æ¥è¿›è¡Œåˆ†é¡µå¯¹äºŽå¤§é‡çš„æ•°æ®è€Œè¨€ï¼Œæˆ‘ä»¬å°½é‡é¿å…ä½¿ç”¨from+sizeè¿™ç§æ–¹æ³•ã€‚è¿™é‡Œçš„åŽŸå› æ˜¯index.max_result_windowçš„é»˜è®¤å€¼æ˜¯10Kï¼Œä¹Ÿå°±æ˜¯è¯´from+sizeçš„æœ€å¤§å€¼æ˜¯1ä¸‡ã€‚æœç´¢è¯·æ±‚å ç”¨å †å†…å­˜å’Œæ—¶é—´ä¸Žfrom+sizeæˆæ¯”ä¾‹ï¼Œè¿™é™åˆ¶äº†å†…å­˜ã€‚å‡å¦‚ä½ æƒ³hitä»Ž990åˆ°1000ï¼Œé‚£ä¹ˆæ¯ä¸ªshardè‡³å°‘éœ€è¦1000ä¸ªæ–‡æ¡£ï¼šä¸ºäº†é¿å…è¿‡åº¦ä½¿å¾—æˆ‘ä»¬çš„clusterç¹å¿™ï¼Œé€šå¸¸ScrollæŽ¥å£è¢«æŽ¨èä½œä¸ºæ·±å±‚æ¬¡çš„scrollingï¼Œä½†æ˜¯å› ä¸ºç»´æŠ¤scrollä¸Šä¸‹æ–‡ä¹Ÿæ˜¯éžå¸¸æ˜‚è´µçš„ï¼Œæ‰€ä»¥è¿™ç§æ–¹æ³•ä¸æŽ¨èä½œä¸ºå®žæ—¶ç”¨æˆ·è¯·æ±‚ã€‚search_afterå‚æ•°é€šè¿‡æä¾›å®žæ—¶cursoræ¥è§£å†³æ­¤é—®é¢˜ã€‚ æˆ‘ä»¬çš„æƒ³æ³•æ˜¯ä½¿ç”¨ä¸Šä¸€é¡µçš„ç»“æžœæ¥å¸®åŠ©æ£€ç´¢ä¸‹ä¸€é¡µã€‚æˆ‘ä»¬å…ˆè¾“å…¥å¦‚ä¸‹çš„æ–‡æ¡£åˆ°twitterç´¢å¼•ä¸­ï¼š12345678910111213POST _bulk&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 1&#125; &#125;&#123;&quot;user&quot;:&quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;DOB&quot;:&quot;1980-01-01&quot;, &quot;message&quot;:&quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;,&quot;uid&quot;:2,&quot;age&quot;:20,&quot;city&quot;:&quot;åŒ—äº¬&quot;,&quot;province&quot;:&quot;åŒ—äº¬&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;39.970718&quot;,&quot;lon&quot;:&quot;116.325747&quot;&#125;&#125;&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 2 &#125;&#125;&#123;&quot;user&quot;:&quot;ä¸œåŸŽåŒº-è€åˆ˜&quot;, &quot;DOB&quot;:&quot;1981-01-01&quot;, &quot;message&quot;:&quot;å‡ºå‘ï¼Œä¸‹ä¸€ç«™äº‘å—ï¼&quot;,&quot;uid&quot;:3,&quot;age&quot;:30,&quot;city&quot;:&quot;åŒ—äº¬&quot;,&quot;province&quot;:&quot;åŒ—äº¬&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½åŒ—äº¬å¸‚ä¸œåŸŽåŒºå°åŸºåŽ‚ä¸‰æ¡3å·&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;39.904313&quot;,&quot;lon&quot;:&quot;116.412754&quot;&#125;&#125;&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 3&#125; &#125;&#123;&quot;user&quot;:&quot;ä¸œåŸŽåŒº-æŽå››&quot;, &quot;DOB&quot;:&quot;1982-01-01&quot;, &quot;message&quot;:&quot;happy birthday!&quot;,&quot;uid&quot;:4,&quot;age&quot;:30,&quot;city&quot;:&quot;åŒ—äº¬&quot;,&quot;province&quot;:&quot;åŒ—äº¬&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½åŒ—äº¬å¸‚ä¸œåŸŽåŒº&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;39.893801&quot;,&quot;lon&quot;:&quot;116.408986&quot;&#125;&#125;&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 4&#125; &#125;&#123;&quot;user&quot;:&quot;æœé˜³åŒº-è€è´¾&quot;,&quot;DOB&quot;:&quot;1983-01-01&quot;, &quot;message&quot;:&quot;123,gogogo&quot;,&quot;uid&quot;:5,&quot;age&quot;:35,&quot;city&quot;:&quot;åŒ—äº¬&quot;,&quot;province&quot;:&quot;åŒ—äº¬&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½åŒ—äº¬å¸‚æœé˜³åŒºå»ºå›½é—¨&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;39.718256&quot;,&quot;lon&quot;:&quot;116.367910&quot;&#125;&#125;&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 5&#125; &#125;&#123;&quot;user&quot;:&quot;æœé˜³åŒº-è€çŽ‹&quot;,&quot;DOB&quot;:&quot;1984-01-01&quot;, &quot;message&quot;:&quot;Happy BirthDay My Friend!&quot;,&quot;uid&quot;:6,&quot;age&quot;:50,&quot;city&quot;:&quot;åŒ—äº¬&quot;,&quot;province&quot;:&quot;åŒ—äº¬&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½åŒ—äº¬å¸‚æœé˜³åŒºå›½è´¸&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;39.918256&quot;,&quot;lon&quot;:&quot;116.467910&quot;&#125;&#125;&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 6&#125; &#125;&#123;&quot;user&quot;:&quot;è™¹æ¡¥-è€å´&quot;, &quot;DOB&quot;:&quot;1985-01-01&quot;, &quot;message&quot;:&quot;å¥½å‹æ¥äº†éƒ½ä»Šå¤©æˆ‘ç”Ÿæ—¥ï¼Œå¥½å‹æ¥äº†,ä»€ä¹ˆ birthday happy å°±æˆ!&quot;,&quot;uid&quot;:7,&quot;age&quot;:90,&quot;city&quot;:&quot;ä¸Šæµ·&quot;,&quot;province&quot;:&quot;ä¸Šæµ·&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½ä¸Šæµ·å¸‚é—µè¡ŒåŒº&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;31.175927&quot;,&quot;lon&quot;:&quot;121.383328&quot;&#125;&#125;è¿™é‡Œå…±æœ‰6ä¸ªæ–‡æ¡£ã€‚å‡è®¾æ£€ç´¢ç¬¬ä¸€é¡µçš„æŸ¥è¯¢å¦‚ä¸‹æ‰€ç¤ºï¼š123456789101112131415161718192021GET twitter/_search&#123; &quot;size&quot;: 2, &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;city&quot;: &quot;åŒ—äº¬&quot; &#125; &#125;, &quot;sort&quot;: [ &#123; &quot;DOB&quot;: &#123; &quot;order&quot;: &quot;asc&quot; &#125; &#125;, &#123; &quot;user.keyword&quot;: &#123; &quot;order&quot;: &quot;asc&quot; &#125; &#125; ]&#125;æ˜¾ç¤ºçš„ç»“æžœä¸ºï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869&#123; &quot;took&quot; : 29, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 5, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : null, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : null, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;DOB&quot; : &quot;1980-01-01&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125; &#125;, &quot;sort&quot; : [ 315532800000, &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot; ] &#125;, &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;2&quot;, &quot;_score&quot; : null, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;ä¸œåŸŽåŒº-è€åˆ˜&quot;, &quot;DOB&quot; : &quot;1981-01-01&quot;, &quot;message&quot; : &quot;å‡ºå‘ï¼Œä¸‹ä¸€ç«™äº‘å—ï¼&quot;, &quot;uid&quot; : 3, &quot;age&quot; : 30, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚ä¸œåŸŽåŒºå°åŸºåŽ‚ä¸‰æ¡3å·&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.904313&quot;, &quot;lon&quot; : &quot;116.412754&quot; &#125; &#125;, &quot;sort&quot; : [ 347155200000, &quot;ä¸œåŸŽåŒº-è€åˆ˜&quot; ] &#125; ] &#125;&#125;ä¸Šè¿°è¯·æ±‚çš„ç»“æžœåŒ…æ‹¬æ¯ä¸ªæ–‡æ¡£çš„sortå€¼æ•°ç»„ã€‚ è¿™äº›sortå€¼å¯ä»¥ä¸Žsearch_afterå‚æ•°ä¸€èµ·ä½¿ç”¨ï¼Œä»¥å¼€å§‹è¿”å›žåœ¨è¿™ä¸ªç»“æžœåˆ—è¡¨ä¹‹åŽçš„ä»»ä½•æ–‡æ¡£ã€‚ ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸Šä¸€ä¸ªæ–‡æ¡£çš„sortå€¼å¹¶å°†å…¶ä¼ é€’ç»™search_afterä»¥æ£€ç´¢ä¸‹ä¸€é¡µç»“æžœï¼š12345678910111213141516171819202122232425GET twitter/_search&#123; &quot;size&quot;: 2, &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;city&quot;: &quot;åŒ—äº¬&quot; &#125; &#125;, &quot;search_after&quot;: [ 347155200000, &quot;ä¸œåŸŽåŒº-è€åˆ˜&quot; ], &quot;sort&quot;: [ &#123; &quot;DOB&quot;: &#123; &quot;order&quot;: &quot;asc&quot; &#125; &#125;, &#123; &quot;user.keyword&quot;: &#123; &quot;order&quot;: &quot;asc&quot; &#125; &#125; ]&#125;åœ¨è¿™é‡Œåœ¨search_afterä¸­ï¼Œæˆ‘ä»¬æŠŠä¸Šä¸€ä¸ªæœç´¢ç»“æžœçš„sortå€¼æ”¾è¿›æ¥ã€‚ æ˜¾ç¤ºçš„ç»“æžœä¸ºï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869&#123; &quot;took&quot; : 47, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 5, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : null, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;3&quot;, &quot;_score&quot; : null, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;ä¸œåŸŽåŒº-æŽå››&quot;, &quot;DOB&quot; : &quot;1982-01-01&quot;, &quot;message&quot; : &quot;happy birthday!&quot;, &quot;uid&quot; : 4, &quot;age&quot; : 30, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚ä¸œåŸŽåŒº&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.893801&quot;, &quot;lon&quot; : &quot;116.408986&quot; &#125; &#125;, &quot;sort&quot; : [ 378691200000, &quot;ä¸œåŸŽåŒº-æŽå››&quot; ] &#125;, &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;4&quot;, &quot;_score&quot; : null, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;æœé˜³åŒº-è€è´¾&quot;, &quot;DOB&quot; : &quot;1983-01-01&quot;, &quot;message&quot; : &quot;123,gogogo&quot;, &quot;uid&quot; : 5, &quot;age&quot; : 35, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æœé˜³åŒºå»ºå›½é—¨&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.718256&quot;, &quot;lon&quot; : &quot;116.367910&quot; &#125; &#125;, &quot;sort&quot; : [ 410227200000, &quot;æœé˜³åŒº-è€è´¾&quot; ] &#125; ] &#125;&#125;æ³¨æ„ï¼šå½“æˆ‘ä»¬ä½¿ç”¨search_afteræ—¶ï¼Œfromå€¼å¿…é¡»è®¾ç½®ä¸º0æˆ–è€…-1ã€‚search_afterä¸æ˜¯è‡ªç”±è·³è½¬åˆ°éšæœºé¡µé¢è€Œæ˜¯å¹¶è¡Œscrollå¤šä¸ªæŸ¥è¯¢çš„è§£å†³æ–¹æ¡ˆã€‚ å®ƒä¸Žscroll APIéžå¸¸ç›¸ä¼¼ï¼Œä½†ä¸Žå®ƒä¸åŒï¼Œsearch_afterå‚æ•°æ˜¯æ— çŠ¶æ€çš„ï¼Œå®ƒå§‹ç»ˆé’ˆå¯¹æœ€æ–°ç‰ˆæœ¬çš„æœç´¢å™¨è¿›è¡Œè§£æžã€‚ å› æ­¤ï¼ŒæŽ’åºé¡ºåºå¯èƒ½ä¼šåœ¨æ­¥è¡ŒæœŸé—´å‘ç”Ÿå˜åŒ–ï¼Œå…·ä½“å–å†³äºŽç´¢å¼•çš„æ›´æ–°å’Œåˆ é™¤ã€‚]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearchï¼šè¿ç”¨scrollæŽ¥å£å¯¹å¤§é‡æ•°æ®å®žçŽ°æ›´å¥½çš„åˆ†é¡µ]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%EF%BC%9A%E8%BF%90%E7%94%A8scroll%E6%8E%A5%E5%8F%A3%E5%AF%B9%E5%A4%A7%E9%87%8F%E6%95%B0%E6%8D%AE%E5%AE%9E%E7%8E%B0%E6%9B%B4%E5%A5%BD%E7%9A%84%E5%88%86%E9%A1%B5%2F</url>
    <content type="text"><![CDATA[åœ¨Elasticsearchä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡sizeå’Œfromæ¥å¯¹æˆ‘ä»¬çš„ç»“æžœæ¥è¿›è¡Œåˆ†é¡µã€‚ä½†æ˜¯å¯¹äºŽæ•°æ®é‡å¾ˆå¤§çš„ç´¢å¼•ï¼Œè¿™æ˜¯æœ‰æ•ˆçš„å—ï¼ŸScroll APIå¯ç”¨äºŽä»Žå•ä¸ªæœç´¢è¯·æ±‚ä¸­æ£€ç´¢å¤§é‡ç»“æžœï¼ˆç”šè‡³æ‰€æœ‰ç»“æžœï¼‰ï¼Œè¿™ä¸Žåœ¨ä¼ ç»Ÿæ•°æ®åº“ä¸Šä½¿ç”¨cursorçš„æ–¹å¼éžå¸¸ç›¸ä¼¼ã€‚Scrollä¸æ˜¯ç”¨äºŽå®žæ—¶ç”¨æˆ·è¯·æ±‚ï¼Œè€Œæ˜¯ç”¨äºŽå¤„ç†å¤§é‡æ•°æ®ï¼Œä¾‹å¦‚ï¼Œç”¨äºŽå¤„ç†å¤§é‡æ•°æ®ã€‚ ä¸ºäº†å°†ä¸€ä¸ªç´¢å¼•çš„å†…å®¹é‡æ–°ç´¢å¼•åˆ°å…·æœ‰ä¸åŒé…ç½®çš„æ–°ç´¢å¼•ä¸­ã€‚ä¸ºäº†è¯´æ˜Žé—®é¢˜ï¼Œæˆ‘ä»¬ä»Šå¤©å…ˆåˆ›å»ºä¸€ä¸ªå«åštwitterçš„Index:12345678910111213POST _bulk&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 1&#125; &#125;&#123;&quot;user&quot;:&quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;,&quot;message&quot;:&quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;,&quot;uid&quot;:2,&quot;age&quot;:20,&quot;city&quot;:&quot;åŒ—äº¬&quot;,&quot;province&quot;:&quot;åŒ—äº¬&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;39.970718&quot;,&quot;lon&quot;:&quot;116.325747&quot;&#125;&#125;&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 2 &#125;&#125;&#123;&quot;user&quot;:&quot;ä¸œåŸŽåŒº-è€åˆ˜&quot;,&quot;message&quot;:&quot;å‡ºå‘ï¼Œä¸‹ä¸€ç«™äº‘å—ï¼&quot;,&quot;uid&quot;:3,&quot;age&quot;:30,&quot;city&quot;:&quot;åŒ—äº¬&quot;,&quot;province&quot;:&quot;åŒ—äº¬&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½åŒ—äº¬å¸‚ä¸œåŸŽåŒºå°åŸºåŽ‚ä¸‰æ¡3å·&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;39.904313&quot;,&quot;lon&quot;:&quot;116.412754&quot;&#125;&#125;&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 3&#125; &#125;&#123;&quot;user&quot;:&quot;ä¸œåŸŽåŒº-æŽå››&quot;,&quot;message&quot;:&quot;happy birthday!&quot;,&quot;uid&quot;:4,&quot;age&quot;:30,&quot;city&quot;:&quot;åŒ—äº¬&quot;,&quot;province&quot;:&quot;åŒ—äº¬&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½åŒ—äº¬å¸‚ä¸œåŸŽåŒº&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;39.893801&quot;,&quot;lon&quot;:&quot;116.408986&quot;&#125;&#125;&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 4&#125; &#125;&#123;&quot;user&quot;:&quot;æœé˜³åŒº-è€è´¾&quot;,&quot;message&quot;:&quot;123,gogogo&quot;,&quot;uid&quot;:5,&quot;age&quot;:35,&quot;city&quot;:&quot;åŒ—äº¬&quot;,&quot;province&quot;:&quot;åŒ—äº¬&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½åŒ—äº¬å¸‚æœé˜³åŒºå»ºå›½é—¨&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;39.718256&quot;,&quot;lon&quot;:&quot;116.367910&quot;&#125;&#125;&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 5&#125; &#125;&#123;&quot;user&quot;:&quot;æœé˜³åŒº-è€çŽ‹&quot;,&quot;message&quot;:&quot;Happy BirthDay My Friend!&quot;,&quot;uid&quot;:6,&quot;age&quot;:50,&quot;city&quot;:&quot;åŒ—äº¬&quot;,&quot;province&quot;:&quot;åŒ—äº¬&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½åŒ—äº¬å¸‚æœé˜³åŒºå›½è´¸&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;39.918256&quot;,&quot;lon&quot;:&quot;116.467910&quot;&#125;&#125;&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 6&#125; &#125;&#123;&quot;user&quot;:&quot;è™¹æ¡¥-è€å´&quot;,&quot;message&quot;:&quot;å¥½å‹æ¥äº†éƒ½ä»Šå¤©æˆ‘ç”Ÿæ—¥ï¼Œå¥½å‹æ¥äº†,ä»€ä¹ˆ birthday happy å°±æˆ!&quot;,&quot;uid&quot;:7,&quot;age&quot;:90,&quot;city&quot;:&quot;ä¸Šæµ·&quot;,&quot;province&quot;:&quot;ä¸Šæµ·&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½ä¸Šæµ·å¸‚é—µè¡ŒåŒº&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;31.175927&quot;,&quot;lon&quot;:&quot;121.383328&quot;&#125;&#125;åœ¨ä¸Šé¢ï¼Œæˆ‘ä»¬åˆ›å»ºäº†6ä¸ªæ–‡æ¡£ã€‚è¿™äº›æ–‡æ¡£çš„æ•°é‡è™½ç„¶ä¸æ˜¯å¾ˆå¤šï¼Œä½†æ˜¯æˆ‘ä»¬æƒ³ä¸ºäº†è¯´æ˜Žé—®é¢˜çš„æ–¹ä¾¿ã€‚åœ¨å®žé™…çš„ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½æœ‰æˆç™¾ä¸Šåƒçš„æ–‡æ¡£ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬é€šè¿‡sizeå’Œfromçš„æ–¹æ³•æ¥è¿›è¡Œåˆ†é¡µã€‚å‡å¦‚æˆ‘ä»¬æŠŠsizsè®¾ç½®ä¸º2ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹å†™çš„æ–¹æ³•æ¥è¿›è¡Œåˆ†é¡µã€‚123GET twitter/_search?size=2&amp;from=0GET twitter/_search?size=2&amp;from=2GET twitter/_search?size=2&amp;from=4è¿™æ ·ï¼Œæˆ‘ä»¬æ¯æ¬¡å¯ä»¥å¾—åˆ°2ä¸ªæ–‡æ¡£ï¼Œä»Žè€Œå¯¹æˆ‘ä»¬çš„Indexè¿›è¡Œåˆ†é¡µã€‚æˆ‘ä»¬å¯ä»¥å¾—åˆ°è¿™äº›æ•°æ®å¹¶åœ¨è‡ªå·±çš„é¡µé¢ä¸Šæˆ–åº”ç”¨é‡Œè¿›è¡Œå±•ç¤ºã€‚é€šå¸¸è¿™æ ·çš„æ¯ä¸ªè¯·æ±‚è¿”å›žçš„ä¸Šçº¿æ˜¯10Kã€‚å¦‚æžœè¶…è¿‡è¿™ä¸ªä¸Šé™çš„è¯ï¼Œè¿™æ ·çš„æ–¹æ³•å°†ä¸å†é€‚åˆã€‚ä¸Šé¢çš„è¿™ç§æ–¹æ³•ï¼Œå¯¹äºŽå°é‡çš„æ•°æ®æ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯å¯¹äºŽå¤§é‡çš„æ•°æ®ï¼Œè€Œä¸”æˆ‘ä»¬éœ€è¦è¿›è¡Œsortæ—¶ï¼Œè¿™ä¸ªæœ‰å¯èƒ½å˜å¾—åŠ›ä¸ä»Žå¿ƒï¼Œæ¯”å¦‚ï¼š1234567891011121314151617GET twitter/_search&#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;city&quot;: &quot;åŒ—äº¬&quot; &#125; &#125;, &quot;from&quot;: 2, &quot;size&quot;: 2, &quot;sort&quot;: [ &#123; &quot;user.keyword&quot;: &#123; &quot;order&quot;: &quot;desc&quot; &#125; &#125; ]&#125;ä½ å¯ä»¥æƒ³è±¡å½“ä½ æ›´æ·±å…¥åœ°è¿›è¡Œåˆ†é¡µæ—¶ï¼Œå®ƒä¼šå˜å¾—å¤šä¹ˆä½Žæ•ˆã€‚ ä¾‹å¦‚ï¼Œå¦‚æžœæ›´æ”¹mappingå¹¶å¸Œæœ›å°†æ‰€æœ‰çŽ°æœ‰æ•°æ®é‡æ–°ç´¢å¼•åˆ°æ–°ç´¢å¼•ä¸­ï¼Œæ‚¨å¯èƒ½æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜æ¥å¯¹æ‰€æœ‰ç»“æžœè¿›è¡ŒæŽ’åºä»¥è¿”å›žæœ€åŽä¸€é¡µçš„æ•°æ®ã€‚å¯¹äºŽè¿™ç§åº”ç”¨åœºæ™¯ï¼Œä½ å¯ä»¥ä½¿ç”¨scanæœç´¢ç±»åž‹ã€‚æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼š1. ä½¿ç”¨scrollæ¥è¿”å›žä¸€ä¸ªåˆå§‹çš„æœç´¢ï¼Œå¹¶è¿”å›žä¸€ä¸ªscroll ID123456789GET twitter/_search?scroll=1m&#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;city&quot;: &quot;åŒ—äº¬&quot; &#125; &#125;, &quot;size&quot;: 2&#125;è¿™é‡Œçš„scroll=1mï¼Œè¡¨æ˜ŽElasticsearchå…è®¸ç­‰å¾…çš„æ—¶é—´æ˜¯1åˆ†é’Ÿã€‚å¦‚æžœåœ¨ä¸€åˆ†é’Ÿä¹‹å†…ï¼ŒæŽ¥ä¸‹æ¥çš„scrollè¯·æ±‚æ²¡æœ‰åˆ°è¾¾çš„è¯ï¼Œé‚£ä¹ˆå½“å‰çš„è¯·æ±‚çš„ä¸Šä¸‹æ–‡å°†ä¼šä¸¢å¤±ã€‚è¿”å›žçš„ç»“æžœæ˜¯ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960&#123; &quot;_scroll_id&quot; : &quot;DXF1ZXJ5QW5kRmV0Y2gBAAAAAAAAFh8WWUdCVlRMUllRb3UzMkdqb0IxVnZNUQ==&quot;, &quot;took&quot; : 31, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 5, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 0.48232412, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 0.48232412, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125; &#125; &#125;, &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;2&quot;, &quot;_score&quot; : 0.48232412, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;ä¸œåŸŽåŒº-è€åˆ˜&quot;, &quot;message&quot; : &quot;å‡ºå‘ï¼Œä¸‹ä¸€ç«™äº‘å—ï¼&quot;, &quot;uid&quot; : 3, &quot;age&quot; : 30, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚ä¸œåŸŽåŒºå°åŸºåŽ‚ä¸‰æ¡3å·&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.904313&quot;, &quot;lon&quot; : &quot;116.412754&quot; &#125; &#125; &#125; ] &#125;&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªè¿”å›žçš„_scroll_idã€‚è¿™ä¸ª_scroll_idå°†ä¼šè¢«ç”¨äºŽæŽ¥ä¸‹æ¥çš„è¯·æ±‚ã€‚2. ä½¿ç”¨_scroll_idï¼Œå†æ¬¡è¯·æ±‚åˆ©ç”¨ä¸Šæ¬¡è¯·æ±‚è¿”å›žæ¥çš„_scroll_idï¼Œå†æ¬¡è¯·æ±‚ä»¥èŽ·å¾—ä¸‹ä¸€ä¸ªpageçš„ä¿¡æ¯ï¼š12345GET _search/scroll&#123; &quot;scroll&quot;: &quot;1m&quot;, &quot;scroll_id&quot;:&quot;DXF1ZXJ5QW5kRmV0Y2gBAAAAAAAAHC8WWUdCVlRMUllRb3UzMkdqb0IxVnZNUQ==&quot;&#125;åœ¨è¿™é‡Œå¿…é¡»æŒ‡å‡ºçš„æ˜¯ï¼šè¿™é‡Œå¡«å†™çš„scroll_idæ˜¯ä¸Šä¸€ä¸ªè¯·æ±‚è¿”å›žçš„å€¼è¿™ä¸ªscroll_idçš„æœ‰æ•ˆæœŸæ˜¯æˆ‘ä»¬åœ¨ç¬¬ä¸€æ¬¡æœç´¢æ—¶å®šä¹‰çš„1mï¼Œä¹Ÿå°±æ˜¯1åˆ†é’Ÿã€‚å¦‚æžœè¶…è¿‡äº†ï¼Œè¿™ä¸ªå°±æ²¡æœ‰ç”¨è¿è¡ŒåŽè¿”å›žçš„ç»“æžœæ˜¯ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960&#123; &quot;_scroll_id&quot; : &quot;DXF1ZXJ5QW5kRmV0Y2gBAAAAAAAAHS0WWUdCVlRMUllRb3UzMkdqb0IxVnZNUQ==&quot;, &quot;took&quot; : 2, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 5, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 0.48232412, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;3&quot;, &quot;_score&quot; : 0.48232412, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;ä¸œåŸŽåŒº-æŽå››&quot;, &quot;message&quot; : &quot;happy birthday!&quot;, &quot;uid&quot; : 4, &quot;age&quot; : 30, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚ä¸œåŸŽåŒº&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.893801&quot;, &quot;lon&quot; : &quot;116.408986&quot; &#125; &#125; &#125;, &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;4&quot;, &quot;_score&quot; : 0.48232412, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;æœé˜³åŒº-è€è´¾&quot;, &quot;message&quot; : &quot;123,gogogo&quot;, &quot;uid&quot; : 5, &quot;age&quot; : 35, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æœé˜³åŒºå»ºå›½é—¨&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.718256&quot;, &quot;lon&quot; : &quot;116.367910&quot; &#125; &#125; &#125; ] &#125;&#125;æ˜¾ç„¶è¿™æ¬¡è¿”å›žçš„æ˜¯2ä¸ªæ–‡æ¡£ã€‚æˆ‘ä»¬éœ€è¦å†æ¬¡ä½¿ç”¨åŒæ ·çš„åŠžæ³•æ¥å¾—åˆ°æœ€åŽä¸€ä¸ªpageçš„ç»“æžœï¼š12345678910111213141516171819202122232425262728293031323334353637383940&#123; &quot;_scroll_id&quot; : &quot;DXF1ZXJ5QW5kRmV0Y2gBAAAAAAAADeoWeno1UkF2RWZRd202VW1HQXRlOWFUdw==&quot;, &quot;took&quot; : 2, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 5, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 0.48232412, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;5&quot;, &quot;_score&quot; : 0.48232412, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;æœé˜³åŒº-è€çŽ‹&quot;, &quot;message&quot; : &quot;Happy BirthDay My Friend!&quot;, &quot;uid&quot; : 6, &quot;age&quot; : 50, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æœé˜³åŒºå›½è´¸&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.918256&quot;, &quot;lon&quot; : &quot;116.467910&quot; &#125; &#125; &#125; ] &#125;&#125;æ˜¾ç„¶ï¼Œè¿™æ¬¡è¿”å›žçš„ç»“æžœåªæœ‰ä¸€ä¸ªæ•°å€¼ï¼Œæ¯”æˆ‘ä»¬è¯·æ±‚çš„pageå¤§å°2è¦å°ã€‚å¦‚æžœæˆ‘ä»¬åˆ©ç”¨è¿”å›žçš„_scroll_idå†æ¬¡è¯·æ±‚æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹è¿”å›žçš„ç»“æžœæ˜¯ï¼š12345678910111213141516171819&#123; &quot;_scroll_id&quot; : &quot;DXF1ZXJ5QW5kRmV0Y2gBAAAAAAAADeoWeno1UkF2RWZRd202VW1HQXRlOWFUdw==&quot;, &quot;took&quot; : 1, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 5, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 0.48232412, &quot;hits&quot; : [ ] &#125;&#125;è¿™æ¬¡æ˜¯ä¸€ä¸ªç»“æžœéƒ½æ²¡æœ‰ã€‚å¦‚æžœå®Œæˆæ­¤è¿‡ç¨‹ï¼Œåˆ™éœ€è¦æ¸…ç†ä¸Šä¸‹æ–‡ï¼Œå› ä¸ºä¸Šä¸‹æ–‡åœ¨è¶…æ—¶ä¹‹å‰ä»ä¼šå ç”¨è®¡ç®—èµ„æºã€‚ å¦‚ä¸‹é¢çš„å±å¹•å¿«ç…§æ‰€ç¤ºï¼Œæ‚¨å¯ä»¥ä½¿ç”¨scroll_idå‚æ•°åœ¨DELETE APIä¸­æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªä¸Šä¸‹æ–‡ï¼š1234DELTE_search/scroll&#123; &quot;scroll_id&quot;:&quot;DXF1ZXJ5QW5kRmV0Y2gBAAAAAAAAHC8WWUdCVlRMUllRb3UzMkdqb0IxVnZNUQ==&quot;&#125;å‚è€ƒï¼šã€1ã€‘Elasticsearch Scrollã€2ã€‘https://www.elastic.co/guide/en/elasticsearch/reference/7.4/search-request-body.html#request-body-search-scroll]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearchï¼šç”¨æˆ·å®‰å…¨è®¾ç½®]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%EF%BC%9A%E7%94%A8%E6%88%B7%E5%AE%89%E5%85%A8%E8%AE%BE%E7%BD%AE%2F</url>
    <content type="text"><![CDATA[Elastic Stackçš„ç»„ä»¶æ˜¯ä¸å®‰å…¨çš„ï¼Œå› ä¸ºå®ƒæ²¡æœ‰å†…ç½®çš„å›ºæœ‰å®‰å…¨æ€§ã€‚ è¿™æ„å‘³ç€ä»»ä½•äººéƒ½å¯ä»¥è®¿é—®å®ƒã€‚ åœ¨ç”Ÿäº§çŽ¯å¢ƒä¸­è¿è¡ŒElastic Stackæ—¶ï¼Œè¿™ä¼šå¸¦æ¥å®‰å…¨é£Žé™©ã€‚ ä¸ºäº†é˜²æ­¢ç”Ÿäº§ä¸­æœªç»æŽˆæƒçš„è®¿é—®ï¼Œé‡‡ç”¨äº†ä¸åŒçš„æœºåˆ¶æ¥æ–½åŠ å®‰å…¨æ€§ï¼Œä¾‹å¦‚åœ¨é˜²ç«å¢™åŽè¿è¡ŒElastic Stackå¹¶é€šè¿‡åå‘ä»£ç†ï¼ˆä¾‹å¦‚nginxï¼ŒHAProxyç­‰ï¼‰è¿›è¡Œä¿æŠ¤ã€‚ Elasticæä¾›å•†ä¸šäº§å“æ¥ä¿æŠ¤Elastic Stackã€‚ æ­¤äº§å“æ˜¯X-Packçš„ä¸€éƒ¨åˆ†ï¼Œæ¨¡å—ç§°ä¸ºå®‰å…¨æ€§ã€‚åœ¨ä»Šå¤©çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æ¥è®²è¿°å¦‚ä½•ä¸ºæˆ‘ä»¬çš„Elasticsç´¢å¼•è®¾ç½®å­—æ®µçº§çš„å®‰å…¨ã€‚è¿™æ ·æœ‰çš„å­—æ®µå¯¹æœ‰äº›ç”¨æˆ·æ˜¯å¯è§çš„ï¼Œè€Œå¯¹å¦å¤–ä¸€äº›ç”¨æˆ·æ˜¯ä¸å¯è§çš„ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å¯¹ç”¨æˆ·å®‰å…¨çš„è®¾ç½®ï¼Œä½¿å¾—ä¸åŒçš„ç”¨æˆ·æœ‰ä¸åŒçš„æƒé™ã€‚User authenticationåœ¨X-Packå®‰å…¨æ€§ä¸­ï¼Œå®‰å…¨èµ„æºæ˜¯åŸºäºŽç”¨æˆ·çš„å®‰å…¨æ€§çš„åŸºç¡€ã€‚ å®‰å…¨èµ„æºæ˜¯éœ€è¦è®¿é—®ä»¥æ‰§è¡ŒElasticsearché›†ç¾¤æ“ä½œçš„èµ„æºï¼Œä¾‹å¦‚ç´¢å¼•ï¼Œæ–‡æ¡£æˆ–å­—æ®µã€‚ X-Packå®‰å…¨æ€§é€šè¿‡åˆ†é…ç»™ç”¨æˆ·çš„è§’è‰²çš„æƒé™æ¥å®žçŽ°ã€‚ æƒé™æ˜¯é’ˆå¯¹å—ä¿æŠ¤èµ„æºçš„ä¸€é¡¹æˆ–å¤šé¡¹ç‰¹æƒã€‚ ç‰¹æƒæ˜¯ä¸€ä¸ªå‘½åçš„ç»„ï¼Œä»£è¡¨ç”¨æˆ·å¯ä»¥é’ˆå¯¹å®‰å…¨èµ„æºæ‰§è¡Œçš„ä¸€ä¸ªæˆ–å¤šä¸ªæ“ä½œã€‚ ç”¨æˆ·å¯ä»¥å…·æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªè§’è‰²ï¼Œå¹¶ä¸”ç”¨æˆ·æ‹¥æœ‰çš„æ€»æƒé™é›†å®šä¹‰ä¸ºå…¶æ‰€æœ‰è§’è‰²çš„æƒé™çš„å¹¶é›†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šä»Žä¸Šé¢çš„å›¾ä¸Šå¯ä»¥çœ‹å‡ºæ¥ï¼šä¸€ä¸ªç”¨æˆ·å¯ä»¥ç”¨å¤šä¸ªroleï¼Œè€Œæ¯ä¸ªroleå¯ä»¥å¯¹åº”å¤šä¸ªpermission(æƒé™ï¼‰ã€‚åœ¨æŽ¥ä¸‹æ¥çš„ç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬æ¥å±•ç¤ºå¦‚ä½•åˆ›å»ºç”¨æˆ·ï¼Œroleï¼ˆè§’è‰²ï¼‰ä»¥åŠæŠŠpermissionåˆ†é…åˆ°æ¯ä¸ªroleã€‚é€šè¿‡è¿™æ ·çš„ç»„åˆï¼Œæˆ‘ä»¬å¯ä»¥å®žçŽ°å¯¹å­—æ®µçº§çš„å®‰å…¨æŽ§åˆ¶ã€‚ä¸ºElasticè®¾ç½®å®‰å…¨åŠåˆ›å»ºç”¨æˆ·å½“æˆ‘ä»¬è®¾ç½®å®Œæˆ‘ä»¬çš„å®‰å…¨è´¦æˆ·åŽï¼Œæœ€å¼€å§‹æˆ‘ä»¬ä½¿ç”¨æœ€åŽŸå§‹çš„elasticçš„è´¦å·è¿›è¡Œç™»å½•ã€‚è¯·æ³¨æ„è¿™é‡Œçš„å¯†ç æ˜¯æˆ‘ä»¬è®¾ç½®elasticè´¦å·çš„å¯†ç ï¼š![](https://img-blog.csdnimg.cn/20190904225704187.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1VidW50dVRvdWNo,size_16,color_FFFFFF,t_70ç­‰ç™»å½•è¿›åŽ»ä¹‹åŽï¼ŒçŽ°åœ¨æˆ‘ä»¬åŽ»Manage/Sercurity/Usersé¡µé¢ï¼šæˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„è´¦å·ã€‚é’ˆå¯¹æˆ‘çš„æƒ…å†µï¼Œæˆ‘æƒ³åˆ›å»ºä¸€ä¸ªå«åšliuxgçš„ç”¨æˆ·åã€‚ç‚¹å‡»å½“å‰é¡µé¢çš„Create UseræŒ‰é’®ï¼šç„¶åŽå¡«å…¥æˆ‘ä»¬æ‰€éœ€è¦çš„ä¿¡æ¯ï¼šç‚¹å‡»Create UseræŒ‰é’®ï¼Œè¿™æ ·æˆ‘ä»¬å°±åˆ›å»ºäº†æˆ‘ä»¬çš„ç”¨æˆ·ã€‚æŒ‰ç…§åŒæ ·çš„æ­¥éª¤ï¼Œæˆ‘ä»¬æ¥åˆ›å»ºå¦å¤–ä¸€ä¸ªå«åšuser1çš„ç”¨æˆ·ã€‚å‡†å¤‡å®žéªŒæ•°æ®åœ¨æˆ‘ä»¬è¿˜æ²¡é€€å‡ºelasticç”¨æˆ·çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨bulk APIæ¥æŠŠå¦‚ä¸‹çš„æ–‡æ¡£è¾“å…¥åˆ°Elasticsearchä¸­ã€‚1234567POST employee/_bulk&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;employee&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;user1&quot;,&quot;email&quot;:&quot;user1@packt.com&quot;,&quot;salary&quot;:5000,&quot;gender&quot;:&quot;M&quot;,&quot;address1&quot;:&quot;312 Main St&quot;,&quot;address2&quot;:&quot;Walthill&quot;,&quot;state&quot;:&quot;NE&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;employee&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;user2&quot;,&quot;email&quot;:&quot;user2@packt.com&quot;,&quot;salary&quot;:10000,&quot;gender&quot;:&quot;F&quot;,&quot;address1&quot;:&quot;5658 N Denver Ave&quot;,&quot;address2&quot;:&quot;Portland&quot;,&quot;state&quot;:&quot;OR&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;employee&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;user3&quot;,&quot;email&quot;:&quot;user3@packt.com&quot;,&quot;salary&quot;:7000,&quot;gender&quot;:&quot;F&quot;,&quot;address1&quot;:&quot;300 Quinterra Ln&quot;,&quot;address2&quot;:&quot;Danville&quot;,&quot;state&quot;:&quot;CA&quot;&#125;è¿™æ ·æˆ‘ä»¬æŠŠä¸‰ä¸ªæ–‡æ¡£å­˜å…¥åˆ°employeeçš„ç´¢å¼•ä¹‹ä¸­ã€‚åˆ›å»ºæ–°çš„roleè¯·æ³¨æ„ï¼šå¦‚ä¸‹çš„æ“ä½œæ˜¯åœ¨elasticç”¨æˆ·ç™»å½•çš„æƒ…å†µä¸‹è¿›è¡Œæ“ä½œçš„ã€‚è¦åˆ›å»ºæ–°ç”¨æˆ·ï¼Œè¯·å¯¼èˆªåˆ°ç®¡ç†UIå¹¶åœ¨â€œSecurityâ€éƒ¨åˆ†ä¸­é€‰æ‹©â€œroleâ€ï¼Œæˆ–è€…å¦‚æžœæ‚¨å½“å‰åœ¨â€œUsersâ€å±å¹•ä¸Šï¼Œè¯·å•å‡»â€œRolesâ€é€‰é¡¹ã€‚ è§’è‰²å±å¹•æ˜¾ç¤ºæ‰€æœ‰å·²å®šä¹‰/å¯ç”¨çš„è§’è‰²:å½“æˆ‘ä»¬ç‚¹å‡»rolesåŽï¼šæˆ‘ä»¬ç‚¹å‡»Create roleæŒ‰é’®ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå«åšmonitor_roleï¼Œå®ƒå…·æœ‰monitorçš„æƒé™ã€‚æŠŠroleèµ‹äºˆç»™ç”¨æˆ·æˆ‘ä»¬æ‰“å¼€æˆ‘ä»¬çš„ç”¨æˆ·åˆ—è¡¨ã€‚é’ˆå¯¹æˆ‘çš„æƒ…å†µï¼Œæˆ‘ä»¬æ‰“å¼€liuxgç”¨æˆ·ï¼šæˆ‘ä»¬ä¿®æ”¹liuxgè´¦å·çš„Rolesã€‚æŠŠåˆšæ‰åˆ›å»ºçš„monitor_roleèµ‹äºˆç»™liuxgç”¨æˆ·ã€‚ç‚¹å‡»Update UseræŒ‰é’®ã€‚è¿™æ ·æˆ‘ä»¬çš„è®¾å®šå°±å¥½äº†ã€‚è®¾å®šå¥½çš„è´¦å·æ˜¯è¿™æ ·çš„ï¼šä»Žä¸Šé¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥liuxgè´¦å·æ˜¯æœ‰monitor_roleçš„ï¼Œè€Œuser1è´¦å·æ˜¯æ²¡æœ‰çš„ã€‚ä¸‹é¢æˆ‘ä»¬æ¥åšä¸€äº›åŸºæœ¬çš„æµ‹è¯•ã€‚æˆ‘ä»¬åœ¨ä¸€ä¸ªterminalä¸­æ‰“å…¥å¦‚ä¸‹çš„å‘½ä»¤ï¼š1curl -u liuxg:123456 &quot;http://localhost:9200/_cluster/health?pretty&quot;æ³¨æ„è¿™é‡Œçš„123456æ˜¯liuxgçš„è´¦å·å¯†ç ã€‚æ‰§è¡Œä¸Šé¢çš„æ˜¾ç¤ºç»“æžœæ˜¯ï¼šæˆ‘ä»¬æ˜¾ç„¶çœ‹åˆ°äº†ç»“æžœã€‚é‚£ä¹ˆæˆ‘ä»¬åŒæ ·åœ°å¯¹use1è´¦å·æ¥è¿›è¡Œå®žéªŒï¼š1curl -u user1:123456 &quot;http://localhost:9200/_cluster/health?pretty&quot;æ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼šæ˜¾ç„¶ï¼Œuser1è´¦å·æ²¡æœ‰å¾—åˆ°ä»»ä½•ç»“æžœã€‚è¿™ä¸ªæ ¹æœ¬çš„åŽŸå› æ˜¯å› ä¸ºè¿™ä¸ªè´¦å·æ²¡æœ‰ç›¸åº”çš„æƒé™ã€‚æ–‡æ¡£çº§æˆ–å­—æ®µçº§å®‰å…¨çŽ°åœ¨ï¼Œæˆ‘ä»¬çŸ¥é“äº†å¦‚ä½•åˆ›å»ºæ–°ç”¨æˆ·ï¼Œåˆ›å»ºæ–°è§’è‰²ä»¥åŠå°†è§’è‰²åˆ†é…ç»™ç”¨æˆ·ï¼Œè®©æˆ‘ä»¬æŽ¢è®¨å¦‚ä½•é’ˆå¯¹ç»™å®šçš„ç´¢å¼•/æ–‡æ¡£å¯¹æ–‡æ¡£å’Œå­—æ®µæ–½åŠ å®‰å…¨æ€§ã€‚æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨æˆ‘ä¹‹å‰ç»™å¤§å®¶è¾“å…¥è¿›çš„employeeç´¢å¼•æ¥å±•ç¤ºã€‚æ¡ˆä¾‹1å½“ç”¨æˆ·æœç´¢å‘˜å·¥è¯¦ç»†ä¿¡æ¯æ—¶ï¼Œè¯¥ç”¨æˆ·ä¸å…è®¸åŒ…å«åœ¨å±žäºŽå‘˜å·¥ç´¢å¼•çš„æ–‡æ¡£ä¸­çš„è–ªæ°´/åœ°å€è¯¦ç»†ä¿¡æ¯ã€‚è¿™å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„å­—æ®µçº§å®‰å…¨ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªå«åšemployee_readçš„roleã€‚è¿™ä¸ªroleåªå…·æœ‰employç´¢å¼•çš„readæƒé™ã€‚ä¸ºäº†é™åˆ¶å­—æ®µï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è®¾ç½®é‡Œåšç›¸åº”çš„é…ç½®ï¼šæˆ‘ä»¬åªå…è®¸è¿™ä¸ªemployee_read roleè®¿é—®genderï¼ŒstateåŠemailå­—æ®µï¼Œè€Œä¸”åªæœ‰readæƒé™ã€‚è¿ç”¨æˆ‘ä»¬åˆšæ‰è®¾ç½®çš„employee_read roleï¼Œæˆ‘ä»¬èµ‹äºˆç»™æˆ‘ä»¬çš„user1ç”¨æˆ·ï¼šè®¾ç½®å¥½çš„ç”¨æˆ·ç•Œé¢ä¸ºï¼š![] (https://img-blog.csdnimg.cn/20191029213613951.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1VidW50dVRvdWNo,size_16,color_FFFFFF,t_70)ä¸Šé¢æ˜¾ç¤ºæˆ‘ä»¬çš„user1å…·æœ‰employ_readçš„roleã€‚åœ¨æˆ‘ä»¬çš„ä¸€ä¸ªterminalé‡Œæ‰“å…¥å¦‚ä¸‹çš„å‘½ä»¤ï¼š1curl -u user1:123456 &quot;http://localhost:9200/employee/_search?pretty&quot;è¯·æ³¨æ„ï¼šè¿™é‡Œçš„123456æ˜¯user1ç”¨æˆ·çš„å¯†ç ã€‚ä¸Šé¢å‘½ä»¤æ˜¾ç¤ºçš„ç»“æžœä¸ºï¼šæ˜¾ç„¶ï¼Œuser1åªèƒ½è®¿é—®åœ¨employee_readä¸­çš„ä¸‰ä¸ªå­—æ®µã€‚æ¡ˆä¾‹2æˆ‘ä»¬æƒ³å®šä¹‰ä¸€ä¸ªroleã€‚è¿™ä¸ªroleå…·æœ‰readçš„æƒé™ï¼Œå¹¶ä¸”åªèƒ½è®¿é—®stateä¸ºORçš„é‚£äº›æ–‡æ¡£ã€‚æˆ‘ä»¬åšä¸€ä¸‹çš„è®¾ç½®ï¼šæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå«åšOR_stateçš„roleã€‚å®ƒé€šè¿‡ä¸€ä¸ªquery:1&#123;&quot;match&quot;: &#123;&quot;state.keyword&quot;:&quot;OR&quot;&#125;&#125;æ¥åŒ¹é…é¡¹å¯¹åº”çš„æ–‡æ¡£ã€‚æˆ‘ä»¬æŽ¥ç€æŠŠè¿™ä¸ªroleèµ‹äºˆç»™liuxgç”¨æˆ·ï¼šåœ¨æˆ‘ä»¬è®¾ç½®å®ŒåŽï¼Œæˆ‘ä»¬æŽ¥ç€åœ¨ä¸€ä¸ªterminalä¸­æ‰“å…¥å¦‚ä¸‹çš„å‘½ä»¤ï¼š1curl -u liuxg:123456 &quot;http://localhost:9200/employee/_search?pretty&quot;æ˜¾ç¤ºçš„ç»“æžœï¼šæˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥è¿™æ¬¡çš„æ˜¾ç¤ºçš„ç»“æžœåªæœ‰ä¸€ä¸ªï¼Œè€Œä¸”è¿™ä¸ªæ–‡æ¡£çš„stateæ˜¯ORã€‚]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearchï¼šä½¿ç”¨function_scoreåŠsoft_scoreå®šåˆ¶æœç´¢ç»“æžœçš„åˆ†æ•°]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%EF%BC%9A%E4%BD%BF%E7%94%A8function_score%E5%8F%8Asoft_score%E5%AE%9A%E5%88%B6%E6%90%9C%E7%B4%A2%E7%BB%93%E6%9E%9C%E7%9A%84%E5%88%86%E6%95%B0%2F</url>
    <content type="text"><![CDATA[æˆ‘ä»¬å°†ä»‹ç»ä½¿ç”¨function_scoreçš„åŸºç¡€çŸ¥è¯†ï¼Œå¹¶ä»‹ç»ä¸€äº›function coreæŠ€æœ¯éžå¸¸æœ‰ç”¨å’Œæœ‰æ•ˆçš„ç”¨ä¾‹ã€‚ä»‹ç»è¯„åˆ†çš„æ¦‚å¿µæ˜¯ä»»ä½•æœç´¢å¼•æ“Žï¼ˆåŒ…æ‹¬Elasticsearchï¼‰çš„æ ¸å¿ƒã€‚è¯„åˆ†å¯ä»¥ç²—ç•¥åœ°å®šä¹‰ä¸ºï¼šæ‰¾åˆ°ç¬¦åˆä¸€ç»„æ ‡å‡†çš„æ•°æ®å¹¶æŒ‰ç›¸å…³æ€§é¡ºåºå°†å…¶è¿”å›žã€‚ç›¸å…³æ€§é€šå¸¸æ˜¯é€šè¿‡ç±»ä¼¼TF-IDFçš„ç®—æ³•æ¥å®žçŽ°çš„ï¼Œè¯¥ç®—æ³•è¯•å›¾æ‰¾å‡ºæ–‡æœ¬ä¸Šä¸Žæäº¤çš„æŸ¥è¯¢æœ€ç›¸ä¼¼çš„æ–‡æ¡£ã€‚å°½ç®¡TF-IDFåŠå…¶è¡¨äº²ï¼ˆä¾‹å¦‚BM25ï¼‰éžå¸¸æ£’ï¼Œä½†æœ‰æ—¶å¿…é¡»é€šè¿‡å…¶ä»–ç®—æ³•æˆ–é€šè¿‡å…¶ä»–è¯„åˆ†å¯å‘å¼æ–¹æ³•æ¥è§£å†³ç›¸å…³æ€§é—®é¢˜ã€‚åœ¨è¿™é‡Œï¼ŒElasticsearchçš„script_scoreå’Œfunction_scoreåŠŸèƒ½å˜å¾—éžå¸¸æœ‰ç”¨ã€‚æœ¬æ–‡å°†ä»‹ç»è¿™äº›å·¥å…·çš„ç”¨æ³•ã€‚æ–‡æœ¬ç›¸ä¼¼æ€§ä¸æ˜¯æœ€é‡è¦å› ç´ çš„ä¸€ä¸ªåŸŸç¤ºä¾‹æ˜¯åœ°ç†æœç´¢ã€‚å¦‚æžœæ­£åœ¨å¯»æ‰¾åœ¨ç»™å®šç‚¹é™„è¿‘çš„å¥½å’–å•¡åº—ï¼Œåˆ™æŒ‰ä¸ŽæŸ¥è¯¢åœ¨æ–‡æœ¬ä¸Šçš„ç›¸ä¼¼ç¨‹åº¦å¯¹å’–å•¡åº—è¿›è¡ŒæŽ’åå¯¹ç”¨æˆ·è€Œè¨€ä¸æ˜¯å¾ˆæœ‰ç”¨ï¼Œä½†æŒ‰åœ°ç†ä½ç½®åœ¨é™„è¿‘çš„æŽ’åå¯¹ä»–ä»¬ã€‚å¦ä¸€ä¸ªç¤ºä¾‹å¯èƒ½æ˜¯è§†é¢‘å…±äº«ç«™ç‚¹ä¸Šçš„è§†é¢‘ï¼Œå…¶ä¸­æœç´¢ç»“æžœå¯èƒ½åº”è¯¥è€ƒè™‘è§†é¢‘çš„ç›¸å¯¹å—æ¬¢è¿Žç¨‹åº¦ã€‚å¦‚æžœæŸä¸ªæµè¡Œæ­Œæ˜Ÿä¸Šä¼ äº†å…·æœ‰ç»™å®šæ ‡é¢˜çš„è§†é¢‘ï¼Œä»Žè€ŒèŽ·å¾—äº†æ•°ç™¾ä¸‡çš„è§‚çœ‹æ¬¡æ•°ï¼Œé‚£ä¹ˆè¯¥è§†é¢‘å¯èƒ½åº”è¯¥æ¯”å…·æœ‰ç›¸ä¼¼æ–‡å­—ç›¸å…³æ€§çš„ä¸å—æ¬¢è¿Žçš„è§†é¢‘æ›´èƒœä¸€ç­¹ã€‚åœ¨ä½¿ç”¨Elasticsearchè¿›è¡Œå…¨æ–‡æœç´¢çš„æ—¶å€™ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨BM25è®¡ç®—çš„_scoreå­—æ®µè¿›è¡Œé™åºæŽ’åºçš„ã€‚å½“æˆ‘ä»¬éœ€è¦ç”¨å…¶ä»–å­—æ®µè¿›è¡Œé™åºæˆ–è€…å‡åºæŽ’åºçš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨sortå­—æ®µï¼Œä¼ å…¥æˆ‘ä»¬æƒ³è¦çš„æŽ’åºå­—æ®µå’Œæ–¹å¼ã€‚ å½“ç®€å•çš„ä½¿ç”¨å‡ ä¸ªå­—æ®µå‡é™åºæŽ’åˆ—ç»„åˆæ— æ³•æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦è‡ªå®šä¹‰æŽ’åºçš„ç‰¹æ€§ï¼ŒElasticsearchæä¾›äº†function_scoreçš„DSLæ¥è‡ªå®šä¹‰æ‰“åˆ†ï¼Œè¿™æ ·å°±å¯ä»¥æ ¹æ®è‡ªå®šä¹‰çš„_scoreæ¥è¿›è¡ŒæŽ’åºã€‚åœ¨å®žé™…çš„ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»æ³¨æ„çš„æ˜¯ï¼šsoft_scoreå’Œfunction_scoreæ˜¯è€—èµ„æºçš„ã€‚æ‚¨åªéœ€è¦è®¡ç®—ä¸€ç»„ç»è¿‡è¿‡æ»¤çš„æ–‡æ¡£çš„åˆ†æ•°ã€‚ä¸‹é¢æˆ‘ä»¬æ¥ç”¨ä¸€ä¸ªä¾‹å­æ¥å…·ä½“è¯´æ˜Žå¦‚ä½•æ¥é€šè¿‡script_coreå’Œfunction_coreæ¥å®šåˆ¶æˆ‘ä»¬çš„åˆ†æ•°ã€‚å‡†å¤‡æ•°æ®æˆ‘ä»¬é¦–å…ˆæ¥ä¸‹è½½æˆ‘ä»¬çš„æµ‹è¯•æ•°æ®ï¼š1git clone https://github.com/liu-xiao-guo/best_games_json_dataç„¶åŽæˆ‘ä»¬é€šè¿‡KibanaæŠŠè¿™ä¸ªæ•°æ®æ¥å¯¼å…¥åˆ°æˆ‘ä»¬çš„Elasticsearchä¸­ï¼šåœ¨å¯¼å…¥çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é€‰æ‹©Time fieldä¸ºyearï¼Œå¹¶ä¸”æŒ‡å®šç›¸åº”çš„æ—¥æœŸæ ¼å¼ï¼šæˆ‘ä»¬æŒ‡å®šæˆ‘ä»¬çš„ç´¢å¼•åå­—ä¸ºbest_gamesï¼šæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ä¸€ä¸‹ä¸€ä¸ªæ ·æœ¬çš„æ–‡æ¡£å°±åƒæ˜¯ä¸‹é¢çš„æ ¼å¼ä¸€æ ·ï¼š1234567891011121314&quot;_source&quot; : &#123; &quot;global_sales&quot; : 82.53, &quot;year&quot; : 2006, &quot;image_url&quot; : &quot;https://upload.wikimedia.org/wikipedia/en/thumb/e/e0/Wii_Sports_Europe.jpg/220px-Wii_Sports_Europe.jpg&quot;, &quot;platform&quot; : &quot;Wii&quot;, &quot;@timestamp&quot; : &quot;2006-01-01T00:00:00.000+08:00&quot;, &quot;user_score&quot; : 8, &quot;critic_score&quot; : 76, &quot;name&quot; : &quot;Wii Sports&quot;, &quot;genre&quot; : &quot;Sports&quot;, &quot;publisher&quot; : &quot;Nintendo&quot;, &quot;developer&quot; : &quot;Nintendo&quot;, &quot;id&quot; : &quot;wii-sports-wii-2006&quot;&#125;åœ¨ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥è¿™ä¸ªæ–‡æ¡£é‡Œæœ‰ä¸¤ä¸ªå¾ˆé‡è¦çš„å­—æ®µï¼šcritic_scoreåŠuser_scoreã€‚ä¸€ä¸ªæ˜¯è¡¨ç¤ºè¿™ä¸ªæ¸¸æˆçš„éš¾åº¦ï¼Œå¦å¤–ä¸€ä¸ªè¡¨ç¤ºæ¸¸æˆçš„å—æ¬¢è¿Žçš„ç¨‹åº¦ã€‚æ­£å¸¸æŸ¥è¯¢é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚æžœä¸ä½¿ç”¨ä»»ä½•çš„åˆ†æ•°å®šåˆ¶ï¼Œé‚£ä¹ˆæƒ…å†µæ˜¯æ€Žä¹ˆæ ·çš„ã€‚12345678910111213GET best_games/_search&#123; &quot;_source&quot;: [ &quot;name&quot;, &quot;critic_score&quot;, &quot;user_score&quot; ], &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;name&quot;: &quot;Final Fantasy&quot; &#125; &#125;&#125;åœ¨ä¸Šé¢çš„æŸ¥è¯¢ä¸­ï¼Œä¸ºäº†è¯´æ˜Žé—®é¢˜çš„æ–¹ä¾¿ï¼Œåœ¨è¿”å›žçš„ç»“æžœä¸­ï¼Œæˆ‘ä»¬åªè¿”å›žname, critic_scoreå’Œuser_scoreå­—æ®µã€‚æˆ‘ä»¬åœ¨nameå­—æ®µé‡Œå«æœ‰â€œFinal Fantasyâ€çš„æ‰€æœ‰æ¸¸æˆï¼Œé‚£ä¹ˆæ˜¾ç¤ºæ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š1234567891011121314151617181920212223242526272829303132333435&quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;2qccJ28BCSSrjaXdSOnC&quot;, &quot;_score&quot; : 8.138414, &quot;_source&quot; : &#123; &quot;user_score&quot; : 9, &quot;critic_score&quot; : 92, &quot;name&quot; : &quot;Final Fantasy VII&quot; &#125; &#125;, &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;6KccJ28BCSSrjaXdSOnC&quot;, &quot;_score&quot; : 8.138414, &quot;_source&quot; : &#123; &quot;user_score&quot; : 8, &quot;critic_score&quot; : 92, &quot;name&quot; : &quot;Final Fantasy X&quot; &#125; &#125;, &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;6qccJ28BCSSrjaXdSOnC&quot;, &quot;_score&quot; : 8.138414, &quot;_source&quot; : &#123; &quot;user_score&quot; : 8, &quot;critic_score&quot; : 90, &quot;name&quot; : &quot;Final Fantasy VIII&quot; &#125; &#125;, ...ä»Žä¸Šé¢çš„ç»“æžœä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥Final Fantasy VIIæ˜¯æœ€åŒ¹é…çš„ç»“æžœã€‚å®ƒçš„åˆ†æ•°æ˜¯æœ€é«˜çš„ã€‚Soft_score æŸ¥è¯¢åŠ å…¥æˆ‘ä»¬æˆ‘ä»¬æ˜¯æ¸¸æˆçš„è¿è¥å•†ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿè®¸æˆ‘ä»¬è‡ªå·±æƒ³è¦çš„æŽ’åçš„æ–¹æ³•ã€‚æ¯”å¦‚ï¼Œè™½ç„¶æ‰€æœ‰çš„ç»“æžœéƒ½å¾ˆåŒ¹é…ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿè®¸ä¸åªå•å•æ˜¯åŒ¹é…Final Fantasyï¼Œè€Œä¸”æˆ‘ä»¬æƒ³æŠŠuser_scoreå’Œcritic_scoreåŠ è¿›æ¥ï¼ˆè™½ç„¶ä½ å¯ä»¥ä½¿ç”¨å…¶ä¸­çš„ä¸€ä¸ªï¼‰ã€‚æˆ‘ä»¬æƒ³è¿™æ ·æ¥ç®—æˆ‘ä»¬çš„åˆ†æ•°ã€‚æœ€ç»ˆscore = score*(user_score*10 + critic_score)/2/100ä¹Ÿå°±æ˜¯æˆ‘ä»¬æŠŠuser_scoreä¹˜ä»¥10ï¼Œä»Žè€Œå˜æˆ100åˆ†åˆ¶ã€‚å®ƒå’Œcritic_scoreåŠ èµ·æ¥ï¼Œç„¶åŽé™¤ä»¥2ï¼Œå¹¶é™¤ä»¥100ï¼Œè¿™æ ·å°±å¾—å‡ºæ¥æœ€åŽçš„åˆ†æ•°çš„åŠ æƒç³»æ•°ã€‚è¿™ä¸ªåŠ æƒç³»æ•°å†ä¹˜ä»¥å…ˆå‰åœ¨ä¸Šä¸€æ­¥å¾—å‡ºæ¥çš„åˆ†æ•°æ‰æ˜¯æœ€ç»ˆçš„åˆ†æ•°å€¼ã€‚ç»è¿‡è¿™æ ·çš„æ”¹é€ åŽï¼Œæˆ‘ä»¬å‘çŽ°æˆ‘ä»¬çš„åˆ†æ•°å…¶å®žä¸å…‰æ˜¯å…¨æ–‡æœç´¢çš„ç›¸å…³æ€§ï¼ŒåŒæ—¶å®ƒä¹Ÿç´§ç´§åœ°å…³è”äº†æˆ‘ä»¬çš„ç”¨æˆ·ä½“éªŒå’Œæ¸¸æˆçš„éš¾é“ç³»æ•°ã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•ä½¿ç”¨è¿™ä¸ªå‘¢ï¼Ÿå‚ç…§Elasticsçš„å®˜æ–¹æ–‡æ¡£soft_scoreï¼Œæˆ‘ä»¬çŽ°åœ¨åšå¦‚ä¸‹çš„æœç´¢ï¼š1234567891011121314151617181920GET best_games/_search&#123; &quot;_source&quot;: [ &quot;name&quot;, &quot;critic_score&quot;, &quot;user_score&quot; ], &quot;query&quot;: &#123; &quot;script_score&quot;: &#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;name&quot;: &quot;Final Fantasy&quot; &#125; &#125;, &quot;script&quot;: &#123; &quot;source&quot;: &quot;_score * (doc[&apos;user_score&apos;].value*10+doc[&apos;critic_score&apos;].value)/2/100&quot; &#125; &#125; &#125;&#125;åœ¨ä¸Šé¢çš„æŸ¥è¯¢ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä½¿ç”¨äº†æ–°çš„å…¬å¼ï¼š123&quot;script&quot;: &#123; &quot;source&quot;: &quot;_score * (doc[&apos;user_score&apos;].value*10+doc[&apos;critic_score&apos;].value)/2/100&quot;&#125;é‚£ä¹ˆæˆ‘æŸ¥è¯¢åŽçš„ç»“æžœä¸ºï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546 &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;2qccJ28BCSSrjaXdSOnC&quot;, &quot;_score&quot; : 7.405957, &quot;_source&quot; : &#123; &quot;user_score&quot; : 9, &quot;critic_score&quot; : 92, &quot;name&quot; : &quot;Final Fantasy VII&quot; &#125; &#125;, &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;K6ccJ28BCSSrjaXdSOrC&quot;, &quot;_score&quot; : 7.0804205, &quot;_source&quot; : &#123; &quot;user_score&quot; : 8, &quot;critic_score&quot; : 94, &quot;name&quot; : &quot;Final Fantasy IX&quot; &#125; &#125;, &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;6KccJ28BCSSrjaXdSOnC&quot;, &quot;_score&quot; : 6.9990363, &quot;_source&quot; : &#123; &quot;user_score&quot; : 8, &quot;critic_score&quot; : 92, &quot;name&quot; : &quot;Final Fantasy X&quot; &#125; &#125;, &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;6qccJ28BCSSrjaXdSOnC&quot;, &quot;_score&quot; : 6.917652, &quot;_source&quot; : &#123; &quot;user_score&quot; : 8, &quot;critic_score&quot; : 90, &quot;name&quot; : &quot;Final Fantasy VIII&quot; &#125; &#125;,...æˆ‘ä»¬ä»Žä¸Šé¢å¯ä»¥çœ‹å‡ºæ¥æœ€ç»ˆçš„åˆ†æ•°_scoreæ˜¯å®Œå…¨ä¸ä¸€æ ·çš„å€¼ã€‚æˆ‘ä»¬åŒæ—¶ä¹Ÿçœ‹å‡ºæ¥å°½ç®¡ç¬¬ä¸€åçš„Final Fantasy VIIæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œä½†æ˜¯ç¬¬äºŒåçš„ä½ç½®ç”±Final Fantasy Xå˜ä¸ºFinal Fantasy IXäº†ã€‚é’ˆå¯¹scriptçš„è¿ç®—ï¼Œæœ‰ä¸€äº›é¢„å®šä¹‰å¥½çš„å‡½æ•°å¯ä»¥ä¾›æˆ‘ä»¬è°ƒç”¨ï¼Œå®ƒä»¬å¯ä»¥å¸®æˆ‘ä»¬åŠ é€Ÿæˆ‘ä»¬çš„è®¡ç®—ã€‚SaturationSigmoidRandom score functionDecay functions for numeric fieldsDecay functions for geo fieldsDecay functions for date fieldsFunctions for vector fieldsæˆ‘ä»¬å¯ä»¥å‚è€ƒElasticçš„å®˜æ–¹æ–‡æ¡£æ¥å¸®æˆ‘ä»¬æ›´æ·±å…¥åœ°äº†è§£ã€‚Function score æŸ¥è¯¢function_scoreå…è®¸æ‚¨ä¿®æ”¹æŸ¥è¯¢æ£€ç´¢çš„æ–‡æ¡£åˆ†æ•°ã€‚ ä¾‹å¦‚ï¼Œå¦‚æžœåˆ†æ•°å‡½æ•°åœ¨è®¡ç®—ä¸Šå¾ˆæ˜‚è´µï¼Œå¹¶ä¸”è¶³ä»¥åœ¨è¿‡æ»¤åŽçš„æ–‡æ¡£é›†ä¸Šè®¡ç®—åˆ†æ•°ï¼Œåˆ™æ­¤åŠŸèƒ½å¾ˆæœ‰ç”¨ã€‚è¦ä½¿ç”¨function_scoreï¼Œç”¨æˆ·å¿…é¡»å®šä¹‰ä¸€ä¸ªæŸ¥è¯¢å’Œä¸€ä¸ªæˆ–å¤šä¸ªå‡½æ•°ï¼Œè¿™äº›å‡½æ•°ä¸ºæŸ¥è¯¢è¿”å›žçš„æ¯ä¸ªæ–‡æ¡£è®¡ç®—ä¸€ä¸ªæ–°åˆ†æ•°ã€‚function_scoreå¯ä»¥åªä¸Žä¸€ä¸ªå‡½æ•°ä¸€èµ·ä½¿ç”¨ï¼Œæ¯”å¦‚ï¼š12345678910111213GET /_search&#123; &quot;query&quot;: &#123; &quot;function_score&quot;: &#123; &quot;query&quot;: &#123; &quot;match_all&quot;: &#123;&#125; &#125;, &quot;boost&quot;: &quot;5&quot;, &quot;random_score&quot;: &#123;&#125;, &quot;boost_mode&quot;: &quot;multiply&quot; &#125; &#125;&#125;è¿™é‡Œå®ƒæŠŠæ‰€æœ‰çš„æ–‡æ¡£çš„åˆ†æ•°ç”±5å’Œä¸€ä¸ªç”±random_score (è¿”å›ž0åˆ°1ä¹‹é—´çš„å€¼)ç›¸ä¹˜è€Œå¾—åˆ°ã€‚é‚£ä¹ˆè¿™ä¸ªåˆ†æ•°å°±æ˜¯ä¸€ä¸ªä»Ž0åˆ°5ä¹‹é—´çš„ä¸€ä¸ªæ•°å€¼ï¼š12345678910111213141516171819202122232425262728&quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;chicago_employees&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;Hrz0_W4BDM8YqwyDD06A&quot;, &quot;_score&quot; : 4.9999876, &quot;_source&quot; : &#123; &quot;Name&quot; : &quot;ADKINS, WILLIAM J&quot;, &quot;Job Titles&quot; : &quot;SUPERVISING FIRE COMMUNICATIONS OPERATOR&quot;, &quot;Department&quot; : &quot;OEMC&quot;, &quot;Full or Part-Time&quot; : &quot;F&quot;, &quot;Salary or Hourly&quot; : &quot;Salary&quot;, &quot;Annual Salary&quot; : 121472.04 &#125; &#125;, &#123; &quot;_index&quot; : &quot;kibana_sample_data_logs&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;eXNIHm8BjrINWI3xYF0J&quot;, &quot;_score&quot; : 4.9999495, &quot;_source&quot; : &#123; &quot;agent&quot; : &quot;Mozilla/5.0 (X11; Linux i686) AppleWebKit/534.24 (KHTML, like Gecko) Chrome/11.0.696.50 Safari/534.24&quot;, &quot;bytes&quot; : 6630, &quot;clientip&quot; : &quot;77.5.51.49&quot;, &quot;extension&quot; : &quot;&quot;, &quot;geo&quot; : &#123; &quot;srcdest&quot; : &quot;CN:ID&quot;, ...å°½ç®¡è¿™ä¸ªåˆ†æ•°æ²¡æœ‰å¤šå¤§å®žé™…çš„æ„æ€ï¼Œä½†æ˜¯å®ƒå¯ä»¥è®©æˆ‘ä»¬æ¯æ¬¡è¿›å…¥ä¸€ä¸ªç½‘é¡µçœ‹åˆ°ä¸åŒçš„æ–‡æ¡£ï¼Œè€Œä¸æ˜¯ä¸¥æ ¼æŒ‰ç…§å›ºå®šçš„åŒ¹é…è€Œå¾—åˆ°çš„å›ºå®šçš„ç»“æžœã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥é…åˆsoft_scoreä¸€èµ·æ¥ä½¿ç”¨function_scoreï¼š1234567891011121314151617181920GET best_games/_search&#123; &quot;_source&quot;: [ &quot;name&quot;, &quot;critic_score&quot;, &quot;user_score&quot; ], &quot;query&quot;: &#123; &quot;function_score&quot;: &#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;name&quot;: &quot;Final Fantasy&quot; &#125; &#125;, &quot;script_score&quot;: &#123; &quot;script&quot;: &quot;_score * (doc[&apos;user_score&apos;].value*10+doc[&apos;critic_score&apos;].value)/2/100&quot; &#125; &#125; &#125;&#125;é‚£ä¹ˆæ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546&quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;2qccJ28BCSSrjaXdSOnC&quot;, &quot;_score&quot; : 60.272747, &quot;_source&quot; : &#123; &quot;user_score&quot; : 9, &quot;critic_score&quot; : 92, &quot;name&quot; : &quot;Final Fantasy VII&quot; &#125; &#125;, &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;K6ccJ28BCSSrjaXdSOrC&quot;, &quot;_score&quot; : 57.623398, &quot;_source&quot; : &#123; &quot;user_score&quot; : 8, &quot;critic_score&quot; : 94, &quot;name&quot; : &quot;Final Fantasy IX&quot; &#125; &#125;, &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;6KccJ28BCSSrjaXdSOnC&quot;, &quot;_score&quot; : 56.96106, &quot;_source&quot; : &#123; &quot;user_score&quot; : 8, &quot;critic_score&quot; : 92, &quot;name&quot; : &quot;Final Fantasy X&quot; &#125; &#125;, &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;6qccJ28BCSSrjaXdSOnC&quot;, &quot;_score&quot; : 56.29872, &quot;_source&quot; : &#123; &quot;user_score&quot; : 8, &quot;critic_score&quot; : 90, &quot;name&quot; : &quot;Final Fantasy VIII&quot; &#125; &#125;, ...ç»†å¿ƒçš„è¯»è€…å¯èƒ½çœ‹å‡ºæ¥äº†ã€‚æˆ‘ä»¬çš„åˆ†æ•°å’Œä¹‹å‰çš„é‚£ä¸ªsoft_scoreç»“æžœæ˜¯ä¸ä¸€æ ·çš„ï¼Œä½†æ˜¯æˆ‘ä»¬æœç´¢çš„ç»“æžœçš„æŽ’åºæ˜¯ä¸€æ ·çš„ã€‚åœ¨ä¸Šé¢çš„scriptçš„å†™æ³•ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ç¡¬ç¼–ç ï¼Œä¹Ÿå°±æ˜¯æŠŠ10ç¡¬å†™å…¥åˆ°scriptä¸­äº†ã€‚å‡å¦‚æœ‰ä¸€ç§æƒ…å†µï¼Œæˆ‘å°†æ¥æƒ³ä¿®æ”¹è¿™ä¸ªå€¼ä¸º20æˆ–å…¶å®ƒçš„å€¼ï¼Œé‡æ–°çœ‹çœ‹æŸ¥è¯¢çš„ç»“æžœã€‚ç”±äºŽscriptçš„æ”¹å˜ï¼Œéœ€è¦é‡æ–°è¿›è¡Œç¼–è¯‘ï¼Œè¿™æ ·çš„æ•ˆçŽ‡å¹¶ä¸é«˜ã€‚ä¸€ç§è¾ƒå¥½çš„åŠžæ³•æ˜¯å¦‚ä¸‹çš„å†™æ³•ï¼š1234567891011121314151617181920212223GET best_games/_search&#123; &quot;_source&quot;: [ &quot;name&quot;, &quot;critic_score&quot;, &quot;user_score&quot; ], &quot;query&quot;: &#123; &quot;script_score&quot;: &#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;name&quot;: &quot;Final Fantasy&quot; &#125; &#125;, &quot;script&quot;: &#123; &quot;params&quot;:&#123; &quot;multiplier&quot;: 10 &#125;, &quot;source&quot;: &quot;_score * (doc[&apos;user_score&apos;].value*params.multiplier+doc[&apos;critic_score&apos;].value)/2/100&quot; &#125; &#125; &#125;&#125;è„šæœ¬ç¼–è¯‘è¢«ç¼“å­˜ä»¥åŠ å¿«æ‰§è¡Œé€Ÿåº¦ã€‚ å¦‚æžœè„šæœ¬å…·æœ‰éœ€è¦è€ƒè™‘çš„å‚æ•°ï¼Œåˆ™æœ€å¥½é‡ç”¨ç›¸åŒçš„è„šæœ¬å¹¶ä¸ºå…¶æä¾›å‚æ•°ã€‚boost_modeboost_modeæ˜¯ç”¨æ¥å®šä¹‰æœ€æ–°è®¡ç®—å‡ºæ¥çš„åˆ†æ•°å¦‚ä½•å’ŒæŸ¥è¯¢çš„åˆ†æ•°æ¥ç›¸ç»“åˆçš„ã€‚mulitply æŸ¥è¯¢åˆ†æ•°å’ŒåŠŸèƒ½åˆ†æ•°ç›¸ä¹˜ï¼ˆé»˜è®¤ï¼‰replace ä»…ä½¿ç”¨åŠŸèƒ½åˆ†æ•°ï¼ŒæŸ¥è¯¢åˆ†æ•°å°†è¢«å¿½ç•¥sum æŸ¥è¯¢åˆ†æ•°å’ŒåŠŸèƒ½åˆ†æ•°ç›¸åŠ avg å¹³å‡å€¼max æŸ¥è¯¢åˆ†æ•°å’ŒåŠŸèƒ½åˆ†æ•°çš„æœ€å¤§å€¼min æŸ¥è¯¢åˆ†æ•°å’ŒåŠŸèƒ½åˆ†æ•°çš„æœ€å°å€¼field_value_factorfield_value_factorå‡½æ•°ä½¿æ‚¨å¯ä»¥ä½¿ç”¨æ–‡æ¡£ä¸­çš„å­—æ®µæ¥å½±å“å¾—åˆ†ã€‚ ä¸Žä½¿ç”¨script_scoreå‡½æ•°ç±»ä¼¼ï¼Œä½†æ˜¯å®ƒé¿å…äº†è„šæœ¬ç¼–å†™çš„å¼€é”€ã€‚ å¦‚æžœç”¨äºŽå¤šå€¼å­—æ®µï¼Œåˆ™åœ¨è®¡ç®—ä¸­ä»…ä½¿ç”¨è¯¥å­—æ®µçš„ç¬¬ä¸€ä¸ªå€¼ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æ‚¨æœ‰ä¸€ä¸ªç”¨æ•°å­—likeså­—æ®µç´¢å¼•çš„æ–‡æ¡£ï¼Œå¹¶å¸Œæœ›é€šè¿‡è¯¥å­—æ®µå½±å“æ–‡æ¡£çš„å¾—åˆ†ï¼Œé‚£ä¹ˆè¿™æ ·åšçš„ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š12345678910111213GET /_search&#123; &quot;query&quot;: &#123; &quot;function_score&quot;: &#123; &quot;field_value_factor&quot;: &#123; &quot;field&quot;: &quot;likes&quot;, &quot;factor&quot;: 1.2, &quot;modifier&quot;: &quot;sqrt&quot;, &quot;missing&quot;: 1 &#125; &#125; &#125;&#125;ä¸Šé¢çš„function_scoreå°†æ ¹æ®field_value_factoreæŒ‰ç…§å¦‚ä¸‹çš„æ–¹å¼æ¥è®¡ç®—åˆ†æ•°ï¼šsqrt(1.2 * doc[&#39;likes&#39;].value)field_value_factorå‡½æ•°æœ‰è®¸å¤šé€‰é¡¹ï¼šfield è¦ä»Žæ–‡æ¡£ä¸­æå–çš„å­—æ®µã€‚factor å­—æ®µå€¼ä¹˜ä»¥çš„å¯é€‰å› å­ï¼Œé»˜è®¤ä¸º1ã€‚modifier åº”ç”¨äºŽå­—æ®µå€¼çš„ä¿®é¥°ç¬¦å¯ä»¥æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼šnoneï¼Œlogï¼Œlog1pï¼Œlog2pï¼Œlnï¼Œln1pï¼Œln2pï¼Œå¹³æ–¹ï¼Œsqrtæˆ–reciprocalã€‚ é»˜è®¤ä¸ºæ— ã€‚missing å¦‚æžœæ–‡æ¡£æ²¡æœ‰è¯¥å­—æ®µï¼Œåˆ™ä½¿ç”¨è¯¥å€¼ã€‚ å°±åƒä»Žæ–‡æ¡£ä¸­è¯»å–ä¸€æ ·ï¼Œä¿®é¥°ç¬¦å’Œå› æ•°ä»ç„¶é€‚ç”¨äºŽå®ƒã€‚é’ˆå¯¹æˆ‘ä»¬çš„ä¾‹å­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æ–¹æ³•æ¥é‡æ–°è®¡ç®—åˆ†æ•°ï¼š1234567891011121314151617181920212223GET best_games/_search&#123; &quot;_source&quot;: [ &quot;name&quot;, &quot;critic_score&quot;, &quot;user_score&quot; ], &quot;query&quot;: &#123; &quot;function_score&quot;: &#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;name&quot;: &quot;Final Fantasy&quot; &#125; &#125;, &quot;field_value_factor&quot;: &#123; &quot;field&quot;: &quot;user_score&quot;, &quot;factor&quot;: 1.2, &quot;modifier&quot;: &quot;none&quot;, &quot;missing&quot;: 1 &#125; &#125; &#125;&#125;åœ¨ä¸Šé¢çš„ä¾‹å­é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨user_scoreå­—æ®µï¼Œå¹¶æŠŠè¿™ä¸ªå­—æ®µçš„factorè®¾ç½®ä¸º1.2ã€‚è¿™æ ·åŠ å¤§è¿™ä¸ªå­—æ®µçš„é‡è¦æ€§ã€‚é‡æ–°è¿›è¡Œæœç´¢ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647 &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;2qccJ28BCSSrjaXdSOnC&quot;, &quot;_score&quot; : 87.89488, &quot;_source&quot; : &#123; &quot;user_score&quot; : 9, &quot;critic_score&quot; : 92, &quot;name&quot; : &quot;Final Fantasy VII&quot; &#125; &#125;, &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;6KccJ28BCSSrjaXdSOnC&quot;, &quot;_score&quot; : 78.128784, &quot;_source&quot; : &#123; &quot;user_score&quot; : 8, &quot;critic_score&quot; : 92, &quot;name&quot; : &quot;Final Fantasy X&quot; &#125; &#125;, &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;6qccJ28BCSSrjaXdSOnC&quot;, &quot;_score&quot; : 78.128784, &quot;_source&quot; : &#123; &quot;user_score&quot; : 8, &quot;critic_score&quot; : 90, &quot;name&quot; : &quot;Final Fantasy VIII&quot; &#125; &#125;, &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;K6ccJ28BCSSrjaXdSOrC&quot;, &quot;_score&quot; : 78.128784, &quot;_source&quot; : &#123; &quot;user_score&quot; : 8, &quot;critic_score&quot; : 94, &quot;name&quot; : &quot;Final Fantasy IX&quot; &#125; &#125;, ...æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥æˆ‘ä»¬çš„åˆ†æ•°åˆæœ‰äº›å˜åŒ–ã€‚è€Œä¸”æŽ’åºä¹Ÿæœ‰å˜åŒ–ã€‚functionsä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæ¯ä¸€ä¸ªdocéƒ½ä¼šä¹˜ä»¥ç›¸åŒçš„ç³»æ•°ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å¯¹ä¸åŒçš„docé‡‡ç”¨ä¸åŒçš„æƒé‡ã€‚è¿™æ—¶ï¼Œä½¿ç”¨functionsæ˜¯ä¸€ç§ä¸é”™çš„é€‰æ‹©ã€‚å‡ ä¸ªfunctionå¯ä»¥ç»„åˆã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥é€‰æ‹©ä»…åœ¨æ–‡æ¡£ä¸Žç»™å®šçš„è¿‡æ»¤æŸ¥è¯¢åŒ¹é…æ—¶æ‰åº”ç”¨è¯¥function:12345678910111213141516171819202122232425262728293031323334GET /_search&#123; &quot;query&quot;: &#123; &quot;function_score&quot;: &#123; &quot;query&quot;: &#123; &quot;match_all&quot;: &#123;&#125; &#125;, &quot;boost&quot;: &quot;5&quot;, &quot;functions&quot;: [ &#123; &quot;filter&quot;: &#123; &quot;match&quot;: &#123; &quot;test&quot;: &quot;bar&quot; &#125; &#125;, &quot;random_score&quot;: &#123;&#125;, &quot;weight&quot;: 23 &#125;, &#123; &quot;filter&quot;: &#123; &quot;match&quot;: &#123; &quot;test&quot;: &quot;cat&quot; &#125; &#125;, &quot;weight&quot;: 42 &#125; ], &quot;max_boost&quot;: 42, &quot;score_mode&quot;: &quot;max&quot;, &quot;boost_mode&quot;: &quot;multiply&quot;, &quot;min_score&quot;: 42 &#125; &#125;&#125;ä¸Šé¢çš„boostä¸º5ï¼Œä¹Ÿå³æ‰€æœ‰çš„æ–‡æ¡£çš„åŠ æƒéƒ½æ˜¯5ã€‚æˆ‘ä»¬åŒæ—¶ä¹Ÿçœ‹åˆ°å‡ ä¸ªå®šä¹‰çš„functionsã€‚å®ƒä»¬æ˜¯é’ˆå¯¹ç›¸åº”çš„åŒ¹é…çš„æ–‡æ¡£åˆ†åˆ«è¿›è¡ŒåŠ æƒçš„ã€‚å¦‚æžœåŒ¹é…äº†ï¼Œå°±å¯ä»¥ä¹˜ä»¥ç›¸åº”çš„åŠ æƒã€‚é’ˆå¯¹æˆ‘ä»¬çš„ä¾‹å­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åšå¦‚ä¸‹çš„å®žéªŒã€‚123456789101112131415161718192021222324GET best_games/_search&#123; &quot;query&quot;: &#123; &quot;function_score&quot;: &#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;name&quot;: &quot;Final Fantasy&quot; &#125; &#125;, &quot;boost&quot;: &quot;1&quot;, &quot;functions&quot;: [ &#123; &quot;filter&quot;: &#123; &quot;match&quot;: &#123; &quot;name&quot;: &quot; XIII&quot; &#125; &#125;, &quot;weight&quot;: 10000000 &#125; ], &quot;boost_mode&quot;: &quot;multiply&quot; &#125; &#125;&#125;æˆ‘ä»¬æƒ³æŠŠnameå«æœ‰XIIIçš„æ‰€æœ‰æ¸¸æˆéƒ½åŠ ä¸€ä¸ªæƒã€‚è¿™æ ·å®ƒå¯ä»¥æŽ’åˆ°æœ€å‰é¢ã€‚æˆ‘ä»¬ç»™å®ƒçš„åŠ æƒå€¼å¾ˆå¤§ï¼š10000000ã€‚æœç´¢åŽçš„ç»“æžœæ˜¯ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182 &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;KqccJ28BCSSrjaXdSOrC&quot;, &quot;_score&quot; : 8.1384144E7, &quot;_source&quot; : &#123; &quot;global_sales&quot; : 5.33, &quot;year&quot; : 2009, &quot;image_url&quot; : &quot;https://www.wired.com/images_blogs/gamelife/2009/09/ffxiii-01.jpg&quot;, &quot;platform&quot; : &quot;PS3&quot;, &quot;@timestamp&quot; : &quot;2009-01-01T00:00:00.000+08:00&quot;, &quot;user_score&quot; : 7, &quot;critic_score&quot; : 83, &quot;name&quot; : &quot;Final Fantasy XIII&quot;, &quot;genre&quot; : &quot;Role-Playing&quot;, &quot;publisher&quot; : &quot;Square Enix&quot;, &quot;developer&quot; : &quot;Square Enix&quot;, &quot;id&quot; : &quot;final-fantasy-xiii-ps3-2009&quot; &#125; &#125;, &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;OKccJ28BCSSrjaXdSOvC&quot;, &quot;_score&quot; : 7.2601472E7, &quot;_source&quot; : &#123; &quot;global_sales&quot; : 2.63, &quot;year&quot; : 2011, &quot;image_url&quot; : &quot;https://i.ytimg.com/vi/tSJH_vhaYUk/maxresdefault.jpg&quot;, &quot;platform&quot; : &quot;PS3&quot;, &quot;@timestamp&quot; : &quot;2011-01-01T00:00:00.000+08:00&quot;, &quot;user_score&quot; : 6, &quot;critic_score&quot; : 79, &quot;name&quot; : &quot;Final Fantasy XIII-2&quot;, &quot;genre&quot; : &quot;Role-Playing&quot;, &quot;publisher&quot; : &quot;Square Enix&quot;, &quot;developer&quot; : &quot;Square Enix&quot;, &quot;id&quot; : &quot;final-fantasy-xiii-2-ps3-2011&quot; &#125; &#125;, &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;2qccJ28BCSSrjaXdSOnC&quot;, &quot;_score&quot; : 8.138414, &quot;_source&quot; : &#123; &quot;global_sales&quot; : 9.72, &quot;year&quot; : 1997, &quot;image_url&quot; : &quot;https://r.hswstatic.com/w_907/gif/finalfantasyvii-MAIN.jpg&quot;, &quot;platform&quot; : &quot;PS&quot;, &quot;@timestamp&quot; : &quot;1997-01-01T00:00:00.000+08:00&quot;, &quot;user_score&quot; : 9, &quot;critic_score&quot; : 92, &quot;name&quot; : &quot;Final Fantasy VII&quot;, &quot;genre&quot; : &quot;Role-Playing&quot;, &quot;publisher&quot; : &quot;Sony Computer Entertainment&quot;, &quot;developer&quot; : &quot;SquareSoft&quot;, &quot;id&quot; : &quot;final-fantasy-vii-ps-1997&quot; &#125; &#125;, &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;6KccJ28BCSSrjaXdSOnC&quot;, &quot;_score&quot; : 8.138414, &quot;_source&quot; : &#123; &quot;global_sales&quot; : 8.05, &quot;year&quot; : 2001, &quot;image_url&quot; : &quot;https://www.mobygames.com/images/promo/l/192477-final-fantasy-x-screenshot.jpg&quot;, &quot;platform&quot; : &quot;PS2&quot;, &quot;@timestamp&quot; : &quot;2001-01-01T00:00:00.000+08:00&quot;, &quot;user_score&quot; : 8, &quot;critic_score&quot; : 92, &quot;name&quot; : &quot;Final Fantasy X&quot;, &quot;genre&quot; : &quot;Role-Playing&quot;, &quot;publisher&quot; : &quot;Sony Computer Entertainment&quot;, &quot;developer&quot; : &quot;SquareSoft&quot;, &quot;id&quot; : &quot;final-fantasy-x-ps2-2001&quot; &#125; &#125;,...æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ï¼Œåœ¨è¿™ä¸€æ¬¡çš„æœç´¢ä¸­Final Fantasy XIIIçš„æŽ’åå˜æˆç¬¬ä¸€äº†ã€‚Elasticsearchä¸­çš„è¡°å˜å‡½æ•°åœ¨Elasticsearchä¸­ï¼Œå¸¸è§çš„Decay function ï¼ˆè¡°å˜å‡½æ•°ï¼‰æœ‰ä¸€ä¸‹çš„å‡ ç§ï¼šFunctionè¯„åˆ†æŠ€æœ¯ä¸ä»…å¯ä»¥ä¿®æ”¹é»˜è®¤çš„Elasticsearchè¯„åˆ†ç®—æ³•ï¼Œè¿˜å¯ä»¥ç”¨äºŽå®Œå…¨æ›¿ä»£å®ƒã€‚ ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯â€œtrendingâ€æœç´¢ï¼Œæ˜¾ç¤ºä¸»é¢˜ä¸­æ­£åœ¨è¿…é€Ÿæµè¡Œçš„é¡¹ç›®ã€‚è¿™æ ·çš„åˆ†æ•°ä¸èƒ½åŸºäºŽç®€å•çš„æŒ‡æ ‡ï¼ˆä¾‹å¦‚â€œå–œæ¬¢â€æˆ–â€œè§‚çœ‹æ¬¡æ•°â€ï¼‰ï¼Œè€Œå¿…é¡»æ ¹æ®å½“å‰æ—¶é—´ä¸æ–­è°ƒæ•´ã€‚ ä¸Žåœ¨24å°æ—¶å†…èŽ·å¾—10000æ¬¡è§‚çœ‹çš„è§†é¢‘ç›¸æ¯”ï¼Œåœ¨1å°æ—¶å†…èŽ·å¾—1000æ¬¡è§‚çœ‹çš„è§†é¢‘é€šå¸¸è¢«è®¤ä¸ºâ€œæ›´çƒ­â€ã€‚ Elasticsearché™„å¸¦äº†å‡ ä¸ªè¡°å‡å‡½æ•°ï¼Œè¿™äº›å‡½æ•°ä½¿è§£å†³æ­¤ç±»é—®é¢˜å˜å¾—è½»è€Œæ˜“ä¸¾ã€‚æˆ‘ä»¬çŽ°åœ¨ä»¥gaussæ¥ä¸ºä¾‹å±•ç¤ºå¦‚ä½•ä½¿ç”¨è¿™ä¸ªè¡°å˜å‡½æ•°çš„ã€‚æ›²çº¿çš„å½¢çŠ¶å¯ä»¥é€šè¿‡orginï¼Œscaleï¼Œoffsetå’Œdecayæ¥æŽ§åˆ¶ã€‚ è¿™ä¸‰ä¸ªå˜é‡æ˜¯æŽ§åˆ¶æ›²çº¿å½¢çŠ¶çš„ä¸»è¦å·¥å…·ã€‚ å¯ä»¥å°†originå’Œscaleå‚æ•°è§†ä¸ºæ‚¨çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ï¼Œå®ƒå®šä¹‰äº†å°†åœ¨å…¶ä¸­å®šä¹‰æ›²çº¿çš„è¾¹ç•Œæ¡†ã€‚ å¦‚æžœæˆ‘ä»¬å¸Œæœ›è¶‹åŠ¿è§†é¢‘åˆ—è¡¨æ¶µç›–ä¸€æ•´å¤©ï¼Œåˆ™æœ€å¥½å°†åŽŸç‚¹å®šä¹‰ä¸ºå½“å‰æ—¶é—´æˆ³ï¼Œæ¯”ä¾‹å°ºå®šä¹‰ä¸º24å°æ—¶ã€‚ offsetå¯ç”¨äºŽåœ¨å¼€å§‹æ—¶å°†æ›²çº¿å®Œå…¨å¹³å¦ï¼Œä¾‹å¦‚å°†å…¶è®¾ç½®ä¸º1hï¼Œå¯æ¶ˆé™¤æœ€è¿‘è§†é¢‘çš„æ‰€æœ‰æƒ©ç½šï¼Œä¹Ÿå³æœ€è¿‘1ä¸ªå°æ—¶é‡Œçš„æ‰€æœ‰è§†é¢‘ä¸å—å½±å“ ã€‚æœ€åŽï¼Œè¡°å‡é€‰é¡¹ä¼šæ ¹æ®æ–‡æ¡£çš„ä½ç½®æ›´æ”¹æ–‡æ¡£é™çº§çš„ä¸¥é‡ç¨‹åº¦ã€‚ é»˜è®¤çš„è¡°å‡å€¼æ˜¯0.5ï¼Œè¾ƒå¤§çš„å€¼ä¼šä½¿æ›²çº¿æ›´é™¡å³­ï¼Œå…¶æ•ˆæžœä¹Ÿæ›´æ˜Žæ˜¾ã€‚æˆ‘ä»¬è¿˜æ˜¯æ‹¿æˆ‘ä»¬çš„best_gamesæ¥ä¸ºä¾‹ï¼š123456789101112131415161718192021222324252627282930GET best_games/_search&#123; &quot;_source&quot;: [ &quot;name&quot;, &quot;critic_score&quot;, &quot;user_score&quot; ], &quot;query&quot;: &#123; &quot;function_score&quot;: &#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;name&quot;: &quot;Final Fantasy&quot; &#125; &#125;, &quot;functions&quot;: [ &#123; &quot;gauss&quot;: &#123; &quot;@timestamp&quot;: &#123; &quot;origin&quot;: &quot;2016-01-01T00:00:00&quot;, &quot;scale&quot;: &quot;365d&quot;, &quot;offset&quot;: &quot;0h&quot;, &quot;decay&quot;: 0.1 &#125; &#125; &#125; ], &quot;boost_mode&quot;: &quot;multiply&quot; &#125; &#125;&#125;ä¸Šé¢çš„æŸ¥è¯¢æ˜¯åŸºäºŽ2016-010-01è¿™ä¸€å¤©å¼€å§‹ï¼Œåœ¨365å¤©ä¹‹å†…çš„æ–‡æ¡£ä¸æ”¶è¡°å‡ï¼Œé‚£ä¹ˆè¶…è¿‡è¿™ä¸ªæ—¶é—´çš„æ‰€æœ‰æ–‡æ¡£ï¼Œè¡°å‡çš„åŠ æƒå€¼ä¸º0.1ã€‚ä¹Ÿå°±æ˜¯è¯´1å¹´å¼€å¤–çš„æ‰€æœ‰æ–‡æ¡£å¯¹æˆ‘çš„æ„ä¹‰å¹¶ä¸æ˜¯å¤ªå¤šã€‚é‡æ–°è¿è¡Œæˆ‘ä»¬çš„æŸ¥è¯¢ï¼Œç»“æžœæ˜¾ç¤ºï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657 &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;OKccJ28BCSSrjaXdSOvC&quot;, &quot;_score&quot; : 6.6742494E-25, &quot;_source&quot; : &#123; &quot;user_score&quot; : 6, &quot;critic_score&quot; : 79, &quot;name&quot; : &quot;Final Fantasy XIII-2&quot; &#125; &#125;, &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;2qccJ28BCSSrjaXdSOnC&quot;, &quot;_score&quot; : 0.0, &quot;_source&quot; : &#123; &quot;user_score&quot; : 9, &quot;critic_score&quot; : 92, &quot;name&quot; : &quot;Final Fantasy VII&quot; &#125; &#125;, &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;6KccJ28BCSSrjaXdSOnC&quot;, &quot;_score&quot; : 0.0, &quot;_source&quot; : &#123; &quot;user_score&quot; : 8, &quot;critic_score&quot; : 92, &quot;name&quot; : &quot;Final Fantasy X&quot; &#125; &#125;, &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;6qccJ28BCSSrjaXdSOnC&quot;, &quot;_score&quot; : 0.0, &quot;_source&quot; : &#123; &quot;user_score&quot; : 8, &quot;critic_score&quot; : 90, &quot;name&quot; : &quot;Final Fantasy VIII&quot; &#125; &#125;, &#123; &quot;_index&quot; : &quot;best_games&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;FqccJ28BCSSrjaXdSOrC&quot;, &quot;_score&quot; : 0.0, &quot;_source&quot; : &#123; &quot;user_score&quot; : 7, &quot;critic_score&quot; : 92, &quot;name&quot; : &quot;Final Fantasy XII&quot; &#125; &#125;,...è¿™æ¬¡çš„æœç´¢ç»“æžœæ˜¾ç¤ºFinal Fantasy XIII-2æ˜¯å¾—åˆ†æœ€é«˜çš„æ–‡æ¡£ã€‚å‚è€ƒï¼šã€1ã€‘https://www.elastic.co/blog/found-function-scoringã€2ã€‘https://medium.com/horrible-hacks/customizing-scores-in-elasticsearch-for-product-recommendations-9e0d02ce1dbdã€3ã€‘https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-function-score-query.html#function-field-value-factorã€4ã€‘https://juejin.im/post/5df8f465518825123751c089ã€5ã€‘https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-script-score-query.html]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearchï¼šå¦‚ä½•æŠŠElasticsearchä¸­çš„æ•°æ®å¯¼å‡ºä¸ºCSVæ ¼å¼çš„æ–‡ä»¶]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%EF%BC%9A%E5%A6%82%E4%BD%95%E6%8A%8AElasticsearch%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%87%BA%E4%B8%BACSV%E6%A0%BC%E5%BC%8F%E7%9A%84%E6%96%87%E4%BB%B6%2F</url>
    <content type="text"><![CDATA[æœ¬æ•™ç¨‹å‘æ‚¨å±•ç¤ºå¦‚ä½•å°†æ•°æ®ä»ŽElasticsearchå¯¼å‡ºåˆ°CSVæ–‡ä»¶ã€‚ æƒ³è±¡ä¸€ä¸‹ï¼Œæ‚¨æƒ³è¦åœ¨Excelä¸­æ‰“å¼€ä¸€äº›Elasticsearchä¸­çš„æ•°æ®ï¼Œå¹¶æ ¹æ®è¿™äº›æ•°æ®åˆ›å»ºæ•°æ®é€è§†è¡¨ã€‚ è¿™åªæ˜¯ä¸€ä¸ªç”¨ä¾‹ï¼Œå…¶ä¸­å°†æ•°æ®ä»ŽElasticsearchå¯¼å‡ºåˆ°CSVæ–‡ä»¶å°†å¾ˆæœ‰ç”¨ã€‚æ–¹æ³•ä¸€å…¶å®žè¿™ç§æ–¹æ³•æœ€ç®€å•äº†ã€‚æˆ‘ä»¬å¯ä»¥ç›´æŽ¥ä½¿ç”¨Kibanaä¸­æä¾›çš„åŠŸèƒ½å®žçŽ°è¿™ä¸ªéœ€æ±‚ã€‚æˆ‘ä»¬é¦–å…ˆæ¥å‡†å¤‡æ•°æ®ï¼šå†æŽ¥ç€é€‰æ‹©Add dataã€‚è¿™æ ·æˆ‘ä»¬çš„Elasticsearchä¸­å°±ä¼šæœ‰æˆ‘ä»¬çš„eCommerceç´¢å¼•äº†ã€‚æˆ‘ä»¬æŽ¥ç€é€‰æ‹©Discoverï¼Œå¹¶é€‰æ‹©æˆ‘ä»¬åˆšæ‰å»ºç«‹çš„eCommerceç´¢å¼•ã€‚æˆ‘ä»¬åŒæ—¶è¦è®°å¾—åœ¨time pickeré‡Œé€‰æ‹©æˆ‘ä»¬æ‰€éœ€è¦çš„æ—¶é—´æ®µï¼šæˆ‘ä»¬å¯ä»¥åšä¸€äº›æˆ‘ä»¬æƒ³è¦çš„æœç´¢ï¼šæˆ‘ä»¬ç‚¹å‡»å·¦ä¸Šè§’çš„SaveæŒ‰é’®ï¼šæŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç‚¹å‡»ShareæŒ‰é’®ï¼šè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°æˆ‘ä»¬å½“å‰æœç´¢ç»“æžœçš„csvæ–‡ä»¶ã€‚æˆ‘ä»¬åªéœ€è¦åœ¨Kibanaä¸­ä¸‹è½½å³å¯ï¼šæ–¹æ³•äºŒæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Logstashæä¾›çš„åŠŸèƒ½æ¥åšè¿™ä¸ªã€‚è¿™ä¸ªçš„å¥½å¤„æ˜¯å¯ä»¥é€šè¿‡ç¼–ç¨‹çš„æ–¹å¼æ¥è¿›è¡Œã€‚Logstashä¸åªå…‰å¯ä»¥æŠŠæ•°æ®ä¼ ä¸ŠElasticsearchï¼ŒåŒæ—¶å®ƒè¿˜å¯ä»¥æŠŠæ•°æ®ä»ŽElasticsearchä¸­å¯¼å‡ºã€‚æˆ‘ä»¬é¦–å…ˆå¿…é¡»å®‰è£…å’ŒElasticsearchç›¸åŒç‰ˆæœ¬çš„ Logstashã€‚å¦‚æžœå¤§å®¶è¿˜ä¸æŒ‡å®šå¦‚å®‰è£…Logstashçš„è¯ï¼Œè¯·å‚é˜…æˆ‘çš„æ–‡ç« â€œå¦‚ä½•å®‰è£…Elasticæ ˆä¸­çš„Logstashâ€ã€‚æˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥æŸ¥çœ‹æˆ‘ä»¬çš„Logstashæ˜¯å¦æ”¯æŒcsvçš„output:1./bin/logstash-plugin list --group outputæ˜¾ç¤ºï¼š123456789101112131415161718192021logstash-output-cloudwatchlogstash-output-csvlogstash-output-elastic_app_searchlogstash-output-elasticsearchlogstash-output-emaillogstash-output-filelogstash-output-graphitelogstash-output-httplogstash-output-lumberjacklogstash-output-nagioslogstash-output-nulllogstash-output-pipelogstash-output-rabbitmqlogstash-output-redislogstash-output-s3logstash-output-snslogstash-output-sqslogstash-output-stdoutlogstash-output-tcplogstash-output-udplogstash-output-webhdfsæ˜¾ç„¶logstash-ouput-csvæ˜¯åœ¨åˆ—è¡¨ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬logstashæ”¯æŒcsvæ ¼å¼çš„è¾“å‡ºã€‚æˆ‘ä»¬å»ºç«‹å¦‚ä¸‹çš„Logstashçš„é…ç½®æ–‡ä»¶ï¼š12345678910111213141516171819202122232425262728293031323334353637383940convert_csv.confinput &#123; elasticsearch &#123; hosts =&gt; &quot;localhost:9200&quot; index =&gt; &quot;kibana_sample_data_ecommerce&quot; query =&gt; &apos;&#123; &quot;query&quot;: &#123; &quot;bool&quot;: &#123; &quot;must&quot;: [ &#123; &quot;match&quot;: &#123; &quot;currency&quot;: &quot;EUR&quot; &#125; &#125;, &#123; &quot;match&quot;: &#123; &quot;products.quantity&quot;: 1 &#125; &#125; ] &#125; &#125; &#125;&apos; &#125;&#125; output &#123; csv &#123; # This is the fields that you would like to output in CSV format. # The field needs to be one of the fields shown in the output when you run your # Elasticsearch query fields =&gt; [&quot;category&quot;, &quot;customer_birth_date&quot;, &quot;customer_first_name&quot;, &quot;customer_full_name&quot;, &quot;day_of_week&quot;] # This is where we store output. We can use several files to store our output # by using a timestamp to determine the filename where to store output. path =&gt; &quot;/Users/liuxg/tmp/csv-export.csv&quot; &#125;&#125;è¯·æ³¨æ„ä¸Šé¢çš„pathéœ€è¦è‡ªå·±åŽ»å®šä¹‰æ—¶å€™è‡ªå·±çŽ¯å¢ƒçš„è·¯å¾„ã€‚è¿™é‡Œæˆ‘ä»¬åœ¨fieldsé‡Œå®šä¹‰äº†æˆ‘ä»¬æƒ³è¦çš„å­—æ®µã€‚ç„¶åŽï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œæˆ‘ä»¬çš„Logstashåº”ç”¨ï¼š1./bin/logstash -f ~/data/convert_csv.confè¿™æ ·åœ¨æˆ‘ä»¬å®šä¹‰çš„æ–‡ä»¶è·¯å¾„/Users/liuxg/tmp/csv-export.csvå¯ä»¥çœ‹åˆ°ä¸€ä¸ªè¾“å‡ºçš„csvæ–‡ä»¶ã€‚æˆ‘ä»¬å¯ä»¥æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œå¹¶çœ‹åˆ°åƒè¿™æ ·çš„æ–‡æ¡£ï¼š]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearchï¼štop_hits aggregation]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%EF%BC%9Atop_hits%20aggregation%2F</url>
    <content type="text"><![CDATA[top_hitsæŒ‡æ ‡èšåˆå™¨è·Ÿè¸ªè¦èšåˆçš„æœ€ç›¸å…³æ–‡æ¡£ã€‚ è¯¥èšåˆå™¨æ—¨åœ¨ç”¨ä½œå­èšåˆå™¨ï¼Œä»¥ä¾¿å¯ä»¥æŒ‰å­˜å‚¨åˆ†åŒºæ±‡æ€»æœ€åŒ¹é…çš„æ–‡æ¡£ã€‚top_hitsèšåˆå™¨å¯ä»¥æœ‰æ•ˆåœ°ç”¨äºŽé€šè¿‡å­˜å‚¨æ¡¶èšåˆå™¨æŒ‰æŸäº›å­—æ®µå¯¹ç»“æžœé›†è¿›è¡Œåˆ†ç»„ã€‚ ä¸€ä¸ªæˆ–å¤šä¸ªå­˜å‚¨æ¡¶èšåˆå™¨ç¡®å®šå°†ç»“æžœé›†åˆ‡æˆå“ªäº›å±žæ€§ã€‚é€‰é¡¹ï¼šfrom-è¦èŽ·å–çš„ç¬¬ä¸€ä¸ªç»“æžœçš„åç§»é‡ã€‚size-æ¯ä¸ªå­˜å‚¨æ¡¶è¦è¿”å›žçš„æœ€åŒ¹é…åŒ¹é…é¡¹çš„æœ€å¤§æ•°ç›®ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿”å›žå‰ä¸‰ä¸ªåŒ¹é…é¡¹ã€‚æŽ’åº-åŒ¹é…çš„çƒ­é—¨åŒ¹é…çš„æŽ’åºæ–¹å¼ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œå‘½ä¸­æŒ‰ä¸»è¦æŸ¥è¯¢çš„åˆ†æ•°æŽ’åºã€‚æˆ‘ä»¬è¿˜æ˜¯æ¥ç”¨ä¸€ä¸ªä¾‹å­æ¥å±•ç¤ºå¦‚ä½•ä½¿ç”¨è¿™ä¸ªï¼šå‡†å¤‡æ•°æ®ï¼šæˆ‘ä»¬é€‰ç”¨Kibanaé‡Œå¸¦çš„å®˜æ–¹çš„Sample web logsæ¥ä½œä¸ºæˆ‘ä»¬çš„ç´¢å¼•ï¼šç„¶åŽåŠ è½½æˆ‘ä»¬çš„ç´¢å¼•ï¼šè¿™æ ·æˆ‘ä»¬çš„æ•°æ®å°±åŠ è½½å®Œæˆäº†ã€‚Top hits aggregationé¦–å…ˆï¼Œæˆ‘ä»¬å…ˆåšä¸€ä¸ªç®€å•çš„åŸºäºŽhostsçš„aggregation:123456789101112GET kibana_sample_data_logs/_search&#123; &quot;size&quot;: 0, &quot;aggs&quot;: &#123; &quot;hosts&quot;: &#123; &quot;terms&quot;: &#123; &quot;field&quot;: &quot;host.keyword&quot;, &quot;size&quot;: 2 &#125; &#125; &#125;&#125;ä¸Šé¢çš„æœç´¢çš„ç»“æžœæ˜¯æˆ‘ä»¬æƒ³å¾—åˆ°2ä¸ªæ¡¶çš„æ•°æ®ï¼ˆè¿™é‡Œä¸ºäº†è¯´æ˜Žé—®é¢˜çš„æ–¹ä¾¿ï¼Œè®¾å®šä¸º2ï¼‰ã€‚è€Œè¿™ä¸¤ä¸ªæ¡¶æ˜¯åŸºäºŽhostsçš„å€¼ã€‚æœç´¢çš„ç»“æžœæ˜¯ï¼š12345678910111213141516&quot;aggregations&quot; : &#123; &quot;hosts&quot; : &#123; &quot;doc_count_error_upper_bound&quot; : 0, &quot;sum_other_doc_count&quot; : 2807, &quot;buckets&quot; : [ &#123; &quot;key&quot; : &quot;artifacts.elastic.co&quot;, &quot;doc_count&quot; : 6488 &#125;, &#123; &quot;key&quot; : &quot;www.elastic.co&quot;, &quot;doc_count&quot; : 4779 &#125; ] &#125; &#125;çŽ°åœ¨çš„è¦æ±‚æ˜¯ï¼šæˆ‘ä»¬æƒ³é’ˆå¯¹è¿™é‡Œçš„æ¯ä¸ªæ¡¶å¾—åˆ°æŒ‰ç…§æˆ‘ä»¬éœ€è¦æŽ’åºçš„å‰é¢çš„å‡ ä¸ªç»“æžœï¼Œæ¯”å¦‚ä¸‹é¢çš„æœç´¢ï¼š12345678910111213141516171819202122232425262728293031323334GET kibana_sample_data_logs/_search&#123; &quot;size&quot;: 0, &quot;aggs&quot;: &#123; &quot;hosts&quot;: &#123; &quot;terms&quot;: &#123; &quot;field&quot;: &quot;host.keyword&quot;, &quot;size&quot;: 2 &#125;, &quot;aggs&quot;: &#123; &quot;most_bytes&quot;: &#123; &quot;top_hits&quot;: &#123; &quot;sort&quot;: [ &#123; &quot;bytes&quot;: &#123; &quot;order&quot;: &quot;desc&quot; &#125; &#125; ], &quot;_source&quot;: &#123; &quot;includes&quot;: [ &quot;bytes&quot;, &quot;hosts&quot;, &quot;ip&quot;, &quot;clientip&quot; ] &#125;, &quot;size&quot;: 2 &#125; &#125; &#125; &#125; &#125;&#125;ä¸Šé¢å®žé™…ä¸Šå¸‚ä¸€ä¸ªpiplelineçš„èšåˆã€‚å®ƒåœ¨é’ˆå¯¹ä¸Šé¢çš„æ¡¶æ¥åšäº†ä¸€ä¸ªtop_hitsçš„èšåˆã€‚é’ˆå¯¹æ¯ä¸ªæ¡¶ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…bytesçš„å¤§å°ï¼Œé™åºæŽ’åˆ—ï¼Œå¹¶ä¸”æ¯ä¸ªæ¡¶åªéœ€è¦ä¸¤ä¸ªæ•°æ®ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394&quot;aggregations&quot; : &#123; &quot;hosts&quot; : &#123; &quot;doc_count_error_upper_bound&quot; : 0, &quot;sum_other_doc_count&quot; : 2807, &quot;buckets&quot; : [ &#123; &quot;key&quot; : &quot;artifacts.elastic.co&quot;, &quot;doc_count&quot; : 6488, &quot;most_bytes&quot; : &#123; &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 6488, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : null, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;kibana_sample_data_logs&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;dnNIHm8BjrINWI3xXlRc&quot;, &quot;_score&quot; : null, &quot;_source&quot; : &#123; &quot;bytes&quot; : 19929, &quot;ip&quot; : &quot;127.155.255.9&quot;, &quot;clientip&quot; : &quot;127.155.255.9&quot; &#125;, &quot;sort&quot; : [ 19929 ] &#125;, &#123; &quot;_index&quot; : &quot;kibana_sample_data_logs&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;OXNIHm8BjrINWI3xX1td&quot;, &quot;_score&quot; : null, &quot;_source&quot; : &#123; &quot;bytes&quot; : 19904, &quot;ip&quot; : &quot;100.177.58.231&quot;, &quot;clientip&quot; : &quot;100.177.58.231&quot; &#125;, &quot;sort&quot; : [ 19904 ] &#125; ] &#125; &#125; &#125;, &#123; &quot;key&quot; : &quot;www.elastic.co&quot;, &quot;doc_count&quot; : 4779, &quot;most_bytes&quot; : &#123; &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 4779, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : null, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;kibana_sample_data_logs&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;4nNIHm8BjrINWI3xYWQl&quot;, &quot;_score&quot; : null, &quot;_source&quot; : &#123; &quot;bytes&quot; : 19986, &quot;ip&quot; : &quot;233.204.30.48&quot;, &quot;clientip&quot; : &quot;233.204.30.48&quot; &#125;, &quot;sort&quot; : [ 19986 ] &#125;, &#123; &quot;_index&quot; : &quot;kibana_sample_data_logs&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;wnNIHm8BjrINWI3xW0Rj&quot;, &quot;_score&quot; : null, &quot;_source&quot; : &#123; &quot;bytes&quot; : 19956, &quot;ip&quot; : &quot;129.237.102.30&quot;, &quot;clientip&quot; : &quot;129.237.102.30&quot; &#125;, &quot;sort&quot; : [ 19956 ] &#125; ] &#125; &#125; &#125; ] &#125;&#125;ä»Žä¸Šé¢çš„è¿”å›žç»“æžœå¯ä»¥çœ‹å‡ºæ¥ä¸¤ä¸ªhosts artifacts.elastic.coåŠwww.elastic.coå„è¿”å›žä¸¤ä¸ªç»“æžœï¼Œå¹¶ä¸”å®ƒä»¬æ˜¯æŒ‰ç…§bytesçš„å¤§å°è¿›è¡Œé™åºæŽ’åˆ—çš„ã€‚ç»†å¿ƒçš„è¯»è€…å¯èƒ½ä¼šå‘çŽ°è¿™ä¸ªå’Œæˆ‘ä¹‹å‰ä»‹ç»çš„field collapsingæœ‰äº›ç±»ä¼¼ã€‚åªæ˜¯field collapsingé‡Œé’ˆå¯¹æ¯ä¸ªæ¡¶æœ‰ä¸€ä¸ªç»“æžœï¼Œå¹¶ä¸”æ˜¯æŒ‰ç…§æˆ‘ä»¬çš„è¦æ±‚è¿›è¡ŒæŽ’åºçš„æœ€é«˜ç»“æžœçš„é‚£ä¸ªã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å«æœ‰å¤šå‡ ä¸ªè¿”å›žç»“æžœåœ¨inner_hitsä¹‹ä¸­ã€‚å‚è€ƒï¼šã€1ã€‘https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations-metrics-top-hits-aggregation.html]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearchï¼šSmart Chinese Analysis plugin]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%EF%BC%9ASmart%20Chinese%20Analysis%20plugin%2F</url>
    <content type="text"><![CDATA[Smart Chinese Analysisæ’ä»¶å°†Luceneçš„Smart Chineseåˆ†æžæ¨¡å—é›†æˆåˆ°Elasticsearchä¸­ï¼Œç”¨äºŽåˆ†æžä¸­æ–‡æˆ–ä¸­è‹±æ–‡æ··åˆæ–‡æœ¬ã€‚ æ”¯æŒçš„åˆ†æžå™¨åœ¨å¤§åž‹è®­ç»ƒè¯­æ–™åº“ä¸Šä½¿ç”¨åŸºäºŽéšé©¬å°”å¯å¤«ï¼ˆMarkovï¼‰æ¨¡åž‹çš„æ¦‚çŽ‡çŸ¥è¯†æ¥æŸ¥æ‰¾ç®€ä½“ä¸­æ–‡æ–‡æœ¬çš„æœ€ä½³åˆ†è¯ã€‚ å®ƒä½¿ç”¨çš„ç­–ç•¥æ˜¯é¦–å…ˆå°†è¾“å…¥æ–‡æœ¬åˆ†è§£ä¸ºå¥å­ï¼Œç„¶åŽå¯¹å¥å­è¿›è¡Œåˆ‡åˆ†ä»¥èŽ·å¾—å•è¯ã€‚ è¯¥æ’ä»¶æä¾›äº†ä¸€ä¸ªç§°ä¸ºsmartcnåˆ†æžå™¨çš„åˆ†æžå™¨ï¼Œä»¥åŠä¸€ä¸ªç§°ä¸ºsmartcn_tokenizerçš„æ ‡è®°å™¨ã€‚ è¯·æ³¨æ„ï¼Œä¸¤è€…å‡ä¸èƒ½ä½¿ç”¨ä»»ä½•å‚æ•°è¿›è¡Œé…ç½®ã€‚è¦å°†smartcn Analysisæ’ä»¶å®‰è£…åœ¨Elasticsearch Dockerå®¹å™¨ä¸­ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å±å¹•æˆªå›¾ä¸­æ˜¾ç¤ºçš„å‘½ä»¤ã€‚ ç„¶åŽï¼Œæˆ‘ä»¬é‡æ–°å¯åŠ¨å®¹å™¨ä»¥ä½¿æ’ä»¶ç”Ÿæ•ˆï¼š1./bin/elasticsearch-plugin install analysis-smartcnåœ¨Elasticsearchçš„å®‰è£…ç›®å½•è¿è¡Œä¸Šé¢çš„å‘½ä»¤ã€‚æ˜¾ç¤ºçš„ç»“æžœå¦‚ä¸‹ï¼š1234567891011121314$ ./bin/elasticsearch-plugin install analysis-smartcn-&gt; Downloading analysis-smartcn from elastic[=================================================] 100% WARNING: An illegal reflective access operation has occurredWARNING: Illegal reflective access by org.bouncycastle.jcajce.provider.drbg.DRBG (file:/Users/liuxg/elastic/elasticsearch-7.3.0/lib/tools/plugin-cli/bcprov-jdk15on-1.61.jar) to constructor sun.security.provider.Sun()WARNING: Please consider reporting this to the maintainers of org.bouncycastle.jcajce.provider.drbg.DRBGWARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operationsWARNING: All illegal access operations will be denied in a future release-&gt; Installed analysis-smartcn(base) localhost:elasticsearch-7.3.0 liuxg$ ./bin/elasticsearch-plugin listanalysis-icuanalysis-ikanalysis-smartcnpinyinä¸Šé¢æ˜¾ç¤ºæˆ‘ä»¬å·²ç»æˆåŠŸåœ°æŠŠanalysis-smartcnå®‰è£…æˆåŠŸäº†ã€‚é’ˆå¯¹dockerçš„å®‰è£…ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥è¿›å…¥åˆ°dockeré‡Œï¼Œå†è¿›è¡Œå®‰è£…ï¼š12345$ docker exec -it es01 /bin/bash[root@ec4d19f59a7d elasticsearch]# lsLICENSE.txt README.textile config jdk logs pluginsNOTICE.txt bin data lib modules[root@ec4d19f59a7d elasticsearch]#åœ¨è¿™é‡Œes01æ˜¯dockerä¸­çš„Elasticsearchå®žä¾‹ã€‚å…·ä½“å®‰è£…è¯·å‚é˜…æˆ‘çš„æ–‡ç« â€œElasticï¼šç”¨Dockeréƒ¨ç½²Elasticæ ˆâ€ã€‚æ³¨æ„ï¼šåœ¨æˆ‘ä»¬å®‰è£…å¥½smartcnåˆ†æžå™¨åŽï¼Œæˆ‘ä»¬å¿…é¡»é‡æ–°å¯åŠ¨Elasticsearchä½¿å®ƒå¼€å§‹èµ·ä½œç”¨ã€‚å®žä¾‹åœ¨ä¸‹é¢ï¼Œæˆ‘ä»¬åœ¨Kibanaä¸­ç”¨ä¸€ä¸ªå®žä¾‹æ¥å±•ç¤ºè¿™ä¸ªç”¨æ³•ï¼š12345POST _analyze &#123; &quot;text&quot;: &quot;è‚¡å¸‚ï¼ŒæŠ•èµ„ï¼Œç¨³ï¼Œèµšï¼Œä¸ï¼Œèµ”ï¼Œå¿…ä¿®è¯¾ï¼Œå¦‚ä½•ï¼Œåšï¼Œå¥½ï¼Œä»“ï¼Œä½ï¼Œç®¡ç†ï¼Œå’Œï¼Œæƒ…ç»ªï¼Œç®¡ç†&quot;, &quot;analyzer&quot;: &quot;smartcn&quot;&#125;æ˜¾ç¤ºç»“æžœï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116&#123; &quot;tokens&quot; : [ &#123; &quot;token&quot; : &quot;è‚¡å¸‚&quot;, &quot;start_offset&quot; : 0, &quot;end_offset&quot; : 2, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 0 &#125;, &#123; &quot;token&quot; : &quot;æŠ•èµ„&quot;, &quot;start_offset&quot; : 3, &quot;end_offset&quot; : 5, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 2 &#125;, &#123; &quot;token&quot; : &quot;ç¨³&quot;, &quot;start_offset&quot; : 6, &quot;end_offset&quot; : 7, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 4 &#125;, &#123; &quot;token&quot; : &quot;èµš&quot;, &quot;start_offset&quot; : 8, &quot;end_offset&quot; : 9, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 6 &#125;, &#123; &quot;token&quot; : &quot;ä¸&quot;, &quot;start_offset&quot; : 10, &quot;end_offset&quot; : 11, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 8 &#125;, &#123; &quot;token&quot; : &quot;èµ”&quot;, &quot;start_offset&quot; : 12, &quot;end_offset&quot; : 13, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 10 &#125;, &#123; &quot;token&quot; : &quot;å¿…ä¿®è¯¾&quot;, &quot;start_offset&quot; : 14, &quot;end_offset&quot; : 17, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 12 &#125;, &#123; &quot;token&quot; : &quot;å¦‚ä½•&quot;, &quot;start_offset&quot; : 18, &quot;end_offset&quot; : 20, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 14 &#125;, &#123; &quot;token&quot; : &quot;åš&quot;, &quot;start_offset&quot; : 21, &quot;end_offset&quot; : 22, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 16 &#125;, &#123; &quot;token&quot; : &quot;å¥½&quot;, &quot;start_offset&quot; : 23, &quot;end_offset&quot; : 24, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 18 &#125;, &#123; &quot;token&quot; : &quot;ä»“&quot;, &quot;start_offset&quot; : 25, &quot;end_offset&quot; : 26, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 20 &#125;, &#123; &quot;token&quot; : &quot;ä½&quot;, &quot;start_offset&quot; : 27, &quot;end_offset&quot; : 28, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 22 &#125;, &#123; &quot;token&quot; : &quot;ç®¡ç†&quot;, &quot;start_offset&quot; : 29, &quot;end_offset&quot; : 31, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 24 &#125;, &#123; &quot;token&quot; : &quot;å’Œ&quot;, &quot;start_offset&quot; : 32, &quot;end_offset&quot; : 33, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 26 &#125;, &#123; &quot;token&quot; : &quot;æƒ…ç»ª&quot;, &quot;start_offset&quot; : 34, &quot;end_offset&quot; : 36, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 28 &#125;, &#123; &quot;token&quot; : &quot;ç®¡ç†&quot;, &quot;start_offset&quot; : 37, &quot;end_offset&quot; : 39, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 30 &#125; ]&#125;]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearchï¼šsignificant terms aggregation]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%EF%BC%9Asignificant%20terms%20aggregation%2F</url>
    <content type="text"><![CDATA[åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹å…³æ³¨significant termså’Œsignificant textèšåˆã€‚è¿™äº›èšåˆæ—¨åœ¨æœç´¢æ•°æ®é›†ä¸­æœ‰è¶£å’Œ/æˆ–ä¸å¯»å¸¸çš„æœ¯è¯­ï¼Œè¿™äº›æœ¯è¯­å¯ä»¥å‘Šè¯‰æ‚¨æœ‰å…³æ•°æ®çš„éšè—å±žæ€§çš„æ›´å¤šä¿¡æ¯ã€‚æ­¤åŠŸèƒ½å¯¹äºŽä»¥ä¸‹ç”¨ä¾‹ç‰¹åˆ«æœ‰ç”¨ï¼šä¸ºç”¨æˆ·æŸ¥è¯¢æ ‡è¯†åŒ…å«åŒä¹‰è¯ï¼Œé¦–å­—æ¯ç¼©ç•¥è¯ç­‰çš„ç›¸å…³æ–‡æ¡£ã€‚ä¾‹å¦‚ï¼Œå½“ç”¨æˆ·æœç´¢H1N1æ—¶ï¼Œé‡è¦æœ¯è¯­èšåˆå¯èƒ½ä¼šå»ºè®®å¸¦æœ‰â€œbird fluâ€çš„æ–‡æ¡£ã€‚è¯†åˆ«æ•°æ®ä¸­çš„å¼‚å¸¸å’Œæœ‰è¶£çš„äº‹ä»¶ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡åŸºäºŽä½ç½®è¿‡æ»¤æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šç‰¹å®šåŒºåŸŸä¸­æœ€å¸¸è§çš„çŠ¯ç½ªç±»åž‹ã€‚ä½¿ç”¨å¯¹æ•´æ•°å­—æ®µï¼ˆä¾‹å¦‚èº«é«˜ï¼Œä½“é‡ï¼Œæ”¶å…¥ç­‰ï¼‰çš„significant termèšåˆæ¥ç¡®å®šä¸€ç»„ä¸»é¢˜çš„æœ€é‡è¦å±žæ€§ã€‚åº”å½“æ³¨æ„ï¼Œé‡è¦æœ¯è¯­å’Œé‡è¦æ–‡æœ¬èšåˆéƒ½å¯¹ç›´æŽ¥æŸ¥è¯¢ï¼ˆå‰æ™¯é›†ï¼‰å’Œç´¢å¼•ä¸­æ‰€æœ‰å…¶ä»–æ–‡æ¡£ï¼ˆèƒŒæ™¯é›†ï¼‰æ£€ç´¢çš„æ–‡æ¡£æ‰§è¡Œå¤æ‚çš„ç»Ÿè®¡è®¡ç®—ã€‚å› æ­¤ï¼Œä¸¤ç§èšåˆéƒ½éœ€è¦å¤§é‡è®¡ç®—ï¼Œå› æ­¤åº”æ­£ç¡®é…ç½®ä»¥å¿«é€Ÿå·¥ä½œã€‚ä½†æ˜¯ï¼Œä¸€æ—¦åœ¨æœ¬æ•™ç¨‹çš„å¸®åŠ©ä¸‹æŽŒæ¡äº†å®ƒä»¬ï¼Œæ‚¨å°†èŽ·å¾—ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­æž„å»ºéžå¸¸æœ‰ç”¨çš„åŠŸèƒ½å¹¶ä»Žæ•°æ®é›†ä¸­èŽ·å–æœ‰ç”¨çš„è§è§£ã€‚è®©æˆ‘ä»¬å¼€å§‹å§ï¼åœ¨æ•™ç¨‹å¼€å§‹ï¼Œæˆ‘ä»¬å‡å®šæ‚¨å·²ç»æŠŠElasticsearchåŠKibanaå®Œæ•´åœ°å®‰è£…å¥½äº†ã€‚åˆ›å»ºIndex mappingä¸ºäº†è¯´æ˜Žsignificant termså’Œsignificant textçš„å·¥ä½œæ–¹å¼ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªæµ‹è¯•â€œnewsâ€ç´¢å¼•æ¥å­˜å‚¨æ–°é—»æ–‡ç« çš„é›†åˆã€‚ ç´¢å¼•æ˜ å°„å°†åŒ…å«è¯¸å¦‚ä½œè€…ï¼Œå‡ºç‰ˆæ—¥æœŸï¼Œæ–‡ç« æ ‡é¢˜ï¼Œè§†å›¾æ•°å’Œä¸»é¢˜ä¹‹ç±»çš„å­—æ®µã€‚ è®©æˆ‘ä»¬åˆ›å»ºæ˜ å°„ï¼š1234567891011121314151617181920212223PUT news&#123; &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;published&quot;: &#123; &quot;type&quot;: &quot;date&quot;, &quot;format&quot;: &quot;dateOptionalTime&quot; &#125;, &quot;author&quot;: &#123; &quot;type&quot;: &quot;keyword&quot; &#125;, &quot;title&quot;: &#123; &quot;type&quot;: &quot;text&quot; &#125;, &quot;topic&quot;: &#123; &quot;type&quot;: &quot;keyword&quot; &#125;, &quot;views&quot;: &#123; &quot;type&quot;: &quot;integer&quot; &#125; &#125; &#125;&#125;å¦‚æ‚¨æ‰€è§ï¼Œæˆ‘ä»¬åœ¨topicå’Œauthorå­—æ®µä¸­ä½¿ç”¨äº†keywordæ•°æ®ç±»åž‹ï¼Œåœ¨titleå­—æ®µä¸­ä½¿ç”¨äº†textæ•°æ®ç±»åž‹ã€‚ æé†’æ‚¨ï¼Œå…³é”®å­—å­—æ®µåªèƒ½æŒ‰å…¶ç¡®åˆ‡å€¼è¿›è¡Œæœç´¢ï¼Œè€Œæ–‡æœ¬å­—æ®µå¯ç”¨äºŽå…¨æ–‡æœç´¢ã€‚æŽ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨Bulk APIå°†ä¸€äº›ä»»æ„æ–°é—»æ–‡æ¡£æ·»åŠ åˆ°ç´¢å¼•ä¸­ã€‚123456789101112131415161718192021POST news/_bulk&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;news&quot;&#125;&#125;&#123;&quot;author&quot;:&quot;John Michael&quot;,&quot;published&quot;:&quot;2018-07-08&quot;,&quot;title&quot;:&quot;Tesla is flirting with its lowest close in over 1 1/2 years (TSLA)&quot;,&quot;topic&quot;:&quot;automobile&quot;,&quot;views&quot;:&quot;431&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;news&quot;&#125;&#125;&#123;&quot;author&quot;:&quot;John Michael&quot;,&quot;published&quot;:&quot;2018-07-22&quot;,&quot;title&quot;:&quot;Tesla to end up like Lehman Brothers (TSLA)&quot;,&quot;topic&quot;:&quot;automobile&quot;,&quot;views&quot;:&quot;1921&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;news&quot;&#125;&#125;&#123;&quot;author&quot;:&quot;John Michael&quot;,&quot;published&quot;:&quot;2018-07-29&quot;,&quot;title&quot;:&quot;Tesla (TSLA) official says that they are going to release a new self-driving car model in the coming year&quot;,&quot;topic&quot;:&quot;automobile&quot;,&quot;views&quot;:&quot;1849&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;news&quot;&#125;&#125;&#123;&quot;author&quot;:&quot;John Michael&quot;,&quot;published&quot;:&quot;2018-08-14&quot;,&quot;title&quot;:&quot;Five ways Tesla uses AI and Big Data&quot;,&quot;topic&quot;:&quot;ai&quot;,&quot;views&quot;:&quot;871&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;news&quot;&#125;&#125;&#123;&quot;author&quot;:&quot;John Michael&quot;,&quot;published&quot;:&quot;2018-08-14&quot;,&quot;title&quot;:&quot;Toyota partners with Tesla (TSLA) to improve the security of self-driving cars&quot;,&quot;topic&quot;:&quot;automobile&quot;,&quot;views&quot;:&quot;871&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;news&quot;&#125;&#125;&#123;&quot;author&quot;:&quot;Robert Cann&quot;,&quot;published&quot;:&quot;2018-08-25&quot;,&quot;title&quot;:&quot;Is AI dangerous for humanity&quot;,&quot;topic&quot;:&quot;ai&quot;,&quot;views&quot;:&quot;981&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;news&quot;&#125;&#125;&#123;&quot;author&quot;:&quot;Robert Cann&quot;,&quot;published&quot;:&quot;2018-09-13&quot;,&quot;title&quot;:&quot;Is AI dangerous for humanity&quot;,&quot;topic&quot;:&quot;ai&quot;,&quot;views&quot;:&quot;871&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;news&quot;&#125;&#125;&#123;&quot;author&quot;:&quot;Robert Cann&quot;,&quot;published&quot;:&quot;2018-09-27&quot;,&quot;title&quot;:&quot;Introduction to Generative Adversarial Networks (GANs) in self-driving cars&quot;,&quot;topic&quot;:&quot;automobile&quot;,&quot;views&quot;:&quot;1183&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;news&quot;&#125;&#125;&#123;&quot;author&quot;:&quot;Robert Cann&quot;,&quot;published&quot;:&quot;2018-10-09&quot;,&quot;title&quot;:&quot;Introduction to Natural Language Processing&quot;,&quot;topic&quot;:&quot;ai&quot;,&quot;views&quot;:&quot;786&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;news&quot;&#125;&#125;&#123;&quot;author&quot;:&quot;Robert Cann&quot;,&quot;published&quot;:&quot;2018-10-15&quot;,&quot;title&quot;:&quot;New Distant Objects Found in the Fight for Planet X &quot;,&quot;topic&quot;:&quot;astronomy&quot;,&quot;views&quot;:&quot;542&quot;&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å…±åŒæ’å…¥äº†20æ¡æ•°æ®ã€‚Significant Terms Aggregationæ­£å¦‚æˆ‘ä»¬å·²ç»æåˆ°çš„ï¼Œé‡è¦çš„æœ¯è¯­èšåˆå¯ä»¥è¯†åˆ«æ•°æ®ä¸­å¼‚å¸¸å’Œæœ‰è¶£çš„æœ¯è¯­ã€‚ å¯¹äºŽä»¥ä¸‹ç”¨ä¾‹ï¼ŒèšåˆåŠŸèƒ½éžå¸¸å¼ºå¤§ï¼šè¯†åˆ«ä¸Žç”¨æˆ·æŸ¥è¯¢ç›¸å…³çš„ç›¸å…³æœ¯è¯­/æ–‡æ¡£ã€‚ ä¾‹å¦‚ï¼Œå½“ç”¨æˆ·æŸ¥è¯¢â€œSpainâ€æ—¶ï¼Œèšåˆå¯èƒ½ä¼šå»ºè®®è¯¸å¦‚â€œMadridâ€ï¼Œâ€œCorridaâ€ä¹‹ç±»çš„æœ¯è¯­ï¼Œæˆ–æœ‰å…³Spainçš„æ–‡æ¡£ä¸­å¸¸è§çš„å…¶ä»–ä»»ä½•æœ¯è¯­ã€‚Significant termèšåˆå¯ç”¨äºŽè‡ªåŠ¨æ–°é—»åˆ†ç±»å™¨ï¼Œå…¶ä¸­åŸºäºŽé¢‘ç¹è¿žæŽ¥çš„æœ¯è¯­å›¾å¯¹æ–‡æ¡£è¿›è¡Œåˆ†ç±»ã€‚å‘çŽ°æ•°æ®ä¸­çš„å¼‚å¸¸ã€‚ ä¾‹å¦‚ï¼Œå€ŸåŠ©è¿™ç§æ±‡æ€»ï¼Œæˆ‘ä»¬å¯ä»¥è¯†åˆ«æŸäº›åœ°ç†åŒºåŸŸä¸­çš„å¼‚å¸¸çŠ¯ç½ªç±»åž‹æˆ–ç–¾ç—…ã€‚é‡è¦çš„æ˜¯è¦ç†è§£ï¼Œsignificant termsèšåˆé€‰æ‹©çš„æœ¯è¯­ä¸ä»…æ˜¯æ–‡æ¡£é›†ä¸­æœ€å—æ¬¢è¿Žçš„æœ¯è¯­ã€‚ ä¾‹å¦‚ï¼Œå³ä½¿é¦–å­—æ¯ç¼©ç•¥è¯â€œ MSFTâ€ä»…å­˜åœ¨äºŽä¸€åƒä¸‡ä¸ªæ–‡æ¡£ç´¢å¼•ä¸­çš„10ä¸ªæ–‡æ¡£ä¸­ï¼Œä½†å¦‚æžœåœ¨ä¸Žç”¨æˆ·æŸ¥è¯¢â€œ Microsoftâ€ç›¸åŒ¹é…çš„50ä¸ªæ–‡æ¡£ä¸­æœ‰10ä¸ªæ‰¾åˆ°äº†è¿™ä¸ªMSFTï¼Œåˆ™å®ƒä»ç„¶æ˜¯ç›¸å…³çš„ã€‚ è¯¥é¢‘çŽ‡ä½¿acronymï¼ˆæ¯”å¦‚MSFTï¼‰ä¸Žç”¨æˆ·çš„æœç´¢ç›¸å…³ã€‚ä¸ºäº†è¯†åˆ«é‡è¦æœ¯è¯­ï¼Œèšåˆå¯¹ä¸ŽæŸ¥è¯¢åŒ¹é…çš„æœç´¢ç»“æžœä»¥åŠä»Žä¸­æ”¶é›†ç»“æžœçš„ç´¢å¼•æ‰§è¡Œå¤æ‚çš„ç»Ÿè®¡åˆ†æžã€‚ ä¸ŽæŸ¥è¯¢ç›´æŽ¥åŒ¹é…çš„æœç´¢ç»“æžœä»£è¡¨å‰æ™¯é›†ï¼Œè€Œä»Žä¸­æ£€ç´¢å®ƒä»¬çš„ç´¢å¼•ä»£è¡¨èƒŒæ™¯é›†ã€‚ é‡è¦æœ¯è¯­èšåˆçš„ä»»åŠ¡æ˜¯æ¯”è¾ƒè¿™äº›é›†åˆå¹¶æ‰¾åˆ°æœ€å¸¸ä¸Žç”¨æˆ·æŸ¥è¯¢å…³è”çš„æœ¯è¯­ã€‚ä¸Šé¢çš„æ„æ€å¯ä»¥ç”¨ä¸Šé¢çš„ä¸€å¹…å›¾æ¥è§£é‡Šã€‚æ¯”å¦‚ä¸Šé¢çš„ç»¿è‰²ä»£è¡¨ä¸€ä¸ªå¾ˆå¤§çš„ç´¢å¼•ï¼Œå®ƒé‡Œé¢å¯èƒ½å«æœ‰æ¯”å¦‚Nokiaè¿™ä¸ªtermå¾ˆé«˜çš„å‡ºçŽ°çŽ‡ã€‚å³ä¾¿å¦‚æ­¤ï¼Œåªè¦æˆ‘ä»¬æ‰€æœç´¢çš„FGé‚£ä¸ªçº¢è‰²çš„ç»“æžœé‡Œï¼Œå®ƒå‡ºçŽ°çš„å‡ çŽ‡éžå¸¸ä½Žï¼Œä¹Ÿä¸èƒ½å¤Ÿå‡ºçŽ°åœ¨significant termsçš„èšåˆé‡Œã€‚ç›¸åï¼Œå¦‚æžœä¸€ä¸ªtermæ¯”å¦‚TECNOï¼ˆä¸­å›½ä¸€ä¸ªéžå¸¸å‡ºåçš„åœ¨éžæ´²çš„å“ç‰Œï¼‰å‡ºçŽ°æˆ‘ä»¬æ‰€æœç´¢çš„seté‡Œï¼ˆæ¯”å¦‚æœç´¢ africa phoneï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœç´¢çš„èšåˆå°†ä¼šæ˜¯æ˜¯TECNOå°½ç®¡TECNOå¯èƒ½åœ¨æ•´ä¸ªBGæ‰€åŒ…å«çš„æ–‡æ¡£é‡Œå‡ºçŽ°çš„å‡ çŽ‡éžå¸¸ä¹‹ä½Žã€‚è®©æˆ‘ä»¬ä½¿ç”¨çœŸå®žç¤ºä¾‹ï¼Œæ¼”ç¤ºèšåˆå¦‚ä½•å·¥ä½œã€‚ åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†å°è¯•åœ¨ç´¢å¼•ä¸­æŸ¥æ‰¾æ¯ä¸ªauthorçš„é‡è¦topicsã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆåœ¨authorå­—æ®µä¸Šä½¿ç”¨æœ¯è¯­â€œæ¡¶èšåˆ(bucket aggregation)â€ã€‚ æ‚¨è¿˜è®°å¾—ï¼Œterms aggregationä¸ºæ‰¾åˆ°ç´¢å¼•çš„æ‰€æœ‰å”¯ä¸€æœ¯è¯­ï¼ˆå³authorï¼‰æž„é€ äº†å­˜å‚¨æ¡¶ã€‚ æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åœ¨â€œtopicsâ€å­—æ®µä¸Šä½¿ç”¨significant termsèšåˆï¼Œä»¥æ‰¾å‡ºæ¯ä¸ªauthorçš„æœ€é‡è¦topicã€‚ çœ‹ä¸€ä¸‹ä¸‹é¢çš„æŸ¥è¯¢ï¼š123456789101112131415161718GET news/_search&#123; &quot;size&quot;: 0, &quot;aggregations&quot;: &#123; &quot;authors&quot;: &#123; &quot;terms&quot;: &#123; &quot;field&quot;: &quot;author&quot; &#125;, &quot;aggregations&quot;: &#123; &quot;significant_topic_types&quot;: &#123; &quot;significant_terms&quot;: &#123; &quot;field&quot;: &quot;topic&quot; &#125; &#125; &#125; &#125; &#125;&#125;æ˜¾ç¤ºçš„ç»“æžœä¸ºï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758&#123; &quot;took&quot; : 1, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 20, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : null, &quot;hits&quot; : [ ] &#125;, &quot;aggregations&quot; : &#123; &quot;authors&quot; : &#123; &quot;doc_count_error_upper_bound&quot; : 0, &quot;sum_other_doc_count&quot; : 0, &quot;buckets&quot; : [ &#123; &quot;key&quot; : &quot;John Michael&quot;, &quot;doc_count&quot; : 10, &quot;significant_topic_types&quot; : &#123; &quot;doc_count&quot; : 10, &quot;bg_count&quot; : 20, &quot;buckets&quot; : [ &#123; &quot;key&quot; : &quot;automobile&quot;, &quot;doc_count&quot; : 8, &quot;score&quot; : 0.4800000000000001, &quot;bg_count&quot; : 10 &#125; ] &#125; &#125;, &#123; &quot;key&quot; : &quot;Robert Cann&quot;, &quot;doc_count&quot; : 10, &quot;significant_topic_types&quot; : &#123; &quot;doc_count&quot; : 10, &quot;bg_count&quot; : 20, &quot;buckets&quot; : [ &#123; &quot;key&quot; : &quot;ai&quot;, &quot;doc_count&quot; : 6, &quot;score&quot; : 0.2999999999999999, &quot;bg_count&quot; : 8 &#125; ] &#125; &#125; ] &#125; &#125;&#125;æ˜¾ç„¶å¯¹äºŽä½œè€…John Michaelæ¥è¯´ï¼Œåœ¨ä»–æ‰€å‘è¡¨çš„ä¹¦é‡Œautomobileæ˜¯æœ€ç»å¸¸å‡ºçŽ°çš„è¯ã€‚å…±æœ‰8æ¬¡ï¼Œè€Œbg_countæ˜¯10ã€‚åŒæ ·å¯¹äºŽä½œè€…Robert Cannæ¥è¯´ï¼Œåœ¨ä»–å‘å¸ƒçš„ä½œå“é‡Œï¼Œaiæ˜¯æœ€æœ€ç»å¸¸å‡ºçŽ°çš„è¯ï¼Œåœ¨ä»–çš„8ä¸ªä½œå“ä¸­ï¼Œæœ‰6è¯æåˆ°aiã€‚å¯ä»¥æ–­å®šä»–å°±æ˜¯ä¸€ä¸ªaiä¸“å®¶ï¼é’ˆå¯¹ä¸Šé¢çš„significant termsèšåˆæŸ¥è¯¢ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹æ³•æ¥æŸ¥è¯¢é’ˆå¯¹æŸä¸ªä½œè€…ï¼ˆauthorï¼‰çš„èšåˆã€‚12345678910111213141516GET news/_search&#123; &quot;size&quot;: 0, &quot;query&quot;: &#123; &quot;term&quot;: &#123; &quot;author&quot;: &quot;John Michael&quot; &#125; &#125;, &quot;aggregations&quot;: &#123; &quot;significant_topics&quot;: &#123; &quot;significant_terms&quot;: &#123; &quot;field&quot;: &quot;topic&quot; &#125; &#125; &#125;&#125;æ˜¾ç¤ºçš„ç»“æžœä¸ºï¼š1234567891011121314151617181920212223242526272829303132&#123; &quot;took&quot; : 0, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 10, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : null, &quot;hits&quot; : [ ] &#125;, &quot;aggregations&quot; : &#123; &quot;significant_topics&quot; : &#123; &quot;doc_count&quot; : 10, &quot;bg_count&quot; : 20, &quot;buckets&quot; : [ &#123; &quot;key&quot; : &quot;automobile&quot;, &quot;doc_count&quot; : 8, &quot;score&quot; : 0.4800000000000001, &quot;bg_count&quot; : 10 &#125; ] &#125; &#125;&#125;è¿™ç§è¡¨è¿°æ›´é€‚åˆè§£é‡Šæˆ‘ä»¬ä¸Šé¢çš„é‚£ä¸ªBGå’ŒFGçš„å›¾ã€‚é’ˆå¯¹significant text aggregationï¼ŒåŸºæœ¬å®ƒå’Œsignificant terms aggregationéžå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯å®ƒä½œç”¨äºŽä¸€ä¸ªtextå­—æ®µè€Œä¸æ˜¯ä¸€ä¸ªkeywordå­—æ®µã€‚æ¯”å¦‚:12345678910111213141516GET news/_search&#123; &quot;size&quot;: 0, &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;title&quot;: &quot;Tesla ai&quot; &#125; &#125;, &quot;aggregations&quot;: &#123; &quot;significant_topics&quot;: &#123; &quot;significant_text&quot;: &#123; &quot;field&quot;: &quot;topic&quot; &#125; &#125; &#125;&#125;æ³¨æ„è¿™é‡Œçš„titleå­—æ®µæ˜¯textï¼Œå®ƒåŒæ—¶æœç´¢TelsaåŠaiï¼Œå†æ ¹æ®è¿™ä¸¤ä¸ªè¯æ¥è¿›è¡Œèšåˆï¼š1234567891011121314151617181920212223242526272829303132333435363738&#123; &quot;took&quot; : 1, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 14, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : null, &quot;hits&quot; : [ ] &#125;, &quot;aggregations&quot; : &#123; &quot;significant_topics&quot; : &#123; &quot;doc_count&quot; : 14, &quot;bg_count&quot; : 20, &quot;buckets&quot; : [ &#123; &quot;key&quot; : &quot;automobile&quot;, &quot;doc_count&quot; : 8, &quot;score&quot; : 0.08163265306122446, &quot;bg_count&quot; : 10 &#125;, &#123; &quot;key&quot; : &quot;ai&quot;, &quot;doc_count&quot; : 6, &quot;score&quot; : 0.030612244897959134, &quot;bg_count&quot; : 8 &#125; ] &#125; &#125;&#125;å‚è€ƒï¼šã€1ã€‘significant terms aggregation(https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations-bucket-significantterms-aggregation.html)ã€2ã€‘significant text aggregation(https://www.elastic.co/guide/en/elasticsearch/reference/master/search-aggregations-bucket-significanttext-aggregation.html)]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearchï¼šsearch template]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%EF%BC%9Asearch%20template%2F</url>
    <content type="text"><![CDATA[æˆ‘ä»¬å‘çŽ°ä¸€äº›ç”¨æˆ·ç»å¸¸ç¼–å†™äº†ä¸€äº›éžå¸¸å†—é•¿å’Œå¤æ‚çš„æŸ¥è¯¢ - åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œç›¸åŒçš„æŸ¥è¯¢ä¼šä¸€éåˆä¸€éåœ°æ‰§è¡Œï¼Œä½†æ˜¯ä¼šæœ‰ä¸€äº›ä¸åŒçš„å€¼ä½œä¸ºå‚æ•°æ¥æŸ¥è¯¢ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è§‰å¾—ä½¿ç”¨ä¸€ä¸ªsearch templateï¼ˆæœç´¢æ¨¡æ¿ï¼‰æ¥åšè¿™æ ·çš„å·¥ä½œéžå¸¸åˆé€‚ã€‚æœç´¢æ¨¡æ¿å…è®¸æ‚¨ä½¿ç”¨å¯åœ¨æ‰§è¡Œæ—¶å®šä¹‰çš„å‚æ•°å®šä¹‰æŸ¥è¯¢ã€‚Search templateçš„å¥½å¤„æ˜¯ï¼šé¿å…åœ¨å¤šä¸ªåœ°æ–¹é‡å¤ä»£ç æ›´å®¹æ˜“æµ‹è¯•å’Œæ‰§è¡Œæ‚¨çš„æŸ¥è¯¢åœ¨åº”ç”¨ç¨‹åºé—´å…±äº«æŸ¥è¯¢å…è®¸ç”¨æˆ·åªæ‰§è¡Œä¸€äº›é¢„å®šä¹‰çš„æŸ¥è¯¢å°†æœç´¢é€»è¾‘ä¸Žåº”ç”¨ç¨‹åºé€»è¾‘åˆ†ç¦»å®šä¹‰ä¸€ä¸ªSearch templateé¦–å…ˆï¼Œæˆ‘ä»¬æ¥å®šä¹‰ä¸€ä¸ªsearch templateæ¥çœ‹çœ‹å®ƒåˆ°åº•æ˜¯ä»€ä¹ˆä¸œè¥¿ã€‚ä½¿ç”¨_scriptsç«¯ç‚¹å°†æ¨¡æ¿å­˜å‚¨åœ¨é›†ç¾¤çŠ¶æ€ä¸­ã€‚åœ¨search templateä¸­ä½¿ç”¨çš„è¯­è¨€å«åšmustacheã€‚(http://mustache.github.io/mustache.5.html)12345678910111213POST _scripts/my_search_template&#123; &quot;script&quot;: &#123; &quot;lang&quot;: &quot;mustache&quot;, &quot;source&quot;: &#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;&#123;&#123;my_field&#125;&#125;&quot;: &quot;&#123;&#123;my_value&#125;&#125;&quot; &#125; &#125; &#125; &#125;&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå«åšmy_search_templateçš„search templateã€‚å¦‚æžœæˆ‘ä»¬æƒ³æ›´æ–°è¿™ä¸ªsearch templateï¼Œæˆ‘ä»¬å¯ä»¥ç›´æŽ¥è¿›è¡Œä¿®æ”¹ï¼Œç„¶åŽå†æ¬¡è¿è¡Œä¸Šé¢çš„å‘½ä»¤å³å¯ã€‚åœ¨matchçš„å­—æ®µé‡Œï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªå‚æ•°ï¼šmy_fieldåŠmy_valueã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥é¦–å…ˆå»ºç«‹ä¸€ä¸ªå«åštwitterçš„æ•°æ®åº“ï¼š12345678910111213141516171819202122232425262728293031PUT twitter/_doc/1&#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125;&#125; PUT twitter/_doc/2&#123; &quot;user&quot; : &quot;è™¹æ¡¥-è€å´&quot;, &quot;message&quot; : &quot;å¥½å‹æ¥äº†éƒ½ä»Šå¤©æˆ‘ç”Ÿæ—¥ï¼Œå¥½å‹æ¥äº†,ä»€ä¹ˆ birthday happy å°±æˆ!&quot;, &quot;uid&quot; : 7, &quot;age&quot; : 90, &quot;city&quot; : &quot;ä¸Šæµ·&quot;, &quot;province&quot; : &quot;ä¸Šæµ·&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½ä¸Šæµ·å¸‚é—µè¡ŒåŒº&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;31.175927&quot;, &quot;lon&quot; : &quot;121.383328&quot; &#125;&#125;æˆ‘ä»¬è¿™é‡ŒæŠŠä¸Šé¢çš„ä¸¤ä¸ªæ–‡æ¡£å­˜äºŽåˆ°twitterçš„indexä¹‹ä¸­ã€‚æˆ‘ä»¬çŽ°åœ¨å¯ä»¥ä½¿ç”¨æˆ‘ä»¬åˆšæ‰å®šä¹‰çš„search templateæ¥è¿›è¡Œæœç´¢ï¼š12345678GET twitter/_search/template&#123; &quot;id&quot;: &quot;my_search_template&quot;, &quot;params&quot;: &#123; &quot;my_field&quot;: &quot;city&quot;, &quot;my_value&quot;: &quot;åŒ—äº¬&quot; &#125;&#125;æ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š123456789101112131415161718192021222324252627282930313233343536373839&#123; &quot;took&quot; : 1, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 1, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 0.9808292, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 0.9808292, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125; &#125; &#125; ] &#125;&#125;æ˜¾ç¤ºå®ƒåªæ˜¾ç¤ºäº†æˆ‘ä»¬çš„cityä¸ºåŒ—äº¬çš„ä¸€ä¸ªæ–‡æ¡£ï¼Œå¦å¤–ä¸€ä¸ªä¸Šæµ·çš„æ–‡æ¡£æ²¡æœ‰åšä»»ä½•çš„æ˜¾ç¤ºã€‚è¯´æ˜Žæˆ‘ä»¬å®šä¹‰çš„search templateæ˜¯å·¥ä½œçš„ã€‚æ¡ä»¶åˆ¤æ–­åœ¨Mustacheè¯­è¨€ä¸­ï¼Œå®ƒæ²¡æœ‰if/elseè¿™æ ·çš„åˆ¤æ–­ï¼Œä½†æ˜¯ä½ å¯ä»¥å®šsectionæ¥è·³è¿‡å®ƒå¦‚æžœé‚£ä¸ªå˜é‡æ˜¯falseè¿˜æ˜¯æ²¡æœ‰è¢«å®šä¹‰ï¼š123&#123;&#123;#param1&#125;&#125; &quot;This section is skipped if param1 is null or false&quot;&#123;&#123;/param1&#125;&#125;æˆ‘ä»¬å®šä¹‰å¦‚ä¸‹çš„ä¸€ä¸ªsearch template:1234567891011121314151617181920212223242526272829303132POST _scripts/docs_from_beijing_and_age&#123; &quot;script&quot;: &#123; &quot;lang&quot;: &quot;mustache&quot;, &quot;source&quot;: &quot;&quot;&quot; &#123; &quot;query&quot;: &#123; &quot;bool&quot;: &#123; &quot;must&quot;: [ &#123; &quot;match&quot;: &#123; &quot;city&quot;: &quot;&#123;&#123;search_term&#125;&#125;&quot; &#125; &#125; &#123;&#123;#search_age&#125;&#125; , &#123; &quot;range&quot;: &#123; &quot;age&quot;: &#123; &quot;gte&quot;: &#123;&#123;search_age&#125;&#125; &#125; &#125; &#125; &#123;&#123;/search_age&#125;&#125; ] &#125; &#125; &#125;&quot;&quot;&quot; &#125;&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åŒæ—¶å®šä¹‰äº†ä¸¤ä¸ªå˜é‡ï¼šsearch_termåŠsearch_ageã€‚é’ˆå¯¹search_ageï¼Œæˆ‘ä»¬åšäº†ä¸€ä¸ªåˆ¤æ–­ï¼Œå¦‚æžœå®ƒæœ‰å®šä¹‰ï¼ŒåŠåšä¸€ä¸ªrangeçš„æŸ¥è¯¢ã€‚å¦‚æžœæ²¡æœ‰å®šä¹‰ï¼Œå°±åªç”¨search_termã€‚é‚£ä¹ˆæˆ‘ä»¬æ¥åšå¦‚ä¸‹çš„å®žéªŒï¼š1234567GET twitter/_search/template&#123; &quot;id&quot;: &quot;docs_from_beijing_and_age&quot;, &quot;params&quot;: &#123; &quot;search_term&quot;: &quot;åŒ—äº¬&quot; &#125;&#125;æ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š123456789101112131415161718192021222324252627282930313233343536373839&#123; &quot;took&quot; : 0, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 1, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 0.9808292, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 0.9808292, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125; &#125; &#125; ] &#125;&#125;æ˜¾ç„¶ï¼Œcityä¸ºåŒ—äº¬çš„æ–‡æ¡£å·²ç»è¢«æœç´¢åˆ°äº†ã€‚å¦‚æžœæˆ‘ä»¬åšå¦‚ä¸‹çš„æŸ¥è¯¢ï¼š12345678GET twitter/_search/template&#123; &quot;id&quot;: &quot;docs_from_beijing_and_age&quot;, &quot;params&quot;: &#123; &quot;search_term&quot;: &quot;åŒ—äº¬&quot;, &quot;search_age&quot;: &quot;30&quot; &#125;&#125;æˆ‘ä»¬å°†æœç´¢ä¸åˆ°ä»»ä½•çš„ç»“æžœï¼Œè¿™æ˜¯å› ä¸ºåœ¨è¿™æ¬¡æŸ¥è¯¢ä¸­search_ageå·²ç»è¢«å¯ç”¨ï¼Œè€Œä¸”åœ¨æ•°æ®åº“ä¸­æ²¡æœ‰ä¸€ä¸ªæ–‡æ¡£æ˜¯æ¥è‡ªâ€œåŒ—äº¬â€ï¼Œå¹¶ä¸”å¹´é¾„å¤§äºŽ30çš„ã€‚æˆ‘ä»¬å¯ä»¥åšå¦‚ä¸‹çš„æŸ¥è¯¢ï¼š12345678GET twitter/_search/template&#123; &quot;id&quot;: &quot;docs_from_beijing_and_age&quot;, &quot;params&quot;: &#123; &quot;search_term&quot;: &quot;åŒ—äº¬&quot;, &quot;search_age&quot;: &quot;20&quot; &#125;&#125;é‚£ä¹ˆè¿™æ¬¡çš„æ˜¾ç¤ºç»“æžœä¸ºï¼š123456789101112131415161718192021222324252627282930313233343536373839&#123; &quot;took&quot; : 0, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 1, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 1.9808292, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 1.9808292, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125; &#125; &#125; ] &#125;&#125;æ˜¾ç„¶è¿™æ¬¡æˆ‘ä»¬æœç´¢åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æžœã€‚æŸ¥è¯¢search template1GET _scripts/&lt;templateid&gt;é’ˆå¯¹æˆ‘ä»¬çš„æƒ…å†µï¼š1GET _scripts/docs_from_beijing_and_ageæ˜¾ç¤ºçš„ç»“æžœä¸ºï¼š1234567891011121314151617181920212223242526272829303132&#123; &quot;_id&quot; : &quot;docs_from_beijing_and_age&quot;, &quot;found&quot; : true, &quot;script&quot; : &#123; &quot;lang&quot; : &quot;mustache&quot;, &quot;source&quot; : &quot;&quot;&quot; &#123; &quot;query&quot;: &#123; &quot;bool&quot;: &#123; &quot;must&quot;: [ &#123; &quot;match&quot;: &#123; &quot;city&quot;: &quot;&#123;&#123;search_term&#125;&#125;&quot; &#125; &#125; &#123;&#123;#search_age&#125;&#125; , &#123; &quot;range&quot;: &#123; &quot;age&quot;: &#123; &quot;gte&quot;: &#123;&#123;search_age&#125;&#125; &#125; &#125; &#125; &#123;&#123;/search_age&#125;&#125; ] &#125; &#125; &#125;&quot;&quot;&quot; &#125;&#125;è¿™ä¸ªæ­£æ˜¯æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„ä¸€ä¸ªsearch templateã€‚åˆ é™¤ä¸€ä¸ªsearch templateæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥åˆ é™¤ä¸€ä¸ªå·²ç»åˆ›å»ºçš„search template:1DELETE _scripts/&lt;templateid&gt;éªŒè¯search templateæˆ‘ä»¬å¯ä»¥é€šè¿‡_renderç«¯ç‚¹æ¥éªŒè¯æˆ‘ä»¬çš„search templateã€‚æ¯”å¦‚ï¼š1234567891011121314151617181920212223242526272829303132GET _render/template&#123; &quot;source&quot;: &quot;&quot;&quot; &#123; &quot;query&quot;: &#123; &quot;bool&quot;: &#123; &quot;must&quot;: [ &#123; &quot;match&quot;: &#123; &quot;city&quot;: &quot;&#123;&#123;search_term&#125;&#125;&quot; &#125; &#125; &#123;&#123;#search_age&#125;&#125; , &#123; &quot;range&quot;: &#123; &quot;age&quot;: &#123; &quot;gte&quot;: &#123;&#123;search_age&#125;&#125; &#125; &#125; &#125; &#123;&#123;/search_age&#125;&#125; ] &#125; &#125; &#125;&quot;&quot;&quot;, &quot;params&quot;: &#123; &quot;search_term&quot;: &quot;åŒ—äº¬&quot;, &quot;search_age&quot;: &quot;20&quot; &#125;&#125;é‚£ä¹ˆæ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š12345678910111213141516171819202122&#123; &quot;template_output&quot; : &#123; &quot;query&quot; : &#123; &quot;bool&quot; : &#123; &quot;must&quot; : [ &#123; &quot;match&quot; : &#123; &quot;city&quot; : &quot;åŒ—äº¬&quot; &#125; &#125;, &#123; &quot;range&quot; : &#123; &quot;age&quot; : &#123; &quot;gte&quot; : 20 &#125; &#125; &#125; ] &#125; &#125; &#125;&#125;æ˜¾ç„¶ï¼Œè¿™ä¸ªå°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æžœã€‚å‚è€ƒï¼šã€1ã€‘https://www.elastic.co/guide/en/elasticsearch/reference/7.4/search-template.html]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearchï¼šPinyin åˆ†è¯å™¨]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%EF%BC%9APinyin%20%E5%88%86%E8%AF%8D%E5%99%A8%2F</url>
    <content type="text"><![CDATA[Elasticçš„Medclæä¾›äº†ä¸€ç§æœç´¢Pinyinæœç´¢çš„æ–¹æ³•ã€‚æ‹¼éŸ³æœç´¢åœ¨å¾ˆå¤šçš„åº”ç”¨åœºæ™¯ä¸­éƒ½æœ‰è¢«ç”¨åˆ°ã€‚æ¯”å¦‚åœ¨ç™¾åº¦æœç´¢ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨æ‹¼éŸ³å°±å¯ä»¥å‡ºçŽ°æ±‰å­—ï¼šå¯¹äºŽæˆ‘ä»¬ä¸­å›½äººæ¥è¯´ï¼Œæ‹¼éŸ³æœç´¢ä¹Ÿæ˜¯éžå¸¸ç›´æŽ¥çš„ã€‚é‚£ä¹ˆåœ¨Elasticsearchä¸­æˆ‘ä»¬è¯¥å¦‚ä½•ä½¿ç”¨pinyinæ¥è¿›è¡Œæœç´¢å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æˆ‘ä»¬é‡‡ç”¨Medclæ‰€åˆ›å»ºçš„elasticsearch-analysis-pinyinåˆ†æžå™¨ã€‚ä¸‹é¢æˆ‘ä»¬ç®€å•ä»‹ç»ä¸€ä¸‹å¦‚ä½•è¿›è¡Œå®‰è£…å’Œæµ‹è¯•ã€‚ä¸‹è½½Pinyinåˆ†æžå™¨æºç è¿›è¡Œç¼–è¯‘åŠå®‰è£…ç”±äºŽelasticsearch-analysis-pinyinç›®å‰æ²¡æœ‰å¯ä»¥ä¸‹è½½çš„å¯ä»¥å®‰è£…çš„å‘å¸ƒæ–‡ä»¶ï¼Œæˆ‘ä»¬å¿…é¡»è‡ªå·±ä¸‹è½½æºç ï¼Œå¹¶ç¼–è¯‘ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½åæ¥è¿›è¡Œä¸‹è½½ï¼š1$ git clone https://github.com/medcl/elasticsearch-analysis-pinyinä¸‹è½½æºç åŽï¼Œè¿›å…¥åˆ°é¡¹ç›®çš„æ ¹ç›®å½•ã€‚æ•´ä¸ªé¡¹ç›®çš„æºç æ˜¾ç¤ºä¸ºï¼š12345678910$ tree -L 2.â”œâ”€â”€ LICENSE.txtâ”œâ”€â”€ README.mdâ”œâ”€â”€ libâ”‚ â””â”€â”€ nlp-lang-1.7.jarâ”œâ”€â”€ pom.xmlâ””â”€â”€ src â”œâ”€â”€ main â””â”€â”€ testè¿™æ ·åœ¨æˆ‘ä»¬çš„ç”µè„‘é‡Œå°±ä¼šå‘çŽ°ä¸‹è½½å¥½çš„elasticsearch-analysis-pinyinæºç ã€‚åœ¨è¿›è¡Œç¼–è¯‘ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»ä¿®æ”¹ä¸€ä¸‹æˆ‘ä»¬çš„ç‰ˆæœ¬å·ä»¥ä¾¿å’Œæˆ‘ä»¬çš„Elasticsearchçš„ç‰ˆæœ¬å·æ˜¯ä¸€è‡´çš„ã€‚å¦åˆ™æˆ‘ä»¬çš„pluginå°†ä¸ä¼šè¢«æ­£ç¡®è£…è½½ã€‚æˆ‘ä»¬å·²çŸ¥æˆ‘ä»¬çš„Elasticsearchç‰ˆæœ¬å·ç æ˜¯7.3.0ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¿®æ”¹æˆ‘ä»¬çš„pom.xmlæ–‡ä»¶ï¼šåœ¨æˆ‘ä»¬çš„ç”µè„‘ä¸Šå¿…é¡»å®‰è£…å¥½Mavenã€‚ç„¶åŽè¿›å…¥é¡¹ç›®çš„æ ¹ç›®å½•ï¼Œå¹¶åœ¨å‘½ä»¤è¡Œä¸­æ‰“å…¥å¦‚ä¸‹çš„å‘½ä»¤ï¼š1$ mvn installè¿™æ ·æ•´ä¸ªé¡¹ç›®çš„ç¼–è¯‘å·¥ä½œå°±å®Œæˆäº†ã€‚æˆ‘ä»¬åœ¨å‘½ä»¤è¡Œä¸­æ‰“å…¥å¦‚ä¸‹çš„å‘½ä»¤ï¼š12$ find ./ -name &quot;*.zip&quot;.//target/releases/elasticsearch-analysis-pinyin-7.3.0.zipå®ƒæ˜¾ç¤ºåœ¨tagertç›®å½•ä¸‹å·²ç»ç”Ÿäº§äº†ä¸€ä¸ªå«åšelasticsearch-analysis-pinyin-7.3.0.zipçš„åŽ‹ç¼©æ–‡ä»¶ã€‚è¿™ä¸ªç‰ˆæœ¬å·ç åˆšå¥½å’Œæˆ‘ä»¬çš„Elasticsearchçš„ç‰ˆæœ¬æ˜¯ä¸€æ ·çš„ã€‚æˆ‘ä»¬åˆ°Elasticsearchçš„å®‰è£…ç›®å½•ä¸‹çš„pluginç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªå«åšpinyinçš„å­ç›®å½•ï¼š123/Users/liuxg/elastic/elasticsearch-7.3.0/pluginslocalhost:plugins liuxg$ ls analysis-ik pinyinç„¶åŽï¼ŒæŠŠæˆ‘ä»¬åˆšæ‰åœ¨ä¸Šä¸€æ­¥ç”Ÿäº§çš„elasticsearch-analysis-pinyin-7.0.0.zipæ–‡ä»¶è¿›è¡Œè§£åŽ‹ï¼Œå¹¶æŠŠæ–‡ä»¶æ”¾å…¥åˆ°æˆ‘ä»¬åˆšæ‰åˆ›å»ºçš„pinyinç›®å½•ä¸‹ã€‚è¿™æ ·æ•´ä¸ªpinyinæ–‡ä»¶å¤¹çš„æ–‡ä»¶æ˜¾ç¤ºå¦‚ä¸‹ï¼š1234567$ lsanalysis-ik pinyinlocalhost:plugins liuxg$ tree pinyin/ -L 3pinyin/â”œâ”€â”€ elasticsearch-analysis-pinyin-7.3.0.jarâ”œâ”€â”€ nlp-lang-1.7.jarâ””â”€â”€ plugin-descriptor.propertiesè‡³æ­¤ï¼Œæˆ‘ä»¬çš„å®‰è£…å·¥ä½œå·²ç»å®Œæˆï¼Œæˆ‘éœ€è¦é‡æ–°å¯åŠ¨æˆ‘ä»¬çš„Elasticsearchã€‚æµ‹è¯•Pinyin analyzerä¸‹é¢æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹æˆ‘ä»¬å·²ç»å®‰è£…å¥½çš„Pinyinåˆ†è¯å™¨æ˜¯å¦å·²ç»å·¥ä½œã€‚æˆ‘ä»¬å¯ä»¥ä»¿ç…§https://github.com/medcl/elasticsearch-analysis-pinyinä¸Šé¢çš„ä»‹ç»æ¥åšä¸€äº›ç®€å•çš„æµ‹è¯•ï¼šåˆ›å»ºä¸€ä¸ªå®šåˆ¶çš„pinyinåˆ†è¯å™¨1234567891011121314151617181920212223PUT /medcl/ &#123; &quot;settings&quot; : &#123; &quot;analysis&quot; : &#123; &quot;analyzer&quot; : &#123; &quot;pinyin_analyzer&quot; : &#123; &quot;tokenizer&quot; : &quot;my_pinyin&quot; &#125; &#125;, &quot;tokenizer&quot; : &#123; &quot;my_pinyin&quot; : &#123; &quot;type&quot; : &quot;pinyin&quot;, &quot;keep_separate_first_letter&quot; : false, &quot;keep_full_pinyin&quot; : true, &quot;keep_original&quot; : true, &quot;limit_first_letter_length&quot; : 16, &quot;lowercase&quot; : true, &quot;remove_duplicated_term&quot; : true &#125; &#125; &#125; &#125;&#125;æµ‹è¯•ä¸€äº›ä¸­æ–‡æ±‰å­—12345678910111213141516171819202122232425262728293031323334353637383940414243444546GET /medcl/_analyze&#123; &quot;text&quot;: [&quot;å¤©å®‰é—¨&quot;], &quot;analyzer&quot;: &quot;pinyin_analyzer&quot;&#125;# æ˜¾ç¤ºç»“æžœä¸ºï¼š&#123; &quot;tokens&quot; : [ &#123; &quot;token&quot; : &quot;tian&quot;, &quot;start_offset&quot; : 0, &quot;end_offset&quot; : 0, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 0 &#125;, &#123; &quot;token&quot; : &quot;å¤©å®‰é—¨&quot;, &quot;start_offset&quot; : 0, &quot;end_offset&quot; : 0, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 0 &#125;, &#123; &quot;token&quot; : &quot;tam&quot;, &quot;start_offset&quot; : 0, &quot;end_offset&quot; : 0, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 0 &#125;, &#123; &quot;token&quot; : &quot;an&quot;, &quot;start_offset&quot; : 0, &quot;end_offset&quot; : 0, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 1 &#125;, &#123; &quot;token&quot; : &quot;men&quot;, &quot;start_offset&quot; : 0, &quot;end_offset&quot; : 0, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 2 &#125; ]&#125;ä¸Šé¢çš„tokenæ˜¾ç¤ºï¼Œå¦‚æžœæˆ‘ä»¬æ‰“å…¥æœç´¢tamæ˜¯å®Œå…¨å¯ä»¥æœç´¢åˆ°æˆ‘ä»¬çš„ç»“æžœçš„ã€‚åˆ›å»ºmapping1234567891011121314151617POST /medcl/_mapping&#123; &quot;properties&quot;: &#123; &quot;name&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;fields&quot;: &#123; &quot;pinyin&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;store&quot;: false, &quot;term_vector&quot;: &quot;with_offsets&quot;, &quot;analyzer&quot;: &quot;pinyin_analyzer&quot;, &quot;boost&quot;: 10 &#125; &#125; &#125; &#125;&#125;Indexæ–‡æ¡£12POST /medcl/_create/andy&#123;&quot;name&quot;:&quot;åˆ˜å¾·åŽ&quot;&#125;æœç´¢æ–‡æ¡£12345curl http://localhost:9200/medcl/_search?q=name:%E5%88%98%E5%BE%B7%E5%8D%8Ecurl http://localhost:9200/medcl/_search?q=name.pinyin:%e5%88%98%e5%be%b7curl http://localhost:9200/medcl/_search?q=name.pinyin:liucurl http://localhost:9200/medcl/_search?q=name.pinyin:ldhcurl http://localhost:9200/medcl/_search?q=name.pinyin:de+huaæˆ–è€…ï¼š12345GET medcl/_search?q=name:%E5%88%98%E5%BE%B7%E5%8D%8EGET medcl/_search?q=name.pinyin:%e5%88%98%e5%be%b7GET medcl/_search?q=name.pinyin:liuGET medcl/_search?q=name.pinyin:ldhGET medcl/_search?q=name.pinyin:de+huaä¸Šé¢çš„ç¬¬ä¸€ä¸ªUnicodeæ˜¯â€œåˆ˜å¾·åŽâ€ï¼Œç¬¬äºŒä¸ªæ˜¯â€œåˆ˜å¾·â€ã€‚ä½¿ç”¨pinyin-tokenFilter1234567891011121314151617181920212223242526PUT /medcl1/ &#123; &quot;settings&quot; : &#123; &quot;analysis&quot; : &#123; &quot;analyzer&quot; : &#123; &quot;user_name_analyzer&quot; : &#123; &quot;tokenizer&quot; : &quot;whitespace&quot;, &quot;filter&quot; : &quot;pinyin_first_letter_and_full_pinyin_filter&quot; &#125; &#125;, &quot;filter&quot; : &#123; &quot;pinyin_first_letter_and_full_pinyin_filter&quot; : &#123; &quot;type&quot; : &quot;pinyin&quot;, &quot;keep_first_letter&quot; : true, &quot;keep_full_pinyin&quot; : false, &quot;keep_none_chinese&quot; : true, &quot;keep_original&quot; : false, &quot;limit_first_letter_length&quot; : 16, &quot;lowercase&quot; : true, &quot;trim_whitespace&quot; : true, &quot;keep_none_chinese_in_first_letter&quot; : true &#125; &#125; &#125; &#125;&#125;Token Test:åˆ˜å¾·åŽ å¼ å­¦å‹ éƒ­å¯ŒåŸŽ é»Žæ˜Ž å››å¤§å¤©çŽ‹12345GET /medcl1/_analyze&#123; &quot;text&quot;: [&quot;åˆ˜å¾·åŽ å¼ å­¦å‹ éƒ­å¯ŒåŸŽ é»Žæ˜Ž å››å¤§å¤©çŽ‹&quot;], &quot;analyzer&quot;: &quot;user_name_analyzer&quot;&#125;12345678910111213141516171819202122232425262728293031323334353637383940&#123; &quot;tokens&quot; : [ &#123; &quot;token&quot; : &quot;ldh&quot;, &quot;start_offset&quot; : 0, &quot;end_offset&quot; : 3, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 0 &#125;, &#123; &quot;token&quot; : &quot;zxy&quot;, &quot;start_offset&quot; : 4, &quot;end_offset&quot; : 7, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 1 &#125;, &#123; &quot;token&quot; : &quot;gfc&quot;, &quot;start_offset&quot; : 8, &quot;end_offset&quot; : 11, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 2 &#125;, &#123; &quot;token&quot; : &quot;lm&quot;, &quot;start_offset&quot; : 12, &quot;end_offset&quot; : 14, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 3 &#125;, &#123; &quot;token&quot; : &quot;sdtw&quot;, &quot;start_offset&quot; : 15, &quot;end_offset&quot; : 19, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 4 &#125; ]&#125;å…¶å®ƒè¯·å‚é˜…é“¾æŽ¥https://github.com/medcl/elasticsearch-analysis-pinyinã€‚å¦‚æžœæƒ³äº†è§£ä¸­æ–‡IKåˆ†è¯å™¨ï¼Œè¯·å‚é˜…æ–‡ç« â€œElasticsearchï¼šIKä¸­æ–‡åˆ†è¯å™¨â€ã€‚]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearchï¼šJava è¿ç”¨ç¤ºä¾‹]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%EF%BC%9AJava%20%E8%BF%90%E7%94%A8%E7%A4%BA%E4%BE%8B%2F</url>
    <content type="text"><![CDATA[åœ¨ä»Šå¤©çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æ¥ä»‹ç»å¦‚ä½•ä½¿ç”¨Javaæ¥è®¿é—®Elasticsearchã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æˆ‘ä»¬çš„ç³»ç»Ÿä¸­å®‰è£…Elasticsearchã€‚Maven é…ç½®é’ˆå¯¹Javaçš„å¼€å‘ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨pom.xmlä¸­é…ç½®ç›¸åº”çš„Elasticsearchçš„ä¿¡æ¯ã€‚Mavev dependencyå®šä¹‰å¦‚ä¸‹ï¼š12345&lt;dependency&gt; &lt;groupId&gt;org.elasticsearch&lt;/groupId&gt; &lt;artifactId&gt;elasticsearch&lt;/artifactId&gt; &lt;version&gt;7.3.1&lt;/version&gt;&lt;/dependency&gt;è¿™ä¹Ÿæ˜¯ç›®å‰æˆªæ­¢æœ€æ–°çš„Elasticsearchçš„ç‰ˆæœ¬ã€‚æ‚¨å¯ä»¥éšæ—¶ä½¿ç”¨ä¹‹å‰æä¾›çš„é“¾æŽ¥æŸ¥çœ‹Maven Centralæ‰˜ç®¡çš„æœ€æ–°ç‰ˆæœ¬ã€‚å®Œæˆæ•°æ®åº“çš„æŸ¥è¯¢å»ºç«‹ä¸€ä¸ªç®€å•çš„model1234567891011121314151617181920212223242526272829303132333435363738package com.javacodegeeks.example; public class Person &#123; private String personId; private String name; private String number; public String getNumber() &#123; return number; &#125; public void setNumber(String number) &#123; this.number = number; &#125; public String getPersonId() &#123; return personId; &#125; public void setPersonId(String personId) &#123; this.personId = personId; &#125; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; @Override public String toString() &#123; return String.format(&quot;Person&#123;personId=&apos;%s&apos;, name=&apos;%s&apos;, number=&apos;%s&#125;&quot;, personId, name, number); &#125;&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªç®€å•çš„Person Modelã€‚å®šä¹‰è¿žæŽ¥å‚æ•°æˆ‘ä»¬å°†ä½¿ç”¨é»˜è®¤è¿žæŽ¥å‚æ•°ä¸ŽElasticsearchå»ºç«‹è¿žæŽ¥ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒESä½¿ç”¨ä¸¤ä¸ªç«¯å£ï¼š9200å’Œ920112345678910private static final String HOST = &quot;localhost&quot;;private static final int PORT_ONE = 9200;private static final int PORT_TWO = 9201;private static final String SCHEME = &quot;http&quot;; private static RestHighLevelClient restHighLevelClient;private static ObjectMapper objectMapper = new ObjectMapper(); private static final String INDEX = &quot;persondata&quot;;private static final String TYPE = &quot;_doc&quot;;è¿™é‡Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå«åšpersondataçš„indexï¼Œå®ƒçš„typeæ˜¯_docã€‚åœ¨æœ€æ–°çš„ç‰ˆæœ¬ä¸­ï¼Œæ¯ä¸ªindexåªæ”¯æŒä¸€ä¸ªtypeã€‚å¦‚ä¸Šé¢å‚æ•°ä¸­æ‰€è¿°ï¼ŒElasticsearchä½¿ç”¨ä¸¤ä¸ªç«¯å£9200å’Œ9201.ç¬¬ä¸€ä¸ªç«¯å£9200ç”±ElasticsearchæŸ¥è¯¢æœåŠ¡å™¨ä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒé€šè¿‡RESTful APIç›´æŽ¥æŸ¥è¯¢æ•°æ®åº“ã€‚ ç¬¬äºŒä¸ªç«¯å£9201ç”±RESTæœåŠ¡å™¨ä½¿ç”¨ï¼Œå¤–éƒ¨å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨è¯¥ç«¯å£è¿žæŽ¥å¹¶æ‰§è¡Œæ“ä½œã€‚å»ºç«‹ä¸€ä¸ªè¿žæŽ¥æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªä¸ŽElasticsearchæ•°æ®åº“å»ºç«‹è¿žæŽ¥çš„æ–¹æ³•ã€‚ åœ¨å»ºç«‹ä¸Žæ•°æ®åº“çš„è¿žæŽ¥æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»æä¾›ä¸¤ä¸ªç«¯å£ï¼Œå› ä¸ºåªæœ‰è¿™æ ·ï¼Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ‰èƒ½è¿žæŽ¥åˆ°ElasticsearchæœåŠ¡å™¨ï¼Œæˆ‘ä»¬å°†èƒ½å¤Ÿæ‰§è¡Œæ•°æ®åº“æ“ä½œã€‚ ä»¥ä¸‹æ˜¯å»ºç«‹è¿žæŽ¥çš„ä»£ç ã€‚1234567891011private static synchronized RestHighLevelClient makeConnection() &#123; if(restHighLevelClient == null) &#123; restHighLevelClient = new RestHighLevelClient( RestClient.builder( new HttpHost(HOST, PORT_ONE, SCHEME), new HttpHost(HOST, PORT_TWO, SCHEME))); &#125; return restHighLevelClient;&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å»ºç«‹ä¸€ä¸ªRestHighLevelClientçš„å®žä¾‹ã€‚å…·ä½“çš„å‚æ•°ï¼Œå¯ä»¥å‚å®˜æ–¹æ–‡æ¡£ Java High Level REST Client (https://www.elastic.co/guide/en/elasticsearch/client/java-rest/7.3/java-rest-high.html)ã€‚è¯·æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨æ­¤å¤„å®žçŽ°äº†Singleton Designæ¨¡å¼ï¼Œå› æ­¤ä¸ä¼šä¸ºESåˆ›å»ºå¤šä¸ªè¿žæŽ¥ï¼Œä»Žè€ŒèŠ‚çœå¤§é‡å†…å­˜ã€‚ç”±äºŽå­˜åœ¨RestHighLevelClientï¼Œä¸ŽElasticsearchçš„è¿žæŽ¥æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ åˆå§‹åŒ–æ­¤è¿žæŽ¥çš„æœ€ä½³æ—¶é—´æ˜¯åº”ç”¨ç¨‹åºè¯·æ±‚æˆ–å‘å®¢æˆ·ç«¯å‘å‡ºç¬¬ä¸€ä¸ªè¯·æ±‚æ—¶ã€‚ åˆå§‹åŒ–æ­¤è¿žæŽ¥å®¢æˆ·ç«¯åŽï¼Œå¯ä»¥ä½¿ç”¨å®ƒæ¥æ‰§è¡Œä»»ä½•æ”¯æŒçš„APIã€‚å…³æŽ‰ä¸€ä¸ªè¿žæŽ¥å°±åƒåœ¨æ—©æœŸç‰ˆæœ¬çš„Elasticsearchä¸­ä¸€æ ·ï¼Œæˆ‘ä»¬ä½¿ç”¨TransportClientï¼Œä¸€æ—¦å®ŒæˆæŸ¥è¯¢å°±å…³é—­å®ƒï¼Œä¸€æ—¦æ•°æ®åº“äº¤äº’å®ŒæˆRestHighLevelClientï¼Œä¹Ÿéœ€è¦å…³é—­è¿žæŽ¥ã€‚ ä»¥ä¸‹æ˜¯å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ï¼š1234private static synchronized void closeConnection() throws IOException &#123; restHighLevelClient.close(); restHighLevelClient = null;&#125;æˆ‘ä»¬è¿˜ä¸ºRestHighLevelClientå¯¹è±¡åˆ†é…äº†nullï¼Œä»¥ä¾¿Singletonæ¨¡å¼å¯ä»¥ä¿æŒä¸€è‡´ã€‚æ’å…¥ä¸€ä¸ªæ–‡æ¡£æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†é”®å’Œå€¼è½¬æ¢ä¸ºHashMapå°†æ•°æ®æ’å…¥æ•°æ®åº“ã€‚ ESæ•°æ®åº“ä»…æŽ¥å—HashMapå½¢å¼çš„å€¼ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å®žçŽ°è¿™ä¸€ç›®æ ‡çš„ä»£ç ç‰‡æ®µï¼š123456789101112131415161718192021222324252627282930313233343536373839private static Person insertPerson(Person person) &#123; person.setPersonId(UUID.randomUUID().toString()); Map&lt;String, Object&gt; dataMap = new HashMap&lt;String, Object&gt;(); dataMap.put(&quot;name&quot;, person.getName()); dataMap.put(&quot;number&quot;, person.getNumber()); IndexRequest indexRequest = new IndexRequest(INDEX) .id(person.getPersonId()).source(dataMap); try &#123; IndexResponse response = restHighLevelClient.index(indexRequest, RequestOptions.DEFAULT); &#125; catch(ElasticsearchException e) &#123; e.getDetailedMessage(); &#125; catch (java.io.IOException ex)&#123; ex.getLocalizedMessage(); &#125; /* // The following is another way to do it // More information https://www.elastic.co/guide/en/elasticsearch/client/java-rest/7.3/java-rest-high-document-index.html String id = UUID.randomUUID().toString(); person.setPersonId(id); IndexRequest request = new IndexRequest(INDEX); request.id(id); String jsonString = &quot;&#123;&quot; + &quot;\&quot;name\&quot;:&quot; + &quot;\&quot;&quot; + person.getName() + &quot;\&quot;&quot; + &quot;&#125;&quot;; System.out.println(&quot;jsonString: &quot; + jsonString); request.source(jsonString, XContentType.JSON); try &#123; IndexResponse response = restHighLevelClient.index(request, RequestOptions.DEFAULT); &#125; catch(ElasticsearchException e) &#123; e.getDetailedMessage(); &#125; catch (java.io.IOException ex)&#123; ex.getLocalizedMessage(); &#125; */ return person; &#125;å°±åƒä¸Šé¢ä»£ç ä¸­æ³¨é‡Šçš„é‚£æ ·ã€‚æ³¨é‡Šçš„ä»£ç çš„é‚£ä¸€éƒ¨åˆ†æ˜¯å¦å¤–ä¸€ç§æ–¹æ³•ã€‚å¤§å®¶å¯ä»¥å‚ç…§é“¾æŽ¥(https://www.elastic.co/guide/en/elasticsearch/client/java-rest/7.3/java-rest-high-document-index.html)èŽ·å¾—æ›´å¤šçš„ä¿¡æ¯ã€‚ä¸Šé¢ï¼Œæˆ‘ä»¬ä½¿ç”¨Javaçš„UUIDç±»æ¥åˆ›å»ºå¯¹è±¡çš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚ è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŽ§åˆ¶å¯¹è±¡æ ‡è¯†ç¬¦çš„åˆ¶ä½œæ–¹å¼ã€‚æˆ‘ä»¬å…¶å®žä¹Ÿå¯ä»¥å›ºå®šä¸€ä¸ªidåŽ»å†™ã€‚å¦‚æžœæ˜¯è¿™æ ·çš„è¯ï¼Œè¿è¡Œå¤šæ¬¡ï¼Œåªä¼šæ›´æ–°ä¹‹å‰çš„æ•°æ®ï¼Œå¹¶ä¸”versionä¼šè‡ªåŠ¨æ¯æ¬¡è¿è¡ŒåŽå¢žåŠ 1ã€‚è¯·æ±‚ä¸Šé¢å­˜å…¥çš„æ–‡æ¡£å®Œæˆå°†æ•°æ®æ’å…¥æ•°æ®åº“åŽï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‘Elasticsearchæ•°æ®åº“æœåŠ¡å™¨å‘å‡ºGETè¯·æ±‚æ¥ç¡®è®¤æ“ä½œã€‚ è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å®Œæˆæ­¤æ“ä½œçš„ä»£ç ç‰‡æ®µï¼š1234567891011121314 private static Person getPersonById(String id)&#123; GetRequest getPersonRequest = new GetRequest(INDEX, id); GetResponse getResponse = null; try &#123; getResponse = restHighLevelClient.get(getPersonRequest, RequestOptions.DEFAULT); &#125; catch (java.io.IOException e)&#123; e.getLocalizedMessage(); &#125; return getResponse != null ? objectMapper.convertValue(getResponse.getSourceAsMap(), Person.class) : null; &#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ ¹æ®ä¸Šé¢è¿”å›žæ¥å¾—idæ¥è¿›è¡Œqueryï¼Œå¹¶è¿”å›žæ•°æ®ã€‚åœ¨è¿™ä¸ªæŸ¥è¯¢ä¸­ï¼Œæˆ‘ä»¬åªæä¾›äº†å¯ä»¥è¯†åˆ«å®ƒçš„å¯¹è±¡çš„ä¸»è¦ä¿¡æ¯ï¼Œå³ç´¢å¼•ï¼Œå’Œå®ƒçš„å”¯ä¸€æ ‡è¯†ç¬¦idã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬å¾—åˆ°çš„å®žé™…ä¸Šæ˜¯ä¸€ä¸ªå€¼çš„æ˜ å°„ã€‚æ›´æ–°æ–‡æ¡£æˆ‘ä»¬å¯ä»¥é€šè¿‡é¦–å…ˆä½¿ç”¨å…¶ç´¢å¼•ï¼Œç±»åž‹å’Œå”¯ä¸€æ ‡è¯†ç¬¦æ¥æ ‡è¯†èµ„æºï¼Œä»Žè€Œè½»æ¾åœ°å‘Elasticsearchå‘å‡ºæ›´æ–°è¯·æ±‚ã€‚ ç„¶åŽæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ–°çš„HashMapå¯¹è±¡æ¥æ›´æ–°Objectä¸­çš„ä»»æ„æ•°é‡çš„å€¼ã€‚ è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»£ç æ®µï¼š1234567891011121314151617private static Person updatePersonById(String id, Person person)&#123; UpdateRequest updateRequest = new UpdateRequest(INDEX, id) .fetchSource(true); // Fetch Object after its update try &#123; String personJson = objectMapper.writeValueAsString(person); updateRequest.doc(personJson, XContentType.JSON); UpdateResponse updateResponse = restHighLevelClient.update(updateRequest, RequestOptions.DEFAULT); return objectMapper.convertValue(updateResponse.getGetResult().sourceAsMap(), Person.class); &#125;catch (JsonProcessingException e)&#123; e.getMessage(); &#125; catch (java.io.IOException e)&#123; e.getLocalizedMessage(); &#125; System.out.println(&quot;Unable to update person&quot;); return null; &#125;åˆ é™¤æ–‡æ¡£æœ€åŽï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç®€å•åœ°ä½¿ç”¨å…¶ç´¢å¼•ï¼Œç±»åž‹å’Œå”¯ä¸€æ ‡è¯†ç¬¦æ¥æ ‡è¯†èµ„æºæ¥åˆ é™¤æ•°æ®ã€‚ è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å¦‚ä½•å®Œæˆæ­¤æ“ä½œçš„ä»£ç ç‰‡æ®µ12345678private static void deletePersonById(String id) &#123; DeleteRequest deleteRequest = new DeleteRequest(INDEX, TYPE, id); try &#123; DeleteResponse deleteResponse = restHighLevelClient.delete(deleteRequest, RequestOptions.DEFAULT); &#125; catch (java.io.IOException e) &#123; e.getLocalizedMessage(); &#125;&#125;æˆ‘ä»¬æ ¹æ®ä¼ å…¥çš„idæ¥åˆ é™¤ç›¸åº”çš„æ–‡æ¡£ã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥åšæŸ¥è¯¢åˆ é™¤ã€‚è¿è¡Œæˆ‘ä»¬çš„åº”ç”¨è®©æˆ‘ä»¬é€šè¿‡æ‰§è¡Œä¸Šé¢æåˆ°çš„æ‰€æœ‰æ“ä½œæ¥å°è¯•æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºã€‚ ç”±äºŽè¿™æ˜¯ä¸€ä¸ªæ™®é€šçš„Javaåº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬å°†è°ƒç”¨è¿™äº›æ–¹æ³•ä¸­çš„æ¯ä¸€ä¸ªå¹¶æ‰“å°æ“ä½œç»“æžœï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051public static void main(String[] args) throws IOException &#123; makeConnection(); Person person = new Person(); person.setName(&quot;å¼ ä¸‰&quot;); System.out.println(&quot;Inserting a new Person with name &quot; + person.getName()); person.setNumber(&quot;111111&quot;); person = insertPerson(person); System.out.println(&quot;Person inserted --&gt; &quot; + person); person = new Person(); person.setName(&quot;å§šæ˜Ž&quot;); System.out.println(&quot;Inserting a new Person with name &quot; + person.getName()); person.setNumber(&quot;222222&quot;); person = insertPerson(person); System.out.println(&quot;Person inserted --&gt; &quot; + person); person.setName(&quot;æŽå››&quot;); System.out.println(&quot;Changing name to &quot; + person.getName()); updatePersonById(person.getPersonId(), person); System.out.println(&quot;Person updated --&gt; &quot; + person); System.out.println(&quot;Searching for all documents&quot;); SearchResponse response = searchAll(); System.out.println(response); System.out.println(&quot;Searching for a term&quot;); response = searchTerm(); System.out.println(response); System.out.println(&quot;Match a query&quot;); response = matchQuery(); System.out.println(response); System.out.println(&quot;Getting æŽå››&quot;); Person personFromDB = getPersonById(person.getPersonId()); System.out.println(&quot;Person from DB --&gt; &quot; + personFromDB); System.out.println(&quot;Deleting &quot; + person.getName()); deletePersonById(personFromDB.getPersonId()); System.out.println(&quot;Person &quot; + person.getName() + &quot; deleted!&quot;); closeConnection(); &#125;è¿è¡Œçš„ç»“æžœå¦‚ä¸‹ï¼š1234567891011121314Inserting a new Person with name å¼ ä¸‰Person inserted --&gt; Person&#123;personId=&apos;33f4162e-0a68-4e66-8717-851516272185&apos;, name=&apos;å¼ ä¸‰&apos;, number=&apos;111111&#125;Inserting a new Person with name å§šæ˜ŽPerson inserted --&gt; Person&#123;personId=&apos;9b477529-6e79-42e8-a50a-21b2d8bc4c13&apos;, name=&apos;å§šæ˜Ž&apos;, number=&apos;222222&#125;Changing name to æŽå››Person updated --&gt; Person&#123;personId=&apos;9b477529-6e79-42e8-a50a-21b2d8bc4c13&apos;, name=&apos;æŽå››&apos;, number=&apos;222222&#125;Searching for all documents&#123;&quot;took&quot;:0,&quot;timed_out&quot;:false,&quot;_shards&quot;:&#123;&quot;total&quot;:1,&quot;successful&quot;:1,&quot;skipped&quot;:0,&quot;failed&quot;:0&#125;,&quot;hits&quot;:&#123;&quot;total&quot;:&#123;&quot;value&quot;:4,&quot;relation&quot;:&quot;eq&quot;&#125;,&quot;max_score&quot;:1.0,&quot;hits&quot;:[&#123;&quot;_index&quot;:&quot;persondata&quot;,&quot;_type&quot;:&quot;_doc&quot;,&quot;_id&quot;:&quot;52425a44-dc06-49ca-b3df-26a8b341391c&quot;,&quot;_score&quot;:1.0,&quot;_source&quot;:&#123;&quot;number&quot;:&quot;111111&quot;,&quot;name&quot;:&quot;å¼ ä¸‰&quot;&#125;&#125;,&#123;&quot;_index&quot;:&quot;persondata&quot;,&quot;_type&quot;:&quot;_doc&quot;,&quot;_id&quot;:&quot;c76b8670-ed00-4212-b47b-46bc85d588b6&quot;,&quot;_score&quot;:1.0,&quot;_source&quot;:&#123;&quot;number&quot;:&quot;111111&quot;,&quot;name&quot;:&quot;å¼ ä¸‰&quot;&#125;&#125;,&#123;&quot;_index&quot;:&quot;persondata&quot;,&quot;_type&quot;:&quot;_doc&quot;,&quot;_id&quot;:&quot;b8bf0466-0ea5-43e0-8188-c0712812fb9a&quot;,&quot;_score&quot;:1.0,&quot;_source&quot;:&#123;&quot;number&quot;:&quot;111111&quot;,&quot;name&quot;:&quot;å¼ ä¸‰&quot;&#125;&#125;,&#123;&quot;_index&quot;:&quot;persondata&quot;,&quot;_type&quot;:&quot;_doc&quot;,&quot;_id&quot;:&quot;468dabe4-8f50-4667-a165-9ce6e015cb76&quot;,&quot;_score&quot;:1.0,&quot;_source&quot;:&#123;&quot;number&quot;:&quot;222222&quot;,&quot;name&quot;:&quot;æŽå››&quot;,&quot;personId&quot;:&quot;468dabe4-8f50-4667-a165-9ce6e015cb76&quot;&#125;&#125;]&#125;&#125;Searching for a term&#123;&quot;took&quot;:0,&quot;timed_out&quot;:false,&quot;_shards&quot;:&#123;&quot;total&quot;:1,&quot;successful&quot;:1,&quot;skipped&quot;:0,&quot;failed&quot;:0&#125;,&quot;hits&quot;:&#123;&quot;total&quot;:&#123;&quot;value&quot;:3,&quot;relation&quot;:&quot;eq&quot;&#125;,&quot;max_score&quot;:0.9444616,&quot;hits&quot;:[&#123;&quot;_index&quot;:&quot;persondata&quot;,&quot;_type&quot;:&quot;_doc&quot;,&quot;_id&quot;:&quot;52425a44-dc06-49ca-b3df-26a8b341391c&quot;,&quot;_score&quot;:0.9444616,&quot;_source&quot;:&#123;&quot;number&quot;:&quot;111111&quot;,&quot;name&quot;:&quot;å¼ ä¸‰&quot;&#125;&#125;,&#123;&quot;_index&quot;:&quot;persondata&quot;,&quot;_type&quot;:&quot;_doc&quot;,&quot;_id&quot;:&quot;c76b8670-ed00-4212-b47b-46bc85d588b6&quot;,&quot;_score&quot;:0.9444616,&quot;_source&quot;:&#123;&quot;number&quot;:&quot;111111&quot;,&quot;name&quot;:&quot;å¼ ä¸‰&quot;&#125;&#125;,&#123;&quot;_index&quot;:&quot;persondata&quot;,&quot;_type&quot;:&quot;_doc&quot;,&quot;_id&quot;:&quot;b8bf0466-0ea5-43e0-8188-c0712812fb9a&quot;,&quot;_score&quot;:0.9444616,&quot;_source&quot;:&#123;&quot;number&quot;:&quot;111111&quot;,&quot;name&quot;:&quot;å¼ ä¸‰&quot;&#125;&#125;]&#125;&#125;Match a query&#123;&quot;took&quot;:0,&quot;timed_out&quot;:false,&quot;_shards&quot;:&#123;&quot;total&quot;:1,&quot;successful&quot;:1,&quot;skipped&quot;:0,&quot;failed&quot;:0&#125;,&quot;hits&quot;:&#123;&quot;total&quot;:&#123;&quot;value&quot;:3,&quot;relation&quot;:&quot;eq&quot;&#125;,&quot;max_score&quot;:1.8889232,&quot;hits&quot;:[&#123;&quot;_index&quot;:&quot;persondata&quot;,&quot;_type&quot;:&quot;_doc&quot;,&quot;_id&quot;:&quot;52425a44-dc06-49ca-b3df-26a8b341391c&quot;,&quot;_score&quot;:1.8889232,&quot;_source&quot;:&#123;&quot;number&quot;:&quot;111111&quot;,&quot;name&quot;:&quot;å¼ ä¸‰&quot;&#125;&#125;,&#123;&quot;_index&quot;:&quot;persondata&quot;,&quot;_type&quot;:&quot;_doc&quot;,&quot;_id&quot;:&quot;c76b8670-ed00-4212-b47b-46bc85d588b6&quot;,&quot;_score&quot;:1.8889232,&quot;_source&quot;:&#123;&quot;number&quot;:&quot;111111&quot;,&quot;name&quot;:&quot;å¼ ä¸‰&quot;&#125;&#125;,&#123;&quot;_index&quot;:&quot;persondata&quot;,&quot;_type&quot;:&quot;_doc&quot;,&quot;_id&quot;:&quot;b8bf0466-0ea5-43e0-8188-c0712812fb9a&quot;,&quot;_score&quot;:1.8889232,&quot;_source&quot;:&#123;&quot;number&quot;:&quot;111111&quot;,&quot;name&quot;:&quot;å¼ ä¸‰&quot;&#125;&#125;]&#125;&#125;Getting æŽå››Person from DB --&gt; Person&#123;personId=&apos;9b477529-6e79-42e8-a50a-21b2d8bc4c13&apos;, name=&apos;æŽå››&apos;, number=&apos;222222&#125;æ•´ä¸ªé¡¹ç›®çš„æºç å¯ä»¥åœ¨åœ°å€æ‰¾åˆ°ï¼šhttps://github.com/liu-xiao-guo/elastic-javaæ›´å¤šèµ„æ–™ï¼šã€1ã€‘ä½¿ç”¨RestHighLevelClientæ—¶å•ä¸ªç´¢å¼•é€Ÿåº¦å¾ˆæ…¢(https://discuss.elastic.co/t/resthighlevelclient/170293)]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearchï¼šinverted indexï¼Œdoc_valuesåŠsource]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%EF%BC%9Ainverted%20index%EF%BC%8Cdoc_values%E5%8F%8Asource%2F</url>
    <content type="text"><![CDATA[å½“æˆ‘ä»¬å­¦ä¹ Elasticsearchæ—¶ï¼Œç»å¸¸ä¼šé‡åˆ°å¦‚ä¸‹çš„å‡ ä¸ªæ¦‚å¿µï¼šReverted indexdoc_valuessourceï¼Ÿè¿™ä¸ªå‡ ä¸ªæ¦‚å¿µåˆ†åˆ«æŒ‡çš„æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç”¨å¤„ï¼Ÿå¦‚ä½•é…ç½®å®ƒä»¬ï¼Ÿåªæœ‰æˆ‘ä»¬ç†Ÿç»ƒåœ°æŽŒæ¡äº†è¿™äº›æ¦‚å¿µï¼Œæˆ‘ä»¬æ‰å¯ä»¥æ­£ç¡®åœ°ä½¿ç”¨å®ƒä»¬ã€‚Inverted indexinverted indexï¼ˆåå‘ç´¢å¼•ï¼‰æ˜¯Elasticsearchå’Œä»»ä½•å…¶ä»–æ”¯æŒå…¨æ–‡æœç´¢çš„ç³»ç»Ÿçš„æ ¸å¿ƒæ•°æ®ç»“æž„ã€‚ åå‘ç´¢å¼•ç±»ä¼¼äºŽæ‚¨åœ¨ä»»ä½•ä¹¦ç±ç»“å°¾å¤„çœ‹åˆ°çš„ç´¢å¼•ã€‚ å®ƒå°†å‡ºçŽ°åœ¨æ–‡æ¡£ä¸­çš„æœ¯è¯­æ˜ å°„åˆ°æ–‡æ¡£ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä»Žä»¥ä¸‹å­—ç¬¦ä¸²æž„å»ºåå‘ç´¢å¼•ï¼šElasticsearchä»Žå·²å»ºç«‹ç´¢å¼•çš„ä¸‰ä¸ªæ–‡æ¡£ä¸­æž„å»ºæ•°æ®ç»“æž„ã€‚ ä»¥ä¸‹æ•°æ®ç»“æž„ç§°ä¸ºåå‘ç´¢å¼•(inverted index)ï¼šTerm Frequency Document (postings)choice 1 3day 1 2is 3 1,2,3it 1 1last 1 2of 1 2of 1 2sunday 2 1,2the 3 2,3tomorrow 1 1week 1 2yours 1 3åœ¨è¿™é‡Œåå‘ç´¢å¼•æŒ‡çš„çš„æ˜¯ï¼Œæˆ‘ä»¬æ ¹æ®termæ¥å¯»æ‰¾ç›¸åº”çš„æ–‡æ¡£idsã€‚è¿™å’Œå¸¸è§„çš„æ ¹æ®æ–‡æ¡£idæ¥å¯»æ‰¾termç›¸åã€‚è¯·æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼šåˆ é™¤æ ‡ç‚¹ç¬¦å·å¹¶å°†å…¶å°å†™åŽï¼Œæ–‡æ¡£ä¼šæŒ‰æœ¯è¯­è¿›è¡Œç»†åˆ†ã€‚æœ¯è¯­æŒ‰å­—æ¯é¡ºåºæŽ’åºâ€œFrequencyâ€åˆ—æ•èŽ·è¯¥æœ¯è¯­åœ¨æ•´ä¸ªæ–‡æ¡£é›†ä¸­å‡ºçŽ°çš„æ¬¡æ•°ç¬¬ä¸‰åˆ—æ•èŽ·äº†åœ¨å…¶ä¸­æ‰¾åˆ°è¯¥æœ¯è¯­çš„æ–‡æ¡£ã€‚ æ­¤å¤–ï¼Œå®ƒè¿˜å¯èƒ½åŒ…å«æ‰¾åˆ°è¯¥æœ¯è¯­çš„ç¡®åˆ‡ä½ç½®ï¼ˆæ–‡æ¡£ä¸­çš„åç§»ï¼‰åœ¨æ–‡æ¡£ä¸­æœç´¢æœ¯è¯­æ—¶ï¼ŒæŸ¥æ‰¾ç»™å®šæœ¯è¯­å‡ºçŽ°åœ¨å…¶ä¸­çš„æ–‡æ¡£éžå¸¸å¿«æ·ã€‚ å¦‚æžœç”¨æˆ·æœç´¢æœ¯è¯­â€œsundayâ€ï¼Œé‚£ä¹ˆä»Žâ€œTermâ€åˆ—ä¸­æŸ¥æ‰¾sundayå°†éžå¸¸å¿«ï¼Œå› ä¸ºè¿™äº›æœ¯è¯­åœ¨ç´¢å¼•ä¸­è¿›è¡Œäº†æŽ’åºã€‚ å³ä½¿æœ‰æ•°ç™¾ä¸‡ä¸ªæœ¯è¯­ï¼Œä¹Ÿå¯ä»¥åœ¨å¯¹æœ¯è¯­è¿›è¡ŒæŽ’åºæ—¶å¿«é€ŸæŸ¥æ‰¾å®ƒä»¬ã€‚éšåŽï¼Œè€ƒè™‘ä¸€ç§æƒ…å†µï¼Œå…¶ä¸­ç”¨æˆ·æœç´¢ä¸¤ä¸ªå•è¯ï¼Œä¾‹å¦‚last sundayã€‚ åå‘ç´¢å¼•å¯ç”¨äºŽåˆ†åˆ«æœç´¢lastå’Œsundayçš„å‘ç”Ÿï¼› æ–‡æ¡£2åŒ…å«è¿™ä¸¤ä¸ªæœ¯è¯­ï¼Œå› æ­¤æ¯”ä»…åŒ…å«ä¸€ä¸ªæœ¯è¯­çš„æ–‡æ¡£1æ›´å¥½ã€‚åå‘ç´¢å¼•æ˜¯æ‰§è¡Œå¿«é€Ÿæœç´¢çš„åŸºç¡€ã€‚ åŒæ ·ï¼Œå¾ˆå®¹æ˜“æŸ¥æ˜Žç´¢å¼•ä¸­å‡ºçŽ°äº†å¤šå°‘æ¬¡æœ¯è¯­ã€‚ è¿™æ˜¯ä¸€ä¸ªç®€å•çš„è®¡æ•°æ±‡æ€»ã€‚ å½“ç„¶ï¼ŒElasticsearchåœ¨æˆ‘ä»¬åœ¨è¿™é‡Œè§£é‡Šçš„ç®€å•çš„åå‘æŽ’ç´¢å¼•çš„åŸºç¡€ä¸Šä½¿ç”¨äº†å¾ˆå¤šåˆ›æ–°ã€‚ å®ƒå…¼é¡¾æœç´¢å’Œåˆ†æžã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒElasticsearchåœ¨æ–‡æ¡£ä¸­çš„æ‰€æœ‰å­—æ®µä¸Šæž„å»ºä¸€ä¸ªåå‘ç´¢å¼•ï¼ŒæŒ‡å‘è¯¥å­—æ®µæ‰€åœ¨çš„Elasticsearchæ–‡æ¡£ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨æ¯ä¸ªElasticsearchçš„Luceneé‡Œï¼Œæœ‰ä¸€ä¸ªä½ç½®å­˜æ”¾è¿™ä¸ªinverted indexã€‚åœ¨Kibanaä¸­ï¼Œæˆ‘ä»¬å»ºç«‹ä¸€ä¸ªå¦‚ä¸‹çš„æ–‡æ¡£ï¼š12345678910111213141516171819202122PUT twitter/_doc/1&#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;name&quot;: &#123; &quot;firstname&quot;: &quot;ä¸‰&quot;, &quot;surname&quot;: &quot;å¼ &quot; &#125;, &quot;address&quot; : [ &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;ä¸­å…³æ‘29å·&quot; ], &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125;&#125;å½“è¿™ä¸ªæ–‡æ¡£è¢«å»ºç«‹å¥½ä»¥åŽï¼ŒElasticå°±å·²ç»å¸®æˆ‘ä»¬å»ºç«‹å¥½äº†ç›¸åº”çš„inverted indexä¾›æˆ‘ä»¬è¿›è¡Œæœç´¢ï¼Œæ¯”å¦‚ï¼š12345678GET twitter/_search&#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;user&quot;: &quot;å¼ ä¸‰&quot; &#125; &#125;&#125;æˆ‘ä»¬å¯ä¸Žå¾—åˆ°ç›¸åº”çš„æœç´¢ç»“æžœï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546&#123; &quot;took&quot; : 0, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 1, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 0.5753642, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 0.5753642, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;name&quot; : &#123; &quot;firstname&quot; : &quot;ä¸‰&quot;, &quot;surname&quot; : &quot;å¼ &quot; &#125;, &quot;address&quot; : [ &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;ä¸­å…³æ‘29å·&quot; ], &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125; &#125; &#125; ] &#125;&#125;å¦‚æžœæˆ‘ä»¬æƒ³ä¸è®©æˆ‘ä»¬çš„æŸä¸ªå­—æ®µä¸è¢«æœç´¢ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸æƒ³ä¸ºè¿™ä¸ªå­—æ®µå»ºç«‹inverted indexï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125DELETE twitterPUT twitter&#123; &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;city&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125;, &quot;address&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125;, &quot;age&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;country&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125;, &quot;location&quot;: &#123; &quot;properties&quot;: &#123; &quot;lat&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125;, &quot;lon&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125; &#125; &#125;, &quot;message&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125;, &quot;name&quot;: &#123; &quot;properties&quot;: &#123; &quot;firstname&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125;, &quot;surname&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125; &#125; &#125;, &quot;province&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125;, &quot;uid&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;user&quot;: &#123; &quot;type&quot;: &quot;object&quot;, &quot;enabled&quot;: false &#125; &#125; &#125;&#125; PUT twitter/_doc/1&#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;name&quot;: &#123; &quot;firstname&quot;: &quot;ä¸‰&quot;, &quot;surname&quot;: &quot;å¼ &quot; &#125;, &quot;address&quot; : [ &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;ä¸­å…³æ‘29å·&quot; ], &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125;&#125;åœ¨ä¸Šé¢ï¼Œæˆ‘ä»¬é€šè¿‡mappingå¯¹userå­—æ®µè¿›è¡Œäº†ä¿®æ”¹ï¼š1234&quot;user&quot;: &#123; &quot;type&quot;: &quot;object&quot;, &quot;enabled&quot;: false &#125;ä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªå­—æ®µå°†ä¸è¢«å»ºç«‹ç´¢å¼•ï¼Œæˆ‘ä»¬å¦‚æžœä½¿ç”¨è¿™ä¸ªå­—æ®µè¿›è¡Œæœç´¢çš„è¯ï¼Œä¸ä¼šäº§ç”Ÿä»»ä½•çš„ç»“æžœï¼š12345678GET twitter/_search&#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;user&quot;: &quot;å¼ ä¸‰&quot; &#125; &#125;&#125;æœç´¢çš„ç»“æžœä¸ºï¼š123456789101112131415161718&#123; &quot;took&quot; : 0, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 0, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : null, &quot;hits&quot; : [ ] &#125;&#125;æ˜¾ç„¶æ˜¯æ²¡æœ‰ä»»ä½•çš„ç»“æžœã€‚ä½†æ˜¯å¦‚æžœæˆ‘ä»¬å¯¹è¿™ä¸ªæ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢çš„è¯ï¼š1GET twitter/_doc/1æ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š123456789101112131415161718192021222324252627282930&#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_version&quot; : 1, &quot;_seq_no&quot; : 0, &quot;_primary_term&quot; : 1, &quot;found&quot; : true, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;name&quot; : &#123; &quot;firstname&quot; : &quot;ä¸‰&quot;, &quot;surname&quot; : &quot;å¼ &quot; &#125;, &quot;address&quot; : [ &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;ä¸­å…³æ‘29å·&quot; ], &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125; &#125;&#125;æ˜¾ç„¶userçš„ä¿¡æ¯æ˜¯å­˜æ”¾äºŽsourceé‡Œçš„ã€‚åªæ˜¯å®ƒä¸è¢«æˆ‘ä»¬æ‰€æœç´¢è€Œå·²ã€‚å¦‚æžœæˆ‘ä»¬ä¸æƒ³æˆ‘ä»¬çš„æ•´ä¸ªæ–‡æ¡£è¢«æœç´¢ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥ç›´æŽ¥é‡‡ç”¨å¦‚ä¸‹çš„æ–¹æ³•ï¼š12345678DELETE twitter PUT twitter &#123; &quot;mappings&quot;: &#123; &quot;enabled&quot;: false &#125;&#125;é‚£ä¹ˆæ•´ä¸ªtwitterç´¢å¼•å°†ä¸å»ºç«‹ä»»ä½•çš„inverted indexï¼Œé‚£ä¹ˆæˆ‘ä»¬é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤ï¼š12345678910111213141516171819202122232425262728293031PUT twitter/_doc/1&#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;name&quot;: &#123; &quot;firstname&quot;: &quot;ä¸‰&quot;, &quot;surname&quot;: &quot;å¼ &quot; &#125;, &quot;address&quot; : [ &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;ä¸­å…³æ‘29å·&quot; ], &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125;&#125; GET twitter/_search&#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;city&quot;: &quot;åŒ—äº¬&quot; &#125; &#125;&#125;ä¸Šé¢çš„å‘½ä»¤æ‰§è¡Œçš„ç»“æžœæ˜¯ï¼Œæ²¡æœ‰ä»»ä½•æœç´¢çš„ç»“æžœã€‚æ›´å¤šé˜…è¯»ï¼Œå¯ä»¥å‚é˜…â€œMapping parameters: enabledâ€(https://www.elastic.co/guide/en/elasticsearch/reference/current/enabled.html)ã€‚Sourceåœ¨Elasticsearchä¸­ï¼Œé€šå¸¸æ¯ä¸ªæ–‡æ¡£çš„æ¯ä¸€ä¸ªå­—æ®µéƒ½ä¼šè¢«å­˜å‚¨åœ¨shardé‡Œå­˜æ”¾sourceçš„åœ°æ–¹ï¼Œæ¯”å¦‚ï¼š12345678910111213141516171819202122PUT twitter/_doc/2&#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;name&quot;: &#123; &quot;firstname&quot;: &quot;ä¸‰&quot;, &quot;surname&quot;: &quot;å¼ &quot; &#125;, &quot;address&quot; : [ &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;ä¸­å…³æ‘29å·&quot; ], &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125;&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªidä¸º2çš„æ–‡æ¡£ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥èŽ·å¾—å®ƒçš„æ‰€æœ‰çš„å­˜å‚¨çš„ä¿¡æ¯ã€‚1GET twitter/_doc/2å®ƒå°†è¿”å›žï¼š123456789101112131415161718192021222324252627282930&#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;2&quot;, &quot;_version&quot; : 1, &quot;_seq_no&quot; : 1, &quot;_primary_term&quot; : 1, &quot;found&quot; : true, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;name&quot; : &#123; &quot;firstname&quot; : &quot;ä¸‰&quot;, &quot;surname&quot; : &quot;å¼ &quot; &#125;, &quot;address&quot; : [ &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;ä¸­å…³æ‘29å·&quot; ], &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125; &#125;&#125;åœ¨ä¸Šé¢çš„_sourceé‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°Elasticsearchä¸ºæˆ‘ä»¬æ‰€å­˜ä¸‹çš„æ‰€æœ‰çš„å­—æ®µã€‚å¦‚æžœæˆ‘ä»¬ä¸æƒ³å­˜å‚¨ä»»ä½•çš„å­—æ®µï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åšå¦‚ä¸‹çš„è®¾ç½®ï¼š12345678910DELETE twitter PUT twitter&#123; &quot;mappings&quot;: &#123; &quot;_source&quot;: &#123; &quot;enabled&quot;: false &#125; &#125;&#125;é‚£ä¹ˆæˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹çš„å‘½ä»¤æ¥åˆ›å»ºä¸€ä¸ªidä¸º1çš„æ–‡æ¡£ï¼š12345678910111213141516171819202122PUT twitter/_doc/1&#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;name&quot;: &#123; &quot;firstname&quot;: &quot;ä¸‰&quot;, &quot;surname&quot;: &quot;å¼ &quot; &#125;, &quot;address&quot; : [ &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;ä¸­å…³æ‘29å·&quot; ], &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125;&#125;é‚£ä¹ˆåŒæ ·åœ°ï¼Œæˆ‘ä»¬æ¥æŸ¥è¯¢ä¸€ä¸‹è¿™ä¸ªæ–‡æ¡£ï¼š1GET witter/_doc/1æ˜¾ç¤ºçš„ç»“æžœä¸ºï¼š123456789&#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_version&quot; : 1, &quot;_seq_no&quot; : 0, &quot;_primary_term&quot; : 1, &quot;found&quot; : true&#125;æ˜¾ç„¶æˆ‘ä»¬çš„æ–‡æ¡£æ˜¯è¢«æ‰¾åˆ°äº†ï¼Œä½†æ˜¯æˆ‘ä»¬çœ‹ä¸åˆ°ä»»ä½•çš„sourceã€‚é‚£ä¹ˆæˆ‘ä»¬èƒ½å¯¹è¿™ä¸ªæ–‡æ¡£è¿›è¡Œæœç´¢å—ï¼Ÿå°è¯•å¦‚ä¸‹çš„å‘½ä»¤ï¼š12345678GET twitter/_search&#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;city&quot;: &quot;åŒ—äº¬&quot; &#125; &#125;&#125;æ˜¾ç¤ºçš„ç»“æžœä¸ºï¼š12345678910111213141516171819202122232425&#123; &quot;took&quot; : 0, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 1, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 0.5753642, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 0.5753642 &#125; ] &#125;&#125;æ˜¾ç„¶è¿™ä¸ªæ–‡æ¡£idä¸º1çš„æ–‡æ¡£å¯ä»¥è¢«æ­£ç¡®åœ°æœç´¢ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæœ‰å®Œå¥½çš„inverted indexä¾›æˆ‘ä»¬æŸ¥è¯¢ï¼Œè™½ç„¶å®ƒæ²¡æœ‰å­—çš„sourceã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•æœ‰é€‰æ‹©åœ°è¿›è¡Œå­˜å‚¨æˆ‘ä»¬æƒ³è¦çš„å­—æ®µå‘¢ï¼Ÿè¿™ç§æƒ…å†µé€‚ç”¨äºŽæˆ‘ä»¬æƒ³èŠ‚çœè‡ªå·±çš„å­˜å‚¨ç©ºé—´ï¼Œåªå­˜å‚¨é‚£äº›æˆ‘ä»¬éœ€è¦çš„å­—æ®µåˆ°sourceé‡ŒåŽ»ã€‚æˆ‘ä»¬å¯ä»¥åšå¦‚ä¸‹çš„è®¾ç½®ï¼š1234567891011121314151617DELETE twitter PUT twitter&#123; &quot;mappings&quot;: &#123; &quot;_source&quot;: &#123; &quot;includes&quot;: [ &quot;*.lat&quot;, &quot;address&quot;, &quot;name.*&quot; ], &quot;excludes&quot;: [ &quot;name.surname&quot; ] &#125; &#125;&#125;åœ¨ä¸Šé¢ï¼Œæˆ‘ä»¬ä½¿ç”¨includeæ¥åŒ…å«æˆ‘ä»¬æƒ³è¦çš„å­—æ®µï¼ŒåŒæ—¶æˆ‘ä»¬é€šè¿‡excludeæ¥åŽ»é™¤é‚£äº›ä¸éœ€è¦çš„å­—æ®µã€‚æˆ‘ä»¬å°è¯•å¦‚ä¸‹çš„æ–‡æ¡£è¾“å…¥ï¼š12345678910111213141516171819202122PUT twitter/_doc/1&#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;name&quot;: &#123; &quot;firstname&quot;: &quot;ä¸‰&quot;, &quot;surname&quot;: &quot;å¼ &quot; &#125;, &quot;address&quot; : [ &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;ä¸­å…³æ‘29å·&quot; ], &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125;&#125;é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥è¿›è¡ŒæŸ¥è¯¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š1GET twitter/_doc/1ç»“æžœæ˜¯ï¼š123456789101112131415161718192021&#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_version&quot; : 1, &quot;_seq_no&quot; : 0, &quot;_primary_term&quot; : 1, &quot;found&quot; : true, &quot;_source&quot; : &#123; &quot;address&quot; : [ &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;ä¸­å…³æ‘29å·&quot; ], &quot;name&quot; : &#123; &quot;firstname&quot; : &quot;ä¸‰&quot; &#125;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot; &#125; &#125;&#125;æ˜¾ç„¶ï¼Œæˆ‘ä»¬åªæœ‰å¾ˆå°‘çš„å‡ ä¸ªå­—æ®µè¢«å­˜å‚¨ä¸‹æ¥äº†ã€‚é€šè¿‡è¿™æ ·çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰é€‰æ‹©åœ°å­˜å‚¨æˆ‘ä»¬æƒ³è¦çš„å­—æ®µã€‚åœ¨å®žé™…çš„ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬åœ¨æŸ¥è¯¢æ–‡æ¡£æ—¶ï¼Œä¹Ÿå¯ä»¥æœ‰é€‰æ‹©åœ°è¿›è¡Œæ˜¾ç¤ºæˆ‘ä»¬æƒ³è¦çš„å­—æ®µï¼Œå°½ç®¡æœ‰å¾ˆå¤šçš„å­—æ®µè¢«å­˜äºŽsourceä¸­ï¼š1GET twitter/_doc/1?_source=name,locationåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åªæƒ³æ˜¾ç¤ºå’ŒnameåŠlocationç›¸å…³çš„å­—æ®µï¼Œé‚£ä¹ˆæ˜¾ç¤ºçš„ç»“æžœä¸ºï¼š1234567891011121314151617&#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_version&quot; : 1, &quot;_seq_no&quot; : 0, &quot;_primary_term&quot; : 1, &quot;found&quot; : true, &quot;_source&quot; : &#123; &quot;name&quot; : &#123; &quot;firstname&quot; : &quot;ä¸‰&quot; &#125;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot; &#125; &#125;&#125;æ›´å¤šçš„é˜…è¯»ï¼Œå¯ä»¥å‚é˜…æ–‡æ¡£â€œMapping meta-field: _sourceâ€(https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-source-field.html)Doc_valuesé»˜è®¤æƒ…å†µä¸‹ï¼Œå¤§å¤šæ•°å­—æ®µéƒ½å·²ç¼–å…¥ç´¢å¼•ï¼Œè¿™ä½¿å®ƒä»¬å¯æœç´¢ã€‚åå‘ç´¢å¼•å…è®¸æŸ¥è¯¢åœ¨å”¯ä¸€çš„æœ¯è¯­æŽ’åºåˆ—è¡¨ä¸­æŸ¥æ‰¾æœç´¢è¯ï¼Œå¹¶ä»Žä¸­ç«‹å³è®¿é—®åŒ…å«è¯¥è¯çš„æ–‡æ¡£åˆ—è¡¨ã€‚sortï¼Œaggregtionå’Œè®¿é—®è„šæœ¬ä¸­çš„å­—æ®µå€¼éœ€è¦ä¸åŒçš„æ•°æ®è®¿é—®æ¨¡å¼ã€‚é™¤äº†æŸ¥æ‰¾æœ¯è¯­å’ŒæŸ¥æ‰¾æ–‡æ¡£å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦èƒ½å¤ŸæŸ¥æ‰¾æ–‡æ¡£å¹¶æŸ¥æ‰¾å…¶åœ¨å­—æ®µä¸­å…·æœ‰çš„æœ¯è¯­ã€‚Doc valuesæ˜¯åœ¨æ–‡æ¡£ç´¢å¼•æ—¶æž„å»ºçš„ç£ç›˜æ•°æ®ç»“æž„ï¼Œè¿™ä½¿è¿™ç§æ•°æ®è®¿é—®æ¨¡å¼æˆä¸ºå¯èƒ½ã€‚å®ƒä»¬å­˜å‚¨ä¸Ž_sourceç›¸åŒçš„å€¼ï¼Œä½†ä»¥é¢å‘åˆ—çš„æ–¹å¼å­˜å‚¨ï¼Œè¿™å¯¹äºŽæŽ’åºå’Œèšåˆè€Œè¨€æ›´ä¸ºæœ‰æ•ˆã€‚å‡ ä¹Žæ‰€æœ‰å­—æ®µç±»åž‹éƒ½æ”¯æŒDocå€¼ï¼Œä½†å¯¹å­—ç¬¦ä¸²å­—æ®µé™¤å¤–ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰æ”¯æŒdocå€¼çš„å­—æ®µå‡å·²å¯ç”¨å®ƒä»¬ã€‚å¦‚æžœæ‚¨ç¡®å®šä¸éœ€è¦å¯¹å­—æ®µè¿›è¡ŒæŽ’åºæˆ–æ±‡æ€»ï¼Œä¹Ÿä¸éœ€è¦é€šè¿‡è„šæœ¬è®¿é—®å­—æ®µå€¼ï¼Œåˆ™å¯ä»¥ç¦ç”¨docå€¼ä»¥èŠ‚çœç£ç›˜ç©ºé—´ï¼šæ¯”å¦‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹å¼æ¥ä½¿å¾—cityå­—æ®µä¸å¯ä»¥åšsortæˆ–aggregationï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108DELETE twitterPUT twitter&#123; &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;city&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;doc_values&quot;: false, &quot;ignore_above&quot;: 256 &#125;, &quot;address&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125;, &quot;age&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;country&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125;, &quot;location&quot;: &#123; &quot;properties&quot;: &#123; &quot;lat&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125;, &quot;lon&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125; &#125; &#125;, &quot;message&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125;, &quot;name&quot;: &#123; &quot;properties&quot;: &#123; &quot;firstname&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125;, &quot;surname&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125; &#125; &#125;, &quot;province&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125;, &quot;uid&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;user&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125; &#125; &#125;&#125;åœ¨ä¸Šé¢ï¼Œæˆ‘ä»¬æŠŠcityå­—æ®µçš„doc_valuesè®¾ç½®ä¸ºfalseã€‚12345&quot;city&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;doc_values&quot;: false, &quot;ignore_above&quot;: 256&#125;,æˆ‘ä»¬é€šè¿‡å¦‚ä¸‹çš„æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªæ–‡æ¡£ï¼š12345678910111213141516171819202122PUT twitter/_doc/1&#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;name&quot;: &#123; &quot;firstname&quot;: &quot;ä¸‰&quot;, &quot;surname&quot;: &quot;å¼ &quot; &#125;, &quot;address&quot; : [ &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;ä¸­å…³æ‘29å·&quot; ], &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125;&#125;é‚£ä¹ˆï¼Œå½“æˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹çš„æ–¹æ³•æ¥è¿›è¡Œaggregationæ—¶ï¼š123456789101112GET twitter/_search&#123; &quot;size&quot;: 0, &quot;aggs&quot;: &#123; &quot;city_bucket&quot;: &#123; &quot;terms&quot;: &#123; &quot;field&quot;: &quot;city&quot;, &quot;size&quot;: 10 &#125; &#125; &#125;&#125;åœ¨æˆ‘ä»¬çš„Kibanaä¸Šæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š12345678910111213141516171819202122232425262728293031323334&#123; &quot;error&quot;: &#123; &quot;root_cause&quot;: [ &#123; &quot;type&quot;: &quot;illegal_argument_exception&quot;, &quot;reason&quot;: &quot;Can&apos;t load fielddata on [city] because fielddata is unsupported on fields of type [keyword]. Use doc values instead.&quot; &#125; ], &quot;type&quot;: &quot;search_phase_execution_exception&quot;, &quot;reason&quot;: &quot;all shards failed&quot;, &quot;phase&quot;: &quot;query&quot;, &quot;grouped&quot;: true, &quot;failed_shards&quot;: [ &#123; &quot;shard&quot;: 0, &quot;index&quot;: &quot;twitter&quot;, &quot;node&quot;: &quot;IyyZ30-hRi2rnOpfx4n1-A&quot;, &quot;reason&quot;: &#123; &quot;type&quot;: &quot;illegal_argument_exception&quot;, &quot;reason&quot;: &quot;Can&apos;t load fielddata on [city] because fielddata is unsupported on fields of type [keyword]. Use doc values instead.&quot; &#125; &#125; ], &quot;caused_by&quot;: &#123; &quot;type&quot;: &quot;illegal_argument_exception&quot;, &quot;reason&quot;: &quot;Can&apos;t load fielddata on [city] because fielddata is unsupported on fields of type [keyword]. Use doc values instead.&quot;, &quot;caused_by&quot;: &#123; &quot;type&quot;: &quot;illegal_argument_exception&quot;, &quot;reason&quot;: &quot;Can&apos;t load fielddata on [city] because fielddata is unsupported on fields of type [keyword]. Use doc values instead.&quot; &#125; &#125; &#125;, &quot;status&quot;: 400&#125;æ˜¾ç„¶ï¼Œæˆ‘ä»¬çš„æ“ä½œæ˜¯å¤±è´¥çš„ã€‚å°½ç®¡æˆ‘ä»¬ä¸èƒ½åšaggregationåŠsortï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥å¾—åˆ°å®ƒçš„sourceï¼š1GET twitter/_doc/1æ˜¾ç¤ºç»“æžœä¸ºï¼š123456789101112131415161718192021222324252627282930&#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_version&quot; : 1, &quot;_seq_no&quot; : 0, &quot;_primary_term&quot; : 1, &quot;found&quot; : true, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;name&quot; : &#123; &quot;firstname&quot; : &quot;ä¸‰&quot;, &quot;surname&quot; : &quot;å¼ &quot; &#125;, &quot;address&quot; : [ &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;ä¸­å…³æ‘29å·&quot; ], &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125; &#125;&#125;æ›´å¤šé˜…è¯»è¯·å‚é˜…â€œMapping parameters: doc_valuesâ€(https://www.elastic.co/guide/en/elasticsearch/reference/7.4/doc-values.html)ã€‚]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearchï¼šIndexç”Ÿå‘½å‘¨æœŸç®¡ç†å…¥é—¨]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%EF%BC%9AIndex%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E7%AE%A1%E7%90%86%E5%85%A5%E9%97%A8%2F</url>
    <content type="text"><![CDATA[å¦‚æžœæ‚¨è¦å¤„ç†æ—¶é—´åºåˆ—æ•°æ®ï¼Œåˆ™ä¸æƒ³å°†æ‰€æœ‰å†…å®¹è¿žç»­è½¬å‚¨åˆ°å•ä¸ªç´¢å¼•ä¸­ã€‚ å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œæ‚¨å¯ä»¥å®šæœŸå°†æ•°æ®æ»šåŠ¨åˆ°æ–°ç´¢å¼•ï¼Œä»¥é˜²æ­¢æ•°æ®è¿‡å¤§è€Œåˆç¼“æ…¢åˆæ˜‚è´µã€‚ éšç€ç´¢å¼•çš„è€åŒ–å’ŒæŸ¥è¯¢é¢‘çŽ‡çš„é™ä½Žï¼Œæ‚¨å¯èƒ½ä¼šå°†å…¶è½¬ç§»åˆ°ä»·æ ¼è¾ƒä½Žçš„ç¡¬ä»¶ä¸Šï¼Œå¹¶å‡å°‘åˆ†ç‰‡å’Œå‰¯æœ¬çš„æ•°é‡ã€‚è¦åœ¨ç´¢å¼•çš„ç”Ÿå‘½å‘¨æœŸå†…è‡ªåŠ¨ç§»åŠ¨ç´¢å¼•ï¼Œå¯ä»¥åˆ›å»ºç­–ç•¥æ¥å®šä¹‰éšç€ç´¢å¼•çš„è€åŒ–å¯¹ç´¢å¼•æ‰§è¡Œçš„æ“ä½œã€‚ ç´¢å¼•ç”Ÿå‘½å‘¨æœŸç­–ç•¥åœ¨ä¸ŽBeatsæ•°æ®å‘ä»¶äººä¸€èµ·ä½¿ç”¨æ—¶ç‰¹åˆ«æœ‰ç”¨ï¼ŒBeatsæ•°æ®å‘ä»¶äººä¸æ–­å°†è¿è¥æ•°æ®ï¼ˆä¾‹å¦‚æŒ‡æ ‡å’Œæ—¥å¿—ï¼‰å‘é€åˆ°Elasticsearchã€‚ å½“çŽ°æœ‰ç´¢å¼•è¾¾åˆ°æŒ‡å®šçš„å¤§å°æˆ–æœŸé™æ—¶ï¼Œæ‚¨å¯ä»¥è‡ªåŠ¨æ»šåŠ¨åˆ°æ–°ç´¢å¼•ã€‚ è¿™æ ·å¯ä»¥ç¡®ä¿æ‰€æœ‰ç´¢å¼•å…·æœ‰ç›¸ä¼¼çš„å¤§å°ï¼Œè€Œä¸æ˜¯æ¯æ—¥ç´¢å¼•ï¼Œå…¶å¤§å°å¯ä»¥æ ¹beatsæ•°å’Œå‘é€çš„äº‹ä»¶æ•°è€Œæœ‰æ‰€ä¸åŒã€‚è®©æˆ‘ä»¬é€šè¿‡åŠ¨æ‰‹æ“ä½œåœºæ™¯è·³å…¥ç´¢å¼•ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ˆIndex cycle management: ILMï¼‰ã€‚ æœ¬æ–‡ç« å°†åˆ©ç”¨æ‚¨å¯èƒ½ä¸ç†Ÿæ‚‰çš„ILMç‹¬æœ‰çš„è®¸å¤šæ–°æ¦‚å¿µã€‚ æˆ‘ä»¬å…ˆç”¨ä¸€ä¸ªç¤ºä¾‹æ¥å±•ç¤ºã€‚æœ¬ç¤ºä¾‹çš„ç›®æ ‡æ˜¯å»ºç«‹ä¸€ç»„ç´¢å¼•ï¼Œè¿™äº›ç´¢å¼•å°†å°è£…æ¥è‡ªæ—¶é—´åºåˆ—æ•°æ®æºçš„æ•°æ®ã€‚ æˆ‘ä»¬å¯ä»¥æƒ³è±¡æœ‰ä¸€ä¸ªåƒFilebeatè¿™æ ·çš„ç³»ç»Ÿï¼Œå¯ä»¥å°†æ–‡æ¡£è¿žç»­ç´¢å¼•åˆ°æˆ‘ä»¬çš„ä¹¦å†™ç´¢å¼•ä¸­ã€‚ æˆ‘ä»¬å¸Œæœ›åœ¨ç´¢å¼•è¾¾åˆ°50 GBï¼Œæˆ–æ–‡æ¡£çš„æ•°é‡è¶…è¿‡10000ï¼Œæˆ–å·²åœ¨30å¤©å‰åˆ›å»ºç´¢å¼•åŽå¯¹å…¶è¿›è¡Œrolloverï¼Œç„¶åŽåœ¨90å¤©åŽåˆ é™¤è¯¥ç´¢å¼•ã€‚ä¸Šå›¾æ˜¾ç¤ºä¸€ä¸ªLogæ–‡æ¡£åœ¨Elasticsearchä¸­ç”Ÿå‘½å‘¨æœŸã€‚è¿è¡Œä¸¤ä¸ªnodeçš„Elasticsearché›†ç¾¤æˆ‘ä»¬å¯ä»¥å‚è€ƒæ–‡ç« â€œElasticsearchï¼šè¿ç”¨shard filteringæ¥æŽ§åˆ¶ç´¢å¼•åˆ†é…ç»™å“ªä¸ªèŠ‚ç‚¹â€è¿è¡Œèµ·æ¥ä¸¤ä¸ªnodeçš„clusterã€‚å…¶å®žéžå¸¸ç®€å•ï¼Œå½“æˆ‘ä»¬å®‰è£…å¥½ElasticsearchåŽï¼Œæ‰“å¼€ä¸€ä¸ªterminalï¼Œå¹¶è¿è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼š1./bin/elasticsearch -E node.name=node1 -E node.attr.data=hot -Enode.max_local_storage_nodes=2å®ƒå°†è¿è¡Œèµ·æ¥ä¸€ä¸ªå«åšnode1çš„èŠ‚ç‚¹ã€‚åŒæ—¶åœ¨å¦å¤–terminalä¸­è¿è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼š1./bin/elasticsearch -E node.name=node2 -E node.attr.data=warm -Enode.max_local_storage_nodes=2å®ƒè¿è¡Œå¦å¤–ä¸€ä¸ªå«åšnode2çš„èŠ‚ç‚¹ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥è¿›è¡ŒæŸ¥çœ‹ï¼š1GET _cat/nodes?væ˜¾ç¤ºä¸¤ä¸ªèŠ‚ç‚¹ï¼šæˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹çš„å‘½ä»¤æ¥æ£€æŸ¥è¿™ä¸¤ä¸ªnodeçš„å±žæ€§ï¼š1GET _cat/nodeattrs?v&amp;s=nameæ˜¾ç„¶å…¶ä¸­çš„ä¸€ä¸ªnodeæ˜¯hotï¼Œå¦å¤–ä¸€ä¸ªæ˜¯warmã€‚å‡†å¤‡æ•°æ®è¿è¡Œèµ·æ¥æˆ‘ä»¬çš„Kibana:æˆ‘ä»¬åˆ†åˆ«ç‚¹å‡»ä¸Šé¢çš„1å’Œ2å¤„ï¼šç‚¹å‡»ä¸Šé¢çš„â€œAdd dataâ€ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŠŠæˆ‘ä»¬çš„kibana_sample_data_logsç´¢å¼•åŠ è½½åˆ°Elasticsearchä¸­ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤è¿›è¡ŒæŸ¥çœ‹ï¼š1GET _cat/indices/kibana_sample_data_logså‘½ä»¤æ˜¾ç¤ºç»“æžœä¸ºï¼šå®ƒæ˜¾ç¤ºkibana_sample_data_logså…·æœ‰11.1Mçš„æ•°æ®ï¼Œå¹¶ä¸”å®ƒæœ‰14074ä¸ªæ–‡æ¡£ã€‚å»ºç«‹ILM policyæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹æ³•æ¥å»ºç«‹ä¸€ä¸ªILMçš„policy.123456789101112131415161718192021222324252627PUT _ilm/policy/logs_policy&#123; &quot;policy&quot;: &#123; &quot;phases&quot;: &#123; &quot;hot&quot;: &#123; &quot;min_age&quot;: &quot;0ms&quot;, &quot;actions&quot;: &#123; &quot;rollover&quot;: &#123; &quot;max_size&quot;: &quot;50gb&quot;, &quot;max_age&quot;: &quot;30d&quot;, &quot;max_docs&quot;: 10000 &#125;, &quot;set_priority&quot;: &#123; &quot;priority&quot;: 100 &#125; &#125; &#125;, &quot;delete&quot;: &#123; &quot;min_age&quot;: &quot;90d&quot;, &quot;actions&quot;: &#123; &quot;delete&quot;: &#123;&#125; &#125; &#125; &#125; &#125;&#125;è¿™é‡Œå®šä¹‰çš„ä¸€ä¸ªpolicyæ„æ€æ˜¯ï¼šå¦‚æžœä¸€ä¸ªindexçš„å¤§å°è¶…è¿‡50GBï¼Œé‚£ä¹ˆè‡ªåŠ¨rolloverå¦‚æžœä¸€ä¸ªindexæ—¥æœŸå·²åœ¨30å¤©å‰åˆ›å»ºç´¢å¼•åŽï¼Œé‚£ä¹ˆè‡ªåŠ¨rolloverå¦‚æžœä¸€ä¸ªindexçš„æ–‡æ¡£æ•°è¶…è¿‡10000ï¼Œé‚£ä¹ˆä¹Ÿä¼šè‡ªåŠ¨rolloverå½“ä¸€ä¸ªindexåˆ›å»ºçš„æ—¶é—´è¶…è¿‡90å¤©ï¼Œé‚£ä¹ˆä¹Ÿè‡ªåŠ¨åˆ é™¤å…¶å®žè¿™ä¸ªæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡Kibanaå¸®æˆ‘ä»¬æ¥å®žçŽ°ã€‚è¯·æŒ‰ç…§å¦‚ä¸‹çš„æ­¥éª¤ï¼šç´§æŽ¥ç€ç‚¹å‡»â€œIndex Lifecycle Policiesâ€ï¼šå†ç‚¹å‡»â€œCreate Policyâ€:æœ€åŽç‚¹â€œSave as new Policyâ€åŠå¯ä»¥åœ¨æˆ‘ä»¬çš„Kibanaä¸­åŒè¿‡å¦‚ä¸‹çš„å‘½ä»¤å¯ä»¥æŸ¥çœ‹åˆ°ï¼š1GET _ilm/policy/logs_policyæ˜¾ç¤ºç»“æžœï¼šè®¾ç½®Index templateæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹æ³•æ¥å»ºç«‹template:1234567891011PUT _template/datastream_template&#123; &quot;index_patterns&quot;: [&quot;logs*&quot;], &quot;settings&quot;: &#123; &quot;number_of_shards&quot;: 1, &quot;number_of_replicas&quot;: 1, &quot;index.lifecycle.name&quot;: &quot;logs_policy&quot;, &quot;index.routing.allocation.require.data&quot;: &quot;hot&quot;, &quot;index.lifecycle.rollover_alias&quot;: &quot;logs&quot; &#125;&#125;è¿™é‡Œçš„æ„æ€æ˜¯æ‰€æœ‰ä»¥logså¼€å¤´çš„indexéƒ½éœ€è¦éµå¾ªè¿™ä¸ªè§„å¾‹ã€‚è¿™é‡Œå®šä¹‰äº†rolloverçš„aliasä¸ºâ€œlogs â€ã€‚è¿™åœ¨æˆ‘ä»¬ä¸‹é¢æ¥å®šä¹‰ã€‚åŒæ—¶ä¹Ÿéœ€è¦æ³¨æ„çš„æ˜¯â€index.routing.allocation.require.dataâ€: â€œhotâ€ã€‚è¿™ä¸ªå®šä¹‰äº†æˆ‘ä»¬éœ€è¦indexingçš„nodeçš„å±žæ€§æ˜¯hotã€‚è¯·çœ‹ä¸€ä¸‹æˆ‘ä»¬ä¸Šé¢çš„policyé‡Œå®šä¹‰çš„æœ‰ä¸€ä¸ªå«åšphasesé‡Œçš„ï¼Œå®ƒå®šä¹‰çš„æ˜¯â€hotâ€ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬æŠŠæ‰€æœ‰çš„logs*ç´¢å¼•éƒ½ç½®äºŽhotå±žæ€§çš„nodeé‡Œã€‚åœ¨å®žé™…çš„ä½¿ç”¨ä¸­ï¼Œhotå±žæ€§çš„indexä¸€èˆ¬ç”¨ä½œindexingã€‚æˆ‘ä»¬å…¶å®žè¿˜å¯ä»¥å®šä¹‰ä¸€äº›å…¶å®ƒphaseï¼Œæ¯”å¦‚warmï¼Œè¿™æ ·å¯ä»¥æŠŠæˆ‘ä»¬çš„ç”¨ä½œæœç´¢çš„indexç½®äºŽwarmçš„èŠ‚ç‚¹ä¸­ã€‚è¿™é‡Œå°±ä¸ä¸€ä¸€æè¿°äº†ã€‚å®šä¹‰Index aliasæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹æ³•æ¥å®šä¹‰ï¼š12345678PUT logs-000001&#123; &quot;aliases&quot;: &#123; &quot;logs&quot;: &#123; &quot;is_write_index&quot;: true &#125; &#125;&#125;åœ¨è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªå«åšlogsçš„aliasï¼Œå®ƒæŒ‡å‘logs-00001ç´¢å¼•ã€‚æ³¨æ„è¿™é‡Œçš„is_write_indexä¸ºtrueã€‚å¦‚æžœæœ‰rolloverå‘ç”Ÿæ—¶ï¼Œè¿™ä¸ªaliasä¼šè‡ªåŠ¨æŒ‡å‘æœ€æ–°rolloverçš„indexã€‚ç”Ÿäº§æ•°æ®åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ä¹‹å‰æˆ‘ä»¬å·²ç»å¯¼å…¥çš„æµ‹è¯•æ•°æ®kibana_sample_data_logsï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹æ³•æ¥å†™å…¥æ•°æ®ï¼š123456789POST _reindex?requests_per_second=500&#123; &quot;source&quot;: &#123; &quot;index&quot;: &quot;kibana_sample_data_logs&quot; &#125;, &quot;dest&quot;: &#123; &quot;index&quot;: &quot;logs&quot; &#125;&#125;ä¸Šé¢çš„æ„æ€æ˜¯æ¯ç§’æŒ‰ç…§500ä¸ªæ–‡æ¡£ä»Žkibana_sample_data_logsç´¢å¼•reindexæ–‡æ¡£åˆ°logsåˆ«åæ‰€æŒ‡å‘çš„indexã€‚æˆ‘ä»¬è¿è¡ŒåŽï¼Œé€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥æŸ¥çœ‹æœ€åŽçš„ç»“æžœï¼š1GET logs*/_countæ˜¾ç¤ºå¦‚ä¸‹ï¼šæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰14074ä¸ªæ–‡æ¡£è¢«reindexåˆ°logs*ç´¢å¼•ä¸­ã€‚é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥æŸ¥çœ‹ï¼š1GET _cat/shards/logs*æˆ‘ä»¬å¯ä»¥çœ‹åˆ°logs-000002å·²ç»ç”Ÿäº§ï¼Œå¹¶ä¸”æ‰€æœ‰çš„ç´¢å¼•éƒ½åœ¨node1ä¸Šé¢ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤ï¼š1GET _cat/indices/logs?væˆ‘ä»¬å¯ä»¥çœ‹åˆ°logs-000001ç´¢å¼•ä¸­æœ‰10000ä¸ªæ–‡æ¡£ï¼Œè€Œlogs-000002ä¸­å«æœ‰4074ä¸ªæ–‡æ¡£ã€‚ç”±äºŽæˆ‘ä»¬å·²ç»è®¾å®šäº†policyï¼Œé‚£ä¹ˆæ‰€æœ‰çš„è¿™äº›logs*ç´¢å¼•çš„ç”Ÿå‘½å‘¨æœŸåªæœ‰90å¤©ã€‚90å¤©è¿‡åŽï¼ˆä»Žç´¢å¼•è¢«åˆ›å»ºæ—¶ç®—èµ·ï¼‰ï¼Œç´¢å¼•ä¼šè‡ªåŠ¨è¢«åˆ é™¤æŽ‰ã€‚]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearchï¼šhanlp ä¸­æ–‡åˆ†è¯å™¨]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%EF%BC%9Ahanlp%20%E4%B8%AD%E6%96%87%E5%88%86%E8%AF%8D%E5%99%A8%2F</url>
    <content type="text"><![CDATA[HanLP ä¸­æ–‡åˆ†è¯å™¨æ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†è¯å™¨ï¼Œæ˜¯ä¸“ä¸ºElasticsearchè€Œè®¾è®¡çš„ã€‚å®ƒæ˜¯åŸºäºŽHanLPï¼Œå¹¶æä¾›äº†HanLPä¸­å¤§éƒ¨åˆ†çš„åˆ†è¯æ–¹å¼ã€‚å®ƒçš„æºç ä½äºŽï¼šhttps://github.com/KennFalcon/elasticsearch-analysis-hanlä»ŽElasticsearch 5.2.2å¼€å§‹ï¼Œä¸€ç›´æœ‰è·ŸéšElasticsearchçš„ä¸åŒå‘è¡Œç‰ˆè€Œæ›´æ–°ã€‚å®‰è£…1ï¼‰ æ–¹å¼ä¸€ï¼ša. ä¸‹è½½å¯¹åº”çš„releaseå®‰è£…åŒ…ï¼Œæœ€æ–°releaseåŒ…å¯ä»Žbaiduç›˜ä¸‹è½½ï¼ˆé“¾æŽ¥:https://pan.baidu.com/s/1mFPNJXgiTPzZeqEjH_zifw å¯†ç :i0o7ï¼‰b. æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å®‰è£…ï¼Œå…¶ä¸­PATHä¸ºæ’ä»¶åŒ…ç»å¯¹è·¯å¾„ï¼š1./bin/elasticsearch-plugin install file://$&#123;PATH&#125;2ï¼‰æ–¹å¼äºŒï¼ša. ä½¿ç”¨elasticsearchæ’ä»¶è„šæœ¬å®‰è£…commandå¦‚ä¸‹ï¼š1./bin/elasticsearch-plugin install https://github.com/KennFalcon/elasticsearch-analysis-hanlp/releases/download/v7.4.2/elasticsearch-analysis-hanlp-7.4.2.zipå®‰è£…å®ŒåŽï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æ–¹å¼æ¥éªŒè¯æˆ‘ä»¬çš„å®‰è£…æ˜¯å¦æˆåŠŸï¼š12$ ./bin/elasticsearch-plugin listanalysis-hanlpå¦‚æžœæˆ‘ä»¬å®‰è£…æ—¶æˆåŠŸçš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„è¾“å‡ºã€‚å®‰è£…æ•°æ®åŒ…releaseåŒ…ä¸­å­˜æ”¾çš„ä¸ºHanLPæºç ä¸­é»˜è®¤çš„åˆ†è¯æ•°æ®ï¼Œè‹¥è¦ä¸‹è½½å®Œæ•´ç‰ˆæ•°æ®åŒ…ï¼Œè¯·æŸ¥çœ‹HanLP Releaseã€‚æ•°æ®åŒ…ç›®å½•ï¼šES_HOME/plugins/analysis-hanlpæ³¨ï¼šå› åŽŸç‰ˆæ•°æ®åŒ…è‡ªå®šä¹‰è¯å…¸éƒ¨åˆ†æ–‡ä»¶åä¸ºä¸­æ–‡ï¼Œè¿™é‡Œçš„hanlp.propertiesä¸­å·²ä¿®æ”¹ä¸ºè‹±æ–‡ï¼Œè¯·å¯¹åº”ä¿®æ”¹æ–‡ä»¶åé‡å¯Elasticsearchæ³¨ï¼šä¸Šè¿°è¯´æ˜Žä¸­çš„ES_HOMEä¸ºè‡ªå·±çš„ESå®‰è£…è·¯å¾„ï¼Œéœ€è¦ç»å¯¹è·¯å¾„ã€‚è¿™ä¸€æ­¥éžå¸¸é‡è¦ã€‚å¦‚æžœæˆ‘ä»¬ä¸é‡æ–°å¯åŠ¨ï¼Œæ–°å®‰è£…çš„åˆ†è¯å™¨å°†ä¸ä¼šå·¥ä½œã€‚çƒ­æ›´æ–°åœ¨æœ¬ç‰ˆæœ¬ä¸­ï¼Œå¢žåŠ äº†è¯å…¸çƒ­æ›´æ–°ï¼Œä¿®æ”¹æ­¥éª¤å¦‚ä¸‹ï¼ša. åœ¨ES_HOME/plugins/analysis-hanlp/data/dictionary/customç›®å½•ä¸­æ–°å¢žè‡ªå®šä¹‰è¯å…¸b. ä¿®æ”¹hanlp.propertiesï¼Œä¿®æ”¹CustomDictionaryPathï¼Œå¢žåŠ è‡ªå®šä¹‰è¯å…¸é…ç½®c. ç­‰å¾…1åˆ†é’ŸåŽï¼Œè¯å…¸è‡ªåŠ¨åŠ è½½æ³¨ï¼šæ¯ä¸ªèŠ‚ç‚¹éƒ½éœ€è¦åšä¸Šè¿°æ›´æ”¹æä¾›çš„åˆ†è¯æ–¹å¼è¯´æ˜Žhanlp: hanlpé»˜è®¤åˆ†è¯hanlp_standard: æ ‡å‡†åˆ†è¯hanlp_index: ç´¢å¼•åˆ†è¯hanlp_nlp: NLPåˆ†è¯hanlp_n_short: N-æœ€çŸ­è·¯åˆ†è¯hanlp_dijkstra: æœ€çŸ­è·¯åˆ†è¯hanlp_crf: CRFåˆ†è¯ï¼ˆå·²æœ‰æœ€æ–°æ–¹å¼ï¼‰hanlp_speed: æžé€Ÿè¯å…¸åˆ†è¯æˆ‘ä»¬æ¥åšä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š12345GET _analyze&#123; &quot;text&quot;: &quot;ç¾Žå›½é˜¿æ‹‰æ–¯åŠ å·žå‘ç”Ÿ8.0çº§åœ°éœ‡&quot;, &quot;tokenizer&quot;: &quot;hanlp&quot;&#125;é‚£ä¹ˆæ˜¾ç¤ºçš„ç»“æžœä¸ºï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546&#123; &quot;tokens&quot; : [ &#123; &quot;token&quot; : &quot;ç¾Žå›½&quot;, &quot;start_offset&quot; : 0, &quot;end_offset&quot; : 2, &quot;type&quot; : &quot;nsf&quot;, &quot;position&quot; : 0 &#125;, &#123; &quot;token&quot; : &quot;é˜¿æ‹‰æ–¯åŠ å·ž&quot;, &quot;start_offset&quot; : 2, &quot;end_offset&quot; : 7, &quot;type&quot; : &quot;nsf&quot;, &quot;position&quot; : 1 &#125;, &#123; &quot;token&quot; : &quot;å‘ç”Ÿ&quot;, &quot;start_offset&quot; : 7, &quot;end_offset&quot; : 9, &quot;type&quot; : &quot;v&quot;, &quot;position&quot; : 2 &#125;, &#123; &quot;token&quot; : &quot;8.0&quot;, &quot;start_offset&quot; : 9, &quot;end_offset&quot; : 12, &quot;type&quot; : &quot;m&quot;, &quot;position&quot; : 3 &#125;, &#123; &quot;token&quot; : &quot;çº§&quot;, &quot;start_offset&quot; : 12, &quot;end_offset&quot; : 13, &quot;type&quot; : &quot;q&quot;, &quot;position&quot; : 4 &#125;, &#123; &quot;token&quot; : &quot;åœ°éœ‡&quot;, &quot;start_offset&quot; : 13, &quot;end_offset&quot; : 15, &quot;type&quot; : &quot;n&quot;, &quot;position&quot; : 5 &#125; ]&#125;æ›´å¤šè¯¦ç»†é˜…è¯»ï¼Œè¯·å‚é˜…é“¾æŽ¥https://github.com/KennFalcon/elasticsearch-analysis-hanlp]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearchï¼šfielddata ä»‹ç»]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%EF%BC%9Afielddata%20%E4%BB%8B%E7%BB%8D%2F</url>
    <content type="text"><![CDATA[é»˜è®¤æƒ…å†µä¸‹ï¼Œå¤§å¤šæ•°å­—æ®µéƒ½å·²ç¼–å…¥ç´¢å¼•ï¼Œè¿™ä½¿å®ƒä»¬å¯æœç´¢ã€‚ ä½†æ˜¯ï¼Œè„šæœ¬ä¸­çš„æŽ’åºï¼Œèšåˆå’Œè®¿é—®å­—æ®µå€¼éœ€è¦ä¸Žæœç´¢ä¸åŒçš„è®¿é—®æ¨¡å¼ã€‚æœç´¢éœ€è¦å›žç­”â€œå“ªä¸ªæ–‡æ¡£åŒ…å«è¯¥æœ¯è¯­ï¼Ÿâ€è¿™ä¸ªé—®é¢˜ï¼Œè€ŒæŽ’åºå’Œæ±‡æ€»åˆ™éœ€è¦å›žç­”ä¸€ä¸ªä¸åŒçš„é—®é¢˜ï¼šâ€œæ­¤å­—æ®µå¯¹è¯¥æ–‡æ¡£çš„å€¼æ˜¯ä»€ä¹ˆï¼Ÿâ€ã€‚å¤§å¤šæ•°å­—æ®µå¯ä»¥å°†ç´¢å¼•æ—¶ç”Ÿäº§çš„ç£ç›˜doc_values(https://www.elastic.co/guide/en/elasticsearch/reference/current/doc-values.html)ç”¨äºŽæ­¤æ•°æ®è®¿é—®æ¨¡å¼ï¼Œä½†æ˜¯æ–‡æœ¬ï¼ˆtextï¼‰å­—æ®µä¸æ”¯æŒdoc_valuesã€‚æ›¿ä»£çš„æ–¹æ¡ˆï¼Œæ–‡æœ¬ï¼ˆtextï¼‰å­—æ®µä½¿ç”¨æŸ¥è¯¢æ—¶å†…å­˜ä¸­çš„æ•°æ®ç»“æž„ï¼Œç§°ä¸ºfielddataã€‚ å½“æˆ‘ä»¬é¦–æ¬¡å°†è¯¥å­—æ®µç”¨äºŽèšåˆï¼ŒæŽ’åºæˆ–åœ¨è„šæœ¬ä¸­ä½¿ç”¨æ—¶ï¼Œå°†æŒ‰éœ€æž„å»ºæ­¤æ•°æ®ç»“æž„ã€‚ å®ƒæ˜¯é€šè¿‡ä»Žç£ç›˜è¯»å–æ¯ä¸ªæ®µçš„æ•´ä¸ªåå‘ç´¢å¼•ï¼Œåè½¬æœ¯è¯­â†”ï¸Žæ–‡æ¡£å…³ç³»å¹¶å°†ç»“æžœå­˜å‚¨åœ¨JVMå †ä¸­çš„å†…å­˜ä¸­æ¥æž„å»ºçš„ã€‚Fielddataé’ˆå¯¹textå­—æ®µåœ¨é»˜è®¤æ—¶æ˜¯ç¦ç”¨çš„Fielddataä¼šå ç”¨å¤§é‡å †ç©ºé—´ï¼Œå°¤å…¶æ˜¯åœ¨åŠ è½½å¤§é‡çš„æ–‡æœ¬å­—æ®µæ—¶ã€‚ ä¸€æ—¦å°†å­—æ®µæ•°æ®åŠ è½½åˆ°å †ä¸­ï¼Œå®ƒåœ¨è¯¥æ®µçš„ç”Ÿå‘½å‘¨æœŸå†…å°†ä¸€ç›´ä¿ç•™åœ¨é‚£é‡Œã€‚ åŒæ ·ï¼ŒåŠ è½½å­—æ®µæ•°æ®æ˜¯ä¸€ä¸ªæ˜‚è´µçš„è¿‡ç¨‹ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·é‡åˆ°å»¶è¿Ÿçš„æƒ…å†µã€‚ è¿™å°±æ˜¯é»˜è®¤æƒ…å†µä¸‹ç¦ç”¨å­—æ®µæ•°æ®çš„åŽŸå› ã€‚å‡å¦‚æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¦‚ä¸‹çš„myindexçš„ç´¢å¼•ï¼š123456789101112131415PUT myindex&#123; &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;address&quot;: &#123; &quot;type&quot;: &quot;text&quot; &#125; &#125; &#125;&#125; PUT myindex/_doc/1&#123; &quot;address&quot;: &quot;New York&quot; &#125;å¦‚æžœæ‚¨å°è¯•å¯¹æ–‡æœ¬å­—æ®µä¸­çš„è„šæœ¬è¿›è¡ŒæŽ’åºï¼Œæ±‡æ€»æˆ–è®¿é—®å€¼:123456789101112GET myindex/_search&#123; &quot;size&quot;: 20, &quot;aggs&quot;: &#123; &quot;aggr_mame&quot;: &#123; &quot;terms&quot;: &#123; &quot;field&quot;: &quot;address&quot;, &quot;size&quot;: 5 &#125; &#125; &#125;&#125;åˆ™ä¼šçœ‹åˆ°ä»¥ä¸‹å¼‚å¸¸ï¼šæ˜¾ç„¶ï¼Œæˆ‘ä»¬ä¸èƒ½å¯¹textå­—æ®µè¿›è¡Œèšåˆå¤„ç†ã€‚é‚£ä¹ˆæˆ‘ä»¬è¯¥å¦‚ä½•å¤„ç†è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿæˆ‘ä»¬çš„ä¸€ç§æ–¹æ³•å°±æ˜¯åœ¨é…ç½®mappingçš„æ—¶å€™åŠ å…¥â€fielddataâ€=trueè¿™ä¸ªé€‰é¡¹ã€‚æˆ‘ä»¬æ¥é‡æ–°å¯¹æˆ‘ä»¬çš„myindexçš„mappingè¿›è¡Œé…ç½®ï¼š12345678910111213141516171819202122232425262728293031DELETE myindex PUT myindex&#123; &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;address&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fielddata&quot;: true &#125; &#125; &#125;&#125; PUT myindex/_doc/1&#123; &quot;address&quot;: &quot;New York&quot; &#125; GET myindex/_search&#123; &quot;size&quot;: 0, &quot;aggs&quot;: &#123; &quot;aggr_mame&quot;: &#123; &quot;terms&quot;: &#123; &quot;field&quot;: &quot;address&quot;, &quot;size&quot;: 5 &#125; &#125; &#125;&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°½ç®¡è¿˜æ˜¯æŠŠaddressè¿™ä¸ªå­—æ®µè®¾ç½®ä¸ºtextï¼Œä½†æ˜¯ç”±äºŽæˆ‘ä»¬åŠ å…¥äº†â€fielddataâ€=trueï¼Œé‚£ä¹ˆæˆ‘ä»¬ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹è¿™ä¸ªé¡¹è¿›è¡Œç»Ÿè®¡äº†ã€‚ä¸Žç®€å•çš„æœç´¢æ“ä½œä¸åŒï¼ŒæŽ’åºå’Œèšåˆéœ€è¦èƒ½å¤Ÿå‘çŽ°åœ¨ç‰¹å®šæ–‡æ¡£çš„ç‰¹å®šå­—æ®µä¸­å¯ä»¥æ‰¾åˆ°å“ªäº›æœ¯è¯­ã€‚ å¯¹äºŽè¿™äº›ä»»åŠ¡å’Œå…¶ä»–ä»»åŠ¡ï¼Œå¿…é¡»å…·æœ‰ä¸ŽElasticsearchï¼ˆåå‘ï¼‰ç´¢å¼•ç›¸åçš„æ•°æ®ç»“æž„ã€‚ è¿™å°±æ˜¯fielddataçš„ç›®çš„ã€‚ç»†å¿ƒçš„å¼€å‘è€…ï¼Œå¦‚æžœè¿™ä¸ªæ—¶å€™åŽ»Kibanaåˆ›å»ºä¸€ä¸ªä»¥myindexä¸ºç´¢å¼•çš„index patternï¼Œæˆ‘ä»¬å¯ä»¥å‘çŽ°ï¼šæˆ‘ä»¬çš„addresså­—æ®µå˜ä¸ºaggregatableï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥å¯¹å®ƒè¿›è¡Œåšèšåˆåˆ†æžå°½ç®¡å®ƒæ²¡æœ‰doc_valuesã€‚åœ¨å¯åŠ¨fielddataä¹‹å‰åœ¨å¯ç”¨fielddataä¹‹å‰ï¼Œè¯·è€ƒè™‘ä¸ºä»€ä¹ˆå°†æ–‡æœ¬å­—æ®µç”¨äºŽèšåˆï¼ŒæŽ’åºæˆ–åœ¨è„šæœ¬ä¸­ä½¿ç”¨ã€‚ è¿™æ ·åšé€šå¸¸æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚åœ¨ç´¢å¼•ä¹‹å‰ä¼šåˆ†æžæ–‡æœ¬å­—æ®µï¼Œä»¥ä¾¿å¯ä»¥é€šè¿‡æœç´¢newæˆ–yorkæ¥æ‰¾åˆ°ç±»ä¼¼New Yorkçš„å€¼ã€‚ å½“æ‚¨å¯èƒ½æƒ³è¦ä¸€ä¸ªåä¸ºNew Yorkçš„å­˜å‚¨æ¡¶æ—¶ï¼Œæ­¤å­—æ®µä¸Šçš„æœ¯è¯­æ±‡æ€»å°†è¿”å›žä¸€ä¸ªå«åšnewå­˜å‚¨æ¡¶å’Œä¸€ä¸ªå«åšyorkå­˜å‚¨æ¡¶ã€‚ç›¸åï¼Œæ‚¨åº”è¯¥æœ‰ä¸€ä¸ªç”¨äºŽå…¨æ–‡æœç´¢çš„æ–‡æœ¬å­—æ®µï¼Œä»¥åŠä¸€ä¸ªä¸ºèšåˆå¯ç”¨doc_valuesçš„æœªåˆ†æžçš„keywordå­—æ®µï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š123456789101112131415161718DELETE myindex PUT myindex&#123; &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;address&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125; &#125; &#125;&#125;è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨addressæ¥åšå…¨æ–‡çš„æœç´¢ï¼Œè€Œaddress.keywordè¢«ç”¨æ¥åšaggregations, sorting åŠåœ¨è„šæœ¬ä¸­ä½¿ç”¨ã€‚å‚è€ƒï¼šã€1ã€‘https://www.elastic.co/guide/en/elasticsearch/reference/current/fielddata.htmlã€2ã€‘https://qbox.io/blog/field-data-elasticsearch-cluster-instability]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearchï¼šElasticsearchä¸­çš„refreshå’Œflushæ“ä½œæŒ‡å—]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%EF%BC%9AElasticsearch%E4%B8%AD%E7%9A%84refresh%E5%92%8Cflush%E6%93%8D%E4%BD%9C%E6%8C%87%E5%8D%97%2F</url>
    <content type="text"><![CDATA[åœ¨ä»Šå¤©çš„æ–‡ç« é‡Œï¼Œæˆ‘ä»¬æ¥ä¸»è¦ä»‹ç»ä¸€ä¸‹Elasticsearchçš„refreshåŠflushä¸¤ç§æ“ä½œçš„åŒºåˆ«ã€‚å¦‚æžœæˆ‘ä»¬ä»Žå­—é¢çš„æ„æ€ä¸Šè®²ï¼Œå¥½åƒéƒ½æ˜¯åˆ·æ–°çš„æ„æ€ã€‚ä½†æ˜¯åœ¨Elasticsearchä¸­ï¼Œè¿™ä¸¤ç§æ“ä½œæ˜¯æœ‰éžå¸¸å¤§çš„åŒºåˆ«çš„ã€‚æœ¬æŒ‡å—å°†æœ‰æ•ˆè§£å†³ä¸¤è€…ä¹‹é—´çš„å·®å¼‚ã€‚ æˆ‘ä»¬è¿˜å°†ä»‹ç»LuceneåŠŸèƒ½çš„åŸºç¡€çŸ¥è¯†ï¼Œä¾‹å¦‚é‡æ–°æ‰“å¼€ï¼ˆreopen)å’Œæäº¤(commit)ï¼Œè¿™æœ‰åŠ©äºŽç†è§£refreshå’Œflushæ“ä½œã€‚RefreshåŠFlushä¹ä¸€çœ‹ï¼ŒRefreshå’ŒFlushæ“ä½œçš„é€šç”¨ç›®çš„ä¼¼ä¹Žæ˜¯ç›¸åŒçš„ã€‚ ä¸¤è€…éƒ½ç”¨äºŽä½¿æ–‡æ¡£åœ¨ç´¢å¼•æ“ä½œåŽç«‹å³å¯ä¾›æœç´¢ã€‚ åœ¨Elasticsearchä¸­æ·»åŠ æ–°æ–‡æ¡£æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ç´¢å¼•è°ƒç”¨_refreshæˆ–_flushæ“ä½œï¼Œä»¥ä½¿æ–°æ–‡æ¡£å¯ç”¨äºŽæœç´¢ã€‚ è¦äº†è§£è¿™äº›æ“ä½œçš„å·¥ä½œæ–¹å¼ï¼Œæ‚¨å¿…é¡»ç†Ÿæ‚‰Luceneä¸­çš„Segmentsï¼ŒReopenå’ŒCommitsã€‚Apache Luceneæ˜¯Elasticsearchä¸­çš„åŸºç¡€æŸ¥è¯¢å¼•æ“Žã€‚Luceneä¸­çš„Segmentsåœ¨Elasticsearchä¸­ï¼Œæœ€åŸºæœ¬çš„æ•°æ®å­˜å‚¨å•ä½æ˜¯shardã€‚ ä½†æ˜¯ï¼Œé€šè¿‡Luceneé•œå¤´çœ‹ï¼Œæƒ…å†µä¼šæœ‰æ‰€ä¸åŒã€‚ åœ¨è¿™é‡Œï¼Œæ¯ä¸ªElasticsearchåˆ†ç‰‡éƒ½æ˜¯ä¸€ä¸ªLuceneç´¢å¼•(index)ï¼Œæ¯ä¸ªLuceneç´¢å¼•éƒ½åŒ…å«å‡ ä¸ªLucene segmentsã€‚ ä¸€ä¸ªSegmentåŒ…å«æ˜ å°„åˆ°æ–‡æ¡£é‡Œçš„æ‰€æœ‰æœ¯è¯­ï¼ˆterms)ä¸€ä¸ªåå‘ç´¢å¼•(inverted index)ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†æ®µçš„æ¦‚å¿µåŠå…¶å¦‚ä½•åº”ç”¨äºŽElasticsearchç´¢å¼•åŠå…¶åˆ†ç‰‡ï¼šè¿™ç§åˆ†Segmentçš„æ¦‚å¿µæ˜¯ï¼Œæ¯å½“åˆ›å»ºæ–°æ–‡æ¡£æ—¶ï¼Œå®ƒä»¬å°±ä¼šè¢«å†™å…¥æ–°çš„Segmentä¸­ã€‚ æ¯å½“åˆ›å»ºæ–°æ–‡æ¡£æ—¶ï¼Œå®ƒä»¬éƒ½å±žäºŽä¸€ä¸ªæ–°çš„Segmentï¼Œå¹¶ä¸”æ— éœ€ä¿®æ”¹å‰ä¸€ä¸ªSegmentã€‚ å¦‚æžœå¿…é¡»åˆ é™¤æ–‡æ¡£ï¼Œåˆ™åœ¨å…¶åŽŸå§‹Segmentä¸­å°†å…¶æ ‡è®°ä¸ºå·²åˆ é™¤ã€‚ è¿™æ„å‘³ç€å®ƒæ°¸è¿œä¸ä¼šä»ŽSegementä¸­ç‰©ç†åˆ é™¤ã€‚ä¸Žæ›´æ–°ç›¸åŒï¼šæ–‡æ¡£çš„å…ˆå‰ç‰ˆæœ¬åœ¨ä¸Šä¸€ä¸ªSegmentä¸­è¢«æ ‡è®°ä¸ºå·²åˆ é™¤ï¼Œæ›´æ–°åŽçš„ç‰ˆæœ¬ä¿ç•™åœ¨å½“å‰Segmentä¸­çš„åŒä¸€æ–‡æ¡£IDä¸‹ã€‚Luceneä¸­çš„Reopenå½“è°ƒç”¨Lucene Reopenæ—¶ï¼Œå°†ä½¿ç´¯ç§¯çš„æ•°æ®å¯ç”¨äºŽæœç´¢ã€‚ å°½ç®¡å¯ä»¥æœç´¢æœ€æ–°æ•°æ®ï¼Œä½†è¿™ä¸èƒ½ä¿è¯æ•°æ®çš„æŒä¹…æ€§æˆ–æœªå°†å…¶å†™å…¥ç£ç›˜ã€‚ æˆ‘ä»¬å¯ä»¥è°ƒç”¨næ¬¡é‡æ–°æ‰“å¼€åŠŸèƒ½ï¼Œå¹¶ä½¿æœ€æ–°æ•°æ®å¯æœç´¢ï¼Œä½†ä¸èƒ½ç¡®å®šç£ç›˜ä¸Šæ˜¯å¦å­˜åœ¨æ•°æ®ã€‚Luceneä¸­çš„CommitsLuceneæäº¤ä½¿æ•°æ®å®‰å…¨ã€‚ å¯¹äºŽæ¯æ¬¡æäº¤ï¼Œæ¥è‡ªä¸åŒæ®µçš„æ•°æ®å°†åˆå¹¶å¹¶æŽ¨é€åˆ°ç£ç›˜ï¼Œä»Žè€Œä½¿æ•°æ®æŒä¹…åŒ–ã€‚ å°½ç®¡æäº¤æ˜¯æŒä¹…ä¿å­˜æ•°æ®çš„ç†æƒ³æ–¹æ³•ï¼Œä½†é—®é¢˜æ˜¯æ¯ä¸ªæäº¤æ“ä½œéƒ½å ç”¨å¤§é‡èµ„æºã€‚ æ¯ä¸ªæäº¤æ“ä½œéƒ½æœ‰å…¶è‡ªå·±çš„å†…éƒ¨ I/O æ“ä½œä»¥åŠä¸Žå…¶ç›¸å…³çš„è¯»/å†™å‘¨æœŸã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å¸Œæœ›åœ¨åŸºäºŽLuceneçš„ç³»ç»Ÿä¸­ä¸€æ¬¡åˆä¸€æ¬¡åœ°é‡æ–°ä½¿ç”¨é‡æ–°æ‰“å¼€åŠŸèƒ½ä»¥ä½¿æ–°æ•°æ®å¯æœç´¢çš„ç¡®åˆ‡åŽŸå› ã€‚Elasticsearchä¸­çš„TranslogElasticsearché‡‡ç”¨å¦ä¸€ç§æ–¹æ³•æ¥è§£å†³æŒä¹…æ€§é—®é¢˜ã€‚ å®ƒåœ¨æ¯ä¸ªåˆ†ç‰‡ä¸­å¼•å…¥ä¸€ä¸ªäº‹åŠ¡æ—¥å¿—ï¼ˆtransaction logï¼‰ã€‚ å·²å»ºç«‹ç´¢å¼•çš„æ–°æ–‡æ¡£å°†ä¼ é€’åˆ°æ­¤äº‹åŠ¡æ—¥å¿—å’Œå†…å­˜ç¼“å†²åŒºä¸­ã€‚ ä¸‹å›¾æ˜¾ç¤ºäº†æ­¤è¿‡ç¨‹ï¼šElasticsearchä¸­çš„refreshå½“æˆ‘ä»¬æŠŠä¸€æ¡æ•°æ®å†™å…¥åˆ°Elasticsearchä¸­åŽï¼Œå®ƒå¹¶ä¸èƒ½é©¬ä¸Šè¢«ç”¨äºŽæœç´¢ã€‚æ–°å¢žçš„ç´¢å¼•å¿…é¡»å†™å…¥åˆ°SegmentåŽæ‰èƒ½è¢«æœç´¢åˆ°ï¼Œå› æ­¤æˆ‘ä»¬æŠŠæ•°æ®å†™å…¥åˆ°å†…å­˜ç¼“å†²åŒºä¹‹åŽå¹¶ä¸èƒ½è¢«æœç´¢åˆ°ã€‚æ–°å¢žäº†ä¸€æ¡è®°å½•æ—¶ï¼ŒElasticsearchä¼šæŠŠæ•°æ®å†™åˆ°translogå’Œin-memory buffer(å†…å­˜ç¼“å­˜åŒº)ä¸­,å¦‚ä¸‹å›¾æ‰€ç¤º:å¦‚æžœå¸Œæœ›è¯¥æ–‡æ¡£èƒ½ç«‹åˆ»è¢«æœç´¢ï¼Œéœ€è¦æ‰‹åŠ¨è°ƒç”¨refreshæ“ä½œã€‚åœ¨Elasticsearchä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹_refreshæ“ä½œè®¾ç½®ä¸ºæ¯ç§’æ‰§è¡Œä¸€æ¬¡ã€‚ åœ¨æ­¤æ“ä½œæœŸé—´ï¼Œå†…å­˜ä¸­ç¼“å†²åŒºçš„å†…å®¹å°†å¤åˆ¶åˆ°å†…å­˜ä¸­æ–°åˆ›å»ºçš„Segmentä¸­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ ç»“æžœï¼Œæ–°æ•°æ®å¯ç”¨äºŽæœç´¢ã€‚è¿™ä¸ªrefreshçš„æ—¶é—´é—´éš”å¯ä»¥ç”±indexè®¾ç½®ä¸­index.refresh_intervalæ¥å®šä¹‰ã€‚æ‰§è¡Œå®ŒrefreshåŽçš„ç»“æžœå¦‚ä¸‹ï¼šæˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ï¼Œåœ¨In-meomory bufferä¸­ï¼ŒçŽ°åœ¨æ‰€æœ‰çš„ä¸œè¥¿éƒ½æ˜¯ç©ºçš„ï¼Œä½†æ˜¯Translogé‡Œè¿˜æ˜¯æœ‰ä¸œè¥¿çš„ã€‚refreshçš„å¼€é”€æ¯”è¾ƒå¤§,æˆ‘åœ¨è‡ªå·±çŽ¯å¢ƒä¸Šæµ‹è¯•10Wæ¡è®°å½•çš„åœºæ™¯ä¸‹refreshä¸€æ¬¡å¤§æ¦‚è¦14ms,å› æ­¤åœ¨æ‰¹é‡æž„å»ºç´¢å¼•æ—¶å¯ä»¥æŠŠrefreshé—´éš”è®¾ç½®æˆ-1æ¥ä¸´æ—¶å…³é—­refresh,ç­‰åˆ°ç´¢å¼•éƒ½æäº¤å®Œæˆä¹‹åŽå†æ‰“å¼€refresh,å¯ä»¥é€šè¿‡å¦‚ä¸‹æŽ¥å£ä¿®æ”¹è¿™ä¸ªå‚æ•°:12345curl -XPUT &apos;localhost:9200/test/_settings&apos; -d &apos;&#123; &quot;index&quot; : &#123; &quot;refresh_interval&quot; : &quot;-1&quot; &#125;&#125;&apos;å¦å¤–å½“ä½ åœ¨åšæ‰¹é‡ç´¢å¼•æ—¶,å¯ä»¥è€ƒè™‘æŠŠå‰¯æœ¬æ•°è®¾ç½®æˆ0ï¼Œå› ä¸ºdocumentä»Žä¸»åˆ†ç‰‡(primary shard)å¤åˆ¶åˆ°ä»Žåˆ†ç‰‡(replica shard)æ—¶,ä»Žåˆ†ç‰‡ä¹Ÿè¦æ‰§è¡Œç›¸åŒçš„åˆ†æžã€ç´¢å¼•å’Œåˆå¹¶è¿‡ç¨‹,è¿™æ ·çš„å¼€é”€æ¯”è¾ƒå¤§ï¼Œä½ å¯ä»¥åœ¨æž„å»ºç´¢å¼•ä¹‹åŽå†å¼€å¯å‰¯æœ¬ï¼Œè¿™æ ·åªéœ€è¦æŠŠæ•°æ®ä»Žä¸»åˆ†ç‰‡æ‹·è´åˆ°ä»Žåˆ†ç‰‡:12345curl -XPUT &apos;localhost:9200/my_index/_settings&apos; -d &apos; &#123; &quot;index&quot; : &#123; &quot;number_of_replicas&quot; : 0 &#125;&#125;&apos;æ‰§è¡Œå®Œæ‰¹é‡ç´¢å¼•ä¹‹åŽ,æŠŠåˆ·æ–°é—´éš”æ”¹å›žæ¥:12345curl -XPUT &apos;localhost:9200/my_index/_settings&apos; -d &apos;&#123; &quot;index&quot; : &#123; &quot;refresh_interval&quot; : &quot;1s&quot; &#125; &#125;&apos;ä½ è¿˜å¯ä»¥å¼ºåˆ¶æ‰§è¡Œä¸€æ¬¡refreshä»¥åŠç´¢å¼•åˆ†æ®µçš„åˆå¹¶:12curl -XPOST &apos;localhost:9200/my_index/_refresh&apos;curl -XPOST &apos;localhost:9200/my_index/_forcemerge?max_num_segments=5&apos;TranslogåŠæŒä¹…åŒ–å­˜å‚¨ä½†æ˜¯ï¼Œtranslogå¦‚ä½•è§£å†³æŒä¹…æ€§é—®é¢˜ï¼Ÿ æ¯ä¸ªShardä¸­éƒ½å­˜åœ¨ä¸€ä¸ªtranslogï¼Œè¿™æ„å‘³ç€å®ƒä¸Žç‰©ç†ç£ç›˜å†…å­˜æœ‰å…³ã€‚ å®ƒæ˜¯åŒæ­¥ä¸”å®‰å…¨çš„ï¼Œå› æ­¤å³ä½¿å¯¹äºŽå°šæœªæäº¤çš„æ–‡æ¡£ï¼Œæ‚¨ä¹Ÿå¯ä»¥èŽ·å¾—æŒä¹…æ€§å’ŒæŒä¹…æ€§ã€‚ å¦‚æžœå‘ç”Ÿé—®é¢˜ï¼Œå¯ä»¥è¿˜åŽŸäº‹åŠ¡æ—¥å¿—ã€‚ åŒæ ·ï¼Œåœ¨æ¯ä¸ªè®¾ç½®çš„æ—¶é—´é—´éš”å†…ï¼Œæˆ–åœ¨æˆåŠŸå®Œæˆè¯·æ±‚ï¼ˆç´¢å¼•ï¼Œæ‰¹é‡ï¼Œåˆ é™¤æˆ–æ›´æ–°ï¼‰åŽï¼Œå°†äº‹åŠ¡æ—¥å¿—æäº¤åˆ°ç£ç›˜ã€‚Elasticsearchä¸­çš„FlushFlushå®žè´¨ä¸Šæ„å‘³ç€å°†å†…å­˜ç¼“å†²åŒºä¸­çš„æ‰€æœ‰æ–‡æ¡£éƒ½å†™å…¥æ–°çš„Lucene Segmentï¼Œå¦‚ä¸‹é¢çš„å›¾æ‰€ç¤ºã€‚ è¿™äº›è¿žåŒæ‰€æœ‰çŽ°æœ‰çš„å†…å­˜æ®µä¸€èµ·è¢«æäº¤åˆ°ç£ç›˜ï¼Œè¯¥ç£ç›˜æ¸…é™¤äº‹åŠ¡æ—¥å¿—ï¼ˆå‚è§å›¾4ï¼‰ã€‚ æ­¤æäº¤æœ¬è´¨ä¸Šæ˜¯Luceneæäº¤ï¼ˆcommitï¼‰ã€‚Flushä¼šå®šæœŸè§¦å‘ï¼Œä¹Ÿå¯ä»¥åœ¨Translogè¾¾åˆ°ç‰¹å®šå¤§å°æ—¶è§¦å‘ã€‚ è¿™äº›è®¾ç½®å¯ä»¥é˜²æ­¢Luceneæäº¤å¸¦æ¥çš„ä¸å¿…è¦çš„è´¹ç”¨ã€‚ç»“è®ºåœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘ä»¬æŽ¢ç´¢äº†ä¸¤ä¸ªç´§å¯†ç›¸å…³çš„Elasticsearchæ“ä½œï¼Œ_flushå’Œ_refreshæ˜¾ç¤ºäº†å®ƒä»¬ä¹‹é—´çš„å…±æ€§å’Œå·®å¼‚ã€‚ æˆ‘ä»¬è¿˜ä»‹ç»äº†Luceneçš„åŸºç¡€æž¶æž„ç»„ä»¶-é‡æ–°æ‰“å¼€ï¼ˆreopen)å¹¶æäº¤(commits)-è¿™æœ‰åŠ©äºŽæŽŒæ¡Elasticsearchä¸­_refreshå’Œ_flushæ“ä½œçš„è¦ç‚¹ã€‚ç®€è€Œè¨€ä¹‹ï¼Œ_refreshç”¨äºŽä½¿æ–°æ–‡æ¡£å¯è§ä»¥è¿›è¡Œæœç´¢ã€‚ è€Œ_flushç”¨äºŽå°†å†…å­˜ä¸­çš„æ®µä¿ç•™åœ¨ç¡¬ç›˜ä¸Šã€‚ _flushä¸ä¼šå½±å“Elasticsearchä¸­æ–‡æ¡£çš„å¯è§æ€§ï¼Œå› ä¸ºæœç´¢æ˜¯åœ¨å†…å­˜æ®µä¸­è¿›è¡Œçš„ï¼Œè€Œä¸æ˜¯_refreshä¼šå½±å“å…¶å¯è§æ€§ã€‚å‚è€ƒï¼šã€1ã€‘https://qbox.io/blog/refresh-flush-operations-elasticsearch-guideã€2ã€‘https://www.ezlippi.com/blog/2018/04/elasticsearch-translog.html]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearchï¼šDynamic mapping]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%EF%BC%9ADynamic%20mapping%2F</url>
    <content type="text"><![CDATA[Elasticsearchæœ€é‡è¦çš„åŠŸèƒ½ä¹‹ä¸€æ˜¯å®ƒè¯•å›¾æ‘†è„±ä½ çš„æ–¹å¼ï¼Œè®©ä½ å°½å¿«å¼€å§‹æŽ¢ç´¢ä½ çš„æ•°æ®ã€‚ è¦ç´¢å¼•æ–‡æ¡£ï¼Œæ‚¨ä¸å¿…é¦–å…ˆåˆ›å»ºç´¢å¼•ï¼Œå®šä¹‰æ˜ å°„ç±»åž‹å’Œå®šä¹‰å­—æ®µ - æ‚¨åªéœ€ç´¢å¼•æ–‡æ¡£ï¼Œé‚£ä¹ˆindexï¼Œtypeå’Œfieldå°†è‡ªåŠ¨ç”Ÿæ•ˆã€‚æ¯”å¦‚ï¼šPUT data/_doc/1 { &quot;count&quot;: 5 } ä¸Šé¢çš„å‘½ä»¤å°†è‡ªåŠ¨å¸®æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªå«åšdataçš„indexï¼Œå¹¶åŒæ—¶ç”Ÿæˆä¸€ä¸ªå«åš_docçš„typeåŠä¸€ä¸ªå«åšcountçš„fieldã€‚countçš„æ•°æ®ç±»åž‹æ˜¯longã€‚è¿™ä¸ªéžå¸¸æ–¹ä¾¿ï¼Œæˆ‘ä»¬ä¸æƒ³ä¼ ç»Ÿçš„RDMSé‚£æ ·ï¼Œå…ˆè¦åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ï¼Œè®©åŽä¸€ä¸ªtableï¼Œç„¶åŽæ‰å¯ä»¥å‘tableé‡Œå†™å…¥æ•°æ®ã€‚è‡ªåŠ¨æ£€æµ‹å’Œæ·»åŠ æ–°å­—æ®µç§°ä¸ºåŠ¨æ€æ˜ å°„ã€‚ åŠ¨æ€æ˜ å°„è§„åˆ™å¯ä»¥æ ¹æ®æ‚¨çš„ç›®çš„è¿›è¡Œå®šåˆ¶ï¼šåŠ¨æ€å­—æ®µæ˜ å°„ï¼šç®¡ç†åŠ¨æ€fieldæ£€æµ‹çš„è§„åˆ™åŠ¨æ€æ¨¡æ¿ï¼šç”¨äºŽé…ç½®åŠ¨æ€æ·»åŠ å­—æ®µçš„æ˜ å°„çš„è‡ªå®šä¹‰è§„åˆ™åœ¨ä»Šå¤©çš„è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æ¥åˆ†åˆ«ä»‹ç»è¿™ä¸¤ä¸ªæ–¹é¢çš„å†…å®¹ã€‚åŠ¨æ€æ¨¡æ¿å‡è®¾æ‚¨æœ‰åŒ…å«å¤§é‡å­—æ®µçš„æ–‡æ¡£æˆ–è€…åœ¨æ˜ å°„å®šä¹‰æ—¶æœªçŸ¥çš„åŠ¨æ€å­—æ®µåç§°çš„æ–‡æ¡£å’Œnestedçš„key/valueå¯¹ä¸æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆä½¿ç”¨åŠ¨æ€æ¨¡æ¿ï¼Œæ‚¨å¯ä»¥åŸºäºŽå®šä¹‰å­—æ®µçš„æ˜ å°„å­—æ®µçš„æ•°æ®ç±»åž‹, ä½¿ç”¨match_mapping_typeå­—æ®µçš„åå­—ï¼Œä½¿ç”¨match and unmatch æˆ–match_pattern.æˆ–è€…å­—æ®µçš„è·¯å¾„ï¼Œä½¿ç”¨path_match åŠ path_unmatch.åŠ¨æ€æ¨¡æ¿ç”±å‘½åå¯¹è±¡çš„æ•°ç»„æ¥å®šä¹‰çš„ï¼š123456789&quot;dynamic_templates&quot;: [ &#123; &quot;my_template_name&quot;: &#123; (1) ... match conditions ... (2) &quot;mapping&quot;: &#123; ... &#125; (3) &#125; &#125;, ... ]templateçš„åå­—å¯ä»¥æ˜¯ä»»ä½•ä¸€ä¸ªå­—ç¬¦ä¸²åŒ¹é…çš„æ¡ä»¶å¯ä»¥æ˜¯è¿™é‡Œçš„ä»»ä½•ä¸€ç§match_mapping_type, match, match_pattern, unmatch, path_match, path_unmatchè¢«åŒ¹é…çš„å­—æ®µçš„mappingä¾‹å¦‚ï¼Œå¦‚æžœæˆ‘ä»¬æƒ³è¦å°†æ‰€æœ‰æ•´æ•°å­—æ®µæ˜ å°„ä¸ºæ•´æ•°è€Œä¸æ˜¯longï¼Œå¹¶å°†æ‰€æœ‰å­—ç¬¦ä¸²å­—æ®µæ˜ å°„ä¸ºtextå’Œkeywordï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ¨¡æ¿ï¼šPUT my_index { &quot;mappings&quot;: { &quot;dynamic_templates&quot;: [ { &quot;integers&quot;: { &quot;match_mapping_type&quot;: &quot;long&quot;, &quot;mapping&quot;: { &quot;type&quot;: &quot;integer&quot; } } }, { &quot;strings&quot;: { &quot;match_mapping_type&quot;: &quot;string&quot;, &quot;mapping&quot;: { &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: { &quot;raw&quot;: { &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 } } } } } ] } } PUT my_index/_doc/1 { &quot;my_integer&quot;: 5, &quot;my_string&quot;: &quot;Some string&quot; } é€šè¿‡ä¸Šé¢çš„åŠ¨æ€templateæ˜ å°„ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°my_integerè¢«æ˜ å°„ä¸ºintegerè€Œä¸æ˜¯longã€‚my_stringæ˜¯ä¸€ä¸ªmulti_fieldå­—æ®µã€‚å‡è®¾æ‚¨å¸Œæœ›ä»»ä½•æœªæ˜ å°„çš„å­—ç¬¦ä¸²å­—æ®µé»˜è®¤æƒ…å†µä¸‹æ˜ å°„ä¸ºâ€œkeywordâ€ç±»åž‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå®šä¹‰ï¼šPUT test2 { &quot;mappings&quot;: { &quot;dynamic_templates&quot;: [ { &quot;my_string_fields&quot;: { &quot;match_mapping_type&quot;: &quot;string&quot;, &quot;mapping&quot;: { &quot;type&quot;: &quot;keyword&quot; } } } ] } } matchåŠunmatchmatchå‚æ•°ä½¿ç”¨æ¨¡å¼åŒ¹é…å­—æ®µåç§°ï¼Œè€Œunmatchä½¿ç”¨æ¨¡å¼æŽ’é™¤åŒ¹é…åŒ¹é…çš„å­—æ®µã€‚ä»¥ä¸‹ç¤ºä¾‹åŒ¹é…åç§°ä»¥long_å¼€å¤´çš„æ‰€æœ‰å­—ç¬¦ä¸²å­—æ®µï¼ˆä»¥_textç»“å°¾çš„å­—ç¬¦ä¸²é™¤å¤–ï¼‰å¹¶å°†å®ƒä»¬æ˜ å°„ä¸ºé•¿å­—æ®µï¼š1234567891011121314151617181920212223PUT my_index&#123; &quot;mappings&quot;: &#123; &quot;dynamic_templates&quot;: [ &#123; &quot;longs_as_strings&quot;: &#123; &quot;match_mapping_type&quot;: &quot;string&quot;, &quot;match&quot;: &quot;long_*&quot;, &quot;unmatch&quot;: &quot;*_text&quot;, &quot;mapping&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125; &#125; &#125; ] &#125;&#125; PUT my_index/_doc/1&#123; &quot;long_num&quot;: &quot;5&quot;, &quot;long_text&quot;: &quot;foo&quot; &#125;æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥æŸ¥çœ‹å®ƒä»¬çš„æ•°æ®ç±»åž‹ï¼šGET my_index/_mappingæ˜¾ç¤ºçš„ç»“æžœä¸ºï¼š1234567891011121314151617181920212223242526272829303132&#123; &quot;my_index&quot; : &#123; &quot;mappings&quot; : &#123; &quot;dynamic_templates&quot; : [ &#123; &quot;longs_as_strings&quot; : &#123; &quot;match&quot; : &quot;long_*&quot;, &quot;unmatch&quot; : &quot;*_text&quot;, &quot;match_mapping_type&quot; : &quot;string&quot;, &quot;mapping&quot; : &#123; &quot;type&quot; : &quot;long&quot; &#125; &#125; &#125; ], &quot;properties&quot; : &#123; &quot;long_num&quot; : &#123; &quot;type&quot; : &quot;long&quot; &#125;, &quot;long_text&quot; : &#123; &quot;type&quot; : &quot;text&quot;, &quot;fields&quot; : &#123; &quot;keyword&quot; : &#123; &quot;type&quot; : &quot;keyword&quot;, &quot;ignore_above&quot; : 256 &#125; &#125; &#125; &#125; &#125; &#125;&#125;ä»Žä¸Šé¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ï¼Œlong_numçš„æ•°æ®ç±»åž‹æ˜¯longï¼Œè€Œlong_textçš„æ•°æ®ç±»åž‹æ˜¯textã€‚æŽ§åˆ¶åŠ¨æ€å­—æ®µé»˜è®¤æƒ…å†µä¸‹ï¼Œå½“åœ¨æ–‡æ¡£ä¸­æ‰¾åˆ°ä»¥å‰æœªè§è¿‡çš„å­—æ®µæ—¶ï¼ŒElasticsearchä¼šå°†æ–°å­—æ®µæ·»åŠ åˆ°ç±»åž‹æ˜ å°„ä¸­ã€‚ é€šè¿‡å°†dynamicå‚æ•°è®¾ç½®ä¸ºfalseï¼ˆå¿½ç•¥æ–°å­—æ®µï¼‰æˆ–strictï¼ˆå¦‚æžœé‡åˆ°æœªçŸ¥å­—æ®µåˆ™æŠ›å‡ºå¼‚å¸¸ï¼‰ï¼Œå¯ä»¥åœ¨æ–‡æ¡£å’Œå¯¹è±¡çº§åˆ«ç¦ç”¨æ­¤è¡Œä¸ºã€‚åœ¨ç”Ÿäº§(product)çŽ¯å¢ƒä¸­ï¼Œä½ æžæœ‰å¯èƒ½ä¼šåˆ›å»ºä½ çš„mappingåœ¨ç´¢å¼•ä½ çš„æ•°æ®ä¹‹å‰ï¼Œè€Œä¸”ä½ æžæœ‰å¯èƒ½ä¸æƒ³ä½ çš„mappingä¼šè¢«ä¿®æ”¹ï¼š1234POST blogs/_doc/2&#123;&quot;some_new_field&quot;: &quot;What should we do?&quot; &#125;åœ¨é€šå¸¸çš„æƒ…å†µä¸‹ï¼Œä¸Šé¢çš„ä¸€ä¸ªå‘½ä»¤å¯èƒ½ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬åœ¨blogsç´¢å¼•é‡Œå¢žåŠ ä¸€ä¸ªæ–°çš„å«åšsome_new_fieldçš„å­—æ®µã€‚æ‚¨å¯ä»¥ä½¿ç”¨â€œåŠ¨æ€â€å±žæ€§ï¼ˆä¸‰ä¸ªé€‰é¡¹ï¼‰æŽ§åˆ¶æ·»åŠ åˆ°æ˜ å°„çš„æ–°å­—æ®µçš„æ•ˆæžœï¼š1234PUT blogs_example/_mapping&#123; &quot;dynamic&quot;: &quot;strict&quot;&#125;åœ¨ä¸Šé¢æˆ‘ä»¬åœ¨mappingä¸­åŠ å…¥äº†dynamicï¼Œå¹¶ä¸”è®¾ç½®ä¸ºstrictï¼Œå®ƒè¡¨æ˜Žå¦‚æžœçŽ°æœ‰çš„mappingé‡Œæ²¡æœ‰å®šä¹‰è¿™ä¸ªå­—æ®µï¼Œé‚£ä¹ˆå°±ä¸indexè¿™ä¸ªæ–‡æ¡£ã€‚1234PUT /blogs_example/_doc/1&#123; &quot;new_field&quot;: &quot;this is a new field&quot;&#125;å¦‚æžœnew_fieldä»Žæ¥æ²¡æœ‰åœ¨mappingä¸­å®šä¹‰è¿‡ï¼Œé‚£ä¹ˆï¼Œä¸Šé¢çš„å‘½ä»¤ä¼šå‡ºçŽ°å¦‚ä¸‹çš„é”™è¯¯ï¼š12345678910111213&#123; &quot;error&quot;: &#123; &quot;root_cause&quot;: [ &#123; &quot;type&quot;: &quot;strict_dynamic_mapping_exception&quot;, &quot;reason&quot;: &quot;mapping set to strict, dynamic introduction of [new_field] within [_doc] is not allowed&quot; &#125; ], &quot;type&quot;: &quot;strict_dynamic_mapping_exception&quot;, &quot;reason&quot;: &quot;mapping set to strict, dynamic introduction of [new_field] within [_doc] is not allowed&quot; &#125;, &quot;status&quot;: 400&#125;å¦‚æžœè¿™ä¸ªé—®é¢˜å‡ºçŽ°äº†ï¼Œæˆ‘ä»¬å¿…é¡»ä¿®æ”¹æˆ‘ä»¬çŽ°æœ‰çš„indexçš„mappingï¼š12345678PUT blogs_example/_mapping&#123; &quot;properties&quot;: &#123; &quot;new_field&quot;: &#123; &quot;type&quot;: &quot;text&quot; &#125; &#125;&#125;é‚£ä¹ˆé‡æ–°è¿è¡Œä¹‹å‰çš„é‚£ä¸ªå‘½ä»¤å°±å¯ä»¥äº†ã€‚settingsä»¥é˜²æ­¢æ˜ å°„çˆ†ç‚¸åœ¨ç´¢å¼•ä¸­å®šä¹‰å¤ªå¤šå­—æ®µæ˜¯ä¸€ç§å¯èƒ½å¯¼è‡´æ˜ å°„çˆ†ç‚¸çš„æƒ…å†µï¼Œè¿™å¯èƒ½å¯¼è‡´å†…å­˜ä¸è¶³é”™è¯¯å’Œéš¾ä»¥æ¢å¤çš„æƒ…å†µã€‚ è¿™ä¸ªé—®é¢˜å¯èƒ½æ¯”é¢„æœŸæ›´å¸¸è§ã€‚ ä¾‹å¦‚ï¼Œè€ƒè™‘æ’å…¥çš„æ¯ä¸ªæ–°æ–‡æ¡£å¼•å…¥æ–°å­—æ®µçš„æƒ…å†µã€‚ è¿™åœ¨åŠ¨æ€æ˜ å°„ä¸­éžå¸¸å¸¸è§ã€‚ æ¯æ¬¡æ–‡æ¡£åŒ…å«æ–°å­—æ®µæ—¶ï¼Œè¿™äº›å­—æ®µæœ€ç»ˆéƒ½ä¼šå‡ºçŽ°åœ¨ç´¢å¼•çš„æ˜ å°„ä¸­ã€‚ è¿™å¹¶ä¸éœ€è¦æ‹…å¿ƒå°‘é‡æ•°æ®ï¼Œä½†éšç€æ˜ å°„çš„å¢žåŠ ï¼Œå®ƒå¯èƒ½ä¼šæˆä¸ºä¸€ä¸ªé—®é¢˜ã€‚ ä»¥ä¸‹è®¾ç½®å…è®¸æ‚¨é™åˆ¶å¯æ‰‹åŠ¨æˆ–åŠ¨æ€åˆ›å»ºçš„å­—æ®µæ˜ å°„çš„æ•°é‡ï¼Œä»¥é˜²æ­¢é”™è¯¯çš„æ–‡æ¡£å¯¼è‡´æ˜ å°„çˆ†ç‚¸ï¼šindex.mapping.total_fields.limitç´¢å¼•ä¸­çš„æœ€å¤§å­—æ®µæ•°ã€‚ å­—æ®µå’Œå¯¹è±¡æ˜ å°„ä»¥åŠå­—æ®µåˆ«åéƒ½è®¡å…¥æ­¤é™åˆ¶ã€‚ é»˜è®¤å€¼ä¸º1000index.mapping.depth.limitå­—æ®µçš„æœ€å¤§æ·±åº¦ï¼Œä»¥å†…éƒ¨å¯¹è±¡çš„æ•°é‡æ¥è¡¡é‡ã€‚ ä¾‹å¦‚ï¼Œå¦‚æžœæ‰€æœ‰å­—æ®µéƒ½åœ¨æ ¹å¯¹è±¡çº§åˆ«å®šä¹‰ï¼Œåˆ™æ·±åº¦ä¸º1.å¦‚æžœæœ‰ä¸€ä¸ªå¯¹è±¡æ˜ å°„ï¼Œåˆ™æ·±åº¦ä¸º2ï¼Œç­‰ç­‰ã€‚é»˜è®¤å€¼ä¸º20ã€‚index.mapping.nested_fields.limitç´¢å¼•ä¸­ä¸åŒnestedæ˜ å°„çš„æœ€å¤§æ•°é‡ï¼Œé»˜è®¤ä¸º50ã€‚index.mapping.nested_objects.limitæ‰€æœ‰nestedç±»åž‹ä¸­å•ä¸ªæ–‡æ¡£ä¸­åµŒå¥—JSONå¯¹è±¡çš„æœ€å¤§æ•°é‡ï¼Œé»˜è®¤ä¸º10000ã€‚index.mapping.field_name_length.limitè®¾ç½®å­—æ®µåç§°çš„æœ€å¤§é•¿åº¦ã€‚ é»˜è®¤å€¼ä¸ºLong.MAX_VALUEï¼ˆæ— é™åˆ¶ï¼‰ã€‚ æ­¤è®¾ç½®å®žé™…ä¸Šä¸æ˜¯è§£å†³æ˜ å°„çˆ†ç‚¸çš„é—®é¢˜ï¼Œä½†å¦‚æžœè¦é™åˆ¶å­—æ®µé•¿åº¦ï¼Œåˆ™å¯èƒ½ä»ç„¶æœ‰ç”¨ã€‚ é€šå¸¸ä¸éœ€è¦è®¾ç½®æ­¤è®¾ç½®ã€‚ é»˜è®¤æ˜¯å¯ä»¥çš„ï¼Œé™¤éžç”¨æˆ·å¼€å§‹æ·»åŠ å¤§é‡å…·æœ‰çœŸæ­£é•¿åç§°çš„å­—æ®µã€‚ä¸Šé¢çš„å­—æ®µéƒ½å¯ä»¥åœ¨ä¸€ä¸ªindexçš„è®¾ç½®ä¸­è¿›è¡Œè®¾ç½®ï¼Œæ¯”å¦‚ï¼š12345678PUT test_blog &#123; &quot;settings&quot;: &#123; &quot;index.mapping.total_fields.limit&quot;: 2000, &quot;number_of_replicas&quot;: 0, &quot;number_of_shards&quot;: 1 &#125;&#125;]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearchï¼šClusterå¤‡ä»½ SnapshotåŠRestore API]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%EF%BC%9ACluster%E5%A4%87%E4%BB%BD%20Snapshot%E5%8F%8ARestore%20API%2F</url>
    <content type="text"><![CDATA[Elasticsearchæä¾›äº†replicaè§£å†³æ–¹æ¡ˆï¼Œå®ƒå¯ä»¥å¸®æˆ‘ä»¬è§£å†³äº†å¦‚æžœæœ‰ä¸€ä¸ªæˆ–å¤šä¸ªnodeå¤±è´¥äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æ•°æ®è¿˜æ˜¯å¯ä»¥ä¿è¯å®Œæ•´çš„æƒ…å†µï¼Œå¹¶ä¸”æœç´¢è¿˜å¯ä»¥ç»§ç»­è¿›è¡Œã€‚ä½†æ˜¯ï¼Œæœ‰ä¸€ç§æƒ…å†µæ˜¯æˆ‘ä»¬çš„æ‰€æœ‰çš„nodeï¼Œæˆ–è€…æœ‰ä¸€éƒ¨åˆ†nodeå¤±è´¥ï¼Œå¯èƒ½ä¼šé€ æˆæˆ‘ä»¬çš„æ•°æ®çš„ä¸¢å¤±ã€‚ä¹Ÿå°±æ˜¯è¯´replcaä¸èƒ½æä¾›ä¸€ç§ç¾éš¾æ€§çš„ä¿æŠ¤æœºåˆ¶ã€‚æˆ‘ä»¬éœ€è¦ä¸€ç§å®Œæ•´çš„å¤‡ä»½æœºåˆ¶ã€‚SnapshotåŠRestoreåœ¨Elasticé‡Œï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå«åšsnapshotåŠrestore APIçš„æŽ¥å£ã€‚ä½¿æ‚¨å¯ä»¥ä½¿ç”¨æ•°æ®å’ŒçŠ¶æ€å¿«ç…§å¤‡ä»½æ‚¨çš„Elasticsearchç´¢å¼•å’Œé›†ç¾¤ã€‚ å¿«ç…§å¾ˆé‡è¦ï¼Œå› ä¸ºå¿«ç…§ä¼šåœ¨å‡ºçŽ°é—®é¢˜æ—¶æä¾›æ‚¨æ•°æ®çš„å‰¯æœ¬ã€‚ å¦‚æžœéœ€è¦å›žæ»šåˆ°æ—§ç‰ˆæœ¬çš„æ•°æ®ï¼Œåˆ™å¯ä»¥ä»Žå­˜å‚¨åº“ä¸­è¿˜åŽŸå¿«ç…§ã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå½“å‰indexçš„çŠ¶æ€åŠæ•°æ®å­˜å…¥åˆ°ä¸€ä¸ªrepositoryé‡ŒåŽ»ã€‚Repositoryä¸ºäº†èƒ½å¤Ÿåšå¤‡ä»½ï¼Œæˆ‘ä»¬é¦–å…ˆå¿…é¡»åˆ›å»ºä¸€ä¸ªrepositoryï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªä»“åº“ã€‚ä½ å¯ä»¥ä¸ºä¸€ä¸ªclusteråˆ›å»ºå¤šä¸ªä»“åº“ã€‚ç›®å‰æ”¯æŒçš„ä»“åº“ç±»åž‹æœ‰ï¼š12345678# Elasticsearchæ”¯æŒä»“åº“ç±»åž‹ Respository é…ç½®ç±»åž‹Shared file system &quot;type&quot;: &quot;fs&quot;Read-only URL &quot;type&quot;: &quot;url&quot;S3 &quot;type&quot;: &quot;s3&quot;HDFS &quot;type&quot;: &quot;hdfs&quot;Azure &quot;type&quot;: &quot;azure&quot;Google Cloud Storage &quot;type&quot;: &quot;gcs&quot;è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼š S3, HDFS, Azure and GCS éœ€è¦ç›¸åº”çš„æ’ä»¶è¿›è¡Œå®‰è£…æ‰å¯ä»¥ã€‚æ³¨å†Œä»“åº“åœ¨ä¸€ä¸ªsnapshotå¯ä»¥è¢«ä½¿ç”¨ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»æ³¨å†Œä¸€ä¸ªä»“åº“ï¼ˆrepository)ã€‚ä½¿ç”¨_snapshot ç»ˆç‚¹æ–‡ä»¶å¤¹å¿…é¡»å¯¹æ‰€æœ‰çš„nodeå¯ä»¥è®¿é—®path.repoå¿…é¡»åœ¨æ‰€æœ‰çš„nodeä¸Šè¿›è¡Œé…ç½®ï¼Œé’ˆå¯¹ä¸€ä¸ªfsçš„repositoryæ¥è¯´1234567PUT _snapshot/my_repo &#123; &quot;type&quot;: &quot;fs&quot;, &quot;settings&quot;: &#123; &quot;location&quot;: &quot;/mnt/my_repo_folder&quot; &#125; &#125;è¿™é‡Œ/mnt/my_repo_folderå¿…é¡»åŠ è¿›æ‰€æœ‰nodeçš„elasticsearch.ymlæ–‡ä»¶ä¸­ã€‚fs resposityè®¾ç½®ï¼š12345678910PUT _snapshot/my_repo&#123; &quot;type&quot;: &quot;fs&quot;, &quot;settings&quot;: &#123; &quot;location&quot;: &quot;/mnt/my_repo_folder&quot;, &quot;compress&quot;: true, &quot;max_restore_bytes_per_sec&quot;: &quot;40mb&quot;, &quot;max_snapshot_bytes_per_sec&quot;: &quot;40mb&quot; &#125;&#125;è¿™é‡Œï¼Œæˆ‘ä»¬å®šä¹‰compressä¸ºtrueï¼Œè¡¨æ˜Žæˆ‘ä»¬å¸Œæœ›åŽ‹ç¼©ã€‚é€šè¿‡max_restore_bytes_per_secåŠmax_snapshot_bytes_per_secçš„å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥æ¥é™åˆ¶æ•°æ®çš„snapshotåŠæ¢å¤çš„æ•°æ®é€Ÿåº¦ã€‚S3 repositoryè®¾ç½®ä¸ºäº†èƒ½èƒ½ä½¿ç”¨S3ä»“åº“ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨å¦‚ä¸‹çš„å‘½ä»¤æ¥è¿›è¡Œå®‰è£…æ’ä»¶ï¼š1./bin/elasticsearch-plugin install repository-s3æ³¨æ„ï¼Œä¸Šé¢çš„å‘½ä»¤å¿…é¡»æ˜¯åœ¨Elasticsearchçš„å®‰è£…ç›®å½•ä¸‹è¿›è¡Œæ‰§è¡Œã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥è¿›è¡Œé…ç½®ï¼š1234567PUT _snapshot/my_s3_repo&#123; &quot;type&quot;: &quot;s3&quot;, &quot;settings&quot;: &#123; &quot;bucket&quot;: &quot;my_s3_bucket_name&quot; &#125;&#125;è¿™é‡Œçš„my_s3_bucket_nameæ˜¯æˆ‘ä»¬åœ¨AWSä¸Šå®šä¹‰çš„S3 bucketã€‚æ›´å¤šå…³äºŽS3çš„é…ç½®å¯ä»¥å‚é˜…é“¾æŽ¥ Repository Settings(https://www.elastic.co/guide/en/elasticsearch/plugins/current/repository-s3-repository.html)ã€‚Snapshotæ‰€æœ‰çš„ç´¢å¼•ä¸€æ—¦æˆ‘ä»¬çš„repositoryå·²ç»è¢«é…ç½®å¥½äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨_snapshotç»ˆç‚¹æ¥è¿›è¡Œsnapshotã€‚å¿…é¡»æ³¨æ„çš„æ˜¯snapshotåªæ‹·è´åœ¨æ‰§è¡Œè¯¥å‘½ä»¤æ—¶çš„æ‰€æœ‰çš„æ•°æ®ï¼Œè€Œåœ¨ä¹‹åŽçš„æ‰€æœ‰çš„æ•°æ®å°†ä¸è¢«å¤‡ä»½ã€‚snapshotæ˜¯æŒ‰ç…§å¢žé‡æ¥è¿›è¡Œå¤‡ä»½çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒåªæ‹·è´ä»Žä¸Šæ¬¡æ‰§è¡Œsnapshotä¹‹åŽå˜åŒ–çš„éƒ¨åˆ†ã€‚é€šå¸¸æ¥è¯´ï¼Œæ¯éš”30åˆ†é’Ÿè¿›è¡Œä¸€æ¬¡å¤‡ä»½æ˜¯è¶³å¤Ÿçš„ã€‚snapshotå‘½ä»¤ï¼š1PUT _snapshot/my_repo/my_snapshot_1è¿™é‡Œå¿…é¡»æ³¨æ„çš„å‡ ç‚¹ï¼šmy_repoæ˜¯æŒ‡çš„æˆ‘ä»¬åœ¨ä¸Šé¢å®šä¹‰çš„repositoryçš„åå­—my_snapshot_1æŒ‡çš„æ˜¯ä¸€ä¸ªå”¯ä¸€çš„snapshotåå­—æ²¡æœ‰ç‰¹å®šçš„ç´¢å¼•åå­—è¢«æŒ‡å‡ºï¼Œé‚£ä¹ˆå®ƒæŒ‡çš„æ˜¯æ‰€æœ‰çš„openç´¢å¼•å¦‚æžœæˆ‘ä»¬æƒ³æŒ‡å®šæŸä¸ªæˆ–æŸäº›ç‰¹å®šçš„ç´¢å¼•ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„å‘½ä»¤æ¥æ‰§è¡Œå¤‡ä»½ï¼ˆsnapshot)123456PUT _snapshot/my_repo/my_logs_snapshot_1&#123; &quot;indices&quot;: &quot;logs-*&quot;, &quot;ignore_unavailable&quot;: true, &quot;include_global_state&quot;: true&#125;è¿™é‡Œå®ƒè¡¨è¿°æˆ‘ä»¬ç›¸å¯¹æ‰€æœ‰ä»¥logs-ä¸ºå¼€å¤´çš„ç´¢å¼•è¿›è¡Œå¤‡ä»½ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥è¿›è¡Œç›‘æµ‹æ­£åœ¨è¿›è¡Œçš„snapshotçš„è¿›åº¦ï¼š1GET _snapshot/my_repo/my_snapshot_2/_statusç®¡ç†snapshotsèŽ·å–æ‰€æœ‰åœ¨repoä¸­çš„snapshots:1GET _snapshot/my_repo/_allèŽ·å–æŸä¸ªç‰¹å®šsnapshotçš„ä¿¡æ¯1GET _snapshot/my_repo/my_snapshot_1åˆ é™¤ä¸€ä¸ªsnapshot1DELETE _snapshot/my_repo/my_snapshot_1æ¢å¤ä¸€ä¸ªsnapshotæˆ‘ä»¬å¯ä»¥ä½¿ç”¨_restoreç»ˆç‚¹æ¥ä»Žä¸€ä¸ªsnapshotæ¢å¤æ‰€æœ‰çš„ç´¢å¼•ï¼š1POST _snapshot/my_repo/my_snapshot_2/_restoreæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹æ³•æ¥æ¢å¤æŸä¸ªæˆ–æŸäº›ç‰¹å®šçš„ç´¢å¼•ï¼š123456POST _snapshot/my_repo/my_snapshot_2/_restore&#123; &quot;indices&quot;: &quot;logs-*&quot;, &quot;ignore_unavailable&quot;: true, &quot;include_global_state&quot;: false&#125;åœ¨å¾ˆå¤šçš„æ—¶å€™ï¼Œæˆ‘ä»¬æƒ³æŠŠsnapshotä¸­çš„ç´¢å¼•æ¢å¤åˆ°ä¸€ä¸ªä¸åŒåå­—çš„ç´¢å¼•ä¹‹ä¸­ï¼Œä»Žè€Œä¸ç”¨è¦†ç›–çŽ°æœ‰çš„ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡rename_patternåŠrename_replacementæ¥è¿›è¡Œé…ç½®ï¼š12345678POST _snapshot/my_repo/my_snapshot_2/_restore&#123; &quot;indices&quot;: &quot;logs-*&quot;, &quot;ignore_unavailable&quot;: true, &quot;include_global_state&quot;: false, &quot;rename_pattern&quot;: &quot;logs-(.+)&quot;, &quot;rename_replacement&quot;: &quot;restored-logs-$1&quot;&#125;åœ¨ä¸Šé¢ï¼Œæˆ‘ä»¬æŠŠæ‰€æœ‰çš„ä»¥logs-ä¸ºå¼€å¤´çš„ç´¢å¼•æ¢å¤åˆ°ä»¥restored-logs-çš„å¼€å¤´çš„ç´¢å¼•ä¹‹ä¸­æ¥ã€‚Restoreåˆ°ä¸€ä¸ªæ–°çš„clusteré’ˆå¯¹è¿™ä¸ªæƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥æ¢å¤ä»Žå¦å¤–ä¸€ä¸ªclusterä¸­å¤‡ä»½çš„snapshotåˆ°å½“å‰çš„clusterä¸­æ¥ã€‚æˆ‘ä»¬å¿…é¡»åœ¨æ–°çš„clusterä¸­æ³¨å†Œè¿™ä¸ªrepositoryæ‰å¯ä»¥è¿›è¡Œä¸‹é¢çš„æ“ä½œã€‚ä»Žä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ï¼Œmy_repoå¿…é¡»å¯¹ä¸¤ä¸ªclusteréƒ½æ˜¯å¯è§çš„æ‰å¯ä»¥ã€‚åŠ¨æ‰‹å®žè·µå‡†å¤‡æ•°æ®ï¼šè¿è¡Œèµ·æ¥æˆ‘ä»¬çš„Kibana:æˆ‘ä»¬åˆ†åˆ«ç‚¹å‡»ä¸Šé¢çš„1å’Œ2å¤„ï¼šç‚¹å‡»ä¸Šé¢çš„â€œAdd dataâ€ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŠŠæˆ‘ä»¬çš„kibana_sample_data_logsç´¢å¼•åŠ è½½åˆ°Elasticsearchä¸­ã€‚1GET _cat/indices/kibana_sample_data_logsæ³¨å†Œrepositoryé¦–å…ˆæˆ‘ä»¬åœ¨æˆ‘ä»¬çš„ç”µè„‘ä¸Šåˆ›å»ºä¸€ä¸ªå¦‚ä¸‹çš„ç›®å½•ï¼š1/shared_folder/my_repoæˆ‘ä»¬åœ¨termimalä¸­æ‰“å…¥å¦‚ä¸‹çš„å‘½ä»¤ï¼š1mkdir -p shared_folder/my_repo/1234$ pwd/Users/liuxg/shared_folderbogon:shared_folder liuxg$ ls -aldrwxr-xr-x 2 liuxg staff 64 Nov 13 13:23 my_repoå°†ä»¥ä¸‹path.repoå±žæ€§æ·»åŠ åˆ°æˆ‘ä»¬è¿è¡Œçš„æ‰€æœ‰nodeçš„elasticsearch.ymlæ–‡ä»¶ä¸­ï¼š1path.repo: /Users/liuxg/shared_folder/my_repoæ³¨æ„ï¼Œé’ˆå¯¹ä½ çš„æƒ…å†µï¼Œä½ éœ€è¦æ”¹åŠ¨è¿™é‡Œçš„pathè·¯å¾„ã€‚ç„¶åŽå¯åŠ¨æˆ‘ä»¬çš„ElasticsearchåŠKibanaã€‚ç´§æŽ¥ç€ï¼Œæˆ‘ä»¬åœ¨Kibana consoleä¸­æ‰“å…¥å¦‚ä¸‹çš„å‘½ä»¤ï¼š1234567PUT _snapshot/my_local_repo&#123; &quot;type&quot;: &quot;fs&quot;, &quot;settings&quot;: &#123; &quot;location&quot;: &quot;/Users/liuxg/shared_folder/my_repo&quot; &#125;&#125;æ³¨æ„è¿™é‡Œçš„locationæ˜¯æ ¹æ®æˆ‘è‡ªå·±çš„ç”µè„‘çš„è·¯å¾„æ¥è®¾ç½®çš„ã€‚ä½ éœ€è¦æ ¹æ®è‡ªå·±å®žé™…çš„è·¯å¾„è¿›è¡Œä¿®æ”¹ã€‚åœ¨è¿™é‡Œmy_local_repoæ˜¯æˆ‘ä»¬çš„repositoryåç§°ã€‚æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ‰“å…¥å¦‚ä¸‹çš„å‘½ä»¤æ¥å¯¹æˆ‘ä»¬çš„kibana_sample_data_logsç´¢å¼•è¿›è¡Œsnapshot:123456PUT _snapshot/my_local_repo/snapshot_1&#123; &quot;indices&quot;: &quot;kibana_sample_data_logs&quot;, &quot;ignore_unavailable&quot;: true, &quot;include_global_state&quot;: true&#125;æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥æŸ¥çœ‹snapshot:1GET _snapshot/my_local_repo/_allæˆ‘ä»¬å¯ä»¥åœ¨å³è¾¹çœ‹åˆ°snapshot_1å‡ºçŽ°åœ¨åˆ—è¡¨ä¹‹ä¸­ï¼Œè¯´æ˜Žæˆ‘ä»¬å·²ç»æˆåŠŸåœ°åˆ›å»ºäº†è¿™ä¸ªsnapshotã€‚æˆ‘ä»¬æŽ¥ä¸‹æ¥å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥åˆ é™¤kibana_sample_data_logsç´¢å¼•ï¼š1DELETE kibana_sample_data_logsè¿™æ ·æˆ‘ä»¬å½»åº•åœ°åˆ é™¤äº†è¿™ä¸ªç´¢å¼•ã€‚é‚£ä¹ˆæˆ‘ä»¬è¯¥å¦‚ä½•æŠŠä¹‹å‰å¤‡ä»½çš„æ•°æ®æ¢å¤å›žæ¥å‘¢ï¼Ÿåœ¨Kibanaä¸­æ‰“å…¥å¦‚ä¸‹çš„å‘½ä»¤ï¼š123456POST _snapshot/my_local_repo/snapshot_1/_restore&#123; &quot;indices&quot;: &quot;kibana_sample_data_logs&quot;, &quot;ignore_unavailable&quot;: true, &quot;include_global_state&quot;: false&#125;åœ¨æ‰§è¡Œå®Œä¸Šé¢çš„å‘½ä»¤åŽï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥æŸ¥çœ‹æ¢å¤åŽçš„kibana_sample_data_logsç´¢å¼•ï¼š1GET kibana_sample_data_logs/_countæ˜¾ç„¶æˆ‘ä»¬å·²ç»æˆåŠŸåœ°æ¢å¤äº†æˆ‘ä»¬ä¹‹å‰å¤‡ä»½çš„æ•°æ®ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå¦‚æžœæˆ‘ä»¬åŽ»åˆ°æˆ‘ä»¬çš„snapshotæ–‡ä»¶ç›®å½•ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š123456$ pwd/Users/liuxg/shared_folder/my_repobogon:my_repo liuxg$ lsindex-0 meta-TzygGpJ1SOK5yJdsmc1lng.datindex.latest snap-TzygGpJ1SOK5yJdsmc1lng.datindicesæ˜¾ç„¶åœ¨æ–‡ä»¶ç›®å½•ä¸­ï¼Œå·²ç»æœ‰æ–°ç”Ÿäº§çš„æ–‡ä»¶äº†ã€‚]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearchï¼šaggregationä»‹ç»]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%EF%BC%9Aaggregation%E4%BB%8B%E7%BB%8D%2F</url>
    <content type="text"><![CDATA[èšåˆ(aggregation)åŠŸèƒ½é›†æ˜¯æ•´ä¸ªElasticsearchäº§å“ä¸­æœ€ä»¤äººå…´å¥‹å’Œæœ‰ç›Šçš„åŠŸèƒ½ä¹‹ä¸€ï¼Œä¸»è¦æ˜¯å› ä¸ºå®ƒæä¾›äº†ä¸€ä¸ªéžå¸¸æœ‰å¸å¼•åŠ›å¯¹ä¹‹å‰çš„facetsçš„æ›¿ä»£ã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†è§£é‡ŠElasticsearchä¸­çš„èšåˆï¼ˆaggregationï¼‰å¹¶é€æ­¥ä»‹ç»ä¸€äº›ç¤ºä¾‹ã€‚ æˆ‘ä»¬æ¯”è¾ƒäº†æŒ‡æ ‡èšåˆå’Œå­˜å‚¨æ¡¶èšåˆï¼Œå¹¶å±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨èšåˆåµŒå¥—ï¼ˆå¯¹äºŽfacetsè€Œè¨€è¿™æ˜¯ä¸å¯èƒ½çš„ï¼‰ã€‚ æ¬¢è¿Žæ‚¨åœ¨æœ¬æ–‡ä¸­å¤åˆ¶æ‰€æœ‰ç¤ºä¾‹ä»£ç ã€‚å…³äºŽElastic Facetsçš„ä¸€ç‚¹èƒŒæ™¯å¦‚æžœæ‚¨æ›¾ç»ä½¿ç”¨è¿‡Elasticsearchçš„facetsï¼Œé‚£ä¹ˆæ‚¨è‚¯å®šäº†è§£å®ƒä»¬çš„å®žç”¨æ€§ã€‚ ç»è¿‡ä¸°å¯Œçš„ç»éªŒï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå‘Šè¯‰æ‚¨Elasticsearchèšåˆï¼ˆaggregations)ç”šè‡³æ›´å¥½ã€‚ facetsä½¿æ‚¨å¯ä»¥å¿«é€Ÿè®¡ç®—å’Œæ±‡æ€»æŸ¥è¯¢ç»“æžœï¼Œå¹¶ä¸”å¯ä»¥å°†å…¶ç”¨äºŽå„ç§ä»»åŠ¡ï¼Œä¾‹å¦‚ç»“æžœå€¼çš„åŠ¨æ€è®¡æ•°æˆ–åˆ›å»ºåˆ†å¸ƒç›´æ–¹å›¾ã€‚ å°½ç®¡facetséžå¸¸å¼ºå¤§ï¼Œä½†å®ƒä»¬åœ¨Elasticsearchæ ¸å¿ƒä¸­çš„å®žçŽ°å­˜åœ¨ä¸€äº›é™åˆ¶ã€‚ ç”±äºŽfacetsä»…æ‰§è¡Œä¸€çº§æ·±åº¦çš„è®¡ç®—ï¼Œå› æ­¤å°†å®ƒä»¬ç»„åˆèµ·æ¥å¹¶ä¸å®¹æ˜“ã€‚èšåˆ(Aggregation)API(https://www.elastic.co/guide/en/elasticsearch/client/java-api/7.4/java-aggs.html)è§£å†³äº†è¿™äº›é—®é¢˜ï¼Œå¹¶ä¸”è¿˜æä¾›äº†ä¸€ç§ç®€å•çš„æ–¹æ³•åœ¨æŸ¥è¯¢æ—¶ï¼ˆåœ¨å•ä¸ªè¯·æ±‚ä¸­ï¼‰è¿›è¡Œçš„éžå¸¸ç²¾ç¡®çš„å¤šçº§è®¡ç®—ã€‚ ç®€è€Œè¨€ä¹‹ï¼šElasticsearchèšåˆæ˜¯å¯¹facetsçš„ä¸€ä¸ªæ›´åŠ å…¨é¢çš„æé«˜çš„ã€‚å‡†å¤‡æ•°æ®ä¸ºäº†å®Œæˆæˆ‘ä»¬ä»Šå¤©çš„ç»ƒä¹ ï¼Œæˆ‘ä»¬å…ˆæ¥å‡†å¤‡ä¸€äº›æ•°æ®ã€‚æˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªå«åšsportsçš„ç´¢å¼•ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªmappingï¼š1234567891011121314151617181920212223PUT sports&#123; &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;birthdate&quot;: &#123; &quot;type&quot;: &quot;date&quot;, &quot;format&quot;: &quot;dateOptionalTime&quot; &#125;, &quot;location&quot;: &#123; &quot;type&quot;: &quot;geo_point&quot; &#125;, &quot;name&quot;: &#123; &quot;type&quot;: &quot;keyword&quot; &#125;, &quot;rating&quot;: &#123; &quot;type&quot;: &quot;integer&quot; &#125;, &quot;sport&quot;: &#123; &quot;type&quot;: &quot;keyword&quot; &#125; &#125; &#125;&#125;åœ¨ä¸Šé¢ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªsportsç´¢å¼•çš„mappingã€‚åœ¨ä¸‹é¢ï¼Œæˆ‘ä»¬é€šè¿‡bulk APIæ¥æŠŠæˆ‘ä»¬æƒ³è¦çš„æ•°æ®å¯¼å…¥åˆ°ç´¢å¼•ä¸­ã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445POST _bulk/&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;sports&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;Michael&quot;,&quot;birthdate&quot;:&quot;1989-10-1&quot;,&quot;sport&quot;:&quot;Baseball&quot;,&quot;rating&quot;:[&quot;5&quot;,&quot;4&quot;],&quot;location&quot;:&quot;46.22,-68.45&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;sports&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;Bob&quot;,&quot;birthdate&quot;:&quot;1989-11-2&quot;,&quot;sport&quot;:&quot;Baseball&quot;,&quot;rating&quot;:[&quot;3&quot;,&quot;4&quot;],&quot;location&quot;:&quot;45.21,-68.35&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;sports&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;Jim&quot;,&quot;birthdate&quot;:&quot;1988-10-3&quot;,&quot;sport&quot;:&quot;Baseball&quot;,&quot;rating&quot;:[&quot;3&quot;,&quot;2&quot;],&quot;location&quot;:&quot;45.16,-63.58&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;sports&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;Joe&quot;,&quot;birthdate&quot;:&quot;1992-5-20&quot;,&quot;sport&quot;:&quot;Baseball&quot;,&quot;rating&quot;:[&quot;4&quot;,&quot;3&quot;],&quot;location&quot;:&quot;45.22,-68.53&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;sports&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;Tim&quot;,&quot;birthdate&quot;:&quot;1992-2-28&quot;,&quot;sport&quot;:&quot;Baseball&quot;,&quot;rating&quot;:[&quot;3&quot;,&quot;3&quot;],&quot;location&quot;:&quot;46.22,-68.85&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;sports&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;Alfred&quot;,&quot;birthdate&quot;:&quot;1990-9-9&quot;,&quot;sport&quot;:&quot;Baseball&quot;,&quot;rating&quot;:[&quot;2&quot;,&quot;2&quot;],&quot;location&quot;:&quot;45.12,-68.35&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;sports&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;Jeff&quot;,&quot;birthdate&quot;:&quot;1990-4-1&quot;,&quot;sport&quot;:&quot;Baseball&quot;,&quot;rating&quot;:[&quot;2&quot;,&quot;3&quot;],&quot;location&quot;:&quot;46.12,-68.55&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;sports&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;Will&quot;,&quot;birthdate&quot;:&quot;1988-3-1&quot;,&quot;sport&quot;:&quot;Baseball&quot;,&quot;rating&quot;:[&quot;4&quot;,&quot;4&quot;],&quot;location&quot;:&quot;46.25,-68.55&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;sports&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;Mick&quot;,&quot;birthdate&quot;:&quot;1989-10-1&quot;,&quot;sport&quot;:&quot;Baseball&quot;,&quot;rating&quot;:[&quot;3&quot;,&quot;4&quot;],&quot;location&quot;:&quot;46.22,-68.45&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;sports&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;Pong&quot;,&quot;birthdate&quot;:&quot;1989-11-2&quot;,&quot;sport&quot;:&quot;Baseball&quot;,&quot;rating&quot;:[&quot;1&quot;,&quot;3&quot;],&quot;location&quot;:&quot;45.21,-68.35&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;sports&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;Ray&quot;,&quot;birthdate&quot;:&quot;1988-10-3&quot;,&quot;sport&quot;:&quot;Baseball&quot;,&quot;rating&quot;:[&quot;2&quot;,&quot;2&quot;],&quot;location&quot;:&quot;45.16,-63.58&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;sports&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;Ping&quot;,&quot;birthdate&quot;:&quot;1992-5-20&quot;,&quot;sport&quot;:&quot;Baseball&quot;,&quot;rating&quot;:[&quot;4&quot;,&quot;3&quot;],&quot;location&quot;:&quot;45.22,-68.53&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;sports&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;Duke&quot;,&quot;birthdate&quot;:&quot;1992-2-28&quot;,&quot;sport&quot;:&quot;Baseball&quot;,&quot;rating&quot;:[&quot;5&quot;,&quot;2&quot;],&quot;location&quot;:&quot;46.22,-68.85&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;sports&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;Hal&quot;,&quot;birthdate&quot;:&quot;1990-9-9&quot;,&quot;sport&quot;:&quot;Baseball&quot;,&quot;rating&quot;:[&quot;4&quot;,&quot;2&quot;],&quot;location&quot;:&quot;45.12,-68.35&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;sports&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;Charge&quot;,&quot;birthdate&quot;:&quot;1990-4-1&quot;,&quot;sport&quot;:&quot;Baseball&quot;,&quot;rating&quot;:[&quot;3&quot;,&quot;2&quot;],&quot;location&quot;:&quot;46.12,-68.55&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;sports&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;Barry&quot;,&quot;birthdate&quot;:&quot;1988-3-1&quot;,&quot;sport&quot;:&quot;Baseball&quot;,&quot;rating&quot;:[&quot;5&quot;,&quot;2&quot;],&quot;location&quot;:&quot;46.25,-68.55&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;sports&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;Bank&quot;,&quot;birthdate&quot;:&quot;1988-3-1&quot;,&quot;sport&quot;:&quot;Golf&quot;,&quot;rating&quot;:[&quot;6&quot;,&quot;4&quot;],&quot;location&quot;:&quot;46.25,-68.55&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;sports&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;Bingo&quot;,&quot;birthdate&quot;:&quot;1988-3-1&quot;,&quot;sport&quot;:&quot;Golf&quot;,&quot;rating&quot;:[&quot;10&quot;,&quot;7&quot;],&quot;location&quot;:&quot;46.25,-68.55&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;sports&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;James&quot;,&quot;birthdate&quot;:&quot;1988-3-1&quot;,&quot;sport&quot;:&quot;Basketball&quot;,&quot;rating&quot;:[&quot;10&quot;,&quot;8&quot;],&quot;location&quot;:&quot;46.25,-68.55&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;sports&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;Wayne&quot;,&quot;birthdate&quot;:&quot;1988-3-1&quot;,&quot;sport&quot;:&quot;Hockey&quot;,&quot;rating&quot;:[&quot;10&quot;,&quot;10&quot;],&quot;location&quot;:&quot;46.25,-68.55&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;sports&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;Brady&quot;,&quot;birthdate&quot;:&quot;1988-3-1&quot;,&quot;sport&quot;:&quot;Football&quot;,&quot;rating&quot;:[&quot;10&quot;,&quot;10&quot;],&quot;location&quot;:&quot;46.25,-68.55&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_index&quot;:&quot;sports&quot;&#125;&#125;&#123;&quot;name&quot;:&quot;Lewis&quot;,&quot;birthdate&quot;:&quot;1988-3-1&quot;,&quot;sport&quot;:&quot;Football&quot;,&quot;rating&quot;:[&quot;10&quot;,&quot;10&quot;],&quot;location&quot;:&quot;46.25,-68.55&quot;&#125;é€šè¿‡ä¸Šé¢çš„bulk APIæŽ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæˆ‘ä»¬æƒ³è¦çš„æ•°æ®è¾“å…¥åˆ°sportsçš„ç´¢å¼•ä¸­ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æŽ¥å£æ¥èŽ·å¾—æˆ‘å¤šå°‘æ¡æ•°æ®ï¼š1GET sports/_countæ˜¾ç¤ºç»“æžœï¼š123456789&#123; &quot;count&quot; : 22, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;&#125;åœ¨è¿™ä¸ªæ•°æ®åº“é‡Œï¼Œæˆ‘ä»¬æœ‰å¯ä»¥çœ‹åˆ°æœ‰22æ¡çš„æ•°æ®ã€‚åŠ¨æ‰‹å®žè·µèšåˆçš„ä¸¤ä¸ªä¸»è¦ç³»åˆ—æ˜¯æŒ‡æ ‡èšåˆï¼ˆmetric aggregationsï¼‰(https://www.elastic.co/guide/en/elasticsearch/reference/master/search-aggregations-metrics.html)å’Œå­˜å‚¨æ¡¶èšåˆï¼ˆbucket aggregationï¼‰(https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations-bucket.html)ã€‚æŒ‡æ ‡èšåˆè®¡ç®—ä¸€ç»„æ–‡æ¡£ä¸­çš„æŸäº›å€¼ï¼ˆä¾‹å¦‚å¹³å‡å€¼ï¼‰ï¼› å­˜å‚¨æ¡¶èšåˆå°†æ–‡æ¡£åˆ†ç»„åˆ°å­˜å‚¨æ¡¶ä¸­ã€‚ åœ¨è¯¦ç»†ä»‹ç»ä¹‹å‰ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹èšåˆè¯·æ±‚çš„ä¸€èˆ¬ç»“æž„ã€‚é™¤æ­¤ä¹‹å‰ï¼Œèšåˆè¿˜æœ‰Matrix(https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations-matrix.html)åŠPipleline(https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations-pipeline.htmlèšåˆã€‚Aggregationç»“æž„123456789&quot;aggregations&quot; : &#123; &quot;&lt;aggregation_name&gt;&quot; : &#123; &quot;&lt;aggregation_type&gt;&quot; : &#123; &lt;aggregation_body&gt; &#125;, [&quot;aggregations&quot; : &#123; [&lt;sub_aggregation&gt;]* &#125; ] &#125; [,&quot;&lt;aggregation_name_2&gt;&quot; : &#123; ... &#125; ]*&#125;è¯·æ±‚jsonä¸­çš„èšåˆï¼ˆæ‚¨ä¹Ÿå¯ä»¥æ”¹ç”¨aggsï¼‰å¯¹è±¡åŒ…å«èšåˆåç§°ï¼Œç±»åž‹å’Œä¸»ä½“ã€‚ &lt;aggregation_name&gt;æ˜¯ç”¨æˆ·å®šä¹‰çš„åç§°ï¼ˆä¸å¸¦æ‹¬å·ï¼‰ï¼Œè¯¥åç§°å°†å”¯ä¸€æ ‡è¯†å“åº”ä¸­çš„èšåˆåç§°/é”®ã€‚&lt;aggregation_type&gt;é€šå¸¸æ˜¯èšåˆä¸­çš„ç¬¬ä¸€ä¸ªé”®ã€‚ å®ƒå¯ä»¥æ˜¯termsï¼Œstatsæˆ–geo-distanceèšåˆï¼Œä½†è¿™æ˜¯å®ƒçš„èµ·ç‚¹ã€‚ åœ¨æˆ‘ä»¬çš„&lt;aggregation_type&gt;ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª&lt;aggregation_body&gt;ã€‚ åœ¨&lt;aggregation_body&gt;ä¸­ï¼Œæˆ‘ä»¬æŒ‡å®šèšåˆæ‰€éœ€çš„å±žæ€§ã€‚ å¯ç”¨å±žæ€§å–å†³äºŽèšåˆçš„ç±»åž‹ã€‚æ‚¨å¯ä»¥é€‰æ‹©æä¾›å­èšåˆï¼Œä»¥å°†ä¸€ä¸ªèšåˆå…ƒç´ çš„ç»“æžœåµŒå¥—åˆ°å¦ä¸€ä¸ªèšåˆå…ƒç´ ä¸­ã€‚ æ­¤å¤–ï¼Œæ‚¨å¯ä»¥åœ¨æŸ¥è¯¢ä¸­è¾“å…¥å¤šä¸ªèšåˆï¼ˆaggregation_name_2ï¼‰ï¼Œä»¥å…·æœ‰æ›´å¤šå•ç‹¬çš„é¡¶çº§èšåˆã€‚ å°½ç®¡å¯¹åµŒå¥—çº§åˆ«æ²¡æœ‰é™åˆ¶ï¼Œä½†æ˜¯æ‚¨ä¸èƒ½å°†åº¦é‡æ ‡å‡†åµŒå¥—åœ¨åº¦é‡æ ‡å‡†èšåˆä¸­ï¼ŒåŽŸå› å¦‚ä¸‹æ‰€è¿°ã€‚ åœ¨ç ”ç©¶å¯ä»¥èšåˆçš„ä¸åŒç±»åž‹çš„å€¼ä¹‹åŽï¼Œæˆ‘ä»¬å°†äº†è§£æ¡¶èšåˆå’Œåº¦é‡èšåˆä¹‹é—´çš„åŒºåˆ«ã€‚ä¾‹å­ä¸€äº›èšåˆä½¿ç”¨ä»Žèšåˆæ–‡æ¡£ä¸­èŽ·å–çš„å€¼ã€‚ è¿™äº›å€¼å¯ä»¥ä»ŽæŒ‡å®šçš„æ–‡æ¡£å­—æ®µï¼ˆfieldï¼‰ä¸­èŽ·å–ï¼Œä¹Ÿå¯ä»¥ä»Žéšæ¯ä¸ªæ–‡æ¡£ç”Ÿæˆå€¼çš„è„šæœ¬ä¸­èŽ·å–ã€‚ ä¸‹é¢çš„ç¬¬ä¸€ä¸ªç¤ºä¾‹åœ¨åç§°å­—æ®µä¸Šæä¾›äº†æœ¯è¯­èšåˆ(terms aggregation)ï¼Œåœ¨å­èšåˆrating_avgå€¼ä¸Šç»™å‡ºäº†é¡ºåºã€‚ å¦‚æ‚¨æ‰€è§ï¼Œæˆ‘ä»¬ä½¿ç”¨åµŒå¥—çš„æŒ‡æ ‡èšåˆå¯¹å­˜å‚¨æ¡¶èšåˆçš„ç»“æžœè¿›è¡ŒæŽ’åºã€‚å°½ç®¡æˆ‘ä»¬ä½¿ç”¨ä¸Šé¢ç»™å‡ºçš„ç´¢å¼•ï¼Œä½†æ˜¯æˆ‘ä»¬é¼“åŠ±æ‚¨è¿è¡Œæ­¤æŸ¥è¯¢ï¼ˆä»¥åŠä¸‹é¢çš„å…¶ä»–æŸ¥è¯¢ï¼‰ã€‚ æ‚¨å¯ä»¥ä»Žå·¥ä½œä¸­èŽ·å¾—ç›´æŽ¥ç»“æžœï¼Œç„¶åŽå¯¹å…¶è¿›è¡Œä¿®æ”¹ä»¥åŒ¹é…æ‚¨çš„æ•°æ®é›†ã€‚å¦å¤–ï¼Œè¯·ä»”ç»†æŸ¥çœ‹æˆ‘ä»¬æ˜¯å¦åŒ…å«â€œ sizeâ€ï¼š0ï¼Œå› ä¸ºæˆ‘ä»¬çš„é‡ç‚¹æ˜¯èšåˆç»“æžœï¼Œè€Œä¸æ˜¯æ–‡æ¡£ç»“æžœã€‚è¿™é‡Œè®¾ç½®ä¸º0ï¼Œè¡¨ç¤ºæˆ‘ä»¬ä¸æƒ³å¾—åˆ°ä»»ä½•çš„æ–‡æ¡£ã€‚123456789101112131415161718192021GET sports/_search&#123; &quot;size&quot;: 0, &quot;aggregations&quot;: &#123; &quot;the_name&quot;: &#123; &quot;terms&quot;: &#123; &quot;field&quot;: &quot;name&quot;, &quot;order&quot;: &#123; &quot;rating_avg&quot;: &quot;desc&quot; &#125; &#125;, &quot;aggregations&quot;: &#123; &quot;rating_avg&quot;: &#123; &quot;avg&quot;: &#123; &quot;field&quot;: &quot;rating&quot; &#125; &#125; &#125; &#125; &#125;&#125;æ˜¾ç¤ºçš„ç»“æžœä¸ºï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596&#123; &quot;took&quot; : 1, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 22, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : null, &quot;hits&quot; : [ ] &#125;, &quot;aggregations&quot; : &#123; &quot;the_name&quot; : &#123; &quot;doc_count_error_upper_bound&quot; : 0, &quot;sum_other_doc_count&quot; : 12, &quot;buckets&quot; : [ &#123; &quot;key&quot; : &quot;Brady&quot;, &quot;doc_count&quot; : 1, &quot;rating_avg&quot; : &#123; &quot;value&quot; : 10.0 &#125; &#125;, &#123; &quot;key&quot; : &quot;Lewis&quot;, &quot;doc_count&quot; : 1, &quot;rating_avg&quot; : &#123; &quot;value&quot; : 10.0 &#125; &#125;, &#123; &quot;key&quot; : &quot;Wayne&quot;, &quot;doc_count&quot; : 1, &quot;rating_avg&quot; : &#123; &quot;value&quot; : 10.0 &#125; &#125;, &#123; &quot;key&quot; : &quot;James&quot;, &quot;doc_count&quot; : 1, &quot;rating_avg&quot; : &#123; &quot;value&quot; : 9.0 &#125; &#125;, &#123; &quot;key&quot; : &quot;Bingo&quot;, &quot;doc_count&quot; : 1, &quot;rating_avg&quot; : &#123; &quot;value&quot; : 8.5 &#125; &#125;, &#123; &quot;key&quot; : &quot;Bank&quot;, &quot;doc_count&quot; : 1, &quot;rating_avg&quot; : &#123; &quot;value&quot; : 5.0 &#125; &#125;, &#123; &quot;key&quot; : &quot;Michael&quot;, &quot;doc_count&quot; : 1, &quot;rating_avg&quot; : &#123; &quot;value&quot; : 4.5 &#125; &#125;, &#123; &quot;key&quot; : &quot;Will&quot;, &quot;doc_count&quot; : 1, &quot;rating_avg&quot; : &#123; &quot;value&quot; : 4.0 &#125; &#125;, &#123; &quot;key&quot; : &quot;Barry&quot;, &quot;doc_count&quot; : 1, &quot;rating_avg&quot; : &#123; &quot;value&quot; : 3.5 &#125; &#125;, &#123; &quot;key&quot; : &quot;Bob&quot;, &quot;doc_count&quot; : 1, &quot;rating_avg&quot; : &#123; &quot;value&quot; : 3.5 &#125; &#125; ] &#125; &#125;&#125;ä¸Šé¢çš„ç»“æžœæ˜¾ç¤ºï¼šæˆ‘ä»¬å¾—åˆ°äº†æŒ‰ç…§æ¯ä¸ªäººæ¥è¿›è¡Œåˆ†ç±»çš„èšåˆï¼Œè€Œä»–ä»¬çš„é¡ºåºæ˜¯æŒ‰ç…§rating_avgèšåˆæ‰€èŽ·å¾—å¹³å‡åˆ†æ•°æ¥æŽ’åºçš„ã€‚æˆ‘ä»¬è¿˜å¯ä»¥æä¾›ä¸€ä¸ªscriptè„šæœ¬æ¥ç”Ÿæˆèšåˆæ‰€ä½¿ç”¨çš„å€¼:123456789101112131415161718192021222324252627GET sports/_search&#123; &quot;size&quot;: 0, &quot;aggs&quot;: &#123; &quot;age_range&quot;: &#123; &quot;range&quot;: &#123; &quot;script&quot;: &#123; &quot;source&quot;: &quot;&quot;&quot; ZonedDateTime dob = doc[&apos;birthdate&apos;].value; return params.now - dob.getYear() &quot;&quot;&quot; , &quot;params&quot;: &#123; &quot;now&quot;: 2019 &#125; &#125;, &quot;ranges&quot;: [ &#123; &quot;from&quot;: 30, &quot;to&quot;: 31 &#125; ] &#125; &#125; &#125;&#125;åœ¨ä¸Šé¢ï¼Œæˆ‘ä»¬é€šè¿‡è„šæœ¬ç”Ÿäº§value sourceï¼Œå¹¶å¯¹å®ƒåšå‡ºç»Ÿè®¡ã€‚æ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š123456789101112131415161718192021222324252627282930&#123; &quot;took&quot; : 0, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 22, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : null, &quot;hits&quot; : [ ] &#125;, &quot;aggregations&quot; : &#123; &quot;age_range&quot; : &#123; &quot;buckets&quot; : [ &#123; &quot;key&quot; : &quot;30.0-31.0&quot;, &quot;from&quot; : 30.0, &quot;to&quot; : 31.0, &quot;doc_count&quot; : 4 &#125; ] &#125; &#125;&#125;ä¸Šé¢æ˜¾ç¤ºåœ¨30è‡³31å²ä¹‹é—´çš„æœ‰4ä¸ªäººã€‚Metric AggregationsæŒ‡æ ‡èšåˆç±»åž‹ç”¨äºŽè®¡ç®—æ•´ä¸ªæ–‡æ¡£é›†çš„æŒ‡æ ‡ã€‚ æœ‰å•å€¼æŒ‡æ ‡èšåˆï¼ˆä¾‹å¦‚avgï¼‰å’Œå¤šå€¼æŒ‡æ ‡èšåˆï¼ˆä¾‹å¦‚statsï¼‰ã€‚ æŒ‡æ ‡èšåˆçš„ä¸€ä¸ªç®€å•ç¤ºä¾‹æ˜¯value_countèšåˆï¼Œå®ƒä»…è¿”å›žå·²ä¸ºç»™å®šå­—æ®µå»ºç«‹ç´¢å¼•çš„å€¼çš„æ€»æ•°ã€‚ è¦åœ¨è¿åŠ¨å‘˜æ•°æ®é›†ä¸­çš„â€œsportâ€å­—æ®µä¸­æ‰¾åˆ°å€¼çš„æ•°é‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŸ¥è¯¢ï¼š1234567891011GET sports/_search&#123; &quot;size&quot;: 0, &quot;aggs&quot;: &#123; &quot;sport_count&quot;: &#123; &quot;value_count&quot;: &#123; &quot;field&quot;: &quot;sport&quot; &#125; &#125; &#125;&#125;æ˜¾ç¤ºç»“æžœï¼š1234567891011121314151617181920212223&#123; &quot;took&quot; : 2, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 22, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : null, &quot;hits&quot; : [ ] &#125;, &quot;aggregations&quot; : &#123; &quot;sport_count&quot; : &#123; &quot;value&quot; : 22 &#125; &#125;&#125;è¯·æ³¨æ„ï¼Œè¿™å°†è¿”å›žè¯¥å­—æ®µçš„å€¼æ€»æ•°ï¼Œè€Œä¸æ˜¯å”¯ä¸€å€¼çš„æ•°ç›®ã€‚ å› æ­¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ˆç”±äºŽæ¯ä¸ªæ–‡æ¡£åœ¨â€œ sportâ€å­—æ®µä¸­éƒ½æœ‰ä¸€ä¸ªå•è¯å€¼ï¼‰ï¼Œç»“æžœä»…ç­‰äºŽç´¢å¼•ä¸­çš„æ–‡æ¡£æ•°ã€‚Bucket Aggregationså­˜å‚¨æ¡¶èšåˆæ˜¯ç”¨äºŽå¯¹æ–‡æ¡£è¿›è¡Œåˆ†ç»„çš„æœºåˆ¶ã€‚ æ¯ç§ç±»åž‹çš„å­˜å‚¨æ¡¶èšåˆéƒ½æœ‰è‡ªå·±çš„åˆ†å‰²æ–‡æ¡£é›†çš„æ–¹æ³•ã€‚ ä¹Ÿè®¸æœ€ç®€å•çš„ç±»åž‹æ˜¯æœ¯è¯­èšåˆã€‚ è¿™ä¸ªåŠŸèƒ½éžå¸¸åƒæœ¯è¯­æ–¹é¢ï¼Œè¿”å›žç»™å®šå­—æ®µç´¢å¼•çš„å”¯ä¸€æœ¯è¯­ä»¥åŠåŒ¹é…æ–‡æ¡£çš„æ•°é‡ã€‚ å¦‚æžœæˆ‘ä»¬æƒ³åœ¨æ•°æ®é›†ä¸­çš„â€œsportâ€å­—æ®µä¸­æ‰¾åˆ°æ‰€æœ‰å€¼ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š123456789101112GET sports/_search&#123; &quot;size&quot;: 0, &quot;aggs&quot;: &#123; &quot;sport&quot;: &#123; &quot;terms&quot;: &#123; &quot;field&quot;: &quot;sport&quot;, &quot;size&quot;: 10 &#125; &#125; &#125;&#125;è¿”å›žå€¼ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546&#123; &quot;took&quot; : 0, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 22, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : null, &quot;hits&quot; : [ ] &#125;, &quot;aggregations&quot; : &#123; &quot;sport&quot; : &#123; &quot;doc_count_error_upper_bound&quot; : 0, &quot;sum_other_doc_count&quot; : 0, &quot;buckets&quot; : [ &#123; &quot;key&quot; : &quot;Baseball&quot;, &quot;doc_count&quot; : 16 &#125;, &#123; &quot;key&quot; : &quot;Football&quot;, &quot;doc_count&quot; : 2 &#125;, &#123; &quot;key&quot; : &quot;Golf&quot;, &quot;doc_count&quot; : 2 &#125;, &#123; &quot;key&quot; : &quot;Basketball&quot;, &quot;doc_count&quot; : 1 &#125;, &#123; &quot;key&quot; : &quot;Hockey&quot;, &quot;doc_count&quot; : 1 &#125; ] &#125; &#125;&#125;æ‚¨å¯èƒ½ä¼šå‘çŽ°geo_distanceèšåˆæ›´å…·å¸å¼•åŠ›ã€‚ å°½ç®¡å®ƒæœ‰è®¸å¤šé€‰é¡¹ï¼Œä½†åœ¨æœ€ç®€å•çš„æƒ…å†µä¸‹ï¼Œå®ƒå–ä¸€ä¸ªåŽŸç‚¹å’Œä¸€ä¸ªè·ç¦»èŒƒå›´ï¼Œç„¶åŽæ ¹æ®ç»™å®šçš„geo_pointå­—æ®µè®¡ç®—åœ†ä¸­æœ‰å¤šå°‘æ–‡æ¡£ã€‚å‡è®¾æˆ‘ä»¬éœ€è¦çŸ¥é“å¤šå°‘ä¸ªè¿åŠ¨å‘˜å±…ä½åœ¨è·ç¦»åœ°ç†ä½ç½®â€œ 46.12ï¼Œ-68.55â€ 20è‹±é‡ŒèŒƒå›´å†…ã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹èšåˆï¼š12345678910111213141516171819GET sports/_search&#123; &quot;size&quot;: 0, &quot;aggregations&quot;: &#123; &quot;baseball_player_ring&quot;: &#123; &quot;geo_distance&quot;: &#123; &quot;field&quot;: &quot;location&quot;, &quot;origin&quot;: &quot;46.12,-68.55&quot;, &quot;unit&quot;: &quot;mi&quot;, &quot;ranges&quot;: [ &#123; &quot;from&quot;: 0, &quot;to&quot;: 20 &#125; ] &#125; &#125; &#125;&#125;è¿”å›žç»“æžœï¼š123456789101112131415161718192021222324252627282930&#123; &quot;took&quot; : 4, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 22, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : null, &quot;hits&quot; : [ ] &#125;, &quot;aggregations&quot; : &#123; &quot;baseball_player_ring&quot; : &#123; &quot;buckets&quot; : [ &#123; &quot;key&quot; : &quot;*-20.0&quot;, &quot;from&quot; : 0.0, &quot;to&quot; : 20.0, &quot;doc_count&quot; : 14 &#125; ] &#125; &#125;&#125;å†…åµŒ Bucket Aggregationsè®¸å¤šå¼€å‘äººå‘˜ä¼šåŒæ„ï¼Œæ¡¶èšåˆçš„æœ€å¼ºå¤§æ–¹é¢æ˜¯åµŒå¥—å®ƒä»¬çš„èƒ½åŠ›ã€‚ æ‚¨å¯ä»¥å®šä¹‰é¡¶çº§å­˜å‚¨æ¡¶èšåˆï¼Œå¹¶åœ¨å…¶å†…éƒ¨å®šä¹‰å¯¹æ¯ä¸ªç»“æžœå­˜å‚¨æ¡¶è¿›è¡Œæ“ä½œçš„ç¬¬äºŒçº§èšåˆã€‚ æ­¤åµŒå¥—å¯ä»¥æ ¹æ®éœ€è¦æ‰©å±•åˆ°å¤šä¸ªçº§åˆ«ã€‚ç»§ç»­æˆ‘ä»¬çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æŒ‰å¹´é¾„åˆ’åˆ†çš„åµŒå¥—èŒƒå›´èšåˆï¼ˆæ ¹æ®è„šæœ¬çš„â€œå‡ºç”Ÿæ—¥æœŸâ€è®¡ç®—å¾—å‡ºï¼‰æ¥è¿›ä¸€æ­¥ç»†åˆ†geo_distanceèšåˆçš„ç»“æžœã€‚ å‡è®¾æˆ‘ä»¬æƒ³çŸ¥é“å±žäºŽä¸¤ä¸ªå¹´é¾„æ®µçš„æ¯ä¸ªè¿åŠ¨å‘˜ä¸­æœ‰å¤šå°‘è¿åŠ¨å‘˜ï¼ˆä»–ä»¬ç”Ÿæ´»åœ¨ä¸Šä¸€èŠ‚ä¸­å®šä¹‰çš„åœˆå­å†…ï¼‰ã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹èšåˆæ¥èŽ·å–æ­¤ä¿¡æ¯ï¼š12345678910111213141516171819202122232425262728293031323334353637383940GET sports/_search&#123; &quot;size&quot;: 0, &quot;aggregations&quot;: &#123; &quot;baseball_player_ring&quot;: &#123; &quot;geo_distance&quot;: &#123; &quot;field&quot;: &quot;location&quot;, &quot;origin&quot;: &quot;46.12,-68.55&quot;, &quot;unit&quot;: &quot;mi&quot;, &quot;ranges&quot;: [ &#123; &quot;from&quot;: 0, &quot;to&quot;: 20 &#125; ] &#125;, &quot;aggregations&quot;: &#123; &quot;ring_age_ranges&quot;: &#123; &quot;range&quot;: &#123; &quot;script&quot;: &#123; &quot;source&quot;: &quot;&quot;&quot; ZonedDateTime dob = doc[&apos;birthdate&apos;].value; return params.now - dob.getYear() &quot;&quot;&quot; , &quot;params&quot;: &#123; &quot;now&quot;: 2019 &#125; &#125;, &quot;ranges&quot;: [ &#123; &quot;from&quot;: 30, &quot;to&quot;: 31 &#125;, &#123; &quot;from&quot;: 31, &quot;to&quot;: 32 &#125; ] &#125; &#125; &#125; &#125; &#125;&#125;æ˜¾ç¤ºçš„ç»“æžœä¸ºï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546&#123; &quot;took&quot; : 0, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 22, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : null, &quot;hits&quot; : [ ] &#125;, &quot;aggregations&quot; : &#123; &quot;baseball_player_ring&quot; : &#123; &quot;buckets&quot; : [ &#123; &quot;key&quot; : &quot;*-20.0&quot;, &quot;from&quot; : 0.0, &quot;to&quot; : 20.0, &quot;doc_count&quot; : 14, &quot;ring_age_ranges&quot; : &#123; &quot;buckets&quot; : [ &#123; &quot;key&quot; : &quot;30.0-31.0&quot;, &quot;from&quot; : 30.0, &quot;to&quot; : 31.0, &quot;doc_count&quot; : 2 &#125;, &#123; &quot;key&quot; : &quot;31.0-32.0&quot;, &quot;from&quot; : 31.0, &quot;to&quot; : 32.0, &quot;doc_count&quot; : 8 &#125; ] &#125; &#125; ] &#125; &#125;&#125;çŽ°åœ¨ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨statsï¼ˆå¤šå€¼æŒ‡æ ‡æ±‡æ€»å™¨ï¼‰æ¥è®¡ç®—æœ€å†…éƒ¨ç»“æžœçš„ä¸€äº›ç»Ÿè®¡æ•°æ®ã€‚ å¯¹äºŽå±…ä½åœ¨æˆ‘ä»¬åœˆå­ä¸­çš„è¿åŠ¨å‘˜ä»¥åŠä¸¤ä¸ªå¹´é¾„æ®µçš„æ¯ä¸ªå¹´é¾„æ®µï¼Œæˆ‘ä»¬çŽ°åœ¨éƒ½å¸Œæœ›æ ¹æ®ç»“æžœæ–‡æ¡£è®¡ç®—â€œratingâ€å­—æ®µçš„ç»Ÿè®¡ä¿¡æ¯ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647GET sports/_search&#123; &quot;size&quot;: 0, &quot;aggregations&quot;: &#123; &quot;baseball_player_ring&quot;: &#123; &quot;geo_distance&quot;: &#123; &quot;field&quot;: &quot;location&quot;, &quot;origin&quot;: &quot;46.12,-68.55&quot;, &quot;unit&quot;: &quot;mi&quot;, &quot;ranges&quot;: [ &#123; &quot;from&quot;: 0, &quot;to&quot;: 20 &#125; ] &#125;, &quot;aggregations&quot;: &#123; &quot;ring_age_ranges&quot;: &#123; &quot;range&quot;: &#123; &quot;script&quot;: &#123; &quot;source&quot;: &quot;&quot;&quot; ZonedDateTime dob = doc[&apos;birthdate&apos;].value; return params.now - dob.getYear() &quot;&quot;&quot; , &quot;params&quot;: &#123; &quot;now&quot;: 2019 &#125; &#125;, &quot;ranges&quot;: [ &#123; &quot;from&quot;: 30, &quot;to&quot;: 31 &#125;, &#123; &quot;from&quot;: 31, &quot;to&quot;: 32 &#125; ] &#125;, &quot;aggregations&quot;: &#123; &quot;rating_stats&quot;: &#123; &quot;stats&quot;: &#123; &quot;field&quot;: &quot;rating&quot; &#125; &#125; &#125; &#125; &#125; &#125; &#125;&#125;æˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªæˆ‘ä»¬éœ€è¦çš„ç»Ÿè®¡ä¿¡æ¯çš„å“åº”ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960&#123; &quot;took&quot; : 0, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 22, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : null, &quot;hits&quot; : [ ] &#125;, &quot;aggregations&quot; : &#123; &quot;baseball_player_ring&quot; : &#123; &quot;buckets&quot; : [ &#123; &quot;key&quot; : &quot;*-20.0&quot;, &quot;from&quot; : 0.0, &quot;to&quot; : 20.0, &quot;doc_count&quot; : 14, &quot;ring_age_ranges&quot; : &#123; &quot;buckets&quot; : [ &#123; &quot;key&quot; : &quot;30.0-31.0&quot;, &quot;from&quot; : 30.0, &quot;to&quot; : 31.0, &quot;doc_count&quot; : 2, &quot;rating_stats&quot; : &#123; &quot;count&quot; : 4, &quot;min&quot; : 3.0, &quot;max&quot; : 5.0, &quot;avg&quot; : 4.0, &quot;sum&quot; : 16.0 &#125; &#125;, &#123; &quot;key&quot; : &quot;31.0-32.0&quot;, &quot;from&quot; : 31.0, &quot;to&quot; : 32.0, &quot;doc_count&quot; : 8, &quot;rating_stats&quot; : &#123; &quot;count&quot; : 16, &quot;min&quot; : 2.0, &quot;max&quot; : 10.0, &quot;avg&quot; : 7.5, &quot;sum&quot; : 120.0 &#125; &#125; ] &#125; &#125; ] &#125; &#125;&#125;å¦‚æ‚¨æ‰€è§ï¼Œæ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªåŒ…å«å¤šä¸ªå­˜å‚¨æ›´å¤šå­˜å‚¨æ¡¶çš„å¤§å­˜å‚¨æ¡¶ã€‚ æ‚¨è¿˜å¯ä»¥èŽ·å–æ¯ä¸ªå­˜å‚¨åˆ†åŒºçš„æŒ‡æ ‡ï¼ˆmetrics)ï¼Œä»¥åŠä¸æ–­æé«˜çš„å¤æ‚æ€§ã€‚ é€šè¿‡è¿™äº›ç®€å•çš„æž„å»ºå—ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨åµŒå¥—èšåˆä»Žæ•°æ®ä¸­èŽ·å¾—æ·±åˆ»è€Œå¤æ‚çš„è§è§£ã€‚]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearchï¼š Joinæ•°æ®ç±»åž‹]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%EF%BC%9A%20Join%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%2F</url>
    <content type="text"><![CDATA[åœ¨Elasticsearchä¸­ï¼ŒJoinå¯ä»¥è®©æˆ‘ä»¬åˆ›å»ºparent/childå…³ç³»ã€‚Elasticsearchä¸æ˜¯ä¸€ä¸ªRDMSã€‚é€šå¸¸joinæ•°æ®ç±»åž‹å°½é‡ä¸è¦ä½¿ç”¨ï¼Œé™¤éžä¸å¾—å·²ã€‚é‚£ä¹ˆElasticsearchä¸ºä»€ä¹ˆéœ€è¦Joinæ•°æ®ç±»åž‹å‘¢ï¼Ÿåœ¨Elasticsearchä¸­ï¼Œæ›´æ–°ä¸€ä¸ªobjectéœ€è¦root objectä¸€ä¸ªå®Œæ•´çš„reindexï¼šå³ä½¿æ˜¯ä¸€ä¸ªfieldçš„ä¸€ä¸ªå­—ç¬¦çš„æ”¹å˜å³ä¾¿æ˜¯nested objectä¹Ÿéœ€è¦å®Œæ•´çš„reindexæ‰å¯ä»¥å®žçŽ°æœç´¢é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™æ˜¯å®Œå…¨OKçš„ï¼Œä½†æ˜¯åœ¨æœ‰äº›åœºåˆä¸‹ï¼Œå¦‚æžœæˆ‘ä»¬æœ‰é¢‘ç¹çš„æ›´æ–°æ“ä½œï¼Œè¿™æ ·å¯èƒ½å¯¹æ€§èƒ½å¸¦æ¥å¾ˆå¤§çš„å½±å“ã€‚å¦‚æžœä½ çš„æ•°æ®éœ€è¦é¢‘ç¹çš„æ›´æ–°ï¼Œå¹¶å¸¦æ¥æ€§èƒ½ä¸Šçš„å½±å“ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œjoinæ•°æ®ç±»åž‹å¯èƒ½æ˜¯ä½ çš„ä¸€ä¸ªè§£å†³æ–¹æ¡ˆã€‚joinæ•°æ®ç±»åž‹å¯ä»¥å®Œå…¨åœ°æŠŠä¸¤ä¸ªobjectåˆ†å¼€ï¼Œä½†æ˜¯è¿˜æ˜¯ä¿æŒè¿™ä¸¤è€…ä¹‹å‰çš„å…³ç³»ã€‚parentåŠchildæ˜¯å®Œå…¨åˆ†å¼€çš„ä¸¤ä¸ªæ–‡æ¡£parentå¯ä»¥å•ç‹¬æ›´æ–°è€Œä¸éœ€è¦é‡æ–°reindex childchildrenå¯ä»¥ä»»æ„è¢«æ·»åŠ /ä¸²æ”¹/åˆ é™¤è€Œä¸å½±å“parentåŠå…¶å®ƒçš„childrenä¸Ž nestedç±»åž‹ç±»ä¼¼ï¼Œçˆ¶å­å…³ç³»ä¹Ÿå…è®¸æ‚¨å°†ä¸åŒçš„å®žä½“å…³è”åœ¨ä¸€èµ·ï¼Œä½†å®ƒä»¬åœ¨å®žçŽ°å’Œè¡Œä¸ºä¸Šæœ‰æ‰€ä¸åŒã€‚ ä¸Žnestedæ–‡æ¡£ä¸åŒï¼Œå®ƒä»¬ä¸åœ¨åŒä¸€æ–‡æ¡£ä¸­ï¼Œè€Œparent/childæ–‡æ¡£æ˜¯å®Œå…¨ç‹¬ç«‹çš„æ–‡æ¡£ã€‚ å®ƒä»¬éµå¾ªä¸€å¯¹å¤šå…³ç³»åŽŸåˆ™ï¼Œå…è®¸æ‚¨å°†ä¸€ç§ç±»åž‹å®šä¹‰ä¸ºparentç±»åž‹ï¼Œå°†ä¸€ç§æˆ–å¤šç§ç±»åž‹å®šä¹‰ä¸ºchildç±»åž‹å³ä¾¿joinæ•°æ®ç±»åž‹ç»™æˆ‘ä»¬å¸¦æ¥äº†æ–¹ä¾¿ï¼Œä½†æ˜¯ï¼Œå®ƒä¹Ÿåœ¨æœç´¢æ—¶ç»™æˆ‘å¸¦æ¥é¢å¤–çš„å†…å­˜åŠè®¡ç®—æ–¹ä¾¿çš„å¼€é”€ã€‚æ³¨æ„ï¼šç›®å‰Kibanaå¯¹nestedåŠjoinæ•°æ®ç±»åž‹æœ‰æ¯”è¾ƒå°‘çš„æ”¯æŒã€‚å¦‚æžœä½ æƒ³ä½¿ç”¨Kibanaæ¥åœ¨dashboardé‡Œå±•ç¤ºæ•°æ®ï¼Œè¿™ä¸ªæ–¹é¢çš„ä½ éœ€è¦è€ƒè™‘ã€‚åœ¨æœªæ¥ï¼Œè¿™ç§æƒ…å†µå¯èƒ½ä¼šå‘ç”Ÿæ”¹å˜ã€‚joinæ•°æ®ç±»åž‹æ˜¯ä¸€ä¸ªç‰¹æ®Šå­—æ®µï¼Œç”¨äºŽåœ¨åŒä¸€ç´¢å¼•çš„æ–‡æ¡£ä¸­åˆ›å»ºçˆ¶/å­å…³ç³»ã€‚ å…³ç³»éƒ¨åˆ†å®šä¹‰æ–‡æ¡£ä¸­çš„ä¸€ç»„å¯èƒ½å…³ç³»ï¼Œæ¯ä¸ªå…³ç³»æ˜¯çˆ¶ï¼ˆparent)åç§°å’Œå­ï¼ˆchild)åç§°ã€‚ä¸€ä¸ªä¾‹å­ï¼š12345678910111213PUT my_index&#123; &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;my_join_field&quot;: &#123; &quot;type&quot;: &quot;join&quot;, &quot;relations&quot;: &#123; &quot;question&quot;: &quot;answer&quot; &#125; &#125; &#125; &#125;&#125;åœ¨è¿™é‡Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå«åšmy_indexçš„ç´¢å¼•ã€‚åœ¨è¿™ä¸ªç´¢å¼•ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªfieldï¼Œå®ƒçš„åå­—æ˜¯my_join_fieldã€‚å®ƒçš„ç±»åž‹æ˜¯joinæ•°æ®ç±»åž‹ã€‚åŒæ—¶æˆ‘ä»¬å®šä¹‰äº†å•ä¸ªå…³ç³»ï¼šquestionæ˜¯answerçš„parentã€‚è¦ä½¿ç”¨joinæ¥indexæ–‡æ¡£ï¼Œå¿…é¡»åœ¨sourceä¸­æä¾›å…³ç³»çš„nameå’Œæ–‡æ¡£çš„å¯é€‰parentã€‚ ä¾‹å¦‚ï¼Œä»¥ä¸‹ç¤ºä¾‹åœ¨questionä¸Šä¸‹æ–‡ä¸­åˆ›å»ºä¸¤ä¸ªparentæ–‡æ¡£ï¼š123456789101112131415PUT my_index/_doc/1?refresh&#123; &quot;text&quot;: &quot;This is a question&quot;, &quot;my_join_field&quot;: &#123; &quot;name&quot;: &quot;question&quot; &#125;&#125; PUT my_index/_doc/2?refresh&#123; &quot;text&quot;: &quot;This is another question&quot;, &quot;my_join_field&quot;: &#123; &quot;name&quot;: &quot;question&quot; &#125;&#125;è¿™é‡Œé‡‡ç”¨refreshæ¥å¼ºåˆ¶è¿›è¡Œç´¢å¼•ï¼Œä»¥ä¾¿æŽ¥ä¸‹æ¥çš„æœç´¢ã€‚åœ¨è¿™é‡Œnameæ ‡è¯†questionï¼Œè¯´æ˜Žè¿™ä¸ªæ–‡æ¡£æ—¶ä¸€ä¸ªquestionæ–‡æ¡£ã€‚ç´¢å¼•parentæ–‡æ¡£æ—¶ï¼Œæ‚¨å¯ä»¥é€‰æ‹©ä»…å°†å…³ç³»çš„åç§°æŒ‡å®šä¸ºå¿«æ·æ–¹å¼ï¼Œè€Œä¸æ˜¯å°†å…¶å°è£…åœ¨æ™®é€šå¯¹è±¡è¡¨ç¤ºæ³•ä¸­ï¼š1234567891011PUT my_index/_doc/1?refresh&#123; &quot;text&quot;: &quot;This is a question&quot;, &quot;my_join_field&quot;: &quot;question&quot; &#125; PUT my_index/_doc/2?refresh&#123; &quot;text&quot;: &quot;This is another question&quot;, &quot;my_join_field&quot;: &quot;question&quot;&#125;è¿™ç§æ–¹æ³•å’Œå‰é¢çš„æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯è¿™é‡Œæˆ‘ä»¬åªä½¿ç”¨äº†question, è€Œä¸æ˜¯ä¸€ä¸ªåƒç¬¬ä¸€ç§æ–¹æ³•é‚£æ ·ï¼Œä½¿ç”¨å¦‚ä¸‹çš„ä¸€ä¸ªå¯¹è±¡æ¥è¡¨è¾¾ï¼š123&quot;my_join_field&quot;: &#123; &quot;name&quot;: &quot;question&quot; &#125;åœ¨å®žé™…çš„ä½¿ç”¨ä¸­ï¼Œä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„å–œå¥½æ¥ä½¿ç”¨ã€‚ç´¢å¼•childé¡¹æ—¶ï¼Œå¿…é¡»åœ¨_sourceä¸­æ·»åŠ å…³ç³»çš„åç§°ä»¥åŠæ–‡æ¡£çš„parent idã€‚æ³¨æ„ï¼šéœ€è¦åœ¨åŒä¸€åˆ†ç‰‡ä¸­ç´¢å¼•çˆ¶çº§çš„è°±ç³»ï¼Œå¿…é¡»ä½¿ç”¨å…¶parentçš„idæ¥ç¡®ä¿è¿™ä¸ªchildå’Œparentæ˜¯åœ¨ä¸€ä¸ªshardä¸­ã€‚æ¯ä¸ªæ–‡æ¡£åˆ†é…åœ¨é‚£ä¸ªshardä¹‹ä¸­åœ¨é»˜è®¤çš„æƒ…å†µä¸‹æ˜¯æŒ‰ç…§æ–‡æ¡£çš„idè¿›è¡Œä¸€äº›hashæ¥åˆ†é…çš„ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡routingæ¥è¿›è¡Œã€‚é’ˆå¯¹childï¼Œæˆ‘ä»¬ä½¿ç”¨å…¶parentçš„idï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯ã€‚å¦åˆ™åœ¨æˆ‘ä»¬joinæ•°æ®çš„æ—¶å€™ï¼Œè·¨shardæ˜¯éžå¸¸å¤§çš„ä¸€ä¸ªæ¶ˆè´¹ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºå¦‚ä½•ç´¢å¼•ä¸¤ä¸ªchildæ–‡æ¡£ï¼š1234567891011121314151617PUT my_index/_doc/3?routing=1?refresh (1)&#123; &quot;text&quot;: &quot;This is an answer&quot;, &quot;my_join_field&quot;: &#123; &quot;name&quot;: &quot;answer&quot;, (2) &quot;parent&quot;: &quot;1&quot; (3) &#125;&#125; PUT my_index/_doc/4?routing=1?refresh&#123; &quot;text&quot;: &quot;This is another answer&quot;, &quot;my_join_field&quot;: &#123; &quot;name&quot;: &quot;answer&quot;, &quot;parent&quot;: &quot;1&quot; &#125;&#125;åœ¨ä¸Šé¢çš„ï¼ˆ1ï¼‰å¤„ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨routingï¼Œè¿™æ ·èƒ½ç¡®ä¿parentå’Œchildæ˜¯åœ¨åŒä¸€ä¸ªshardé‡Œã€‚æˆ‘ä»¬è¿™é‡Œroutingä¸º1ï¼Œè¿™æ˜¯å› ä¸ºparentçš„id ä¸º1ï¼Œåœ¨ï¼ˆ3ï¼‰å¤„å®šä¹‰ã€‚(2) å¤„å®šä¹‰äº†è¯¥æ–‡æ¡£joinçš„åç§°ã€‚parent-joinåŠå…¶æ€§èƒ½joinå­—æ®µä¸åº”åƒå…³ç³»æ•°æ®åº“ä¸­çš„è¿žæŽ¥ä¸€æ ·ä½¿ç”¨ã€‚ åœ¨Elasticsearchä¸­ï¼Œè‰¯å¥½æ€§èƒ½çš„å…³é”®æ˜¯å°†æ•°æ®åŽ»è§„èŒƒåŒ–ä¸ºæ–‡æ¡£ã€‚ æ¯ä¸ªè¿žæŽ¥å­—æ®µhas_childæˆ–has_parentæŸ¥è¯¢éƒ½ä¼šå¯¹æŸ¥è¯¢æ€§èƒ½äº§ç”Ÿé‡å¤§å½±å“ã€‚joinå­—æ®µæœ‰æ„ä¹‰çš„å”¯ä¸€æƒ…å†µæ˜¯ï¼Œå¦‚æžœæ‚¨çš„æ•°æ®åŒ…å«ä¸€å¯¹å¤šå…³ç³»ï¼Œå…¶ä¸­ä¸€ä¸ªå®žä½“æ˜Žæ˜¾è¶…è¿‡å¦ä¸€ä¸ªå®žä½“ã€‚ è¿™ç§æƒ…å†µçš„ä¸€ä¸ªä¾‹å­æ˜¯äº§å“çš„ç”¨ä¾‹å’Œè¿™äº›äº§å“çš„æŠ¥ä»·ã€‚ å¦‚æžœæä¾›çš„äº§å“æ•°é‡æ˜Žæ˜¾å¤šäºŽäº§å“æ•°é‡ï¼Œåˆ™å°†äº§å“å»ºæ¨¡ä¸ºçˆ¶æ–‡æ¡£å¹¶å°†äº§å“å»ºæ¨¡ä¸ºå­æ–‡æ¡£æ˜¯æœ‰æ„ä¹‰çš„ã€‚parent-joinçš„é™åˆ¶å¯¹äºŽæ¯ä¸ªindexæ¥è¯´ï¼Œåªèƒ½æœ‰ä¸€ä¸ªjoinå­—æ®µparentåŠchildæ–‡æ¡£ï¼Œå¿…é¡»æ˜¯åœ¨ä¸€ä¸ªshardé‡Œå»ºç«‹ç´¢å¼•ã€‚è¿™ä¹Ÿæ„å‘³ç€ï¼ŒåŒæ ·çš„routingå€¼å¿…é¡»åº”ç”¨äºŽgetting, deletingæˆ–updatingä¸€ä¸ªchildæ–‡æ¡£ã€‚ä¸€ä¸ªå…ƒç´ å¯ä»¥æœ‰å¤šä¸ªchildrenï¼Œä½†æ˜¯åªèƒ½æœ‰ä¸€ä¸ªparent.å¯ä»¥å¯¹å·²æœ‰çš„joiné¡¹æ·»åŠ æ–°çš„å…³ç³»ä¹Ÿå¯ä»¥å°†childæ·»åŠ åˆ°çŽ°æœ‰å…ƒç´ ï¼Œä½†ä»…å½“å…ƒç´ å·²ç»æ˜¯parentæ—¶æ‰å¯ä»¥ã€‚é’ˆå¯¹parent-joinçš„æœç´¢parent-joinåˆ›å»ºä¸€ä¸ªå­—æ®µæ¥ç´¢å¼•æ–‡æ¡£ä¸­å…³ç³»çš„åç§°ï¼ˆmy_parentï¼Œmy_childï¼Œâ€¦ï¼‰ã€‚å®ƒè¿˜ä¸ºæ¯ä¸ªparent/childå…³ç³»åˆ›å»ºä¸€ä¸ªå­—æ®µã€‚ æ­¤å­—æ®µçš„åç§°æ˜¯joinå­—æ®µçš„åç§°ï¼ŒåŽè·Ÿï¼ƒå’Œå…³ç³»ä¸­parentçš„åç§°ã€‚ å› æ­¤ï¼Œä¾‹å¦‚å¯¹äºŽmy_parentâ‡’[my_childï¼Œanother_child]å…³ç³»ï¼Œjoinå­—æ®µä¼šåˆ›å»ºä¸€ä¸ªåä¸ºmy_join_fieldï¼ƒmy_parentçš„é™„åŠ å­—æ®µã€‚å¦‚æžœæ–‡æ¡£æ˜¯å­æ–‡ä»¶ï¼ˆmy_childæˆ–another_childï¼‰ï¼Œåˆ™æ­¤å­—æ®µåŒ…å«æ–‡æ¡£é“¾æŽ¥åˆ°çš„parent_idï¼Œå¦‚æžœæ–‡æ¡£æ˜¯parentæ–‡ä»¶ï¼ˆmy_parentï¼‰ï¼Œåˆ™åŒ…å«æ–‡æ¡£çš„_idã€‚æœç´¢åŒ…å«joinå­—æ®µçš„ç´¢å¼•æ—¶ï¼Œå§‹ç»ˆåœ¨æœç´¢å“åº”ä¸­è¿”å›žè¿™ä¸¤ä¸ªå­—æ®µï¼šä¸Šé¢çš„æè¿°æ¯”è¾ƒç»•å£ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä»¥ä¸€ä¸ªä¾‹å­æ¥è¯´è¯´æ˜Žå§ï¼š1234567GET my_index/_search&#123; &quot;query&quot;: &#123; &quot;match_all&quot;: &#123;&#125; &#125;, &quot;sort&quot;: [&quot;_id&quot;]&#125;è¿™é‡Œæˆ‘ä»¬æœç´¢æ‰€æœ‰çš„æ–‡æ¡£ï¼Œå¹¶ä»¥_idè¿›è¡ŒæŽ’åºï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879&#123; &quot;took&quot; : 2, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 4, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : null, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;my_index&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : null, &quot;_source&quot; : &#123; &quot;text&quot; : &quot;This is a question&quot;, &quot;my_join_field&quot; : &quot;question&quot; (1) &#125;, &quot;sort&quot; : [ &quot;1&quot; ] &#125;, &#123; &quot;_index&quot; : &quot;my_index&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;2&quot;, &quot;_score&quot; : null, &quot;_source&quot; : &#123; &quot;text&quot; : &quot;This is another question&quot;, &quot;my_join_field&quot; : &quot;question&quot; (2) &#125;, &quot;sort&quot; : [ &quot;2&quot; ] &#125;, &#123; &quot;_index&quot; : &quot;my_index&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;3&quot;, &quot;_score&quot; : null, &quot;_routing&quot; : &quot;1&quot;, &quot;_source&quot; : &#123; &quot;text&quot; : &quot;This is an answer&quot;, &quot;my_join_field&quot; : &#123; &quot;name&quot; : &quot;answer&quot;, (3) &quot;parent&quot; : &quot;1&quot; (4) &#125; &#125;, &quot;sort&quot; : [ &quot;3&quot; ] &#125;, &#123; &quot;_index&quot; : &quot;my_index&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;4&quot;, &quot;_score&quot; : null, &quot;_routing&quot; : &quot;1&quot;, &quot;_source&quot; : &#123; &quot;text&quot; : &quot;This is another answer&quot;, &quot;my_join_field&quot; : &#123; &quot;name&quot; : &quot;answer&quot;, &quot;parent&quot; : &quot;1&quot; &#125; &#125;, &quot;sort&quot; : [ &quot;4&quot; ] &#125; ] &#125;&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°4ä¸ªæ–‡æ¡£ï¼š(1)è¡¨æ˜Žè¿™ä¸ªæ–‡æ¡£æ˜¯ä¸€ä¸ªquestion join(2)è¡¨æ˜Žè¿™ä¸ªæ–‡æ¡£æ˜¯ä¸€ä¸ªquestion join(3)è¡¨æ˜Žè¿™ä¸ªæ–‡æ¡£æ˜¯ä¸€ä¸ªanswer join(4)è¡¨æ˜Žè¿™ä¸ªæ–‡æ¡£çš„parentæ˜¯idä¸º1çš„æ–‡æ¡£Parent-join æŸ¥è¯¢åŠaggregationå¯ä»¥åœ¨aggregationå’Œscriptä¸­è®¿é—®joinå­—æ®µçš„å€¼ï¼Œå¹¶å¯ä»¥ä½¿ç”¨parent_idæŸ¥è¯¢è¿›è¡ŒæŸ¥è¯¢ï¼š123456789GET my_index/_search&#123; &quot;query&quot;: &#123; &quot;parent_id&quot;: &#123; &quot;type&quot;: &quot;answer&quot;, &quot;id&quot;: &quot;1&quot; &#125; &#125;&#125;æˆ‘ä»¬é€šè¿‡æŸ¥è¯¢parent_idï¼Œè¿”å›žæ‰€æœ‰parent_idä¸º1çš„æ‰€æœ‰answerç±»åž‹çš„æ–‡æ¡£ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&#123; &quot;took&quot; : 0, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 2, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 0.35667494, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;my_index&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;4&quot;, &quot;_score&quot; : 0.35667494, &quot;_routing&quot; : &quot;1&quot;, &quot;_source&quot; : &#123; &quot;text&quot; : &quot;This is another answer&quot;, &quot;my_join_field&quot; : &#123; &quot;name&quot; : &quot;answer&quot;, &quot;parent&quot; : &quot;1&quot; &#125; &#125; &#125;, &#123; &quot;_index&quot; : &quot;my_index&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;3&quot;, &quot;_score&quot; : 0.35667494, &quot;_routing&quot; : &quot;1&quot;, &quot;_source&quot; : &#123; &quot;text&quot; : &quot;This is an answer&quot;, &quot;my_join_field&quot; : &#123; &quot;name&quot; : &quot;answer&quot;, &quot;parent&quot; : &quot;1&quot; &#125; &#125; &#125; ] &#125;&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿”å›židä¸º3å’Œ4çš„æ–‡æ¡£ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹è¿™äº›æ–‡æ¡£è¿›è¡Œaggregation:123456789101112131415161718192021222324GET my_index/_search&#123; &quot;query&quot;: &#123; &quot;parent_id&quot;: &#123; &quot;type&quot;: &quot;answer&quot;, &quot;id&quot;: &quot;1&quot; &#125; &#125;, &quot;aggs&quot;: &#123; &quot;parents&quot;: &#123; &quot;terms&quot;: &#123; &quot;field&quot;: &quot;my_join_field#question&quot;, &quot;size&quot;: 10 &#125; &#125; &#125;, &quot;script_fields&quot;: &#123; &quot;parent&quot;: &#123; &quot;script&quot;: &#123; &quot;source&quot;: &quot;doc[&apos;my_join_field#question&apos;]&quot; &#125; &#125; &#125;&#125;å°±åƒæˆ‘ä»¬åœ¨ä¸Šä¸€èŠ‚ä¸­ä»‹ç»çš„é‚£æ ·ï¼Œ åœ¨æˆ‘ä»¬çš„åº”ç”¨å®žä¾‹ä¸­ï¼Œåœ¨indexæ—¶ï¼Œå®ƒä¹Ÿåˆ›å»ºä¸€ä¸ªé¢å¤–çš„ä¸€ä¸ªå­—æ®µï¼Œè™½ç„¶åœ¨sourceé‡Œæˆ‘ä»¬çœ‹ä¸åˆ°ã€‚è¿™ä¸ªå­—æ®µå°±æ˜¯my_join_filed#questionï¼Œè¿™ä¸ªå­—æ®µå«æœ‰parent _idã€‚åœ¨ä¸Šé¢çš„æŸ¥è¯¢ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆæŸ¥è¯¢æ‰€æœ‰çš„parent_idä¸º1çš„æ‰€æœ‰çš„answerç±»åž‹çš„æ–‡æ¡£ã€‚æŽ¥ä¸‹æ¥å¯¹æ‰€æœ‰çš„æ–‡æ¡£ä»¥parent_idè¿›è¡Œèšåˆï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455&#123; &quot;took&quot; : 0, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 2, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 0.35667494, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;my_index&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;4&quot;, &quot;_score&quot; : 0.35667494, &quot;_routing&quot; : &quot;1&quot;, &quot;fields&quot; : &#123; &quot;parent&quot; : [ &quot;1&quot; ] &#125; &#125;, &#123; &quot;_index&quot; : &quot;my_index&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;3&quot;, &quot;_score&quot; : 0.35667494, &quot;_routing&quot; : &quot;1&quot;, &quot;fields&quot; : &#123; &quot;parent&quot; : [ &quot;1&quot; ] &#125; &#125; ] &#125;, &quot;aggregations&quot; : &#123; &quot;parents&quot; : &#123; &quot;doc_count_error_upper_bound&quot; : 0, &quot;sum_other_doc_count&quot; : 0, &quot;buckets&quot; : [ &#123; &quot;key&quot; : &quot;1&quot;, &quot;doc_count&quot; : 2 &#125; ] &#125; &#125;&#125;ä¸€ä¸ªparentå¯¹åº”å¤šä¸ªchildå¯¹äºŽä¸€ä¸ªparentæ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰å¤šä¸ªchildï¼Œæ¯”å¦‚ï¼š12345678910111213PUT my_index&#123; &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;my_join_field&quot;: &#123; &quot;type&quot;: &quot;join&quot;, &quot;relations&quot;: &#123; &quot;question&quot;: [&quot;answer&quot;, &quot;comment&quot;] &#125; &#125; &#125; &#125;&#125;åœ¨è¿™é‡Œï¼Œquestionæ˜¯answeråŠcommentçš„parentã€‚å¤šå±‚çš„parent joinè™½ç„¶è¿™ä¸ªä¸å»ºè®®ï¼Œè¿™æ ·åšå¯èƒ½ä¼šå¯èƒ½åœ¨queryæ—¶å¸¦æ¥æ›´å¤šçš„å†…å­˜åŠè®¡ç®—æ–¹é¢çš„å¼€é”€ï¼š1234567891011121314PUT my_index&#123; &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;my_join_field&quot;: &#123; &quot;type&quot;: &quot;join&quot;, &quot;relations&quot;: &#123; &quot;question&quot;: [&quot;answer&quot;, &quot;comment&quot;], &quot;answer&quot;: &quot;vote&quot; &#125; &#125; &#125; &#125;&#125;è¿™é‡Œquestionæ˜¯answeråŠcommentçš„parentï¼ŒåŒæ—¶answerä¹Ÿæ˜¯voteçš„parentã€‚å®ƒè¡¨æ˜Žäº†å¦‚ä¸‹çš„å…³ç³»ï¼šç´¢å¼•grandchildæ–‡æ¡£éœ€routingå€¼ç­‰äºŽgrand-parentï¼ˆè°±ç³»é‡Œçš„æ›´å¤§parentï¼‰ï¼š12345678PUT my_index/_doc/3?routing=1&amp;refresh &#123; &quot;text&quot;: &quot;This is a vote&quot;, &quot;my_join_field&quot;: &#123; &quot;name&quot;: &quot;vote&quot;, &quot;parent&quot;: &quot;2&quot; &#125;&#125;è¿™ä¸ªchildæ–‡æ¡£å¿…é¡»æ˜¯å’Œä»–çš„grand-parentåœ¨ä¸€ä¸ªshardé‡Œã€‚åœ¨è¿™é‡Œå®ƒä½¿ç”¨äº†1ï¼Œä¹Ÿå³questionçš„idã€‚åŒæ—¶ï¼Œå¯¹äºŽvoteæ¥è¯´ï¼Œå®ƒçš„parentå¿…é¡»æ˜¯å®ƒçš„parentï¼Œä¹Ÿå³answerçš„idã€‚æ›´å¤šå‚è€ƒï¼šhttps://www.elastic.co/guide/en/elasticsearch/reference/7.3/parent-join.html]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearch ä½¿ç”¨URI Search]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%20%E4%BD%BF%E7%94%A8URI%20Search%2F</url>
    <content type="text"><![CDATA[åœ¨Elasticsearchä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨_searchç»ˆç«¯è¿›è¡Œæœç´¢ã€‚è¿™ä¸ªåœ¨æˆ‘ä¹‹å‰çš„æ–‡ç«  â€œå¼€å§‹ä½¿ç”¨Elasticsearch ï¼ˆ2ï¼‰â€ ä¸­æœ‰å¾ˆå¤šçš„æè¿°ã€‚é’ˆå¯¹è¿™ç§æœç´¢ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¼ºå¤§çš„DSLè¿›è¡Œæœç´¢ã€‚åœ¨Elasticsearchä¸­ï¼Œè¿˜æœ‰ä¸€ç±»æ˜¯åŸºäºŽURIçš„æœç´¢ã€‚å¯¹äºŽè¿™ç§å®ƒå¯ä»¥å¾ˆæ–¹ä¾¿åœ°ç›´æŽ¥åœ¨æµè§ˆå™¨ä¸­çš„åœ°å€æ æˆ–å‘½ä»¤è¡Œä¸­ç›´æŽ¥ä½¿ç”¨ã€‚ ä½¿ç”¨æ­¤æ¨¡å¼æ‰§è¡Œæœç´¢æ—¶ï¼Œå¹¶éžæ‰€æœ‰æœç´¢é€‰é¡¹éƒ½å…¬å¼€ï¼Œä½†æ˜¯å¯¹äºŽå¿«é€Ÿçš„â€œcurl testsâ€æ¥è¯´ï¼Œå®ƒå¯èƒ½å¾ˆæ–¹ä¾¿ã€‚åœ¨ä»Šå¤©çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æ¥åšä¸€ä¸ªç®€å•çš„æè¿°ã€‚åŒæ—¶æˆ‘éœ€è¦æŒ‡å‡ºæ¥çš„æ˜¯ï¼Œè¿™é‡Œçš„è¯­æ³•å’ŒKibanaä¸­çš„Search Baræœç´¢è¯­æ³•æ˜¯ä¸€æ ·çš„ã€‚å®‰è£…Elastic Stackå‡†å¤‡å¥½æ•°æ®ä¸ºäº†è¯´æ˜Žé—®é¢˜çš„æ–¹ä¾¿ï¼Œæˆ‘ä»¬é¦–å…ˆåœ¨Kibanaä¸­ä½¿ç”¨å¦‚ä¸‹çš„bulkæŒ‡ä»¤æ¥åˆ›å»ºæˆ‘ä»¬çš„twitterç´¢å¼•ã€‚12345678910111213POST _bulk&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 1&#125; &#125;&#123;&quot;user&quot;:&quot;å¼ ä¸‰&quot;,&quot;message&quot;:&quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;,&quot;uid&quot;:2,&quot;age&quot;:20,&quot;city&quot;:&quot;åŒ—äº¬&quot;,&quot;province&quot;:&quot;åŒ—äº¬&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;39.970718&quot;,&quot;lon&quot;:&quot;116.325747&quot;&#125;, &quot;DOB&quot;:&quot;1980-12-01&quot;&#125;&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 2 &#125;&#125;&#123;&quot;user&quot;:&quot;è€åˆ˜&quot;,&quot;message&quot;:&quot;å‡ºå‘ï¼Œä¸‹ä¸€ç«™äº‘å—ï¼&quot;,&quot;uid&quot;:3,&quot;age&quot;:30,&quot;city&quot;:&quot;åŒ—äº¬&quot;,&quot;province&quot;:&quot;åŒ—äº¬&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½åŒ—äº¬å¸‚ä¸œåŸŽåŒºå°åŸºåŽ‚ä¸‰æ¡3å·&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;39.904313&quot;,&quot;lon&quot;:&quot;116.412754&quot;&#125;, &quot;DOB&quot;:&quot;1981-12-01&quot;&#125;&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 3&#125; &#125;&#123;&quot;user&quot;:&quot;æŽå››&quot;,&quot;message&quot;:&quot;happy birthday!&quot;,&quot;uid&quot;:4,&quot;age&quot;:30,&quot;city&quot;:&quot;åŒ—äº¬&quot;,&quot;province&quot;:&quot;åŒ—äº¬&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½åŒ—äº¬å¸‚ä¸œåŸŽåŒº&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;39.893801&quot;,&quot;lon&quot;:&quot;116.408986&quot;&#125;, &quot;DOB&quot;:&quot;1982-12-01&quot;&#125;&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 4&#125; &#125;&#123;&quot;user&quot;:&quot;è€è´¾&quot;,&quot;message&quot;:&quot;123,gogogo&quot;,&quot;uid&quot;:5,&quot;age&quot;:35,&quot;city&quot;:&quot;åŒ—äº¬&quot;,&quot;province&quot;:&quot;åŒ—äº¬&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½åŒ—äº¬å¸‚æœé˜³åŒºå»ºå›½é—¨&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;39.718256&quot;,&quot;lon&quot;:&quot;116.367910&quot;&#125;, &quot;DOB&quot;:&quot;1983-12-01&quot;&#125;&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 5&#125; &#125;&#123;&quot;user&quot;:&quot;è€çŽ‹&quot;,&quot;message&quot;:&quot;Happy BirthDay My Friend!&quot;,&quot;uid&quot;:6,&quot;age&quot;:50,&quot;city&quot;:&quot;åŒ—äº¬&quot;,&quot;province&quot;:&quot;åŒ—äº¬&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½åŒ—äº¬å¸‚æœé˜³åŒºå›½è´¸&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;39.918256&quot;,&quot;lon&quot;:&quot;116.467910&quot;&#125;, &quot;DOB&quot;:&quot;1984-12-01&quot;&#125;&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 6&#125; &#125;&#123;&quot;user&quot;:&quot;è€å´&quot;,&quot;message&quot;:&quot;å¥½å‹æ¥äº†éƒ½ä»Šå¤©æˆ‘ç”Ÿæ—¥ï¼Œå¥½å‹æ¥äº†,ä»€ä¹ˆ birthday happy å°±æˆ!&quot;,&quot;uid&quot;:7,&quot;age&quot;:90,&quot;city&quot;:&quot;ä¸Šæµ·&quot;,&quot;province&quot;:&quot;ä¸Šæµ·&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½ä¸Šæµ·å¸‚é—µè¡ŒåŒº&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;31.175927&quot;,&quot;lon&quot;:&quot;121.383328&quot;&#125;, &quot;DOB&quot;:&quot;1985-12-01&quot;&#125;è¿™é‡Œæ€»å…±æœ‰6æ¡æ•°æ®ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥è¿›è¡Œä¸€äº›æŸ¥è¯¢çš„åŠ¨ä½œã€‚æœç´¢æ•°æ®é¦–å…ˆï¼Œæˆ‘ä»¬åšä¸€ä¸ªç®€å•çš„æœç´¢ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æµè§ˆå™¨ä¸­æ‰“å…¥å¦‚ä¸‹çš„å‘½ä»¤ï¼š1GET twitter/_search?q=user:å¼ ä¸‰æˆ‘ä»¬é€šè¿‡ â€œq=user:å¼ ä¸‰â€ æŸ¥è¯¢åˆ°æˆ‘ä»¬æ‰€éœ€è¦çš„æ–‡æ¡£ã€‚åœ¨æœ‰çš„æ—¶å€™è¿™æ˜¯ä¸€ç§éžå¸¸å¿«çš„æŸ¥è¯¢æ–¹å¼ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨æµè§ˆå™¨ä¸­ç›´æŽ¥æ‰“å…¥ä¸€ä¸ªè¿™æ ·çš„URI:1http://localhost:9200/_search?q=user:%E5%BC%A0%E4%B8%89&amp;prettyæˆ–è€…åœ¨å‘½ä»¤è¡Œä¸­ï¼šä¸‹é¢ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨Kibanaæ¥å±•ç¤ºä½¿ç”¨URIæœç´¢çš„ä¸€äº›æœ€åŸºæœ¬çš„ç‰¹ç‚¹ã€‚URIæŸ¥è¯¢ä½¿ç”¨è¯­æ³•æ ¹æ®è¿ç®—ç¬¦ï¼ˆä¾‹å¦‚ORï¼ŒANDæˆ–NOTï¼‰è§£æžå’Œæ‹†åˆ†æä¾›çš„æŸ¥è¯¢å­—ç¬¦ä¸²æˆ‘ä»¬æƒ³ä½¿ç”¨sortæ¥å¯¹æ•°æ®è¿›è¡ŒæŽ’åºï¼š1GET twitter/_search?q=city:&quot;åŒ—äº¬&quot;&amp;sort=DOB:descä¸Šé¢æ˜¾ç¤ºäº†æ‰€æœ‰æ¥è‡ªåŒ—äº¬çš„ç”¨æˆ·ï¼Œå¹¶æŒ‰ç…§å‡ºç”Ÿå¹´æœˆé™åºæŽ’åˆ—ã€‚å‡å¦‚æˆ‘ä»¬åªæƒ³åœ¨_sourceé‡Œæ˜¾ç¤ºå¹´é¾„ï¼ŒDOBåŠåŸŽå¸‚ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼š1GET twitter/_search?q=city:&quot;åŒ—äº¬&quot;&amp;sort=DOB:desc&amp;_source=city,age,DOBä»Žä¸Šé¢çš„æ˜¾ç¤ºå¯ä»¥çœ‹å‡ºæ¥ï¼Œæˆ‘ä»¬åªçœ‹åˆ°æœ‰ä¸‰ä¸ªå­—æ®µæ˜¾ç¤ºå‡ºæ¥ã€‚åŠ å…¥æˆ‘ä»¬æƒ³åˆ†é¡µï¼Œæ¯ä¸ªé¡µåªæœ‰2ä¸ªæ–‡æ¡£ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼š1GET twitter/_search?q=city:&quot;åŒ—äº¬&quot;&amp;sort=DOB:desc&amp;_source=city,age,DOB&amp;size=2ä»Žä¸Šé¢çš„æ˜¾ç¤ºä¸Šæˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ï¼Œåªæœ‰ä¸¤ä¸ªæ–‡æ¡£è¢«æ˜¾ç¤ºå‡ºæ¥å°½ç®¡æ€»å…±æœ‰5ä¸ªæ–‡æ¡£æ»¡è¶³æ¡ä»¶ã€‚å‡å¦‚è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬æƒ³å¯¹cityä¸ºâ€œä¸Šæµ·â€å’Œâ€œåŒ—äº¬â€çš„æ‰€æœ‰ç”¨æˆ·éƒ½æ¥ç»Ÿè®¡ä¸€ä¸‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„è¯­å¥ï¼š1GET twitter/_search?q=city:(&quot;åŒ—äº¬&quot; or &quot;ä¸Šæµ·&quot;) &amp;sort=DOB:desc&amp;_source=city,age,DOB&amp;size=2æ˜¾ç„¶è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¾—åˆ°äº†6æ¡æ•°æ®ã€‚ä¸Šæµ·å’ŒåŒ—äº¬çš„æ‰€æœ‰ç”¨æˆ·éƒ½è¢«æœç´¢å‡ºæ¥äº†ã€‚å‡å¦‚æˆ‘ä»¬æƒ³æŸ¥è¯¢æ¥è‡ªâ€œåŒ—äº¬â€å¹¶ä¸”åå­—å«åšâ€œå¼ ä¸‰â€çš„æ–‡æ¡£ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆæŸ¥è¯¢ï¼š1GET twitter/_search?q=city:&quot;åŒ—äº¬&quot; AND user:&quot;å¼ ä¸‰ä»Žä¸Šé¢å¯ä»¥çœ‹å‡ºæ¥å°±åªæœ‰ä¸€æ¡æ•°æ®ã€‚å‡å¦‚æˆ‘ä»¬æƒ³å¾—åˆ°æ¥é™¤äº†ä¸Šæµ·ä»¥å¤–åœ°åŒºçš„æ‰€æœ‰çš„ç”¨æˆ·ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æ–¹æ³•æ¥å¾—åˆ°ï¼š1GET twitter/_search?q=NOT city:&quot;ä¸Šæµ·&quot;æˆ‘ä»¬çœ‹åˆ°äº†5ä¸ªæ•°æ®ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹æŸäº›æƒ³è¿›è¡ŒåŠ æƒï¼Œä»¥ä½¿å¾—å®ƒä»¬èƒ½å¤ŸæŽ’åœ¨æ›´å‰é¢ï¼Œæ¯”å¦‚ï¼šä¸Šé¢çš„æŸ¥è¯¢æ˜¯å¯»æ‰¾å¹´é¾„æ˜¯20å²çš„ï¼Œæˆ–è€…æ˜¯æ¥è‡ªä¸Šæµ·çš„äººã€‚ä»Žæœç´¢çš„ç»“æžœæ¥çœ‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸Šæµ·çš„è€å´æ˜¯æŽ’åœ¨å‰é¢ã€‚å¦‚æžœæˆ‘ä»¬æƒ³å¯¹å¹´é¾„ä¸º20å²çš„äººéœ€è¦æœ‰æ›´å¤šçš„å…³æ³¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¯¹å®ƒä»¬çš„æœç´¢ç»“æžœè¿›è¡ŒåŠ æƒï¼Œè¿™æ ·ä¼šä½¿å¾—å®ƒä»¬çš„åˆ†æ•°æ›´é«˜ã€‚æˆ‘ä»¬å¯ä»¥é‡‡ç”¨å¦‚ä¸‹çš„æ–¹æ³•æ¥åšï¼š1GET twitter/_search?q=(age:20^5 OR city:&quot;ä¸Šæµ·&quot;)åœ¨ä¸Šé¢ï¼Œæˆ‘ä»¬æ˜¾ç„¶å¯¹ageä¸º20çš„è¿™ä¸ªé€‰é¡¹è¿›è¡Œäº†åŠ æƒã€‚é‚£ä¹ˆæœç´¢åŽçš„ç»“æžœä¸ºï¼šæˆ‘ä»¬å¯ä»¥çœ‹åˆ°çŽ°åœ¨ageä¸º20å²çš„å¼ ä¸‰æŽ’åˆ°äº†æœç´¢ç»“æžœçš„å‰é¢ã€‚å‡å¦‚æˆ‘ä»¬ä¸æŒ‡å®šä»»ä½•çš„fieldçš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªæœç´¢å°†å¯¹æ‰€æœ‰çš„fieldéƒ½è¿›è¡Œï¼š1GET twitter/_search?q=å¼ ä¸‰å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿›è¡Œfuzzyæœç´¢ï¼šä¸Šé¢æ ‡æ˜Žæœ‰ä¸€ä¸ªedité”™è¯¯ä¹Ÿå¯ä»¥è¢«æœç´¢å‡ºæ¥ã€‚å¯¹äºŽä¸­æ–‡çš„æ£€ç´¢ï¼Œè¿™ä¸ªä¾èµ–äºŽåˆ†è¯å™¨ã€‚åœ¨æˆ‘ä»¬çš„å®žéªŒä¸­æ²¡æœ‰ä½¿ç”¨å…·ä½“çš„åˆ†è¯å™¨ã€‚è¿™ä¸ªå’Œå®žé™…çš„ä½¿ç”¨å¯èƒ½ä¼šæœ‰åŒºåˆ«ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹ä¸€ä¸‹èŒƒå›´è¿›è¡Œæœç´¢ï¼š1GET twitter/_search?q=age:[20 TO 30]ä¸Šé¢æœç´¢çš„ç»“æžœæ˜¯ä»Ž20å²åˆ°30å²çš„æ‰€æœ‰çš„ç»“æžœï¼Œå¹¶ä¸”éƒ½åŒ…å«åœ¨é‡Œé¢ã€‚æˆ‘ä»¬å¦‚æžœä¸æƒ³åŒ…å«30å²çš„è¯ï¼Œé‚£ä¹ˆå¯ä»¥å†™æˆè¿™æ ·çš„æ ¼å¼ï¼šæˆ‘ä»¬ä½¿ç”¨[20 TO 30}ï¼Œ å¦‚æžœæˆ‘ä»¬æƒ³æœç´¢åœ¨30å²ä¸€ä¸‹çš„æ‰€æœ‰æ–‡æ¡£ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æœç´¢æ–¹å¼ï¼šåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨[* TO 30}ï¼Œè¿™é‡Œä¸åŒ…å«30ã€‚å¥½äº†ä»Šå¤©å°±è®²åˆ°è¿™é‡Œã€‚è¿™é‡Œçš„æ‰€æœ‰çš„è¯­æ³•ä¹Ÿé€‚ç”¨äºŽåœ¨Kibanaä¸­çš„Search Barã€‚å¦‚æžœæˆ‘ä»¬ç†Ÿç»ƒåœ°æŽŒæ¡äº†è¿™äº›ï¼Œä¹Ÿå¯ä»¥å¾ˆæ–¹ä¾¿åœ°è®©æˆ‘ä»¬ç†Ÿç»ƒåœ°æ“ä½œKibanaä¸­æœç´¢ã€‚å‚è€ƒï¼šã€1ã€‘https://www.elastic.co/guide/en/elasticsearch/reference/current/query-filter-context.htmlã€2ã€‘https://www.elastic.co/guide/en/elasticsearch/reference/7.4/search-uri-request.html]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearch rollover API]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%20rollover%20API%2F</url>
    <content type="text"><![CDATA[rolloverä½¿æ‚¨å¯ä»¥æ ¹æ®ç´¢å¼•å¤§å°ï¼Œæ–‡æ¡£æ•°æˆ–ä½¿ç”¨æœŸé™è‡ªåŠ¨è¿‡æ¸¡åˆ°æ–°ç´¢å¼•ã€‚ å½“rolloverè§¦å‘åŽï¼Œå°†åˆ›å»ºæ–°ç´¢å¼•ï¼Œå†™åˆ«åï¼ˆwrite alias)å°†æ›´æ–°ä¸ºæŒ‡å‘æ–°ç´¢å¼•ï¼Œæ‰€æœ‰åŽç»­æ›´æ–°éƒ½å°†å†™å…¥æ–°ç´¢å¼•ã€‚å¯¹äºŽåŸºäºŽæ—¶é—´çš„rolloveræ¥è¯´ï¼ŒåŸºäºŽå¤§å°ï¼Œæ–‡æ¡£æ•°æˆ–ä½¿ç”¨æœŸé™è¿‡æ¸¡è‡³æ–°ç´¢å¼•æ˜¯æ¯”è¾ƒé€‚åˆçš„ã€‚ åœ¨ä»»æ„æ—¶é—´rolloveré€šå¸¸ä¼šå¯¼è‡´è®¸å¤šå°çš„ç´¢å¼•ï¼Œè¿™å¯èƒ½ä¼šå¯¹æ€§èƒ½å’Œèµ„æºä½¿ç”¨äº§ç”Ÿè´Ÿé¢å½±å“ã€‚RolloveråŽ†å²æ•°æ®åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ— é™æœŸä¿ç•™åŽ†å²æ•°æ®æ˜¯ä¸å¯è¡Œçš„æ—¶é—´åºåˆ—æ•°æ®éšç€æ—¶é—´çš„æµé€è€Œå¤±åŽ»ä»·å€¼ï¼Œæˆ‘ä»¬æœ€ç»ˆä¸å¾—ä¸å°†å…¶åˆ é™¤ä½†æ˜¯å…¶ä¸­ä¸€äº›æ•°æ®å¯¹äºŽåˆ†æžä»ç„¶éžå¸¸æœ‰ç”¨Elasticsearch 6.3å¼•å…¥äº†ä¸€é¡¹æ–°çš„rolloveråŠŸèƒ½ï¼Œè¯¥åŠŸèƒ½ä»¥ç´§å‡‘çš„èšåˆæ ¼å¼ä¿å­˜æ—§æ•°æ®ä»…ä¿å­˜æ‚¨æ„Ÿå…´è¶£çš„æ•°æ®å°±åƒä¸Šé¢çš„å›¾ç‰‡çœ‹åˆ°çš„é‚£æ ·ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå«åšlogs-aliasçš„aliasï¼Œå¯¹äºŽå†™æ“ä½œæ¥è¯´ï¼Œå®ƒæ€»æ˜¯ä¼šè‡ªåŠ¨æŒ‡å‘æœ€æ–°çš„å¯ä»¥ç”¨äºŽå†™å…¥indexçš„ä¸€ä¸ªç´¢å¼•ã€‚é’ˆå¯¹æˆ‘ä»¬ä¸Šé¢çš„æƒ…å†µï¼Œå®ƒæŒ‡å‘logs-000002ã€‚å¦‚æžœæ–°çš„rolloverå‘ç”ŸåŽï¼Œæ–°çš„logs-000003å°†è¢«ç”Ÿæˆï¼Œå¹¶å¯¹äºŽå†™æ“ä½œæ¥è¯´ï¼Œå®ƒè‡ªåŠ¨æŒ‡å‘æœ€æ–°ç”Ÿäº§çš„logs-000003ç´¢å¼•ã€‚è€Œå¯¹äºŽè¯»å†™æ“ä½œæ¥è¯´ï¼Œå®ƒå°†åŒæ—¶æŒ‡å‘æœ€å…ˆçš„logs-1ï¼Œlogs-000002åŠlogs-000003ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯ï¼šåœ¨æˆ‘ä»¬æœ€æ—©è®¾å®šindexåå­—æ—¶ï¼Œæœ€åŽçš„ä¸€ä¸ªå­—ç¬¦å¿…é¡»æ˜¯æ•°å­—ï¼Œæ¯”å¦‚æˆ‘ä»¬ä¸Šé¢æ˜¾ç¤ºçš„logs-1ã€‚å¦åˆ™ï¼Œè‡ªåŠ¨ç”Ÿäº§indexå°†ä¼šå¤±è´¥ã€‚rolloverä¾‹å­æˆ‘ä»¬è¿˜æ˜¯å…ˆæ‹¿ä¸€ä¸ªrolloverçš„ä¾‹å­æ¥è¯´æ˜Žï¼Œè¿™æ ·æ¯”è¾ƒæ¸…æ¥šã€‚é¦–å…ˆæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªlog-aliasçš„alias:12345678PUT /%3Clogs-%7Bnow%2Fd%7D-1%3E&#123; &quot;aliases&quot;: &#123; &quot;log_alias&quot;: &#123; &quot;is_write_index&quot;: true &#125; &#125;&#125;å¦‚æžœå¤§å®¶å¯¹äºŽä¸Šé¢çš„å­—ç¬¦ä¸²â€œ%3Clogs-%7Bnow%2Fd%7D-1%3Eâ€æ¯”è¾ƒé™Œç”Ÿçš„è¯ï¼Œå¯ä»¥å‚è€ƒç½‘ç«™https://www.urlencoder.io/ã€‚å®žé™…ä¸Šå®ƒå°±æ˜¯å­—ç¬¦ä¸²â€œ&lt;logs-{now/d}-1&gt;â€çš„urlç¼–ç å½¢å¼ã€‚è¯·æ³¨æ„ä¸Šé¢çš„is_write_indexå¿…é¡»è®¾ç½®ä¸ºtrueã€‚è¿è¡Œä¸Šé¢çš„ç»“æžœæ˜¯ï¼š12345&#123; &quot;acknowledged&quot; : true, &quot;shards_acknowledged&quot; : true, &quot;index&quot; : &quot;logs-2019.10.21-1&quot;&#125;æ˜¾ç„¶ï¼Œå®ƒå¸®æˆ‘ä»¬ç”Ÿäº§äº†ä¸€ä¸ªå«åšlogs-2019.10.21-1çš„indexã€‚æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å…ˆä½¿ç”¨æˆ‘ä»¬çš„Kibanaæ¥å‡†å¤‡ä¸€ä¸‹æˆ‘ä»¬çš„indexæ•°æ®ã€‚æˆ‘ä»¬è¿è¡Œèµ·æ¥æˆ‘ä»¬çš„Kibana:æˆ‘ä»¬åˆ†åˆ«ç‚¹å‡»ä¸Šé¢çš„1å’Œ2å¤„ï¼šç‚¹å‡»ä¸Šé¢çš„â€œAdd dataâ€ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŠŠæˆ‘ä»¬çš„kibana_sample_data_logsç´¢å¼•åŠ è½½åˆ°Elasticsearchä¸­ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤è¿›è¡ŒæŸ¥çœ‹ï¼š1GET _cat/indices/kibana_sample_data_logså‘½ä»¤æ˜¾ç¤ºç»“æžœä¸ºï¼šå®ƒæ˜¾ç¤ºkibana_sample_data_logså…·æœ‰11.1Mçš„æ•°æ®ï¼Œå¹¶ä¸”å®ƒæœ‰14074ä¸ªæ–‡æ¡£ï¼šæˆ‘ä»¬æŽ¥ä¸‹æ¥è¿è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼š123456789POST _reindex&#123; &quot;source&quot;: &#123; &quot;index&quot;: &quot;kibana_sample_data_logs&quot; &#125;, &quot;dest&quot;: &#123; &quot;index&quot;: &quot;log_alias&quot; &#125;&#125;è¿™ä¸ªå‘½ä»¤çš„ä½œç”¨æ˜¯æŠŠkibana_sample_data_logsé‡Œçš„æ•°æ®reindexåˆ°log_aliasæ‰€æŒ‡å‘çš„indexã€‚ä¹Ÿå°±æ˜¯æŠŠkibana_sample_data_logsçš„æ–‡æ¡£å¤åˆ¶ä¸€ä»½åˆ°æˆ‘ä»¬ä¸Šé¢æ˜¾ç¤ºçš„logs-2019.10.21-1ç´¢å¼•é‡Œã€‚æˆ‘ä»¬åšå¦‚ä¸‹çš„æ“ä½œæŸ¥çœ‹ä¸€ä¸‹ç»“æžœï¼š1GET logs-2019.10.21-1/_countæ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š123456789&#123; &quot;count&quot; : 14074, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;&#125;æ˜¾ç„¶ï¼Œæˆ‘ä»¬å·²ç»å¤åˆ¶åˆ°æ‰€æœ‰çš„æ•°æ®ã€‚é‚£ä¹ˆæŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥è¿è¡Œå¦‚ä¸‹çš„ä¸€ä¸ªæŒ‡ä»¤ï¼š12345678POST /log_alias/_rollover?dry_run&#123; &quot;conditions&quot;: &#123; &quot;max_age&quot;: &quot;7d&quot;, &quot;max_docs&quot;: 14000, &quot;max_size&quot;: &quot;5gb&quot; &#125;&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸‰ä¸ªæ¡ä»¶ï¼šå¦‚æžœæ—¶é—´è¶…è¿‡7å¤©ï¼Œé‚£ä¹ˆè‡ªåŠ¨rolloverï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨æ–°çš„indexå¦‚æžœæ–‡æ¡£çš„æ•°ç›®è¶…è¿‡14000ä¸ªï¼Œé‚£ä¹ˆè‡ªåŠ¨rolloverå¦‚æžœindexçš„å¤§å°è¶…è¿‡5Gï¼Œé‚£ä¹ˆè‡ªåŠ¨rolloveråœ¨ä¸Šé¢æˆ‘ä»¬ä½¿ç”¨äº†dry_runå‚æ•°ï¼Œè¡¨æ˜Žå°±æ˜¯è¿è¡Œæ—¶çœ‹çœ‹ï¼Œä½†ä¸æ˜¯çœŸæ­£åœ°å®žæ–½ã€‚æ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š12345678910111213&#123; &quot;acknowledged&quot; : false, &quot;shards_acknowledged&quot; : false, &quot;old_index&quot; : &quot;logs-2019.10.21-1&quot;, &quot;new_index&quot; : &quot;logs-2019.10.21-000002&quot;, &quot;rolled_over&quot; : false, &quot;dry_run&quot; : true, &quot;conditions&quot; : &#123; &quot;[max_docs: 1400]&quot; : true, &quot;[max_size: 5gb]&quot; : false, &quot;[max_age: 7d]&quot; : false &#125;&#125;æ ¹æ®ç›®å‰æˆ‘ä»¬çš„æ¡ä»¶ï¼Œæˆ‘ä»¬çš„logs-2019.10.21-1æ–‡æ¡£æ•°å·²ç»è¶…è¿‡14000ä¸ªäº†ï¼Œæ‰€ä»¥ä¼šç”Ÿäº§æ–°çš„ç´¢å¼•logs-2019.10.21-000002ã€‚å› ä¸ºæˆ‘ä½¿ç”¨äº†dry_runï¼Œä¹Ÿå°±æ˜¯æ¼”ä¹ ï¼Œæ‰€ä»¥æ˜¾ç¤ºçš„rolled_overæ˜¯falseã€‚ä¸ºäº†èƒ½çœŸæ­£åœ°rolloverï¼Œæˆ‘ä»¬è¿è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼š12345678POST /log_alias/_rollover&#123; &quot;conditions&quot;: &#123; &quot;max_age&quot;: &quot;7d&quot;, &quot;max_docs&quot;: 1400, &quot;max_size&quot;: &quot;5gb&quot; &#125;&#125;æ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š12345678910111213&#123; &quot;acknowledged&quot; : true, &quot;shards_acknowledged&quot; : true, &quot;old_index&quot; : &quot;logs-2019.10.21-1&quot;, &quot;new_index&quot; : &quot;logs-2019.10.21-000002&quot;, &quot;rolled_over&quot; : true, &quot;dry_run&quot; : false, &quot;conditions&quot; : &#123; &quot;[max_docs: 1400]&quot; : true, &quot;[max_size: 5gb]&quot; : false, &quot;[max_age: 7d]&quot; : false &#125;&#125;è¯´æ˜Žå®ƒå·²ç»rolled_ovderäº†ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹å†™çš„å‘½ä»¤æ¥æ£€æŸ¥ï¼š1GET _cat/indices/logs-2019*æ˜¾ç¤ºçš„ç»“æžœä¸ºï¼šæˆ‘ä»¬çŽ°åœ¨å¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ªä»¥logs-2019.10.21ä¸ºå¤´çš„indexï¼Œå¹¶ä¸”ç¬¬äºŒæ–‡æ¡£logs-2019.10.21-000002æ–‡æ¡£æ•°ä¸º0ã€‚å¦‚æžœæˆ‘ä»¬è¿™ä¸ªæ—¶å€™ç›´æŽ¥å†æƒ³log_aliaså†™å…¥æ–‡æ¡£çš„è¯ï¼š1234567891011121314151617181920212223242526272829303132333435363738POST log_alias/_doc&#123; &quot;agent&quot;: &quot;Mozilla/5.0 (X11; Linux x86_64; rv:6.0a1) Gecko/20110421 Firefox/6.0a1&quot;, &quot;bytes&quot;: 6219, &quot;clientip&quot;: &quot;223.87.60.27&quot;, &quot;extension&quot;: &quot;deb&quot;, &quot;geo&quot;: &#123; &quot;srcdest&quot;: &quot;IN:US&quot;, &quot;src&quot;: &quot;IN&quot;, &quot;dest&quot;: &quot;US&quot;, &quot;coordinates&quot;: &#123; &quot;lat&quot;: 39.41042861, &quot;lon&quot;: -88.8454325 &#125; &#125;, &quot;host&quot;: &quot;artifacts.elastic.co&quot;, &quot;index&quot;: &quot;kibana_sample_data_logs&quot;, &quot;ip&quot;: &quot;223.87.60.27&quot;, &quot;machine&quot;: &#123; &quot;ram&quot;: 8589934592, &quot;os&quot;: &quot;win 8&quot; &#125;, &quot;memory&quot;: null, &quot;message&quot;: &quot;&quot;&quot; 223.87.60.27 - - [2018-07-22T00:39:02.912Z] &quot;GET /elasticsearch/elasticsearch-6.3.2.deb_1 HTTP/1.1&quot; 200 6219 &quot;-&quot; &quot;Mozilla/5.0 (X11; Linux x86_64; rv:6.0a1) Gecko/20110421 Firefox/6.0a1&quot; &quot;&quot;&quot;, &quot;phpmemory&quot;: null, &quot;referer&quot;: &quot;http://twitter.com/success/wendy-lawrence&quot;, &quot;request&quot;: &quot;/elasticsearch/elasticsearch-6.3.2.deb&quot;, &quot;response&quot;: 200, &quot;tags&quot;: [ &quot;success&quot;, &quot;info&quot; ], &quot;timestamp&quot;: &quot;2019-10-13T00:39:02.912Z&quot;, &quot;url&quot;: &quot;https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.3.2.deb_1&quot;, &quot;utc_time&quot;: &quot;2019-10-13T00:39:02.912Z&quot;&#125;æ˜¾ç¤ºçš„ç»“æžœï¼š1234567891011121314&#123; &quot;_index&quot; : &quot;logs-2019.10.21-000002&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;xPyQ7m0BsjOKp1OsjsP8&quot;, &quot;_version&quot; : 1, &quot;result&quot; : &quot;created&quot;, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;failed&quot; : 0 &#125;, &quot;_seq_no&quot; : 1, &quot;_primary_term&quot; : 1&#125;æ˜¾ç„¶å®ƒå†™å…¥çš„æ˜¯logs-2019.10.21-000002ç´¢å¼•ã€‚æˆ‘ä»¬å†æ¬¡æŸ¥è¯¢log_aliasçš„æ€»å…±æ–‡æ¡£æ•°ï¼š1GET log_alias/_countæ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š123456789&#123; &quot;count&quot; : 14075, &quot;_shards&quot; : &#123; &quot;total&quot; : 2, &quot;successful&quot; : 2, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;&#125;æ˜¾ç„¶å®ƒå’Œä¹‹å‰çš„14074ä¸ªæ–‡æ¡£å¤šå¢žåŠ äº†ä¸€ä¸ªæ–‡æ¡£ï¼Œä¹Ÿå°±æ˜¯è¯´log_aliasæ˜¯åŒæ—¶æŒ‡å‘logs-2019.10.21-1åŠlogs-2019.10.21-000002ã€‚æ€»ç»“ï¼šåœ¨ä»Šå¤©çš„æ–‡æ¡£é‡Œï¼Œæˆ‘ä»¬è®²è¿°äº†å¦‚ä½•ä½¿ç”¨rollover APIæ¥è‡ªåŠ¨ç®¡ç†æˆ‘ä»¬çš„indexã€‚åˆ©ç”¨rollover APIï¼Œå®ƒå¯ä»¥å¾ˆæ–¹ä¾¿åœ°å¸®æˆ‘ä»¬è‡ªåŠ¨æ ¹æ®æˆ‘ä»¬è®¾å®šçš„æ¡ä»¶å¸®æˆ‘ä»¬æŠŠæˆ‘ä»¬çš„Indexè¿‡åº¦åˆ°æ–°çš„indexã€‚åœ¨æœªæ¥çš„æ–‡ç« é‡Œï¼Œæˆ‘ä»¬å°†è®²è¿°å¦‚ä½•ä½¿ç”¨Index life cycle policyæ¥å¸®æˆ‘ä»¬ç®¡ç†æˆ‘ä»¬çš„indexã€‚]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Elasticsearch ReindexæŽ¥å£]]></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%20Reindex%E6%8E%A5%E5%8F%A3%2F</url>
    <content type="text"><![CDATA[åœ¨æˆ‘ä»¬å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æœ‰å¾ˆå¤šæ—¶å€™éœ€è¦ç”¨åˆ°ReindexæŽ¥å£ã€‚å®ƒå¯ä»¥å¸®æˆ‘ä»¬æŠŠæ•°æ®ä»Žä¸€ä¸ªindexåˆ°å¦å¤–ä¸€ä¸ªindexè¿›è¡Œé‡æ–°reindexã€‚è¿™ä¸ªå¯¹äºŽç‰¹åˆ«é€‚ç”¨äºŽæˆ‘ä»¬åœ¨ä¿®æ”¹æˆ‘ä»¬æ•°æ®çš„mappingåŽï¼Œéœ€è¦é‡æ–°æŠŠæ•°æ®ä»ŽçŽ°æœ‰çš„indexè½¬åˆ°æ–°çš„indexå»ºç«‹æ–°çš„ç´¢å¼•ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬ä¸èƒ½ä¿®æ”¹çŽ°æœ‰çš„indexçš„mappingä¸€æ—¦å·²ç»å®šä¸‹æ¥äº†ã€‚åœ¨æŽ¥ä¸‹æ¥çš„ä»‹ç»ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨reindexæŽ¥å£ã€‚ä¸ºäº†èƒ½å¤Ÿä½¿ç”¨reindexæŽ¥å£ï¼Œæˆ‘ä»¬å¿…é¡»æ»¡è¶³ä¸€ä¸‹çš„æ¡ä»¶ï¼š_sourceé€‰é¡¹å¯¹æ‰€æœ‰çš„æºindexæ–‡æ¡£æ˜¯å¯åŠ¨çš„ï¼Œä¹Ÿå³æºindexçš„sourceæ˜¯è¢«å­˜å‚¨çš„reindexä¸æ˜¯å¸®æˆ‘ä»¬å°è¯•è®¾ç½®å¥½ç›®çš„åœ°indexã€‚å®ƒä¸æ‹·è´æºindexçš„è®¾ç½®åˆ°ç›®çš„åœ°çš„indexé‡ŒåŽ»ã€‚ä½ åº”è¯¥åœ¨åšreindexä¹‹å‰æŠŠç›®çš„åœ°çš„æºçš„indexè®¾ç½®å¥½ï¼Œè¿™å…¶ä¸­åŒ…æ‹¬mapping, shardæ•°ç›®ï¼Œreplicaç­‰ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ï¼Œæ¯”å¦‚å»ºç«‹ä¸€ä¸ªblogsçš„indexã€‚123456789101112131415PUT twitter2/_doc/1&#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125;&#125;ä¸Šé¢çš„å‘½ä»¤è®©æˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ªå«åštwitter2çš„indexï¼Œå¹¶åŒæ—¶å¸®æˆ‘ä»¬ç”Ÿäº§äº†ä¸€ä¸ªå¦‚ä¸‹çš„mapping:1GET /twitter2/_mappingæ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990&#123; &quot;twitter2&quot; : &#123; &quot;mappings&quot; : &#123; &quot;properties&quot; : &#123; &quot;address&quot; : &#123; &quot;type&quot; : &quot;text&quot;, &quot;fields&quot; : &#123; &quot;keyword&quot; : &#123; &quot;type&quot; : &quot;keyword&quot;, &quot;ignore_above&quot; : 256 &#125; &#125; &#125;, &quot;age&quot; : &#123; &quot;type&quot; : &quot;long&quot; &#125;, &quot;city&quot; : &#123; &quot;type&quot; : &quot;text&quot;, &quot;fields&quot; : &#123; &quot;keyword&quot; : &#123; &quot;type&quot; : &quot;keyword&quot;, &quot;ignore_above&quot; : 256 &#125; &#125; &#125;, &quot;country&quot; : &#123; &quot;type&quot; : &quot;text&quot;, &quot;fields&quot; : &#123; &quot;keyword&quot; : &#123; &quot;type&quot; : &quot;keyword&quot;, &quot;ignore_above&quot; : 256 &#125; &#125; &#125;, &quot;location&quot; : &#123; &quot;properties&quot; : &#123; &quot;lat&quot; : &#123; &quot;type&quot; : &quot;text&quot;, &quot;fields&quot; : &#123; &quot;keyword&quot; : &#123; &quot;type&quot; : &quot;keyword&quot;, &quot;ignore_above&quot; : 256 &#125; &#125; &#125;, &quot;lon&quot; : &#123; &quot;type&quot; : &quot;text&quot;, &quot;fields&quot; : &#123; &quot;keyword&quot; : &#123; &quot;type&quot; : &quot;keyword&quot;, &quot;ignore_above&quot; : 256 &#125; &#125; &#125; &#125; &#125;, &quot;message&quot; : &#123; &quot;type&quot; : &quot;text&quot;, &quot;fields&quot; : &#123; &quot;keyword&quot; : &#123; &quot;type&quot; : &quot;keyword&quot;, &quot;ignore_above&quot; : 256 &#125; &#125; &#125;, &quot;province&quot; : &#123; &quot;type&quot; : &quot;text&quot;, &quot;fields&quot; : &#123; &quot;keyword&quot; : &#123; &quot;type&quot; : &quot;keyword&quot;, &quot;ignore_above&quot; : 256 &#125; &#125; &#125;, &quot;uid&quot; : &#123; &quot;type&quot; : &quot;long&quot; &#125;, &quot;user&quot; : &#123; &quot;type&quot; : &quot;text&quot;, &quot;fields&quot; : &#123; &quot;keyword&quot; : &#123; &quot;type&quot; : &quot;keyword&quot;, &quot;ignore_above&quot; : 256 &#125; &#125; &#125; &#125; &#125; &#125;&#125;æ˜¾ç„¶ç³»ç»Ÿå¸®æˆ‘ä»¬ç”Ÿäº§çš„locationæ•°æ®ç±»åž‹æ˜¯ä¸å¯¹çš„ï¼Œæˆ‘ä»¬å¿…é¡»è¿›è¡Œä¿®æ”¹ã€‚ä¸€ç§åŠžæ³•æ˜¯åˆ é™¤çŽ°æœ‰çš„twitter2ç´¢å¼•ï¼Œè®©åŽä¿®æ”¹å®ƒçš„mappingï¼Œå†é‡æ–°ç´¢å¼•æ‰€æœ‰çš„æ•°æ®ã€‚è¿™å¯¹äºŽä¸€ä¸ªä¸¤ä¸ªæ–‡æ¡£è¿˜æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯å¦‚æžœå·²ç»æœ‰å¾ˆå¤šçš„æ•°æ®äº†ï¼Œè¿™ä¸ªæ–¹æ³•å¹¶ä¸å¯å–ã€‚å¦å¤–ä¸€ç§æ–¹å¼ï¼Œæ˜¯å»ºç«‹ä¸€ä¸ªå®Œå…¨æ–°çš„indexï¼Œä½¿ç”¨æ–°çš„mappingè¿›è¡Œreindexã€‚ä¸‹é¢æˆ‘ä»¬å±•ç¤ºå¦‚ä½•ä½¿ç”¨è¿™ç§æ–¹æ³•ã€‚åˆ›å»ºä¸€ä¸ªæ–°çš„twitter3çš„indexï¼Œä½¿ç”¨å¦‚ä¸‹çš„mapping:1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950PUT twitter3&#123; &quot;settings&quot;: &#123; &quot;number_of_shards&quot;: 1, &quot;number_of_replicas&quot;: 1 &#125;, &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;address&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125;, &quot;age&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;city&quot;: &#123; &quot;type&quot;: &quot;text&quot; &#125;, &quot;country&quot;: &#123; &quot;type&quot;: &quot;text&quot; &#125;, &quot;location&quot;: &#123; &quot;type&quot;: &quot;geo_point&quot; &#125;, &quot;message&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125;, &quot;province&quot;: &#123; &quot;type&quot;: &quot;text&quot; &#125;, &quot;uid&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;user&quot;: &#123; &quot;type&quot;: &quot;text&quot; &#125; &#125; &#125;&#125;è¿™é‡Œæˆ‘ä»¬æˆ‘ä»¬ä¿®æ”¹äº†locationåŠå…¶å®ƒçš„ä¸€äº›æ•°æ®é¡¹çš„æ•°æ®ç±»åž‹ã€‚è¿è¡Œä¸Šé¢çš„æŒ‡ä»¤ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªå®Œå…¨æ–°çš„twitter3çš„indexã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥è¿›è¡Œreindexï¼š123456789POST _reindex&#123; &quot;source&quot;: &#123; &quot;index&quot;: &quot;twitter2&quot; &#125;, &quot;dest&quot;: &#123; &quot;index&quot;: &quot;twitter3&quot; &#125;&#125;æ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š12345678910111213141516171819&#123; &quot;took&quot; : 52, &quot;timed_out&quot; : false, &quot;total&quot; : 1, &quot;updated&quot; : 0, &quot;created&quot; : 1, &quot;deleted&quot; : 0, &quot;batches&quot; : 1, &quot;version_conflicts&quot; : 0, &quot;noops&quot; : 0, &quot;retries&quot; : &#123; &quot;bulk&quot; : 0, &quot;search&quot; : 0 &#125;, &quot;throttled_millis&quot; : 0, &quot;requests_per_second&quot; : -1.0, &quot;throttled_until_millis&quot; : 0, &quot;failures&quot; : [ ]&#125;æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥æ£€æŸ¥æˆ‘ä»¬çš„twitter3æ˜¯å¦å·²ç»æœ‰æ–°çš„æ•°æ®ï¼š1GET /twitter3/_searchæ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š123456789101112131415161718192021222324252627282930313233343536373839&#123; &quot;took&quot; : 100, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 1, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 1.0, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;twitter3&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 1.0, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125; &#125; &#125; ] &#125;&#125;æ˜¾ç„¶æˆ‘ä»¬çš„æ•°æ®å·²ç»ä»Žtwitter2åˆ°twitter3ï¼Œå¹¶ä¸”å®ƒçš„æ•°æ®ç±»åž‹å·²ç»æ˜¯å®Œå…¨ç¬¦åˆæˆ‘ä»¬è¦æ±‚çš„æ•°æ®ç±»åž‹ã€‚Reindexæ‰§è¡ŒReindexæ˜¯ä¸€ä¸ªæ—¶é—´ç‚¹çš„å‰¯æœ¬å°±åƒä¸Šé¢è¿”å›žçš„ç»“æžœæ˜¾ç¤ºçš„é‚£æ ·ï¼Œå®ƒæ˜¯ä»¥batchï¼ˆæ‰¹é‡ï¼‰çš„æ–¹å¼æ¥æ‰§è¡Œçš„ã€‚é»˜è®¤çš„æ‰¹é‡å¤§å°ä¸º1000ä½ ä¹Ÿå¯ä»¥åªæ‹·è´æºindexå…¶ä¸­çš„ä¸€éƒ¨åˆ†æ•°æ®é€šè¿‡åŠ å…¥queryåˆ°sourceä¸­é€šè¿‡å®šä¹‰max_docså‚æ•°æ¯”å¦‚ï¼š123456789101112131415POST _reindex&#123; &quot;max_docs&quot;: 100, &quot;source&quot;: &#123; &quot;index&quot;: &quot;twitter2&quot;, &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;city&quot;: &quot;åŒ—äº¬&quot; &#125; &#125; &#125;, &quot;dest&quot;: &#123; &quot;index&quot;: &quot;twitter3&quot; &#125;&#125;è¿™é‡Œï¼Œæˆ‘ä»¬å®šä¹‰æœ€å¤šä¸è¶…è¿‡100ä¸ªæ–‡æ¡£ï¼ŒåŒæ—¶ï¼Œæˆ‘ä»¬åªæ‹·è´æ¥è‡ªâ€œåŒ—äº¬â€çš„twitterè®°å½•ã€‚è®¾ç½®op_type to createå°†å¯¼è‡´_reindexä»…åœ¨ç›®æ ‡ç´¢å¼•ä¸­åˆ›å»ºç¼ºå°‘çš„æ–‡æ¡£ã€‚ æ‰€æœ‰çŽ°æœ‰æ–‡æ¡£éƒ½ä¼šå¯¼è‡´ç‰ˆæœ¬å†²çªï¼Œæ¯”å¦‚ï¼š12345678910POST _reindex&#123; &quot;source&quot;: &#123; &quot;index&quot;: &quot;twitter2&quot; &#125;, &quot;dest&quot;: &#123; &quot;index&quot;: &quot;twitter3&quot;, &quot;op_type&quot;: &quot;create&quot; &#125;&#125;å¦‚æžœæˆ‘ä»¬ä¹‹å‰å·²ç»åšè¿‡reindexï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„ç»“æžœï¼š123456789101112131415161718192021222324252627282930313233&#123; &quot;took&quot;: 2, &quot;timed_out&quot;: false, &quot;total&quot;: 1, &quot;updated&quot;: 0, &quot;created&quot;: 0, &quot;deleted&quot;: 0, &quot;batches&quot;: 1, &quot;version_conflicts&quot;: 1, &quot;noops&quot;: 0, &quot;retries&quot;: &#123; &quot;bulk&quot;: 0, &quot;search&quot;: 0 &#125;, &quot;throttled_millis&quot;: 0, &quot;requests_per_second&quot;: -1, &quot;throttled_until_millis&quot;: 0, &quot;failures&quot;: [ &#123; &quot;index&quot;: &quot;twitter3&quot;, &quot;type&quot;: &quot;_doc&quot;, &quot;id&quot;: &quot;1&quot;, &quot;cause&quot;: &#123; &quot;type&quot;: &quot;version_conflict_engine_exception&quot;, &quot;reason&quot;: &quot;[1]: version conflict, document already exists (current version [5])&quot;, &quot;index_uuid&quot;: &quot;ffz2LNIIQqqDx211R5f4fQ&quot;, &quot;shard&quot;: &quot;0&quot;, &quot;index&quot;: &quot;twitter3&quot; &#125;, &quot;status&quot;: 409 &#125; ]&#125;å®ƒè¡¨æ˜Žæˆ‘ä»¬ä¹‹å‰çš„æ–‡æ¡£idä¸º1çš„æœ‰ç‰ˆæœ¬ä¸Šçš„å†²çªã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç‰ˆæœ¬å†²çªä¼šä¸­æ­¢_reindexè¿›ç¨‹ã€‚ â€œconflictâ€è¯·æ±‚bodyå‚æ•°å¯ç”¨äºŽæŒ‡ç¤º_reindexç»§ç»­å¤„ç†ç‰ˆæœ¬å†²çªçš„ä¸‹ä¸€ä¸ªæ–‡æ¡£ã€‚ è¯·åŠ¡å¿…æ³¨æ„ï¼Œå…¶ä»–é”™è¯¯ç±»åž‹çš„å¤„ç†ä¸å—â€œconflictâ€å‚æ•°çš„å½±å“ã€‚ å½“â€œconflictâ€ï¼šåœ¨è¯·æ±‚æ­£æ–‡ä¸­è®¾ç½®â€œproceedâ€æ—¶ï¼Œ_reindexè¿›ç¨‹å°†ç»§ç»­å‘ç”Ÿç‰ˆæœ¬å†²çªå¹¶è¿”å›žé‡åˆ°çš„ç‰ˆæœ¬å†²çªè®¡æ•°ï¼š1234567891011POST _reindex&#123; &quot;conflicts&quot;: &quot;proceed&quot;, &quot;source&quot;: &#123; &quot;index&quot;: &quot;twitter&quot; &#125;, &quot;dest&quot;: &#123; &quot;index&quot;: &quot;new_twitter&quot;, &quot;op_type&quot;: &quot;create&quot; &#125;&#125;Throttlingé‡æ–°ç´¢å¼•å¤§é‡æ–‡æ¡£å¯èƒ½ä¼šä½¿æ‚¨çš„ç¾¤é›†æ³›æ»¥ç”šè‡³å´©æºƒã€‚requests_per_secondé™åˆ¶ç´¢å¼•æ“ä½œé€ŸçŽ‡ã€‚12345678910POST _reindex?requests_per_second=500 &#123; &quot;source&quot;: &#123; &quot;index&quot;: &quot;blogs&quot;, &quot;size&quot;: 500 &#125;, &quot;dest&quot;: &#123; &quot;index&quot;: &quot;blogs_fixed&quot; &#125;&#125;è¿ç”¨indexåˆ«åæ¥è¿›è¡Œreindexæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹æ³•æ¥å®žçŽ°ä»Žä¸€ä¸ªindexåˆ°å¦å¤–ä¸€ä¸ªindexçš„æ•°æ®è½¬ç§»ï¼š123456789PUT test PUT test_2 POST /_aliases&#123; &quot;actions&quot; : [ &#123; &quot;add&quot;: &#123; &quot;index&quot;: &quot;test_2&quot;, &quot;alias&quot;: &quot;test&quot; &#125; &#125;, &#123; &quot;remove_index&quot;: &#123; &quot;index&quot;: &quot;test&quot; &#125; &#125; ]&#125;åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå‡å¦‚æˆ‘ä»¬åœ°æ·»åŠ äº†ä¸€ä¸ªå«åštestçš„indexï¼Œè€Œtest_2æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚æˆ‘ä»¬ç›´æŽ¥å¯ä»¥é€šè¿‡ä¸Šé¢çš„æ–¹æ³•å§testä¸­çš„æ•°æ®äº¤æ¢åˆ°test_2ä¸­ï¼Œå¹¶åŒæ—¶æŠŠtestç´¢å¼•åˆ é™¤ã€‚ä»Žè¿œå¤„è¿›è¡Œreindex_reindexä¹Ÿæ”¯æŒä»Žä¸€ä¸ªè¿œå¤„çš„Elasticsearchçš„æœåŠ¡å™¨è¿›è¡Œreindexï¼Œå®ƒçš„è¯­æ³•ä¸ºï¼š1234567891011121314POST _reindex&#123; &quot;source&quot;: &#123; &quot;index&quot;: &quot;blogs&quot;, &quot;remote&quot;: &#123; &quot;host&quot;: &quot;http://remote_cluster_node1:9200&quot;, &quot;username&quot;: &quot;USERNAME&quot;, &quot;password&quot;: &quot;PASSWORD&quot; &#125; &#125;, &quot;dest&quot;: &#123; &quot;index&quot;: &quot;blogs&quot; &#125;&#125;è¿™é‡Œæ˜¾ç¤ºå®ƒä»Žä¸€ä¸ªåœ¨http://remote_cluster_node1:9200çš„æœåŠ¡å™¨æ¥æ‹·è´æ–‡ä»¶ä»Žä¸€ä¸ªindexåˆ°å¦å¤–ä¸€ä¸ªindexã€‚å‚è€ƒï¼šã€1ã€‘https://www.elastic.co/guide/en/elasticsearch/reference/7.3/docs-reindex.html]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%20Painless%20script%E7%BC%96%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[æˆ‘ä»¬ä¹‹å‰çœ‹è§äº†åœ¨Elasticsearché‡Œçš„ingest nodeé‡Œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹processorçš„å¤„ç†å¸®æˆ‘ä»¬å¤„ç†æˆ‘ä»¬çš„ä¸€äº›æ•°æ®ã€‚å®ƒä»¬çš„åŠŸèƒ½æ˜¯éžå¸¸å…·ä½“è€Œæ˜Žç¡®çš„ã€‚é‚£ä¹ˆåœ¨Elasticsearché‡Œï¼Œæœ‰æ²¡æœ‰ä¸€ç§æ›´åŠ çµæ´»çš„æ–¹å¼å¯ä¾›æˆ‘ä»¬æ¥è¿›è¡Œç¼–ç¨‹å¤„ç†å‘¢ï¼Ÿå¦‚æžœæœ‰ï¼Œå®ƒä½¿ç”¨çš„è¯­è¨€æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿåœ¨Elasticsearcä¸­ï¼Œå®ƒä½¿ç”¨äº†ä¸€ä¸ªå«åšPainlessçš„è¯­è¨€ã€‚å®ƒæ˜¯ä¸“é—¨ä¸ºElasticsearchè€Œå»ºç«‹çš„ã€‚Painlessæ˜¯ä¸€ç§ç®€å•ï¼Œå®‰å…¨çš„è„šæœ¬è¯­è¨€ï¼Œä¸“ä¸ºä¸ŽElasticsearchä¸€èµ·ä½¿ç”¨è€Œè®¾è®¡ã€‚ å®ƒæ˜¯Elasticsearchçš„é»˜è®¤è„šæœ¬è¯­è¨€ï¼Œå¯ä»¥å®‰å…¨åœ°ç”¨äºŽinlineå’Œstoredè„šæœ¬ã€‚å®ƒå…·æœ‰åƒGroovyé‚£æ ·çš„è¯­æ³•ã€‚è‡ªElasticsearch 6.0ä»¥åŽçš„ç‰ˆæœ¬ä¸å†æ”¯æŒGroovyï¼ŒJavascriptåŠPythonè¯­è¨€ã€‚å¦‚ä½•ä½¿ç”¨è„šæœ¬è„šæœ¬çš„è¯­æ³•ä¸º:12345&quot;script&quot;: &#123; &quot;lang&quot;: &quot;...&quot;, &quot;source&quot; | &quot;id&quot;: &quot;...&quot;, &quot;params&quot;: &#123; ... &#125; &#125;è¿™é‡Œlangé»˜è®¤çš„å€¼ä¸ºâ€painlessâ€ã€‚åœ¨å®žé™…çš„ä½¿ç”¨ä¸­å¯ä»¥ä¸è®¾ç½®ï¼Œé™¤éžæœ‰ç¬¬äºŒç§è¯­è¨€ä¾›ä½¿ç”¨sourceå¯ä»¥ä¸ºinlineè„šæœ¬ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªidï¼Œé‚£ä¹ˆè¿™ä¸ªidå¯¹åº”äºŽä¸€ä¸ªstoredè„šæœ¬ä»»ä½•æœ‰åå­—çš„å‚æ•°ï¼Œå¯ä»¥è¢«ç”¨äºŽè„šæœ¬çš„è¾“å…¥å‚æ•°Painlessçš„ç®€å•ä½¿ç”¨ä¾‹å­inline è„šæœ¬é¦–å…ˆæˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªç®€å•çš„æ–‡æ¡£ï¼š123456789101112131415PUT twitter/_doc/1&#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125;&#125;åœ¨è¿™ä¸ªæ–‡æ¡£é‡Œï¼Œæˆ‘ä»¬çŽ°åœ¨æƒ³æŠŠageä¿®æ”¹ä¸º30ï¼Œé‚£ä¹ˆä¸€ç§åŠžæ³•å°±æ˜¯æŠŠæ‰€æœ‰çš„æ–‡æ¡£å†…å®¹éƒ½è¯»å‡ºæ¥ï¼Œè®©ä¿®æ”¹å…¶ä¸­çš„ageæƒ³ä¸º30ï¼Œå†é‡æ–°ç”¨åŒæ ·çš„æ–¹æ³•å†™è¿›åŽ»ã€‚é¦–å…ˆè¿™é‡Œéœ€è¦æœ‰å‡ ä¸ªåŠ¨ä½œï¼šå…ˆè¯»å‡ºæ•°æ®ï¼Œç„¶åŽä¿®æ”¹ï¼Œå†æ¬¡å†™å…¥æ•°æ®ã€‚æ˜¾ç„¶è¿™æ ·æ¯”è¾ƒéº»çƒ¦ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç›´æŽ¥ä½¿ç”¨Painlessè¯­è¨€ç›´æŽ¥è¿›è¡Œä¿®æ”¹ï¼š123456POST twitter/_update/1&#123; &quot;script&quot;: &#123; &quot;source&quot;: &quot;ctx._source.age = 30&quot; &#125;&#125;è¿™é‡Œçš„sourceè¡¨æ˜Žæ˜¯æˆ‘ä»¬çš„Painlessä»£ç ã€‚è¿™é‡Œæˆ‘ä»¬åªå†™äº†å¾ˆå°‘çš„ä»£ç åœ¨DSLä¹‹ä¸­ã€‚è¿™ç§ä»£ç ç§°ä¹‹ä¸ºinlineã€‚åœ¨è¿™é‡Œæˆ‘ä»¬ç›´æŽ¥é€šè¿‡ctx._source.ageæ¥è®¿é—® _souceé‡Œçš„ageã€‚è¿™æ ·æˆ‘ä»¬é€šè¿‡ç¼–ç¨‹çš„åŠžæ³•ç›´æŽ¥å¯¹å¹´é¾„è¿›è¡Œäº†ä¿®æ”¹ã€‚è¿è¡Œçš„ç»“æžœæ˜¯ï¼š1234567891011121314151617181920212223&#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_version&quot; : 16, &quot;_seq_no&quot; : 20, &quot;_primary_term&quot; : 1, &quot;found&quot; : true, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 30, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125; &#125;&#125;æ˜¾ç„¶è¿™ä¸ªageå·²ç»æ”¹å˜ä¸º30ã€‚ä¸Šé¢çš„æ–¹æ³•å›ºç„¶å¥½ï¼Œä½†æ˜¯æ¯æ¬¡æ‰§è¡Œscriptséƒ½æ˜¯éœ€è¦é‡æ–°è¿›è¡Œç¼–è¯‘çš„ã€‚ç¼–è¯‘å¥½çš„scriptå¯ä»¥cacheå¹¶ä¾›ä»¥åŽä½¿ç”¨ã€‚ä¸Šé¢çš„scriptå¦‚æžœæ˜¯æ”¹å˜å¹´é¾„çš„è¯ï¼Œéœ€è¦é‡æ–°è¿›è¡Œç¼–è¯‘ã€‚ä¸€ç§æ›´å¥½çš„æ–¹æ³•æ˜¯æ”¹ä¸ºè¿™æ ·çš„ï¼š123456789POST twitter/_update/1&#123; &quot;script&quot;: &#123; &quot;source&quot;: &quot;ctx._source.age = params.value&quot;, &quot;params&quot;: &#123; &quot;value&quot;: 34 &#125; &#125;&#125;è¿™æ ·ï¼Œæˆ‘ä»¬çš„scriptçš„sourceæ˜¯ä¸ç”¨æ”¹å˜çš„ï¼Œåªéœ€è¦ç¼–è¯‘ä¸€æ¬¡ã€‚ä¸‹æ¬¡è°ƒç”¨çš„æ—¶å€™ï¼Œåªéœ€è¦ä¿®æ”¹paramsé‡Œçš„å‚æ•°å³å¯ã€‚åœ¨Elasticsearché‡Œï¼š123&quot;script&quot;: &#123; &quot;source&quot;: &quot;ctx._source.num_of_views += 2&quot;&#125;å’Œ123&quot;script&quot;: &#123; &quot;source&quot;: &quot;ctx._source.num_of_views += 3&quot;&#125;è¢«è§†ä¸ºä¸¤ä¸ªä¸åŒçš„è„šæœ¬ï¼Œéœ€è¦åˆ†åˆ«è¿›è¡Œç¼–è¯‘ï¼Œæ‰€ä»¥æœ€å¥½çš„åŠžæ³•æ˜¯ä½¿ç”¨paramsæ¥ä¼ å…¥å‚æ•°ã€‚å­˜å‚¨çš„è„šæœ¬ (stored script)åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œscriptså¯ä»¥è¢«å­˜æ”¾äºŽä¸€ä¸ªé›†ç¾¤çš„çŠ¶æ€ä¸­ã€‚å®ƒä¹‹åŽå¯ä»¥é€šè¿‡IDè¿›è¡Œè°ƒç”¨ï¼š1234567PUT _scripts/add_age&#123; &quot;script&quot;: &#123; &quot;lang&quot;: &quot;painless&quot;, &quot;source&quot;: &quot;ctx._source.age += params.value&quot; &#125;&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå«åšadd_ageçš„scriptã€‚å®ƒçš„ä½œç”¨å°±æ˜¯å¸®æˆ‘ä»¬æŠŠsourceé‡Œçš„ageåŠ ä¸Šä¸€ä¸ªæ•°å€¼ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ä¹‹åŽè°ƒç”¨å®ƒï¼š123456789POST twitter/_update/1&#123; &quot;script&quot;: &#123; &quot;id&quot;: &quot;add_age&quot;, &quot;params&quot;: &#123; &quot;value&quot;: 2 &#125; &#125;&#125;é€šè¿‡ä¸Šé¢çš„æ‰§è¡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œageå°†ä¼šè¢«åŠ ä¸Š2ã€‚è®¿é—®sourceé‡Œçš„å­—æ®µPainlessä¸­ç”¨äºŽè®¿é—®å­—æ®µå€¼çš„è¯­æ³•å–å†³äºŽä¸Šä¸‹æ–‡ã€‚åœ¨Elasticsearchä¸­ï¼Œæœ‰è®¸å¤šä¸åŒçš„Plainlessä¸Šä¸‹æ–‡ã€‚å°±åƒé‚£ä¸ªé“¾æŽ¥æ˜¾ç¤ºçš„é‚£æ ·ï¼ŒPlainlessä¸Šä¸‹æ–‡åŒ…æ‹¬ï¼šingest processor, update, update by query, sortï¼Œfilterç­‰ç­‰ã€‚Context è®¿é—®å­—æ®µIngest node: è®¿é—®å­—æ®µä½¿ç”¨ctx ctx.field_nameUpdates: ä½¿ç”¨_source å­—æ®µ ctx._source.field_nameè¿™é‡Œçš„updatesåŒ…æ‹¬_updateï¼Œ_reindexä»¥åŠupdate_by_queryã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å¯¹äºŽcontextï¼ˆä¸Šä¸‹æ–‡çš„ç†è§£ï¼‰éžå¸¸é‡è¦ã€‚å®ƒçš„æ„æ€æ˜¯é’ˆå¯¹ä¸åŒçš„APIï¼Œåœ¨ä½¿ç”¨ä¸­ctxæ‰€åŒ…å«çš„å­—æ®µæ˜¯ä¸ä¸€æ ·çš„ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é’ˆå¯¹ä¸€äº›æƒ…å†µæ¥åšå…·ä½“çš„åˆ†æžã€‚Painlessè„šæœ¬ä¾‹å­é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå«åšadd_field_cçš„pipelineã€‚å…³äºŽå¦‚ä½•åˆ›å»ºä¸€ä¸ªpiplelineï¼Œå¤§å®¶å¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰å†™è¿‡çš„ä¸€ä¸ªæ–‡ç« â€œå¦‚ä½•åœ¨Elasticsearchä¸­ä½¿ç”¨pipeline APIæ¥å¯¹äº‹ä»¶è¿›è¡Œå¤„ç†â€ã€‚ä¾‹å­11234567891011121314PUT _ingest/pipeline/add_field_c&#123; &quot;processors&quot;: [ &#123; &quot;script&quot;: &#123; &quot;lang&quot;: &quot;painless&quot;, &quot;source&quot;: &quot;ctx.field_c = (ctx.field_a + ctx.field_b) * params.value&quot;, &quot;params&quot;: &#123; &quot;value&quot;: 2 &#125; &#125; &#125; ]&#125;è¿™ä¸ªpipeplineçš„ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„fieldï¼šfield_cã€‚å®ƒçš„ç»“æžœæ˜¯field_aåŠfield_bçš„å’Œï¼Œå¹¶ä¹˜ä»¥2ã€‚é‚£ä¹ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¦‚ä¸‹çš„æ–‡æ¡£ï¼š12345PUT test_script/_doc/1?pipeline=add_field_c&#123; &quot;field_a&quot;: 10, &quot;field_b&quot;: 20&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº†pipleline add_field_cã€‚æ‰§è¡ŒåŽçš„ç»“æžœæ˜¯ï¼š123456789101112131415161718192021222324252627282930&#123; &quot;took&quot; : 147, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 1, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 1.0, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;test_script&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 1.0, &quot;_source&quot; : &#123; &quot;field_c&quot; : 60, &quot;field_a&quot; : 10, &quot;field_b&quot; : 20 &#125; &#125; ] &#125;&#125;æ˜¾ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°field_cè¢«æˆåŠŸåˆ›å»ºäº†ã€‚ä¾‹å­2åœ¨ingestè¿‡ç¨‹ä¸­ï¼Œå¯ä»¥ä½¿ç”¨è„šæœ¬å¤„ç†å™¨æ¥å¤„ç†metadataï¼Œå¦‚_indexå’Œ_typeã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªIngest Pipelineçš„ç¤ºä¾‹ï¼Œæ— è®ºåŽŸå§‹ç´¢å¼•è¯·æ±‚ä¸­æä¾›äº†ä»€ä¹ˆï¼Œå®ƒéƒ½ä¼šå°†ç´¢å¼•å’Œç±»åž‹é‡å‘½åä¸ºmy_indexï¼š1234567891011121314PUT _ingest/pipeline/my_index&#123; &quot;description&quot;: &quot;use index:my_index and type:_doc&quot;, &quot;processors&quot;: [ &#123; &quot;script&quot;: &#123; &quot;source&quot;: &quot;&quot;&quot; ctx._index = &apos;my_index&apos;; ctx._type = &apos;_doc&apos;; &quot;&quot;&quot; &#125; &#125; ]&#125;ä½¿ç”¨ä¸Šé¢çš„pipelineï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•indexä¸€ä¸ªæ–‡æ¡£åˆ°any_indexï¼š1234PUT any_index/_doc/1?pipeline=my_index&#123; &quot;message&quot;: &quot;text&quot;&#125;æ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š1234567891011121314&#123; &quot;_index&quot;: &quot;my_index&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: &quot;1&quot;, &quot;_version&quot;: 1, &quot;result&quot;: &quot;created&quot;, &quot;_shards&quot;: &#123; &quot;total&quot;: 2, &quot;successful&quot;: 1, &quot;failed&quot;: 0 &#125;, &quot;_seq_no&quot;: 89, &quot;_primary_term&quot;: 1,&#125;ä¹Ÿå°±æ˜¯è¯´çœŸæ­£çš„æ–‡æ¡£æ—¶å­˜åˆ°my_indexä¹‹ä¸­ï¼Œè€Œä¸æ˜¯any_indexã€‚ä¾‹å­31234567891011121314PUT _ingest/pipeline/blogs_pipeline&#123; &quot;processors&quot;: [ &#123; &quot;script&quot;: &#123; &quot;source&quot;: &quot;&quot;&quot; if (ctx.category == &quot;&quot;) &#123; ctx.category = &quot;None&quot; &#125; &quot;&quot;&quot; &#125; &#125; ]&#125;æˆ‘ä»¬ä¸Šé¢å®šä¹‰äº†ä¸€ä¸ªpipelineï¼Œå®ƒå¯ä»¥å¸®æˆ‘ä»¬æ£€æŸ¥å¦‚æžœ categoryå­—æ®µæ˜¯å¦ä¸ºç©ºï¼Œå¦‚æžœæ˜¯ï¼Œå°±ä¿®æ”¹ä¸ºâ€œNoneâ€ã€‚è¿˜æ˜¯ä»¥ä¹‹å‰çš„é‚£ä¸ªtest_scriptç´¢å¼•ä¸ºä¾‹ï¼š12345678PUT test_script/_doc/2?pipeline=blogs_pipeline&#123; &quot;field_a&quot;: 5, &quot;field_b&quot;: 10, &quot;category&quot;: &quot;&quot;&#125; GET test_script/_doc/2æ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š1234567891011121314&#123; &quot;_index&quot; : &quot;test_script&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;2&quot;, &quot;_version&quot; : 2, &quot;_seq_no&quot; : 6, &quot;_primary_term&quot; : 1, &quot;found&quot; : true, &quot;_source&quot; : &#123; &quot;field_a&quot; : 5, &quot;field_b&quot; : 10, &quot;category&quot; : &quot;None&quot; &#125;&#125;æ˜¾ç„¶ï¼Œå®ƒæŠŠcategoryä¸ºâ€œâ€çš„å­—æ®µå˜ä¸ºâ€œNoneâ€äº†ã€‚ä¾‹å­412345678910111213141516POST _reindex&#123; &quot;source&quot;: &#123; &quot;index&quot;: &quot;blogs&quot; &#125;, &quot;dest&quot;: &#123; &quot;index&quot;: &quot;blogs_fixed&quot; &#125;, &quot;script&quot;: &#123; &quot;source&quot;: &quot;&quot;&quot; if (ctx._source.category == &quot;&quot;) &#123; ctx._source.category = &quot;None&quot; &#125;&quot;&quot;&quot; &#125;&#125;ä¸Šé¢çš„è¿™ä¸ªä¾‹å­åœ¨reindexæ—¶ï¼Œå¦‚æžœcategoryä¸ºç©ºæ—¶ï¼Œå†™å…¥â€œNoneâ€ã€‚æˆ‘ä»¬å¯ä»¥ä»Žä¸Šé¢çš„ä¸¤ä¸ªä¾‹å­ä¸­çœ‹å‡ºæ¥ï¼Œé’ˆå¯¹pipelineï¼Œæˆ‘ä»¬å¯ä»¥ç›´æŽ¥å¯¹cxt.fieldè¿›è¡Œæ“ä½œï¼Œè€Œé’ˆå¯¹updateæ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹cxt._sourceä¸‹çš„å­—æ®µè¿›è¡Œæ“ä½œã€‚è¿™ä¹Ÿæ˜¯ä¹‹å‰æåˆ°çš„ä¸Šä¸‹æ–‡çš„åŒºåˆ«ã€‚ä¾‹å­512345PUT test/_doc/1&#123; &quot;counter&quot; : 1, &quot;tags&quot; : [&quot;red&quot;]&#125;æ‚¨å¯ä»¥ä½¿ç”¨å’Œupdateè„šæœ¬å°†tagæ·»åŠ åˆ°tagsåˆ—è¡¨ï¼ˆè¿™åªæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œå› æ­¤å³ä½¿å­˜åœ¨æ ‡è®°ä¹Ÿä¼šæ·»åŠ ï¼‰ï¼š12345678910POST test/_update/1&#123; &quot;script&quot; : &#123; &quot;source&quot;: &quot;ctx._source.tags.add(params.tag)&quot;, &quot;lang&quot;: &quot;painless&quot;, &quot;params&quot; : &#123; &quot;tag&quot; : &quot;blue&quot; &#125; &#125;&#125;æ˜¾ç¤ºç»“æžœï¼š123456789101112131415161718GET test/_doc/1 &#123; &quot;_index&quot; : &quot;test&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_version&quot; : 4, &quot;_seq_no&quot; : 3, &quot;_primary_term&quot; : 11, &quot;found&quot; : true, &quot;_source&quot; : &#123; &quot;counter&quot; : 1, &quot;tags&quot; : [ &quot;red&quot;, &quot;blue&quot; ] &#125; &#125;æ˜¾ç¤ºâ€œblueâ€ï¼Œå·²ç»è¢«æˆåŠŸåŠ å…¥åˆ°tagsåˆ—è¡¨ä¹‹ä¸­äº†ã€‚æ‚¨è¿˜å¯ä»¥ä»Žtagsåˆ—è¡¨ä¸­åˆ é™¤tagã€‚ åˆ é™¤tagçš„Painlesså‡½æ•°é‡‡ç”¨è¦åˆ é™¤çš„å…ƒç´ çš„æ•°ç»„ç´¢å¼•ã€‚ ä¸ºé¿å…å¯èƒ½çš„è¿è¡Œæ—¶é”™è¯¯ï¼Œé¦–å…ˆéœ€è¦ç¡®ä¿tagå­˜åœ¨ã€‚ å¦‚æžœåˆ—è¡¨åŒ…å«tagçš„é‡å¤é¡¹ï¼Œåˆ™æ­¤è„šæœ¬åªåˆ é™¤ä¸€ä¸ªåŒ¹é…é¡¹ã€‚123456789101112POST test/_update/1&#123; &quot;script&quot;: &#123; &quot;source&quot;: &quot;if (ctx._source.tags.contains(params.tag)) &#123; ctx._source.tags.remove(ctx._source.tags.indexOf(params.tag)) &#125;&quot;, &quot;lang&quot;: &quot;painless&quot;, &quot;params&quot;: &#123; &quot;tag&quot;: &quot;blue&quot; &#125; &#125;&#125; GET test/_doc/1æ˜¾ç¤ºç»“æžœï¼š123456789101112131415&#123; &quot;_index&quot; : &quot;test&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_version&quot; : 5, &quot;_seq_no&quot; : 4, &quot;_primary_term&quot; : 11, &quot;found&quot; : true, &quot;_source&quot; : &#123; &quot;counter&quot; : 1, &quot;tags&quot; : [ &quot;red&quot; ] &#125;&#125;â€œblueâ€æ˜¾ç„¶å·²ç»è¢«åˆ é™¤äº†ã€‚Painlessè„šæœ¬ç®€å•çš„æ“ç»ƒä¸ºäº†è¯´æ˜ŽPainlessçš„å·¥ä½œåŽŸç†ï¼Œè®©æˆ‘ä»¬å°†ä¸€äº›æ›²æ£çƒç»Ÿè®¡æ•°æ®åŠ è½½åˆ°Elasticsearchç´¢å¼•ä¸­ï¼š1234567891011121314151617181920212223PUT hockey/_bulk?refresh&#123;&quot;index&quot;:&#123;&quot;_id&quot;:1&#125;&#125;&#123;&quot;first&quot;:&quot;johnny&quot;,&quot;last&quot;:&quot;gaudreau&quot;,&quot;goals&quot;:[9,27,1],&quot;assists&quot;:[17,46,0],&quot;gp&quot;:[26,82,1],&quot;born&quot;:&quot;1993/08/13&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_id&quot;:2&#125;&#125;&#123;&quot;first&quot;:&quot;sean&quot;,&quot;last&quot;:&quot;monohan&quot;,&quot;goals&quot;:[7,54,26],&quot;assists&quot;:[11,26,13],&quot;gp&quot;:[26,82,82],&quot;born&quot;:&quot;1994/10/12&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_id&quot;:3&#125;&#125;&#123;&quot;first&quot;:&quot;jiri&quot;,&quot;last&quot;:&quot;hudler&quot;,&quot;goals&quot;:[5,34,36],&quot;assists&quot;:[11,62,42],&quot;gp&quot;:[24,80,79],&quot;born&quot;:&quot;1984/01/04&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_id&quot;:4&#125;&#125;&#123;&quot;first&quot;:&quot;micheal&quot;,&quot;last&quot;:&quot;frolik&quot;,&quot;goals&quot;:[4,6,15],&quot;assists&quot;:[8,23,15],&quot;gp&quot;:[26,82,82],&quot;born&quot;:&quot;1988/02/17&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_id&quot;:5&#125;&#125;&#123;&quot;first&quot;:&quot;sam&quot;,&quot;last&quot;:&quot;bennett&quot;,&quot;goals&quot;:[5,0,0],&quot;assists&quot;:[8,1,0],&quot;gp&quot;:[26,1,0],&quot;born&quot;:&quot;1996/06/20&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_id&quot;:6&#125;&#125;&#123;&quot;first&quot;:&quot;dennis&quot;,&quot;last&quot;:&quot;wideman&quot;,&quot;goals&quot;:[0,26,15],&quot;assists&quot;:[11,30,24],&quot;gp&quot;:[26,81,82],&quot;born&quot;:&quot;1983/03/20&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_id&quot;:7&#125;&#125;&#123;&quot;first&quot;:&quot;david&quot;,&quot;last&quot;:&quot;jones&quot;,&quot;goals&quot;:[7,19,5],&quot;assists&quot;:[3,17,4],&quot;gp&quot;:[26,45,34],&quot;born&quot;:&quot;1984/08/10&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_id&quot;:8&#125;&#125;&#123;&quot;first&quot;:&quot;tj&quot;,&quot;last&quot;:&quot;brodie&quot;,&quot;goals&quot;:[2,14,7],&quot;assists&quot;:[8,42,30],&quot;gp&quot;:[26,82,82],&quot;born&quot;:&quot;1990/06/07&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_id&quot;:39&#125;&#125;&#123;&quot;first&quot;:&quot;mark&quot;,&quot;last&quot;:&quot;giordano&quot;,&quot;goals&quot;:[6,30,15],&quot;assists&quot;:[3,30,24],&quot;gp&quot;:[26,60,63],&quot;born&quot;:&quot;1983/10/03&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_id&quot;:10&#125;&#125;&#123;&quot;first&quot;:&quot;mikael&quot;,&quot;last&quot;:&quot;backlund&quot;,&quot;goals&quot;:[3,15,13],&quot;assists&quot;:[6,24,18],&quot;gp&quot;:[26,82,82],&quot;born&quot;:&quot;1989/03/17&quot;&#125;&#123;&quot;index&quot;:&#123;&quot;_id&quot;:11&#125;&#125;&#123;&quot;first&quot;:&quot;joe&quot;,&quot;last&quot;:&quot;colborne&quot;,&quot;goals&quot;:[3,18,13],&quot;assists&quot;:[6,20,24],&quot;gp&quot;:[26,67,82],&quot;born&quot;:&quot;1990/01/30&quot;&#125;ä½¿ç”¨Painlessè®¿é—®Docé‡Œçš„å€¼æ–‡æ¡£é‡Œçš„å€¼å¯ä»¥é€šè¿‡ä¸€ä¸ªå«åšdocçš„Mapå€¼æ¥è®¿é—®ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹è„šæœ¬è®¡ç®—çŽ©å®¶çš„æ€»è¿›çƒæ•°ã€‚ æ­¤ç¤ºä¾‹ä½¿ç”¨ç±»åž‹intå’Œforå¾ªçŽ¯ã€‚12345678910111213141516171819GET hockey/_search&#123; &quot;query&quot;: &#123; &quot;function_score&quot;: &#123; &quot;script_score&quot;: &#123; &quot;script&quot;: &#123; &quot;lang&quot;: &quot;painless&quot;, &quot;source&quot;: &quot;&quot;&quot; int total = 0; for (int i = 0; i &lt; doc[&apos;goals&apos;].length; ++i) &#123; total += doc[&apos;goals&apos;][i]; &#125; return total; &quot;&quot;&quot; &#125; &#125; &#125; &#125;&#125;è¿™é‡Œæˆ‘ä»¬é€šè¿‡scriptæ¥è®¡ç®—æ¯ä¸ªæ–‡æ¡£çš„_scoreã€‚é€šè¿‡scriptæŠŠæ¯ä¸ªè¿åŠ¨å‘˜çš„goaléƒ½åŠ èµ·æ¥ï¼Œå¹¶å½¢æˆæœ€ç»ˆçš„_scoreã€‚è¿™é‡Œæˆ‘ä»¬é€šè¿‡doc[â€˜goalsâ€™]è¿™ä¸ªMapç±»åž‹æ¥è®¿é—®æˆ‘ä»¬çš„å­—æ®µå€¼ã€‚æ˜¾ç¤ºçš„ç»“æžœä¸ºï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243&#123; &quot;took&quot; : 25, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 11, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 87.0, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;hockey&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;2&quot;, &quot;_score&quot; : 87.0, &quot;_source&quot; : &#123; &quot;first&quot; : &quot;sean&quot;, &quot;last&quot; : &quot;monohan&quot;, &quot;goals&quot; : [ 7, 54, 26 ], &quot;assists&quot; : [ 11, 26, 13 ], &quot;gp&quot; : [ 26, 82, 82 ], &quot;born&quot; : &quot;1994/10/12&quot; &#125; &#125;,...æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨script_fieldsè€Œä¸æ˜¯function_scoreæ‰§è¡Œç›¸åŒçš„æ“ä½œï¼š1234567891011121314151617181920GET hockey/_search&#123; &quot;query&quot;: &#123; &quot;match_all&quot;: &#123;&#125; &#125;, &quot;script_fields&quot;: &#123; &quot;total_goals&quot;: &#123; &quot;script&quot;: &#123; &quot;lang&quot;: &quot;painless&quot;, &quot;source&quot;: &quot;&quot;&quot; int total = 0; for (int i = 0; i &lt; doc[&apos;goals&apos;].length; ++i) &#123; total += doc[&apos;goals&apos;][i]; &#125; return total; &quot;&quot;&quot; &#125; &#125; &#125;&#125;æ˜¾ç¤ºçš„ç»“æžœä¸ºï¼š123456789101112131415161718192021222324252627282930313233343536373839&#123; &quot;took&quot; : 5, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 11, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 1.0, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;hockey&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 1.0, &quot;fields&quot; : &#123; &quot;total_goals&quot; : [ 37 ] &#125; &#125;, &#123; &quot;_index&quot; : &quot;hockey&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;2&quot;, &quot;_score&quot; : 1.0, &quot;fields&quot; : &#123; &quot;total_goals&quot; : [ 87 ] &#125; &#125;,...ä»¥ä¸‹ç¤ºä¾‹ä½¿ç”¨Painlessè„šæœ¬æŒ‰å…¶ç»„åˆçš„åå­—å’Œå§“æ°å¯¹çŽ©å®¶è¿›è¡ŒæŽ’åºã€‚ ä½¿ç”¨doc [â€˜firstâ€™]ã€‚valueå’Œdoc [â€˜lastâ€™]ã€‚valueè®¿é—®åç§°ã€‚12345678910111213141516GET hockey/_search&#123; &quot;query&quot;: &#123; &quot;match_all&quot;: &#123;&#125; &#125;, &quot;sort&quot;: &#123; &quot;_script&quot;: &#123; &quot;type&quot;: &quot;string&quot;, &quot;order&quot;: &quot;asc&quot;, &quot;script&quot;: &#123; &quot;lang&quot;: &quot;painless&quot;, &quot;source&quot;: &quot;doc[&apos;first.keyword&apos;].value + &apos; &apos; + doc[&apos;last.keyword&apos;].value&quot; &#125; &#125; &#125;&#125;æ£€æŸ¥ç¼ºå¤±é¡¹doc [â€˜fieldâ€™].valueã€‚å¦‚æžœæ–‡æ¡£ä¸­ç¼ºå°‘è¯¥å­—æ®µï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚è¦æ£€æŸ¥æ–‡æ¡£æ˜¯å¦ç¼ºå°‘å€¼ï¼Œå¯ä»¥è°ƒç”¨doc [&#39;field&#39;] .sizeï¼ˆï¼‰== 0ã€‚ä½¿ç”¨Painlessæ›´æ–°å­—æ®µæ‚¨è¿˜å¯ä»¥è½»æ¾æ›´æ–°å­—æ®µã€‚ æ‚¨å¯ä»¥ä½¿ç”¨ctx._source.&lt;field-name&gt;è®¿é—®å­—æ®µçš„åŽŸå§‹æºã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬é€šè¿‡æäº¤ä»¥ä¸‹è¯·æ±‚æ¥æŸ¥çœ‹çŽ©å®¶çš„æºæ•°æ®ï¼š12345678910111213GET hockey/_search&#123; &quot;stored_fields&quot;: [ &quot;_id&quot;, &quot;_source&quot; ], &quot;query&quot;: &#123; &quot;term&quot;: &#123; &quot;_id&quot;: 1 &#125; &#125;&#125;æ˜¾ç¤ºçš„ç»“æžœä¸ºï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445&#123; &quot;took&quot; : 0, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 1, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 1.0, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;hockey&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 1.0, &quot;_source&quot; : &#123; &quot;first&quot; : &quot;johnny&quot;, &quot;last&quot; : &quot;gaudreau&quot;, &quot;goals&quot; : [ 9, 27, 1 ], &quot;assists&quot; : [ 17, 46, 0 ], &quot;gp&quot; : [ 26, 82, 1 ], &quot;born&quot; : &quot;1993/08/13&quot; &#125; &#125; ] &#125;&#125;è¦å°†çŽ©å®¶1çš„å§“æ°æ›´æ”¹ä¸ºhockeyï¼Œåªéœ€å°†ctx._source.lastè®¾ç½®ä¸ºæ–°å€¼ï¼š12345678910POST hockey/_update/1&#123; &quot;script&quot;: &#123; &quot;lang&quot;: &quot;painless&quot;, &quot;source&quot;: &quot;ctx._source.last = params.last&quot;, &quot;params&quot;: &#123; &quot;last&quot;: &quot;hockey&quot; &#125; &#125;&#125;æ‚¨è¿˜å¯ä»¥å‘æ–‡æ¡£æ·»åŠ å­—æ®µã€‚ ä¾‹å¦‚ï¼Œæ­¤è„šæœ¬æ·»åŠ ä¸€ä¸ªåŒ…å«çŽ©å®¶nicknameä¸ºhockeyçš„æ–°å­—æ®µã€‚1234567891011121314POST hockey/_update/1&#123; &quot;script&quot;: &#123; &quot;lang&quot;: &quot;painless&quot;, &quot;source&quot;: &quot;&quot;&quot; ctx._source.last = params.last; ctx._source.nick = params.nick &quot;&quot;&quot;, &quot;params&quot;: &#123; &quot;last&quot;: &quot;gaudreau&quot;, &quot;nick&quot;: &quot;hockey&quot; &#125; &#125;&#125;æ˜¾ç¤ºçš„ç»“æžœä¸ºï¼š12345678910111213141516171819202122232425262728293031GET hockey/_doc/1 &#123; &quot;_index&quot; : &quot;hockey&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_version&quot; : 2, &quot;_seq_no&quot; : 11, &quot;_primary_term&quot; : 1, &quot;found&quot; : true, &quot;_source&quot; : &#123; &quot;first&quot; : &quot;johnny&quot;, &quot;last&quot; : &quot;gaudreau&quot;, &quot;goals&quot; : [ 9, 27, 1 ], &quot;assists&quot; : [ 17, 46, 0 ], &quot;gp&quot; : [ 26, 82, 1 ], &quot;born&quot; : &quot;1993/08/13&quot;, &quot;nick&quot; : &quot;hockey&quot; &#125; &#125;æœ‰ä¸€ä¸ªå«åš â€œnickâ€çš„æ–°å­—æ®µè¢«åŠ å…¥äº†ã€‚æˆ‘ä»¬ç”šè‡³å¯ä»¥å¯¹æ—¥æœŸç±»åž‹æ¥è¿›è¡Œæ“ä½œä»Žè€Œå¾—åˆ°å¹´æœˆç­‰ä¿¡æ¯ï¼š12345678910GET hockey/_search&#123; &quot;script_fields&quot;: &#123; &quot;birth_year&quot;: &#123; &quot;script&quot;: &#123; &quot;source&quot;: &quot;doc.born.value.year&quot; &#125; &#125; &#125;&#125;æ˜¾ç¤ºç»“æžœï¼š12345678910111213141516171819202122232425262728&#123; &quot;took&quot; : 0, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 11, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 1.0, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;hockey&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;2&quot;, &quot;_score&quot; : 1.0, &quot;fields&quot; : &#123; &quot;birth_year&quot; : [ 1994 ] &#125; &#125;,...Script CachingElasticsearchç¬¬ä¸€æ¬¡çœ‹åˆ°ä¸€ä¸ªæ–°è„šæœ¬ï¼Œå®ƒä¼šç¼–è¯‘å®ƒå¹¶å°†ç¼–è¯‘åŽçš„ç‰ˆæœ¬å­˜å‚¨åœ¨ç¼“å­˜ä¸­ã€‚æ— è®ºæ˜¯inlineæˆ–æ˜¯storedè„šæœ¬éƒ½å­˜å‚¨åœ¨ç¼“å­˜ä¸­ã€‚æ–°è„šæœ¬å¯ä»¥é©±é€ç¼“å­˜çš„è„šæœ¬ã€‚é»˜è®¤çš„æƒ…å†µä¸‹æ˜¯å¯ä»¥å­˜å‚¨100ä¸ªè„šæœ¬ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®script.cache.max_sizeæ¥æ”¹å˜å…¶å¤§å°ï¼Œæˆ–è€…é€šè¿‡script.cache.expireæ¥è®¾ç½®è¿‡æœŸçš„æ—¶é—´ã€‚è¿™äº›è®¾ç½®éœ€è¦åœ¨config/elasticsearch.ymlé‡Œè®¾ç½®ã€‚Script è°ƒè¯•ä¸èƒ½è°ƒè¯•çš„è„šæœ¬æ˜¯éžå¸¸éš¾çš„ã€‚æœ‰ä¸€ä¸ªå¥½çš„è°ƒè¯•æ‰‹æ®µæ— ç–‘å¯¹æˆ‘ä»¬çš„è„šæœ¬ç¼–ç¨‹æ˜¯éžå¸¸æœ‰ç”¨çš„ã€‚Debug.explainPainlessæ²¡æœ‰REPLï¼Œè™½ç„¶æœ‰ä¸€å¤©å®ƒå¾ˆå¥½ï¼Œä½†å®ƒä¸ä¼šå‘Šè¯‰ä½ å…³äºŽè°ƒè¯•Elasticsearchä¸­åµŒå…¥çš„Painlessè„šæœ¬çš„å…¨éƒ¨æ•…äº‹ï¼Œå› ä¸ºè„šæœ¬å¯ä»¥è®¿é—®çš„æ•°æ®æˆ–â€œä¸Šä¸‹æ–‡â€ æ˜¯å¦‚æ­¤é‡è¦ã€‚ ç›®å‰ï¼Œè°ƒè¯•åµŒå…¥å¼è„šæœ¬çš„æœ€ä½³æ–¹æ³•æ˜¯åœ¨é€‰æ‹©ä½ç½®æŠ›å‡ºå¼‚å¸¸ã€‚ è™½ç„¶æ‚¨å¯ä»¥æŠ›å‡ºè‡ªå·±çš„å¼‚å¸¸ï¼ˆthrow new exception(â€˜whateverâ€™ï¼‰ï¼Œä½†Painlessçš„æ²™ç®±ä¼šé˜»æ­¢æ‚¨è®¿é—®æœ‰ç”¨çš„ä¿¡æ¯ï¼Œå¦‚å¯¹è±¡çš„ç±»åž‹ã€‚ æ‰€ä»¥Painlessæœ‰ä¸€ä¸ªå®žç”¨å·¥å…·æ–¹æ³•Debug.explainï¼Œå®ƒä¼šä¸ºä½ æŠ›å‡ºå¼‚å¸¸ã€‚ ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨_explainæ¥æŽ¢ç´¢script queryå¯ç”¨çš„ä¸Šä¸‹æ–‡ã€‚PUT /hockey/_doc/1?refresh {&quot;first&quot;:&quot;johnny&quot;,&quot;last&quot;:&quot;gaudreau&quot;,&quot;goals&quot;:[9,27,1],&quot;assists&quot;:[17,46,0],&quot;gp&quot;:[26,82,1]} POST /hockey/_explain/1 { &quot;query&quot;: { &quot;script&quot;: { &quot;script&quot;: &quot;Debug.explain(doc.goals)&quot; } } } è¿™è¡¨æ˜Ždoc.goalsç±»æ˜¯org.elasticsearch.index.fielddata.ScriptDocValues.Longsé€šè¿‡å“åº”ï¼š{ &quot;error&quot;: { &quot;root_cause&quot;: [ { &quot;type&quot;: &quot;script_exception&quot;, &quot;reason&quot;: &quot;runtime error&quot;, &quot;painless_class&quot;: &quot;org.elasticsearch.index.fielddata.ScriptDocValues.Longs&quot;, &quot;to_string&quot;: &quot;[1, 9, 27]&quot;, &quot;java_class&quot;: &quot;org.elasticsearch.index.fielddata.ScriptDocValues$Longs&quot;, &quot;script_stack&quot;: [ &quot;Debug.explain(doc.goals)&quot;, &quot; ^---- HERE&quot; ], &quot;script&quot;: &quot;Debug.explain(doc.goals)&quot;, &quot;lang&quot;: &quot;painless&quot; } ], &quot;type&quot;: &quot;script_exception&quot;, &quot;reason&quot;: &quot;runtime error&quot;, &quot;painless_class&quot;: &quot;org.elasticsearch.index.fielddata.ScriptDocValues.Longs&quot;, &quot;to_string&quot;: &quot;[1, 9, 27]&quot;, &quot;java_class&quot;: &quot;org.elasticsearch.index.fielddata.ScriptDocValues$Longs&quot;, &quot;script_stack&quot;: [ &quot;Debug.explain(doc.goals)&quot;, &quot; ^---- HERE&quot; ], &quot;script&quot;: &quot;Debug.explain(doc.goals)&quot;, &quot;lang&quot;: &quot;painless&quot;, &quot;caused_by&quot;: { &quot;type&quot;: &quot;painless_explain_error&quot;, &quot;reason&quot;: null } }, &quot;status&quot;: 400 } æ‚¨å¯ä»¥ä½¿ç”¨ç›¸åŒçš„æŠ€å·§æ¥æŸ¥çœ‹_sourceæ˜¯_update APIä¸­çš„LinkedHashMapï¼š1234POST /hockey/_update/1&#123; &quot;script&quot;: &quot;Debug.explain(ctx._source)&quot;&#125;æ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š123456789101112131415161718192021222324252627282930&#123; &quot;error&quot;: &#123; &quot;root_cause&quot;: [ &#123; &quot;type&quot;: &quot;remote_transport_exception&quot;, &quot;reason&quot;: &quot;[localhost][127.0.0.1:9300][indices:data/write/update[s]]&quot; &#125; ], &quot;type&quot;: &quot;illegal_argument_exception&quot;, &quot;reason&quot;: &quot;failed to execute script&quot;, &quot;caused_by&quot;: &#123; &quot;type&quot;: &quot;script_exception&quot;, &quot;reason&quot;: &quot;runtime error&quot;, &quot;painless_class&quot;: &quot;java.util.LinkedHashMap&quot;, &quot;to_string&quot;: &quot;&#123;first=johnny, last=gaudreau, goals=[9, 27, 1], assists=[17, 46, 0], gp=[26, 82, 1], born=1993/08/13, nick=hockey&#125;&quot;, &quot;java_class&quot;: &quot;java.util.LinkedHashMap&quot;, &quot;script_stack&quot;: [ &quot;Debug.explain(ctx._source)&quot;, &quot; ^---- HERE&quot; ], &quot;script&quot;: &quot;Debug.explain(ctx._source)&quot;, &quot;lang&quot;: &quot;painless&quot;, &quot;caused_by&quot;: &#123; &quot;type&quot;: &quot;painless_explain_error&quot;, &quot;reason&quot;: null &#125; &#125; &#125;, &quot;status&quot;: 400&#125;å‚è€ƒï¼šã€1ã€‘https://www.elastic.co/guide/en/elasticsearch/painless/current/painless-walkthrough.htmlã€2ã€‘https://www.elastic.co/guide/en/elasticsearch/painless/current/painless-debugging.html]]></content>
  </entry>
  <entry>
    <title></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%20Ngrams%2C%20edge%20ngrams%2C%20and%20shingles%2F</url>
    <content type="text"><![CDATA[Ngramså’Œedge ngramsæ˜¯åœ¨Elasticsearchä¸­æ ‡è®°æ–‡æœ¬çš„ä¸¤ç§æ›´ç‹¬ç‰¹çš„æ–¹å¼ã€‚ Ngramsæ˜¯ä¸€ç§å°†ä¸€ä¸ªæ ‡è®°åˆ†æˆä¸€ä¸ªå•è¯çš„æ¯ä¸ªéƒ¨åˆ†çš„å¤šä¸ªå­å­—ç¬¦çš„æ–¹æ³•ã€‚ ngramå’Œedge ngramè¿‡æ»¤å™¨éƒ½å…è®¸æ‚¨æŒ‡å®šmin_gramä»¥åŠmax_gramè®¾ç½®ã€‚ è¿™äº›è®¾ç½®æŽ§åˆ¶å•è¯è¢«åˆ†å‰²æˆçš„æ ‡è®°çš„å¤§å°ã€‚ è¿™å¯èƒ½ä»¤äººå›°æƒ‘ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ã€‚ å‡è®¾ä½ æƒ³ç”¨ngramåˆ†æžä»ªåˆ†æžâ€œspaghettiâ€è¿™ä¸ªè¯ï¼Œè®©æˆ‘ä»¬ä»Žæœ€ç®€å•çš„æƒ…å†µå¼€å§‹ï¼Œ1-gamsï¼ˆä¹Ÿç§°ä¸ºunigramsï¼‰ã€‚åœ¨å®žé™…çš„æœç´¢ä¾‹å­ä¸­ï¼Œæ¯”å¦‚è°·æ­Œæœç´¢ï¼šæ¯å½“æˆ‘ä»¬æ‰“å…¥å‰é¢çš„å‡ ä¸ªå­—æ¯æ—¶ï¼Œå°±ä¼šå‡ºçŽ°ç›¸åº”çš„å¾ˆå¤šçš„å€™é€‰åå•ã€‚è¿™ä¸ªå°±æ˜¯autocompleteåŠŸèƒ½ã€‚åœ¨Elasticsearchä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡Edge ngramæ¥å®žçŽ°è¿™ä¸ªç›®çš„ã€‚1-gramsâ€œspaghettiâ€çš„1-gramsæ˜¯sï¼Œpï¼Œaï¼Œgï¼Œhï¼Œeï¼Œtï¼Œtï¼Œiã€‚ æ ¹æ®ngramçš„å¤§å°å°†å­—ç¬¦ä¸²æ‹†åˆ†ä¸ºè¾ƒå°çš„tokenã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸ªtokenéƒ½æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼Œå› ä¸ºæˆ‘ä»¬è°ˆè®ºçš„æ˜¯unigramsã€‚Bigramså¦‚æžœä½ è¦å°†å­—ç¬¦ä¸²æ‹†åˆ†ä¸ºåŒå­—æ¯ç»„ï¼ˆè¿™æ„å‘³ç€å¤§å°ä¸º2ï¼‰ï¼Œä½ å°†èŽ·å¾—ä»¥ä¸‹è¾ƒå°çš„tokenï¼šspï¼Œpaï¼Œagï¼Œghï¼Œheï¼Œetï¼Œttï¼Œtiã€‚Trigramså†è¯´ä¸€æ¬¡ï¼Œå¦‚æžœä½ è¦ä½¿ç”¨ä¸‰ä¸ªå¤§å°ï¼Œä½ å°†å¾—åˆ°tokenä¸ºspaï¼Œpagï¼Œaghï¼Œgheï¼Œhetï¼Œettï¼Œttiã€‚è®¾ç½®min_gramå’Œmax_gramä½¿ç”¨æ­¤åˆ†æžå™¨æ—¶ï¼Œéœ€è¦è®¾ç½®ä¸¤ç§ä¸åŒçš„å¤§å°ï¼šä¸€ç§æŒ‡å®šè¦ç”Ÿæˆçš„æœ€å°ngramsï¼ˆmin_gramè®¾ç½®ï¼‰ï¼Œå¦ä¸€ç§æŒ‡å®šè¦ç”Ÿæˆçš„æœ€å¤§ngramsã€‚ ä½¿ç”¨å‰é¢çš„ç¤ºä¾‹ï¼Œå¦‚æžœæ‚¨æŒ‡å®šmin_gramä¸º2ä¸”max_gramä¸º3ï¼Œåˆ™æ‚¨å°†èŽ·å¾—å‰ä¸¤ä¸ªç¤ºä¾‹ä¸­çš„ç»„åˆæ ‡è®°ï¼š1sp, spa, pa, pag, ag, agh, gh, ghe, he, het, et, ett, tt, tti, tiå¦‚æžœä½ è¦å°†min_gramè®¾ç½®ä¸º1å¹¶å°†max_gramè®¾ç½®ä¸º3ï¼Œé‚£ä¹ˆä½ å°†å¾—åˆ°æ›´å¤šçš„æ ‡è®°ï¼Œä»Žsï¼Œspï¼Œspaï¼Œpï¼Œpaï¼Œpagï¼Œaï¼Œâ€¦.å¼€å§‹ã€‚ä»¥è¿™ç§æ–¹å¼åˆ†æžæ–‡æœ¬å…·æœ‰ä¸€ä¸ªæœ‰è¶£çš„ä¼˜ç‚¹ã€‚ å½“ä½ æŸ¥è¯¢æ–‡æœ¬æ—¶ï¼Œä½ çš„æŸ¥è¯¢å°†ä»¥ç›¸åŒçš„æ–¹å¼è¢«åˆ†å‰²æˆæ–‡æœ¬ï¼Œæ‰€ä»¥è¯´ä½ æ­£åœ¨å¯»æ‰¾æ‹¼å†™é”™è¯¯çš„å•è¯â€œspaghetyâ€ã€‚æœç´¢è¿™ä¸ªçš„ä¸€ç§æ–¹æ³•æ˜¯åšä¸€ä¸ªfuzzy queryï¼Œå®ƒå…è®¸ä½  æŒ‡å®šå•è¯çš„ç¼–è¾‘è·ç¦»ä»¥æ£€æŸ¥åŒ¹é…ã€‚ ä½†æ˜¯ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ngramsæ¥èŽ·å¾—ç±»ä¼¼çš„è¡Œä¸ºã€‚ è®©æˆ‘ä»¬å°†åŽŸå§‹å•è¯ï¼ˆâ€œspaghettiâ€ï¼‰ç”Ÿæˆçš„bigramsä¸Žæ‹¼å†™é”™è¯¯çš„å•è¯ï¼ˆâ€œspaghetyâ€ï¼‰è¿›è¡Œæ¯”è¾ƒï¼šâ€œspaghettiâ€çš„bigramsï¼šspï¼Œpaï¼Œagï¼Œghï¼Œheï¼Œetï¼Œttï¼Œtiâ€œspaghetyâ€çš„bigramsï¼šspï¼Œpaï¼Œagï¼Œghï¼Œheï¼Œetï¼Œtyæ‚¨å¯ä»¥çœ‹åˆ°å…­ä¸ªtokené‡å ï¼Œå› æ­¤å½“æŸ¥è¯¢åŒ…å«â€œspaghetyâ€æ—¶ï¼Œå…¶ä¸­å¸¦æœ‰â€œspaghettiâ€çš„å•è¯ä»ç„¶åŒ¹é…ã€‚è¯·è®°ä½ï¼Œè¿™æ„å‘³ç€æ‚¨å¯èƒ½ä¸æ‰“ç®—ä½¿ç”¨çš„åŽŸå§‹â€œspaghettiâ€å•è¯æ›´å¤šçš„å•è¯ ï¼Œæ‰€ä»¥è¯·åŠ¡å¿…æµ‹è¯•æ‚¨çš„æŸ¥è¯¢ç›¸å…³æ€§ï¼ngramsåšçš„å¦ä¸€ä¸ªæœ‰ç”¨çš„äº‹æƒ…æ˜¯å…è®¸æ‚¨åœ¨äº‹å…ˆä¸äº†è§£è¯­è¨€æ—¶æˆ–è€…å½“æ‚¨ä½¿ç”¨ä¸Žå…¶ä»–æ¬§æ´²è¯­è¨€ä¸åŒçš„æ–¹å¼ç»„åˆå•è¯çš„è¯­è¨€æ—¶åˆ†æžæ–‡æœ¬ã€‚ è¿™è¿˜æœ‰ä¸€ä¸ªä¼˜ç‚¹ï¼Œå³èƒ½å¤Ÿä½¿ç”¨å•ä¸ªåˆ†æžå™¨å¤„ç†å¤šç§è¯­è¨€ï¼Œè€Œä¸å¿…æŒ‡å®šã€‚Edge ngramså¸¸è§„ngramæ‹†åˆ†çš„å˜ä½“ç§°ä¸ºedge ngramsï¼Œä»…ä»Žå‰æ²¿æž„å»ºngramã€‚ åœ¨â€œspaghettiâ€ç¤ºä¾‹ä¸­ï¼Œå¦‚æžœå°†min_gramè®¾ç½®ä¸º2å¹¶å°†max_gramè®¾ç½®ä¸º6ï¼Œåˆ™ä¼šèŽ·å¾—ä»¥ä¸‹æ ‡è®°ï¼š1sp, spa, spag, spagh, spagheæ‚¨å¯ä»¥çœ‹åˆ°æ¯ä¸ªæ ‡è®°éƒ½æ˜¯ä»Žè¾¹ç¼˜æž„å»ºçš„ã€‚ è¿™æœ‰åŠ©äºŽæœç´¢å…±äº«ç›¸åŒå‰ç¼€çš„å•è¯è€Œæ— éœ€å®žé™…æ‰§è¡Œå‰ç¼€æŸ¥è¯¢ã€‚ å¦‚æžœä½ éœ€è¦ä»Žä¸€ä¸ªå•è¯çš„åŽé¢æž„å»ºngramsï¼Œä½ å¯ä»¥ä½¿ç”¨sideå±žæ€§ä»ŽåŽé¢è€Œä¸æ˜¯é»˜è®¤å‰é¢èŽ·å–è¾¹ç¼˜ã€‚Ngram è®¾ç½®å½“ä½ ä¸çŸ¥é“è¯­è¨€æ˜¯ä»€ä¹ˆæ—¶ï¼ŒNgramsæ˜¯åˆ†æžæ–‡æœ¬çš„å¥½æ–¹æ³•ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥åˆ†æžå•è¯ä¹‹é—´æ²¡æœ‰ç©ºæ ¼çš„è¯­è¨€ã€‚ ä½¿ç”¨minå’Œmax gramsé…ç½®edge ngram analyzerçš„ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤º:1234567891011121314151617181920212223PUT my_index&#123; &quot;settings&quot;: &#123; &quot;analysis&quot;: &#123; &quot;analyzer&quot;: &#123; &quot;my_analyzer&quot;: &#123; &quot;tokenizer&quot;: &quot;my_tokenizer&quot; &#125; &#125;, &quot;tokenizer&quot;: &#123; &quot;my_tokenizer&quot;: &#123; &quot;type&quot;: &quot;edge_ngram&quot;, &quot;min_gram&quot;: 2, &quot;max_gram&quot;: 10, &quot;token_chars&quot;: [ &quot;letter&quot;, &quot;digit&quot; ] &#125; &#125; &#125; &#125;&#125;æˆ‘ä»¬å¯ä»¥ç”¨åˆšæ‰åˆ›å»ºçš„my_tokenizeræ¥åˆ†æžæˆ‘ä»¬çš„å­—ç¬¦ä¸²ï¼š12345POST my_index/_analyze&#123; &quot;analyzer&quot;: &quot;my_analyzer&quot;, &quot;text&quot;: &quot;2 Quick Foxes.&quot;&#125;æ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960&#123; &quot;tokens&quot; : [ &#123; &quot;token&quot; : &quot;Qu&quot;, &quot;start_offset&quot; : 2, &quot;end_offset&quot; : 4, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 0 &#125;, &#123; &quot;token&quot; : &quot;Qui&quot;, &quot;start_offset&quot; : 2, &quot;end_offset&quot; : 5, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 1 &#125;, &#123; &quot;token&quot; : &quot;Quic&quot;, &quot;start_offset&quot; : 2, &quot;end_offset&quot; : 6, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 2 &#125;, &#123; &quot;token&quot; : &quot;Quick&quot;, &quot;start_offset&quot; : 2, &quot;end_offset&quot; : 7, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 3 &#125;, &#123; &quot;token&quot; : &quot;Fo&quot;, &quot;start_offset&quot; : 8, &quot;end_offset&quot; : 10, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 4 &#125;, &#123; &quot;token&quot; : &quot;Fox&quot;, &quot;start_offset&quot; : 8, &quot;end_offset&quot; : 11, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 5 &#125;, &#123; &quot;token&quot; : &quot;Foxe&quot;, &quot;start_offset&quot; : 8, &quot;end_offset&quot; : 12, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 6 &#125;, &#123; &quot;token&quot; : &quot;Foxes&quot;, &quot;start_offset&quot; : 8, &quot;end_offset&quot; : 13, &quot;type&quot; : &quot;word&quot;, &quot;position&quot; : 7 &#125; ]&#125;å› ä¸ºæˆ‘ä»¬å®šä¹‰çš„min_gramæ˜¯2ï¼Œæ‰€ä»¥ç”Ÿæˆçš„tokençš„é•¿åº¦æ˜¯ä»Ž2å¼€å§‹çš„ã€‚é€šå¸¸æˆ‘ä»¬å»ºè®®åœ¨ç´¢å¼•æ—¶å’Œæœç´¢æ—¶ä½¿ç”¨ç›¸åŒçš„åˆ†æžå™¨ã€‚ åœ¨edge_ngram tokenizerçš„æƒ…å†µä¸‹ï¼Œå»ºè®®æ˜¯ä¸åŒçš„ã€‚ ä»…åœ¨ç´¢å¼•æ—¶ä½¿ç”¨edge_ngramæ ‡è®°ç”Ÿæˆå™¨æ‰æœ‰æ„ä¹‰ï¼Œä»¥ç¡®ä¿éƒ¨åˆ†å•è¯å¯ç”¨äºŽç´¢å¼•ä¸­çš„åŒ¹é…ã€‚ åœ¨æœç´¢æ—¶ï¼Œåªéœ€æœç´¢ç”¨æˆ·è¾“å…¥çš„æœ¯è¯­ï¼Œä¾‹å¦‚ï¼šQuick Foã€‚ä¸‹é¢æ˜¯å¦‚ä½•ä¸ºæœç´¢ç±»åž‹è®¾ç½®å­—æ®µçš„ç¤ºä¾‹ï¼š12345678910111213141516171819202122232425262728293031323334353637PUT my_index&#123; &quot;settings&quot;: &#123; &quot;analysis&quot;: &#123; &quot;analyzer&quot;: &#123; &quot;autocomplete&quot;: &#123; &quot;tokenizer&quot;: &quot;autocomplete&quot;, &quot;filter&quot;: [ &quot;lowercase&quot; ] &#125;, &quot;autocomplete_search&quot;: &#123; &quot;tokenizer&quot;: &quot;lowercase&quot; &#125; &#125;, &quot;tokenizer&quot;: &#123; &quot;autocomplete&quot;: &#123; &quot;type&quot;: &quot;edge_ngram&quot;, &quot;min_gram&quot;: 2, &quot;max_gram&quot;: 10, &quot;token_chars&quot;: [ &quot;letter&quot; ] &#125; &#125; &#125; &#125;, &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;title&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;analyzer&quot;: &quot;autocomplete&quot;, &quot;search_analyzer&quot;: &quot;autocomplete_search&quot; &#125; &#125; &#125;&#125;åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç´¢å¼•æ—¶å’Œæœç´¢æ—¶æ—¶ç”¨äº†ä¸¤ä¸ªä¸åŒçš„analyzerï¼šautocompleteåŠautocomplete_searchã€‚123456PUT my_index/_doc/1&#123; &quot;title&quot;: &quot;Quick Foxes&quot; &#125; POST my_index/_refreshä¸Šé¢æˆ‘ä»¬åŠ å…¥ä¸€ä¸ªæ–‡æ¡£ã€‚ä¸‹é¢æˆ‘ä»¬æ¥è¿›è¡Œæœç´¢ï¼š1234567891011GET my_index/_search&#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;title&quot;: &#123; &quot;query&quot;: &quot;Quick Fo&quot;, &quot;operator&quot;: &quot;and&quot; &#125; &#125; &#125;&#125;æ˜¾ç¤ºç»“æžœï¼š12345678910111213141516171819202122232425262728&#123; &quot;took&quot; : 3, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 1, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 0.5753642, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;my_index&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 0.5753642, &quot;_source&quot; : &#123; &quot;title&quot; : &quot;Quick Foxes&quot; &#125; &#125; ] &#125;&#125;åœ¨è¿™é‡Œautocomplete analyzerå¯ä»¥æŠŠå­—ç¬¦ä¸²â€œQuick Foxesâ€åˆ†è§£ä¸º[qu, qui, quic, quick, fo, fox, foxe, foxes]ã€‚è€Œè‡ªautocomplete_search analyzeræœç´¢æ¡ç›®[quickï¼Œfo]ï¼Œä¸¤è€…éƒ½å‡ºçŽ°åœ¨ç´¢å¼•ä¸­ã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥åšå¦‚ä¸‹çš„æœç´¢ï¼š12345678910GET my_index/_search&#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;title&quot;: &#123; &quot;query&quot;: &quot;Fo&quot; &#125; &#125; &#125;&#125;æ˜¾ç¤ºçš„å’Œä¸Šé¢ä¸€æ ·çš„ç»“æžœã€‚Shinglesä¸Žngramså’Œedge ngramsä¸€æ ·ï¼Œæœ‰ä¸€ä¸ªç§°ä¸ºshingleçš„è¿‡æ»¤å™¨ï¼ˆä¸ï¼Œä¸æ˜¯ç–¾ç—…çš„é‚£ä¸ªshingleï¼ï¼‰ã€‚ Shingle tokenè¿‡æ»¤å™¨åŸºæœ¬ä¸Šæ˜¯tokençº§åˆ«çš„ngramsè€Œä¸æ˜¯å­—ç¬¦çº§åˆ«ã€‚æƒ³æƒ³æˆ‘ä»¬æœ€å–œæ¬¢çš„å•è¯â€œspaghettiâ€ã€‚ä½¿ç”¨æœ€å°å’Œæœ€å¤§è®¾ç½®ä¸º1å’Œ3çš„ngramsï¼ŒElasticsearchå°†ç”Ÿæˆæ ‡è®°sï¼Œspï¼Œspaï¼Œpï¼Œpaï¼Œpagï¼Œaï¼Œagç­‰ã€‚ ä¸€ä¸ªshingleè¿‡æ»¤å™¨åœ¨tokençº§åˆ«æ‰§è¡Œæ­¤æ“ä½œï¼Œå› æ­¤å¦‚æžœæ‚¨æœ‰æ–‡æœ¬â€œfoo bar bazâ€å¹¶å†æ¬¡ä½¿ç”¨in_shingle_sizeä¸º2ä¸”max_shingle_sizeä¸º3ï¼Œåˆ™æ‚¨å°†ç”Ÿæˆä»¥ä¸‹tokenï¼š1foo, foo bar, foo bar baz, bar, bar baz, bazä¸ºä»€ä¹ˆä»ç„¶åŒ…å«å•tokenè¾“å‡ºï¼Ÿ è¿™æ˜¯å› ä¸ºé»˜è®¤æƒ…å†µä¸‹ï¼Œshingleè¿‡æ»¤å™¨åŒ…å«åŽŸå§‹tokenï¼Œå› æ­¤åŽŸå§‹æ ‡è®°ç”Ÿæˆä»¤ç‰Œfooï¼Œbarå’Œbazï¼Œç„¶åŽå°†å…¶ä¼ é€’ç»™shingle tokenè¿‡æ»¤å™¨ï¼Œç”Ÿæˆæ ‡è®°foo barï¼Œfoo bar bazå’Œbar bazã€‚ æ‰€æœ‰è¿™äº›tokenç»„åˆåœ¨ä¸€èµ·å½¢æˆæœ€ç»ˆtokenæµã€‚ æ‚¨å¯ä»¥é€šè¿‡å°†output_unigramsé€‰é¡¹è®¾ç½®ä¸ºfalseæ¥ç¦ç”¨æ­¤è¡Œä¸ºï¼Œä¹Ÿå³ä¸éœ€è¦æœ€åŽŸå§‹çš„tokenï¼šfoo, baråŠbazä¸‹ä¸€ä¸ªæ¸…å•æ˜¾ç¤ºäº†shingle tokenè¿‡æ»¤å™¨çš„ç¤ºä¾‹; è¯·æ³¨æ„ï¼Œmin_shingle_sizeé€‰é¡¹å¿…é¡»å¤§äºŽæˆ–ç­‰äºŽ2ã€‚123456789101112131415161718192021222324PUT my_index&#123; &quot;settings&quot;: &#123; &quot;analysis&quot;: &#123; &quot;analyzer&quot;: &#123; &quot;shingle&quot;: &#123; &quot;type&quot;: &quot;custom&quot;, &quot;tokenizer&quot;: &quot;standard&quot;, &quot;filter&quot;: [ &quot;shingle-filter&quot; ] &#125; &#125;, &quot;filter&quot;: &#123; &quot;shingle-filter&quot;: &#123; &quot;type&quot;: &quot;shingle&quot;, &quot;min_shingle_size&quot;: 2, &quot;max_shingle_size&quot;: 3, &quot;output_unigrams&quot;: false &#125; &#125; &#125; &#125;&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå«åšshingle-filterçš„è¿‡æ»¤å™¨ã€‚æœ€å°çš„shangleå¤§å°æ˜¯2ï¼Œæœ€å¤§çš„shingleå¤§å°æ˜¯3ã€‚åŒæ—¶æˆ‘ä»¬è®¾ç½®output_unigramsä¸ºfalseï¼Œè¿™æ ·æœ€åˆçš„é‚£äº›tokenå°†ä¸è¢«åŒ…å«åœ¨æœ€ç»ˆçš„ç»“æžœä¹‹ä¸­ã€‚ä¸‹é¢æˆ‘ä»¬æ¥åšä¸€ä¸ªä¾‹å­ï¼Œçœ‹çœ‹æ˜¾ç¤ºçš„ç»“æžœï¼š12345GET /my_index/_analyze&#123; &quot;text&quot;: &quot;foo bar baz&quot;, &quot;analyzer&quot;: &quot;shingle&quot;&#125;æ˜¾ç¤ºçš„ç»“æžœä¸ºï¼š1234567891011121314151617181920212223242526&#123; &quot;tokens&quot; : [ &#123; &quot;token&quot; : &quot;foo bar&quot;, &quot;start_offset&quot; : 0, &quot;end_offset&quot; : 7, &quot;type&quot; : &quot;shingle&quot;, &quot;position&quot; : 0 &#125;, &#123; &quot;token&quot; : &quot;foo bar baz&quot;, &quot;start_offset&quot; : 0, &quot;end_offset&quot; : 11, &quot;type&quot; : &quot;shingle&quot;, &quot;position&quot; : 0, &quot;positionLength&quot; : 2 &#125;, &#123; &quot;token&quot; : &quot;bar baz&quot;, &quot;start_offset&quot; : 4, &quot;end_offset&quot; : 11, &quot;type&quot; : &quot;shingle&quot;, &quot;position&quot; : 1 &#125; ]&#125;å‚è€ƒï¼šã€1ã€‘ https://www.elastic.co/guide/en/elasticsearch/reference/7.3/analysis-edgengram-tokenizer.html]]></content>
  </entry>
  <entry>
    <title></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%20nested%E5%AF%B9%E8%B1%A1%2F</url>
    <content type="text"><![CDATA[åœ¨å¤„ç†å¤§é‡æ•°æ®æ—¶ï¼Œå…³ç³»æ•°æ®åº“å­˜åœ¨å¾ˆå¤šé—®é¢˜ã€‚ æ— è®ºæ˜¯é€Ÿåº¦ï¼Œé«˜æ•ˆå¤„ç†ï¼Œæœ‰æ•ˆå¹¶è¡ŒåŒ–ï¼Œå¯æ‰©å±•æ€§è¿˜æ˜¯æˆæœ¬ï¼Œå½“æ•°æ®é‡å¼€å§‹å¢žé•¿æ—¶ï¼Œå…³ç³»æ•°æ®åº“éƒ½ä¼šå¤±è´¥ã€‚è¯¥å…³ç³»æ•°æ®åº“çš„å¦ä¸€ä¸ªæŒ‘æˆ˜æ˜¯å¿…é¡»é¢„å…ˆå®šä¹‰å…³ç³»å’Œæ¨¡å¼ã€‚Elasticsearchä¹Ÿæ˜¯ä¸€ä¸ªNoSQLæ–‡æ¡£æ•°æ®å­˜å‚¨ã€‚ ä½†æ˜¯ï¼Œå°½ç®¡æ˜¯ä¸€ä¸ªNoSQLæ•°æ®å­˜å‚¨ï¼ŒElasticsearchåœ¨ä¸€å®šç¨‹åº¦ä¸Šæä¾›äº†å¾ˆå¤šå¸®åŠ©æ¥ç®¡ç†å…³ç³»æ•°æ®ã€‚ å®ƒæ”¯æŒç±»ä¼¼SQLçš„è¿žæŽ¥ï¼Œå¹¶ä¸”åœ¨åµŒå¥—å’Œç›¸å…³çš„æ•°æ®å®žä½“ä¸Šå·¥ä½œå¾—éžå¸¸æ£’ã€‚æ¯”å¦‚ï¼Œå¯¹äºŽä¸€ä¸ªåƒä¸‹é¢çš„blogå½¢å¼çš„æ–‡æ¡£ï¼šä¸€ä¸ªblogå¯èƒ½å¯¹åº”äºŽå¾ˆå¤šçš„commentsï¼Œæˆ–è€…ä¸€ä¸ªå‘˜å·¥å¯¹åº”äºŽå¾ˆå¤šçš„ç»éªŒã€‚è¿™ç§æ•°æ®å°±æ˜¯å…³ç³»æ•°æ®ã€‚ä½¿ç”¨Elasticsearchï¼Œæ‚¨å¯ä»¥é€šè¿‡ä¿ç•™è½»æ¾åœ°å·¥ä½œä¸Žä¸åŒå®žä½“çš„å…³è”ä»¥åŠå¼ºå¤§çš„å…¨æ–‡æœç´¢å’Œåˆ†æžã€‚ Elasticsearché€šè¿‡å¼•å…¥ä¸¤ç§ç±»åž‹çš„æ–‡æ¡£å…³ç³»æ¨¡åž‹ä½¿è¿™æˆä¸ºå¯èƒ½ï¼šnested å…³ç³»: åœ¨è¿™ç§å…³ç³»ä¸­ï¼Œè¿™ç§ä¸€å¯¹å¤šçš„å…³ç³»å­˜åœ¨äºŽåŒä¸€ä¸ªæ–‡æ¡£ä¹‹ä¸­parent-child å…³ç³»ï¼šåœ¨è¿™ç§å…³ç³»ä¸­ï¼Œå®ƒä»¬å­˜åœ¨äºŽä¸åŒçš„æ–‡æ¡£ä¹‹ä¸­ã€‚è¿™ä¸¤ç§å…³ç³»åœ¨åŒä¸€ä¸ªæ¨¡å¼ä¸‹å·¥ä½œï¼Œå³ä¸€å¯¹å¤šä¸ªçš„å…³ç³»ã€‚ä¸€ä¸ªrootæˆ–parentå¯ä»¥æœ‰ä¸€ä¸ªåŠå¤šä¸ªå­objectã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåœ¨åµŒå¥—å…³ç³»ä¸­ï¼Œæœ‰ä¸€ä¸ªæ ¹å¯¹è±¡ï¼Œå®ƒæ˜¯æˆ‘ä»¬æ‹¥æœ‰çš„ä¸»æ–‡æ¡£ï¼Œå®ƒåŒ…å«ä¸€ä¸ªç§°ä¸ºåµŒå¥—æ–‡æ¡£çš„å­æ–‡æ¡£æ•°ç»„ã€‚ æ ¹å¯¹è±¡å†…çš„æ–‡æ¡£åµŒå¥—çº§åˆ«æ²¡æœ‰é™åˆ¶ã€‚ ä¾‹å¦‚ï¼ŒæŸ¥çœ‹ä»¥ä¸‹JSONä»¥è¿›è¡Œå¤šçº§åµŒå¥—ï¼š1234567891011121314151617 &#123; &quot;location_id&quot;: &quot;axdbyu&quot;, &quot;location_name&quot;: &quot;gurgaon&quot;, &quot;company&quot;: [ &#123; &quot;name&quot;: &quot;honda&quot;, &quot;modelName&quot;: [ &#123; &quot;name&quot;: &quot;honda cr-v&quot;, &quot;price&quot;: &quot;2 million&quot; &#125; ]&#125;, &#123; &quot;name&quot;: &quot;bmw&quot;, &quot;modelName&quot;: [ &#123; &quot;name&quot;: &quot;BMW 3 Series&quot;, &quot;price&quot;: &quot;2 million&quot;&#125;, &#123; &quot;name&quot;: &quot;BMW 1 Series&quot;, &quot;price&quot;: &quot;3 million&quot; &#125; ] &#125; ]&#125;ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥åšä¸€ä¸ªä¾‹å­æ¥å±•ç¤ºä¸€ä¸‹ä¸ºä»€ä¹ˆnestedå¯¹è±¡å¯ä»¥è§£å†³æˆ‘ä»¬çš„é—®é¢˜ã€‚Objectæ•°æ®ç±»åž‹æˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªå«åšdeveloperçš„indexï¼Œå¹¶è¾“å…¥å¦‚ä¸‹çš„ä¸¤ä¸ªæ•°æ®ï¼š12345678910111213141516171819202122232425POST developer/_doc/101&#123; &quot;name&quot;: &quot;zhang san&quot;, &quot;skills&quot;: [ &#123; &quot;language&quot;: &quot;ruby&quot;, &quot;level&quot;: &quot;expert&quot; &#125;, &#123; &quot;language&quot;: &quot;javascript&quot;, &quot;level&quot;: &quot;beginner&quot; &#125; ]&#125; POST developer/_doc/102&#123; &quot;name&quot;: &quot;li si&quot;, &quot;skills&quot;: [ &#123; &quot;language&quot;: &quot;ruby&quot;, &quot;level&quot;: &quot;beginner&quot; &#125; ]&#125;ä¸Šé¢æ˜¾ç¤ºæ˜¯ä¸€å¯¹å¤šçš„ä¸€ä¸ªindexã€‚Object Queryè¿™ä¸ªæ—¶å€™æˆ‘ä»¬æƒ³æœä¸€ä¸ªskills: languageæ˜¯rubyï¼Œå¹¶ä¸”levelæ˜¯biginnerçš„æ–‡æ¡£ã€‚æˆ‘ä»¬å¯èƒ½æƒ³åˆ°çš„æ–¹æ³•æ˜¯ï¼š12345678910111213141516171819GET developer/_search&#123; &quot;query&quot;: &#123; &quot;bool&quot;: &#123; &quot;filter&quot;: [ &#123; &quot;match&quot;: &#123; &quot;skills.language&quot;: &quot;ruby&quot; &#125; &#125;, &#123; &quot;match&quot;: &#123; &quot;skills.level&quot;: &quot;beginner&quot; &#125; &#125; ] &#125; &#125;&#125;é€šè¿‡ä¸Šé¢çš„æœå¯»ï¼Œæˆ‘ä»¬å¾—åˆ°çš„ç»“æžœæ˜¯ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&#123; &quot;took&quot; : 0, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 2, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 0.0, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;developer&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;101&quot;, &quot;_score&quot; : 0.0, &quot;_source&quot; : &#123; &quot;name&quot; : &quot;zhang san&quot;, &quot;skills&quot; : [ &#123; &quot;language&quot; : &quot;ruby&quot;, &quot;level&quot; : &quot;expert&quot; &#125;, &#123; &quot;language&quot; : &quot;javascript&quot;, &quot;level&quot; : &quot;beginner&quot; &#125; ] &#125; &#125;, &#123; &quot;_index&quot; : &quot;developer&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;102&quot;, &quot;_score&quot; : 0.0, &quot;_source&quot; : &#123; &quot;name&quot; : &quot;li si&quot;, &quot;skills&quot; : [ &#123; &quot;language&quot; : &quot;ruby&quot;, &quot;level&quot; : &quot;beginner&quot; &#125; ] &#125; &#125; ] &#125;&#125;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸¤ä¸ªç»“æžœã€‚ä½†æ˜¯æˆ‘ä»¬ä»”ç»†æŸ¥çœ‹ä¸€ä¸‹å‘çŽ°å¾—åˆ°çš„ç»“æžœå¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³å¾—åˆ°çš„ã€‚ä»Žæˆ‘ä»¬çš„åŽŸæ„æ¥è¯´ï¼Œæˆ‘ä»¬æƒ³å¾—åˆ°çš„æ˜¯li siï¼Œå› ä¸ºåªæœ‰li siè¿™ä¸ªäººçš„languageæ˜¯rubyï¼Œå¹¶ä¸”ä»–çš„levelæ˜¯biginnerã€‚zhang sanè¿™ä¸ªæ–‡æ¡£ï¼Œåº”è¯¥ä¸åœ¨æœå¯»ä¹‹åˆ—ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼ŸåŽŸæ¥ï¼ŒlangaugeåŠlevelæ˜¯skillsçš„JSONå†…éƒ¨æ•°ç»„é¡¹ã€‚å½“JSONå¯¹è±¡è¢«Luceneæ‰å¹³åŒ–åŽï¼Œæˆ‘ä»¬å¤±åŽ»äº†languageå’Œlevelä¹‹é—´çš„å¯¹åº”å…³ç³»ã€‚å–è€Œä»£ä¹‹çš„æ˜¯å¦‚ä¸‹çš„è¿™ç§å…³ç³»ï¼š12345&#123; &quot;name&quot;: &quot;zhang san&quot;, &quot;skills.language&quot; :[&quot;ruby&quot;, &quot;javascript&quot;], &quot;skills.level&quot;: [&quot;expert&quot;, &quot;beginner&quot;]&#125;å¦‚ä¸Šæ‰€ç¤ºï¼Œæˆ‘ä»¬çœ‹åˆ°çš„æ˜¯ä¸€ä¸ªæ‰å¹³åŒ–çš„æ•°ç»„ã€‚ä¹‹å‰çš„é‚£ç§languageå’Œlevelä¹‹é—´çš„é‚£ç§å¯¹åº”å…³ç³»å·²ç»ä¸å­˜åœ¨äº†ã€‚Object aggregationåŒæ ·çš„é—®é¢˜ä¹Ÿå­˜åœ¨äºŽaggregationä¸­ï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³åšä¸€ä¸‹çš„aggregation:12345678910111213141516GET developer/_search&#123; &quot;size&quot;: 0, &quot;aggs&quot;: &#123; &quot;languages&quot;: &#123; &quot;terms&quot;: &#123; &quot;field&quot;: &quot;skills.language.keyword&quot; &#125;, &quot;aggs&quot;: &#123; &quot;level&quot;: &#123; &quot;terms&quot;: &#123;&quot;field&quot;: &quot;skills.level.keyword&quot;&#125; &#125; &#125; &#125; &#125;&#125;æ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162&#123; &quot;took&quot; : 2, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 2, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : null, &quot;hits&quot; : [ ] &#125;, &quot;aggregations&quot; : &#123; &quot;languages&quot; : &#123; &quot;doc_count_error_upper_bound&quot; : 0, &quot;sum_other_doc_count&quot; : 0, &quot;buckets&quot; : [ &#123; &quot;key&quot; : &quot;ruby&quot;, &quot;doc_count&quot; : 2, &quot;level&quot; : &#123; &quot;doc_count_error_upper_bound&quot; : 0, &quot;sum_other_doc_count&quot; : 0, &quot;buckets&quot; : [ &#123; &quot;key&quot; : &quot;beginner&quot;, &quot;doc_count&quot; : 2 &#125;, &#123; &quot;key&quot; : &quot;expert&quot;, &quot;doc_count&quot; : 1 &#125; ] &#125; &#125;, &#123; &quot;key&quot; : &quot;javascript&quot;, &quot;doc_count&quot; : 1, &quot;level&quot; : &#123; &quot;doc_count_error_upper_bound&quot; : 0, &quot;sum_other_doc_count&quot; : 0, &quot;buckets&quot; : [ &#123; &quot;key&quot; : &quot;beginner&quot;, &quot;doc_count&quot; : 1 &#125;, &#123; &quot;key&quot; : &quot;expert&quot;, &quot;doc_count&quot; : 1 &#125; ] &#125; &#125; ] &#125; &#125;&#125;æ˜¾ç„¶ï¼Œå¯¹äºŽkey javascriptæ¥è¯´ï¼Œå®ƒå¹¶æ²¡æœ‰expertå¯¹åº”çš„levelï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬çš„aggregationé‡Œæ˜¾ç¤ºå‡ºæ¥äº†ã€‚è¿™ä¸ªç»“æžœæ˜¾ç„¶æ˜¯é”™è¯¯çš„ã€‚nested æ•°æ®ç±»åž‹nestedæ•°æ®ç±»åž‹èƒ½å¤Ÿè®©æˆ‘ä»¬å¯¹objectæ•°ç»„å»ºç«‹ç´¢å¼•ï¼Œå¹¶ä¸”åˆ†åˆ«è¿›è¡ŒæŸ¥è¯¢ã€‚å¦‚æžœéœ€è¦ç»´æŠ¤æ•°ç»„ä¸­æ¯ä¸ªå¯¹è±¡çš„å…³ç³»ï¼Œè¯·ä½¿ç”¨nestedæ•°æ®ç±»åž‹ä¸ºäº†èƒ½å¤ŸæŠŠæˆ‘ä»¬çš„æ•°æ®å®šä¹‰ä¸ºnestedï¼Œæˆ‘ä»¬å¿…é¡»ä¿®æ”¹ä¹‹å‰çš„ç´¢å¼•mappingä¸ºï¼š1234567891011121314151617181920212223DELETE developer PUT developer&#123; &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;name&quot;: &#123; &quot;type&quot;: &quot;text&quot; &#125;, &quot;skills&quot;: &#123; &quot;type&quot;: &quot;nested&quot;, &quot;properties&quot;: &#123; &quot;language&quot;: &#123; &quot;type&quot;: &quot;keyword&quot; &#125;, &quot;level&quot;: &#123; &quot;type&quot;: &quot;keyword&quot; &#125; &#125; &#125; &#125; &#125;&#125;ç»è¿‡è¿™æ ·çš„æ”¹é€ ä¹‹åŽï¼Œé‡æ–°æŠŠæˆ‘ä»¬ä¹‹å‰çš„æ•°æ®è¾“å…¥åˆ°indexé‡Œï¼š12345678910111213141516171819202122232425POST developer/_doc/101&#123; &quot;name&quot;: &quot;zhang san&quot;, &quot;skills&quot;: [ &#123; &quot;language&quot;: &quot;ruby&quot;, &quot;level&quot;: &quot;expert&quot; &#125;, &#123; &quot;language&quot;: &quot;javascript&quot;, &quot;level&quot;: &quot;beginner&quot; &#125; ]&#125; POST developer/_doc/102&#123; &quot;name&quot;: &quot;li si&quot;, &quot;skills&quot;: [ &#123; &quot;language&quot;: &quot;ruby&quot;, &quot;level&quot;: &quot;beginner&quot; &#125; ]&#125;é’ˆå¯¹101ï¼Œåœ¨Lucenceä¸­çš„æ•°æ®ç»“æž„å˜ä¸ºï¼š1234567891011&#123; &quot;name&quot;: &quot;zhang san&quot;, &#123; &quot;skills.language&quot;: &quot;ruby&quot;, &quot;skills.level&quot;: &quot;expert&quot; &#125;, &#123; &quot;skills.language&quot;: &quot;javascript&quot;, &quot;skills.level&quot;, &quot;beginner&quot; &#125;&#125;nested queryæˆ‘ä»¬æ¥é‡æ–°åšæˆ‘ä»¬ä¹‹å‰çš„æœç´¢ï¼š123456789101112131415161718192021222324GET developer/_search&#123; &quot;query&quot;: &#123; &quot;nested&quot;: &#123; &quot;path&quot;: &quot;skills&quot;, &quot;query&quot;: &#123; &quot;bool&quot;: &#123; &quot;filter&quot;: [ &#123; &quot;match&quot;: &#123; &quot;skills.language&quot;: &quot;ruby&quot; &#125; &#125;, &#123; &quot;match&quot;: &#123; &quot;skills.level&quot;: &quot;beginner&quot; &#125; &#125; ] &#125; &#125; &#125; &#125;&#125;æ³¨æ„ä¸Šé¢çš„â€œnestedâ€å­—æ®µã€‚æ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š12345678910111213141516171819202122232425262728293031323334&#123; &quot;took&quot; : 5, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 1, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 0.0, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;developer&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;102&quot;, &quot;_score&quot; : 0.0, &quot;_source&quot; : &#123; &quot;name&quot; : &quot;li si&quot;, &quot;skills&quot; : [ &#123; &quot;language&quot; : &quot;ruby&quot;, &quot;level&quot; : &quot;beginner&quot; &#125; ] &#125; &#125; ] &#125;&#125;æ˜¾ç„¶ï¼Œæˆ‘ä»¬åªå¾—åˆ°äº†ä¸€ä¸ªæˆ‘ä»¬æƒ³è¦çš„ç»“æžœã€‚nested aggregationåŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æˆ‘ä»¬çš„indexæ¥åšä¸€ä¸ªaggregation:12345678910111213141516171819202122232425GET developer/_search&#123; &quot;size&quot;: 0, &quot;aggs&quot;: &#123; &quot;nested_skills&quot;: &#123; &quot;nested&quot;: &#123; &quot;path&quot;: &quot;skills&quot; &#125;, &quot;aggs&quot;: &#123; &quot;languages&quot;: &#123; &quot;terms&quot;: &#123; &quot;field&quot;: &quot;skills.language&quot; &#125;, &quot;aggs&quot;: &#123; &quot;levels&quot;: &#123; &quot;terms&quot;: &#123; &quot;field&quot;: &quot;skills.level&quot; &#125; &#125; &#125; &#125; &#125; &#125; &#125;&#125;æ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061&#123; &quot;took&quot; : 1, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 2, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : null, &quot;hits&quot; : [ ] &#125;, &quot;aggregations&quot; : &#123; &quot;nested_skills&quot; : &#123; &quot;doc_count&quot; : 3, &quot;languages&quot; : &#123; &quot;doc_count_error_upper_bound&quot; : 0, &quot;sum_other_doc_count&quot; : 0, &quot;buckets&quot; : [ &#123; &quot;key&quot; : &quot;ruby&quot;, &quot;doc_count&quot; : 2, &quot;levels&quot; : &#123; &quot;doc_count_error_upper_bound&quot; : 0, &quot;sum_other_doc_count&quot; : 0, &quot;buckets&quot; : [ &#123; &quot;key&quot; : &quot;beginner&quot;, &quot;doc_count&quot; : 1 &#125;, &#123; &quot;key&quot; : &quot;expert&quot;, &quot;doc_count&quot; : 1 &#125; ] &#125; &#125;, &#123; &quot;key&quot; : &quot;javascript&quot;, &quot;doc_count&quot; : 1, &quot;levels&quot; : &#123; &quot;doc_count_error_upper_bound&quot; : 0, &quot;sum_other_doc_count&quot; : 0, &quot;buckets&quot; : [ &#123; &quot;key&quot; : &quot;beginner&quot;, &quot;doc_count&quot; : 1 &#125; ] &#125; &#125; ] &#125; &#125; &#125;&#125;ä»Žä¸Šé¢æ˜¾ç¤ºçš„ç»“æžœï¼Œå¯ä»¥çœ‹å‡ºæ¥å¯¹äºŽrubyæ¥è¯´ï¼Œå®ƒåˆ†åˆ«å¯¹åº”äºŽä¸€ä¸ªbiggineråŠä¸€ä¸ªexpertã€‚è¿™ä¸ªå’Œæˆ‘ä»¬ä¹‹å‰çš„æ•°æ®æ˜¯ä¸€æ ·çš„ã€‚å¯¹äºŽjavascriptæ¥è¯´ï¼Œå®ƒåªæœ‰ä¸€ä¸ªbeginnerçš„levelã€‚]]></content>
  </entry>
  <entry>
    <title></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%20Index%20template%2F</url>
    <content type="text"><![CDATA[Index templateå®šä¹‰åœ¨åˆ›å»ºæ–°indexæ—¶å¯ä»¥è‡ªåŠ¨åº”ç”¨çš„settingså’Œmappingsã€‚ Elasticsearchæ ¹æ®ä¸Žindexåç§°åŒ¹é…çš„indexæ¨¡å¼å°†æ¨¡æ¿åº”ç”¨äºŽæ–°ç´¢å¼•ã€‚è¿™ä¸ªå¯¹äºŽæˆ‘ä»¬æƒ³åˆ›å»ºçš„ä¸€ç³»åˆ—çš„Indexå…·æœ‰åŒæ ·çš„settingsåŠmappingsã€‚æ¯”å¦‚æˆ‘ä»¬å¸Œæœ›æ¯ä¸€å¤©/æœˆçš„æ—¥å¿—çš„indexéƒ½å…·æœ‰åŒæ ·çš„è®¾ç½®ã€‚Index templateä»…åœ¨indexåˆ›å»ºæœŸé—´åº”ç”¨ã€‚ å¯¹index templateçš„æ›´æ”¹ä¸ä¼šå½±å“çŽ°æœ‰ç´¢å¼•ã€‚ create index APIè¯·æ±‚ä¸­æŒ‡å®šçš„è®¾ç½®å’Œæ˜ å°„ä¼šè¦†ç›–ç´¢å¼•æ¨¡æ¿ä¸­æŒ‡å®šçš„ä»»ä½•è®¾ç½®æˆ–æ˜ å°„ã€‚ä½ å¯ä»¥åœ¨ä»£ç ä¸­åŠ å…¥åƒCè¯­è¨€é‚£æ ·çš„blockæ³¨é‡Šã€‚ä½ å¯ä»¥æŠŠè¿™ä¸ªæ³¨é‡Šæ”¾åœ¨å‡ºæ¥å¼€å¤´ â€œ{â€å’Œç»“å°¾çš„â€œ}â€ä¹‹é—´çš„ä»»ä½•åœ°æ–¹ã€‚å®šä¹‰ä¸€ä¸ªIndex templateæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æŽ¥å£æ¥å®šä¹‰ä¸€ä¸ªindex templateï¼š1PUT /_template/&lt;index-template&gt;æˆ‘ä»¬å¯ä»¥ä½¿ç”¨_templateè¿™ä¸ªç»ˆç‚¹æ¥åˆ›å»ºï¼Œåˆ é™¤ï¼ŒæŸ¥çœ‹ä¸€ä¸ªindex templateã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥ä¸¾ä¸€ä¸ªä¾‹å­ï¼š12345678910111213141516PUT _template/logs_template&#123; &quot;index_patterns&quot;: &quot;logs-*&quot;, &quot;order&quot;: 1, &quot;settings&quot;: &#123; &quot;number_of_shards&quot;: 4, &quot;number_of_replicas&quot;: 1 &#125;, &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;@timestamp&quot;: &#123; &quot;type&quot;: &quot;date&quot; &#125; &#125; &#125;&#125;åœ¨ä¸Šé¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå«åšlogs_templateçš„index templateã€‚å®ƒçš„index_patternså®šä¹‰ä¸ºâ€œlogs-*â€ï¼Œè¯´æ˜Žï¼Œä»»ä½•ä»¥â€œlogs-â€ä¸ºå¼€å¤´çš„ä»»ä½•ä¸€ä¸ªindexå°†å…·æœ‰åœ¨è¯¥templateé‡Œå…·æœ‰çš„settingsåŠmappingså±žæ€§ã€‚è¿™é‡Œçš„â€œorderâ€çš„æ„æ€æ˜¯ï¼šå¦‚æžœç´¢å¼•ä¸Žå¤šä¸ªæ¨¡æ¿åŒ¹é…ï¼Œåˆ™Elasticsearchåº”ç”¨æ­¤æ¨¡æ¿çš„é¡ºåºã€‚è¯¥å€¼ä¸º1ï¼Œè¡¨æ˜Žæœ‰æœ€å…ˆåˆå¹¶ï¼Œå¦‚æžœæœ‰æ›´é«˜orderçš„templateï¼Œè¿™ä¸ªsettingsæˆ–mappingsæœ‰å¯èƒ½è¢«å…¶å®ƒçš„templateæ‰€è¦†ç›–ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹æˆ‘ä»¬åˆšå®šä¹‰çš„index templateï¼š1PUT logs-2019-03-01åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå«åšlogs-2019-03-01çš„indexã€‚æˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹çš„å‘½ä»¤æ¥æ£€æŸ¥è¢«åˆ›å»ºçš„æƒ…å†µï¼š1GET logs-2019-03-01æ˜¾ç¤ºçš„ç»“æžœä¸ºï¼š123456789101112131415161718192021222324&#123; &quot;logs-2019-03-01&quot; : &#123; &quot;aliases&quot; : &#123; &#125;, &quot;mappings&quot; : &#123; &quot;properties&quot; : &#123; &quot;@timestamp&quot; : &#123; &quot;type&quot; : &quot;date&quot; &#125; &#125; &#125;, &quot;settings&quot; : &#123; &quot;index&quot; : &#123; &quot;creation_date&quot; : &quot;1567652671032&quot;, &quot;number_of_shards&quot; : &quot;4&quot;, &quot;number_of_replicas&quot; : &quot;1&quot;, &quot;uuid&quot; : &quot;Dz5rqRS4SEyLM_gf5eEolQ&quot;, &quot;version&quot; : &#123; &quot;created&quot; : &quot;7030099&quot; &#125;, &quot;provided_name&quot; : &quot;logs-2019-03-01&quot; &#125; &#125; &#125;&#125;è¯å¦‚ä¸Šæ‰€ç¤ºï¼Œæˆ‘ä»¬å·²ç»æˆåŠŸåˆ›å»ºäº†ä¸€ä¸ªæˆ‘ä»¬æƒ³è¦çš„indexï¼Œå¹¶ä¸”å®ƒå…·æœ‰æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„settingsåŠmappingsã€‚Index templateå’Œaliasæˆ‘ä»¬ç”šè‡³å¯ä»¥ä¸ºæˆ‘ä»¬çš„index templateæ·»åŠ index aliasï¼š12345678910111213141516171819PUT _template/logs_template&#123; &quot;index_patterns&quot;: &quot;logs-*&quot;, &quot;order&quot;: 1, &quot;settings&quot;: &#123; &quot;number_of_shards&quot;: 4, &quot;number_of_replicas&quot;: 1 &#125;, &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;@timestamp&quot;: &#123; &quot;type&quot;: &quot;date&quot; &#125; &#125; &#125;, &quot;aliases&quot;: &#123; &quot;&#123;index&#125;-alias&quot; : &#123;&#125; &#125;&#125;åœ¨ä¸Šé¢ï¼Œæˆ‘ä»¬å·²ç»åˆ›ç«‹äº†ä¸€ä¸ªå«åš{index}-aliasçš„åˆ«åã€‚è¿™é‡Œçš„{index}å°±æ˜¯å®žé™…ç”Ÿæˆindexçš„æ–‡ä»¶åæ¥ä»£æ›¿ã€‚æˆ‘ä»¬ä¸‹é¢ç”¨ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜Žï¼š1PUT logs-2019-04-01æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå«åšlogs-2019-04-01çš„index, é‚£ä¹ˆå®ƒåŒæ—¶ç”Ÿæˆäº†ä¸€ä¸ªå«åšlogs-2019-04-01-aliasçš„åˆ«åã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥æ£€æŸ¥ï¼š1GET logs-2019-04-01-aliasæ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š1234567891011121314151617181920212223242526&#123; &quot;logs-2019-04-01&quot; : &#123; &quot;aliases&quot; : &#123; &quot;logs-2019-04-01-alias&quot; : &#123; &#125; &#125;, &quot;mappings&quot; : &#123; &quot;properties&quot; : &#123; &quot;@timestamp&quot; : &#123; &quot;type&quot; : &quot;date&quot; &#125; &#125; &#125;, &quot;settings&quot; : &#123; &quot;index&quot; : &#123; &quot;creation_date&quot; : &quot;1567653644605&quot;, &quot;number_of_shards&quot; : &quot;4&quot;, &quot;number_of_replicas&quot; : &quot;1&quot;, &quot;uuid&quot; : &quot;iLf-j_G2T4CYcHCqwz32Ng&quot;, &quot;version&quot; : &#123; &quot;created&quot; : &quot;7030099&quot; &#125;, &quot;provided_name&quot; : &quot;logs-2019-04-01&quot; &#125; &#125; &#125;&#125;IndexåŒ¹é…å¤šä¸ªtemplateå¤šä¸ªç´¢å¼•æ¨¡æ¿å¯èƒ½ä¸Žç´¢å¼•åŒ¹é…ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè®¾ç½®å’Œæ˜ å°„éƒ½åˆå¹¶åˆ°ç´¢å¼•çš„æœ€ç»ˆé…ç½®ä¸­ã€‚ å¯ä»¥ä½¿ç”¨orderå‚æ•°æŽ§åˆ¶åˆå¹¶çš„é¡ºåºï¼Œé¦–å…ˆåº”ç”¨è¾ƒä½Žçš„é¡ºåºï¼Œå¹¶ä¸”è¦†ç›–å®ƒä»¬çš„è¾ƒé«˜é¡ºåºã€‚ ä¾‹å¦‚ï¼š1234567891011121314151617181920212223PUT /_template/template_1&#123; &quot;index_patterns&quot; : [&quot;*&quot;], &quot;order&quot; : 0, &quot;settings&quot; : &#123; &quot;number_of_shards&quot; : 1 &#125;, &quot;mappings&quot; : &#123; &quot;_source&quot; : &#123; &quot;enabled&quot; : false &#125; &#125;&#125; PUT /_template/template_2&#123; &quot;index_patterns&quot; : [&quot;te*&quot;], &quot;order&quot; : 1, &quot;settings&quot; : &#123; &quot;number_of_shards&quot; : 1 &#125;, &quot;mappings&quot; : &#123; &quot;_source&quot; : &#123; &quot;enabled&quot; : true &#125; &#125;&#125;ä»¥ä¸Šçš„template_1å°†ç¦ç”¨å­˜å‚¨_sourceï¼Œä½†å¯¹äºŽä»¥te *å¼€å¤´çš„ç´¢å¼•ï¼Œä»å°†å¯ç”¨_sourceã€‚ æ³¨æ„ï¼Œå¯¹äºŽæ˜ å°„ï¼Œåˆå¹¶æ˜¯â€œæ·±åº¦â€çš„ï¼Œè¿™æ„å‘³ç€å¯ä»¥åœ¨é«˜é˜¶æ¨¡æ¿ä¸Šè½»æ¾æ·»åŠ /è¦†ç›–ç‰¹å®šçš„åŸºäºŽå¯¹è±¡/å±žæ€§çš„æ˜ å°„ï¼Œè€Œè¾ƒä½Žé˜¶æ¨¡æ¿æä¾›åŸºç¡€ã€‚æˆ‘ä»¬å¯ä»¥æ¥åˆ›å»ºä¸€ä¸ªä¾‹å­çœ‹çœ‹ï¼š123PUT test10 GET test10æ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š123456789101112131415161718&#123; &quot;test10&quot; : &#123; &quot;aliases&quot; : &#123; &#125;, &quot;mappings&quot; : &#123; &#125;, &quot;settings&quot; : &#123; &quot;index&quot; : &#123; &quot;creation_date&quot; : &quot;1567654333181&quot;, &quot;number_of_shards&quot; : &quot;1&quot;, &quot;number_of_replicas&quot; : &quot;1&quot;, &quot;uuid&quot; : &quot;iEwaQFl9RAKyTt79PduN-Q&quot;, &quot;version&quot; : &#123; &quot;created&quot; : &quot;7030099&quot; &#125;, &quot;provided_name&quot; : &quot;test10&quot; &#125; &#125; &#125;&#125;å¦‚æžœæˆ‘ä»¬åˆ›å»ºå¦å¤–ä¸€ä¸ªä¸æ˜¯ä»¥ â€œteâ€å¼€å¤´çš„indexï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹å¦‚ä¸‹çš„æƒ…å†µï¼š12PUT my_test_indexGET my_test_indexæ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š12345678910111213141516171819202122&#123; &quot;my_test_index&quot; : &#123; &quot;aliases&quot; : &#123; &#125;, &quot;mappings&quot; : &#123; &quot;_source&quot; : &#123; &quot;enabled&quot; : false &#125; &#125;, &quot;settings&quot; : &#123; &quot;index&quot; : &#123; &quot;creation_date&quot; : &quot;1567654713059&quot;, &quot;number_of_shards&quot; : &quot;1&quot;, &quot;number_of_replicas&quot; : &quot;1&quot;, &quot;uuid&quot; : &quot;aSsIZMT2RyWKT44G2dF2zg&quot;, &quot;version&quot; : &#123; &quot;created&quot; : &quot;7030099&quot; &#125;, &quot;provided_name&quot; : &quot;my_test_index&quot; &#125; &#125; &#125;&#125;æ˜¾ç„¶åœ¨mappingsé‡Œæ˜¾ç¤ºsourceæ˜¯è¢«ç¦æ­¢çš„ã€‚å¦‚æžœå¯¹äºŽä¸¤ä¸ªtemplatesæ¥è¯´ï¼Œå¦‚æžœorderæ˜¯ä¸€æ ·çš„è¯ï¼Œæˆ‘ä»¬å¯èƒ½é™·äºŽä¸€ç§ä¸å¯çŸ¥è®ºçš„åˆå¹¶çŠ¶æ€ã€‚åœ¨å®žé™…çš„ä½¿ç”¨ä¸­å¿…é¡»é¿å…ã€‚æŸ¥è¯¢Index templateæŽ¥å£æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æŽ¥å£æ¥æŸ¥è¯¢å·²ç»è¢«åˆ›å»ºå¥½çš„index template:1GET /_template/&lt;index-template&gt;æ¯”å¦‚ï¼š1GET _template/logs_templateæ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š123456789101112131415161718192021222324&#123; &quot;logs_template&quot; : &#123; &quot;order&quot; : 1, &quot;index_patterns&quot; : [ &quot;logs-*&quot; ], &quot;settings&quot; : &#123; &quot;index&quot; : &#123; &quot;number_of_shards&quot; : &quot;4&quot;, &quot;number_of_replicas&quot; : &quot;1&quot; &#125; &#125;, &quot;mappings&quot; : &#123; &quot;properties&quot; : &#123; &quot;@timestamp&quot; : &#123; &quot;type&quot; : &quot;date&quot; &#125; &#125; &#125;, &quot;aliases&quot; : &#123; &quot;&#123;index&#125;-alias&quot; : &#123; &#125; &#125; &#125;&#125;æ˜¾ç¤ºçš„å†…å®¹å°±æ˜¯æˆ‘ä»¬ä¹‹å‰å·²ç»åˆ›å»ºçš„é‚£ä¸ªindex templateã€‚ä½ ä¹Ÿå¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹å¼æ¥åŒæ—¶æŸ¥è¯¢å¤šä¸ªtemplateçš„æƒ…å†µï¼š123GET /_template/template_1,template_2GET /_template/temp*GET /_templateåˆ é™¤ä¸€ä¸ªindex templateåœ¨ä¹‹å‰çš„ç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬åŒ¹é…â€œ*â€ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä»¥åŽæ‰€æœ‰çš„åˆ›å»ºçš„æ–°çš„indexå°†ä¸å­˜å‚¨sourceï¼Œè¿™ä¸ªæ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ã€‚æˆ‘ä»¬éœ€è¦æ¥æŠŠè¿™ä¸ªtemplateè¿›è¡Œåˆ é™¤ã€‚åˆ é™¤ä¸€ä¸ªtemplateçš„æŽ¥å£å¦‚ä¸‹ï¼š1DELETE /_template/&lt;index-template&gt;é‚£ä¹ˆé’ˆå¯¹æˆ‘ä»¬çš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„å‘½ä»¤æ¥åˆ é™¤æˆ‘ä»¬ä¸éœ€è¦çš„template:12DELETE _template/template_1DELETE _template/template_2è¿™æ ·æˆ‘ä»¬åˆ é™¤äº†æˆ‘ä»¬åˆšæ‰åˆ›å»ºçš„ä¸¤ä¸ªtemplatesã€‚å‚è€ƒï¼šã€1ã€‘https://www.elastic.co/guide/en/elasticsearch/reference/7.4/indices-get-template.htmlã€2ã€‘https://www.elastic.co/guide/en/elasticsearch/reference/7.4/indices-delete-template.htmlã€3ã€‘https://www.elastic.co/guide/en/elasticsearch/reference/7.4/indices-templates.html]]></content>
  </entry>
  <entry>
    <title></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%20analyzer%2F</url>
    <content type="text"><![CDATA[åœ¨ä»Šå¤©çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æ¥è¿›ä¸€æ­¥äº†è§£analyzerã€‚ analyzeræ‰§è¡Œå°†è¾“å…¥å­—ç¬¦æµåˆ†è§£ä¸ºtokençš„è¿‡ç¨‹ï¼Œå®ƒä¸€èˆ¬å‘ç”Ÿåœ¨ä¸¤ä¸ªåœºåˆï¼šåœ¨indexingçš„æ—¶å€™ï¼Œä¹Ÿå³åœ¨å»ºç«‹ç´¢å¼•çš„æ—¶å€™åœ¨searchingçš„æ—¶å€™ï¼Œä¹Ÿå³åœ¨æœç´¢æ—¶ï¼Œåˆ†æžéœ€è¦æœç´¢çš„è¯è¯­ä»€ä¹ˆæ˜¯analysis?åˆ†æžæ˜¯Elasticsearchåœ¨æ–‡æ¡£å‘é€ä¹‹å‰å¯¹æ–‡æ¡£æ­£æ–‡æ‰§è¡Œçš„è¿‡ç¨‹ï¼Œä»¥æ·»åŠ åˆ°åå‘ç´¢å¼•ä¸­ï¼ˆinverted indexï¼‰ã€‚ åœ¨å°†æ–‡æ¡£æ·»åŠ åˆ°ç´¢å¼•ä¹‹å‰ï¼ŒElasticsearchä¼šä¸ºæ¯ä¸ªåˆ†æžçš„å­—æ®µæ‰§è¡Œè®¸å¤šæ­¥éª¤ï¼šCharacter filtering (å­—ç¬¦è¿‡æ»¤å™¨): ä½¿ç”¨å­—ç¬¦è¿‡æ»¤å™¨è½¬æ¢å­—ç¬¦Breaking text into tokens (æŠŠæ–‡å­—è½¬åŒ–ä¸ºæ ‡è®°): å°†æ–‡æœ¬åˆ†æˆä¸€ç»„ä¸€ä¸ªæˆ–å¤šä¸ªæ ‡è®°Token filteringï¼šä½¿ç”¨æ ‡è®°è¿‡æ»¤å™¨è½¬æ¢æ¯ä¸ªæ ‡è®°Token indexingï¼šæŠŠè¿™äº›æ ‡è®°å­˜äºŽindexä¸­æŽ¥ä¸‹æ¥æˆ‘ä»¬å°†æ›´è¯¦ç»†åœ°è®¨è®ºæ¯ä¸ªæ­¥éª¤ï¼Œä½†é¦–å…ˆè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å›¾è¡¨ä¸­æ€»ç»“çš„æ•´ä¸ªè¿‡ç¨‹ã€‚ å›¾5.1æ˜¾ç¤ºäº†â€œshare your experience with NoSql &amp; big data technologiesâ€ä¸ºåˆ†æžçš„æ ‡è®°ï¼šshare, your, experience, with, nosql, big, dataï¼Œtools,åŠ technologiesã€‚ä¸Šé¢æ‰€å±•ç¤ºçš„æ˜¯ä¸€ä¸ªç”±characterè¿‡æ»¤å™¨ï¼Œæ ‡å‡†çš„tokenizeråŠToken filterç»„æˆçš„å®šåˆ¶analyzerã€‚ä¸Šé¢çš„è¿™ä¸ªå›¾éžå¸¸å¥½ï¼Œå®ƒå¾ˆç®€æ´åœ°æè¿°ä¸€ä¸ªanalyzerçš„åŸºæœ¬ç»„æˆéƒ¨åˆ†ï¼Œä»¥åŠæ¯ä¸ªéƒ¨åˆ†æ‰€éœ€è¦è¡¨è¿°çš„ä¸œè¥¿ã€‚æ¯å½“ä¸€ä¸ªæ–‡æ¡£è¢«ingestèŠ‚ç‚¹çº³å…¥ï¼Œå®ƒéœ€è¦ç»åŽ†å¦‚ä¸‹çš„æ­¥éª¤ï¼Œæ‰èƒ½æœ€ç»ˆæŠŠæ–‡æ¡£å†™å…¥åˆ°Elasticsearchçš„æ•°æ®åº“ä¸­ï¼šä¸Šé¢ä¸­é—´çš„é‚£éƒ¨åˆ†å°±å«åšanalyzerï¼Œå³åˆ†æžå™¨ã€‚å®ƒæœ‰ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼šChar Filters, TokenizeråŠ Token Filterã€‚å®ƒä»¬çš„ä½œç”¨åˆ†åˆ«å¦‚ä¸‹ï¼šChar Filter: å­—ç¬¦è¿‡æ»¤å™¨çš„å·¥ä½œæ˜¯æ‰§è¡Œæ¸…é™¤ä»»åŠ¡ï¼Œä¾‹å¦‚å‰¥ç¦»HTMLæ ‡è®°ï¼Œè¿˜æœ‰ä¸Šé¢çš„æŠŠâ€œ&amp;â€è½¬æ¢ä¸ºâ€œandâ€å­—ç¬¦ä¸²Tokenizer: ä¸‹ä¸€æ­¥æ˜¯å°†æ–‡æœ¬æ‹†åˆ†ä¸ºç§°ä¸ºæ ‡è®°çš„æœ¯è¯­ã€‚ è¿™æ˜¯ç”±tokenizerå®Œæˆçš„ã€‚ å¯ä»¥åŸºäºŽä»»ä½•è§„åˆ™ï¼ˆä¾‹å¦‚ç©ºæ ¼ï¼‰æ¥å®Œæˆæ‹†åˆ†ã€‚ æœ‰å…³tokennizerçš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—®ä»¥ä¸‹URLï¼šhttps://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-tokenizers.htmlã€‚Token filter: ä¸€æ—¦åˆ›å»ºäº†tokenï¼Œå®ƒä»¬å°±ä¼šè¢«ä¼ é€’ç»™token filterï¼Œè¿™äº›è¿‡æ»¤å™¨ä¼šå¯¹tokenè¿›è¡Œè§„èŒƒåŒ–ã€‚ Token filterå¯ä»¥æ›´æ”¹tokenï¼Œåˆ é™¤æœ¯è¯­æˆ–å‘tokenæ·»åŠ æœ¯è¯­ã€‚Elasticsearchå·²ç»æä¾›äº†æ¯”è¾ƒä¸°å¯Œçš„å¼€ç®±å³ç”¨analyzerã€‚æˆ‘ä»¬å¯ä»¥è‡ªå·±åˆ›å»ºè‡ªå·±çš„token analyzerï¼Œç”šè‡³å¯ä»¥åˆ©ç”¨å·²ç»æœ‰çš„char filterï¼ŒtokenizeråŠtoken filteræ¥é‡æ–°ç»„åˆæˆä¸€ä¸ªæ–°çš„analyzerï¼Œå¹¶å¯ä»¥å¯¹æ–‡æ¡£ä¸­çš„æ¯ä¸€ä¸ªå­—æ®µåˆ†åˆ«å®šä¹‰è‡ªå·±çš„analyzerã€‚å¦‚æžœå¤§å®¶å¯¹analyzeræ¯”è¾ƒæ„Ÿå…´è¶£çš„è¯ï¼Œè¯·å‚é˜…æˆ‘ä»¬çš„ç½‘å€https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-analyzers.htmlã€‚åœ¨é»˜è®¤çš„æƒ…å†µä¸‹ï¼Œstandard analyzeræ˜¯Elasticsearchçš„ç¼ºçœåˆ†æžå™¨(https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-standard-analyzer.html)ï¼šæ²¡æœ‰ Char Filterä½¿ç”¨standard tokonizeræŠŠå­—ç¬¦ä¸²å˜ä¸ºå°å†™ï¼ŒåŒæ—¶æœ‰é€‰æ‹©åœ°åˆ é™¤ä¸€äº›stop wordsç­‰ã€‚é»˜è®¤çš„æƒ…å†µä¸‹stop wordsä¸ºnoneï¼Œä¹Ÿå³ä¸è¿‡æ»¤ä»»ä½•stop wordsã€‚æ€»ä½“è¯´æ¥ä¸€ä¸ªanalyzerå¯ä»¥åˆ†ä¸ºå¦‚ä¸‹çš„å‡ ä¸ªéƒ¨åˆ†ï¼š0ä¸ªæˆ–1ä¸ªä»¥ä¸Šçš„character filter1ä¸ªtokenizer0ä¸ªæˆ–1ä¸ªä»¥ä¸Šçš„token filterAnalyze API1234GET /_analyzePOST /_analyzeGET /&lt;index&gt;/_analyzePOST /&lt;index&gt;/_analyzeä½¿ç”¨_analyze APIæ¥æµ‹è¯•analyzerå¦‚ä½•è§£æžæˆ‘ä»¬çš„å­—ç¬¦ä¸²çš„ï¼Œæ¯”å¦‚ï¼š12345GET /_analyze&#123; &quot;analyzer&quot;: &quot;standard&quot;, &quot;text&quot;: &quot;Quick Brown Foxes!&quot;&#125;è¿”å›žç»“æžœï¼š123456789101112131415161718192021222324 &quot;tokens&quot; : [ &#123; &quot;token&quot; : &quot;quick&quot;, &quot;start_offset&quot; : 0, &quot;end_offset&quot; : 5, &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;, &quot;position&quot; : 0 &#125;, &#123; &quot;token&quot; : &quot;brown&quot;, &quot;start_offset&quot; : 6, &quot;end_offset&quot; : 11, &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;, &quot;position&quot; : 1 &#125;, &#123; &quot;token&quot; : &quot;foxes&quot;, &quot;start_offset&quot; : 12, &quot;end_offset&quot; : 17, &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;, &quot;position&quot; : 2 &#125; ]&#125;åœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†standardåˆ†æžå™¨ï¼Œå®ƒæŠŠæˆ‘ä»¬çš„å­—ç¬¦ä¸²åˆ†è§£ä¸ºä¸‰ä¸ªtokenï¼Œå¹¶æ˜¾ç¤ºå®ƒä»¬åˆ†åˆ«çš„ä½ç½®ä¿¡æ¯ã€‚Multi-fieldå­—ç¬¦å­—æ®µæˆ‘ä»¬å¯ä»¥é’ˆå¯¹è¿™ä¸ªä½¿ç”¨å¤šä¸ªä¸åŒçš„anaylzeræ¥æé«˜æˆ‘ä»¬çš„æœç´¢ï¼šä½¿ç”¨ä¸åŒçš„åˆ†æžå™¨æ¥åˆ†æžåŒæ ·çš„ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨ä¸åŒçš„æ–¹å¼ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨çŽ°æœ‰çš„åˆ†æžå™¨ä¿©è®¾ç½®ä¸€ä¸ªå®šåˆ¶çš„åˆ†æžå™¨ã€‚æ¯”å¦‚æˆ‘ä»¬å®šä¹‰å¦‚ä¸‹çš„ä¸€ä¸ªmapping:1234567891011121314151617PUT multifield&#123; &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;content&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;analyzer&quot;: &quot;standard&quot;, &quot;fields&quot;: &#123; &quot;english&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;analyzer&quot;: &quot;english&quot; &#125; &#125; &#125; &#125; &#125;&#125;åœ¨è¿™é‡Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå«åšmultifieldçš„indexï¼Œæˆ‘ä»¬å¯ä»¥å¯¹è¿™ä¸ªindexè¿›è¡Œåˆ†æžã€‚æˆ‘ä»¬å¯¹æ•´ä¸ªfieldå®šä¹‰äº†ä¸€ä¸ªstandardåˆ†æžå™¨ï¼ŒåŒæ—¶ä¸ºå«åšenglishçš„å­—æ®µå®šä¹‰äº†ä¸€ä¸ªenglishçš„åˆ†æžå™¨ï¼Œè¿™æ ·æœ‰åˆ©äºŽæˆ‘ä»¬åˆ é™¤ä¸€äº›stop wordsåŠè¿ç”¨ä¸€äº›åŒæ ¹è¯ã€‚æˆ‘ä»¬é¦–å…ˆæ¥ä¸ºmultifieldæ¥å»ºç«‹ä¸€ä¸ªæ–‡æ¡£ï¼š1234PUT multifield/_doc/1&#123; &quot;content&quot;: &quot;We are excited to introduce the world to X-Pack&quot;&#125;é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹æ³•æ¥è¿›è¡Œæœç´¢ï¼š12345678GET /multifield/_search&#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;content&quot;: &quot;the&quot; &#125; &#125;&#125;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœç´¢çš„ç»“æžœï¼š12345678910111213141516171819202122232425262728&#123; &quot;took&quot; : 0, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 1, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 0.2876821, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;multifield&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 0.2876821, &quot;_source&quot; : &#123; &quot;content&quot; : &quot;We are excited to introduce the world to X-Pack&quot; &#125; &#125; ] &#125;&#125;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœå¯»çš„ç»“æžœï¼Œä½†æ˜¯å¦‚æžœæˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹çš„æ–¹æ³•ï¼š12345678GET /multifield/_search&#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;content.english&quot;: &quot;the&quot; &#125; &#125;&#125;æˆ‘ä»¬å•¥ä¹Ÿçœ‹ä¸åˆ°ï¼Œè¿™æ˜¯å› ä¸ºâ€œtheâ€åœ¨english analyzeré‡Œâ€œtheâ€è¢«è®¤ä¸ºæ˜¯stop wordï¼Œè€Œè¢«å¿½ç•¥ã€‚å¦‚ä½•å®šä¹‰ä¸€ä¸ªå®šåˆ¶çš„åˆ†æžå™¨åœ¨è¿™é‡Œæˆ‘ä»¬ä¸»è¦è¿ç”¨çŽ°æœ‰çš„pluginæ¥å®Œæˆå®šåˆ¶çš„åˆ†æžå™¨ã€‚å¯¹äºŽéœ€è¦å¼€å‘è‡ªå·±çš„pluginçš„éœ€æ±‚ï¼Œä¸åœ¨è¿™ç¯‡æ–‡ç« çš„èŒƒå›´ã€‚å‡å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸‹çš„ä¸€ä¸ªå¥å­ï¼š12345GET _analyze&#123; &quot;text&quot;: &quot;I am so excited to go to the x-school&quot;, &quot;analyzer&quot;: &quot;standard&quot;&#125;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™æ ·çš„ç»“æžœï¼š1234567891011121314&#123; &quot;token&quot; : &quot;x&quot;, &quot;start_offset&quot; : 29, &quot;end_offset&quot; : 30, &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;, &quot;position&quot; : 8&#125;,&#123; &quot;token&quot; : &quot;school&quot;, &quot;start_offset&quot; : 31, &quot;end_offset&quot; : 37, &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;, &quot;position&quot; : 9&#125;x-schoolåœ¨è¿™é‡Œè¢«åˆ†ä¸ºä¸¤ä¸ªtokenï¼šx åŠ schoolã€‚å¦‚æžœæˆ‘ä»¬æƒ³æŠŠx-schoolå½“åšä¸€ä¸ªè¯¥æ€Žä¹ˆåŠžå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®ç‰¹æœ‰çš„mappingæ¥å®žçŽ°ï¼Œæ¯”å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªå«åšblogçš„indexï¼š1234567891011121314151617181920212223242526272829303132333435PUT blogs&#123; &quot;settings&quot;: &#123; &quot;analysis&quot;: &#123; &quot;char_filter&quot;: &#123; &quot;xschool_filter&quot;: &#123; &quot;type&quot;: &quot;mapping&quot;, &quot;mappings&quot;: [ &quot;X-School =&gt; XSchool&quot; ] &#125; &#125;, &quot;analyzer&quot;: &#123; &quot;my_content_analyzer&quot;: &#123; &quot;type&quot;: &quot;custom&quot;, &quot;char_filter&quot;: [ &quot;xschool_filter&quot; ], &quot;tokenizer&quot;: &quot;standard&quot;, &quot;filter&quot;: [ &quot;lowercase&quot; ] &#125; &#125; &#125; &#125;, &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;content&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;analyzer&quot;: &quot;my_content_analyzer&quot; &#125; &#125; &#125; &#125;å¤§å®¶è¯·æ³¨æ„åœ¨settingsé‡Œçš„â€œanalysisâ€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªç§°ä¹‹ä¸ºxschool_filterçš„char_filterï¼Œå®ƒå¯ä»¥å¸®æˆ‘ä»¬æŠŠâ€œx-schoolâ€è½¬åŒ–ä¸ºâ€œXSchoolâ€ã€‚ç´§æŽ¥ç€ï¼Œæˆ‘ä»¬åˆ©ç”¨xschool_filterå®šä¹‰äº†ä¸€ä¸ªå«åšâ€œmy_content_analyzerâ€ã€‚å®ƒæ˜¯ä¸€ä¸ªå®šåˆ¶çš„ç±»åž‹ã€‚æˆ‘ä»¬å®šä¹‰å®ƒçš„char_filterï¼Œ tokenizeråŠfilterã€‚çŽ°åœ¨æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æˆ‘ä»¬åˆšæ‰å®šä¹‰my_content_analyzeræ¥åˆ†æžæˆ‘ä»¬çš„å­—ç¬¦ä¸²ã€‚æˆ‘ä»¬åœ¨mappingsé‡Œå¯ä»¥çœ‹åˆ°ï¼š12345678&quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;content&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;analyzer&quot;: &quot;my_content_analyzer&quot; &#125; &#125;&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº†æˆ‘ä»¬åˆšæ‰åœ¨analysisé‡Œå®šä¹‰çš„my_content_analyzeråˆ†æžå™¨ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹æ³•æ¥æµ‹è¯•å®ƒæ˜¯å¦å·¥ä½œï¼š12345POST blogs/_analyze&#123; &quot;text&quot;: &quot;I am so excited to go to the X-School&quot;, &quot;analyzer&quot;: &quot;my_content_analyzer&quot;&#125;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„ç»“æžœï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667&#123; &quot;tokens&quot; : [ &#123; &quot;token&quot; : &quot;i&quot;, &quot;start_offset&quot; : 0, &quot;end_offset&quot; : 1, &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;, &quot;position&quot; : 0 &#125;, &#123; &quot;token&quot; : &quot;am&quot;, &quot;start_offset&quot; : 2, &quot;end_offset&quot; : 4, &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;, &quot;position&quot; : 1 &#125;, &#123; &quot;token&quot; : &quot;so&quot;, &quot;start_offset&quot; : 5, &quot;end_offset&quot; : 7, &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;, &quot;position&quot; : 2 &#125;, &#123; &quot;token&quot; : &quot;excited&quot;, &quot;start_offset&quot; : 8, &quot;end_offset&quot; : 15, &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;, &quot;position&quot; : 3 &#125;, &#123; &quot;token&quot; : &quot;to&quot;, &quot;start_offset&quot; : 16, &quot;end_offset&quot; : 18, &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;, &quot;position&quot; : 4 &#125;, &#123; &quot;token&quot; : &quot;go&quot;, &quot;start_offset&quot; : 19, &quot;end_offset&quot; : 21, &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;, &quot;position&quot; : 5 &#125;, &#123; &quot;token&quot; : &quot;to&quot;, &quot;start_offset&quot; : 22, &quot;end_offset&quot; : 24, &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;, &quot;position&quot; : 6 &#125;, &#123; &quot;token&quot; : &quot;the&quot;, &quot;start_offset&quot; : 25, &quot;end_offset&quot; : 28, &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;, &quot;position&quot; : 7 &#125;, &#123; &quot;token&quot; : &quot;xschool&quot;, &quot;start_offset&quot; : 29, &quot;end_offset&quot; : 37, &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;, &quot;position&quot; : 8 &#125; ]&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°â€œxschoolâ€è¿™ä¸ªtokenã€‚ä»Žä¸Šé¢çš„è¿”å›žçš„ç»“æžœæ¥çœ‹ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¯ä»¥çœ‹åˆ°â€œtheâ€ï¼Œâ€œtoâ€è¿™æ ·çš„tokenã€‚å¦‚æžœæˆ‘ä»¬æƒ³åŽ»æŽ‰è¿™äº›tokençš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥åšåšå¦‚ä¸‹çš„è®¾ç½®ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344DELETE blogs PUT blogs&#123; &quot;settings&quot;: &#123; &quot;analysis&quot;: &#123; &quot;char_filter&quot;: &#123; &quot;xschool_filter&quot;: &#123; &quot;type&quot;: &quot;mapping&quot;, &quot;mappings&quot;: [ &quot;X-School =&gt; XSchool&quot; ] &#125; &#125;, &quot;analyzer&quot;: &#123; &quot;my_content_analyzer&quot;: &#123; &quot;type&quot;: &quot;custom&quot;, &quot;char_filter&quot;: [ &quot;xschool_filter&quot; ], &quot;tokenizer&quot;: &quot;standard&quot;, &quot;filter&quot;: [ &quot;lowercase&quot;, &quot;my_stop&quot; ] &#125; &#125;, &quot;filter&quot;: &#123; &quot;my_stop&quot;: &#123; &quot;type&quot;: &quot;stop&quot;, &quot;stopwords&quot;: [&quot;so&quot;, &quot;to&quot;, &quot;the&quot;] &#125; &#125; &#125; &#125;, &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;content&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;analyzer&quot;: &quot;my_content_analyzer&quot; &#125; &#125; &#125;&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é‡æ–°åŠ å…¥äº†ä¸€ä¸ªå«åšmy_stopçš„è¿‡æ»¤å™¨ï¼š123456&quot;filter&quot;: &#123; &quot;my_stop&quot;: &#123; &quot;type&quot;: &quot;stop&quot;, &quot;stopwords&quot;: [&quot;so&quot;, &quot;to&quot;, &quot;the&quot;] &#125;&#125;æˆ‘ä»¬åœ¨æˆ‘ä»¬è‡ªå·±å®šåˆ¶çš„åˆ†æžå™¨ä¸­ä¹ŸåŠ å…¥äº†my_stopã€‚é‡æ–°è¿è¡Œæˆ‘ä»¬çš„åˆ†æžï¼š12345POST blogs/_analyze&#123; &quot;text&quot;: &quot;I am so excited to go to the X-School&quot;, &quot;analyzer&quot;: &quot;my_content_analyzer&quot;&#125;åœ¨ä¸Šé¢æˆ‘ä»¬æŠŠso, toåŠtheä½œä¸ºstop wordsåŽ»æŽ‰äº†ã€‚é‡æ–°è¿è¡Œæˆ‘ä»¬çš„åˆ†æžï¼š12345POST blogs/_analyze&#123; &quot;text&quot;: &quot;I am so excited to go to the X-School&quot;, &quot;analyzer&quot;: &quot;my_content_analyzer&quot;&#125;æ˜¾ç¤ºçš„ç»“æžœä¸ºï¼š123456789101112131415161718192021222324252627282930313233343536373839&#123; &quot;tokens&quot; : [ &#123; &quot;token&quot; : &quot;i&quot;, &quot;start_offset&quot; : 0, &quot;end_offset&quot; : 1, &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;, &quot;position&quot; : 0 &#125;, &#123; &quot;token&quot; : &quot;am&quot;, &quot;start_offset&quot; : 2, &quot;end_offset&quot; : 4, &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;, &quot;position&quot; : 1 &#125;, &#123; &quot;token&quot; : &quot;excited&quot;, &quot;start_offset&quot; : 8, &quot;end_offset&quot; : 15, &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;, &quot;position&quot; : 3 &#125;, &#123; &quot;token&quot; : &quot;go&quot;, &quot;start_offset&quot; : 19, &quot;end_offset&quot; : 21, &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;, &quot;position&quot; : 5 &#125;, &#123; &quot;token&quot; : &quot;xschool&quot;, &quot;start_offset&quot; : 29, &quot;end_offset&quot; : 37, &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;, &quot;position&quot; : 8 &#125; ]&#125;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°so, theåŠtoéƒ½è¢«è¿‡æ»¤æŽ‰äº†ã€‚Filterçš„é¡ºåºä¹Ÿå¾ˆé‡è¦æˆ‘ä»¬æ¥è¯•ä¸€ä¸‹ä¸‹é¢çš„ä¸€ä¸ªä¾‹å­ï¼š123456789GET _analyze&#123; &quot;tokenizer&quot;: &quot;whitespace&quot;, &quot;filter&quot;: [ &quot;lowercase&quot;, &quot;stop&quot; ], &quot;text&quot;: &quot;To Be Or Not To Be&quot;&#125;åœ¨è¿™é‡Œæˆ‘ä»¬å…ˆè¿›è¡Œlowercaseçš„è¿‡æ»¤å™¨ï¼Œå…ˆå˜æˆå°å†™å­—æ¯ï¼Œå†è¿›è¡Œstopè¿‡æ»¤å™¨ï¼Œé‚£ä¹ˆè¿”å›žçš„ç»“æžœæ˜¯[]ï¼Œä¹Ÿå³æ²¡æœ‰ã€‚ç›¸åï¼Œå¦‚æžœæˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹çš„é¡ºåºï¼š123456789GET _analyze&#123; &quot;tokenizer&quot;: &quot;whitespace&quot;, &quot;filter&quot;: [ &quot;stop&quot;, &quot;lowercase&quot; ], &quot;text&quot;: &quot;To Be Or Not To Be&quot;&#125;è¿™é‡Œå…ˆè¿›è¡Œstopè¿‡æ»¤å™¨ï¼Œå› ä¸ºè¿™é‡Œçš„è¯æœ‰äº›æ˜¯å¤§å†™å­—æ¯ï¼Œæ‰€ä»¥ä¸è¢«è®¤ä¸ºæ˜¯stopè¯ï¼Œé‚£ä¹ˆæ²¡æœ‰è¢«è¿‡æ»¤æŽ‰ã€‚ä¹‹åŽè¿›è¡Œlowercaseï¼Œæ˜¾ç¤ºçš„ç»“æžœæ˜¯to, be, or, not, to, beè¿™äº›tokenã€‚search_analyzerä¹Ÿè®¸å¤§å®¶å·²ç»çœ‹å‡ºæ¥äº†ï¼Œæ¯å½“ä¸€ä¸ªæ–‡æ¡£åœ¨è¢«å½•å…¥åˆ°Elasticsearchä¸­æ—¶ï¼Œéœ€è¦ä¸€ä¸ªå«åšindexçš„è¿‡ç¨‹ã€‚åœ¨Indexçš„è¿‡ç¨‹ä¸­ï¼Œå®ƒä¼šä¸ºè¯¥å­—ç¬¦ä¸²è¿›è¡Œåˆ†è¯ï¼Œå¹¶æœ€ç»ˆå½¢æˆä¸€ä¸ªä¸€ä¸ªçš„tokenï¼Œå¹¶å­˜äºŽæ•°æ®åº“ã€‚ä½†æ˜¯ï¼Œæ¯å½“æˆ‘ä»¬æœç´¢ä¸€ä¸ªå­—ç¬¦ä¸²æ—¶ï¼Œåœ¨æœç´¢æ—¶ï¼Œæˆ‘ä»¬åŒæ ·ä¹Ÿè¦å¯¹è¯¥å­—ç¬¦ä¸²è¿›è¡Œåˆ†è¯ï¼Œä¹Ÿä¼šå»ºç«‹tokenã€‚å½“ç„¶è¿™äº›tokenä¸ä¼šè¢«å­˜æ”¾äºŽæ•°æ®åº“ä¸­ã€‚æ¯”å¦‚ï¼š12345678GET /chinese/_search&#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;content&quot;: &quot;Happy a birthday&quot; &#125; &#125;&#125;å¯¹äºŽè¿™ä¸ªæœç´¢æ¥è¯´ï¼Œæˆ‘ä»¬åœ¨é»˜è®¤çš„æƒ…å†µä¸‹ï¼Œä¼šæŠŠâ€Happy a birthdayâ€ä½¿ç”¨åŒæ ·çš„analyzerè¿›è¡Œåˆ†è¯ã€‚å¦‚æžœæˆ‘ä»¬çš„analyzeré‡Œå«æœ‰stopè¿‡æ»¤å™¨ï¼Œå®ƒæžæœ‰å¯èƒ½æŠŠå­—æ¯â€œaâ€è¿‡æ»¤æŽ‰ï¼Œé‚£ä¹ˆç›´å‰©ä¸‹â€œhappyâ€åŠâ€œbirthdayâ€è¿™ä¸¤ä¸ªè¯ï¼Œè€Œâ€œaâ€å°†ä¸è¿›å…¥æœç´¢ä¹‹ä¸­ã€‚åœ¨å®žé™…çš„ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹æ³•å¯¹æœç´¢è¿›è¡Œåˆ¶å®šå…·ä½“çš„search_analyzerã€‚12345678910111213141516171819202122232425262728293031323334353637383940414243PUT blogs&#123; &quot;settings&quot;: &#123; &quot;analysis&quot;: &#123; &quot;char_filter&quot;: &#123; &quot;xschool_filter&quot;: &#123; &quot;type&quot;: &quot;mapping&quot;, &quot;mappings&quot;: [ &quot;X-School =&gt; XSchool&quot; ] &#125; &#125;, &quot;analyzer&quot;: &#123; &quot;my_content_analyzer&quot;: &#123; &quot;type&quot;: &quot;custom&quot;, &quot;char_filter&quot;: [ &quot;xschool_filter&quot; ], &quot;tokenizer&quot;: &quot;standard&quot;, &quot;filter&quot;: [ &quot;lowercase&quot;, &quot;my_stop&quot; ] &#125; &#125;, &quot;filter&quot;: &#123; &quot;my_stop&quot;: &#123; &quot;type&quot;: &quot;stop&quot;, &quot;stopwords&quot;: [&quot;so&quot;, &quot;to&quot;, &quot;the&quot;] &#125; &#125; &#125; &#125;, &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;content&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;analyzer&quot;: &quot;my_content_analyzer&quot;, &quot;search_analyzer&quot;: &quot;standard&quot; &#125; &#125; &#125;&#125;åœ¨ä¸Šé¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åˆ†åˆ«å®šä¹‰äº†ä¸ç”¨çš„analyzerï¼šåœ¨å½•å…¥æ–‡æ¡£æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†my_content_analyzeråˆ†æžå™¨ï¼Œè€Œåœ¨æœç´¢æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†standardåˆ†æžå™¨ã€‚]]></content>
  </entry>
  <entry>
    <title></title>
    <url>%2F2020%2F01%2F02%2FElasticsearch%20alias%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%2F</url>
    <content type="text"><![CDATA[å°±åƒå…¶ä»–çš„å¾ˆå¤šè¯­è¨€ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ç»™å·²æœ‰çš„å˜é‡å–ä¸€ä¸ªåˆ«åï¼ˆaliasï¼‰ã€‚å³ä¾¿æ˜¯å¯¹é«˜çº§è¯­è¨€ä¸€æ ·ï¼Œæ¯”å¦‚æˆ‘ä»¬å®šä¹‰ä¸åŒçš„æŒ‡é’ˆå˜é‡ï¼ŒæŒ‡å‘åŒä¸€ä¸ªå†…å­˜ç©ºé—´ã€‚è¿™ä¸ªæœ‰äº›ç±»ä¼¼åˆ«åçš„æ¦‚å¿µã€‚åœ¨Elasticsearchä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸ºindexä¸­çš„ä¸€ä¸ªå­—æ®µï¼ˆfieldï¼‰å–ä¸€ä¸ªå¦å¤–çš„åå­—ï¼šå®ƒå¯ä»¥ç”¨æ¥ä»£æ›¿æœç´¢è¯·æ±‚ä¸­çš„ç›®æ ‡ï¼ˆtargetï¼‰å­—æ®µä»¥åŠå…¶å®ƒçš„è¢«é€‰å®šçš„APIä¸­é€šå¸¸aliaså¯ä»¥ç”¨æ¥å¸®åŠ©æˆ‘ä»¬é‡æ–°å‘½åä¸€ä¸ªå­—æ®µï¼Œå¹¶è®©è¿™ä¸ªå­—æ®µçš„åç§°ç¬¦åˆæˆ‘ä»¬çš„å‘½åè§„åˆ™ã€‚æˆ‘ä»¬å¯ä»¥å‚è€ƒECSã€‚é€šè¿‡aliasçš„ä½¿ç”¨ï¼Œå¯ä»¥ä½¿å¾—æˆ‘ä»¬çš„å­—æ®µæ ¹æ®ç¬¦åˆECSæ ‡å‡†ã€‚ä¸€ä¸ªå­—æ®µçš„aliasåªèƒ½æœ‰ä¸€ä¸ªç›®æ ‡å­—æ®µã€‚åœ¨ä½¿ç”¨aliasæ—¶ï¼Œå­—æ®µåˆ«åçš„ç›®æ ‡æœ‰ä¸€äº›é™åˆ¶ï¼šå®ƒå¿…é¡»æ˜¯ä¸€ä¸ªå…·ä½“çš„å­—æ®µï¼ˆä¸æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–è€…æ˜¯å¦å¤–ä¸€ä¸ªaliasï¼‰å®ƒå¿…é¡»åœ¨aliasè¢«åˆ›å»ºæ—¶å·²ç»å­˜åœ¨å¦‚æžœæ˜¯ä¸€ä¸ªnestedçš„å¯¹è±¡ï¼Œé‚£ä¹ˆaliaså¿…é¡»å…·æœ‰å’Œå®ƒçš„ç›®æ ‡å…·æœ‰åŒæ ·çš„nested scopeä¸€ä¸ªaliasçš„åº”ç”¨ä¾‹å­ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥ç”¨ä¸€ä¸ªå…·ä½“çš„ä¾‹å­æ¥è¯´è¯´æ˜Žã€‚æˆ‘ä»¬é¦–å…ˆæ¥å®šä¹‰ä¸€ä¸ªindexçš„mappingå¦‚ä¸‹ï¼š1234567891011121314151617PUT trips&#123; &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;distance&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;route_length_miles&quot;: &#123; &quot;type&quot;: &quot;alias&quot;, &quot;path&quot;: &quot;distance&quot; &#125;, &quot;transit_mode&quot;: &#123; &quot;type&quot;: &quot;keyword&quot; &#125; &#125; &#125;&#125;çŽ°åœ¨æˆ‘ä»¬è¾“å…¥ä¸€ä¸‹çš„ä¸¤ä¸ªæ–‡æ¡£ï¼Œå¹¶æœç´¢ï¼š12345678910111213141516171819202122PUT trips/_doc/1&#123; &quot;distance&quot;: 100, &quot;transit_mode&quot;: &quot;mode1&quot;&#125; PUT trips/_doc/2&#123; &quot;distance&quot;: 50, &quot;transit_mode&quot;: &quot;mode2&quot;&#125; GET _search&#123; &quot;query&quot;: &#123; &quot;range&quot; : &#123; &quot;route_length_miles&quot; : &#123; &quot;gte&quot; : 60 &#125; &#125; &#125;&#125;æ˜¾ç¤ºçš„ç»“æžœæ˜¯ï¼š1234567891011121314151617181920212223242526272829&#123; &quot;took&quot; : 346, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 20, &quot;successful&quot; : 20, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 1, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 1.0, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;trips&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 1.0, &quot;_source&quot; : &#123; &quot;distance&quot; : 100, &quot;transit_mode&quot; : &quot;mode1&quot; &#125; &#125; ] &#125;&#125;ä»Žä¸Šé¢å¯ä»¥çœ‹å‡ºæ¥ï¼Œè™½ç„¶æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨åœ¨sourceä¸­çš„distanceï¼Œä½†æ˜¯æˆ‘ä»¬ä½¿ç”¨å®ƒçš„åˆ«åroute_length_milesï¼Œæˆ‘ä»¬å¯ä»¥ç…§æ ·æŠŠæˆ‘ä»¬çš„ç»Ÿè®¡æ•°æ®æœç´¢å‡ºæ¥ã€‚ä¸è¢«æ”¯æŒçš„APIä¸æ”¯æŒå†™å…¥å­—æ®µåˆ«åï¼šå°è¯•åœ¨ç´¢å¼•æˆ–æ›´æ–°è¯·æ±‚ä¸­ä½¿ç”¨åˆ«åå°†å¯¼è‡´å¤±è´¥ã€‚ åŒæ ·ï¼Œåˆ«åä¸èƒ½ç”¨ä½œcopy_toçš„ç›®æ ‡æˆ–å¤šå­—æ®µã€‚ç”±äºŽæ–‡æ¡£æºä¸­ä¸å­˜åœ¨åˆ«åï¼Œå› æ­¤åœ¨æ‰§è¡Œæºè¿‡æ»¤æ—¶ä¸èƒ½ä½¿ç”¨åˆ«åã€‚ ä¾‹å¦‚ï¼Œä»¥ä¸‹è¯·æ±‚å°†è¿”å›ž_sourceçš„ç©ºç»“æžœï¼šä¸æ”¯æŒå†™å…¥å­—æ®µåˆ«åï¼šå°è¯•åœ¨ç´¢å¼•æˆ–æ›´æ–°è¯·æ±‚ä¸­ä½¿ç”¨åˆ«åå°†å¯¼è‡´å¤±è´¥ã€‚ åŒæ ·ï¼Œåˆ«åä¸èƒ½ç”¨ä½œcopy_toçš„ç›®æ ‡æˆ–å¤šå­—æ®µã€‚ç”±äºŽæ–‡æ¡£æºä¸­ä¸å­˜åœ¨åˆ«åï¼Œå› æ­¤åœ¨æ‰§è¡Œæºè¿‡æ»¤æ—¶ä¸èƒ½ä½¿ç”¨åˆ«åã€‚ ä¾‹å¦‚ï¼Œä»¥ä¸‹è¯·æ±‚å°†è¿”å›ž_sourceçš„ç©ºç»“æžœï¼š]]></content>
  </entry>
  <entry>
    <title></title>
    <url>%2F2020%2F01%2F02%2FElastic%EF%BC%9AElastic%E9%83%A8%E7%BD%B2%E6%9E%B6%E6%9E%84%E4%BB%8B%E7%BB%8D%2F</url>
    <content type="text"><![CDATA[Elastic Stackæ˜¯ä¸€å¥—å®Œæ•´çš„ä»Žæ•°æ®é‡‡é›†ï¼Œè§£æžï¼Œåˆ†æžï¼Œä¸°å¯Œï¼Œåˆ°æœç´¢ï¼Œæ£€ç´¢ï¼Œæ•°æ®ç¨‹åºç­‰ä¸€å¥—å®Œæ•´çš„è½¯ä»¶æ ˆã€‚åœ¨å…·ä½“çš„å®žè·µä¸­ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•æ­å»ºæˆ‘ä»¬çš„ç³»ç»Ÿå‘¢ï¼Ÿä¸‹å›¾æè¿°äº†å¸¸ç”¨çš„Elastic Stackçš„éƒ¨ç½²æž¶æž„ï¼šè¯¥å›¾æè¿°äº†ä¸‰ç§å¯èƒ½çš„ä½“ç³»ç»“æž„ï¼šå°†æ“ä½œæŒ‡æ ‡ç›´æŽ¥å‘é€åˆ°Elasticsearchï¼šå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæ‚¨å°†åœ¨è¦ä»Žå…¶å‘é€æ“ä½œæŒ‡æ ‡/æ—¥å¿—çš„è¾¹ç¼˜æœåŠ¡å™¨ä¸Šå®‰è£…å„ç§ç±»åž‹çš„Beatsï¼Œä¾‹å¦‚Metricbeatï¼ŒFilebeatï¼ŒPacketbeatç­‰ã€‚ å¦‚æžœä¸éœ€è¦è¿›ä¸€æ­¥å¤„ç†ï¼Œé‚£ä¹ˆå¯ä»¥å°†ç”Ÿæˆçš„äº‹ä»¶ç›´æŽ¥ä¼ é€åˆ°Elasticsearché›†ç¾¤ã€‚ ä¸€æ—¦æ•°æ®å‡ºçŽ°åœ¨Elasticsearchä¸­ï¼Œå°±å¯ä»¥ä½¿ç”¨Kibanaå¯¹å…¶è¿›è¡Œå¯è§†åŒ–/åˆ†æžã€‚ åœ¨è¿™ç§ä½“ç³»ç»“æž„ä¸­ï¼Œäº‹ä»¶æµå°†æ˜¯Beatsâ†’Elasticsearchâ†’Kibanaã€‚å½“ç„¶å¦‚æžœæ‚¨éœ€è¦åšè¿›ä¸€æ­¥çš„å¤„ç†ï¼Œæ‚¨ä¹Ÿå¯ä»¥é€šè¿‡ingest nodeçš„piplelineå¸®åŠ©å®žçŽ°ã€‚å°†æ“ä½œæŒ‡æ ‡å‘é€åˆ°Logstashï¼šBeatsæ•èŽ·å¹¶å®‰è£…åœ¨è¾¹ç¼˜æœåŠ¡å™¨ä¸Šçš„æ“ä½œæŒ‡æ ‡/æ—¥å¿—å°†å‘é€åˆ°Logstashè¿›è¡Œè¿›ä¸€æ­¥å¤„ç†ï¼Œä¾‹å¦‚è§£æžæ—¥å¿—æˆ–ä¸°å¯Œæ—¥å¿—äº‹ä»¶ã€‚ ç„¶åŽï¼Œå·²è§£æž/ä¸°å¯Œçš„äº‹ä»¶è¢«æŽ¨é€åˆ°Elasticsearchã€‚ ä¸ºäº†æé«˜å¤„ç†èƒ½åŠ›ï¼Œæ‚¨å¯ä»¥æ‰©å±•Logstashå®žä¾‹ï¼Œä¾‹å¦‚ï¼Œé€šè¿‡é…ç½®ä¸€ç»„Beatså°†æ•°æ®å‘é€åˆ°Logstashå®žä¾‹1ï¼Œå¹¶é…ç½®å¦ä¸€ç»„Beatså°†æ•°æ®å‘é€åˆ°Logstashå®žä¾‹2ï¼Œä¾æ­¤ç±»æŽ¨ã€‚ åœ¨è¿™ç§æž¶æž„ä¸­ï¼Œäº‹ä»¶æµå°†æ˜¯Beatsâ†’Logstashâ†’Elasticsearchâ†’Kibanaã€‚å°†æ“ä½œæŒ‡æ ‡å‘é€åˆ°å¼¹æ€§é˜Ÿåˆ—ï¼šå¦‚æžœç”Ÿæˆçš„äº‹ä»¶å‘ç”ŸçŽ‡å¾ˆé«˜ï¼Œå¹¶ä¸”Logstashåœæœºæ—¶Logstashæ— æ³•åº”ä»˜è´Ÿè½½æˆ–é˜²æ­¢æ•°æ®/äº‹ä»¶ä¸¢å¤±ï¼Œåˆ™å¯ä»¥ä½¿ç”¨è¯¸å¦‚ä»¥ä¸‹çš„å¼¹æ€§é˜Ÿåˆ— Apache Kafkaï¼Œä»¥ä¾¿å°†äº‹ä»¶æŽ’é˜Ÿã€‚ ç„¶åŽï¼ŒLogstashå¯ä»¥ä»¥è‡ªå·±çš„é€Ÿåº¦å¤„ç†å®ƒä»¬ï¼Œä»Žè€Œé¿å…ä¸¢å¤±Beatsæ•èŽ·çš„æ“ä½œæŒ‡æ ‡/æ—¥å¿—ã€‚ åœ¨è¿™ç§ä½“ç³»ç»“æž„ä¸­ï¼Œäº‹ä»¶æµå°†æ˜¯Beatsâ†’Kafkaâ†’Logstashâ†’Elasticsearchâ†’Kibanaã€‚æç¤ºï¼šä»ŽLogstash 5.xå¼€å§‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨Logstashçš„æŒä¹…é˜Ÿåˆ—è®¾ç½®ï¼Œä¹Ÿå¯ä»¥å°†å…¶ç”¨ä½œé˜Ÿåˆ—ã€‚ ä½†æ˜¯ï¼Œå®ƒä¸åƒKafkaä¸€æ ·æä¾›é«˜åº¦çš„å¼¹æ€§ã€‚ä¹Ÿæœ‰ä¸€äº›åº”ç”¨åœºæ™¯æ˜¯è¿™æ ·éƒ¨ç½²çš„ï¼šåŒæ ·çš„ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡radisæˆ–Kafakaæ¥æä¾›ä¸€ä¸ªå¼¹æ€§é˜Ÿåˆ—æ¥ç¼“å†²é«˜å‘ç”ŸçŽ‡äº‹ä»¶ã€‚åœ¨å®žé™…çš„ä½¿ç”¨ä¸­ï¼Œå¦‚æžœæˆ‘ä»¬ä¸æŠŠElasticsearchå½“åšå”¯ä¸€çš„æ•°æ®åº“æ¥å­˜å‚¨çš„è¯ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨å¦‚ä¸‹çš„æ–¹æ¡ˆï¼šåœ¨è¿™ç§æž¶æž„ä¸­ï¼Œæ‚¨æœ‰ä¸¤ä¸ªæ•°æ®å­˜å‚¨ï¼Œå¿…é¡»æ‰¾åˆ°ä¸€ç§ä½¿å®ƒä»¬ä¿æŒåŒæ­¥çš„æ–¹æ³•ã€‚ æ ¹æ®æ‚¨çš„ä¸»è¦æ•°æ®å­˜å‚¨åŒºå’Œæ•°æ®å¸ƒå±€æ–¹å¼ï¼Œæ‚¨å¯ä»¥éƒ¨ç½²Elasticsearchæ’ä»¶ä»¥ä½¿ä¸¤ä¸ªå®žä½“ä¿æŒåŒæ­¥ã€‚å¦‚ä¸‹çš„æ˜¯å¦å¤–ä¸€ä¸­æœ‰å¤–éƒ¨æ•°æ®ï¼Œç‰©è”ç½‘ç­‰çš„ä¸€ç§æž¶æž„ï¼šæˆ–è€…ä¸€ä¸ªæ›´åŠ å…¨é¢çš„æž¶æž„å›¾ï¼šåœ¨Elasticçš„å®˜æ–¹æ–‡æ¡£ä¸­ï¼Œæœ‰æ›´å¤šå…³äºŽéƒ¨ç½²æž¶æž„çš„æè¿°ã€‚è¯¦ç»†æ–‡æ¡£ï¼šhttps://www.elastic.co/assets/blt2614227bb99b9878/architecture-best-practices.pdf]]></content>
  </entry>
  <entry>
    <title></title>
    <url>%2F2020%2F01%2F02%2FElastic%20%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%20%E7%AE%A1%E7%90%86(APM)%E5%AE%9E%E8%B7%B5%2F</url>
    <content type="text"><![CDATA[åœ¨ä»Šå¤©çš„æ–‡ç« é‡Œï¼Œæˆ‘ä»¬å°†ä»‹ç»Elasticçš„ä¸€ä¸ªé‡è¦çš„åº”ç”¨ï¼šåº”ç”¨ç¨‹åºæ€§èƒ½ç®¡ç†ï¼ˆApplication Performance Monitoring/Management)ï¼Œç®€ç§°APMã€‚é‚£ä¹ˆåˆ°åº•ä»€ä¹ˆæ˜¯APMå‘¢ï¼Ÿéšç€æ—¶ä»£çš„å‘å±•ï¼Œæˆ‘ä»¬çš„ITæž¶æž„è¶Šæ¥è¶Šå¤æ‚ï¼Œæ¯”å¦‚ï¼šæˆ‘ä»¬ç³»ç»Ÿçš„æœåŠ¡å™¨è¶Šæ¥è¶Šå¤šï¼Œè€Œä¸”æ›´å¤šçš„è®¾å¤‡éƒ½éƒ¨ç½²åœ¨äº‘ç«¯ã€‚å¤æ‚çš„ç³»ç»Ÿç”šè‡³æœ‰æˆåƒä¸ªå¾®æœåŠ¡åŠæž¶æž„æ‰€ç»„æˆï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ä¸šåŠ¡è¯·æ±‚å¯èƒ½éœ€è¦ä¸€ä¸ªæˆ–æ›´å¤šçš„æœåŠ¡å…±åŒæ¥å®Œæˆã€‚é‚£ä¹ˆçŽ°åœ¨çš„é—®é¢˜æ˜¯ï¼Œå¦‚æžœæˆ‘ä»¬çš„è¯·æ±‚å˜å¾—å¾ˆæ…¢ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“åˆ°åº•æ˜¯å“ªä¸ªçŽ¯èŠ‚å‡ºçŽ°é—®é¢˜äº†å‘¢ï¼Ÿç»éªŒä¸°å¯Œçš„ç¨‹åºå‘˜æˆ–è€…ç³»ç»Ÿè®¾è®¡è€…ï¼Œå¯èƒ½ä»Žä¸€äº›logé‡Œæ‰¾åˆ°ç­”æ¡ˆã€‚å¯æ˜¯å½“æˆ‘ä»¬çš„logå˜å¾—éžå¸¸å¤§çš„æ—¶å€™ï¼Œè€Œä¸”æˆ‘ä»¬çš„æŽ¥å£ä¹Ÿè¶Šæ¥è¶Šå¤šæ—¶ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä¹Ÿè®¸æˆ‘ä»¬ä¹Ÿæ— èƒ½ä¸ºåŠ›ã€‚å½“æˆ‘ä»¬åœ¨è®¾è®¡é¡µé¢æˆ–è€…è¯·æ±‚æ—¶ï¼Œç»å¸¸ä¼šé‡åˆ°ä¸Šé¢çš„è¿™ç§ç­‰å¾…çš„æƒ…å†µã€‚å¯èƒ½æœ‰ä¸ªåˆ«çš„å·¥å…·èƒ½æœ‰æ•ˆåœ°è§£å†³éƒ¨åˆ†çš„é—®é¢˜ï¼Œä½†æ˜¯å¦‚ä½•èƒ½ä»Žæ•´ä¸ªçš„ç³»ç»Ÿé‡Œæ¥å®Œæˆè¿™ç§é—®é¢˜çš„å®šä½åŠåˆ†æžã€‚ElasticæŽ¨å‡ºçš„APMè§£å†³æ–¹æ¡ˆå¯ä»¥å®Œç¾Žåœ°è§£å†³è¿™äº›é—®é¢˜ã€‚ä¸ºæˆ‘ä»¬çš„ç³»ç»Ÿè®¾è®¡è€…æˆ–ç¨‹åºå‘˜æä¾›äº†ä¸€ä¸ªå¿«é€Ÿå®šä½çš„æ–¹æ³•ã€‚APM åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹å¦‚ä¸‹çš„è¿™ä¸ªå›¾ï¼šå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåœ¨ä¸åŒæ—¶åˆ»æˆ‘ä»¬è¯·æ±‚æ—¶ï¼Œæˆ‘ä»¬å‘çŽ°ä¸ºä»€ä¹ˆåœ¨17:36:30å‘ç”Ÿçš„ä¸€ä¸ªè¯·æ±‚éœ€è¦èŠ±å°†è¿‘8ç§’çš„æ—¶é—´ï¼Œè€Œå¦å¤–åœ¨17:36:30åˆ†å‘ç”Ÿçš„ä¸€ä¸ªè¯·æ±‚å´è¿”å›žä¸€ä¸ªé”™è¯¯çš„ä»£ç ï¼ŸElastic APMæ–¹æ¡ˆæ˜¯ä¸–ç•Œä¸Šç¬¬ä¸€ä¸ªå¼€æºçš„APM è§£å†³æ–¹æ¡ˆï¼šAPMè®°å½•æ•°æ®åº“æŸ¥è¯¢ï¼Œå¤–éƒ¨HTTPè¯·æ±‚ä»¥åŠå¯¹åº”ç”¨ç¨‹åºçš„è¯·æ±‚æœŸé—´å‘ç”Ÿçš„å…¶ä»–ç¼“æ…¢æ“ä½œçš„è·Ÿè¸ªå¾ˆå®¹æ˜“è®©ç¨‹åºå‘˜çœ‹åˆ°åº”ç”¨åœ¨è¿è¡Œæ—¶å„ä¸ªéƒ¨åˆ†æ‰€èŠ±çš„æ—¶é—´å®ƒæ”¶é›†æœªå¤„ç†çš„é”™è¯¯å’Œå¼‚å¸¸å¾ˆå®¹è®©ç¨‹åºå‘˜è°ƒè¯•é”™è¯¯åœ¨å®¢æˆ·é¢å¯¹æ€§èƒ½ç“¶é¢ˆå’Œé”™è¯¯ä¹‹å‰å…ˆå®šä½åˆ°é—®é¢˜æ‰€åœ¨æé«˜å¼€å‘å›¢é˜Ÿçš„ç”Ÿäº§åŠ›APMé€‚ç”¨äºŽElastic Stackçš„ä½ç½®APMå¦‚ä½•æŠŠæ•°æ®å­˜äºŽElasticsearchä¸­ï¼Œå¹¶æä¾›åˆ†æžå‘¢ï¼Ÿæˆ‘ä»¬çœ‹ä¸€ä¸‹å¦‚ä¸‹çš„æž¶æž„å›¾ï¼šå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ªæœ€å…¸åž‹çš„APMæž¶æž„å›¾ï¼šæˆ‘ä»¬éœ€è¦æž¶è®¾ä¸€å°ä¸“é—¨çš„APMæœåŠ¡å™¨ï¼Œè™½ç„¶ä¹Ÿå¯ä»¥å’ŒElastic Stackçš„å…¶å®ƒæœåŠ¡å™¨å¤„äºŽåŒä¸€å°æœåŠ¡å™¨ä¸­AMP agentä¸“é—¨æ”¶é›†æ•°æ®å¹¶å‘é€æ•°æ®åˆ°APMæœåŠ¡å™¨ä¸­ã€‚è¿™é‡Œçš„APM agentsåŒ…å«ï¼šAPMæœåŠ¡å™¨æŠŠæ•°æ®å‘é€åˆ°Elasticsearchä¸­ï¼Œå¹¶è¿›è¡Œæ•°æ®åˆ†æžKibanaå¯ä»¥å¸®æˆ‘ä»¬æŠŠæ•°æ®è¿›è¡Œå±•ç¤ºå¹¶æ˜¾ç¤ºåœ¨Dashboardä¹‹ä¸­æ€»ä½“æ¥è¯´ï¼ŒAPMæ•°æ®ä»…ä»…æ˜¯å¦å¤–Elasticsearchç´¢å¼•ã€‚åœ¨Kibanaä¸­å·²ç»æœ‰ä¸€ä¸ªçŽ°æˆçš„APMåº”ç”¨å¯ä»¥è¢«æˆ‘ä»¬æ‰€ä½¿ç”¨ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æ ¹æ®éœ€æ±‚è‡ªå·±å®šåˆ¶è‡ªå·±çš„Dashboardã€‚APMå¯ä»¥å®Œç¾Žåœ°ç»“åˆæœºå™¨å­¦ä¹ å’Œå‘Šè­¦ã€‚APMæœ¯è¯­Service: åœ¨apm agenté…ç½®ä¸­è¿›è¡Œè®¾ç½®ï¼Œä»¥å°†ç‰¹å®šçš„apm agentç»„æ ‡è¯†ä¸ºå•ä¸ªæœåŠ¡ï¼Œè¿™æ˜¯ä¸€ç§é€»è¾‘ä¸Šæ ‡è¯†ä¸€ç»„äº‹åŠ¡çš„æ–¹æ³•Transaction: ç»„æˆä¸€ä¸ªæœåŠ¡çš„è¯·æ±‚å’Œå“åº”ï¼Œä¾‹å¦‚ ç™»å½•apiè°ƒç”¨ï¼Œæ¯ä¸ªè°ƒç”¨ç”±å•ç‹¬çš„spanç»„æˆã€‚Span: äº‹åŠ¡ä¸­çš„å•ä¸ªäº‹ä»¶ï¼Œä¾‹å¦‚æ–¹æ³•è°ƒç”¨ï¼Œæ•°æ®åº“æŸ¥è¯¢æˆ–ç¼“å­˜æ’å…¥æˆ–æ£€ç´¢ï¼Œå³éœ€è¦èŠ±è´¹æ—¶é—´æ‰èƒ½å®Œæˆçš„ä»»ä½•äº‹ä»¶ã€‚Erorrsï¼šå…·æœ‰åŒ¹é…çš„å¼‚å¸¸æˆ–æ—¥å¿—æ¶ˆæ¯çš„å¼‚å¸¸ç»„å®ƒä»¬ä¹‹é—´çš„å…³ç³»å¯ä»¥ç”¨å¦‚ä¸‹çš„å›¾æ¥è¡¨ç¤ºï¼šåˆ†å¸ƒå¼tracingï¼šä¾‹å­åœ¨ä»Šå¤©çš„ç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬å°†ä»¥Java Spring bootä¸ºä¾‹æ¥å±•ç¤ºå¦‚ä½•ä½¿ç”¨Elastic APMã€‚ä¸‹è½½Spring bootä»£ç é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨terminalä¸­æ‰“å…¥å¦‚ä¸‹çš„å‘½ä»¤ï¼š1git clone https://github.com/liu-xiao-guo/elastic-apm-demoä¸Šé¢çš„ä¸€ä¸ªä¾‹å­æ˜¯ä¸€ä¸ªç®€å•çš„Spring bootåº”ç”¨ã€‚å®ƒæœ‰ä¸€ä¸‹çš„å‡ ä¸ªç‰¹ç‚¹ï¼šå®ƒå¯ä»¥RESTæŽ¥å£è®¿é—®MySQLçš„æ•°æ®åº“è¿›è¡Œæ·»åŠ æ•°æ®ï¼Œè¯·æ±‚æ•°æ®å®ƒå¯ä»¥é€šè¿‡RESTæŽ¥å£è¿›è¡Œè®¿é—®ç™¾åº¦å¤©æ°”æŽ¥å£æ¥èŽ·å¾—å¤©æ°”æ•°æ®ä¸‹é¢æ˜¯å®ƒçš„éƒ¨åˆ†ä»£ç ï¼š123456789101112131415161718192021222324252627282930@PostMapping(path=&quot;/add&quot;) // Map ONLY POST Requestspublic @ResponseBody String addNewUser (@RequestParam String name , @RequestParam String email) &#123; // @ResponseBody means the returned String is the response, not a view name // @RequestParam means it is a parameter from the GET or POST request User n = new User(); n.setName(name); n.setEmail(email); userRepository.save(n); return &quot;Saved&quot;;&#125;@GetMapping(path=&quot;/all&quot;)public @ResponseBody Iterable&lt;User&gt; getAllUsers() &#123; // This returns a JSON or XML with the users return userRepository.findAll();&#125;@GetMapping(path=&quot;/weather&quot;)public @ResponseBody String getBaiduWeather() throws InterruptedException &#123; // Add some random delays before getting the info double delay = Math.random() * 10; System.out.println(&quot;delay: &quot; + delay); TimeUnit.SECONDS.sleep((long)delay); String weather = getWeatherInform(&quot;åŒ—äº¬&quot;); return weather;&#125;åœ¨èŽ·å¾—å¤©æ°”ï¼ˆweatherï¼‰çš„æŽ¥å£ä¸­ï¼Œæˆ‘æ•…æ„åŠ å…¥äº†ä¸€ä¸‹éšæœºæ•°çš„å»¶è¿Ÿï¼Œè¿™æ ·æ¥æ¨¡æ‹Ÿæ¯ä¸€æ¬¡è¯·æ±‚çš„æ—¶é—´æ˜¯ä¸åŒçš„ã€‚æˆ‘ä»¬å¯ä»¥åœ¨åº”ç”¨çš„æ ¹ç›®å½•ä¸‹æ‰“å…¥å¦‚ä¸‹çš„å‘½ä»¤ï¼š1./mvnw clean packageè¿™æ ·å®ƒå°†ä¼šåœ¨å½“å‰ç›®å½•ä¸‹çš„targetå­ç›®å½•ä¸‹ç”Ÿäº§ä¸€ä¸ªå«åšaccessing-data-mysql-0.0.1-SNAPSHOT.jarçš„æ–‡ä»¶ã€‚12$ ls ./target/accessing-data-mysql-0.0.1-SNAPSHOT.jar./target/accessing-data-mysql-0.0.1-SNAPSHOT.jaræˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªæ–‡ä»¶æ‹·å…¥åˆ°æˆ‘ä»¬æƒ³è¦çš„ä»»ä½•ä¸€ä¸ªç›®å½•ä¸­ã€‚é’ˆå¯¹æˆ‘çš„æƒ…å†µï¼Œæˆ‘æŠŠå®ƒæ‹·å…¥åˆ°æˆ‘çš„homeç›®å½•ä¸‹çš„data/apmç›®å½•ä¸­ã€‚1234$ pwd/Users/liuxg/data/apmliuxg-2:apm liuxg$ ls accessing-data-mysql-0.0.1-SNAPSHOT.jaraccessing-data-mysql-0.0.1-SNAPSHOT.jarå®‰è£…MySQLæˆ‘ä»¬å¯ä»¥æŒ‰ç…§æ–‡æ¡£çš„éœ€æ±‚æ¥å®‰è£…æˆ‘ä»¬çš„MySQLã€‚æˆ‘ä»¬åœ¨ä¸€ä¸ªterminalä¸­æ‰“å…¥å¦‚ä¸‹çš„å‘½ä»¤ï¼š1mysql -uroot -pæˆ‘ä»¬æ‰“å…¥rootç”¨æˆ·çš„å¯†ç è¿›å…¥åˆ°MySQLä¹‹ä¸­ã€‚ä¸ºäº†åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ï¼Œæˆ‘ä»¬åœ¨MySQLçš„promptä¸­æ‰“å…¥å¦‚ä¸‹çš„å‘½ä»¤ï¼š123mysql&gt; create database db_example; -- Creates the new databasemysql&gt; create user &apos;springuser&apos;@&apos;%&apos; identified by &apos;ThePassword&apos;; -- Creates the usermysql&gt; grant all on db_example.* to &apos;springuser&apos;@&apos;%&apos;; -- Gives all privileges to the new user on the newly created databaseä¸Šé¢çš„å‘½ä»¤åˆ›å»ºäº†ä¸€ä¸ªå«åšdb_exampleçš„æ•°æ®åº“ã€‚åŒæ—¶ï¼Œå®ƒä¹Ÿåˆ›å»ºäº†ä¸€ä¸ªå«åšspringuserçš„ç”¨æˆ·åŠå…¶å¯†ç ThePasswordã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡Navicatå·¥å…·æ¥æŸ¥çœ‹:è¿è¡ŒElastic Stackå®‰è£…åŠè¿è¡Œæˆ‘ä»¬çš„ElasticsearchåŠKibanaã€‚æˆ‘ä»¬æ‰“å¼€æˆ‘ä»¬çš„Kibanaç•Œé¢ï¼Œå¹¶ç‚¹å‡»å·¦ä¸Šè§’çš„éƒ¨åˆ†ï¼šç„¶åŽï¼Œæˆ‘ä»¬æŒ‰ç…§ä¸Šé¢çš„æ­¥éª¤ä¸€æ­¥ä¸€æ­¥åœ°è¿›è¡Œå®‰è£…ï¼šä¸Šé¢çš„æ­¥éª¤éžå¸¸è¯¦ç»†ã€‚å¯¹äºŽAPM agentçš„é€‰æ‹©æ¥è®²ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯Javaåº”ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©Java agentã€‚æˆ‘ä»¬ä¸‹è½½ç›¸åº”çš„agent jaræ–‡ä»¶ï¼Œå¹¶å­˜æ”¾äºŽæˆ‘ä»¬ä¸Šé¢æ”¾ç½®spring bootçš„jaræ–‡ä»¶æ‰€å¤„çš„æ–‡ä»¶å¤¹ã€‚é’ˆå¯¹æˆ‘çš„æƒ…å†µæ˜¯homeç›®å½•ä¸‹çš„data/apmã€‚1234$ pwd/Users/liuxg/data/apmliuxg-2:apm liuxg$ ls elastic-apm-agent-1.10.0.jar elastic-apm-agent-1.10.0.jaråœ¨è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹è¿è¡Œæˆ‘ä»¬çš„Spring Javaåº”ç”¨äº†ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥è¿è¡Œï¼š123456java -javaagent:./elastic-apm-agent-1.10.0.jar \ -Delastic.apm.service_name=sample_apm \ -Delastic.apm.server_url=http://localhost:8200 \ -Delastic.apm.secret_token= \ -Delastic.apm.application_packages=accessing-data-mysql \ -jar accessing-data-mysql-0.0.1-SNAPSHOT.jaræ³¨æ„ï¼šè¿™é‡Œçš„sample_apmæ˜¯æˆ‘ç»™å–çš„ä¸€ä¸ªæœåŠ¡åç§°ã€‚ä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚å–ä¸€ä¸ªç‹¬ç‰¹çš„åå­—ã€‚å¦‚æžœä½ ä¸æƒ³è¿™ä¹ˆéº»çƒ¦ï¼Œä½ å¯ä»¥åœ¨å½“å‰çš„ç›®å½•ä¸‹ç”Ÿäº§ä¸€ä¸ªå«åšelasticapm.propertiesçš„æ–‡ä»¶ã€‚å®ƒçš„å†…å®¹å¦‚ä¸‹ï¼š123service_name=sample_apmapplication_packages=accessing-data-mysqlserver_url=http://localhost:8200é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥è¿è¡Œï¼š123java -javaagent:./elastic-apm-agent-1.10.0.jar \ -Delastic.apm.secret_token= \ -jar accessing-data-mysql-0.0.1-SNAPSHOT.jarç­‰æˆ‘ä»¬çš„Spring Bootåº”ç”¨å®Œå…¨èµ·æ¥åŽï¼Œæˆ‘ä»¬ç‚¹å‡»Kibanaä¸­çš„â€œCheck agent statusâ€æŒ‰é’®ã€‚è¿™ä¸ªæ—¶å€™å¯èƒ½æ˜¾ç¤ºæ²¡æœ‰ä»»ä½•çš„æ•°æ®ã€‚æˆ‘ä»¬å¯ä»¥æ‰“å¼€æˆ‘ä»¬çš„æµè§ˆå™¨ï¼Œå¹¶åœ¨æµè§ˆå™¨çš„åœ°å€æ ä¸­è¾“å…¥å¦‚ä¸‹çš„åœ°å€ï¼šæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸‹å¤©æ°”çš„æ•°æ®ä¿¡æ¯ã€‚é‚£ä¹ˆè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥åœ¨Agent statusä¸­çœ‹åˆ°ä¿¡æ¯ï¼šå¯åŠ¨APMåº”ç”¨å¦‚æžœä½ å·²ç»è¿è¡Œåˆ°è¿™é‡Œï¼Œé‚£ä¹ˆä½ åŸºæœ¬ä¸Šå·²ç»æŠŠæ•´ä¸ªçš„çŽ¯å¢ƒè¿è¡Œèµ·æ¥äº†ã€‚æˆ‘ä»¬å¯ä»¥åœ¨terminalä¸­æ‰“å…¥å¦‚ä¸‹çš„å‘½ä»¤ï¼š1curl localhost:8080/demo/add -d name=First -d email=someemail@someemailprovider.comä¸Šé¢çš„åº”ç”¨æ˜¯å‘æˆ‘ä»¬çš„æ•°æ®ä¸­å†™å…¥ä¸€æ¡è®°å½•ã€‚1curl &apos;localhost:8080/demo/all&apos;è¿è¡Œä¸Šé¢çš„å‘½ä»¤å¯ä»¥å±•ç¤ºå·²ç»è¾“å…¥çš„æ‰€æœ‰çš„è®°å½•1curl &apos;localhost:8080/demo/weather&apos;è¿è¡Œä¸Šé¢çš„å‘½ä»¤å¯ä»¥èŽ·å¾—ç™¾åº¦å¤©æ°”APIæŽ¥å£æ‰€å¸¦ç»™æˆ‘ä»¬çš„å¤©æ°”ä¿¡æ¯ã€‚ä¸Šé¢çš„æ‰€æœ‰çš„ä¿¡æ¯æˆ‘ä»¬éƒ½å¯ä»¥åœ¨æµè§ˆå™¨ä¸­çš„åœ°å€æ ä¸­è¾“å…¥ã€‚ç‚¹å‡»Kibanaä¸­çš„APMåº”ç”¨å›¾æ ‡ï¼šåœ¨ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åº”ç”¨çš„å››ä¸ªæŽ¥å£çš„ç»Ÿè®¡æƒ…å†µã€‚æˆ‘ä»¬åœ¨è¿™ä¸ªAPMåº”ç”¨çš„dashboardä¸Šå¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ‰€æœ‰çš„APIçš„è°ƒç”¨æƒ…å†µã€‚æ¯”å¦‚ï¼šå› ä¸ºåœ¨æˆ‘çš„åº”ç”¨ä¸­ï¼Œæˆ‘æ•…æ„åŠ å…¥äº†ä¸€äº›å»¶è¿Ÿï¼Œæ‰€ä»¥å¯¼è‡´æˆ‘ä»¬çš„æ•´ä¸ªgetBaiduWeatherçš„è¯·æ±‚æ—¶é—´ä¸º9.157ç§’æ‰å®Œæˆï¼Œè€Œapi.map.baidu.comçš„æ—¶é—´åªæœ‰149msã€‚åˆ°è¿™é‡Œæˆ‘çš„è®²è§£å°±å®Œæˆäº†ã€‚å‰©ä¸‹çš„ç•™ç»™å¤§å®¶è‡ªå·±åŽ»æŒ–æŽ˜å“ˆï¼å‚è€ƒï¼šã€1ã€‘Accessing data with MySQL(https://spring.io/guides/gs/accessing-data-mysql/)]]></content>
  </entry>
  <entry>
    <title></title>
    <url>%2F2020%2F01%2F02%2FBeats%EF%BC%9A%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%AE%9A%E5%88%B6%E7%9A%84Elastic%20Beat%2F</url>
    <content type="text"><![CDATA[Beatsä½œä¸ºElastic Stackå®¶æ—ä¸­é‡è¦çš„éƒ¨åˆ†ã€‚å®ƒå¯ä»¥å’Œæ–¹ä¾¿åœ°è®©æˆ‘ä»¬æŠŠæˆ‘ä»¬çš„æ•°æ®å‘é€åˆ°Elasticsearchæˆ–Logstashä¹‹ä¸­ã€‚å¦‚æžœæˆ‘ä»¬æƒ³è¦ç”Ÿæˆè‡ªå·±çš„Beatï¼Œè¯·ä½¿ç”¨GitHubçš„beatsä»“åº“ä¸­æä¾›çš„Beatç”Ÿæˆå™¨ã€‚åœ¨ä»Šå¤©çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä¸€æ­¥ä¸€æ­¥åœ°æ¥åˆ›å»ºä¸€ä¸ªæˆ‘ä»¬è‡ªå·±æƒ³è¦çš„beatã€‚è®¾ç½®è‡ªå·±çš„å¼€å‘çŽ¯å¢ƒå®‰è£…goçŽ¯å¢ƒBeatså®žé™…ä¸Šæ˜¯goç¨‹åºã€‚æˆ‘ä»¬å¯ä»¥å‚ç…§é“¾æŽ¥â€œGo get startedâ€(https://golang.org/doc/install)æ¥å®‰è£…è‡ªå·±çš„golangè¯­è¨€å¼€å‘çŽ¯å¢ƒã€‚ç­‰æˆ‘ä»¬å®‰è£…å¥½æˆ‘ä»¬çš„goåŽï¼Œæˆ‘ä»¬å¯ä»¥åœ¨terminalä¸­æ‰“å…¥å¦‚ä¸‹çš„å‘½ä»¤ï¼š12$ which go/usr/local/go/bin/goé‚£ä¹ˆæˆ‘ä»¬éœ€è¦åœ¨æˆ‘ä»¬çš„çŽ¯å¢ƒä¸­è®¾ç½®å¦‚ä¸‹çš„å˜é‡ï¼š123export GOROOT=/usr/local/goexport PATH=$GOPATH/bin:$GOROOT/bin:$PATHexport GOPATH=$HOME/go/beatsåœ¨è¿™é‡Œï¼Œæˆ‘ä¹Ÿè®¾ç½®äº†ä»¥GOPATHã€‚ä½ å¯ä»¥è®¾ç½®è‡ªå·±çš„è·¯å¾„ã€‚é’ˆå¯¹æˆ‘çš„æƒ…å†µï¼Œæˆ‘åœ¨æˆ‘çš„homeç›®å½•ä¸‹åˆ›å»ºäº†ä¸€ä¸ªgoç›®å½•ï¼Œå¹¶åœ¨goç›®å½•ä¸‹ç”Ÿäº§ä¸€ä¸ªå«åšbeatsçš„ç›®å½•ã€‚åœ¨ä¸€ä¸‹ï¼Œæˆ‘ä»¬ä¼šåœ¨è¿™ä¸ªç›®å½•é‡Œç”Ÿæˆæˆ‘ä»¬çš„å®šåˆ¶çš„beatã€‚ä¸‹è½½Elastic beatsæºç åœ¨è¿™ä¸€æ­¥æˆ‘ä»¬ä¸‹è½½Elastic beatsçš„æºç ã€‚åœ¨termnialä¸­æ‰“å…¥å¦‚ä¸‹çš„å‘½ä»¤ï¼š12mkdir -p $&#123;GOPATH&#125;/src/github.com/elasticgit clone https://github.com/elastic/beats $&#123;GOPATH&#125;/src/github.com/elastic/beatså®‰è£…Pythonç›®å‰generatoråªå¯¹Python2é€‚ç”¨ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…Python2ã€‚æˆ‘ä»¬å¯ä»¥å‚ç…§é¡µé¢https://www.python.org/downloads/è¿›è¡Œå®‰è£…æˆ‘ä»¬çš„python2ã€‚å®‰è£…virtualenvæˆ‘ä»¬å¿…é¡»å®‰è£…virtualenvæ‰èƒ½ä½¿å¾—generatoræ­£å¸¸å·¥ä½œã€‚å¯ä»¥å‚ç…§é“¾æŽ¥https://virtualenv.pypa.io/en/latest/installation/æ¥è¿›è¡Œå®‰è£…ã€‚å¦‚æžœè‡ªå·±çš„ç”µè„‘ä¸ŠåŒæ—¶å·²ç»å®‰è£…äº†python3ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦åŒæ—¶è®¾ç½®å¦‚å†™å˜é‡ï¼š12345export PYTHON_EXE=&apos;python2.7&apos;export VIRTUALENV_PARAMS=&apos;-p python2.7&apos;export VIRTUALENV_PYTHON=&apos;/usr/bin/python2.7&apos; export VIRTUALENV_PYTHON=&apos;/usr/local/bin/python&apos; (for Mac)è¯·æ³¨æ„ï¼šè¿™é‡Œçš„pythonæ˜¯2.xç‰ˆæœ¬çš„pythonï¼Œè€Œä¸æ˜¯python3ã€‚æˆ‘ä»¬éœ€è¦ä¿è¯VIRTUALENV_PYTHONæŒ‡å‘æˆ‘ä»¬çš„Python2çš„æ‰§è¡Œæ–‡ä»¶ã€‚å®‰è£…mageæˆ‘ä»¬éœ€è¦åœ¨åœ°å€https://github.com/magefile/mageä¸‹è½½è¿™ä¸ªæºç ï¼Œå¹¶ç¼–è¯‘ï¼š123go get -u -d github.com/magefile/magecd $GOPATH/src/github.com/magefile/magego run bootstrap.goç­‰ä¸Šé¢çš„å‘½ä»¤æ‰§è¡Œå®ŒåŽï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¦‚ä¸‹çš„ç›®å½•ä¸­æ‰¾åˆ°ç¼–è¯‘å¥½çš„æ‰§è¡Œæ–‡ä»¶mage:12liuxg-2:bin liuxg$ ls $GOPATH/binmageåˆ›å»ºå®šåˆ¶beaté¦–å…ˆåˆ›å»ºä¸€ä¸ªç›®å½•åœ¨$GOPATHä¸‹ï¼Œå¹¶è¿›å…¥è¯¥ç›®å½•ã€‚12mkdir $&#123;GOPATH&#125;/src/github.com/&#123;user&#125;cd $&#123;GOPATH&#125;/src/github.com/&#123;user&#125;æ³¨æ„è¿™é‡Œçš„useræŒ‡çš„æ˜¯è‡ªå·±åœ¨githubä¸Šçš„ç”¨æˆ·åã€‚æ¯”å¦‚é’ˆå¯¹æˆ‘çš„æƒ…å†µæ˜¯liu-xiao-guoã€‚æˆ‘æ‰“å…¥å¦‚ä¸‹å†™çš„å‘½ä»¤ï¼š12mkdir $&#123;GOPATH&#125;/src/github.com/liu-xiao-guocd $GOPATH/src/github.com/elastic/beats/æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¿è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼š1mage GenerateCustomBeatæ‰§è¡Œç»“æžœï¼š12345678910111213141516171819$ mage GenerateCustomBeat2019/11/13 15:24:01 Found Elastic Beats dir at /Users/liuxg/go/beats/src/github.com/elastic/beatsEnter the beat name [examplebeat]: CountbeatEnter your github name [your-github-name]: liu-xiao-guoEnter the beat path [github.com/liu-xiao-guo/countbeat]: Enter your full name [Firstname Lastname]: Xiaoguo LiuEnter the beat type [beat]: DEPRECATION: Python 2.7 will reach the end of its life on January 1st, 2020. Please upgrade your Python as Python 2.7 won&apos;t be maintained after that date. A future version of pip will drop support for Python 2.7. More details about Python 2 support in pip, can be found at https://pip.pypa.io/en/latest/development/release-process/#python-2-supportDEPRECATION: Python 2.7 will reach the end of its life on January 1st, 2020. Please upgrade your Python as Python 2.7 won&apos;t be maintained after that date. A future version of pip will drop support for Python 2.7. More details about Python 2 support in pip, can be found at https://pip.pypa.io/en/latest/development/release-process/#python-2-support WARNING: Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by &apos;ReadTimeoutError(&quot;HTTPSConnectionPool(host=&apos;pypi.tuna.tsinghua.edu.cn&apos;, port=443): Read timed out. (read timeout=15)&quot;,)&apos;: /simple/semver/2019/11/13 15:25:50 Found Elastic Beats dir at /Users/liuxg/go/beats/src/github.com/liu-xiao-guo/countbeat/vendor/github.com/elastic/beatsGenerated fields.yml for countbeat to /Users/liuxg/go/beats/src/github.com/liu-xiao-guo/countbeat/fields.yml2019/11/13 15:25:52 Found Elastic Beats dir at /Users/liuxg/go/beats/src/github.com/liu-xiao-guo/countbeat/vendor/github.com/elastic/beatsAuto packing the repository in background for optimum performance.See &quot;git help gc&quot; for manual housekeeping.=======================Your custom beat is now available as /Users/liuxg/go/beats/src/github.com/liu-xiao-guo/countbeat=======================è¿™æ ·ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå°±ç”Ÿäº§äº†ä¸€ä¸ªæœ€åŸºæœ¬çš„beatçš„æ¡†æž¶ã€‚æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¿›å…¥åˆ°æˆ‘ä»¬çš„beatç›®å½•é‡Œï¼Œå¹¶è¿›è¡Œç¼–è¯‘ï¼š1cd $&#123;GOPATH&#125;/src/github.com/&#123;user&#125;/countbeaté’ˆå¯¹æˆ‘çš„æƒ…å†µï¼š1cd $&#123;GOPATH&#125;/src/github.com/liu-xiao-guo/countbeatæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹é‡Œé¢æœ€åŸºæœ¬çš„æ–‡ä»¶ï¼š1234567891011$ pwd/Users/liuxg/go/beats/src/github.com/liu-xiao-guo/countbeatliuxg-2:countbeat liuxg$ lsCONTRIBUTING.md cmd magefile.goLICENSE.txt config main.goMakefile countbeat.docker.yml main_test.goNOTICE.txt countbeat.reference.yml make.batREADME.md countbeat.yml tests_meta docs vendorbeater fields.ymlbuild includeè¿™é‡Œæœ‰æœ€åŸºæœ¬çš„æ¡†æž¶æ–‡ä»¶ã€‚é‡Œé¢å«æœ‰ä¸€ä¸ªå«åšcountbeat.ymlçš„é…ç½®æ–‡ä»¶åŠä¸€äº›æ ‡å‡†çš„æ¨¡æ¿æ–‡ä»¶ã€‚æˆ‘ä»¬åœ¨å‘½ä»¤è¡Œä¸­ç›´æŽ¥æ‰“å…¥å¦‚ä¸‹çš„æŒ‡ä»¤ï¼š1234make $ make go build -i -ldflags &quot;-X github.com/liu-xiao-guo/countbeat/vendor/github.com/elastic/beats/libbeat/version.buildTime=2019-11-13T07:33:25Z -X github.com/liu-xiao-guo/countbeat/vendor/github.com/elastic/beats/libbeat/version.commit=501bd87da668346f78398676c78b4a39394a3640&quot;ç»è¿‡ä¸Šé¢çš„ç¼–è¯‘ï¼Œæˆ‘ä»¬å¯ä»¥å‘çŽ°åœ¨å½“å‰çš„ç›®å½•ä¸‹ï¼Œæœ‰ä¸€ä¸ªå·²ç»ç¼–è¯‘å¥½çš„countbeatå¯æ‰§è¡Œæ–‡ä»¶ï¼šæˆ‘ä»¬åœ¨å½“å‰çš„ç›®å½•ä¸‹ç›´æŽ¥è¿è¡Œè¿™ä¸ªå¯æ‰§è¡Œçš„æ–‡ä»¶ï¼š1./countbeat -e -d &quot;*&quot;æˆ‘ä»¬å¯ä»¥åœ¨terminalä¸­çœ‹åˆ°ï¼šé‚£ä¹ˆåœ¨æˆ‘ä»¬çš„Kibanaä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼šæ˜¾ç„¶æ•°æ®å·²ç»è¢«æˆåŠŸä¸Šä¼ åˆ°Elasticsearchä¸­äº†ã€‚æ¯ä¸€ä¸ªæ–‡æ¡£çš„å†…å®¹å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829&#123; &quot;@timestamp&quot;: &quot;2019-11-13T07:38:57.095Z&quot;, &quot;agent&quot;: &#123; &quot;version&quot;: &quot;8.0.0&quot;, &quot;type&quot;: &quot;countbeat&quot;, &quot;ephemeral_id&quot;: &quot;d3f0638e-ee58-45ff-92cc-74f188fd66a4&quot;, &quot;hostname&quot;: &quot;liuxg-2.local&quot;, &quot;id&quot;: &quot;1d35220e-7f75-442a-88eb-43ec1e97f0d0&quot; &#125;, &quot;counter&quot;: 5, &quot;ecs&quot;: &#123; &quot;version&quot;: &quot;1.2.0&quot; &#125;, &quot;host&quot;: &#123; &quot;hostname&quot;: &quot;liuxg-2.local&quot;, &quot;architecture&quot;: &quot;x86_64&quot;, &quot;os&quot;: &#123; &quot;build&quot;: &quot;19B88&quot;, &quot;platform&quot;: &quot;darwin&quot;, &quot;version&quot;: &quot;10.15.1&quot;, &quot;family&quot;: &quot;darwin&quot;, &quot;name&quot;: &quot;Mac OS X&quot;, &quot;kernel&quot;: &quot;19.0.0&quot; &#125;, &quot;id&quot;: &quot;E51545F1-4BDC-5890-B194-83D23620325A&quot;, &quot;name&quot;: &quot;liuxg-2.local&quot; &#125;, &quot;type&quot;: &quot;liuxg-2.local&quot;&#125;å®ƒé‡Œé¢å«æœ‰ä¸€ä¸ªcounterçš„æ•´æ•°å€¼ã€‚æ‰€æœ‰å…³äºŽbeatçš„è®¾è®¡ä¸Šçš„ä»£ç å¯ä»¥åœ¨ç›®å½•${GOPATH}/src/github.com/liu-xiao-guo/countbeatä¸‹çš„/beater/CountBeat.goæ–‡ä»¶é‡Œå®žçŽ°çš„ã€‚è®¾è®¡æ¯”è¾ƒç›´æŽ¥ã€‚å¤§å®¶å¯ä»¥çœ‹ä¸€ä¸‹ä»£ç åº”è¯¥å¯ä»¥æ˜Žç™½ã€‚è¯»å–JSONæ–‡ä»¶beatåœ¨ä¸Šé¢æˆ‘ä»¬å·²ç»ç†Ÿæ‚‰äº†å¦‚ä½•åŽ»åˆ›å»ºä¸€ä¸ªtemplateçš„beatã€‚å®ƒæ˜¯ä¸€ä¸ªæœ€åŸºæœ¬çš„beatï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„åŠŸèƒ½ã€‚åœ¨è¿™èŠ‚é‡Œï¼Œæˆ‘ä»¬æŽ¥ç€å¦‚æ³•ç‚®åˆ¶æ¥åˆ›å»ºä¸€ä¸ªç¨å¾®æœ‰ä¸€ç‚¹ç”¨é€”çš„beatã€‚æˆ‘ä»¬çš„è¿™ä¸ªbeatå«åšreadjson beatã€‚å®ƒçš„æºç å¯ä»¥æŒ‰ç…§å¦‚ä¸‹çš„æ–¹æ³•å¾—åˆ°ï¼š1git clone https://github.com/liu-xiao-guo/beats-readjsoné¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥å‡†å¤‡ä¸€ä¸ªæˆ‘ä»¬æƒ³è¦çš„jsonæ–‡ä»¶ï¼Œæ¯”å¦‚ï¼š123456789101112131415161718192021222324users.json &#123; &quot;users&quot;: [ &#123; &quot;name&quot;: &quot;Elliot&quot;, &quot;type&quot;: &quot;Reader&quot;, &quot;age&quot;: 23, &quot;social&quot;: &#123; &quot;facebook&quot;: &quot;https://facebook.com&quot;, &quot;twitter&quot;: &quot;https://twitter.com&quot; &#125; &#125;, &#123; &quot;name&quot;: &quot;Fraser&quot;, &quot;type&quot;: &quot;Author&quot;, &quot;age&quot;: 17, &quot;social&quot;: &#123; &quot;facebook&quot;: &quot;https://facebook.com&quot;, &quot;twitter&quot;: &quot;https://twitter.com&quot; &#125; &#125; ] &#125;æˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªæ–‡ä»¶æ”¾å…¥åˆ°æˆ‘ä»¬å¦‚ä½•å–œæ¬¢çš„ä½ç½®ã€‚é’ˆå¯¹æˆ‘çš„æƒ…å†µï¼Œæˆ‘æŠŠå®ƒç½®äºŽæˆ‘çš„ç”µè„‘çš„å¦‚ä¸‹ä½ç½®ï¼š1/Users/liuxg/data/beats/users.jsonæˆ‘ä»¬å¯ä»¥åœ¨readjson.ymlæ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ï¼š1readjson.ymlæˆ‘ä»¬çš„readjson.goè®¾è®¡ä¹Ÿç›¸å½“ç®€å•ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135readjson.go package beater import ( &quot;fmt&quot; &quot;os&quot; &quot;io/ioutil&quot; &quot;encoding/json&quot; &quot;strconv&quot; &quot;time&quot; &quot;os/signal&quot; &quot;syscall&quot; &quot;github.com/elastic/beats/libbeat/beat&quot; &quot;github.com/elastic/beats/libbeat/common&quot; &quot;github.com/elastic/beats/libbeat/logp&quot; &quot;github.com/liu-xiao-guo/readjson/config&quot; ) type Users struct &#123; Users []User `json:&quot;users&quot;` &#125; // User struct which contains a name // a type and a list of social links type User struct &#123; Name string `json:&quot;name&quot;` Type string `json:&quot;type&quot;` Age int `json:&quot;Age&quot;` Social Social `json:&quot;social&quot;` &#125; // Social struct which contains a // list of links type Social struct &#123; Facebook string `json:&quot;facebook&quot;` Twitter string `json:&quot;twitter&quot;` &#125; // readjson configuration. type readjson struct &#123; done chan struct&#123;&#125; config config.Config client beat.Client &#125; // New creates an instance of readjson. func New(b *beat.Beat, cfg *common.Config) (beat.Beater, error) &#123; c := config.DefaultConfig if err := cfg.Unpack(&amp;c); err != nil &#123; return nil, fmt.Errorf(&quot;Error reading config file: %v&quot;, err) &#125; bt := &amp;readjson&#123; done: make(chan struct&#123;&#125;), config: c, &#125; return bt, nil &#125; // Run starts readjson. func (bt *readjson) Run(b *beat.Beat) error &#123; logp.Info(&quot;readjson is running! Hit CTRL-C to stop it.&quot;) var err error bt.client, err = b.Publisher.Connect() if err != nil &#123; return err &#125; fmt.Println(&quot;Path: &quot;, bt.config.Path) fmt.Println(&quot;Period: &quot;, bt.config.Period) // Open our jsonFile jsonFile, err := os.Open(bt.config.Path) // if we os.Open returns an error then handle it if err != nil &#123; fmt.Println(err) &#125; fmt.Println(&quot;Successfully Opened users.json&quot;) // defer the closing of our jsonFile so that we can parse it later on defer jsonFile.Close() byteValue, _ := ioutil.ReadAll(jsonFile) // we initialize our Users array var users Users json.Unmarshal(byteValue, &amp;users) // we iterate through every user within our users array and // print out the user Type, their name, and their facebook url // as just an example for i := 0; i &lt; len(users.Users); i++ &#123; fmt.Println(&quot;User Type: &quot; + users.Users[i].Type) fmt.Println(&quot;User Age: &quot; + strconv.Itoa(users.Users[i].Age)) fmt.Println(&quot;User Name: &quot; + users.Users[i].Name) fmt.Println(&quot;Facebook Url: &quot; + users.Users[i].Social.Facebook) event := beat.Event&#123; Timestamp: time.Now(), Fields: common.MapStr &#123; &quot;ostype&quot;: b.Info.Name, &quot;name&quot;: users.Users[i].Name, &quot;type&quot;: users.Users[i].Type, &quot;age&quot;: users.Users[i].Age, &quot;social&quot;: users.Users[i].Social, &#125;, &#125; bt.client.Publish(event) &#125; c := make(chan os.Signal) signal.Notify(c, os.Interrupt, syscall.SIGTERM) go func() &#123; &lt;-c os.Exit(1) &#125;() for &#123; fmt.Println(&quot;sleeping...&quot;) time.Sleep(10 * time.Second) &#125; &#125; // Stop stops readjson. func (bt *readjson) Stop() &#123; bt.client.Close() close(bt.done) &#125;å®ƒåœ¨run methodé‡ŒæŠŠjsonæ–‡ä»¶è¯»å…¥ï¼Œå¹¶æŠŠå®ƒä»¬åˆ†åˆ«å‘é€å‡ºåŽ»åˆ°æˆ‘ä»¬çš„Elasticsearchä¸­ã€‚æˆ‘ä»¬æŒ‰ç…§ä¸Šé¢çš„æ­¥éª¤è¿›è¡Œç¼–è¯‘ï¼Œå¹¶æœ€ç»ˆè¿è¡Œæˆ‘ä»¬çš„readjson beatã€‚1./readjson -eæˆ‘ä»¬å¯ä»¥åœ¨Kibanaä¸­çœ‹åˆ°æˆ‘ä»¬å·²ç»å‘é€ä¸Šæ¥çš„beatä¿¡æ¯ï¼šå‚è€ƒï¼šã€1ã€‘https://www.elastic.co/guide/en/beats/devguide/7.5/newbeat-generate.html]]></content>
  </entry>
  <entry>
    <title></title>
    <url>%2F2020%2F01%2F02%2FBeats%EF%BC%9ABeats%E5%9C%A8Kibana%E4%B8%AD%E7%9A%84%E9%9B%86%E4%B8%AD%E7%AE%A1%E7%90%86%2F</url>
    <content type="text"><![CDATA[æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨å‘½ä»¤è¡Œä¸­å¯¹æˆ‘ä»¬çš„Beatsè¿›è¡Œç®¡ç†ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥å¯åŠ¨metricå‡ ä¸ªæ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥æ‰§è¡Œï¼š1./metricbeat modules enable apache mysqlä¸Šé¢çš„å‘½ä»¤å¯åŠ¨apache mysqlæ¨¡å—ã€‚æˆ‘ä»¬ä¹Ÿè®¸è§‰å¾—è¿™ä¸ªè¿™æ ·åšå¾ˆæ–¹ä¾¿ã€‚ä½†æ˜¯å¦‚æžœæˆ‘ç›¸å¯¹è®¸å¤šçš„æœºå™¨ï¼ˆæ¯”å¦‚å‡ åƒéƒ¨æœºå™¨ï¼‰æ¥åšè¿™æ ·çš„ç®¡ç†ï¼Œå¯èƒ½ä¹Ÿå¾ˆéº»çƒ¦ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬éœ€è¦åˆ°æ¯ä¸€å°æœºå™¨ä¸Šé‡å¤åšåŒæ ·çš„åŠ¨ä½œã€‚å¦‚æžœæˆ‘ä»¬éœ€è¦æœ‰æ”¹åŠ¨çš„è¯ï¼Œé‚£ä¹ˆéœ€è¦å¯¹æ¯ä¸€å°æœºå™¨å†æ¬¡æ‰§è¡ŒåŒæ ·çš„æ“ä½œã€‚é‚£ä¹ˆæœ‰ä»€ä¹ˆåŠžæ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬å‡å°‘è¿™ä¸ªå·¥ä½œé‡å‘¢ï¼ŸElasticåœ¨Kibanaä¸­åšè¿›åŽ»ä¸€ä¸ªæ–°çš„åŠŸèƒ½ï¼šé›†ä¸­ç®¡ç†ã€‚Beatsä¸­å¤®ç®¡ç†ä½¿ç”¨ä¸€ç§ç§°ä¸ºé…ç½®æ ‡ç­¾çš„æœºåˆ¶æ¥å¯¹ç›¸å…³é…ç½®è¿›è¡Œåˆ†ç»„ã€‚ æ³¨å†Œç¬¬ä¸€ä¸ªBeatåŽï¼Œæ‚¨å¯ä»¥åœ¨Kibanaçš„ä¸­å¤®ç®¡ç†UIä¸­å®šä¹‰é…ç½®æ ‡ç­¾ã€‚Beatsé›†ä¸­ç®¡ç†æ˜¯6.5ç‰ˆå¸¦æ¥çš„åŠŸèƒ½ã€‚ å‡ºäºŽå®‰å…¨è€ƒè™‘ï¼Œæ­¤åŠŸèƒ½åœ¨Elastic Goldè®¸å¯è¯æˆ–ä½¿ç”¨æˆ‘ä»¬çš„Elastic CloudæœåŠ¡çš„Standardè®¸å¯è¯ä¸‹å¯ç”¨ï¼Œä»¥ç¡®ä¿æ­£ç¡®ä¿æŠ¤éƒ¨ç½²ã€‚ å®ƒåŒ…å«Kibanaä¸­æ–°çš„Beatsä¸­å¤®ç®¡ç†UIï¼Œå¹¶åˆ©ç”¨Elasticsearchä½œä¸ºé›†ä¸­å¼é…ç½®å­˜å‚¨ã€‚ åœ¨ä¸ä¹…çš„å°†æ¥ï¼Œæˆ‘ä»¬è¿˜è®¡åˆ’å…¬å¼€ä¸€ä¸ªAPIï¼Œä»¥ä¾¿æ›´è½»æ¾åœ°ä¸Žå¤–éƒ¨å·¥å…·å’Œç³»ç»Ÿé›†æˆã€‚ä¸‹é¢æˆ‘æ¥å±•ç¤ºå¦‚ä½•ä½¿ç”¨Beatsçš„é›†ä¸­ç®¡ç†ã€‚å‡†å¤‡å·¥ä½œå°±åƒæˆ‘ä¸Šé¢æåˆ°çš„ï¼Œæˆ‘ä»¬å¿…é¡»è´­ä¹°Elastic Goldæ‰å¯ä»¥æ‹¥æœ‰è¿™æ ·çš„åŠŸèƒ½ã€‚ä¸ºäº†æµ‹è¯•è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥æŽ¥å—30å¤©å°è¯•ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æˆ‘ä»¬çš„æµ‹è¯•äº†ã€‚æˆ‘ä»¬é¦–å…ˆç‚¹å‡»Kibanaä¸­çš„Managementï¼Œè®©åŽé€‰æ‹©30å¤©å°è¯•ã€‚å½“æˆ‘ä»¬æŽ¥å—å®Œæ¡ä»¶åŽï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼šå¤§å®¶ä¸€å®šå¯ä»¥çœ‹åˆ°å·¦è¾¹çš„åˆ—è¡¨ä¼šå¤šäº†ä¸€ä¸ªå«åšBeatsçš„ç§ç±»ï¼Œå¹¶åœ¨å…¶ä¸‹é¢æœ‰ä¸€ä¸ªå«åšCentral Managementçš„é¡¹ã€‚æˆ‘ä»¬ç‚¹å‡»Central Managementï¼šå®ƒæ˜¾ç¤ºæˆ‘ä»¬çš„å®‰å…¨æ²¡æœ‰æ‰“å¼€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªåŠŸèƒ½å¿…é¡»é…åˆå®‰å…¨åŠŸèƒ½æ‰èƒ½å¯ç”¨ã€‚æˆ‘ä»¬å‚ç…§æˆ‘ä¹‹å‰çš„æ–‡ç« â€œElasticsearchï¼šè®¾ç½®Elasticè´¦æˆ·å®‰å…¨â€æ¥å¯åŠ¨å®‰å…¨åŠŸèƒ½ã€‚æˆ‘ä»¬ä½¿ç”¨elasticè´¦å·è¿›è¡Œç™»å½•ï¼šæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå¯¹è¯æ¡†ï¼Œæç¤ºæˆ‘ä»¬Enroll Beatã€‚ç‚¹å‡»è¿™ä¸ªæŒ‰é’®ã€‚ç›®å‰æˆ‘ä»¬çœ‹åˆ°æœ‰ä¸¤ä¸ªBeatsï¼šFilebeatåŠMetricbeatå¯ä»¥ä¾›æˆ‘ä»¬æ¥é€‰æ‹©ã€‚æˆ‘ä»¬æ¥é€‰æ‹©Metricbeatæ¥åšä¸€äº›å®žéªŒã€‚åŒæ—¶åœ¨Platformä¸­é€‰æ‹©è‡ªå·±å–œæ¬¢çš„å¹³å°ï¼šé’ˆå¯¹æˆ‘ä»¬çš„æƒ…å†µï¼Œæˆ‘é€‰æ‹©MacOSã€‚ç”±äºŽéœ€è¦ä½¿ç”¨åˆ°Metricbeatï¼Œéœ€è¦å®‰è£…æˆ‘ä»¬çš„Metribeatã€‚åŒæ—¶åœ¨æˆ‘ä»¬çš„Terminalä¸­æ‰“å…¥ä»ŽCopy Commandå¤„æ‹·è´æ¥çš„å‘½ä»¤ï¼šè¿™ä¸ªæ—¶å€™åœ¨æˆ‘ä»¬çš„Kibanaä¸­ä¼šæ˜¾ç¤ºï¼šåœ¨ä¸Šé¢æ˜¾ç¤ºäº†æˆ‘çš„hostnameä»¥åŠmetricbeatçš„ç‰ˆæœ¬ä¿¡æ¯ã€‚æˆ‘ä»¬æŽ¥ä¸‹æ¥é€‰æ‹©ContinueæŒ‰é’®ï¼šæˆ‘ä»¬å¯ä»¥é€‰ä¸€ä¸ªæˆ‘ä»¬å–œæ¬¢çš„Tag Nameå’Œè‡ªå·±å–œæ¬¢çš„é¢œè‰²ã€‚åœ¨ä¸Šé¢æˆ‘é€‰æ‹©äº†Localè¡¨æ˜Žæˆ‘çš„è¿™ä¸ªMetricbeatæ˜¯åœ¨æœ¬åœ°è¿è¡Œçš„ã€‚è¿™æ ·ä»¥åŽæˆ‘ä»¬èƒ½å¾ˆå®¹æ˜“åœ°æ‰¾åˆ°æˆ‘ä»¬çš„è¿™ä¸ªæœºå™¨çš„é…ç½®ã€‚æˆ‘ä»¬ç‚¹å‡»Add configuration blockæŒ‰é’®ï¼šæˆ‘ä»¬å¯ä»¥é€‰æ‹©æˆ‘ä»¬çš„æ¨¡å—ï¼Œå¹¶é€‰æ‹©å–œæ¬¢é¢moduleã€‚æœ€åŽé€‰æ‹©SaveæŒ‰é’®ã€‚å†æŽ¥ç€é€‰æ‹©Save &amp; ContinueæŒ‰é’®ï¼šæœ€ç»ˆæˆ‘ä»¬å®Œæˆäº†ï¼šåœ¨ä¸Šé¢çš„ç”»é¢ä¸­é€‰æ‹©Doneï¼šæˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥æˆ‘ä»¬å·²ç»æˆåŠŸåœ°é…ç½®å¥½æˆ‘ä»¬çš„Metricbeatæ¨¡å—äº†ã€‚ä¸Šé¢æ˜¾ç¤ºConfig Statusæ˜¯OfflineçŠ¶æ€ã€‚æˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬çš„Terminalä¸­æ‰“å…¥å¦‚ä¸‹çš„å‘½ä»¤ï¼ˆåœ¨Metricbeatçš„å®‰è£…ç›®å½•ä¸­ï¼‰ï¼š1./metricbeat runæˆ‘ä»¬å†é‡æ–°åˆ·æ–°æˆ‘ä»¬çš„Kibanaç•Œé¢ï¼šä»Žä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥æˆ‘ä»¬çš„metricbeatå·²ç»åœ¨æˆåŠŸè¿è¡Œäº†ã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰¾åˆ°ç›¸åº”çš„indexã€‚æŒ‰ç…§åŒæ ·çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å…¶å®ƒçš„æ¨¡å—æ¥è¿›è¡Œé…ç½®ã€‚æˆ‘ä»¬æŽ¥ä¸‹æ¥éœ€è¦ç‚¹å‡»æˆ‘ä»¬çš„Tagsæ¥æ·»åŠ æˆ–é…ç½®æˆ‘ä»¬çš„Beats:æˆ‘ä»¬å¯ä»¥ç‚¹å‡»Add configuration blockæ¥æ·»åŠ åŒä¸€ä¸ªBeatæ¨¡å—é‡Œçš„å…¶å®ƒæ¨¡å—ï¼Œæˆ–è€…å¢žåŠ ä¸€ä¸ªè¾“å‡ºåˆ°Elasticsearchï¼šé’ˆå¯¹ä½ çš„è®¾ç½®ä½ éœ€è¦ä¿®ä¸ªè¿™ä¸ªhostsçš„åœ°å€ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬çš„filebeatçš„è¾“å‡ºå°±ä¼šå‘é€åˆ°æˆ‘ä»¬çš„Elasticsearchä¸­äº†ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‰ç…§åŒæ ·çš„æ–¹æ³•æ¥æ·»åŠ å¦å¤–ä¸€ä¸ªmoduleã€‚å‚è€ƒï¼šã€1ã€‘https://www.elastic.co/guide/en/beats/filebeat/current/how-central-managment-works.htmlã€2ã€‘https://www.elastic.co/blog/introducing-beats-central-management-in-the-elastic-stack]]></content>
  </entry>
  <entry>
    <title><![CDATA[å¦‚ä½•ä½¿ç”¨Elasticsearchä¸­çš„copy_toæ¥æé«˜æœç´¢æ•ˆçŽ‡]]></title>
    <url>%2F2020%2F01%2F02%2F%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8Elasticsearch%E4%B8%AD%E7%9A%84copy_to%E6%9D%A5%E6%8F%90%E9%AB%98%E6%90%9C%E7%B4%A2%E6%95%88%E7%8E%87%2F</url>
    <content type="text"><![CDATA[åœ¨ä»Šå¤©çš„è¿™ä¸ªæ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ¥ç€é‡è®²è§£ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨Elasticsearchä¸­çš„copyæ¥æé«˜æœç´¢çš„æ•ˆçŽ‡ã€‚æ¯”å¦‚åœ¨æˆ‘ä»¬çš„æœç´¢ä¸­ï¼Œç»å¸¸æˆ‘ä»¬ä¼šé‡åˆ°å¦‚ä¸‹çš„æ–‡æ¡£ï¼š1234567891011121314&#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125;&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨è¿™ä¸ªæ–‡æ¡£ä¸­ï¼Œæˆ‘ä»¬æœ‰è¿™æ ·çš„å‡ ä¸ªå­—æ®µï¼š123&quot;city&quot; : &quot;åŒ—äº¬&quot;,&quot;province&quot; : &quot;åŒ—äº¬&quot;,&quot;country&quot; : &quot;ä¸­å›½&quot;,å®ƒä»¬æ˜¯éžå¸¸ç›¸å…³çš„ã€‚æˆ‘ä»¬åœ¨æƒ³æ˜¯ä¸æ˜¯å¯ä»¥æŠŠå®ƒä»¬ç»¼åˆæˆä¸€ä¸ªå­—æ®µï¼Œè¿™æ ·å¯ä»¥æ–¹ä¾¿æˆ‘ä»¬çš„æœç´¢ã€‚å‡å¦‚æˆ‘ä»¬è¦ç»å¸¸å¯¹è¿™ä¸‰ä¸ªå­—æ®µè¿›è¡Œæœç´¢ï¼Œé‚£ä¹ˆä¸€ç§æ–¹æ³•æˆ‘ä»¬å¯ä»¥åœ¨mustå­å¥ä¸­ä½¿ç”¨shouldå­å¥è¿è¡ŒboolæŸ¥è¯¢ã€‚è¿™ç§æ–¹æ³•å†™èµ·æ¥æ¯”è¾ƒéº»çƒ¦ã€‚æœ‰æ²¡æœ‰ä¸€ç§æ›´å¥½çš„æ–¹æ³•å‘¢ï¼Ÿæˆ‘ä»¬å…¶å®žå¯ä»¥ä½¿ç”¨Elasticsearchæ‰€æä¾›çš„copy_toæ¥æé«˜æˆ‘ä»¬çš„æœç´¢æ•ˆçŽ‡ã€‚æˆ‘ä»¬å¯ä»¥é¦–å…ˆæŠŠæˆ‘ä»¬çš„indexçš„mappingè®¾ç½®æˆå¦‚ä¸‹çš„é¡¹ï¼ˆè¿™é‡Œå‡è®¾æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ä¸€ä¸ªå«åštwitterçš„index)ã€‚1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859PUT twitter&#123; &quot;mappings&quot;: &#123; &quot;properties&quot;: &#123; &quot;address&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125;, &quot;age&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;city&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;copy_to&quot;: &quot;region&quot; &#125;, &quot;country&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;copy_to&quot;: &quot;region&quot; &#125;, &quot;province&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;copy_to&quot;: &quot;region&quot; &#125;, &quot;region&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;store&quot;: true &#125;, &quot;location&quot;: &#123; &quot;type&quot;: &quot;geo_point&quot; &#125;, &quot;message&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125;, &quot;uid&quot;: &#123; &quot;type&quot;: &quot;long&quot; &#125;, &quot;user&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;fields&quot;: &#123; &quot;keyword&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;ignore_above&quot;: 256 &#125; &#125; &#125; &#125; &#125;&#125;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ç‰¹åˆ«æ³¨æ„å¦‚ä¸‹çš„è¿™ä¸ªéƒ¨åˆ†ï¼š123456789101112131415&quot;city&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;copy_to&quot;: &quot;region&quot;&#125;,&quot;country&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;copy_to&quot;: &quot;region&quot; &#125;,&quot;province&quot;: &#123; &quot;type&quot;: &quot;keyword&quot;, &quot;copy_to&quot;: &quot;region&quot;&#125;,&quot;region&quot;: &#123; &quot;type&quot;: &quot;text&quot;&#125;æˆ‘ä»¬æŠŠcity, countryåŠprovinceä¸‰ä¸ªé¡¹åˆå¹¶æˆä¸ºä¸€ä¸ªé¡¹regionï¼Œä½†æ˜¯è¿™ä¸ªregionå¹¶ä¸å­˜åœ¨äºŽæˆ‘ä»¬æ–‡æ¡£çš„sourceé‡Œã€‚å½“æˆ‘ä»¬è¿™ä¹ˆå®šä¹‰æˆ‘ä»¬çš„mappingçš„è¯ï¼Œåœ¨æ–‡æ¡£è¢«ç´¢å¼•ä¹‹åŽï¼Œæœ‰ä¸€ä¸ªæ–°çš„regioné¡¹å¯ä»¥ä¾›æˆ‘ä»¬è¿›è¡Œæœç´¢ã€‚æˆ‘ä»¬å¯ä»¥é‡‡ç”¨å¦‚ä¸‹çš„æ•°æ®æ¥è¿›è¡Œå±•ç¤ºï¼š12345678910111213POST _bulk&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 1&#125; &#125;&#123;&quot;user&quot;:&quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;,&quot;message&quot;:&quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;,&quot;uid&quot;:2,&quot;age&quot;:20,&quot;city&quot;:&quot;åŒ—äº¬&quot;,&quot;province&quot;:&quot;åŒ—äº¬&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;39.970718&quot;,&quot;lon&quot;:&quot;116.325747&quot;&#125;&#125;&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 2 &#125;&#125;&#123;&quot;user&quot;:&quot;ä¸œåŸŽåŒº-è€åˆ˜&quot;,&quot;message&quot;:&quot;å‡ºå‘ï¼Œä¸‹ä¸€ç«™äº‘å—ï¼&quot;,&quot;uid&quot;:3,&quot;age&quot;:30,&quot;city&quot;:&quot;åŒ—äº¬&quot;,&quot;province&quot;:&quot;åŒ—äº¬&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½åŒ—äº¬å¸‚ä¸œåŸŽåŒºå°åŸºåŽ‚ä¸‰æ¡3å·&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;39.904313&quot;,&quot;lon&quot;:&quot;116.412754&quot;&#125;&#125;&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 3&#125; &#125;&#123;&quot;user&quot;:&quot;ä¸œåŸŽåŒº-æŽå››&quot;,&quot;message&quot;:&quot;happy birthday!&quot;,&quot;uid&quot;:4,&quot;age&quot;:30,&quot;city&quot;:&quot;åŒ—äº¬&quot;,&quot;province&quot;:&quot;åŒ—äº¬&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½åŒ—äº¬å¸‚ä¸œåŸŽåŒº&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;39.893801&quot;,&quot;lon&quot;:&quot;116.408986&quot;&#125;&#125;&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 4&#125; &#125;&#123;&quot;user&quot;:&quot;æœé˜³åŒº-è€è´¾&quot;,&quot;message&quot;:&quot;123,gogogo&quot;,&quot;uid&quot;:5,&quot;age&quot;:35,&quot;city&quot;:&quot;åŒ—äº¬&quot;,&quot;province&quot;:&quot;åŒ—äº¬&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½åŒ—äº¬å¸‚æœé˜³åŒºå»ºå›½é—¨&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;39.718256&quot;,&quot;lon&quot;:&quot;116.367910&quot;&#125;&#125;&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 5&#125; &#125;&#123;&quot;user&quot;:&quot;æœé˜³åŒº-è€çŽ‹&quot;,&quot;message&quot;:&quot;Happy BirthDay My Friend!&quot;,&quot;uid&quot;:6,&quot;age&quot;:50,&quot;city&quot;:&quot;åŒ—äº¬&quot;,&quot;province&quot;:&quot;åŒ—äº¬&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½åŒ—äº¬å¸‚æœé˜³åŒºå›½è´¸&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;39.918256&quot;,&quot;lon&quot;:&quot;116.467910&quot;&#125;&#125;&#123; &quot;index&quot; : &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_id&quot;: 6&#125; &#125;&#123;&quot;user&quot;:&quot;è™¹æ¡¥-è€å´&quot;,&quot;message&quot;:&quot;å¥½å‹æ¥äº†éƒ½ä»Šå¤©æˆ‘ç”Ÿæ—¥ï¼Œå¥½å‹æ¥äº†,ä»€ä¹ˆ birthday happy å°±æˆ!&quot;,&quot;uid&quot;:7,&quot;age&quot;:90,&quot;city&quot;:&quot;ä¸Šæµ·&quot;,&quot;province&quot;:&quot;ä¸Šæµ·&quot;,&quot;country&quot;:&quot;ä¸­å›½&quot;,&quot;address&quot;:&quot;ä¸­å›½ä¸Šæµ·å¸‚é—µè¡ŒåŒº&quot;,&quot;location&quot;:&#123;&quot;lat&quot;:&quot;31.175927&quot;,&quot;lon&quot;:&quot;121.383328&quot;&#125;&#125;åœ¨Kibnanaä¸­æ‰§è¡Œä¸Šé¢çš„è¯­å¥ï¼Œå®ƒå°†ä¸ºæˆ‘ä»¬ç”Ÿäº§æˆ‘ä»¬çš„twitterç´¢å¼•ã€‚åŒæ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„è¯­å¥æ¥æŸ¥è¯¢æˆ‘ä»¬çš„mapping:æˆ‘ä»¬å¯ä»¥çœ‹åˆ°twitterçš„mappingä¸­æœ‰ä¸€ä¸ªæ–°çš„è¢«ç§°ä½œä¸ºregionçš„é¡¹ã€‚å®ƒå°†ä¸ºæˆ‘ä»¬çš„æœç´¢å¸¦æ¥æ–¹ä¾¿ã€‚é‚£ä¹ˆå‡å¦‚æˆ‘ä»¬æƒ³æœç´¢country:ä¸­å›½ï¼Œprovince:åŒ—äº¬ è¿™æ ·çš„è®°å½•çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥åªå†™å¦‚ä¸‹çš„ä¸€æ¡è¯­å¥å°±å¯ä»¥äº†ï¼š1234567891011GET twitter/_search &#123; &quot;query&quot;: &#123; &quot;match&quot;: &#123; &quot;region&quot;: &#123; &quot;query&quot;: &quot;ä¸­å›½ åŒ—äº¬&quot;, &quot;minimum_should_match&quot;: 4 &#125; &#125; &#125;&#125;ä¸‹é¢æ˜¾ç¤ºçš„æ˜¯æœç´¢çš„ç»“æžœï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119&#123; &quot;took&quot; : 0, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 5, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 0.8114117, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 0.8114117, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;åŒæ¦†æ ‘-å¼ ä¸‰&quot;, &quot;message&quot; : &quot;ä»Šå„¿å¤©æ°”ä¸é”™å•Šï¼Œå‡ºåŽ»è½¬è½¬åŽ»&quot;, &quot;uid&quot; : 2, &quot;age&quot; : 20, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒº&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.970718&quot;, &quot;lon&quot; : &quot;116.325747&quot; &#125; &#125; &#125;, &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;2&quot;, &quot;_score&quot; : 0.8114117, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;ä¸œåŸŽåŒº-è€åˆ˜&quot;, &quot;message&quot; : &quot;å‡ºå‘ï¼Œä¸‹ä¸€ç«™äº‘å—ï¼&quot;, &quot;uid&quot; : 3, &quot;age&quot; : 30, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚ä¸œåŸŽåŒºå°åŸºåŽ‚ä¸‰æ¡3å·&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.904313&quot;, &quot;lon&quot; : &quot;116.412754&quot; &#125; &#125; &#125;, &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;3&quot;, &quot;_score&quot; : 0.8114117, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;ä¸œåŸŽåŒº-æŽå››&quot;, &quot;message&quot; : &quot;happy birthday!&quot;, &quot;uid&quot; : 4, &quot;age&quot; : 30, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚ä¸œåŸŽåŒº&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.893801&quot;, &quot;lon&quot; : &quot;116.408986&quot; &#125; &#125; &#125;, &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;4&quot;, &quot;_score&quot; : 0.8114117, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;æœé˜³åŒº-è€è´¾&quot;, &quot;message&quot; : &quot;123,gogogo&quot;, &quot;uid&quot; : 5, &quot;age&quot; : 35, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æœé˜³åŒºå»ºå›½é—¨&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.718256&quot;, &quot;lon&quot; : &quot;116.367910&quot; &#125; &#125; &#125;, &#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;5&quot;, &quot;_score&quot; : 0.8114117, &quot;_source&quot; : &#123; &quot;user&quot; : &quot;æœé˜³åŒº-è€çŽ‹&quot;, &quot;message&quot; : &quot;Happy BirthDay My Friend!&quot;, &quot;uid&quot; : 6, &quot;age&quot; : 50, &quot;city&quot; : &quot;åŒ—äº¬&quot;, &quot;province&quot; : &quot;åŒ—äº¬&quot;, &quot;country&quot; : &quot;ä¸­å›½&quot;, &quot;address&quot; : &quot;ä¸­å›½åŒ—äº¬å¸‚æœé˜³åŒºå›½è´¸&quot;, &quot;location&quot; : &#123; &quot;lat&quot; : &quot;39.918256&quot;, &quot;lon&quot; : &quot;116.467910&quot; &#125; &#125; &#125; ] &#125;&#125;è¿™æ ·æˆ‘ä»¬åªå¯¹ä¸€ä¸ªregionè¿›è¡Œæ“ä½œå°±å¯ä»¥äº†ï¼Œå¦åˆ™æˆ‘ä»¬éœ€è¦é’ˆå¯¹country, cityåŠprovinceåˆ†åˆ«è¿›è¡Œæœç´¢ã€‚å¦‚ä½•æŸ¥çœ‹copy_toçš„å†…å®¹åœ¨ä¹‹å‰çš„mappingä¸­ï¼Œæˆ‘ä»¬å¯¹regionå­—æ®µåŠ å…¥äº†å¦‚ä¸‹çš„ä¸€ä¸ªå±žæ€§ï¼š1234&quot;region&quot;: &#123; &quot;type&quot;: &quot;text&quot;, &quot;store&quot;: true&#125;è¿™é‡Œçš„storeå±žæ€§ä¸ºtrueï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å‘½ä»¤æ¥æŸ¥çœ‹æ–‡æ¡£çš„regionçš„å†…å®¹ï¼š1GET twitter/_doc/1?stored_fields=regioné‚£ä¹ˆå®ƒæ˜¾ç¤ºçš„å†…å®¹å¦‚ä¸‹ï¼š12345678910111213141516&#123; &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_version&quot; : 1, &quot;_seq_no&quot; : 0, &quot;_primary_term&quot; : 1, &quot;found&quot; : true, &quot;fields&quot; : &#123; &quot;region&quot; : [ &quot;åŒ—äº¬&quot;, &quot;åŒ—äº¬&quot;, &quot;ä¸­å›½&quot; ] &#125;&#125;å¦‚æžœä½ æƒ³äº†è§£æ›´å¤šå…³äºŽElastic Stackï¼Œè¯·å‚é˜…æ–‡ç« â€œElasticsearchç®€ä»‹â€]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ESé›†ç¾¤SSLç›¸å…³]]></title>
    <url>%2F2019%2F12%2F31%2FES%E9%9B%86%E7%BE%A4SSL%E7%9B%B8%E5%85%B3%2F</url>
    <content type="text"><![CDATA[ä¸ºæ‚¨çš„æ¯ä¸ªElasticsearchèŠ‚ç‚¹ç”Ÿæˆä¸€ä¸ªç§é’¥å’ŒX.509è¯ä¹¦åœ¨ElasticsearchåŠ å¯†é€šè®¯å‰ææ¡ä»¶ï¼šç¡®è®¤xpack.security.enabledè®¾ç½®ä¸ºtrueç”ŸæˆèŠ‚ç‚¹è¯ä¹¦ä¸ºæ‚¨çš„Elasticsearché›†ç¾¤åˆ›å»ºä¸€ä¸ªè¯ä¹¦é¢å‘æœºæž„bin/elasticsearch-certutil caæ‚¨å¯ä»¥å°†ç¾¤é›†é…ç½®ä¸ºä¿¡ä»»å…·æœ‰æ­¤CAç­¾åçš„è¯ä¹¦çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚è¯¥å‘½ä»¤è¾“å‡ºå•ä¸ªæ–‡ä»¶ï¼Œé»˜è®¤åç§°ä¸ºelastic-stack-ca.p12ã€‚æ­¤æ–‡ä»¶æ˜¯PKCSï¼ƒ12å¯†é’¥åº“ï¼Œå…¶ä¸­åŒ…å«CAçš„å…¬å…±è¯ä¹¦å’Œç”¨äºŽå¯¹æ¯ä¸ªèŠ‚ç‚¹çš„è¯ä¹¦ç­¾åçš„ç§é’¥ã€‚è¯¥elasticsearch-certutilå‘½ä»¤è¿˜ä¼šæç¤ºæ‚¨è¾“å…¥å¯†ç ä»¥ä¿æŠ¤æ–‡ä»¶å’Œå¯†é’¥ã€‚å¦‚æžœæ‚¨æ‰“ç®—å°†æ¥å°†æ›´å¤šèŠ‚ç‚¹æ·»åŠ åˆ°ç¾¤é›†ä¸­ï¼Œè¯·ä¿ç•™è¯¥æ–‡ä»¶çš„å‰¯æœ¬å¹¶è®°ä½å…¶å¯†ç ã€‚ä¸ºé›†ç¾¤ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ç”Ÿæˆè¯ä¹¦å’Œç§é’¥bin/elasticsearch-certutil cert --ca elastic-stack-ca.p12è¾“å‡ºæ˜¯å•ä¸ªPKCSï¼ƒ12å¯†é’¥åº“ï¼Œå…¶ä¸­åŒ…æ‹¬èŠ‚ç‚¹è¯ä¹¦ï¼ŒèŠ‚ç‚¹å¯†é’¥å’ŒCAè¯ä¹¦ã€‚è¿˜æç¤ºæ‚¨è¾“å…¥å¯†ç ã€‚æ‚¨å¯ä»¥è¾“å…¥è¯ä¹¦å’Œå¯†é’¥çš„å¯†ç ï¼Œä¹Ÿå¯ä»¥æŒ‰Enteré”®å°†å¯†ç ä¿ç•™ä¸ºç©ºç™½ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œelasticsearch-certutilç”Ÿæˆçš„è¯ä¹¦ä¸­æ²¡æœ‰ä¸»æœºåä¿¡æ¯ï¼ˆå³ï¼Œå®ƒä»¬æ²¡æœ‰ä»»ä½•â€œä½¿ç”¨è€…å¤‡ç”¨åç§°â€å­—æ®µï¼‰ã€‚è¿™æ„å‘³ç€æ‚¨å¯ä»¥å¯¹ç¾¤é›†ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ä½¿ç”¨è¯ä¹¦ï¼Œä½†æ˜¯å¿…é¡»å…³é—­ä¸»æœºåéªŒè¯ï¼Œå¦‚ä¸‹é¢çš„é…ç½®æ‰€ç¤ºã€‚å¦‚æžœä½ æƒ³ç”¨ä½ çš„é›†ç¾¤ä¸­çš„ä¸»æœºåçš„éªŒè¯ï¼Œè¿è¡Œ elasticsearch-certutil certå‘½ä»¤ä¸€æ¬¡ï¼Œæ¯ä¸ªèŠ‚ç‚¹å’Œæä¾›çš„â€“nameï¼Œâ€“dnså’Œâ€“ipé€‰é¡¹ã€‚å°†èŠ‚ç‚¹è¯ä¹¦å¤åˆ¶åˆ°é€‚å½“çš„ä½ç½®å°†é€‚ç”¨çš„.p12æ–‡ä»¶å¤åˆ¶åˆ°æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„Elasticsearché…ç½®ç›®å½•å†…çš„ç›®å½•ä¸­ã€‚ä¾‹å¦‚ï¼Œ/home/es/config/certsã€‚æ— éœ€å°†CAæ–‡ä»¶å¤åˆ¶åˆ°æ­¤ç›®å½•ã€‚å¯¹äºŽè¦é…ç½®çš„æ¯ä¸ªå…¶ä»–Elasticäº§å“ï¼Œå°†è¯ä¹¦å¤åˆ¶åˆ°ç›¸å…³çš„é…ç½®ç›®å½•ã€‚åŠ å¯†é›†ç¾¤ä¸­çš„èŠ‚ç‚¹ä¹‹é—´çš„é€šä¿¡å¯ç”¨TLSå¹¶æŒ‡å®šè®¿é—®èŠ‚ç‚¹è¯ä¹¦æ‰€éœ€çš„ä¿¡æ¯å¦‚æžœç­¾åè¯ä¹¦ä¸ºPKCSï¼ƒ12æ ¼å¼ï¼Œåˆ™å°†ä»¥ä¸‹ä¿¡æ¯æ·»åŠ åˆ°elasticsearch.ymlæ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„ æ–‡ä»¶ä¸­ï¼š1234xpack.security.transport.ssl.enabled: truexpack.security.transport.ssl.verification_mode: certificate xpack.security.transport.ssl.keystore.path: certs/elastic-certificates.p12 xpack.security.transport.ssl.truststore.path: certs/elastic-certificates.p12å¦‚æžœåœ¨å‘½ä»¤ä¸­ä½¿ç”¨â€“dnsæˆ–â€“ipé€‰é¡¹ï¼Œelasticsearch-certutil certå¹¶ä¸”è¦å¯ç”¨ä¸¥æ ¼çš„ä¸»æœºåæ£€æŸ¥ï¼Œè¯·å°†éªŒè¯æ¨¡å¼è®¾ç½®ä¸º fullã€‚æœ‰å…³xpack.security.transport.ssl.verification_modeè¿™äº›å€¼çš„æè¿°ï¼Œè¯·å‚è§ã€‚å¦‚æžœä¸ºæ¯ä¸ªèŠ‚ç‚¹åˆ›å»ºäº†å•ç‹¬çš„è¯ä¹¦ï¼Œåˆ™å¯èƒ½éœ€è¦åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šè‡ªå®šä¹‰æ­¤è·¯å¾„ã€‚å¦‚æžœæ–‡ä»¶åä¸ŽèŠ‚ç‚¹åç§°åŒ¹é…ï¼Œåˆ™å¯ä»¥ä½¿ç”¨certs/${node.name}.p12ä¾‹å¦‚æ ¼å¼ã€‚æ‰€è¿°elasticsearch-certutilè¾“å‡ºPKCSï¼ƒ12å¯†é’¥åº“ï¼Œå…¶åŒ…æ‹¬CAè¯ä¹¦ä½œä¸ºä¿¡ä»»è¯ä¹¦çš„æ¡ç›®ã€‚è¿™å…è®¸å¯†é’¥åº“ä¹Ÿç”¨ä½œä¿¡ä»»åº“ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè·¯å¾„å€¼åº”ä¸Žè¯¥keystore.pathå€¼åŒ¹é…ã€‚ä½†æ˜¯è¯·æ³¨æ„ï¼Œè¿™ä¸æ˜¯ä¸€èˆ¬è§„åˆ™ã€‚æœ‰äº›å¯†é’¥åº“ä¸èƒ½ç”¨ä½œä¿¡ä»»åº“ï¼Œåªæœ‰ç»è¿‡ç‰¹æ®Šè®¾è®¡çš„å¯†é’¥åº“æ‰èƒ½ä½¿ç”¨å¦‚æžœè¯ä¹¦ä¸ºPEMæ ¼å¼ï¼Œåˆ™å°†ä»¥ä¸‹ä¿¡æ¯æ·»åŠ åˆ°elasticsearch.ymlæ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„ æ–‡ä»¶ä¸­ï¼š12345xpack.security.transport.ssl.enabled: truexpack.security.transport.ssl.verification_mode: certificate xpack.security.transport.ssl.key: /home/es/config/node01.key xpack.security.transport.ssl.certificate: /home/es/config/node01.crt xpack.security.transport.ssl.certificate_authorities: [ &quot;/home/es/config/ca.crt&quot; ]å¦‚æžœåœ¨å‘½ä»¤ä¸­ä½¿ç”¨â€“dnsæˆ–â€“ipé€‰é¡¹ï¼Œelasticsearch-certutil certå¹¶ä¸”è¦å¯ç”¨ä¸¥æ ¼çš„ä¸»æœºåæ£€æŸ¥ï¼Œè¯·å°†éªŒè¯æ¨¡å¼è®¾ç½®ä¸º fullã€‚æœ‰å…³xpack.security.transport.ssl.verification_modeè¿™äº›å€¼çš„æè¿°ï¼Œè¯·å‚è§ã€‚èŠ‚ç‚¹å¯†é’¥æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ã€‚è¯¥ä½ç½®å¿…é¡»åœ¨Elasticsearché…ç½®ç›®å½•ä¸­ã€‚èŠ‚ç‚¹è¯ä¹¦çš„å®Œæ•´è·¯å¾„ã€‚è¯¥ä½ç½®å¿…é¡»åœ¨Elasticsearché…ç½®ç›®å½•ä¸­ã€‚åº”å½“ä¿¡ä»»çš„CAè¯ä¹¦è·¯å¾„çš„æ•°ç»„ã€‚è¿™äº›è·¯å¾„å¿…é¡»æ˜¯Elasticsearché…ç½®ç›®å½•ä¸­çš„ä½ç½®ã€‚å¦‚æžœæ‚¨ä½¿ç”¨å¯†ç ä¿æŠ¤äº†èŠ‚ç‚¹è¯ä¹¦çš„å®‰å…¨ï¼Œè¯·å°†å¯†ç æ·»åŠ åˆ°æ‚¨çš„Elasticsearchå¯†é’¥åº“ä¸­ï¼š3.1 å¦‚æžœç­¾åè¯ä¹¦ä¸ºPKCSï¼ƒ12æ ¼å¼ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š12bin/elasticsearch-keystore add xpack.security.transport.ssl.keystore.secure_passwordbin/elasticsearch-keystore add xpack.security.transport.ssl.truststore.secure_password3.2 å¦‚æžœè¯ä¹¦ä¸ºPEMæ ¼å¼ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š1bin/elasticsearch-keystore add xpack.security.transport.ssl.secure_key_passphraseé‡æ–°å¯åŠ¨Elasticsearchæ‚¨å¿…é¡»æ‰§è¡Œå®Œå…¨é›†ç¾¤é‡å¯ã€‚é…ç½®ä¸ºä½¿ç”¨TLSçš„èŠ‚ç‚¹æ— æ³•ä¸Žä½¿ç”¨æœªåŠ å¯†ç½‘ç»œçš„èŠ‚ç‚¹é€šä¿¡ï¼ˆåä¹‹äº¦ç„¶ï¼‰ã€‚å¯ç”¨TLSä¹‹åŽï¼Œæ‚¨å¿…é¡»é‡æ–°å¯åŠ¨æ‰€æœ‰èŠ‚ç‚¹ï¼Œä»¥ç»´æŠ¤æ•´ä¸ªç¾¤é›†ä¹‹é—´çš„é€šä¿¡ã€‚Elasticsearchç›‘è§†é…ç½®ä¸ºTLSç›¸å…³èŠ‚ç‚¹è®¾ç½®å€¼çš„æ‰€æœ‰æ–‡ä»¶ï¼Œä¾‹å¦‚è¯ä¹¦ï¼Œå¯†é’¥ï¼Œå¯†é’¥åº“æˆ–ä¿¡ä»»åº“ã€‚å¦‚æžœæ‚¨æ›´æ–°äº†è¿™äº›æ–‡ä»¶ä¸­çš„ä»»ä½•ä¸€ä¸ªï¼ˆä¾‹å¦‚ï¼Œå½“æ‚¨çš„ä¸»æœºåæ›´æ”¹æˆ–æ‚¨çš„è¯ä¹¦åˆ°æœŸæ—¶ï¼‰ï¼ŒElasticsearchå°†é‡æ–°åŠ è½½å®ƒä»¬ã€‚ä»¥å…¨å±€Elasticsearch resource.reload.interval.high è®¾ç½®ï¼ˆé»˜è®¤ä¸º5ç§’ï¼‰ç¡®å®šçš„é¢‘çŽ‡è½®è¯¢æ–‡ä»¶æ˜¯å¦æœ‰æ›´æ”¹åŠ å¯†HTTPå®¢æˆ·ç«¯é€šä¿¡å¯ç”¨TLSå¹¶æŒ‡å®šè®¿é—®èŠ‚ç‚¹è¯ä¹¦æ‰€éœ€çš„ä¿¡æ¯å¦‚æžœè¯ä¹¦é‡‡ç”¨PKCSï¼ƒ12æ ¼å¼ï¼Œåˆ™å°†ä»¥ä¸‹ä¿¡æ¯æ·»åŠ åˆ°elasticsearch.ymlæ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„ æ–‡ä»¶ä¸­ï¼š123xpack.security.http.ssl.enabled: truexpack.security.http.ssl.keystore.path: certs/elastic-certificates.p12 xpack.security.http.ssl.truststore.path: certs/elastic-certificates.p12å¦‚æžœä¸ºæ¯ä¸ªèŠ‚ç‚¹åˆ›å»ºäº†å•ç‹¬çš„è¯ä¹¦ï¼Œåˆ™å¯èƒ½éœ€è¦åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šè‡ªå®šä¹‰æ­¤è·¯å¾„ã€‚å¦‚æžœæ–‡ä»¶åä¸ŽèŠ‚ç‚¹åç§°åŒ¹é…ï¼Œåˆ™å¯ä»¥ä½¿ç”¨certs/${node.name}.p12ä¾‹å¦‚æ ¼å¼ã€‚è¯¥elasticsearch-certutilè¾“å‡ºåŒ…æ‹¬PKCSï¼ƒ12å¯†é’¥åº“å†…éƒ¨çš„CAè¯ä¹¦ï¼Œå› æ­¤å¯†é’¥åº“ä¹Ÿå¯ä»¥è¢«ç”¨ä½œä¿¡ä»»åº“ã€‚æ­¤åç§°åº”ä¸Žkeystore.pathå€¼åŒ¹é…ã€‚å¦‚æžœè¯ä¹¦ä¸ºPEMæ ¼å¼ï¼Œåˆ™å°†ä»¥ä¸‹ä¿¡æ¯æ·»åŠ åˆ°elasticsearch.ymlæ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„ æ–‡ä»¶ä¸­ï¼š1234xpack.security.http.ssl.enabled: truexpack.security.http.ssl.key: /home/es/config/node01.key xpack.security.http.ssl.certificate: /home/es/config/node01.crt xpack.security.http.ssl.certificate_authorities: [ &quot;/home/es/config/ca.crt&quot; ]èŠ‚ç‚¹å¯†é’¥æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ã€‚è¯¥ä½ç½®å¿…é¡»åœ¨Elasticsearché…ç½®ç›®å½•ä¸­ã€‚èŠ‚ç‚¹è¯ä¹¦çš„å®Œæ•´è·¯å¾„ã€‚è¯¥ä½ç½®å¿…é¡»åœ¨Elasticsearché…ç½®ç›®å½•ä¸­ã€‚åº”å½“ä¿¡ä»»çš„CAè¯ä¹¦è·¯å¾„çš„æ•°ç»„ã€‚è¿™äº›è·¯å¾„å¿…é¡»æ˜¯Elasticsearché…ç½®ç›®å½•ä¸­çš„ä½ç½®ã€‚å¦‚æžœæ‚¨ä½¿ç”¨å¯†ç ä¿æŠ¤äº†èŠ‚ç‚¹è¯ä¹¦çš„å®‰å…¨ï¼Œè¯·å°†å¯†ç æ·»åŠ åˆ°æ‚¨çš„Elasticsearchå¯†é’¥åº“ä¸­ï¼š3.1 å¦‚æžœç­¾åè¯ä¹¦ä¸ºPKCSï¼ƒ12æ ¼å¼ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š12bin/elasticsearch-keystore add xpack.security.http.ssl.keystore.secure_passwordbin/elasticsearch-keystore add xpack.security.http.ssl.truststore.secure_password3.2 å¦‚æžœè¯ä¹¦ä¸ºPEMæ ¼å¼ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š1bin/elasticsearch-keystore add xpack.security.http.ssl.secure_key_passphraseé‡æ–°å¯åŠ¨ElasticsearchElasticsearchç›‘è§†é…ç½®ä¸ºTLSç›¸å…³èŠ‚ç‚¹è®¾ç½®å€¼çš„æ‰€æœ‰æ–‡ä»¶ï¼Œä¾‹å¦‚è¯ä¹¦ï¼Œå¯†é’¥ï¼Œå¯†é’¥åº“æˆ–ä¿¡ä»»åº“ã€‚å¦‚æžœæ‚¨æ›´æ–°äº†è¿™äº›æ–‡ä»¶ä¸­çš„ä»»ä½•ä¸€ä¸ªï¼ˆä¾‹å¦‚ï¼Œå½“æ‚¨çš„ä¸»æœºåæ›´æ”¹æˆ–æ‚¨çš„è¯ä¹¦åˆ°æœŸæ—¶ï¼‰ï¼ŒElasticsearchå°†é‡æ–°åŠ è½½å®ƒä»¬ã€‚ä»¥å…¨å±€Elasticsearch resource.reload.interval.high è®¾ç½®ï¼ˆé»˜è®¤ä¸º5ç§’ï¼‰ç¡®å®šçš„é¢‘çŽ‡è½®è¯¢æ–‡ä»¶æ˜¯å¦æœ‰æ›´æ”¹é…ç½®ç›‘è§†åŠŸèƒ½ä»¥ä½¿ç”¨åŠ å¯†çš„è¿žæŽ¥Elastic Stackç›‘è§†åŠŸèƒ½ç”±ä¸¤ä¸ªç»„ä»¶ç»„æˆï¼šæ‚¨åœ¨æ¯ä¸ªElasticsearchå’ŒLogstashèŠ‚ç‚¹ä¸Šå®‰è£…çš„ä»£ç†ï¼Œä»¥åŠKibanaä¸­çš„Monitoring UIã€‚ç›‘è§†ä»£ç†ç¨‹åºä»ŽèŠ‚ç‚¹æ”¶é›†æŒ‡æ ‡å¹¶ä¸ºå…¶å»ºç«‹ç´¢å¼•ï¼Œæ‚¨å¯ä»¥é€šè¿‡Kibanaä¸­çš„â€œç›‘è§†â€ä»ªè¡¨æ¿å¯è§†åŒ–æ•°æ®ã€‚ä»£ç†å¯ä»¥ä¸ºåŒä¸€Elasticsearché›†ç¾¤ä¸Šçš„æ•°æ®å»ºç«‹ç´¢å¼•ï¼Œæˆ–å°†å…¶å‘é€åˆ°å¤–éƒ¨ç›‘è§†é›†ç¾¤ã€‚è¦åœ¨å¯ç”¨å®‰å…¨æ€§åŠŸèƒ½çš„æƒ…å†µä¸‹ä½¿ç”¨ç›‘è§†åŠŸèƒ½ï¼Œæ‚¨éœ€è¦ è®¾ç½®Kibanaä»¥ä½¿ç”¨å®‰å…¨æ€§åŠŸèƒ½ï¼Œ å¹¶ä¸ºç›‘è§†UIåˆ›å»ºè‡³å°‘ä¸€ä¸ªç”¨æˆ·ã€‚å¦‚æžœä½¿ç”¨çš„æ˜¯å¤–éƒ¨ç›‘è§†ç¾¤é›†ï¼Œåˆ™è¿˜éœ€è¦ä¸ºç›‘è§†ä»£ç†ç¨‹åºé…ç½®ç”¨æˆ·ï¼Œå¹¶é…ç½®ä»£ç†ç¨‹åºä»¥åœ¨ä¸Žç›‘è§†ç¾¤é›†é€šä¿¡æ—¶ä½¿ç”¨é€‚å½“çš„å‡­æ®ã€‚åœ¨Kibanaé…ç½®å®‰å…¨å½“é›†ç¾¤ä¸Šå¯ç”¨äº†X-Packå®‰å…¨æ€§æ—¶ï¼ŒKibanaç”¨æˆ·å¿…é¡»ç™»å½•ã€‚æ‚¨å¯ä»¥ä¸ºKibanaç”¨æˆ·é…ç½®X-Packå®‰å…¨è§’è‰²ï¼Œä»¥æŽ§åˆ¶è¿™äº›ç”¨æˆ·å¯ä»¥è®¿é—®å“ªäº›æ•°æ®ã€‚é€šè¿‡Kibanaå‘Elasticsearchå‘å‡ºçš„å¤§å¤šæ•°è¯·æ±‚éƒ½ä½¿ç”¨ç™»å½•ç”¨æˆ·çš„å‡­æ®è¿›è¡Œèº«ä»½éªŒè¯ã€‚ä½†æ˜¯ï¼ŒKibanaæœåŠ¡å™¨éœ€è¦å‘Elasticsearché›†ç¾¤æå‡ºä¸€äº›å†…éƒ¨è¯·æ±‚ã€‚å› æ­¤ï¼Œæ‚¨å¿…é¡»ä¸ºKibanaæœåŠ¡å™¨é…ç½®å‡­æ®ä»¥ç”¨äºŽé‚£äº›è¯·æ±‚ã€‚å¯ç”¨X-Packå®‰å…¨æ€§åŽï¼Œå¦‚æžœåŠ è½½Kibanaä»ªè¡¨æ¿æ¥è®¿é—®æœªç»æŽˆæƒæŸ¥çœ‹çš„ç´¢å¼•ä¸­çš„æ•°æ®ï¼Œåˆ™ä¼šå‡ºçŽ°é”™è¯¯ï¼ŒæŒ‡ç¤ºè¯¥ç´¢å¼•ä¸å­˜åœ¨ã€‚X-Packå®‰å…¨æ€§å½“å‰ä¸æä¾›æŽ§åˆ¶å“ªäº›ç”¨æˆ·å¯ä»¥åŠ è½½å“ªäº›ä»ªè¡¨æ¿çš„æ–¹æ³•ã€‚åœ¨Elasticsearché…ç½®å®‰å…¨1.1 éªŒè¯xpack.security.enabledè®¾ç½®æ˜¯å¦trueåœ¨ç¾¤é›†ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ä¸Šã€‚å¦‚æžœæ‚¨ä½¿ç”¨åŸºæœ¬æˆ–è¯•ç”¨è®¸å¯è¯ï¼Œåˆ™é»˜è®¤å€¼ä¸ºfalseã€‚1.2 é…ç½®ç”¨äºŽèŠ‚ç‚¹é—´é€šä¿¡çš„ä¼ è¾“å±‚å®‰å…¨æ€§ï¼ˆTLS / SSLï¼‰1.3 è®¾ç½®æ‰€æœ‰å†…ç½®ç”¨æˆ·çš„å¯†ç Elasticsearchå®‰å…¨åŠŸèƒ½æä¾› å†…ç½®ç”¨æˆ·æ¥å¸®åŠ©æ‚¨å¯åŠ¨å’Œè¿è¡Œã€‚è¯¥elasticsearch-setup-passwordså‘½ä»¤æ˜¯é¦–æ¬¡è®¾ç½®å†…ç½®ç”¨æˆ·å¯†ç çš„æœ€ç®€å•æ–¹æ³•ã€‚1bin/elasticsearch-setup-passwords interactiveè¯¥elasticsearch-setup-passwordså‘½ä»¤ä½¿ç”¨çž¬æ€å¼•å¯¼å¯†ç ï¼Œè¯¥å¯†ç åœ¨å‘½ä»¤æˆåŠŸè¿è¡ŒåŽå°†ä¸å†æœ‰æ•ˆã€‚æ‚¨ä¸èƒ½elasticsearch-setup-passwordså†æ¬¡è¿è¡Œè¯¥å‘½ä»¤ã€‚ç›¸åï¼Œæ‚¨å¯ä»¥ä»ŽKibanaä¸­çš„â€œ ç®¡ç†â€&gt;â€œç”¨æˆ·â€ UI æ›´æ–°å¯†ç ï¼Œæˆ–ä½¿ç”¨å®‰å…¨ç”¨æˆ·APIã€‚é…ç½®Kibanaä»¥ä½¿ç”¨é€‚å½“çš„å†…ç½®ç”¨æˆ·æ›´æ–°kibana.ymlé…ç½®æ–‡ä»¶ä¸­çš„ä»¥ä¸‹è®¾ç½®ï¼š12elasticsearch.username: &quot;kibana&quot;elasticsearch.password: &quot;kibanapassword&quot;KibanaæœåŠ¡å™¨ä»¥è¯¥ç”¨æˆ·èº«ä»½æäº¤è¯·æ±‚ï¼Œä»¥è®¿é—®é›†ç¾¤ç›‘è§†APIå’Œ.kibanaç´¢å¼•ã€‚è¯¥æœåŠ¡å™¨å¹¶æ²¡æœ‰éœ€è¦è®¿é—®ç”¨æˆ·ç´¢å¼•ã€‚å†…ç½®kibanaç”¨æˆ·çš„å¯†ç é€šå¸¸æ˜¯åœ¨Elasticsearchä¸Šçš„X-Packå®‰å…¨é…ç½®è¿‡ç¨‹ä¸­è®¾ç½®çš„ã€‚xpack.security.encryptionKeyåœ¨kibana.yml é…ç½®æ–‡ä»¶ä¸­è®¾ç½®å±žæ€§ã€‚æ‚¨å¯ä»¥ä½¿ç”¨32ä¸ªå­—ç¬¦æˆ–æ›´é•¿çš„ä»»ä½•æ–‡æœ¬å­—ç¬¦ä¸²ä½œä¸ºåŠ å¯†å¯†é’¥ã€‚1xpack.security.encryptionKey: &quot;something_at_least_32_characters&quot;å¯é€‰ï¼šæ›´æ”¹é»˜è®¤ä¼šè¯æŒç»­æ—¶é—´ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä¼šè¯ä¿æŒæ´»åŠ¨çŠ¶æ€ï¼Œç›´åˆ°å…³é—­æµè§ˆå™¨ã€‚è¦æ›´æ”¹æŒç»­æ—¶é—´ï¼Œè¯·xpack.security.sessionTimeoutåœ¨kibana.ymlé…ç½®æ–‡ä»¶ä¸­è®¾ç½® å±žæ€§ã€‚è¶…æ—¶ä»¥æ¯«ç§’ä¸ºå•ä½ã€‚ä¾‹å¦‚ï¼Œå°†è¶…æ—¶è®¾ç½®ä¸º600000ä»¥ä½¿ä¼šè¯åœ¨10åˆ†é’ŸåŽè¿‡æœŸï¼š1xpack.security.sessionTimeout: 600000å¯é€‰ï¼šé…ç½®Kibanaä»¥åŠ å¯†é€šä¿¡ã€‚Kibanaæ”¯æŒå®¢æˆ·ç«¯è¯·æ±‚çš„ä¼ è¾“å±‚å®‰å…¨æ€§ï¼ˆTLS / SSLï¼‰åŠ å¯†ã€‚å¦‚æžœæ‚¨æ­£åœ¨ä½¿ç”¨X-Packå®‰å…¨æ€§æˆ–ä¸ºElasticsearchæä¾›HTTPSç«¯ç‚¹çš„ä»£ç†ï¼Œåˆ™å¯ä»¥é…ç½®Kibanaé€šè¿‡HTTPSè®¿é—®Elasticsearchã€‚å› æ­¤ï¼ŒKibanaå’ŒElasticsearchä¹‹é—´çš„é€šä¿¡ä¹Ÿè¢«åŠ å¯†ã€‚5.1 é…ç½®Kibanaä»¥åŠ å¯†æµè§ˆå™¨å’ŒKibanaæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ï¼šæ‚¨æ— éœ€ä¸ºè¿™ç§ç±»åž‹çš„åŠ å¯†å¯ç”¨X-Packå®‰å…¨æ€§ã€‚ä¸ºKibanaç”ŸæˆæœåŠ¡å™¨è¯ä¹¦ã€‚a. æ‚¨å¿…é¡»å°†è¯ä¹¦çš„ subjectAltNameåç§°è®¾ç½®ä¸ºKibanaæœåŠ¡å™¨çš„ä¸»æœºåï¼Œæ ‡å‡†åŸŸåï¼ˆFQDNï¼‰æˆ–IPåœ°å€ï¼Œæˆ–è€…å°†CNè®¾ç½®ä¸ºKibanaæœåŠ¡å™¨çš„ä¸»æœºåæˆ–FQDNã€‚å°†æœåŠ¡å™¨çš„IPåœ°å€ç”¨ä½œCNæ— æ•ˆã€‚b. è®¾ç½®server.ssl.enabledï¼Œserver.ssl.keyä»¥åŠserver.ssl.certificate åœ¨æ€§èƒ½kibana.ymlï¼š123server.ssl.enabled: trueserver.ssl.key: /path/to/your/server.keyserver.ssl.certificate: /path/to/your/server.crtè¿›è¡Œè¿™äº›æ›´æ”¹ä¹‹åŽï¼Œæ‚¨å¿…é¡»å§‹ç»ˆé€šè¿‡HTTPSè®¿é—®Kibanaã€‚ä¾‹å¦‚ï¼Œ httpsï¼š// localhostï¼š5601ã€‚5.2 é…ç½®Kibanaä»¥é€šè¿‡HTTPSè¿žæŽ¥åˆ°Elasticsearchè¦æ‰§è¡Œæ­¤æ­¥éª¤ï¼Œæ‚¨å¿…é¡» å¯ç”¨Elasticsearchå®‰å…¨åŠŸèƒ½ï¼Œæˆ–è€…å¿…é¡»å…·æœ‰ä¸ºElasticsearchæä¾›HTTPSç«¯ç‚¹çš„ä»£ç†ã€‚a. elasticsearch.hostsåœ¨Kibanaé…ç½®æ–‡ä»¶çš„è®¾ç½®ä¸­æŒ‡å®šHTTPSåè®®kibana.ymlï¼š1elasticsearch.hosts: [&quot;https://&lt;your_elasticsearch_host&gt;.com:9200&quot;]b. å¦‚æžœæ‚¨ä½¿ç”¨è‡ªå·±çš„CAä¸ºElasticsearchç­¾åè¯ä¹¦ï¼Œè¯·åœ¨ä¸­è¿›è¡Œ elasticsearch.ssl.certificateAuthoritiesè®¾ç½®kibana.ymlä»¥æŒ‡å®šPEMæ–‡ä»¶çš„ä½ç½®ã€‚1elasticsearch.ssl.certificateAuthorities: /path/to/your/cacert.pemè®¾ç½®certificateAuthoritieså±žæ€§å¯ä»¥ä½¿æ‚¨ä½¿ç”¨é»˜è®¤ verificationModeé€‰é¡¹fullã€‚5.3 ï¼ˆå¯é€‰ï¼‰å¦‚æžœå¯ç”¨äº†å¼¹æ€§ç›‘è§†åŠŸèƒ½ï¼Œè¯·é…ç½®Kibanaä»¥é€šè¿‡HTTPSè¿žæŽ¥åˆ°Elasticsearchç›‘è§†é›†ç¾¤ï¼šè¦æ‰§è¡Œæ­¤æ­¥éª¤ï¼Œæ‚¨å¿…é¡»å¯ç”¨Elasticsearchå®‰å…¨åŠŸèƒ½ï¼Œæˆ–è€…å¿…é¡»å…·æœ‰ä¸ºElasticsearchæä¾›HTTPSç«¯ç‚¹çš„ä»£ç†ã€‚a. xpack.monitoring.elasticsearch.hostsåœ¨Kibanaé…ç½®æ–‡ä»¶çš„è®¾ç½®ä¸­æŒ‡å®šHTTPS URL ï¼Œkibana.yml1xpack.monitoring.elasticsearch.hosts: [&quot;https://&lt;your_monitoring_cluster&gt;:9200&quot;]b. xpack.monitoring.elasticsearch.ssl.*åœ¨kibana.ymlæ–‡ä»¶ä¸­æŒ‡å®šè®¾ç½® ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœæ‚¨ä½¿ç”¨è‡ªå·±çš„è¯ä¹¦é¢å‘æœºæž„æ¥ç­¾ç½²è¯ä¹¦ï¼Œè¯·åœ¨æ–‡ä»¶ä¸­æŒ‡å®šPEMæ–‡ä»¶çš„ä½ç½®kibana.ymlï¼š1xpack.monitoring.elasticsearch.ssl.certificateAuthorities: /path/to/your/cacert.pemé‡æ–°å¯åŠ¨Kibanaé€‰æ‹©ä¸€ç§èº«ä»½éªŒè¯æœºåˆ¶ï¼Œå¹¶å‘ç”¨æˆ·æŽˆäºˆä½¿ç”¨Kibanaæ‰€éœ€çš„ç‰¹æƒå¯ä»¥åœ¨Kibana çš„â€œ ç®¡ç†/å®‰å…¨æ€§/è§’è‰²â€é¡µé¢ä¸Šç®¡ç†ç‰¹æƒ,æŽˆäºˆç”¨æˆ·è®¿é—®å°†åœ¨Kibanaä¸­ä½¿ç”¨çš„ç´¢å¼•çš„æƒé™åœ¨Elasticsearchä¸­é…ç½®ç›‘è§†åœ¨Kibanaä¸­é…ç½®ç›‘è§†é…ç½®LogstashèŠ‚ç‚¹çš„ç›‘è§†]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[elastic stack 7.2æŠ€æœ¯æ ˆã€ä¸€ã€‘Elasticsearch 7.2 æŠ€æœ¯æ ˆå®‰è£…ä¸Žé…ç½®æ¦‚è¦çš„è¯´æ˜Ž]]></title>
    <url>%2F2019%2F12%2F31%2Felastic%20stack%207.2%E6%8A%80%E6%9C%AF%E6%A0%88%E3%80%90%E4%B8%80%E3%80%91%E2%80%94%E2%80%94%20%E9%9C%80%E8%A6%81%E6%8E%8C%E6%8F%A1%E7%9A%84%E4%B8%80%E4%BA%9Belastic%E9%87%8D%E8%A6%81%E6%A6%82%E5%BF%B5%E4%B8%8E%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%2F</url>
    <content type="text"><![CDATA[Elasticsearch 7.2 æŠ€æœ¯æ ˆå®‰è£…ä¸Žé…ç½®æ¦‚è¦çš„è¯´æ˜Žæˆ‘ä»¬å°†å¤§ä½“ä¸ŠæŒ‰ä»¥ä¸‹æ­¥éª¤é€æ­¥å®‰è£…å’Œé…ç½®å‡ºä¸€å¥—æ»¡è¶³ç”Ÿäº§çŽ¯å¢ƒè¿è¡Œè¦æ±‚å’Œä¿¡æ¯å®‰å…¨ç®¡ç†è¦æ±‚çš„ä¸‰èŠ‚ç‚¹esæœåŠ¡é›†ç¾¤ã€‚åœ¨èŠ‚ç‚¹1ä¸Šé¢å…ˆè¡Œå®‰è£…ä¸€å¥—es+kinaba+beatsçš„å•èŠ‚ç‚¹æœåŠ¡è¯¦ç»†æ­¥éª¤å¯ä»¥å‚è€ƒå®˜ç½‘è¿™ä¸ªæ•™ç¨‹ï¼šget-started-elastic-stackç»§ç»­åœ¨å•èŠ‚ç‚¹çš„ç»“æž„ä¸‹å¯ç”¨å’Œé…ç½®å‡ºeså®‰å…¨ç®¡ç†åŠŸèƒ½è¯¦ç»†æ­¥éª¤å¯ä»¥å‚è€ƒå®˜ç½‘è¿™ä¸ªæ•™ç¨‹ï¼šsecurity-getting-startedè¿›è¡Œé¢å‘æ”¯æŒå¤šèŠ‚ç‚¹çš„åŠ å¯†é€šä¿¡æ”¹é€ çš„ç›¸å…³é…ç½®ï¼ŒåŒæ—¶å°†èŠ‚ç‚¹2ã€3åŠ å…¥esé›†ç¾¤ä¸­è¯¦ç»†æ­¥éª¤å¯ä»¥å‚è€ƒå®˜ç½‘è¿™ä¸ªæ•™ç¨‹ï¼šencrypting-internode-communicationsæˆ‘ä»¬ä¹‹æ‰€ä»¥æ²¡æœ‰é€‰æ‹©æŒ‰ä¸€æ­¥åˆ°ä½çš„æ–¹æ³•éƒ¨ç½²æ•´å¥—esé›†ç¾¤ï¼Œæ˜¯å› ä¸ºåœ¨å¯ç”¨å’Œé…ç½®xpackçš„éƒ¨åˆ†å¾ˆå®¹æ˜“é‡åˆ°é—®é¢˜ã€‚å‚ç…§ä¸Šé¢çš„ä¸‰ä¸ªæ­¥éª¤ï¼Œå¯ä»¥ä¾æ¬¡éƒ¨ç½²ã€é…ç½®å¹¶å¯¹ç»“æžœè¿›è¡ŒéªŒè¯ï¼Œåœ¨å‰ä¸€æ­¥éª¤éƒ¨ç½²æˆåŠŸçš„åŸºç¡€ä¸Šç»§ç»­åšæ›´å¤šå†…å®¹çš„éƒ¨ç½²ï¼Œè¿™æ ·å¤„ç†çš„æˆåŠŸçŽ‡ä¼šæ¯”è¾ƒé«˜ã€‚ç‰ˆæœ¬åŠè®¸å¯çš„è¯´æ˜Žæ“ä½œç³»ç»Ÿä½¿ç”¨centos7 minimualï¼Œå‡çº§åˆ°æœ€æ–°å°ç‰ˆæœ¬ã€‚elasticsearchæŠ€æœ¯æ ˆå‡é‡‡ç”¨ 7.2ç‰ˆæœ¬ï¼Œé»˜è®¤ä½¿ç”¨basicè®¸å¯ï¼Œå¯å…è´¹ä½¿ç”¨xpackéƒ¨åˆ†å®‰å…¨ç®¡ç†æœåŠ¡ã€‚ä½¿ç”¨å®˜ç½‘ä¸‹è½½çš„tar.gzå®‰è£…åŒ…è¿›è¡Œéƒ¨ç½²ã€‚ä¸€äº›elasticé‡è¦æ¦‚å¿µä¸Žé…ç½®å‚æ•°ES æ˜¯åœ¨ lucene çš„åŸºç¡€ä¸Šè¿›è¡Œç ”å‘çš„ï¼Œéšè—äº† lucene çš„å¤æ‚æ€§ï¼Œæä¾›ç®€å•æ˜“ç”¨çš„ RESTful ApiæŽ¥å£ã€‚ES çš„åˆ†ç‰‡ç›¸å½“äºŽ lucene çš„ç´¢å¼•ã€‚Node èŠ‚ç‚¹çš„å‡ ç§éƒ¨ç½²å®žä¾‹å®žä¾‹ä¸€: åªç”¨äºŽæ•°æ®å­˜å‚¨å’Œæ•°æ®æŸ¥è¯¢ï¼Œé™ä½Žå…¶èµ„æºæ¶ˆè€—çŽ‡12node.master: falsenode.data: trueå®žä¾‹äºŒ: æ¥åè°ƒå„ç§åˆ›å»ºç´¢å¼•è¯·æ±‚æˆ–è€…æŸ¥è¯¢è¯·æ±‚ï¼Œä½†ä¸å­˜å‚¨ä»»ä½•ç´¢å¼•æ•°æ®12node.master: truenode.data: falseå®žä¾‹ä¸‰: ä¸»è¦ç”¨ äºŽæŸ¥è¯¢è´Ÿè½½å‡è¡¡ï¼Œ å¹¶è¯·æ±‚åˆ†å‘åˆ°å¤šä¸ªæŒ‡å®šçš„nodeæœåŠ¡å™¨ï¼Œå¹¶å¯¹å„ä¸ªnodeæœåŠ¡å™¨è¿”å›žçš„ç»“æžœè¿›è¡Œä¸€ä¸ªæ±‡æ€»å¤„ç†ï¼Œæœ€ç»ˆè¿”å›žç»™å®¢æˆ·ç«¯12node.master: falsenode.data: falseå®žä¾‹å››: å³æœ‰æˆä¸ºä¸»èŠ‚ç‚¹çš„èµ„æ ¼ï¼Œåˆå­˜å‚¨æ•°æ®12node.master: truenode.data: trueåœ¨åªæœ‰3ä¸ªèŠ‚ç‚¹çš„éƒ¨ç½²æ–¹æ¡ˆä¸­ï¼Œå»ºè®®è®¾ç½®3ä¸ªèŠ‚ç‚¹å‡æœ‰æˆä¸ºmasterèŠ‚ç‚¹çš„èµ„æ ¼ï¼Œä¸”å­˜å‚¨ç´¢å¼•æ•°æ®ã€‚æ•°æ®ç›®å½•é…ç½®ä¸Žç‰©ç†ç£ç›˜çš„ä½¿ç”¨ä¸€èˆ¬æ¥è¯´ï¼Œæ˜¯è¿™æ ·é…ç½®ï¼š123path: logs: /var/log/elasticsearch data: /var/data/elasticsearchæ•°æ®ç›®å½•å¯ä»¥æ”¯æŒä½¿ç”¨å¤šä¸ªï¼š12345path: data: - /mnt/elasticsearch_1 - /mnt/elasticsearch_2 - /mnt/elasticsearch_3ç‰©ç†ç£ç›˜çš„ä½¿ç”¨ï¼šç”±äºŽeså·²ç»æä¾›äº†æ•°æ®å‰¯æœ¬çš„å†—ä½™ï¼Œæ‰€ä»¥å»ºè®®ä½¿ç”¨raid0ï¼Œä¸é€šè¿‡raidæä¾›é¢å¤–çš„æ•°æ®ä¿æŠ¤ï¼›å½“æœ‰å¤šå—æ•°æ®ç›˜æ—¶ï¼Œé€šè¿‡path.dataé…ç½®æŠŠæ•°æ®æ¡å¸¦åŒ–åˆ†é…åˆ°å¤šå—ç›˜ä¸Šæ˜¯å¯è¡Œçš„ï¼Œä½†å»ºè®®æ˜¯é€šè¿‡è®¾ç½®raid0å°†å¤šå—ç‰©ç†ç£ç›˜æ•´åˆä¸ºä¸€å—é€»è¾‘ç›˜ä½¿ç”¨ï¼Œä»¥ç¡®ä¿æ¯ä¸ªåˆ†ç‰‡éƒ½æ˜¯è¢«æ”¾å…¥çš„åŒæ ·çš„ç›®å½•ï¼›é›†ç¾¤åç§°é…ç½®1cluster.name: logging-prodnodeèŠ‚ç‚¹åç§°é»˜è®¤ä¸ºä½¿ç”¨ä¸»æœºåï¼Œä¹Ÿå¯ä»¥åœ¨elasticsearch.ymlä¸­æŒ‡å®šã€‚åœ¨ä¸€ä¸ªä¸»æœºä¸ŠåŒæ—¶è·‘å¤šä¸ªeså®žä¾‹æ—¶ï¼Œè¿™ä¸ªé…ç½®é¡¹å°±ä¼šå¾ˆæœ‰å¸®åŠ©äº†ã€‚1node.name: prod-data-2ç½‘ç»œåœ°å€é…ç½®é»˜è®¤å°†æœåŠ¡ç»‘å®šåˆ°loopbackæŽ¥å£ï¼Œè¿™éœ€è¦æŒ‰å®žé™…æƒ…å†µè°ƒæ•´ã€‚1network.host: 10.20.0.11æ³¨ï¼šå˜æ›´æœåŠ¡ç»‘å®šæŽ¥å£åŽï¼Œä¼šè¢«è®¤ä¸ºæ˜¯ä½œä¸ºç”Ÿäº§çŽ¯å¢ƒä½¿ç”¨ï¼Œä¼šè§¦å‘esçš„çŽ¯å¢ƒæ£€æŸ¥æ“ä½œã€‚å½“æœ‰ä¸ç¬¦è¦æ±‚çš„ç³»ç»Ÿæˆ–é›†ç¾¤é…ç½®å‚æ•°æ—¶ï¼ŒesæœåŠ¡ä¼šæ— æ³•å¯åŠ¨ã€‚èŠ‚ç‚¹å‘çŽ°å’Œclusteråˆå§‹åŒ–å‚æ•°å•æ’­ä¸»æœºåˆ—è¡¨é€šè¿‡discovery.zen.ping.unicast.hostsæ¥é…ç½®ã€‚è¿™ä¸ªé…ç½®åœ¨ elasticsearch.yml æ–‡ä»¶ä¸­ï¼š1discovery.zen.ping.unicast.hosts: [&quot;host1&quot;, &quot;host2:port&quot;]å…·ä½“çš„å€¼æ˜¯ä¸€ä¸ªä¸»æœºæ•°ç»„æˆ–é€—å·åˆ†éš”çš„å­—ç¬¦ä¸²ã€‚æ¯ä¸ªå€¼åº”é‡‡ç”¨hostï¼športæˆ–hostçš„å½¢å¼ï¼ˆå…¶ä¸­porté»˜è®¤ä¸ºè®¾ç½®transport.profiles.default.portï¼Œå¦‚æžœæœªè®¾ç½®åˆ™è¿”å›žtransport.tcp.portï¼‰ã€‚è¯·æ³¨æ„ï¼Œå¿…é¡»å°†IPv6ä¸»æœºç½®äºŽæ‹¬å·å†…ã€‚æ­¤è®¾ç½®çš„é»˜è®¤å€¼ä¸º127.0.0.1ï¼Œ[:: 1]ã€‚ä½¿ç”¨å•æ’­ï¼Œä½ å¯ä»¥ä¸º Elasticsearch æä¾›ä¸€äº›å®ƒåº”è¯¥åŽ»å°è¯•è¿žæŽ¥çš„èŠ‚ç‚¹åˆ—è¡¨ã€‚å½“ä¸€ä¸ªèŠ‚ç‚¹è”ç³»åˆ°å•æ’­åˆ—è¡¨ä¸­çš„æˆå‘˜æ—¶ï¼Œå®ƒå°±ä¼šå¾—åˆ°æ•´ä¸ªé›†ç¾¤æ‰€æœ‰èŠ‚ç‚¹çš„çŠ¶æ€ï¼Œç„¶åŽå®ƒä¼šè”ç³» master èŠ‚ç‚¹ï¼Œå¹¶åŠ å…¥é›†ç¾¤ã€‚12345678discovery.seed_hosts: - 192.168.1.10:9300 - 192.168.1.11 - seeds.mydomain.comcluster.initial_master_nodes: - master-node-a - master-node-b - master-node-cæä¾›äº†seed.hostså‚æ•°çš„ä¸‰ç§èµ‹å€¼æ–¹å¼initial_master_nodeså‚æ•°åªèƒ½ä½¿ç”¨èŠ‚ç‚¹çš„node.nameå‚æ•°å€¼ï¼Œä¸€èˆ¬æ¥è¯´æ˜¯ä¸»æœºåZen Discovery æ˜¯ ES é»˜è®¤å†…å»ºå‘çŽ°æœºåˆ¶ã€‚å®ƒæä¾›å•æ’­å’Œå¤šæ’­çš„å‘çŽ°æ–¹å¼ï¼Œå¹¶ä¸”å¯ä»¥æ‰©å±•ä¸ºé€šè¿‡æ’ä»¶æ”¯æŒäº‘çŽ¯å¢ƒå’Œå…¶ä»–å½¢å¼çš„å‘çŽ°ã€‚Elasticsearch å®˜æ–¹æŽ¨èæˆ‘ä»¬ä½¿ç”¨ å•æ’­ ä»£æ›¿ ç»„æ’­ã€‚è€Œä¸” Elasticsearch é»˜è®¤è¢«é…ç½®ä¸ºä½¿ç”¨ å•æ’­ å‘çŽ°ï¼Œä»¥é˜²æ­¢èŠ‚ç‚¹æ— æ„ä¸­åŠ å…¥é›†ç¾¤ã€‚è®¾ç½®JVM heap sizeé€šè¿‡jvm.optionsæ–‡ä»¶è®¾ç½®jvmç¼“å­˜å‚æ•°ï¼Œè¿‡å¤§æˆ–è¿‡å°éƒ½ä¸å¥½ï¼Œè¿‡å¤§çš„ç¼“å­˜ä¹Ÿä¼šè®©åžƒåœ¾å›žæ”¶å˜æ…¢ã€‚å½“jvmç¼“å­˜è®¾ç½®å¤§äºŽ26GBæ—¶ï¼Œéœ€è¦è¯„ä¼°zero-based compressed oopsé™åˆ¶ï¼Œå‚è§ä¸‹é¢çš„è¯´æ˜Žï¼šhttps://www.elastic.co/guide/en/elasticsearch/reference/current/heap-size.htmlç”±äºŽESæž„å»ºåŸºäºŽlucene, è€Œluceneè®¾è®¡å¼ºå¤§ä¹‹å¤„åœ¨äºŽluceneèƒ½å¤Ÿå¾ˆå¥½çš„åˆ©ç”¨æ“ä½œç³»ç»Ÿå†…å­˜æ¥ç¼“å­˜ç´¢å¼•æ•°æ®ï¼Œä»¥æä¾›å¿«é€Ÿçš„æŸ¥è¯¢æ€§èƒ½ã€‚luceneçš„ç´¢å¼•æ–‡ä»¶segementsæ˜¯å­˜å‚¨åœ¨å•æ–‡ä»¶ä¸­çš„ï¼Œå¹¶ä¸”ä¸å¯å˜ï¼Œå¯¹äºŽOSæ¥è¯´ï¼Œèƒ½å¤Ÿå¾ˆå‹å¥½åœ°å°†ç´¢å¼•æ–‡ä»¶ä¿æŒåœ¨cacheä¸­ï¼Œä»¥ä¾¿å¿«é€Ÿè®¿é—®ï¼›å› æ­¤ï¼Œæˆ‘ä»¬å¾ˆæœ‰å¿…è¦å°†ä¸€åŠçš„ç‰©ç†å†…å­˜ç•™ç»™lucene ; å¦ä¸€åŠçš„ç‰©ç†å†…å­˜ç•™ç»™ESï¼ˆJVM heap )ã€‚æ‰€ä»¥ï¼Œ åœ¨ESå†…å­˜è®¾ç½®æ–¹é¢ï¼Œå¯ä»¥éµå¾ªä»¥ä¸‹åŽŸåˆ™ï¼šå½“æœºå™¨å†…å­˜å°äºŽ64Gæ—¶ï¼Œéµå¾ªé€šç”¨çš„åŽŸåˆ™ï¼Œ50%ç»™ESï¼Œ50%ç•™ç»™luceneã€‚å½“æœºå™¨å†…å­˜å¤§äºŽ64Gæ—¶ï¼Œéµå¾ªä»¥ä¸‹åŽŸåˆ™ï¼ša. å¦‚æžœä¸»è¦çš„ä½¿ç”¨åœºæ™¯æ˜¯å…¨æ–‡æ£€ç´¢, é‚£ä¹ˆå»ºè®®ç»™ES Heapåˆ†é… 4~32Gçš„å†…å­˜å³å¯ï¼›å…¶å®ƒå†…å­˜ç•™ç»™æ“ä½œç³»ç»Ÿ, ä¾›luceneä½¿ç”¨ï¼ˆsegments cache), ä»¥æä¾›æ›´å¿«çš„æŸ¥è¯¢æ€§èƒ½ã€‚b. å¦‚æžœä¸»è¦çš„ä½¿ç”¨åœºæ™¯æ˜¯èšåˆæˆ–æŽ’åºï¼Œ å¹¶ä¸”å¤§å¤šæ•°æ˜¯numerics, dates, geo_points ä»¥åŠnot_analyzedçš„å­—ç¬¦ç±»åž‹ï¼Œ å»ºè®®åˆ†é…ç»™ES Heapåˆ†é… 4~32Gçš„å†…å­˜å³å¯ï¼Œå…¶å®ƒå†…å­˜ç•™ç»™æ“ä½œç³»ç»Ÿï¼Œä¾›luceneä½¿ç”¨(doc values cache)ï¼Œæä¾›å¿«é€Ÿçš„åŸºäºŽæ–‡æ¡£çš„èšç±»ã€æŽ’åºæ€§èƒ½ã€‚c. å¦‚æžœä½¿ç”¨åœºæ™¯æ˜¯èšåˆæˆ–æŽ’åºï¼Œå¹¶ä¸”éƒ½æ˜¯åŸºäºŽanalyzed å­—ç¬¦æ•°æ®ï¼Œè¿™æ—¶éœ€è¦æ›´å¤šçš„ heap size, å»ºè®®æœºå™¨ä¸Šè¿è¡Œå¤šESå®žä¾‹ï¼Œæ¯ä¸ªå®žä¾‹ä¿æŒä¸è¶…è¿‡50%çš„ES heapè®¾ç½®(ä½†ä¸è¶…è¿‡32Gï¼Œå †å†…å­˜è®¾ç½®32Gä»¥ä¸‹æ—¶ï¼ŒJVMä½¿ç”¨å¯¹è±¡æŒ‡æ ‡åŽ‹ç¼©æŠ€å·§èŠ‚çœç©ºé—´)ï¼Œ50%ä»¥ä¸Šç•™ç»™luceneã€‚ç¦æ­¢swapï¼Œä¸€æ—¦å…è®¸å†…å­˜ä¸Žç£ç›˜çš„äº¤æ¢ï¼Œä¼šå¼•èµ·è‡´å‘½çš„æ€§èƒ½é—®é¢˜ã€‚ é€šè¿‡ï¼š åœ¨elasticsearch.yml ä¸­ bootstrap.memory_lock: trueï¼Œ ä»¥ä¿æŒJVMé”å®šå†…å­˜ï¼Œä¿è¯ESçš„æ€§èƒ½ã€‚æ“ä½œç³»ç»Ÿé€šè¿‡äº¤æ¢ï¼ˆswapï¼‰å°†å†…å­˜çš„åˆ†é¡µå†™å…¥ç£ç›˜ï¼Œesåœ¨å†…å­˜ä¸­ä¿ç•™äº†å¾ˆå¤šè¿è¡Œæ—¶å¿…éœ€çš„æ•°æ®å’Œç¼“å­˜ï¼Œæ‰€ä»¥æ¶ˆè€—ç£ç›˜çš„æ“ä½œå°†ä¸¥é‡å½±å“æ­£åœ¨è¿è¡Œçš„é›†ç¾¤ã€‚å…³é—­esäº¤æ¢æœ€å½»åº•çš„æ–¹æ³•æ˜¯ï¼Œåœ¨elasticsearch.ymlæ–‡ä»¶ä¸­å°†bootstrap.mlockallè®¾ç½®ä¸ºtrue ã€‚GCè®¾ç½®åŽŸåˆ™ï¼ša. ä¿æŒGCçš„çŽ°æœ‰è®¾ç½®ï¼Œé»˜è®¤è®¾ç½®ä¸ºï¼šConcurrent-Mark and Sweep (CMS)ï¼Œåˆ«æ¢æˆG1GCï¼Œå› ä¸ºç›®å‰G1è¿˜æœ‰å¾ˆå¤šBUGã€‚b. ä¿æŒçº¿ç¨‹æ± çš„çŽ°æœ‰è®¾ç½®ï¼Œç›®å‰ESçš„çº¿ç¨‹æ± è¾ƒ1.Xæœ‰äº†è¾ƒå¤šä¼˜åŒ–è®¾ç½®ï¼Œä¿æŒçŽ°çŠ¶å³å¯ï¼›é»˜è®¤çº¿ç¨‹æ± å¤§å°ç­‰äºŽCPUæ ¸å¿ƒæ•°ã€‚å¦‚æžœä¸€å®šè¦æ”¹ï¼ŒæŒ‰å…¬å¼ï¼ˆï¼ˆCPUæ ¸å¿ƒæ•°* 3ï¼‰/ 2ï¼‰+ 1 è®¾ç½®ï¼›ä¸èƒ½è¶…è¿‡CPUæ ¸å¿ƒæ•°çš„2å€ï¼›ä½†æ˜¯ä¸å»ºè®®ä¿®æ”¹é»˜è®¤é…ç½®ï¼Œå¦åˆ™ä¼šå¯¹CPUé€ æˆç¡¬ä¼¤ã€‚Temp directoryé…ç½®åœ¨ä½¿ç”¨.tar.gzæ–¹å¼éƒ¨ç½²esæœåŠ¡æ—¶ï¼Œå»ºè®®æŒ‡å®šä¸€ä¸ªå®‰å…¨çš„ä¸´æ—¶æ–‡ä»¶ç›®å½•ï¼Œé¿å…å› ä¸ºé»˜è®¤ä½¿ç”¨çš„/tmpä¸‹çš„ä¸´æ—¶ç›®å½•è¢«æ“ä½œç³»ç»Ÿå®šæœŸåˆ é™¤ï¼Œé€ æˆæœåŠ¡æ•…éšœã€‚é€šè¿‡çŽ¯å¢ƒå˜é‡ $ES_TMPDIR æ¥è®¾ç½®ã€‚åˆ†ç‰‡åˆ†é…çš„æ„ŸçŸ¥åˆ†é…æ„ŸçŸ¥ï¼ˆallocation awarenessï¼‰æ˜¯ç®¡ç†åœ¨å“ªé‡Œæ”¾ç½®æ•°æ®çš„å‰¯æœ¬ã€‚https://www.elastic.co/guide/en/elasticsearch/reference/7.2/allocation-awareness.html1. åŸºäºŽåˆ†ç‰‡çš„åˆ†é…åˆ†é…æ„ŸçŸ¥å…è®¸ç”¨æˆ·ä½¿ç”¨è‡ªå®šä¹‰çš„å‚æ•°æ¥é…ç½®åˆ†ç‰‡çš„åˆ†é…ã€‚é€šè¿‡å®šä¹‰ä¸€ç»„é”®ï¼Œç„¶åŽåœ¨åˆé€‚çš„èŠ‚ç‚¹ä¸Šè®¾ç½®è¿™ä¸ªé”®ï¼Œå°±å¯ä»¥å¼€å¯åˆ†é…æ„ŸçŸ¥ã€‚elasticsearch.yml1cluster.routing.allocation.awareness.attributes: rack_idæ³¨ï¼šæ”¯æŒèµ‹å¤šä¸ªå€¼åŒæ—¶ç”¨ä½œæ„ŸçŸ¥å±žæ€§ï¼Œå¦‚cluster.routing.allocation.awareness.attributes: rack, group, zoneé’ˆå¯¹æ¯ä¸ªesèŠ‚ç‚¹ï¼Œç”¨æˆ·å¯ä»¥ä¿®æ”¹elasticsearch.ymlï¼ŒæŒ‰æœŸå¾…çš„ç½‘ç»œé…ç½®æ¥è®¾ç½®è¯¥å€¼ã€‚ESå…è®¸ç”¨æˆ·åœ¨èŠ‚ç‚¹ä¸Šè®¾ç½®å…ƒæ•°æ®ï¼Œè¿™äº›å…ƒæ•°æ®çš„é”®å°†æˆä¸ºæˆ‘ä»¬è¦ä½¿ç”¨çš„åˆ†é…æ„ŸçŸ¥å‚æ•°ã€‚1node.attr.rack_id: rack_oneå½“æœ‰å¤šä¸ªesèŠ‚ç‚¹å¯ç”¨æ—¶ï¼Œesä¼šå°½é‡æŠŠåˆ†ç‰‡ä¸Žå‰¯æœ¬å‡è¡¡åˆ°rack_idå€¼ä¸åŒçš„èŠ‚ç‚¹ä¸ŠåŽ»ã€‚ä½†å¦‚æžœåªå‰©ä¸€ä¸ªå¯ç”¨çš„esæ•°æ®èŠ‚ç‚¹äº†ï¼Œesä¹Ÿä¼šé€‰æ‹©æŠŠä¸€ä¸ªç´¢å¼•çš„åˆ†ç‰‡å’Œå‰¯æœ¬å…¨éƒ¨éƒ¨ç½²åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šé¢ã€‚å¸¸è§çš„ä½¿ç”¨åœºæ™¯æ˜¯æŒ‰ç…§åœ°ç‚¹ã€æœºæž¶æˆ–æ˜¯è™šæ‹Ÿæœºç­‰æ¥åˆ’åˆ†é›†ç¾¤çš„æ‹“æ‰‘ã€‚2. å¼ºåˆ¶æ€§çš„åˆ†é…æ„ŸçŸ¥åœ¨ç”¨æˆ·äº‹å…ˆè§„åˆ™å¥½åˆ†ç‰‡åˆ†ç»„ä¿¡æ¯ï¼Œä¸”å¸Œæœ›é™åˆ¶æ¯ä¸ªåˆ†ç»„çš„å‰¯æœ¬åˆ†ç‰‡æ•°é‡æ—¶ï¼Œå¼ºåˆ¶åˆ†é…æ„ŸçŸ¥æ˜¯é€‚ç”¨çš„è§£å†³æ–¹æ³•ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå³ä¾¿å› ä¸ºéƒ¨åˆ†åˆ†ç»„çš„æ•°æ®èŠ‚ç‚¹ä¸å¯ç”¨ï¼Œå¯¼è‡´esæœåŠ¡å¯ç”¨æ€§é£Žé™©ï¼Œesä¹Ÿä¸ä¼šæŠŠç´¢å¼•çš„åˆ†ç‰‡ä¸Žå‰¯æœ¬éƒ½éƒ¨ç½²åœ¨ç›¸åŒçš„åˆ†ç»„èŠ‚ç‚¹ä¸Šé¢ã€‚ä¾‹å¦‚ï¼Œç”¨æˆ·æƒ³åœ¨åŒºåŸŸçº§åˆ«ä½¿ç”¨å¼ºåˆ¶åˆ†é…ã€‚å¯ä»¥å…ˆæŒ‡å®šä¸€ä¸ªzoneçš„å±žæ€§ï¼Œç„¶åŽä¸ºè¯¥åˆ†ç»„æ·»åŠ å¤šä¸ªç»´åº¦ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š12cluster.routing.allocation.awareness.attributes: zonecluster.routing.allocation.force.zone.values: us-east, us-westæ­¤æ—¶ï¼Œæˆ‘ä»¬åœ¨ä¸œéƒ¨åœ°åŒºå¯ç”¨äº†ä¸€æ‰¹èŠ‚ç‚¹ï¼Œè¿™äº›èŠ‚ç‚¹çš„é…ç½®éƒ½æ˜¯node.attr.zone: us-east ï¼Œåœ¨åˆ›å»ºç´¢å¼•æ—¶ç”±äºŽä»¥ä¸Šé™åˆ¶ï¼Œå‰¯æœ¬åˆ†ç‰‡åªä¼šè¢«å‡è¡¡åˆ°æ²¡æœ‰ç›¸åº”zoneå€¼çš„èŠ‚ç‚¹ä¸ŠåŽ»ã€‚3. åŠ¨æ€è®¾ç½®åˆ†ç‰‡æ„ŸçŸ¥å¯ä»¥é€šè¿‡é›†ç¾¤è®¾ç½®APIåœ¨è¿è¡Œæ—¶è¿›è¡Œä¿®æ”¹ï¼Œè¿™ä¸ªä¿®æ”¹çš„æ•ˆæžœå¯ä»¥è‡ªè¡Œé€‰æ‹©æ˜¯æŒä¹…çš„ï¼Œè¿˜æ˜¯ä¸´æ—¶æ€§çš„ã€‚123456curl -XPUT localhost:9200/_cluster/settings -d &apos;&#123; &quot;persistent&quot;: &#123; &quot;cluster.routing.allocation.awareness.attributes&quot;: zone &quot;cluster.routing.allocation.force.zone.values&quot;: us-east, us-west &#125;&#125;&apos;]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[elastic stack 7.2æŠ€æœ¯æ ˆã€äº”ã€‘å‘esé›†ç¾¤ä¸­å¢žåŠ æ›´å¤šèŠ‚ç‚¹å¹¶é…ç½®èŠ‚ç‚¹é—´çš„åŠ å¯†é€šä¿¡]]></title>
    <url>%2F2019%2F12%2F31%2Felastic%20stack%207.2%E6%8A%80%E6%9C%AF%E6%A0%88%E3%80%90%E4%BA%94%E3%80%91%E2%80%94%E2%80%94%20%E5%90%91es%E9%9B%86%E7%BE%A4%E4%B8%AD%E5%A2%9E%E5%8A%A0%E6%9B%B4%E5%A4%9A%E8%8A%82%E7%82%B9%E5%B9%B6%E9%85%8D%E7%BD%AE%E8%8A%82%E7%82%B9%E9%97%B4%E7%9A%84%E5%8A%A0%E5%AF%86%E9%80%9A%E4%BF%A1%2F</url>
    <content type="text"><![CDATA[æœ¬ç« èŠ‚çš„é…ç½®å†…å®¹ï¼Œæ˜¯å»ºç«‹åœ¨æˆåŠŸéƒ¨ç½²å’Œé…ç½®äº†å‰é¢å‡ ä¸ªç« èŠ‚çš„åŸºç¡€ä¹‹ä¸Šã€‚åˆ¶ä½œæ•°å­—è¯ä¹¦åœ¨ä¸€ä¸ªå®‰å…¨çš„é›†ç¾¤ä¸­ï¼ŒElasticsearchèŠ‚ç‚¹åœ¨ä¸Žå…¶ä»–èŠ‚ç‚¹é€šä¿¡æ—¶ä¼šä½¿ç”¨è¯ä¹¦æ¥æ ‡è¯†è‡ªå·±ã€‚ç¾¤é›†å¿…é¡»éªŒè¯è¿™äº›è¯ä¹¦çš„çœŸå®žæ€§ã€‚ å»ºè®®çš„æ–¹æ³•æ˜¯ä¿¡ä»»ç‰¹å®šçš„è¯ä¹¦é¢å‘æœºæž„ï¼ˆCAï¼‰ã€‚ å› æ­¤ï¼Œå½“èŠ‚ç‚¹æ·»åŠ åˆ°ç¾¤é›†æ—¶ï¼Œéœ€è¦ä»–ä»¬ä½¿ç”¨ç”±åŒä¸€CAç­¾åçš„è¯ä¹¦ã€‚åˆ¶ä½œcaè¯ä¹¦ï¼š1./bin/elasticsearch-certutil caä½¿ç”¨é»˜è®¤è¾“å‡ºæ–‡ä»¶åelastic-stack-ca.p12ï¼Œå¹¶ä¸ºè¯ä¹¦è®¾ç½®è®¿é—®å£ä»¤ï¼šmy-elastic123ã€‚å¦‚æžœæ˜¯ä½ çš„ç”Ÿäº§é›†ç¾¤ï¼Œè¯·æ³¨æ„åšå¥½è¯ä¹¦å’Œå£ä»¤çš„ä¿æŠ¤ã€‚åˆ›å»ºä¸€ä¸ªç›®å½•ç”¨äºŽå­˜æ”¾è¯ä¹¦ï¼š12cd $&#123;ES_HOME&#125;/configmkdir certsä¸ºèŠ‚ç‚¹1åˆ¶ä½œè¯ä¹¦å’Œå¯†é’¥ï¼š1./bin/elasticsearch-certutil cert --ca elastic-stack-ca.p12 --ip 10.20.0.11 --out config/certs/es-node1.p12è¾“å…¥caçš„å£ä»¤ï¼Œå¹¶ä¸ºèŠ‚ç‚¹1çš„è¯ä¹¦è®¾ç½®å£ä»¤ä¸ºï¼šes-node123elasticsearch-certutilå·¥å…·æä¾›äº†æ›´å¤šå¤æ‚çš„è¯ä¹¦ç®¡ç†åŠŸèƒ½ï¼Œå¦‚æžœæœ‰ä½¿ç”¨éœ€æ±‚å¯ä»¥å‚è§ï¼šhttps://www.elastic.co/guide/en/elasticsearch/reference/7.2/certutil.htmlé…ç½®é›†ç¾¤èŠ‚ç‚¹é—´çš„åŠ å¯†é€šä¿¡ç¼–è¾‘elasticsearch.ymlæ–‡ä»¶ï¼Œä¿®æ”¹ä»¥ä¸‹å‚æ•°ã€‚1ï¼‰ç¦ç”¨single-node discoveryï¼š1discovery.type: single-nodeæˆ‘ä»¬ä¹‹å‰ä¸ºäº†è°ƒè¯•å•èŠ‚ç‚¹çš„esåŠŸèƒ½è€Œå¯ç”¨çš„è¿™ä¸ªå‚æ•°ï¼ŒçŽ°åœ¨ç›´æŽ¥ä»Žé…ç½®æ–‡ä»¶ä¸­æ¸…é™¤è¿™ä¸€é…ç½®é¡¹ï¼Œä½¿ç”¨é»˜è®¤å€¼å³å¯ã€‚2ï¼‰è®¾ç½®è¿™æ¬¡å¯åŠ¨ä¸­æœ‰èµ„æ ¼æˆä¸ºmasterèŠ‚ç‚¹çš„ä¸»æœºåˆ—è¡¨ï¼š1cluster.initial_master_nodes: [&quot;es-node1&quot;]å› ä¸ºæ­¤æ—¶æˆ‘ä»¬è¿˜åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚å¦‚æžœæ˜¯å·²ç»æœ‰å¤šä¸ªå…·å¤‡master nodeèµ„æ ¼çš„èŠ‚ç‚¹æ—¶ï¼Œåˆ™è¿™é‡Œéœ€è¦æŠŠå®ƒä»¬éƒ½ç»´æŠ¤åœ¨åˆ—è¡¨ä¸­ã€‚è¿™ä¸€å‚æ•°ä»…åœ¨é›†ç¾¤åˆæ¬¡å»ºç«‹æ—¶æœ‰ç”¨ã€‚3ï¼‰ä¸ºä¼ è¾“ï¼ˆèŠ‚ç‚¹é—´ï¼‰é€šä¿¡å¯ç”¨ä¼ è¾“å±‚å®‰å…¨æ€§ï¼ˆTLS / SSLï¼‰ï¼šES_PATH_CONF/elasticsearch.yml1234xpack.security.enabled: truexpack.security.transport.ssl.enabled: truexpack.security.transport.ssl.keystore.path: certs/$&#123;node.name&#125;.p12xpack.security.transport.ssl.truststore.path: certs/$&#123;node.name&#125;.p12å°†PKCSï¼ƒ12æ–‡ä»¶çš„å¯†ç å­˜å‚¨åœ¨Elasticsearchå¯†é’¥åº“ä¸­ã€‚123./bin/elasticsearch-keystore create./bin/elasticsearch-keystore add xpack.security.transport.ssl.keystore.secure_password./bin/elasticsearch-keystore add xpack.security.transport.ssl.truststore.secure_passwordå¦‚æžœelasticsearch keystoreæ–‡ä»¶å·²ç»å­˜åœ¨äº†ï¼Œåˆ™å¯ä»¥è·³è¿‡åˆ›å»ºå‘½ä»¤ç³»ç»Ÿå°†æç¤ºä½ æä¾›ä¸ºes-node1.p12æ–‡ä»¶åˆ›å»ºçš„å¯†ç ã€‚ æˆ‘ä»¬å°†æ­¤æ–‡ä»¶ç”¨äºŽä¼ è¾“TLSå¯†é’¥åº“å’Œä¿¡ä»»åº“ï¼Œå› æ­¤ä¸ºè¿™ä¸¤ä¸ªè®¾ç½®æä¾›ç›¸åŒçš„å¯†ç ã€‚1234[elastic@es-node1 elasticsearch-7.2.0]$ ./bin/elasticsearch-keystore listkeystore.seedxpack.security.transport.ssl.keystore.secure_passwordxpack.security.transport.ssl.truststore.secure_passwordé‡æ–°å¯åŠ¨esæœåŠ¡ï¼š1./bin/elasticsearchä»¥åŠkibanaæœåŠ¡ï¼š1./bin/kibanaå‘esé›†ç¾¤ä¸­æ·»åŠ æ›´å¤šçš„èŠ‚ç‚¹eså¯ä»¥ä½¿ç”¨çš„èŠ‚ç‚¹æœ‰å¾ˆå¤šç±»åž‹ï¼Œè¯¦è§ï¼šhttps://www.elastic.co/guide/en/elasticsearch/reference/7.2/modules-node.html ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œå‘é›†ç¾¤ä¸­æ·»åŠ ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æ—¢ä½œä¸ºmaster-eligible nodeï¼ˆnode.master: trueï¼‰ï¼Œä¹Ÿä½œä¸ºdata nodeï¼ˆnode.dataï¼š trueï¼‰ã€‚1ï¼‰æˆ‘ä»¬å…ˆé…ç½®å¥½å¦å¤–çš„ä¸¤ä¸ªä¸»æœºèŠ‚ç‚¹å‚ç…§æœ¬æ–‡ç¬¬ä¸€éƒ¨åˆ†çš„å†…å®¹å¯¹ç³»ç»Ÿè¿›è¡Œåˆå§‹åŒ–é…ç½®ï¼›å‚ç…§æœ¬æ–‡ç¬¬äºŒéƒ¨åˆ†ï¼Œç¬¬1ç« èŠ‚çš„å†…å®¹éƒ¨ç½²elasticsearchç¨‹åºï¼Œæš‚ä¸å¯åŠ¨esæœåŠ¡ï¼›2ï¼‰åœ¨èŠ‚ç‚¹1ä¸Šä¸ºæ–°å¢žçš„ä¸¤ä¸ªèŠ‚ç‚¹åˆ¶ä½œè¯ä¹¦1./bin/elasticsearch-certutil cert --ca elastic-stack-ca.p12 --multipleä¾æ¬¡ä¸ºes-node2, es-node3ç”Ÿæˆè¯ä¹¦ï¼Œå¾—åˆ°åä¸ºcertificate-bundle.zipçš„è¾“å‡ºæ–‡ä»¶ï¼›ä¸ºç®€å•èµ·è§ï¼Œç»Ÿä¸€å°†ä¸¤ä¸ªæ–°èŠ‚ç‚¹è¯ä¹¦çš„å¯†ç ä¹Ÿè®¾ç½®ä¸ºå’ŒèŠ‚ç‚¹1ç›¸åŒçš„ es-node123 ï¼›å°†è§£åŽ‹ç¼©åŽå¾—åˆ°è¯ä¹¦æ–‡ä»¶ï¼Œå‚ç…§èŠ‚ç‚¹1çš„å­˜æ”¾è·¯å¾„ï¼ˆ/opt/elasticsearch-7.2.0/config/certsï¼‰ï¼Œåˆ†åˆ«éƒ¨ç½²åˆ°èŠ‚ç‚¹2å’ŒèŠ‚ç‚¹3ä¸ŠåŽ»ã€‚3ï¼‰ç¼–è¾‘3ä¸ªèŠ‚ç‚¹çš„ES_PATH_CONF/elasticsearch.ymlæ–‡ä»¶èŠ‚ç‚¹es-node1ï¼š12345678910cluster.name: my-elasticnode.name: es-node1bootstrap.memory_lock: truenetwork.host: 10.20.0.11cluster.initial_master_nodes: [&quot;es-node1&quot;,&quot;es-node2&quot;,&quot;es-node3&quot;]discovery.seed_hosts: [&quot;10.20.0.11&quot;,&quot;10.20.0.12&quot;,&quot;10.20.0.13&quot;]xpack.security.enabled: truexpack.security.transport.ssl.enabled: truexpack.security.transport.ssl.keystore.path: certs/$&#123;node.name&#125;.p12xpack.security.transport.ssl.truststore.path: certs/$&#123;node.name&#125;.p12èŠ‚ç‚¹es-node2ï¼š12345678910cluster.name: my-elasticnode.name: es-node2bootstrap.memory_lock: truenetwork.host: 10.20.0.12cluster.initial_master_nodes: [&quot;es-node1&quot;,&quot;es-node2&quot;,&quot;es-node3&quot;]discovery.seed_hosts: [&quot;10.20.0.11&quot;,&quot;10.20.0.12&quot;,&quot;10.20.0.13&quot;]xpack.security.enabled: truexpack.security.transport.ssl.enabled: truexpack.security.transport.ssl.keystore.path: certs/$&#123;node.name&#125;.p12xpack.security.transport.ssl.truststore.path: certs/$&#123;node.name&#125;.p12èŠ‚ç‚¹es-node3ï¼š123456789cluster.name: my-elasticnode.name: es-node3bootstrap.memory_lock: truenetwork.host: 10.20.0.13cluster.initial_master_nodes: [&quot;es-node1&quot;,&quot;es-node2&quot;,&quot;es-node3&quot;]discovery.seed_hosts: [&quot;10.20.0.11&quot;,&quot;10.20.0.12&quot;,&quot;10.20.0.13&quot;]xpack.security.enabled: truexpack.security.transport.ssl.enabled: truexpack.security.transport.ssl.keystore.path: certs/$&#123;node.name&#125;.p12xpack.security.transport.ssl.truststore.path: certs/$&#123;node.name&#125;.p124ï¼‰å°†ä¸¤ä¸ªæ–°èŠ‚ç‚¹çš„PKCS#12 è¯ä¹¦å£ä»¤å­˜å‚¨åœ¨Elasticsearch Keystoreä¸­123./bin/elasticsearch-keystore create./bin/elasticsearch-keystore add xpack.security.transport.ssl.keystore.secure_password./bin/elasticsearch-keystore add xpack.security.transport.ssl.truststore.secure_passwordæ ¹æ®æç¤ºï¼Œå°†èŠ‚ç‚¹è¯ä¹¦çš„å¯†ç ä¿¡æ¯es-node123ä¿å­˜åˆ°eså¯†é’¥åº“ä¸­5ï¼‰ä¾æ¬¡å¯åŠ¨ä¸‰ä¸ªèŠ‚ç‚¹ä¸Šçš„esæœåŠ¡1./bin/elasticsearchæ³¨æ„è§‚å¯Ÿæ—¥å¿—è¾“å‡ºå¯åŠ¨kibanaï¼Œåœ¨dev toolsä¸­æ‰§è¡ŒGET _cluster/health æŸ¥çœ‹é›†ç¾¤å¥åº·çŠ¶æ€ã€‚æ‰§è¡Œ GET _cat/nodes?v æŸ¥çœ‹master nodeè§’è‰²åˆ†å¸ƒï¼š]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[elastic stack 7.2æŠ€æœ¯æ ˆã€å››ã€‘åœ¨å•æœºç‰ˆesæŠ€æœ¯æ ˆä¹‹ä¸Šå¯ç”¨å’Œé…ç½®eså®‰å…¨ç®¡ç†åŠŸèƒ½]]></title>
    <url>%2F2019%2F12%2F31%2Felastic%20stack%207.2%E6%8A%80%E6%9C%AF%E6%A0%88%E3%80%90%E5%9B%9B%E3%80%91%E2%80%94%E2%80%94%20%E5%9C%A8%E5%8D%95%E6%9C%BA%E7%89%88es%E6%8A%80%E6%9C%AF%E6%A0%88%E4%B9%8B%E4%B8%8A%E5%90%AF%E7%94%A8%E5%92%8C%E9%85%8D%E7%BD%AEes%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%8A%9F%E8%83%BD%2F</url>
    <content type="text"><![CDATA[Elasticsearchå®‰å…¨åŠŸèƒ½ä½¿å¾—å¯ä»¥è½»æ¾ä¿æŠ¤ç¾¤é›†ã€‚ å¯ä»¥å¯¹æ•°æ®è¿›è¡ŒåŸºç¡€çš„å¯†ç ä¿æŠ¤ï¼Œå¹¶å®žæ–½æ›´é«˜çº§çš„å®‰å…¨æŽªæ–½ï¼Œä¾‹å¦‚åŠ å¯†é€šä¿¡ï¼ŒåŸºäºŽè§’è‰²çš„è®¿é—®æŽ§åˆ¶ï¼ŒIPè¿‡æ»¤å’Œå®¡è®¡ã€‚åœ¨æœ€æ–°å‘è¡Œçš„eså’Œkinabaç‰ˆæœ¬ä¸­ï¼Œbasicçº§åˆ«çš„è®¸å¯ä¸­å·²ç»å¼€æ”¾äº†éƒ¨åˆ†å®‰å…¨ç®¡ç†çš„åŠŸèƒ½ç‰¹æ€§ï¼Œå¯ä»¥å…è´¹ä½¿ç”¨ã€‚è¯¦ç»†ä¿¡æ¯å‚è§ï¼šhttps://www.elastic.co/subscriptionsä¾æ¬¡åœæ­¢Metricbeatã€kibanaå’ŒelasticsearchæœåŠ¡è¿›ç¨‹ç¼–è¾‘ES_PATH_CONF/elasticsearch.ymlæ–‡ä»¶ï¼Œå¯ç”¨xpackæœåŠ¡æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š1xpack.security.enabled: trueç¼–è¾‘ES_PATH_CONF/elasticsearch.ymlæ–‡ä»¶ï¼Œå¯ç”¨ single-node discoveryåŠŸèƒ½1discovery.type: single-nodeé€šè¿‡å°†discovery.typeè®¾ç½®ä¸ºsingle-nodeï¼Œ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒèŠ‚ç‚¹å°†é€‰æ‹©è‡ªå·±ä½œä¸ºä¸»èŠ‚ç‚¹ï¼Œå¹¶ä¸”ä¸ä¼šåŠ å…¥ä»»ä½•å…¶ä»–èŠ‚ç‚¹çš„é›†ç¾¤ã€‚å¯ç”¨Elasticsearchå®‰å…¨åŠŸèƒ½åŽï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šå¯ç”¨åŸºæœ¬èº«ä»½éªŒè¯ã€‚ è¦ä¸Žç¾¤é›†é€šä¿¡ï¼Œå¿…é¡»æŒ‡å®šç”¨æˆ·åå’Œå¯†ç ã€‚ é™¤éžå¯ç”¨äº†åŒ¿åè®¿é—®ï¼Œå¦åˆ™æ‰€æœ‰ä¸åŒ…å«ç”¨æˆ·åå’Œå¯†ç çš„è¯·æ±‚éƒ½å°†è¢«æ‹’ç»ã€‚ä¸ºå†…ç½®ç”¨æˆ·åˆ›å»ºå¯†ç æœ‰ä¸€äº›ç®¡ç†ç”¨é€”çš„é›†ç¾¤å†…å»ºç”¨æˆ·ï¼Œå¦‚apm_system, beats_system, elastic, kibana, logstash_system, and remote_monitoring_userï¼Œæˆ‘ä»¬éœ€è¦ä¸ºå…¶è®¾ç½®å¯†ç ã€‚è¿™äº›å†…å»ºç®¡ç†ç”¨æˆ·çš„è¯´æ˜Žä¿¡æ¯å‚è§ï¼š https://www.elastic.co/guide/en/elastic-stack-overview/7.2/built-in-users.htmlå¯åŠ¨esæœåŠ¡ï¼š1./bin/elasticsearchæ‰§è¡Œä¸‹é¢å‘½ä»¤è®¾ç½®å†…å»ºç®¡ç†ç”¨æˆ·çš„å¯†ç ï¼š1./bin/elasticsearch-setup-passwords interactiveè¿™é‡Œè®¾ç½®çš„è´¦å·å¯†ç ï¼Œåœ¨åŽç»­å„ç§æœåŠ¡é›†æˆé…ç½®ä¸­ä¼šä½¿ç”¨åˆ°ï¼Œæ‰€ä»¥åŠ¡å¿…åšå¥½è®°å½•ã€‚è¯¥å‘½ä»¤ä»…å¯ä»¥æ‰§è¡Œä¸€æ¬¡ã€‚123456elastic/elastic123apm_system/apm_system123kibana/kibana123logstash_system/logstash_system123beats_system/beats_system123remote_monitoring_user/remote_monitoring_user123è´¦å·ä¸Žå¯†ç ä¿¡æ¯çš„ç®¡ç†è¿™é‡Œåˆæœ‰ä¸¤ç§æ–¹å¼è¿›è¡Œé…ç½®ï¼Œä¸€ä¸ªæ˜¯ç›´æŽ¥å°†è´¦å·/å¯†ç ç»´æŠ¤åœ¨é…ç½®æ–‡ä»¶ä¸­ã€‚å¦ä¸€ä¸ªæ–¹æ³•æ˜¯ï¼ŒæŠŠè´¦å·/å¯†ç å­˜å‚¨åˆ°keystoreå¯†é’¥åº“ä¸­ã€‚åŽä¸€ç§çš„å®‰å…¨æ€§æ›´é«˜äº›ã€‚ç¼–è¾‘ KIBANA_HOME/config/kibana.yml ï¼š12elasticsearch.username: &quot;kibana&quot;elasticsearch.password: &quot;kibana123&quot;æˆ–è€…å­˜å‚¨åœ¨keystoreä¸­ï¼š12345678# æ”¾ç½®åŽ†å²æ“ä½œè®°å½•è¢«æŸ¥çœ‹åˆ°set +o historyexport LOGSTASH_KEYSTORE_PASS=mypassword set -o history./bin/kibana-keystore create./bin/kibana-keystore add elasticsearch.username./bin/kibana-keystore add elasticsearch.passwordåœ¨æç¤ºè¾“å…¥æ—¶ï¼Œæ ¹æ®æç¤ºè¾“å…¥kibana/kibana123çš„ç”¨æˆ·åå’Œå¯†ç ä¿¡æ¯ã€‚è¯¥è´¦å·å°†è¢«ç”¨äºŽkibanaè®¿é—®esæœåŠ¡æ—¶ä½¿ç”¨ã€‚å¯åŠ¨kibanaæœåŠ¡ï¼š1./bin/kibanaçŽ°åœ¨æˆ‘ä»¬å·²ç»è®¾ç½®å¥½äº†å†…ç½®ç”¨æˆ·ï¼Œéœ€è¦å†³å®šå¦‚ä½•ç®¡ç†æ‰€æœ‰å…¶ä»–ç”¨æˆ·ã€‚Elastic Stackå¯¹ç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯ä»¥ç¡®ä¿å®ƒä»¬æœ‰æ•ˆã€‚ èº«ä»½éªŒè¯è¿‡ç¨‹ç”±realmè¿›è¡Œå¤„ç†ã€‚ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªå†…ç½®realmï¼Œä¾‹å¦‚nativeï¼Œfileï¼ŒLDAPï¼ŒPKIï¼ŒActive Directoryï¼ŒSAMLæˆ–Kerberos realmã€‚ ä¹Ÿå¯ä»¥åˆ›å»ºè‡ªå·±çš„è‡ªå®šä¹‰realmã€‚ åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æœ¬æœºnative realmï¼Œè¿™ä¹Ÿæ˜¯basicè®¸å¯æ‰€å…è®¸å…è´¹ä½¿ç”¨çš„ç”¨æˆ·èº«ä»½éªŒè¯æ–¹å¼ä¹‹ä¸€ã€‚é€šå¸¸ï¼Œå¯ä»¥é€šè¿‡åœ¨elasticsearch.ymlæ–‡ä»¶ä¸­æ·»åŠ xpack.security.authc.realmè®¾ç½®æ¥é…ç½®realmã€‚ ä½†æ˜¯ï¼Œå¦‚æžœæœªé…ç½®å…¶ä»–åŸŸï¼Œåˆ™é»˜è®¤æƒ…å†µä¸‹ä¸ºä½¿ç”¨æœ¬æœºnative realmã€‚ å› æ­¤ï¼Œæ— éœ€åœ¨æœ¬æ•™ç¨‹ä¸­æ‰§è¡Œä»»ä½•é¢å¤–çš„é…ç½®æ­¥éª¤ï¼Œå°±å¯ä»¥ç›´æŽ¥è·³è½¬åˆ°åˆ›å»ºç”¨æˆ·äº†ï¼åˆ›å»ºç”¨æˆ·æˆ‘ä»¬åˆ›å»ºä¸¤ä¸ªåŸºäºŽnative realmçš„ç”¨æˆ·ã€‚ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€kibanaæœåŠ¡åœ°å€ï¼Œä¼šå‘çŽ°æ­¤æ—¶å·²ç»éœ€è¦ç™»å½•æ‰èƒ½ä½¿ç”¨kibanaæœåŠ¡äº†ã€‚1ï¼‰ä½¿ç”¨elastic/elastic123è´¦å·ï¼Œç™»å½•è¿›å…¥kibanaã€‚2ï¼‰è½¬åˆ°Management / Security / Usersé¡µé¢ã€‚3ï¼‰ç‚¹å‡»Create new userï¼Œåˆ›å»ºä¸€ä¸ªè´¦å·gqtest/gqtest123ï¼Œä½†æš‚æ—¶å…ˆä¸è®¾ç½®Rolesï¼Œè¯¥è´¦å·å°†ä½œä¸ºæŸ¥çœ‹kibanaçš„ä¸ªäººè´¦å·ä½¿ç”¨ã€‚4ï¼‰å†åˆ›å»ºä¸€ä¸ªlogstash_internal/logstash_internal123ç”¨æˆ·ï¼Œç”¨äºŽlogstashå‘eså†™å…¥æ•°æ®æ—¶ä½¿ç”¨ã€‚5ï¼‰é…ç½®è§’è‰²æŽˆæƒæ¯ä¸ªè§’è‰²å®šä¹‰ä¸€ç»„ç‰¹å®šçš„æ“ä½œï¼ˆå¦‚è¯»å–ï¼Œåˆ›å»ºæˆ–åˆ é™¤ï¼‰ï¼Œè¿™äº›æ“ä½œå¯ä»¥åœ¨ç‰¹å®šçš„å®‰å…¨èµ„æºï¼ˆä¾‹å¦‚ç´¢å¼•ï¼Œåˆ«åï¼Œæ–‡æ¡£ï¼Œå­—æ®µæˆ–é›†ç¾¤ï¼‰ä¸Šæ‰§è¡Œã€‚ eså·²ç»æä¾›äº†å¾ˆå¤šå†…ç½®è§’è‰²å¯ä»¥ç›´æŽ¥ä½¿ç”¨ã€‚æ‰“å¼€Management / Security / Rolesé¡µé¢ï¼ŒæŸ¥çœ‹ç³»ç»Ÿå†…ç½®çš„å„ç§Rolesã€‚ç‚¹å‡»æŸä¸ªè§’è‰²çš„åç§°ï¼Œå¯ä»¥æŸ¥çœ‹è¯¥è§’è‰²éƒ½è¢«æŽˆäºˆäº†å“ªäº›æƒé™ã€‚æˆ‘ä»¬å°†kibana_userè§’è‰²åˆ†é…ç»™ä½ çš„ç”¨æˆ·ã€‚ è¿”å›žManagement / Security / Usersé¡µé¢å¹¶é€‰æ‹©ä½ çš„ç”¨æˆ·ã€‚ æ·»åŠ kibana_userè§’è‰²å¹¶ä¿å­˜æ›´æ”¹ã€‚è¯¥è§’è‰²å°†æä¾›kibanaçš„æ‰€æœ‰ä½¿ç”¨æƒé™ã€‚åœ¨å®žé™…ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦ä¸ºç‰¹å®šçš„ç”¨æˆ·åˆ›å»ºä¸“ç”¨çš„kibanaè´¦å·ï¼Œä»…æ˜¾ç¤ºéƒ¨åˆ†kibanaåŠŸèƒ½èœå•ï¼ŒåŒæ—¶æŽ§åˆ¶å„èœå•é¡¹çš„è¯»ã€å†™æƒé™ã€‚è¿™äº›å¯ä»¥é€šè¿‡åœ¨kibanaä¸Šè‡ªå®šä¹‰Roleè§’è‰²æ¥å®žçŽ°ã€‚è¯¦æƒ…é…ç½®æ–¹æ³•å‚è§ï¼šhttps://www.elastic.co/guide/en/kibana/7.2/kibana-role-management.htmlåœ¨å‰é¢é…ç½®æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬åœ¨Elasticsearchä¸­å­˜å‚¨Metricbeatæ•°æ®ã€‚ è®©æˆ‘ä»¬åˆ›å»ºä¸¤ä¸ªè§’è‰²ï¼ŒæŽˆäºˆå¯¹è¯¥æ•°æ®çš„ä¸åŒçº§åˆ«çš„è®¿é—®æƒé™ã€‚è½¬åˆ°Management / Security / Rolesé¡µé¢ï¼Œç„¶åŽå•å‡»Create roleã€‚åˆ›å»ºä¸€ä¸ªmetricbeat_readerè§’è‰²ï¼Œè¯¥è§’è‰²å¯¹metricbeat- ç´¢å¼•å…·æœ‰readå’Œview_index_metadataç‰¹æƒï¼šåˆ›å»ºä¸€ä¸ªmetricbert_writerè§’è‰²ï¼Œè¯¥è§’è‰²å…·æœ‰manage_index_templatesçš„æƒé™å¹¶ç›‘è§†é›†ç¾¤ç‰¹æƒï¼Œä»¥åŠå¯¹metricbeat- ç´¢å¼•çš„write, delete, create_index, manageçš„ç‰¹æƒï¼šRole metricbert_writerï¼šçŽ°åœ¨è¿”å›žManagement / Security / Usersé¡µé¢å¹¶å°†è¿™äº›è§’è‰²åˆ†é…ç»™é€‚å½“çš„ç”¨æˆ·ã€‚ å°†metricbeat_readerè§’è‰²åˆ†é…ç»™ä½ çš„ä¸ªäººç”¨æˆ·ã€‚ å°†metricbeat_writerè§’è‰²åˆ†é…ç»™logstash_internalç”¨æˆ·ã€‚å¦‚æžœéœ€è¦äº†è§£æ›´å¤šçš„æŽˆæƒå’Œè§’è‰²ç®¡ç†çŸ¥è¯†ï¼Œè¯·å‚è§ï¼šhttps://www.elastic.co/guide/en/elastic-stack-overview/7.2/authorization.html6ï¼‰é…ç½®Logstashæˆ–Metricbeatä½¿ç”¨esè´¦å·Logstashçš„é…ç½®æ–¹æ³•å‚è§ï¼šhttps://www.elastic.co/guide/en/elastic-stack-overview/7.2/get-started-logstash-user.htmlMetricbeaté…ç½®ä½¿ç”¨esè´¦å·åˆ›å»ºä¸€ä¸ªkeystoreå¯†é’¥åº“ï¼š1./metricbeat keystore createå°†æ•æ„Ÿçš„å¯†ç ä¿¡æ¯å­˜æ”¾åœ¨å¯†é’¥åº“é‡Œï¼š1./metricbeat keystore add ES_PWDä½¿ç”¨è´¦å·metricbeat_internal/metricbeat_internal123ï¼Œå°†å…¶å¯†ç ä¿¡æ¯ä¿å­˜äºŽkeystoreä¸­çš„ES_PWDå˜é‡ä¸­ã€‚metricbeat_internalæ˜¯æˆ‘ä»¬åˆ›å»ºçš„ä¸€ä¸ªç”¨æˆ·ï¼ŒæŽˆäºˆäº†beats_system, kibana_userï¼Œmetricbert_writerè¿™3ä¸ªè§’è‰²æƒé™ã€‚æŸ¥çœ‹ä¸Žåˆ é™¤çš„æ–¹æ³•ï¼š12./metricbeat keystore list./metricbeat keystore remove ES_PWDç¼–è¾‘metricbeat.ymlé…ç½®æ–‡ä»¶ï¼š12345678910111213setup.kibana: host: &quot;es-node1:5601&quot; username: &quot;metricbeat_internal&quot; password: &quot;$&#123;ES_PWD&#125;&quot;#-------------------------- Elasticsearch output ------------------------------output.elasticsearch: # Array of hosts to connect to. hosts: [&quot;localhost:9200&quot;] # Optional protocol and basic auth credentials. #protocol: &quot;https&quot; username: &quot;beats_system&quot; password: &quot;$&#123;ES_PWD&#125;&quot;å¯åŠ¨MetricbeatæœåŠ¡ï¼š1./metricbeat -eå›žåˆ°kibanaçš„webé¡µé¢ï¼Œä½¿ç”¨ä¹‹å‰åˆ›å»ºçš„gqtest/gqtest123è´¦å·ç™»å½•å¹¶æŸ¥çœ‹ç³»ç»ŸæŒ‡æ ‡æ•°æ®ï¼Œè¯¥è´¦å·å…·æœ‰metricbeat_reader å’Œ kibana_userçš„æŽˆæƒã€‚å¯ä»¥çœ‹åˆ°Metricbeaté‡‡é›†çš„ç³»ç»ŸæŒ‡æ ‡æ•°æ®æ­£å¸¸å†™å…¥elasticsearchï¼Œä¸”åœ¨kibanaä¸Šæ­£å¸¸å±•ç¤ºï¼Œåˆ™å¯ä»¥ç»§ç»­é…ç½®ä¸‹é¢çš„æ­¥éª¤ã€‚]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[elastic stack 7.2æŠ€æœ¯æ ˆã€ä¸‰ã€‘éƒ¨ç½²å•æœºç‰ˆæœ¬çš„elasticsearchæŠ€æœ¯æ ˆ]]></title>
    <url>%2F2019%2F12%2F31%2Felastic%20stack%207.2%E6%8A%80%E6%9C%AF%E6%A0%88%E3%80%90%E4%B8%89%E3%80%91%E2%80%94%E2%80%94%20%E9%83%A8%E7%BD%B2%E5%8D%95%E6%9C%BA%E7%89%88%E6%9C%AC%E7%9A%84elasticsearch%E6%8A%80%E6%9C%AF%E6%A0%88%2F</url>
    <content type="text"><![CDATA[åœ¨èŠ‚ç‚¹1ä¸Šé¢å®‰è£…å•èŠ‚ç‚¹es12curl -L -O https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.2.0-linux-x86_64.tar.gztar -xzvf elasticsearch-7.2.0-linux-x86_64.tar.gzå¯¹elasticsearch.ymlå‡ ä¸ªé‡è¦é…ç½®å‚æ•°è¿›è¡Œè®¾ç½®ï¼š1234cluster.name: my-elasticnode.name: es-node1# network.host: 10.20.0.11bootstrap.memory_lock: trueæš‚ä¸èƒ½å¯ç”¨network.hostå‚æ•°ï¼Œå¦åˆ™ä¼šè§¦å‘esçš„å¼ºè°ƒé›†ç¾¤é…ç½®æ£€æŸ¥ï¼Œå› ä¸ºesé›†ç¾¤é…ç½®è¿˜ä¸å®Œæ•´ï¼Œæ‰€ä»¥è¿™ä¼šå¯¼è‡´å¯åŠ¨å¤±è´¥å¯åŠ¨esæœåŠ¡ï¼š12cd elasticsearch-7.2.0./bin/elasticsearchæ£€æµ‹ä¸‹æœåŠ¡æ˜¯å¦æ­£å¸¸å¯åŠ¨ï¼š1curl http://10.20.0.11:9200åœ¨èŠ‚ç‚¹1ä¸Šå®‰è£…kibana123curl -L -O https://artifacts.elastic.co/downloads/kibana/kibana-7.2.0-linux-x86_64.tar.gztar xzvf kibana-7.2.0-linux-x86_64.tar.gzcd kibana-7.2.0-linux-x86_64/ç¼–è¾‘config/kibana.ymlæ–‡ä»¶ï¼š12elasticsearch.hosts: [&quot;http://10.20.0.11:9200&quot;]server.host: &quot;es-node1&quot;å¯åŠ¨ï¼š1./bin/kibanaè°ƒæ•´é˜²ç«å¢™æ”¾è¡Œè§„åˆ™ï¼š12firewall-cmd --permanent --zone=public --add-port=5601/tcpfirewall-cmd --reloadæ£€æµ‹æœåŠ¡æ˜¯å¦æ­£å¸¸å¯åŠ¨ï¼š1curl http://10.20.0.11:5601åœ¨èŠ‚ç‚¹1ä¸Šå®‰è£…BeatsBeatsé’ˆå¯¹ä¸åŒçš„ä½¿ç”¨åœºæ™¯ï¼Œåˆ†åˆ«æä¾›äº†ä¸åŒçš„å·¥å…·å®žçŽ°ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨Metricbeatå¯¹èŠ‚ç‚¹ä¸»æœºçš„ç³»ç»Ÿè¿›è¡Œç›‘æŽ§ã€‚Metricbeatæä¾›é¢„æž„å»ºçš„æ¨¡å—ï¼Œå¯ä»¥ä½¿ç”¨å®ƒä»¬å¿«é€Ÿå®žæ–½å’Œéƒ¨ç½²ç³»ç»Ÿç›‘æŽ§è§£å†³æ–¹æ¡ˆã€‚12curl -L -O https://artifacts.elastic.co/downloads/beats/metricbeat/metricbeat-7.2.0-linux-x86_64.tar.gztar xzvf metricbeat-7.2.0-linux-x86_64.tar.gzåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†è¿è¡ŒMetricbeatçš„systemæ¨¡å—ä»¥ä»ŽæœåŠ¡å™¨ä¸Šè¿è¡Œçš„æ“ä½œç³»ç»Ÿå’ŒæœåŠ¡æ”¶é›†æŒ‡æ ‡ã€‚systemæ¨¡å—æ”¶é›†ç³»ç»Ÿçº§æŒ‡æ ‡ï¼Œä¾‹å¦‚CPUä½¿ç”¨çŽ‡ï¼Œå†…å­˜ï¼Œæ–‡ä»¶ç³»ç»Ÿï¼Œç£ç›˜IOå’Œç½‘ç»œIOç»Ÿè®¡ä¿¡æ¯ï¼Œä»¥åŠç³»ç»Ÿä¸Šè¿è¡Œçš„æ¯ä¸ªè¿›ç¨‹çš„ç±»ä¼¼é¡¶çº§çš„ç»Ÿè®¡ä¿¡æ¯ã€‚å¯ç”¨systemæ¨¡å—ï¼š1./metricbeat modules enable systemåˆå§‹åŒ–æ•°æ®ï¼š1./metricbeat setup -eå¦‚æžœå‰ä¸€æ­¥ä¸­kibanaæœåŠ¡ç»‘å®šçš„ç½‘å¡å˜æ›´ä¸ºå¯¹å¤–æœåŠ¡çš„ç½‘å¡äº†ï¼Œåˆ™åœ¨æ‰§è¡Œè¿™ä¸ªå‘½ä»¤å‰è¯·ä¿®æ”¹metricbeat.ymlæ–‡ä»¶ä¸­kibanaæœåŠ¡åœ°å€çš„å®šä¹‰ã€‚å¯åŠ¨MetricbeatæœåŠ¡ï¼š1./metricbeat -eè¦çœ‹å¯è§†åŒ–ç³»ç»ŸæŒ‡æ ‡ï¼Œè¯·æ‰“å¼€æµè§ˆå™¨å¹¶å¯¼èˆªåˆ°Metricbeatç³»ç»Ÿæ¦‚è¿°ä»ªè¡¨æ¿ï¼šhttp://10.20.0.11:5601/app/kibana#/dashboard/Metricbeat-system-overview-ecsè‡³æ­¤ï¼Œå•æœºç‰ˆæœ¬çš„éƒ¨ç½²å®Œæˆï¼Œåœ¨éƒ¨ç½²ç»“æžœé€šè¿‡éªŒæ”¶åŽï¼Œè¿›å…¥ä¸‹ä¸€æ­¥éª¤ï¼Œå¯ç”¨å’Œé…ç½®å‡ºeså®‰å…¨ç®¡ç†åŠŸèƒ½ã€‚]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[elastic stack 7.2æŠ€æœ¯æ ˆã€ä¸ƒã€‘å¯ç”¨Metricbeatçš„å®‰å…¨æ€§é…ç½®]]></title>
    <url>%2F2019%2F12%2F31%2Felastic%20stack%207.2%E6%8A%80%E6%9C%AF%E6%A0%88%E3%80%90%E4%B8%83%E3%80%91%E2%80%94%E2%80%94%E5%90%AF%E7%94%A8Metricbeat%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7%E9%85%8D%E7%BD%AE%2F</url>
    <content type="text"><![CDATA[æˆ‘ä»¬ä½¿ç”¨Metricbeaté‡‡é›†esä¸»æœºèŠ‚ç‚¹çš„ç³»ç»Ÿç›‘æŽ§æŒ‡æ ‡æ•°æ®ï¼Œä»¥åŠç›‘æŽ§esé›†ç¾¤ä¸­ç´¢å¼•ç­‰æœåŠ¡ã€‚å¯¹æ¯ä¸ªesæœåŠ¡èŠ‚ç‚¹ç¼–è¾‘elasticsearch.ymlï¼Œä»¥å¯ç”¨ç›‘æŽ§æ•°æ®é‡‡é›†1xpack.monitoring.collection.enabled: trueåœ¨æ¯ä¸ªèŠ‚ç‚¹çš„metricbeatéƒ¨ç½²ç›®å½•ä¸‹ï¼Œå¯ç”¨elasticsearch-xpackæ¨¡å—1./metricbeat modules enable elasticsearch-xpackè¿›å…¥elasticsearchéƒ¨ç½²ç›®å½•ï¼Œä¸ºæ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„Metricbeatåˆ¶ä½œä¸€ä¸ªæ•°å­—è¯ä¹¦123./bin/elasticsearch-certutil cert --ca elastic-stack-ca.p12 --name es-node1 --ip 10.20.0.11 --pem./bin/elasticsearch-certutil cert --ca elastic-stack-ca.p12 --name es-node2 --ip 10.20.0.12 --pem./bin/elasticsearch-certutil cert --ca elastic-stack-ca.p12 --name es-node3 --ip 10.20.0.13 --pemæ‰§è¡Œä»¥ä¸Šå‘½ä»¤ï¼Œå°†è¾“å‡ºç»“æžœåˆ†åˆ«ä¿å­˜ä¸ºes-node1.zip es-node2.zip es-node3.zipå°†åŽ‹ç¼©åŒ…è§£åŽ‹åŽçš„è¯ä¹¦æ–‡ä»¶ï¼Œåˆ†åˆ«éƒ¨ç½²åˆ°æ¯ä¸ªä¸»æœºèŠ‚ç‚¹ä¸ŠMetricbeatä¸‹çš„certså­ç›®å½•ä¸­ï¼Œæ–‡ä»¶å±žä¸»elastic.elasticï¼Œè®¿é—®æƒé™600å› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯è‡ªç­¾CAè¯ä¹¦ï¼Œæ‰€ä»¥è¿˜éœ€è¦æŠŠCAè¯ä¹¦å…¬é’¥æ–‡ä»¶cacert.pemï¼ŒåŒæ ·åœ¨certsç›®å½•ä¸­æ”¾ä¸€ä»½ç¼–è¾‘modules.d/elasticsearch-xpack.ymlæ–‡ä»¶123456789101112131415161718- module: elasticsearch metricsets: - ccr - cluster_stats - index - index_recovery - index_summary - ml_job - node_stats - shard period: 10s hosts: [&quot;https://10.20.0.11:9200&quot;] username: &quot;remote_monitoring_user&quot; password: &quot;remote_monitoring_user123&quot; ssl.certificate_authorities: [&quot;certs/cacert.pem&quot;] ssl.certificate: &quot;certs/es-node1.crt&quot; ssl.key: &quot;certs/es-node1.key&quot; xpack.enabled: trueè¿™é‡Œä½¿ç”¨äº†ä¸€ä¸ªesæä¾›çš„å†…å»ºç®¡ç†è´¦å·remote_monitoring_userç¼–è¾‘metricbeat.ymlæ–‡ä»¶åœ¨èŠ‚ç‚¹1ä¸Šé¢ï¼š12345678910111213setup.kibana: host: &quot;https://es-node1:5601&quot; username: &quot;metricbeat_internal&quot; password: &quot;$&#123;ES_PWD&#125;&quot;output.elasticsearch: hosts: [&quot;10.20.0.11:9200&quot;] protocol: &quot;https&quot; ssl.certificate_authorities: [&quot;certs/cacert.pem&quot;] username: &quot;metricbeat_internal&quot; password: &quot;$&#123;ES_PWD&#125;&quot; ssl.certificate: &quot;certs/es-node1.crt&quot; ssl.key: &quot;certs/es-node1.key&quot;åœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨å‰é¢ç« èŠ‚ä¸­åˆ›å»ºçš„è´¦å·metricbeat_internalåŒæ—¶ä½œä¸ºmetricbeatè®¿é—®kibanaå’Œelasticsearchæ—¶çš„æŽˆæƒè´¦å·ï¼›éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨å¯ç”¨äº†eså®‰å…¨ç‰¹æ€§åŽï¼Œmetricbeaté‡‡é›†å’Œå‘esç´¢å¼•å†™å…¥ç›‘æŽ§æŒ‡æ ‡æ•°æ®æ—¶éœ€è¦æ‹¥æœ‰é€‚å½“çš„è§’è‰²æŽˆæƒï¼Œè¯·ä½¿ç”¨elasticè´¦å·ç™»å½•kibanaå¹¶ä¸ºmetricbeat_internalç”¨æˆ·å¢žåŠ remote_monitoring_collectorã€remote_monitoring_agentä¸¤ä¸ªè§’è‰²çš„æŽˆæƒã€‚å‚ç…§ä¸Šé¢çš„è¯´æ˜Žï¼Œå¯¹èŠ‚ç‚¹2å’ŒèŠ‚ç‚¹3ä¸Šçš„Metricbeaté…ç½®æ–‡ä»¶metricbeat.ymlè¿›è¡Œä¿®æ”¹ï¼Œæ³¨æ„è¦å¼•ç”¨æœ¬èŠ‚ç‚¹çš„å¯†é’¥æ–‡ä»¶åã€‚å¯åŠ¨MetricbeatæœåŠ¡1./metricbeat -eç¡®è®¤æ—¥å¿—è¾“å‡ºä¸­æ²¡æœ‰éœ€è¦å¼•èµ·æ³¨æ„çš„warningæˆ–errorä¿¡æ¯ç™»å½•kibanaå¹¶æŸ¥çœ‹Stack Monitoré¡µé¢ï¼Œå¦‚æžœèƒ½æ­£å¸¸çœ‹åˆ°ä»¥ä¸‹å†…å®¹åˆ™è¡¨ç¤ºç›‘æŽ§æ•°æ®é‡‡é›†å’Œå±•ç¤ºæ˜¯æ­£ç¡®çš„]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[elastic stack 7.2æŠ€æœ¯æ ˆã€å…­ã€‘å¯ç”¨Kibanaä¸­çš„å®‰å…¨æ€§é…ç½®]]></title>
    <url>%2F2019%2F12%2F31%2Felastic%20stack%207.2%E6%8A%80%E6%9C%AF%E6%A0%88%E3%80%90%E5%85%AD%E3%80%91%E2%80%94%E2%80%94%E5%90%AF%E7%94%A8Kibana%E4%B8%AD%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7%E9%85%8D%E7%BD%AE%2F</url>
    <content type="text"><![CDATA[æœ¬ç« èŠ‚ä¸»è¦åŒ…æ‹¬é…ç½®kibanaçš„ä¼šè¯å®‰å…¨å’ŒåŠ å¯†é€šä¿¡ä¸¤é¡¹å†…å®¹ã€‚é…ç½®xpack.security.encryptionKeyå±žæ€§ç”¨äºŽåŠ å¯†cookieä¸­çš„å‡­æ®çš„ä»»æ„å­—ç¬¦ä¸²ï¼Œé•¿åº¦ä¸è¶…è¿‡32ä¸ªå­—ç¬¦ã€‚ è‡³å…³é‡è¦çš„æ˜¯ï¼Œè¿™ä¸ªå¯†é’¥ä¸ä¼šæš´éœ²ç»™Kibanaçš„ç”¨æˆ·ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œä¼šåœ¨å†…å­˜ä¸­è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå€¼ã€‚ å¦‚æžœä½¿ç”¨è¯¥é»˜è®¤è¡Œä¸ºï¼Œåˆ™åœ¨Kibanaé‡æ–°å¯åŠ¨æ—¶ï¼Œæ‰€æœ‰ä¼šè¯éƒ½å°†å¤±æ•ˆã€‚è®¾ç½®ä¼šè¯è¶…æ—¶æ—¶é—´ä¸º30minã€‚åœ¨kibana.ymlé…ç½®æ–‡ä»¶ä¸­ï¼š12xpack.security.encryptionKey: &quot;something_at_least_32_characters&quot;xpack.security.sessionTimeout: 1800000é…ç½®kibanaä½¿ç”¨httpsè®¿é—®esæœåŠ¡åœ¨èŠ‚ç‚¹1ä¸Šeså®¶ç›®å½•ä¸‹ï¼Œä¸ºkibanaæœåŠ¡åˆ¶ä½œæ•°å­—è¯ä¹¦ï¼š1./bin/elasticsearch-certutil cert --ca elastic-stack-ca.p12 --name es-node1 --ip 10.20.0.11 --pemå°†å¾—åˆ°çš„è¯ä¹¦æ–‡ä»¶å­˜æ”¾åˆ°kibanaéƒ¨ç½²è·¯å¾„çš„é…ç½®æ–‡ä»¶ç›®å½•ä¸‹certså­ç›®å½•ä¸­ï¼š1234[elastic@es-node1 certs]$ pwd/opt/kibana-7.2.0-linux-x86_64/config/certs[elastic@es-node1 certs]$ lses-node1.crt es-node1.keyåœ¨kibana.ymlæ–‡ä»¶ä¸­ä¸ºkibanaé…ç½®sslçš„ç›¸å…³å‚æ•°123server.ssl.enabled: trueserver.ssl.key: config/certs/es-node1.keyserver.ssl.certificate: config/certs/es-node1.crtæ­¤æ—¶ï¼Œå¯åŠ¨kibanaæœåŠ¡ï¼ŒéªŒè¯é€šè¿‡ https://10.20.0.11:5601 æ˜¯å¦å¯ä»¥æˆåŠŸè®¿é—®ç½‘ç«™ã€‚è‡³æ­¤ï¼Œæˆ‘ä»¬åœ¨è®¿é—®kibanaæœåŠ¡æ—¶å·²ç»å®žçŽ°çš„åŠ å¯†é€šä¿¡ã€‚æŽ¥ä¸‹æ¥ï¼Œç»§ç»­å°†kibanaè®¿é—®elasticsearchæœåŠ¡çš„è¿‡ç¨‹åˆ‡æ¢åˆ°httpsåŠ å¯†é€šä¿¡ã€‚é…ç½®kibanaé€šè¿‡httpsè®¿é—®elasticsearchå› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯è‡ªç­¾åè¯ä¹¦ï¼Œæ‰€ä»¥éœ€è¦ä¸ºkibanaæä¾›caè¯ä¹¦ã€‚æˆ‘ä»¬å…ˆåœ¨èŠ‚ç‚¹1ä¸Šï¼Œå°†pkcs12æ ¼å¼çš„caè¯ä¹¦è½¬æ¢ä¸ºkibanaé€‚ç”¨çš„pemæ ¼å¼ï¼Œå…¶ä¸­cacert.pemæ˜¯è¯ä¹¦å…¬é’¥æ–‡ä»¶ã€‚12openssl pkcs12 -nocerts -nodes -in elastic-stack-ca.p12 -out private.pemopenssl pkcs12 -clcerts -nokeys -in elastic-stack-ca.p12 -out cacert.pemåœ¨kibana.ymlæ–‡ä»¶ä¸­é…ç½®elasticsearch.hostså‚æ•°ï¼Œå¹¶æŒ‡å®šcaè¯ä¹¦æ–‡ä»¶ä½ç½®ï¼šï¼š12elasticsearch.hosts: [&quot;https://10.20.0.11:9200&quot;]elasticsearch.ssl.certificateAuthorities: [ &quot;config/certs/cacert.pem&quot; ]å°†Kibanaé…ç½®ä¸ºé€šè¿‡HTTPSè¿žæŽ¥åˆ°Elasticsearchç›‘æŽ§é›†ç¾¤ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªesé›†ç¾¤ï¼š12xpack.monitoring.elasticsearch.hosts: [&quot;https://10.20.0.11:9200&quot;]xpack.monitoring.elasticsearch.ssl.certificateAuthorities: config/certs/cacert.pemé…ç½®ä¸‰ä¸ªèŠ‚ç‚¹ä¸Šçš„elasticsearchæœåŠ¡ï¼Œåœ¨elasticsearch.ymlæ–‡ä»¶ä¸­è¡¥å……ä»¥ä¸‹http.sslæœåŠ¡ä½¿ç”¨çš„é…ç½®å‚æ•°ï¼š123xpack.security.http.ssl.enabled: truexpack.security.http.ssl.keystore.path: certs/$&#123;node.name&#125;.p12xpack.security.http.ssl.truststore.path: certs/$&#123;node.name&#125;.p12å°†http.sslè®¿é—®è¯ä¹¦æ—¶ä½¿ç”¨çš„å¯†ç ä¿¡æ¯å­˜å‚¨åœ¨å¯†é’¥åº“ä¸­ï¼š12bin/elasticsearch-keystore add xpack.security.http.ssl.keystore.secure_passwordbin/elasticsearch-keystore add xpack.security.http.ssl.truststore.secure_passwordåœ¨å‰é¢ç« èŠ‚ä¸­æˆ‘ä»¬ä¸ºèŠ‚ç‚¹è¯ä¹¦è®¾ç½®çš„å¯†ç æ˜¯ï¼šes-node123ä¸‰ä¸ªesèŠ‚ç‚¹ä¸Šå‡éœ€è¦è®¾ç½®é‡å¯æœåŠ¡è¿›ç¨‹å¹¶éªŒè¯é…ç½®ç»“æžœé‡å¯ä¸‰èŠ‚ç‚¹ä¸Šçš„esæœåŠ¡è¿›ç¨‹ï¼šbin/elasticsearché‡å¯èŠ‚ç‚¹1ä¸Šçš„kibanaæœåŠ¡è¿›ç¨‹ï¼šbin/kibanaçœ‹åˆ°ä¸‹é¢è¿™æ ·çš„æ—¥å¿—è¾“å‡ºæ—¶ï¼Œå¯ä»¥ç¡®è®¤é…ç½®æˆåŠŸäº†ï¼š12log [18:46:19.967] [info][listening] Server running at https://es-node1:5601log [18:46:19.997] [info][status][plugin:spaces@7.2.0] Status changed from yellow to green - Read]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[elastic stack 7.2æŠ€æœ¯æ ˆã€äºŒã€‘æ“ä½œç³»ç»Ÿçš„åˆå§‹åŒ–é…ç½®]]></title>
    <url>%2F2019%2F12%2F31%2Felastic%20stack%207.2%E6%8A%80%E6%9C%AF%E6%A0%88%E3%80%90%E4%BA%8C%E3%80%91%E2%80%94%E2%80%94%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%E9%85%8D%E7%BD%AE%2F</url>
    <content type="text"><![CDATA[æ“ä½œç³»ç»Ÿä½¿ç”¨centos7 minimualç‰ˆæœ¬ã€‚elasticsearchæŠ€æœ¯æ ˆå‡é‡‡ç”¨ 7.2ç‰ˆæœ¬ï¼Œé»˜è®¤ä½¿ç”¨basicè®¸å¯ï¼Œå¯å…è´¹ä½¿ç”¨xpackéƒ¨åˆ†å®‰å…¨ç®¡ç†æœåŠ¡ã€‚éƒ¨ç½²ä½¿ç”¨çš„ä¸»æœºèµ„æºè§„åˆ’ä½¿ç”¨3ä¸ªä¸»æœºèŠ‚ç‚¹10.20.0.11 es-node110.20.0.12 es-node210.20.0.13 es-node3å‡çº§è‡³æœ€æ–°çš„ç³»ç»Ÿå°ç‰ˆæœ¬1yum -y update &amp;&amp; hostnamectl set-hostname es-node1åœ¨è®¾ç½®èŠ‚ç‚¹2ï¼ŒèŠ‚ç‚¹3æ—¶è¯·æ³¨æ„å˜æ›´ä¸ºæ­£ç¡®çš„ä¸»æœºåç¦ç”¨swapå› ä¸ºesæ˜¯åœ¨jvmä¸­è¿è¡Œçš„ï¼Œåœ¨å†…å­˜ä½¿ç”¨ä¸Šæ¶‰åŠä¸åˆ°ä½¿ç”¨swapã€‚12swapoff -ased -i &apos;/swap/d&apos; /etc/fstabç³»ç»Ÿå¯ç”¨èµ„æºé™åˆ¶æ–‡ä»¶å¥æŸ„ä¸Žæœ€å¤§çº¿ç¨‹å¹¶å‘æ•°é‡ï¼š12345678cat &lt;&lt; EOF &gt;&gt; /etc/security/limits.conf* soft nofile 65535* hard nofile 65535* soft nproc 4096* hard nproc 4096* soft memlock unlimited* hard memlock unlimitedEOFè™šæ‹Ÿå†…å­˜Elasticsearch uses a mmapfs directory by default to store its indices.12345cat &lt;&lt; EOF &gt;&gt; /etc/sysctl.confvm.max_map_count=262144EOFsysctl -pMMap FSç±»åž‹é€šè¿‡å°†æ–‡ä»¶æ˜ å°„åˆ°å†…å­˜ï¼ˆmmapï¼‰æ¥å°†åˆ†ç‰‡ç´¢å¼•å­˜å‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿä¸Šï¼ˆæ˜ å°„åˆ°Lucene MMapDirectoryï¼‰ã€‚ å†…å­˜æ˜ å°„ä½¿ç”¨è¿›ç¨‹ä¸­è™šæ‹Ÿå†…å­˜åœ°å€ç©ºé—´çš„ä¸€éƒ¨åˆ†ç­‰äºŽè¦æ˜ å°„çš„æ–‡ä»¶çš„å¤§å°ã€‚ åœ¨ä½¿ç”¨æ­¤ç±»ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨å·²ç»æ‹¥æœ‰è¶³å¤Ÿçš„è™šæ‹Ÿåœ°å€ç©ºé—´ã€‚åˆ›å»ºesä¸“ç”¨çš„ç³»ç»Ÿç”¨æˆ·useradd elasticé…ç½®firewalldé˜²ç«å¢™è§„åˆ™123firewall-cmd --zone=public --permanent --add-rich-rule=&quot;rule family=&apos;ipv4&apos; source address=&apos;10.20.0.0/24&apos; accept&quot;firewall-cmd --reloadfirewall-cmd --list-allå…³é—­selinux12setenforce 0sed -i &apos;/SELINUX/s/enforcing/disabled/&apos; /etc/selinux/configé…ç½®/etc/hosts12345cat &lt;&lt; EOF &gt;&gt; /etc/hosts10.20.0.11 es-node110.20.0.12 es-node210.20.0.13 es-node3EOFé‡å¯ç³»ç»ŸéªŒè¯å„é¡¹é…ç½®ç”Ÿæ•ˆåŽï¼Œç»§ç»­æœ¬ç³»åˆ—æ–‡ç« çš„ä¸‹é¢ç« èŠ‚çš„é…ç½®ã€‚]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[elastic stack 7.2æŠ€æœ¯æ ˆã€å…«ã€‘Filebeatä¸ŽLogstashä¸¤ä¸ªå·¥å…·ä¹‹é—´æ€Žæ ·é…ç½®SSLåŠ å¯†é€šä¿¡]]></title>
    <url>%2F2019%2F12%2F31%2Felastic%20stack%207.2%E6%8A%80%E6%9C%AF%E6%A0%88%E3%80%90%E5%85%AB%E3%80%91%E2%80%94%E2%80%94%20Filebeat%E4%B8%8ELogstash%E4%B8%A4%E4%B8%AA%E5%B7%A5%E5%85%B7%E4%B9%8B%E9%97%B4%E6%80%8E%E6%A0%B7%E9%85%8D%E7%BD%AESSL%E5%8A%A0%E5%AF%86%E9%80%9A%E4%BF%A1%2F</url>
    <content type="text"><![CDATA[åœ¨ç›®å‰æ¯”è¾ƒæµè¡Œçš„æŠ€æœ¯å®žè·µæ–¹æ¡ˆé‡Œï¼ŒFilebeatå¤§å¤šç”¨ä½œæ—¥å¿—é‡‡é›†å·¥å…·ï¼Œè™½ç„¶å®ƒå¯ä»¥ç›´æŽ¥å°†æ•°æ®å†™å…¥Elasticsearchä¸­ï¼Œä½†å‡ºäºŽå„æ–¹é¢çš„æ•ˆçŽ‡è€ƒè™‘ï¼Œä¸€èˆ¬éƒ½ä¼šé€šè¿‡Logstashåšä¸€ä¸ªæ—¥å¿—æ•°æ®çš„æ±‡èšã€è½¬æ¢å’Œåˆ†å‘å¤„ç†ã€‚ä¸ºäº†ä¿è¯åº”ç”¨æ—¥å¿—æ•°æ®çš„ä¼ è¾“å®‰å…¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨SSLç›¸äº’èº«ä»½éªŒè¯æ¥ä¿æŠ¤Filebeatå’ŒLogstashä¹‹é—´çš„è¿žæŽ¥ã€‚ è¿™å¯ä»¥ç¡®ä¿Filebeatä»…å°†åŠ å¯†æ•°æ®å‘é€åˆ°å—ä¿¡ä»»çš„LogstashæœåŠ¡å™¨ï¼Œå¹¶ç¡®ä¿LogstashæœåŠ¡å™¨ä»…ä»Žå—ä¿¡ä»»çš„Filebeatå®¢æˆ·ç«¯æŽ¥æ”¶æ•°æ®ã€‚ä¸‹é¢å°±è®²è¿°ä¸€ä¸‹é…ç½®Filebeatä¸ŽLogstashä¹‹é—´è¿›è¡ŒåŠ å¯†é€šä¿¡çš„æ–¹æ³•ã€‚å…¨æ–‡æ˜¯åœ¨CentOS7ä¸ŠåŸºäºŽElastic 7.2æŠ€æœ¯æ ˆæ‰€éªŒè¯çš„ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªè‡ªç­¾çš„CAè¯ä¹¦ï¼Œä»¥åŠä½¿ç”¨è¯¥CAè¯ä¹¦ç­¾ç½²çš„ä¸¤ä»½æ•°æ®è¯ä¹¦ã€‚ä¸€ä»½æ˜¯ç»™Logstashä½œä¸ºserverç«¯éªŒè¯è‡ªå·±èº«ä»½æ—¶ä½¿ç”¨ï¼Œä¸€ä»½æ˜¯æä¾›ç»™Filebeatå®¢æˆ·ç«¯éªŒè¯è‡ªå·±èº«ä»½ä½¿ç”¨ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ˜¯ç›´æŽ¥åˆ©ç”¨çš„Elasticsearchéšå®‰è£…åŒ…æä¾›çš„æ•°å­—è¯ä¹¦å·¥å…·elasticsearch-certutilæ¥åˆ¶ä½œéœ€è¦çš„è¯ä¹¦ã€‚å¦‚æžœæ‚¨éœ€è¦å¯¹è¯¥å·¥å…·åšæ›´å¤šçš„äº†è§£ï¼Œå‚è€ƒå®˜ç½‘çš„è¿™ä¸ªèµ„æ–™ï¼šelasticsearch-certutilåˆ¶ä½œè‡ªç­¾çš„CAè¯ä¹¦åœ¨Linuxä¸‹ï¼Œè¿›å…¥åˆ°Elasticsearchç¨‹åºçš„éƒ¨ç½²å®¶ç›®å½•ä¸­ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯ä»¥ç”Ÿæˆä¸€ä»½è‡ªç­¾çš„CAè¯ä¹¦ï¼š1./bin/elasticsearch-certutil caä½¿ç”¨é»˜è®¤è¾“å‡ºæ–‡ä»¶åelastic-stack-ca.p12ï¼Œå¹¶ä¸ºè¯ä¹¦è®¾ç½®è®¿é—®å£ä»¤ã€‚æ ¹æ®è¯ä¹¦æ–‡ä»¶å¯¼å‡ºä¸€ä»½CAå…¬é’¥æ–‡ä»¶ï¼Œç”¨äºŽåŽç»­å„åº”ç”¨é…ç½®æ–‡ä»¶ä¸­å¼•ç”¨CAå…¬é’¥æ—¶ä½¿ç”¨ï¼š1openssl pkcs12 -clcerts -nokeys -in elastic-stack-ca.p12 -out cacert.pemåˆ¶ä½œLogstashä½¿ç”¨çš„æ•°å­—è¯ä¹¦LogstashæœåŠ¡åœ¨å¯ç”¨SSLåŠ å¯†é€šä¿¡æ”¯æŒæ—¶ï¼Œä¼šæœ‰ä¸€ä¸ªç‰¹æ®Šçš„é—®é¢˜ã€‚å› ä¸ºLogstashåœ¨åº•å±‚æ˜¯é€šè¿‡é›†æˆäº†Nettyæ¥æä¾›çš„å¯¹å¤–æœåŠ¡ç«¯å£ï¼Œè€ŒNettyåœ¨æ”¯æŒæ•°å­—è¯ä¹¦è¿™ä¸€åŠŸèƒ½ä¸Šé¢ï¼Œæœ‰ä¸€ä¸ªå±€é™æ€§ï¼Œå³Nettyä»…æ”¯æŒä½¿ç”¨PKCS#8çš„å¯†é’¥æ ¼å¼ã€‚å¯¹äºŽæˆ‘ä»¬ä½¿ç”¨æœ€å¤šçš„PEMæ ¼å¼è¯ä¹¦ï¼ŒLogstashä¼šæ¯«ä¸ç•™æƒ…åœ°æ‰“å°å‡ºä»¥ä¸‹å¼‚å¸¸ä¿¡æ¯ï¼š123456[2019-08-06T14:48:35,643][ERROR][logstash.inputs.beats ] Looks like you either have a bad certificate, an invalid key or your private key was not in PKCS8 format.[2019-08-06T14:48:35,643][WARN ][io.netty.channel.ChannelInitializer] Failed to initialize a channel. Closing: [id: 0x81e7ac55, L:/172.17.0.6:5044 - R:/100.200.106.60:32500]java.lang.IllegalArgumentException: File does not contain valid private key: /data/logstash/config/certs/logstash.key at io.netty.handler.ssl.SslContextBuilder.keyManager(SslContextBuilder.java:270) ~[netty-all-4.1.30.Final.jar:4.1.30.Final] at io.netty.handler.ssl.SslContextBuilder.forServer(SslContextBuilder.java:90) ~[netty-all-4.1.30.Final.jar:4.1.30.Final] at org.logstash.netty.SslSimpleBuilder.build(SslSimpleBuilder.java:112) ~[logstash-input-beats-6.0.0.jar:?]ç”±äºŽElasticå®˜ç½‘ä¸Šå¯¹äºŽFilebeatå’ŒLogstashä¹‹é—´é…ç½®SSLåŠ å¯†é€šä¿¡æ—¶çš„è¯´æ˜Žèµ„æ–™å¯¹åˆ¶ä½œLogstashä½¿ç”¨çš„æ•°å­—è¯ä¹¦çš„æ“ä½œä¸€å¸¦è€Œè¿‡ï¼Œåªæ˜¯ç®€å•çš„è¯´æ—¢å¯ä»¥ä½¿ç”¨elasticsearchè‡ªå¸¦çš„è¯ä¹¦å·¥å…·ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨é€šç”¨çš„opensslã€‚æ‰€ä»¥ï¼ŒæŒ‰ç…§ElasticæŠ€æœ¯æ ˆä¸­å¤„ç†å…¶å®ƒå·¥å…·é…ç½®SSLåŠŸèƒ½æ”¯æŒæ—¶çš„æ–¹æ³•ï¼Œåˆ¶ä½œå’Œå¾—åˆ°PEMæ ¼å¼çš„è¯ä¹¦åŽï¼Œä¾¿ä¼šé‡åˆ°LogstashæŠ›å‡ºçš„ä¸Šé¢çš„å¼‚å¸¸ä¿¡æ¯äº†ã€‚ç”±äºŽLogstashæ‰“å°çš„é”™è¯¯ä¿¡æ¯æ¯”è¾ƒå¤šï¼Œåˆ†æžäº†å¾ˆé•¿æ—¶é—´æ‰å®šä½åˆ°æ˜¯ç”±äºŽæœªä½¿ç”¨PKCS8å¯†é’¥æ ¼å¼æ‰€å¼•å‘çš„ã€‚æœ‰å…´è¶£è¿›ä¸€æ­¥äº†è§£Nettyè¿™æ–¹é¢é…ç½®ç‰¹æ€§çš„åŒå­¦ï¼Œå¯ä»¥å‚è€ƒè¿™ä¸ªé“¾æŽ¥ï¼šhttps://netty.io/wiki/sslcontextbuilder-and-private-key.html ã€‚åˆ¶ä½œLogstash Serverè¯ä¹¦çš„æ­£ç¡®æ–¹æ³•1234./bin/elasticsearch-certutil cert --ca elastic-stack-ca.p12 --name logstash --dns testserver --ip 172.17.0.6 --pemunzip certificate-bundle.zipcd logstashopenssl pkcs8 -in logstash.key -topk8 -nocrypt -out logstash.p8ç»ç”±å‘½ä»¤1ï¼Œæˆ‘ä»¬ä½¿ç”¨è‡ªç­¾çš„CAç­¾ç½²ç”Ÿæˆäº†ä¸€ä»½åä¸ºlogstashçš„æ•°å­—è¯ä¹¦ï¼›å¾—åˆ°çš„æ•°å­—è¯ä¹¦æ˜¯pemæ ¼å¼çš„ï¼Œè§£åŽ‹åŽä¼šå„æœ‰ä¸€ä¸ª.keyå’Œ.crtåŽç¼€çš„æ–‡ä»¶ï¼›å‘½ä»¤3ï¼Œä½¿ç”¨opensslè½¬æ¢å‡ºä¸€ä»½PKCS#8æ ¼å¼çš„å¯†é’¥æ–‡ä»¶ï¼Œå³logstash.p8ï¼›å¯¹äºŽæˆ‘ä»¬åˆ¶ä½œçš„logstash.crtçš„è¯ä¹¦ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹è¯ä¹¦ä¸­çš„ä¿¡æ¯ï¼š1openssl x509 -in logstash.crt -textå°†è¯ä¹¦æ–‡ä»¶éƒ¨ç½²åˆ°Logstashé…ç½®ç›®å½•ä¸‹å‡å®šæˆ‘ä»¬éƒ¨ç½²Logstashçš„è·¯å¾„ä¸º/data/logstash ï¼Œæˆ‘ä»¬åˆ›å»ºä¸‹é¢è¿™æ ·çš„è¯ä¹¦å­˜æ”¾ç›®å½•ï¼Œå¹¶æŠŠåŒ…æ‹¬logstashè¯ä¹¦å’Œcaè¯ä¹¦åœ¨å†…çš„æ–‡ä»¶éƒ¨ç½²äºŽæ­¤ã€‚1234mkdir /data/logstash/config/certs$ ls /data/logstash/config/certscacert.pem logstash.crt logstash.key logstash.p8å®‰å…¨èµ·è§ï¼Œå°†ä»¥ä¸Šæ–‡ä»¶æƒé™è°ƒæ•´ä¸º600 ã€‚ä¸ºFilebeatæœåŠ¡åˆ¶ä½œå’Œé…ç½®æ•°å­—è¯ä¹¦å›žåˆ°åˆšæ‰æˆ‘ä»¬åˆ¶ä½œCAè¯ä¹¦çš„åœ°æ–¹ï¼Œç»§ç»­ä¸ºFilebeatç”Ÿæˆä¸€ä»½æ•°å­—è¯ä¹¦ï¼š1./bin/elasticsearch-certutil cert --ca elastic-stack-ca.p12 --name filebeat --dns test-filebeat --pemåœ¨ç”Ÿæˆè¯ä¹¦æ—¶è‡³å°‘éœ€è¦æä¾›â€“dnså‚æ•°çš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨é€—å·åˆ†éš”æŒ‡å®šå¤šä¸ªï¼Œç®€å•å¤„ç†çš„è¯å¯ä»¥ç›´æŽ¥æŒ‡å®šä¸ºFilebeatå·¥å…·æ‰€åœ¨ä¸»æœºçš„hostnameå³å¯ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨â€“ipä¸ºè¯ä¹¦ç»‘å®šIPåœ°å€ï¼Œæˆ–è€…äºŒè€…åŒæ—¶ä½¿ç”¨ã€‚æœ€ç»ˆä¼šå¾—åˆ°ä¸€ä¸ªzipæ–‡ä»¶ï¼Œå†…å«PEMæ ¼å¼çš„è¯ä¹¦ä¸Žå¯†é’¥æ–‡ä»¶ã€‚è¯·å°†å¾—åˆ°çš„æ•°å­—è¯ä¹¦å’Œå¯†é’¥æ–‡ä»¶ï¼Œä»¥åŠcaè¯ä¹¦æ–‡ä»¶ï¼Œå­˜æ”¾åˆ°Filebeatä»¥ä¸‹éƒ¨ç½²è·¯å¾„ä¸­ï¼š1234mkdir /data/filebeat/certsls /data/filebeat/certsfilebeat.crt filebeat.key cacert.pemå®‰å…¨èµ·è§ï¼Œå°†ä»¥ä¸Šæ–‡ä»¶æƒé™è°ƒæ•´ä¸º600 ã€‚é…ç½®Filebeatä½¿ç”¨SSLç¼–è¾‘filebeat.ymlæ–‡ä»¶ï¼Œå‚ç…§ä»¥ä¸‹å†…å®¹è¿›è¡Œé…ç½®ï¼š12345output.logstash: hosts: [&quot;log.mytestserver.com:5044&quot;] ssl.certificate_authorities: [&quot;/data/filebeat/certs/cacert.pem&quot;] ssl.certificate: &quot;/data/filebeat/certs/filebeat.crt&quot; ssl.key: &quot;/data/filebeat/certs/filebeat.key&quot;é…ç½®Logstashåœ¨é€šè¿‡beatsæŽ¥æ”¶æ—¥å¿—æ•°æ®æ—¶ä½¿ç”¨SSL1234567891011121314input &#123; beats &#123; id =&gt; &quot;logstash-1&quot; port =&gt; 5044 codec =&gt; plain &#123; charset =&gt; &quot;UTF-8&quot; &#125; ssl =&gt; true ssl_certificate_authorities =&gt; [&quot;/data/logstash/config/certs/cacert.pem&quot;] ssl_certificate =&gt; &quot;/data/logstash/config/certs/logstash.crt&quot; ssl_key =&gt; &quot;/data/logstash/config/certs/logstash.p8&quot; ssl_verify_mode =&gt; &quot;force_peer&quot; &#125;&#125;å¦‚ä¸Šæ‰€ç¤ºï¼Œåœ¨ssl_keyå‚æ•°ä¸­ï¼Œå¼•ç”¨çš„æ˜¯æˆ‘ä»¬åˆ¶ä½œçš„PCKS#8æ ¼å¼çš„å¯†é’¥æ–‡ä»¶ã€‚Logstashçš„filterå’Œoutputæ’ä»¶é…ç½®ä¸æ˜¯æœ¬æ–‡çš„é‡ç‚¹ï¼Œè¿™é‡Œç›´æŽ¥çœç•¥æŽ‰äº†ã€‚å¯åŠ¨FilebeatæœåŠ¡å¹¶è§‚å¯Ÿæ—¥å¿—è§‚å¯Ÿæ—¥å¿—è¾“å‡ºï¼Œæ˜¾ç¤ºæœ‰ç±»ä¼¼ä»¥ä¸‹ä¿¡æ¯æ—¶è¡¨ç¤ºFilebeatæ­£å¸¸è¿žæŽ¥åˆ°LogstashæœåŠ¡ä¸”SSLåŠŸèƒ½å·¥ä½œæ­£å¸¸ã€‚122019-08-06T16:29:08.745+0800 INFO pipeline/output.go:95 Connecting to backoff(async(tcp://log.mytestserver.com:5044))2019-08-06T16:29:08.992+0800 INFO pipeline/output.go:105 Connection to backoff(async(tcp://log.mytestserver.com:5044)) establishedå‚è€ƒææ–™ï¼šhttps://www.elastic.co/guide/en/beats/filebeat/7.2/configuring-ssl-logstash.html]]></content>
      <categories>
        <category>elk</category>
      </categories>
      <tags>
        <tag>elk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç½‘ç»œ_udp]]></title>
    <url>%2F2019%2F12%2F31%2F%E7%BD%91%E7%BB%9C_udp%2F</url>
    <content type="text"><![CDATA[ç½‘ç»œé€šä¿¡æ¦‚è¿°ä»€ä¹ˆæ˜¯ç½‘ç»œä¸€ç§è¾…åŠ©åŒæ–¹æˆ–è€…å¤šæ–¹èƒ½å¤Ÿè¿žæŽ¥åœ¨ä¸€èµ·çš„å·¥å…·ä½¿ç”¨ç½‘ç»œçš„ç›®çš„å°±æ˜¯ä¸ºäº†è”é€šå¤šæ–¹ç„¶åŽè¿›è¡Œé€šä¿¡ç”¨çš„ï¼Œå³æŠŠæ•°æ®ä»Žä¸€æ–¹ä¼ é€’ç»™å¦å¤–ä¸€æ–¹,ä¸ºäº†è®©åœ¨ä¸åŒçš„ç”µè„‘ä¸Šè¿è¡Œçš„è½¯ä»¶ä¹‹é—´èƒ½å¤Ÿäº’ç›¸ä¼ é€’æ•°æ®ï¼Œå°±éœ€è¦å€ŸåŠ©ç½‘ç»œçš„åŠŸèƒ½å°æ€»ç»“:ä½¿ç”¨ç½‘ç»œèƒ½å¤ŸæŠŠå¤šæ–¹é“¾æŽ¥åœ¨ä¸€èµ·ï¼Œç„¶åŽå¯ä»¥è¿›è¡Œæ•°æ®ä¼ é€’æ‰€è°“çš„ç½‘ç»œç¼–ç¨‹å°±æ˜¯ï¼Œè®©åœ¨ä¸åŒçš„ç”µè„‘ä¸Šçš„è½¯ä»¶èƒ½å¤Ÿè¿›è¡Œæ•°æ®ä¼ é€’ï¼Œå³è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡IPåœ°å€ä»€ä¹ˆæ˜¯IPåœ°å€ç”¨æ¥åœ¨ç½‘ç»œä¸­æ ‡è®°ä¸€å°ç”µè„‘ï¼Œæ¯”å¦‚192.168.1.1ï¼›åœ¨æœ¬åœ°å±€åŸŸç½‘ä¸Šæ˜¯å”¯ä¸€çš„ã€‚ipåœ°å€çš„ä½œç”¨ipåœ°å€çš„åˆ†ç±»ï¼ˆäº†è§£ï¼‰æ¯ä¸€ä¸ªIPåœ°å€åŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼šç½‘ç»œåœ°å€å’Œä¸»æœºåœ°å€Aç±»IPåœ°å€ä¸€ä¸ªAç±»IPåœ°å€ç”±1å­—èŠ‚çš„ç½‘ç»œåœ°å€å’Œ3å­—èŠ‚ä¸»æœºåœ°å€ç»„æˆï¼Œç½‘ç»œåœ°å€çš„æœ€é«˜ä½å¿…é¡»æ˜¯â€œ0â€ï¼Œåœ°å€èŒƒå›´1.0.0.1-126.255.255.254äºŒè¿›åˆ¶è¡¨ç¤ºä¸ºï¼š00000001 00000000 00000000 00000001 - 01111110 11111111 11111111 11111110å¯ç”¨çš„Aç±»ç½‘ç»œæœ‰126ä¸ªï¼Œæ¯ä¸ªç½‘ç»œèƒ½å®¹çº³1677214ä¸ªä¸»æœºBç±»IPåœ°å€ä¸€ä¸ªBç±»IPåœ°å€ç”±2ä¸ªå­—èŠ‚çš„ç½‘ç»œåœ°å€å’Œ2ä¸ªå­—èŠ‚çš„ä¸»æœºåœ°å€ç»„æˆï¼Œç½‘ç»œåœ°å€çš„æœ€é«˜ä½å¿…é¡»æ˜¯â€œ10â€ï¼Œåœ°å€èŒƒå›´128.1.0.1-191.255.255.254äºŒè¿›åˆ¶è¡¨ç¤ºä¸ºï¼š10000000 00000001 00000000 00000001 - 10111111 11111111 11111111 11111110å¯ç”¨çš„Bç±»ç½‘ç»œæœ‰16384ä¸ªï¼Œæ¯ä¸ªç½‘ç»œèƒ½å®¹çº³65534ä¸»æœºCç±»IPåœ°å€ä¸€ä¸ªCç±»IPåœ°å€ç”±3å­—èŠ‚çš„ç½‘ç»œåœ°å€å’Œ1å­—èŠ‚çš„ä¸»æœºåœ°å€ç»„æˆï¼Œç½‘ç»œåœ°å€çš„æœ€é«˜ä½å¿…é¡»æ˜¯â€œ110â€èŒƒå›´192.0.1.1-223.255.255.254äºŒè¿›åˆ¶è¡¨ç¤ºä¸º: 11000000 00000000 00000001 00000001 - 11011111 11111111 11111110 11111110Cç±»ç½‘ç»œå¯è¾¾2097152ä¸ªï¼Œæ¯ä¸ªç½‘ç»œèƒ½å®¹çº³254ä¸ªä¸»æœºDç±»åœ°å€ç”¨äºŽå¤šç‚¹å¹¿æ’­Dç±»IPåœ°å€ç¬¬ä¸€ä¸ªå­—èŠ‚ä»¥â€œ1110â€å¼€å§‹ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸“é—¨ä¿ç•™çš„åœ°å€ã€‚å®ƒå¹¶ä¸æŒ‡å‘ç‰¹å®šçš„ç½‘ç»œï¼Œç›®å‰è¿™ä¸€ç±»åœ°å€è¢«ç”¨åœ¨å¤šç‚¹å¹¿æ’­ï¼ˆMulticastï¼‰ä¸­å¤šç‚¹å¹¿æ’­åœ°å€ç”¨æ¥ä¸€æ¬¡å¯»å€ä¸€ç»„è®¡ç®—æœº s åœ°å€èŒƒå›´224.0.0.1-239.255.255.254Eç±»IPåœ°å€ä»¥â€œ1111â€å¼€å§‹ï¼Œä¸ºå°†æ¥ä½¿ç”¨ä¿ç•™Eç±»åœ°å€ä¿ç•™ï¼Œä»…ä½œå®žéªŒå’Œå¼€å‘ç”¨ç§æœ‰ipåœ¨è¿™ä¹ˆå¤šç½‘ç»œIPä¸­ï¼Œå›½é™…è§„å®šæœ‰ä¸€éƒ¨åˆ†IPåœ°å€æ˜¯ç”¨äºŽæˆ‘ä»¬çš„å±€åŸŸç½‘ä½¿ç”¨ï¼Œä¹Ÿå°±æ˜¯å±žäºŽç§ç½‘IPï¼Œä¸åœ¨å…¬ç½‘ä¸­ä½¿ç”¨çš„ï¼Œå®ƒä»¬çš„èŒƒå›´æ˜¯ï¼š10.0.0.0ï½ž10.255.255.255172.16.0.0ï½ž172.31.255.255192.168.0.0ï½ž192.168.255.255æ³¨æ„IPåœ°å€127ï¼Ž0ï¼Ž0ï¼Ž1~127ï¼Ž255ï¼Ž255ï¼Ž255ç”¨äºŽå›žè·¯æµ‹è¯•ï¼Œå¦‚ï¼š127.0.0.1å¯ä»¥ä»£è¡¨æœ¬æœºIPåœ°å€ï¼Œç”¨http://127.0.0.1å°±å¯ä»¥æµ‹è¯•æœ¬æœºä¸­é…ç½®çš„WebæœåŠ¡å™¨ã€‚Linuxå‘½ä»¤(ping, ifconfig)æŸ¥çœ‹æˆ–é…ç½®ç½‘å¡ä¿¡æ¯ï¼šifconfigæ•²ï¼šifconfigï¼Œå®ƒä¼šæ˜¾ç¤ºæ‰€æœ‰ç½‘å¡çš„ä¿¡æ¯æµ‹è¯•è¿œç¨‹ä¸»æœºè¿žé€šæ€§ï¼špingé€šå¸¸ç”¨pingæ¥æ£€æµ‹ç½‘ç»œæ˜¯å¦æ­£å¸¸ç«¯å£ä»€ä¹ˆæ˜¯ç«¯å£ç«¯å£å°±å¥½ä¸€ä¸ªæˆ¿å­çš„é—¨ï¼Œæ˜¯å‡ºå…¥è¿™é—´æˆ¿å­çš„å¿…ç»ä¹‹è·¯ã€‚å¦‚æžœä¸€ä¸ªç¨‹åºéœ€è¦æ”¶å‘ç½‘ç»œæ•°æ®ï¼Œé‚£ä¹ˆå°±éœ€è¦æœ‰è¿™æ ·çš„ç«¯å£.åœ¨linuxç³»ç»Ÿä¸­ï¼Œç«¯å£å¯ä»¥æœ‰65536ï¼ˆ2çš„16æ¬¡æ–¹ï¼‰ä¸ªä¹‹å¤šï¼æ—¢ç„¶æœ‰è¿™ä¹ˆå¤šï¼Œæ“ä½œç³»ç»Ÿä¸ºäº†ç»Ÿä¸€ç®¡ç†ï¼Œæ‰€ä»¥è¿›è¡Œäº†ç¼–å·ï¼Œè¿™å°±æ˜¯ç«¯å£å·ã€‚ç«¯å£å·ç«¯å£æ˜¯é€šè¿‡ç«¯å£å·æ¥æ ‡è®°çš„ï¼Œç«¯å£å·åªæœ‰æ•´æ•°ï¼ŒèŒƒå›´æ˜¯ä»Ž0åˆ°65535æ³¨æ„ï¼šç«¯å£æ•°ä¸ä¸€æ ·çš„*nixç³»ç»Ÿä¸ä¸€æ ·ï¼Œè¿˜å¯ä»¥æ‰‹åŠ¨ä¿®æ”¹ç«¯å£æ˜¯æ€Žæ ·åˆ†é…çš„ç«¯å£å·ä¸æ˜¯éšæ„ä½¿ç”¨çš„ï¼Œè€Œæ˜¯æŒ‰ç…§ä¸€å®šçš„è§„å®šè¿›è¡Œåˆ†é…ã€‚ç«¯å£çš„åˆ†ç±»æ ‡å‡†æœ‰å¥½å‡ ç§ï¼Œæˆ‘ä»¬è¿™é‡Œä¸åšè¯¦ç»†è®²è§£ï¼Œåªä»‹ç»ä¸€ä¸‹çŸ¥åç«¯å£å’ŒåŠ¨æ€ç«¯å£çŸ¥åç«¯å£ï¼ˆWell Known Portsï¼‰çŸ¥åç«¯å£æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„ç«¯å£å·ï¼ŒèŒƒå›´ä»Ž0åˆ°102380ç«¯å£åˆ†é…ç»™HTTPæœåŠ¡21ç«¯å£åˆ†é…ç»™FTPæœåŠ¡å¯ä»¥ç†è§£ä¸ºï¼Œä¸€äº›å¸¸ç”¨çš„åŠŸèƒ½ä½¿ç”¨çš„å·ç æ˜¯ä¼°è®¡çš„ï¼Œå¥½æ¯” ç”µè¯å·ç 110ã€10086ã€10010ä¸€æ ·ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¦‚æžœä¸€ä¸ªç¨‹åºéœ€è¦ä½¿ç”¨çŸ¥åç«¯å£çš„éœ€è¦æœ‰rootæƒé™ã€‚åŠ¨æ€ç«¯å£ï¼ˆDynamic Portsï¼‰åŠ¨æ€ç«¯å£çš„èŒƒå›´æ˜¯ä»Ž1024åˆ°65535ä¹‹æ‰€ä»¥ç§°ä¸ºåŠ¨æ€ç«¯å£ï¼Œæ˜¯å› ä¸ºå®ƒä¸€èˆ¬ä¸å›ºå®šåˆ†é…æŸç§æœåŠ¡ï¼Œè€Œæ˜¯åŠ¨æ€åˆ†é…ã€‚åŠ¨æ€åˆ†é…æ˜¯æŒ‡å½“ä¸€ä¸ªç³»ç»Ÿç¨‹åºæˆ–åº”ç”¨ç¨‹åºç¨‹åºéœ€è¦ç½‘ç»œé€šä¿¡æ—¶ï¼Œå®ƒå‘ä¸»æœºç”³è¯·ä¸€ä¸ªç«¯å£ï¼Œä¸»æœºä»Žå¯ç”¨çš„ç«¯å£å·ä¸­åˆ†é…ä¸€ä¸ªä¾›å®ƒä½¿ç”¨ã€‚å½“è¿™ä¸ªç¨‹åºå…³é—­æ—¶ï¼ŒåŒæ—¶ä¹Ÿå°±é‡Šæ”¾äº†æ‰€å ç”¨çš„ç«¯å£å·ã€‚æ€Žæ ·æŸ¥çœ‹ç«¯å£ ï¼Ÿç”¨â€œnetstat ï¼anâ€æŸ¥çœ‹ç«¯å£çŠ¶æ€lsof -i [tcp/udp]:2425å°æ€»ç»“ç«¯å£æœ‰ä»€ä¹ˆç”¨å‘¢ ï¼Ÿ æˆ‘ä»¬çŸ¥é“ï¼Œä¸€å°æ‹¥æœ‰IPåœ°å€çš„ä¸»æœºå¯ä»¥æä¾›è®¸å¤šæœåŠ¡ï¼Œæ¯”å¦‚HTTPï¼ˆä¸‡ç»´ç½‘æœåŠ¡ï¼‰ã€FTPï¼ˆæ–‡ä»¶ä¼ è¾“ï¼‰ã€SMTPï¼ˆç”µå­é‚®ä»¶ï¼‰ç­‰ï¼Œè¿™äº›æœåŠ¡å®Œå…¨å¯ä»¥é€šè¿‡1ä¸ªIPåœ°å€æ¥å®žçŽ°ã€‚é‚£ä¹ˆï¼Œä¸»æœºæ˜¯æ€Žæ ·åŒºåˆ†ä¸åŒçš„ç½‘ç»œæœåŠ¡å‘¢ï¼Ÿæ˜¾ç„¶ä¸èƒ½åªé IPåœ°å€ï¼Œå› ä¸ºIPåœ°å€ä¸Žç½‘ç»œæœåŠ¡çš„å…³ç³»æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ã€‚å®žé™…ä¸Šæ˜¯é€šè¿‡â€œIPåœ°å€+ç«¯å£å·â€æ¥åŒºåˆ†ä¸åŒçš„æœåŠ¡çš„ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç«¯å£å¹¶ä¸æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚æ¯”å¦‚ä½ çš„ç”µè„‘ä½œä¸ºå®¢æˆ·æœºè®¿é—®ä¸€å°WWWæœåŠ¡å™¨æ—¶ï¼ŒWWWæœåŠ¡å™¨ä½¿ç”¨â€œ80â€ç«¯å£ä¸Žä½ çš„ç”µè„‘é€šä¿¡ï¼Œä½†ä½ çš„ç”µè„‘åˆ™å¯èƒ½ä½¿ç”¨â€œ3457â€è¿™æ ·çš„ç«¯å£ã€‚socketç®€ä»‹ä¸åŒç”µè„‘ä¸Šçš„è¿›ç¨‹ä¹‹é—´å¦‚ä½•é€šä¿¡é¦–è¦è§£å†³çš„é—®é¢˜æ˜¯å¦‚ä½•å”¯ä¸€æ ‡è¯†ä¸€ä¸ªè¿›ç¨‹ï¼Œå¦åˆ™é€šä¿¡æ— ä»Žè°ˆèµ·ï¼åœ¨1å°ç”µè„‘ä¸Šå¯ä»¥é€šè¿‡è¿›ç¨‹å·ï¼ˆPIDï¼‰æ¥å”¯ä¸€æ ‡è¯†ä¸€ä¸ªè¿›ç¨‹ï¼Œä½†æ˜¯åœ¨ç½‘ç»œä¸­è¿™æ˜¯è¡Œä¸é€šçš„ã€‚å…¶å®žTCP/IPåè®®æ—å·²ç»å¸®æˆ‘ä»¬è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œç½‘ç»œå±‚çš„â€œipåœ°å€â€å¯ä»¥å”¯ä¸€æ ‡è¯†ç½‘ç»œä¸­çš„ä¸»æœºï¼Œè€Œä¼ è¾“å±‚çš„â€œåè®®+ç«¯å£â€å¯ä»¥å”¯ä¸€æ ‡è¯†ä¸»æœºä¸­çš„åº”ç”¨è¿›ç¨‹ï¼ˆè¿›ç¨‹ï¼‰ã€‚è¿™æ ·åˆ©ç”¨ipåœ°å€ï¼Œåè®®ï¼Œç«¯å£å°±å¯ä»¥æ ‡è¯†ç½‘ç»œçš„è¿›ç¨‹äº†ï¼Œç½‘ç»œä¸­çš„è¿›ç¨‹é€šä¿¡å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ ‡å¿—ä¸Žå…¶å®ƒè¿›ç¨‹è¿›è¡Œäº¤äº’ã€‚æ³¨æ„:æ‰€è°“è¿›ç¨‹æŒ‡çš„æ˜¯ï¼šè¿è¡Œçš„ç¨‹åºä»¥åŠè¿è¡Œæ—¶ç”¨åˆ°çš„èµ„æºè¿™ä¸ªæ•´ä½“ç§°ä¹‹ä¸ºè¿›ç¨‹ï¼ˆåœ¨è®²è§£å¤šä»»åŠ¡ç¼–ç¨‹æ—¶è¿›è¡Œè¯¦ç»†è®²è§£ï¼‰æ‰€è°“è¿›ç¨‹é—´é€šä¿¡æŒ‡çš„æ˜¯ï¼šè¿è¡Œçš„ç¨‹åºä¹‹é—´çš„æ•°æ®å…±äº«åŽé¢è¯¾ç¨‹ä¸­ä¼šè¯¦ç»†è¯´åˆ°ï¼Œåƒç½‘ç»œå±‚ç­‰çŸ¥è¯†ï¼Œä¸è¦ç€æ€¥ä»€ä¹ˆæ˜¯socketsocket(ç®€ç§° å¥—æŽ¥å­—) æ˜¯è¿›ç¨‹é—´é€šä¿¡çš„ä¸€ç§æ–¹å¼ï¼Œå®ƒä¸Žå…¶ä»–è¿›ç¨‹é—´é€šä¿¡çš„ä¸€ä¸ªä¸»è¦ä¸åŒæ˜¯ï¼šå®ƒèƒ½å®žçŽ°ä¸åŒä¸»æœºé—´çš„è¿›ç¨‹é—´é€šä¿¡ï¼Œæˆ‘ä»¬ç½‘ç»œä¸Šå„ç§å„æ ·çš„æœåŠ¡å¤§å¤šéƒ½æ˜¯åŸºäºŽ Socket æ¥å®Œæˆé€šä¿¡çš„ä¾‹å¦‚æˆ‘ä»¬æ¯å¤©æµè§ˆç½‘é¡µã€QQ èŠå¤©ã€æ”¶å‘ email ç­‰ç­‰socketå¥—æŽ¥å­—èµ°çš„æ˜¯å…¨åŒå·¥åˆ›å»ºsocketåœ¨ Python ä¸­ ä½¿ç”¨socket æ¨¡å—çš„å‡½æ•° socket å°±å¯ä»¥å®Œæˆï¼š12import socketsocket.socket(AddressFamily, Type)è¯´æ˜Žï¼šå‡½æ•° socket.socket åˆ›å»ºä¸€ä¸ª socketï¼Œè¯¥å‡½æ•°å¸¦æœ‰ä¸¤ä¸ªå‚æ•°ï¼šAddress Familyï¼šå¯ä»¥é€‰æ‹© AF_INETï¼ˆç”¨äºŽ Internet è¿›ç¨‹é—´é€šä¿¡ï¼‰ æˆ–è€… AF_UNIXï¼ˆç”¨äºŽåŒä¸€å°æœºå™¨è¿›ç¨‹é—´é€šä¿¡ï¼‰,å®žé™…å·¥ä½œä¸­å¸¸ç”¨AF_INETTypeï¼šå¥—æŽ¥å­—ç±»åž‹ï¼Œå¯ä»¥æ˜¯ SOCK_STREAMï¼ˆæµå¼å¥—æŽ¥å­—ï¼Œä¸»è¦ç”¨äºŽ TCP åè®®ï¼‰æˆ–è€… SOCK_DGRAMï¼ˆæ•°æ®æŠ¥å¥—æŽ¥å­—ï¼Œä¸»è¦ç”¨äºŽ UDP åè®®ï¼‰åˆ›å»ºä¸€ä¸ªtcp socketï¼ˆtcpå¥—æŽ¥å­—ï¼‰123456789import socket# åˆ›å»ºtcpçš„å¥—æŽ¥å­—s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)# ...è¿™é‡Œæ˜¯ä½¿ç”¨å¥—æŽ¥å­—çš„åŠŸèƒ½ï¼ˆçœç•¥ï¼‰...# ä¸ç”¨çš„æ—¶å€™ï¼Œå…³é—­å¥—æŽ¥å­—s.close()åˆ›å»ºä¸€ä¸ªudp socketï¼ˆudpå¥—æŽ¥å­—ï¼‰123456789import socket# åˆ›å»ºudpçš„å¥—æŽ¥å­—s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)# ...è¿™é‡Œæ˜¯ä½¿ç”¨å¥—æŽ¥å­—çš„åŠŸèƒ½ï¼ˆçœç•¥ï¼‰...# ä¸ç”¨çš„æ—¶å€™ï¼Œå…³é—­å¥—æŽ¥å­—s.close()è¯´æ˜Žå¥—æŽ¥å­—ä½¿ç”¨æµç¨‹ ä¸Ž æ–‡ä»¶çš„ä½¿ç”¨æµç¨‹å¾ˆç±»ä¼¼åˆ›å»ºå¥—æŽ¥å­—ä½¿ç”¨å¥—æŽ¥å­—æ”¶/å‘æ•°æ®å…³é—­å¥—æŽ¥å­—udpç½‘ç»œç¨‹åº-å‘é€ã€æŽ¥æ”¶æ•°æ®udpç½‘ç»œç¨‹åº-å‘é€æ•°æ®åˆ›å»ºä¸€ä¸ªåŸºäºŽudpçš„ç½‘ç»œç¨‹åºæµç¨‹å¾ˆç®€å•ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š1. åˆ›å»ºå®¢æˆ·ç«¯å¥—æŽ¥å­— 2. å‘é€/æŽ¥æ”¶æ•°æ® 3. å…³é—­å¥—æŽ¥å­— ä»£ç å¦‚ä¸‹ï¼š1234567891011121314151617181920#coding=utf-8from socket import *# 1. åˆ›å»ºudpå¥—æŽ¥å­—udp_socket = socket(AF_INET, SOCK_DGRAM)# 2. å‡†å¤‡æŽ¥æ”¶æ–¹çš„åœ°å€# '192.168.1.103'è¡¨ç¤ºç›®çš„ipåœ°å€# 8080è¡¨ç¤ºç›®çš„ç«¯å£dest_addr = ('192.168.1.103', 8080) # æ³¨æ„ æ˜¯å…ƒç»„ï¼Œipæ˜¯å­—ç¬¦ä¸²ï¼Œç«¯å£æ˜¯æ•°å­—# 3. ä»Žé”®ç›˜èŽ·å–æ•°æ®send_data = input("è¯·è¾“å…¥è¦å‘é€çš„æ•°æ®:")# 4. å‘é€æ•°æ®åˆ°æŒ‡å®šçš„ç”µè„‘ä¸Šçš„æŒ‡å®šç¨‹åºä¸­udp_socket.sendto(send_data.encode('utf-8'), dest_addr)# 5. å…³é—­å¥—æŽ¥å­—udp_socket.close()è¿è¡ŒçŽ°è±¡ï¼šåœ¨Ubuntuä¸­è¿è¡Œè„šæœ¬ï¼šåœ¨windowsä¸­è¿è¡Œâ€œç½‘ç»œè°ƒè¯•åŠ©æ‰‹â€ï¼šudpç½‘ç»œç¨‹åº-å‘é€ã€æŽ¥æ”¶æ•°æ®12345678910111213141516171819202122232425262728#coding=utf-8from socket import *# 1. åˆ›å»ºudpå¥—æŽ¥å­—udp_socket = socket(AF_INET, SOCK_DGRAM)# 2. å‡†å¤‡æŽ¥æ”¶æ–¹çš„åœ°å€dest_addr = ('192.168.236.129', 8080)# 3. ä»Žé”®ç›˜èŽ·å–æ•°æ®send_data = input("è¯·è¾“å…¥è¦å‘é€çš„æ•°æ®:")# 4. å‘é€æ•°æ®åˆ°æŒ‡å®šçš„ç”µè„‘ä¸Šudp_socket.sendto(send_data.encode('utf-8'), dest_addr)# 5. ç­‰å¾…æŽ¥æ”¶å¯¹æ–¹å‘é€çš„æ•°æ®recv_data = udp_socket.recvfrom(1024) # 1024è¡¨ç¤ºæœ¬æ¬¡æŽ¥æ”¶çš„æœ€å¤§å­—èŠ‚æ•°# 6. æ˜¾ç¤ºå¯¹æ–¹å‘é€çš„æ•°æ®# æŽ¥æ”¶åˆ°çš„æ•°æ®recv_dataæ˜¯ä¸€ä¸ªå…ƒç»„# ç¬¬1ä¸ªå…ƒç´ æ˜¯å¯¹æ–¹å‘é€çš„æ•°æ®# ç¬¬2ä¸ªå…ƒç´ æ˜¯å¯¹æ–¹çš„ipå’Œç«¯å£print(recv_data[0].decode('gbk'))print(recv_data[1])# 7. å…³é—­å¥—æŽ¥å­—udp_socket.close()pythonè„šæœ¬ï¼šç½‘ç»œè°ƒè¯•åŠ©æ‰‹æˆªå›¾ï¼špython3ç¼–ç è½¬æ¢12str-&gt;bytes:encodeç¼–ç bytes-&gt;str:decodeè§£ç å­—ç¬¦ä¸²é€šè¿‡ç¼–ç æˆä¸ºå­—èŠ‚ç ï¼Œå­—èŠ‚ç é€šè¿‡è§£ç æˆä¸ºå­—ç¬¦ä¸²ã€‚12345678910111213141516171819&gt;&gt;&gt; text = 'æˆ‘æ˜¯æ–‡æœ¬'&gt;&gt;&gt; text'æˆ‘æ˜¯æ–‡æœ¬'&gt;&gt;&gt; print(text)æˆ‘æ˜¯æ–‡æœ¬&gt;&gt;&gt; bytesText = text.encode()&gt;&gt;&gt; bytesTextb'\xe6\x88\x91\xe6\x98\xaf\xe6\x96\x87\xe6\x9c\xac'&gt;&gt;&gt; print(bytesText)b'\xe6\x88\x91\xe6\x98\xaf\xe6\x96\x87\xe6\x9c\xac'&gt;&gt;&gt; type(text)&lt;class 'str'&gt;&gt;&gt;&gt; type(bytesText)&lt;class 'bytes'&gt;&gt;&gt;&gt; textDecode = bytesText.decode()&gt;&gt;&gt; textDecode'æˆ‘æ˜¯æ–‡æœ¬'&gt;&gt;&gt; print(textDecode)æˆ‘æ˜¯æ–‡æœ¬å…¶ä¸­decode()ä¸Žencode()æ–¹æ³•å¯ä»¥æŽ¥å—å‚æ•°ï¼Œå…¶å£°æ˜Žåˆ†åˆ«ä¸º:12bytes.decode(encoding="utf-8", errors="strict")str.encode(encoding="utf-8", errors="strict")å…¶ä¸­çš„encodingæ˜¯æŒ‡åœ¨è§£ç ç¼–ç è¿‡ç¨‹ä¸­ä½¿ç”¨çš„ç¼–ç (æ­¤å¤„æŒ‡â€œç¼–ç æ–¹æ¡ˆâ€æ˜¯åè¯)ï¼Œerrorsæ˜¯æŒ‡é”™è¯¯çš„å¤„ç†æ–¹æ¡ˆã€‚udpç»‘å®šä¿¡æ¯udpç½‘ç»œç¨‹åº-ç«¯å£é—®é¢˜ä¼šå˜çš„ç«¯å£å·é‡æ–°è¿è¡Œå¤šæ¬¡è„šæœ¬ï¼Œç„¶åŽåœ¨â€œç½‘ç»œè°ƒè¯•åŠ©æ‰‹â€ä¸­ï¼Œçœ‹åˆ°çš„çŽ°è±¡å¦‚ä¸‹ï¼šè¯´æ˜Žï¼šæ¯é‡æ–°è¿è¡Œä¸€æ¬¡ç½‘ç»œç¨‹åºï¼Œä¸Šå›¾ä¸­çº¢åœˆä¸­çš„æ•°å­—ï¼Œä¸ä¸€æ ·çš„åŽŸå› åœ¨äºŽï¼Œè¿™ä¸ªæ•°å­—æ ‡è¯†è¿™ä¸ªç½‘ç»œç¨‹åºï¼Œå½“é‡æ–°è¿è¡Œæ—¶ï¼Œå¦‚æžœæ²¡æœ‰ç¡®å®šåˆ°åº•ç”¨å“ªä¸ªï¼Œç³»ç»Ÿé»˜è®¤ä¼šéšæœºåˆ†é…è®°ä½ä¸€ç‚¹ï¼šè¿™ä¸ªç½‘ç»œç¨‹åºåœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œè¿™ä¸ªå°±å”¯ä¸€æ ‡è¯†è¿™ä¸ªç¨‹åºï¼Œæ‰€ä»¥å¦‚æžœå…¶ä»–ç”µè„‘ä¸Šçš„ç½‘ç»œç¨‹åºå¦‚æžœæƒ³è¦å‘æ­¤ç¨‹åºå‘é€æ•°æ®ï¼Œé‚£ä¹ˆå°±éœ€è¦å‘è¿™ä¸ªæ•°å­—ï¼ˆå³ç«¯å£ï¼‰æ ‡è¯†çš„ç¨‹åºå‘é€å³å¯udpç»‘å®šä¿¡æ¯ç»‘å®šä¿¡æ¯ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåœ¨ä¸€å°ç”µè„‘ä¸Šè¿è¡Œçš„ç½‘ç»œç¨‹åºæœ‰å¾ˆå¤šï¼Œä¸ºäº†ä¸ä¸Žå…¶ä»–çš„ç½‘ç»œç¨‹åºå ç”¨åŒä¸€ä¸ªç«¯å£å·ï¼Œå¾€å¾€åœ¨ç¼–ç¨‹ä¸­ï¼Œudpçš„ç«¯å£å·ä¸€èˆ¬ä¸ç»‘å®šä½†æ˜¯å¦‚æžœéœ€è¦åšæˆä¸€ä¸ªæœåŠ¡å™¨ç«¯çš„ç¨‹åºçš„è¯ï¼Œæ˜¯éœ€è¦ç»‘å®šçš„ï¼Œæƒ³æƒ³çœ‹è¿™åˆæ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå¦‚æžœæŠ¥è­¦ç”µè¯æ¯å¤©éƒ½åœ¨å˜ï¼Œæƒ³å¿…ä¸–ç•Œå°±ä¼šä¹±äº†ï¼Œæ‰€ä»¥ä¸€èˆ¬æœåŠ¡æ€§çš„ç¨‹åºï¼Œå¾€å¾€éœ€è¦ä¸€ä¸ªå›ºå®šçš„ç«¯å£å·ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ç«¯å£ç»‘å®šç»‘å®šç¤ºä¾‹12345678910111213141516171819#coding=utf-8from socket import *# 1. åˆ›å»ºå¥—æŽ¥å­—udp_socket = socket(AF_INET, SOCK_DGRAM)# 2. ç»‘å®šæœ¬åœ°çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚æžœä¸€ä¸ªç½‘ç»œç¨‹åºä¸ç»‘å®šï¼Œåˆ™ç³»ç»Ÿä¼šéšæœºåˆ†é…local_addr = ('', 7788) # ipåœ°å€å’Œç«¯å£å·ï¼Œipä¸€èˆ¬ä¸ç”¨å†™ï¼Œè¡¨ç¤ºæœ¬æœºçš„ä»»ä½•ä¸€ä¸ªipudp_socket.bind(local_addr)# 3. ç­‰å¾…æŽ¥æ”¶å¯¹æ–¹å‘é€çš„æ•°æ®recv_data = udp_socket.recvfrom(1024) # 1024è¡¨ç¤ºæœ¬æ¬¡æŽ¥æ”¶çš„æœ€å¤§å­—èŠ‚æ•°# 4. æ˜¾ç¤ºæŽ¥æ”¶åˆ°çš„æ•°æ®print(recv_data[0].decode('gbk'))# 5. å…³é—­å¥—æŽ¥å­—udp_socket.close()è¿è¡Œç»“æžœï¼šæ€»ç»“:ä¸€ä¸ªudpç½‘ç»œç¨‹åºï¼Œå¯ä»¥ä¸ç»‘å®šï¼Œæ­¤æ—¶æ“ä½œç³»ç»Ÿä¼šéšæœºè¿›è¡Œåˆ†é…ä¸€ä¸ªç«¯å£ï¼Œå¦‚æžœé‡æ–°è¿è¡Œæ­¤ç¨‹åºç«¯å£å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ä¸€ä¸ªudpç½‘ç»œç¨‹åºï¼Œä¹Ÿå¯ä»¥ç»‘å®šä¿¡æ¯ï¼ˆipåœ°å€ï¼Œç«¯å£å·ï¼‰ï¼Œå¦‚æžœç»‘å®šæˆåŠŸï¼Œé‚£ä¹ˆæ“ä½œç³»ç»Ÿç”¨è¿™ä¸ªç«¯å£å·æ¥è¿›è¡ŒåŒºåˆ«æ”¶åˆ°çš„ç½‘ç»œæ•°æ®æ˜¯å¦æ˜¯æ­¤è¿›ç¨‹çš„ç½‘ç»œé€šä¿¡è¿‡ç¨‹(ç®€å•ç‰ˆ)ç½‘ç»œé€šä¿¡è¿‡ç¨‹ä¸­ï¼Œä¹‹æ‰€éœ€è¦ipã€portç­‰ï¼Œå°±æ˜¯ä¸ºäº†èƒ½å¤Ÿå°†ä¸€ä¸ªå¤æ‚çš„é€šä¿¡è¿‡ç¨‹è¿›è¡Œä»»åŠ¡åˆ’åˆ†ï¼Œä»Žè€Œä¿è¯æ•°æ®å‡†ç¡®æ— è¯¯çš„ä¼ é€’åº”ç”¨ï¼šudpèŠå¤©å™¨è¯´æ˜Žåœ¨ä¸€ä¸ªç”µè„‘ä¸­ç¼–å†™1ä¸ªç¨‹åºï¼Œæœ‰2ä¸ªåŠŸèƒ½1.èŽ·å–é”®ç›˜æ•°æ®ï¼Œå¹¶å°†å…¶å‘é€ç»™å¯¹æ–¹2.æŽ¥æ”¶æ•°æ®å¹¶æ˜¾ç¤ºå¹¶ä¸”åŠŸèƒ½æ•°æ®è¿›è¡Œé€‰æ‹©ä»¥ä¸Šçš„2ä¸ªåŠŸèƒ½è°ƒç”¨å‚è€ƒä»£ç :12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849#coding=utf-8import socketdef send_msg(udp_socket): """èŽ·å–é”®ç›˜æ•°æ®ï¼Œå¹¶å°†å…¶å‘é€ç»™å¯¹æ–¹""" # 1. ä»Žé”®ç›˜è¾“å…¥æ•°æ® msg = input("\nè¯·è¾“å…¥è¦å‘é€çš„æ•°æ®:") # 2. è¾“å…¥å¯¹æ–¹çš„ipåœ°å€ dest_ip = input("\nè¯·è¾“å…¥å¯¹æ–¹çš„ipåœ°å€:") # 3. è¾“å…¥å¯¹æ–¹çš„port dest_port = int(input("\nè¯·è¾“å…¥å¯¹æ–¹çš„port:")) # 4. å‘é€æ•°æ® udp_socket.sendto(msg.encode("utf-8"), (dest_ip, dest_port))def recv_msg(udp_socket): """æŽ¥æ”¶æ•°æ®å¹¶æ˜¾ç¤º""" # 1. æŽ¥æ”¶æ•°æ® recv_msg = udp_socket.recvfrom(1024) # 2. è§£ç  recv_ip = recv_msg[1] recv_msg = recv_msg[0].decode("utf-8") # 3. æ˜¾ç¤ºæŽ¥æ”¶åˆ°çš„æ•°æ® print("&gt;&gt;&gt;%s:%s" % (str(recv_ip), recv_msg))def main(): # 1. åˆ›å»ºå¥—æŽ¥å­— udp_socket = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) # 2. ç»‘å®šæœ¬åœ°ä¿¡æ¯ udp_socket.bind(("", 7890)) while True: # 3. é€‰æ‹©åŠŸèƒ½ print("="*30) print("1:å‘é€æ¶ˆæ¯") print("2:æŽ¥æ”¶æ¶ˆæ¯") print("="*30) op_num = input("è¯·è¾“å…¥è¦æ“ä½œçš„åŠŸèƒ½åºå·:") # 4. æ ¹æ®é€‰æ‹©è°ƒç”¨ç›¸åº”çš„å‡½æ•° if op_num == "1": send_msg(udp_socket) elif op_num == "2": recv_msg(udp_socket) else: print("è¾“å…¥æœ‰è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥...")if __name__ == "__main__": main()æƒ³ä¸€æƒ³ä»¥ä¸Šçš„ç¨‹åºå¦‚æžœé€‰æ‹©äº†æŽ¥æ”¶æ•°æ®åŠŸèƒ½ï¼Œå¹¶ä¸”æ­¤æ—¶æ²¡æœ‰æ•°æ®ï¼Œç¨‹åºä¼šå µå¡žåœ¨è¿™ï¼Œé‚£ä¹ˆæ€Žæ ·æ‰èƒ½è®©è¿™ä¸ªç¨‹åºæ”¶å‘æ•°æ®ä¸€èµ·è¿›è¡Œå‘¢ï¼Ÿ]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>udp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç½‘ç»œ_tcp]]></title>
    <url>%2F2019%2F12%2F31%2F%E7%BD%91%E7%BB%9C_tcp%2F</url>
    <content type="text"><![CDATA[TCPç®€ä»‹TCPä»‹ç»TCPåè®®ï¼Œä¼ è¾“æŽ§åˆ¶åè®®ï¼ˆè‹±è¯­ï¼šTransmission Control Protocolï¼Œç¼©å†™ä¸º TCPï¼‰æ˜¯ä¸€ç§é¢å‘è¿žæŽ¥çš„ã€å¯é çš„ã€åŸºäºŽå­—èŠ‚æµçš„ä¼ è¾“å±‚é€šä¿¡åè®®ï¼Œç”±IETFçš„RFC 793å®šä¹‰ã€‚TCPé€šä¿¡éœ€è¦ç»è¿‡åˆ›å»ºè¿žæŽ¥ã€æ•°æ®ä¼ é€ã€ç»ˆæ­¢è¿žæŽ¥ä¸‰ä¸ªæ­¥éª¤ã€‚TCPé€šä¿¡æ¨¡åž‹ä¸­ï¼Œåœ¨é€šä¿¡å¼€å§‹ä¹‹å‰ï¼Œä¸€å®šè¦å…ˆå»ºç«‹ç›¸å…³çš„é“¾æŽ¥ï¼Œæ‰èƒ½å‘é€æ•°æ®ï¼Œç±»ä¼¼äºŽç”Ÿæ´»ä¸­ï¼Œâ€æ‰“ç”µè¯â€â€TCPç‰¹ç‚¹é¢å‘è¿žæŽ¥é€šä¿¡åŒæ–¹å¿…é¡»å…ˆå»ºç«‹è¿žæŽ¥æ‰èƒ½è¿›è¡Œæ•°æ®çš„ä¼ è¾“ï¼ŒåŒæ–¹éƒ½å¿…é¡»ä¸ºè¯¥è¿žæŽ¥åˆ†é…å¿…è¦çš„ç³»ç»Ÿå†…æ ¸èµ„æºï¼Œä»¥ç®¡ç†è¿žæŽ¥çš„çŠ¶æ€å’Œè¿žæŽ¥ä¸Šçš„ä¼ è¾“ã€‚åŒæ–¹é—´çš„æ•°æ®ä¼ è¾“éƒ½å¯ä»¥é€šè¿‡è¿™ä¸€ä¸ªè¿žæŽ¥è¿›è¡Œã€‚å®Œæˆæ•°æ®äº¤æ¢åŽï¼ŒåŒæ–¹å¿…é¡»æ–­å¼€æ­¤è¿žæŽ¥ï¼Œä»¥é‡Šæ”¾ç³»ç»Ÿèµ„æºã€‚è¿™ç§è¿žæŽ¥æ˜¯ä¸€å¯¹ä¸€çš„ï¼Œå› æ­¤TCPä¸é€‚ç”¨äºŽå¹¿æ’­çš„åº”ç”¨ç¨‹åºï¼ŒåŸºäºŽå¹¿æ’­çš„åº”ç”¨ç¨‹åºè¯·ä½¿ç”¨UDPåè®®ã€‚å¯é ä¼ è¾“TCPé‡‡ç”¨å‘é€åº”ç­”æœºåˆ¶TCPå‘é€çš„æ¯ä¸ªæŠ¥æ–‡æ®µéƒ½å¿…é¡»å¾—åˆ°æŽ¥æ”¶æ–¹çš„åº”ç­”æ‰è®¤ä¸ºè¿™ä¸ªTCPæŠ¥æ–‡æ®µä¼ è¾“æˆåŠŸè¶…æ—¶é‡ä¼ å‘é€ç«¯å‘å‡ºä¸€ä¸ªæŠ¥æ–‡æ®µä¹‹åŽå°±å¯åŠ¨å®šæ—¶å™¨ï¼Œå¦‚æžœåœ¨å®šæ—¶æ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°åº”ç­”å°±é‡æ–°å‘é€è¿™ä¸ªæŠ¥æ–‡æ®µã€‚TCPä¸ºäº†ä¿è¯ä¸å‘ç”Ÿä¸¢åŒ…ï¼Œå°±ç»™æ¯ä¸ªåŒ…ä¸€ä¸ªåºå·ï¼ŒåŒæ—¶åºå·ä¹Ÿä¿è¯äº†ä¼ é€åˆ°æŽ¥æ”¶ç«¯å®žä½“çš„åŒ…çš„æŒ‰åºæŽ¥æ”¶ã€‚ç„¶åŽæŽ¥æ”¶ç«¯å®žä½“å¯¹å·²æˆåŠŸæ”¶åˆ°çš„åŒ…å‘å›žä¸€ä¸ªç›¸åº”çš„ç¡®è®¤ï¼ˆACKï¼‰ï¼›å¦‚æžœå‘é€ç«¯å®žä½“åœ¨åˆç†çš„å¾€è¿”æ—¶å»¶ï¼ˆRTTï¼‰å†…æœªæ”¶åˆ°ç¡®è®¤ï¼Œé‚£ä¹ˆå¯¹åº”çš„æ•°æ®åŒ…å°±è¢«å‡è®¾ä¸ºå·²ä¸¢å¤±å°†ä¼šè¢«è¿›è¡Œé‡ä¼ ã€‚é”™è¯¯æ ¡éªŒTCPç”¨ä¸€ä¸ªæ ¡éªŒå’Œå‡½æ•°æ¥æ£€éªŒæ•°æ®æ˜¯å¦æœ‰é”™è¯¯ï¼›åœ¨å‘é€å’ŒæŽ¥æ”¶æ—¶éƒ½è¦è®¡ç®—æ ¡éªŒå’Œã€‚æµé‡æŽ§åˆ¶å’Œé˜»å¡žç®¡ç†æµé‡æŽ§åˆ¶ç”¨æ¥é¿å…ä¸»æœºå‘é€å¾—è¿‡å¿«è€Œä½¿æŽ¥æ”¶æ–¹æ¥ä¸åŠå®Œå…¨æ”¶ä¸‹ã€‚TCPä¸ŽUDPçš„ä¸åŒç‚¹é¢å‘è¿žæŽ¥ï¼ˆç¡®è®¤æœ‰åˆ›å»ºä¸‰æ–¹äº¤æ¡ï¼Œè¿žæŽ¥å·²åˆ›å»ºæ‰ä½œä¼ è¾“ã€‚ï¼‰æœ‰åºæ•°æ®ä¼ è¾“é‡å‘ä¸¢å¤±çš„æ•°æ®åŒ…èˆå¼ƒé‡å¤çš„æ•°æ®åŒ…æ— å·®é”™çš„æ•°æ®ä¼ è¾“é˜»å¡ž/æµé‡æŽ§åˆ¶udpé€šä¿¡æ¨¡åž‹udpé€šä¿¡æ¨¡åž‹ä¸­ï¼Œåœ¨é€šä¿¡å¼€å§‹ä¹‹å‰ï¼Œä¸éœ€è¦å»ºç«‹ç›¸å…³çš„é“¾æŽ¥ï¼Œåªéœ€è¦å‘é€æ•°æ®å³å¯ï¼Œç±»ä¼¼äºŽç”Ÿæ´»ä¸­ï¼Œâ€å†™ä¿¡â€â€TCPé€šä¿¡æ¨¡åž‹tcpé€šä¿¡æ¨¡åž‹ä¸­ï¼Œåœ¨é€šä¿¡å¼€å§‹ä¹‹å‰ï¼Œä¸€å®šè¦å…ˆå»ºç«‹ç›¸å…³çš„é“¾æŽ¥ï¼Œæ‰èƒ½å‘é€æ•°æ®ï¼Œç±»ä¼¼äºŽç”Ÿæ´»ä¸­ï¼Œâ€æ‰“ç”µè¯â€â€tcpå®¢æˆ·ç«¯æ‰€è°“çš„æœåŠ¡å™¨ç«¯ï¼šå°±æ˜¯æä¾›æœåŠ¡çš„ä¸€æ–¹ï¼Œè€Œå®¢æˆ·ç«¯ï¼Œå°±æ˜¯éœ€è¦è¢«æœåŠ¡çš„ä¸€æ–¹tcpå®¢æˆ·ç«¯æž„å»ºæµç¨‹tcpçš„å®¢æˆ·ç«¯è¦æ¯”æœåŠ¡å™¨ç«¯ç®€å•å¾ˆå¤šï¼Œå¦‚æžœè¯´æœåŠ¡å™¨ç«¯æ˜¯éœ€è¦è‡ªå·±ä¹°æ‰‹æœºã€æŸ¥æ‰‹æœºå¡ã€è®¾ç½®é“ƒå£°ã€ç­‰å¾…åˆ«äººæ‰“ç”µè¯æµç¨‹çš„è¯ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯å°±åªéœ€è¦æ‰¾ä¸€ä¸ªç”µè¯äº­ï¼Œæ‹¿èµ·ç”µè¯æ‹¨æ‰“å³å¯ï¼Œæµç¨‹è¦å°‘å¾ˆå¤šç¤ºä¾‹ä»£ç ï¼š1234567891011121314151617181920212223from socket import *# åˆ›å»ºsockettcp_client_socket = socket(AF_INET, SOCK_STREAM)# ç›®çš„ä¿¡æ¯server_ip = input("è¯·è¾“å…¥æœåŠ¡å™¨ip:")server_port = int(input("è¯·è¾“å…¥æœåŠ¡å™¨port:"))# é“¾æŽ¥æœåŠ¡å™¨tcp_client_socket.connect((server_ip, server_port))# æç¤ºç”¨æˆ·è¾“å…¥æ•°æ®send_data = input("è¯·è¾“å…¥è¦å‘é€çš„æ•°æ®ï¼š")tcp_client_socket.send(send_data.encode("gbk"))# æŽ¥æ”¶å¯¹æ–¹å‘é€è¿‡æ¥çš„æ•°æ®ï¼Œæœ€å¤§æŽ¥æ”¶1024ä¸ªå­—èŠ‚recvData = tcp_client_socket.recv(1024)print('æŽ¥æ”¶åˆ°çš„æ•°æ®ä¸º:', recvData.decode('gbk'))# å…³é—­å¥—æŽ¥å­—tcp_client_socket.close()è¿è¡Œæµç¨‹tcpå®¢æˆ·ç«¯1234è¯·è¾“å…¥æœåŠ¡å™¨ip:10.10.0.47è¯·è¾“å…¥æœåŠ¡å™¨port:8080è¯·è¾“å…¥è¦å‘é€çš„æ•°æ®ï¼šä½ å¥½å•ŠæŽ¥æ”¶åˆ°çš„æ•°æ®ä¸º: æˆ‘å¾ˆå¥½ï¼Œä½ å‘¢ç½‘ç»œè°ƒè¯•åŠ©æ‰‹tcpæœåŠ¡å™¨åœ¨ç¨‹åºä¸­ï¼Œå¦‚æžœæƒ³è¦å®Œæˆä¸€ä¸ªtcpæœåŠ¡å™¨çš„åŠŸèƒ½ï¼Œéœ€è¦çš„æµç¨‹å¦‚ä¸‹ï¼šsocketåˆ›å»ºä¸€ä¸ªå¥—æŽ¥å­—bindç»‘å®šipå’Œportlistenä½¿å¥—æŽ¥å­—å˜ä¸ºå¯ä»¥è¢«åŠ¨é“¾æŽ¥acceptç­‰å¾…å®¢æˆ·ç«¯çš„é“¾æŽ¥recv/sendæŽ¥æ”¶å‘é€æ•°æ®ä¸€ä¸ªå¾ˆç®€å•çš„tcpæœåŠ¡å™¨å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728from socket import *# åˆ›å»ºsockettcp_server_socket = socket(AF_INET, SOCK_STREAM)# æœ¬åœ°ä¿¡æ¯address = ('', 7788)# ç»‘å®štcp_server_socket.bind(address)# ä½¿ç”¨socketåˆ›å»ºçš„å¥—æŽ¥å­—é»˜è®¤çš„å±žæ€§æ˜¯ä¸»åŠ¨çš„ï¼Œä½¿ç”¨listenå°†å…¶å˜ä¸ºè¢«åŠ¨çš„ï¼Œè¿™æ ·å°±å¯ä»¥æŽ¥æ”¶åˆ«äººçš„é“¾æŽ¥äº†tcp_server_socket.listen(128)# å¦‚æžœæœ‰æ–°çš„å®¢æˆ·ç«¯æ¥é“¾æŽ¥æœåŠ¡å™¨ï¼Œé‚£ä¹ˆå°±äº§ç”Ÿä¸€ä¸ªæ–°çš„å¥—æŽ¥å­—ä¸“é—¨ä¸ºè¿™ä¸ªå®¢æˆ·ç«¯æœåŠ¡# client_socketç”¨æ¥ä¸ºè¿™ä¸ªå®¢æˆ·ç«¯æœåŠ¡# tcp_server_socketå°±å¯ä»¥çœä¸‹æ¥ä¸“é—¨ç­‰å¾…å…¶ä»–æ–°å®¢æˆ·ç«¯çš„é“¾æŽ¥client_socket, clientAddr = tcp_server_socket.accept()# æŽ¥æ”¶å¯¹æ–¹å‘é€è¿‡æ¥çš„æ•°æ®recv_data = client_socket.recv(1024) # æŽ¥æ”¶1024ä¸ªå­—èŠ‚print('æŽ¥æ”¶åˆ°çš„æ•°æ®ä¸º:', recv_data.decode('gbk'))# å‘é€ä¸€äº›æ•°æ®åˆ°å®¢æˆ·ç«¯client_socket.send("thank you !".encode('gbk'))# å…³é—­ä¸ºè¿™ä¸ªå®¢æˆ·ç«¯æœåŠ¡çš„å¥—æŽ¥å­—ï¼Œåªè¦å…³é—­äº†ï¼Œå°±æ„å‘³ç€ä¸ºä¸èƒ½å†ä¸ºè¿™ä¸ªå®¢æˆ·ç«¯æœåŠ¡äº†ï¼Œå¦‚æžœè¿˜éœ€è¦æœåŠ¡ï¼Œåªèƒ½å†æ¬¡é‡æ–°è¿žæŽ¥client_socket.close()è¿è¡Œæµç¨‹tcpæœåŠ¡å™¨1æŽ¥æ”¶åˆ°çš„æ•°æ®ä¸º: ä½ åœ¨ä¹ˆï¼Ÿç½‘ç»œè°ƒè¯•åŠ©æ‰‹tcpæ³¨æ„ç‚¹tcpæœåŠ¡å™¨ä¸€èˆ¬æƒ…å†µä¸‹éƒ½éœ€è¦ç»‘å®šï¼Œå¦åˆ™å®¢æˆ·ç«¯æ‰¾ä¸åˆ°è¿™ä¸ªæœåŠ¡å™¨tcpå®¢æˆ·ç«¯ä¸€èˆ¬ä¸ç»‘å®šï¼Œå› ä¸ºæ˜¯ä¸»åŠ¨é“¾æŽ¥æœåŠ¡å™¨ï¼Œæ‰€ä»¥åªè¦ç¡®å®šå¥½æœåŠ¡å™¨çš„ipã€portç­‰ä¿¡æ¯å°±å¥½ï¼Œæœ¬åœ°å®¢æˆ·ç«¯å¯ä»¥éšæœºtcpæœåŠ¡å™¨ä¸­é€šè¿‡listenå¯ä»¥å°†socketåˆ›å»ºå‡ºæ¥çš„ä¸»åŠ¨å¥—æŽ¥å­—å˜ä¸ºè¢«åŠ¨çš„ï¼Œè¿™æ˜¯åštcpæœåŠ¡å™¨æ—¶å¿…é¡»è¦åšçš„å½“å®¢æˆ·ç«¯éœ€è¦é“¾æŽ¥æœåŠ¡å™¨æ—¶ï¼Œå°±éœ€è¦ä½¿ç”¨connectè¿›è¡Œé“¾æŽ¥ï¼Œudpæ˜¯ä¸éœ€è¦é“¾æŽ¥çš„è€Œæ˜¯ç›´æŽ¥å‘é€ï¼Œä½†æ˜¯tcpå¿…é¡»å…ˆé“¾æŽ¥ï¼Œåªæœ‰é“¾æŽ¥æˆåŠŸæ‰èƒ½é€šä¿¡å½“ä¸€ä¸ªtcpå®¢æˆ·ç«¯è¿žæŽ¥æœåŠ¡å™¨æ—¶ï¼ŒæœåŠ¡å™¨ç«¯ä¼šæœ‰1ä¸ªæ–°çš„å¥—æŽ¥å­—ï¼Œè¿™ä¸ªå¥—æŽ¥å­—ç”¨æ¥æ ‡è®°è¿™ä¸ªå®¢æˆ·ç«¯ï¼Œå•ç‹¬ä¸ºè¿™ä¸ªå®¢æˆ·ç«¯æœåŠ¡listenåŽçš„å¥—æŽ¥å­—æ˜¯è¢«åŠ¨å¥—æŽ¥å­—ï¼Œç”¨æ¥æŽ¥æ”¶æ–°çš„å®¢æˆ·ç«¯çš„é“¾æŽ¥è¯·æ±‚çš„ï¼Œè€Œacceptè¿”å›žçš„æ–°å¥—æŽ¥å­—æ˜¯æ ‡è®°è¿™ä¸ªæ–°å®¢æˆ·ç«¯çš„å…³é—­listenåŽçš„å¥—æŽ¥å­—æ„å‘³ç€è¢«åŠ¨å¥—æŽ¥å­—å…³é—­äº†ï¼Œä¼šå¯¼è‡´æ–°çš„å®¢æˆ·ç«¯ä¸èƒ½å¤Ÿé“¾æŽ¥æœåŠ¡å™¨ï¼Œä½†æ˜¯ä¹‹å‰å·²ç»é“¾æŽ¥æˆåŠŸçš„å®¢æˆ·ç«¯æ­£å¸¸é€šä¿¡ã€‚å…³é—­acceptè¿”å›žçš„å¥—æŽ¥å­—æ„å‘³ç€è¿™ä¸ªå®¢æˆ·ç«¯å·²ç»æœåŠ¡å®Œæ¯•å½“å®¢æˆ·ç«¯çš„å¥—æŽ¥å­—è°ƒç”¨closeåŽï¼ŒæœåŠ¡å™¨ç«¯ä¼šrecvè§£å µå¡žï¼Œå¹¶ä¸”è¿”å›žçš„é•¿åº¦ä¸º0ï¼Œå› æ­¤æœåŠ¡å™¨å¯ä»¥é€šè¿‡è¿”å›žæ•°æ®çš„é•¿åº¦æ¥åŒºåˆ«å®¢æˆ·ç«¯æ˜¯å¦å·²ç»ä¸‹çº¿æ¡ˆä¾‹:æ–‡ä»¶ä¸‹è½½å™¨æœåŠ¡å™¨ å‚è€ƒä»£ç å¦‚ä¸‹:1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950from socket import *import sysdef get_file_content(file_name): """èŽ·å–æ–‡ä»¶çš„å†…å®¹""" try: with open(file_name, "rb") as f: content = f.read() return content except: print("æ²¡æœ‰ä¸‹è½½çš„æ–‡ä»¶:%s" % file_name)def main(): if len(sys.argv) != 2: print("è¯·æŒ‰ç…§å¦‚ä¸‹æ–¹å¼è¿è¡Œï¼špython3 xxx.py 7890") return else: # è¿è¡Œæ–¹å¼ä¸ºpython3 xxx.py 7890 port = int(sys.argv[1]) # åˆ›å»ºsocket tcp_server_socket = socket(AF_INET, SOCK_STREAM) # æœ¬åœ°ä¿¡æ¯ address = ('', port) # ç»‘å®šæœ¬åœ°ä¿¡æ¯ tcp_server_socket.bind(address) # å°†ä¸»åŠ¨å¥—æŽ¥å­—å˜ä¸ºè¢«åŠ¨å¥—æŽ¥å­— tcp_server_socket.listen(128) while True: # ç­‰å¾…å®¢æˆ·ç«¯çš„é“¾æŽ¥ï¼Œå³ä¸ºè¿™ä¸ªå®¢æˆ·ç«¯å‘é€æ–‡ä»¶ client_socket, clientAddr = tcp_server_socket.accept() # æŽ¥æ”¶å¯¹æ–¹å‘é€è¿‡æ¥çš„æ•°æ® recv_data = client_socket.recv(1024) # æŽ¥æ”¶1024ä¸ªå­—èŠ‚ file_name = recv_data.decode("utf-8") print("å¯¹æ–¹è¯·æ±‚ä¸‹è½½çš„æ–‡ä»¶åä¸º:%s" % file_name) file_content = get_file_content(file_name) # å‘é€æ–‡ä»¶çš„æ•°æ®ç»™å®¢æˆ·ç«¯ # å› ä¸ºèŽ·å–æ‰“å¼€æ–‡ä»¶æ—¶æ˜¯ä»¥rbæ–¹å¼æ‰“å¼€ï¼Œæ‰€ä»¥file_contentä¸­çš„æ•°æ®å·²ç»æ˜¯äºŒè¿›åˆ¶çš„æ ¼å¼ï¼Œå› æ­¤ä¸éœ€è¦encodeç¼–ç  if file_content: client_socket.send(file_content) # å…³é—­è¿™ä¸ªå¥—æŽ¥å­— client_socket.close() # å…³é—­ç›‘å¬å¥—æŽ¥å­— tcp_server_socket.close()if __name__ == "__main__": main()å®¢æˆ·ç«¯ å‚è€ƒä»£ç å¦‚ä¸‹:123456789101112131415161718192021222324252627282930313233from socket import *def main(): # åˆ›å»ºsocket tcp_client_socket = socket(AF_INET, SOCK_STREAM) # ç›®çš„ä¿¡æ¯ server_ip = input("è¯·è¾“å…¥æœåŠ¡å™¨ip:") server_port = int(input("è¯·è¾“å…¥æœåŠ¡å™¨port:")) # é“¾æŽ¥æœåŠ¡å™¨ tcp_client_socket.connect((server_ip, server_port)) # è¾“å…¥éœ€è¦ä¸‹è½½çš„æ–‡ä»¶å file_name = input("è¯·è¾“å…¥è¦ä¸‹è½½çš„æ–‡ä»¶åï¼š") # å‘é€æ–‡ä»¶ä¸‹è½½è¯·æ±‚ tcp_client_socket.send(file_name.encode("utf-8")) # æŽ¥æ”¶å¯¹æ–¹å‘é€è¿‡æ¥çš„æ•°æ®ï¼Œæœ€å¤§æŽ¥æ”¶1024ä¸ªå­—èŠ‚ï¼ˆ1Kï¼‰ recv_data = tcp_client_socket.recv(1024) # print('æŽ¥æ”¶åˆ°çš„æ•°æ®ä¸º:', recv_data.decode('utf-8')) # å¦‚æžœæŽ¥æ”¶åˆ°æ•°æ®å†åˆ›å»ºæ–‡ä»¶ï¼Œå¦åˆ™ä¸åˆ›å»º if recv_data: with open("[æŽ¥æ”¶]"+file_name, "wb") as f: f.write(recv_data) # å…³é—­å¥—æŽ¥å­— tcp_client_socket.close()if __name__ == "__main__": main()tcpçš„3æ¬¡æ¡æ‰‹tcpçš„4æ¬¡æŒ¥æ‰‹tcpé•¿è¿žæŽ¥å’ŒçŸ­è¿žæŽ¥TCPåœ¨çœŸæ­£çš„è¯»å†™æ“ä½œä¹‹å‰ï¼Œserverä¸Žclientä¹‹é—´å¿…é¡»å»ºç«‹ä¸€ä¸ªè¿žæŽ¥ï¼Œå½“è¯»å†™æ“ä½œå®ŒæˆåŽï¼ŒåŒæ–¹ä¸å†éœ€è¦è¿™ä¸ªè¿žæŽ¥æ—¶å®ƒä»¬å¯ä»¥é‡Šæ”¾è¿™ä¸ªè¿žæŽ¥ï¼Œè¿žæŽ¥çš„å»ºç«‹é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹ï¼Œé‡Šæ”¾åˆ™éœ€è¦å››æ¬¡æ¡æ‰‹ï¼Œæ‰€ä»¥è¯´æ¯ä¸ªè¿žæŽ¥çš„å»ºç«‹éƒ½æ˜¯éœ€è¦èµ„æºæ¶ˆè€—å’Œæ—¶é—´æ¶ˆè€—çš„ã€‚TCPé€šä¿¡çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œå¦‚ä¸‹å›¾:TCPçŸ­è¿žæŽ¥æ¨¡æ‹Ÿä¸€ç§TCPçŸ­è¿žæŽ¥çš„æƒ…å†µ:1. client å‘ server å‘èµ·è¿žæŽ¥è¯·æ±‚ 2. server æŽ¥åˆ°è¯·æ±‚ï¼ŒåŒæ–¹å»ºç«‹è¿žæŽ¥ 3. client å‘ server å‘é€æ¶ˆæ¯ 4. server å›žåº” client 5. ä¸€æ¬¡è¯»å†™å®Œæˆï¼Œæ­¤æ—¶åŒæ–¹ä»»ä½•ä¸€ä¸ªéƒ½å¯ä»¥å‘èµ· close æ“ä½œ åœ¨æ­¥éª¤5ä¸­ï¼Œä¸€èˆ¬éƒ½æ˜¯ client å…ˆå‘èµ· close æ“ä½œã€‚å½“ç„¶ä¹Ÿä¸æŽ’é™¤æœ‰ç‰¹æ®Šçš„æƒ…å†µã€‚ä»Žä¸Šé¢çš„æè¿°çœ‹ï¼ŒçŸ­è¿žæŽ¥ä¸€èˆ¬åªä¼šåœ¨ client/server é—´ä¼ é€’ä¸€æ¬¡è¯»å†™æ“ä½œï¼TCPé•¿è¿žæŽ¥å†æ¨¡æ‹Ÿä¸€ç§é•¿è¿žæŽ¥çš„æƒ…å†µ:1. client å‘ server å‘èµ·è¿žæŽ¥ 2. server æŽ¥åˆ°è¯·æ±‚ï¼ŒåŒæ–¹å»ºç«‹è¿žæŽ¥ 3. client å‘ server å‘é€æ¶ˆæ¯ 4. server å›žåº” client 5. ä¸€æ¬¡è¯»å†™å®Œæˆï¼Œè¿žæŽ¥ä¸å…³é—­ 6. åŽç»­è¯»å†™æ“ä½œ... 7. é•¿æ—¶é—´æ“ä½œä¹‹åŽclientå‘èµ·å…³é—­è¯·æ±‚ TCPé•¿/çŸ­è¿žæŽ¥æ“ä½œè¿‡ç¨‹çŸ­è¿žæŽ¥çš„æ“ä½œæ­¥éª¤æ˜¯ï¼šå»ºç«‹è¿žæŽ¥â€”â€”æ•°æ®ä¼ è¾“â€”â€”å…³é—­è¿žæŽ¥â€¦å»ºç«‹è¿žæŽ¥â€”â€”æ•°æ®ä¼ è¾“â€”â€”å…³é—­è¿žæŽ¥é•¿è¿žæŽ¥çš„æ“ä½œæ­¥éª¤æ˜¯ï¼šå»ºç«‹è¿žæŽ¥â€”â€”æ•°æ®ä¼ è¾“â€¦ï¼ˆä¿æŒè¿žæŽ¥ï¼‰â€¦æ•°æ®ä¼ è¾“â€”â€”å…³é—­è¿žæŽ¥TCPé•¿/çŸ­è¿žæŽ¥çš„ä¼˜ç‚¹å’Œç¼ºç‚¹é•¿è¿žæŽ¥å¯ä»¥çœåŽ»è¾ƒå¤šçš„TCPå»ºç«‹å’Œå…³é—­çš„æ“ä½œï¼Œå‡å°‘æµªè´¹ï¼ŒèŠ‚çº¦æ—¶é—´ã€‚å¯¹äºŽé¢‘ç¹è¯·æ±‚èµ„æºçš„å®¢æˆ·æ¥è¯´ï¼Œè¾ƒé€‚ç”¨é•¿è¿žæŽ¥ã€‚clientä¸Žserverä¹‹é—´çš„è¿žæŽ¥å¦‚æžœä¸€ç›´ä¸å…³é—­çš„è¯ï¼Œä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œéšç€å®¢æˆ·ç«¯è¿žæŽ¥è¶Šæ¥è¶Šå¤šï¼Œserveræ—©æ™šæœ‰æ‰›ä¸ä½çš„æ—¶å€™ï¼Œè¿™æ—¶å€™serverç«¯éœ€è¦é‡‡å–ä¸€äº›ç­–ç•¥ï¼Œå¦‚å…³é—­ä¸€äº›é•¿æ—¶é—´æ²¡æœ‰è¯»å†™äº‹ä»¶å‘ç”Ÿçš„è¿žæŽ¥ï¼Œè¿™æ ·å¯ä»¥é¿å…ä¸€äº›æ¶æ„è¿žæŽ¥å¯¼è‡´serverç«¯æœåŠ¡å—æŸï¼›å¦‚æžœæ¡ä»¶å†å…è®¸å°±å¯ä»¥ä»¥å®¢æˆ·ç«¯æœºå™¨ä¸ºé¢—ç²’åº¦ï¼Œé™åˆ¶æ¯ä¸ªå®¢æˆ·ç«¯çš„æœ€å¤§é•¿è¿žæŽ¥æ•°ï¼Œè¿™æ ·å¯ä»¥å®Œå…¨é¿å…æŸä¸ªè›‹ç–¼çš„å®¢æˆ·ç«¯è¿žç´¯åŽç«¯æœåŠ¡ã€‚çŸ­è¿žæŽ¥å¯¹äºŽæœåŠ¡å™¨æ¥è¯´ç®¡ç†è¾ƒä¸ºç®€å•ï¼Œå­˜åœ¨çš„è¿žæŽ¥éƒ½æ˜¯æœ‰ç”¨çš„è¿žæŽ¥ï¼Œä¸éœ€è¦é¢å¤–çš„æŽ§åˆ¶æ‰‹æ®µã€‚ä½†å¦‚æžœå®¢æˆ·è¯·æ±‚é¢‘ç¹ï¼Œå°†åœ¨TCPçš„å»ºç«‹å’Œå…³é—­æ“ä½œä¸Šæµªè´¹æ—¶é—´å’Œå¸¦å®½ã€‚TCPé•¿/çŸ­è¿žæŽ¥çš„åº”ç”¨åœºæ™¯é•¿è¿žæŽ¥å¤šç”¨äºŽæ“ä½œé¢‘ç¹ï¼Œç‚¹å¯¹ç‚¹çš„é€šè®¯ï¼Œè€Œä¸”è¿žæŽ¥æ•°ä¸èƒ½å¤ªå¤šæƒ…å†µã€‚æ¯ä¸ªTCPè¿žæŽ¥éƒ½éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œè¿™éœ€è¦æ—¶é—´ï¼Œå¦‚æžœæ¯ä¸ªæ“ä½œéƒ½æ˜¯å…ˆè¿žæŽ¥ï¼Œå†æ“ä½œçš„è¯é‚£ä¹ˆå¤„ç†é€Ÿåº¦ä¼šé™ä½Žå¾ˆå¤šï¼Œæ‰€ä»¥æ¯ä¸ªæ“ä½œå®ŒåŽéƒ½ä¸æ–­å¼€ï¼Œå†æ¬¡å¤„ç†æ—¶ç›´æŽ¥å‘é€æ•°æ®åŒ…å°±OKäº†ï¼Œä¸ç”¨å»ºç«‹TCPè¿žæŽ¥ã€‚ä¾‹å¦‚ï¼šæ•°æ®åº“çš„è¿žæŽ¥ç”¨é•¿è¿žæŽ¥ï¼Œå¦‚æžœç”¨çŸ­è¿žæŽ¥é¢‘ç¹çš„é€šä¿¡ä¼šé€ æˆsocketé”™è¯¯ï¼Œè€Œä¸”é¢‘ç¹çš„socket åˆ›å»ºä¹Ÿæ˜¯å¯¹èµ„æºçš„æµªè´¹ã€‚è€ŒåƒWEBç½‘ç«™çš„httpæœåŠ¡ä¸€èˆ¬éƒ½ç”¨çŸ­é“¾æŽ¥ï¼Œå› ä¸ºé•¿è¿žæŽ¥å¯¹äºŽæœåŠ¡ç«¯æ¥è¯´ä¼šè€—è´¹ä¸€å®šçš„èµ„æºï¼Œè€ŒåƒWEBç½‘ç«™è¿™ä¹ˆé¢‘ç¹çš„æˆåƒä¸Šä¸‡ç”šè‡³ä¸Šäº¿å®¢æˆ·ç«¯çš„è¿žæŽ¥ç”¨çŸ­è¿žæŽ¥ä¼šæ›´çœä¸€äº›èµ„æºï¼Œå¦‚æžœç”¨é•¿è¿žæŽ¥ï¼Œè€Œä¸”åŒæ—¶æœ‰æˆåƒä¸Šä¸‡çš„ç”¨æˆ·ï¼Œå¦‚æžœæ¯ä¸ªç”¨æˆ·éƒ½å ç”¨ä¸€ä¸ªè¿žæŽ¥çš„è¯ï¼Œé‚£å¯æƒ³è€ŒçŸ¥å§ã€‚æ‰€ä»¥å¹¶å‘é‡å¤§ï¼Œä½†æ¯ä¸ªç”¨æˆ·æ— éœ€é¢‘ç¹æ“ä½œæƒ…å†µä¸‹éœ€ç”¨çŸ­é“¾æŽ¥å¥½ã€‚tcp-ipç®€ä»‹ä»€ä¹ˆæ˜¯åè®®ä¸ºäº†è§£å†³ä¸åŒç§æ—äººä¹‹é—´çš„è¯­è¨€æ²Ÿé€šéšœç¢ï¼ŒçŽ°è§„å®šå›½é™…é€šç”¨è¯­è¨€æ˜¯è‹±è¯­ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªè§„å®šï¼Œè¿™å°±æ˜¯åè®®è®¡ç®—æœºç½‘ç»œæ²Ÿé€šç”¨ä»€ä¹ˆä¸åŒçš„è®¡ç®—æœºåªéœ€è¦èƒ½å¤Ÿè”ç½‘ï¼ˆæœ‰çº¿æ— çº¿éƒ½å¯ä»¥ï¼‰é‚£ä¹ˆå°±å¯ä»¥ç›¸äº’è¿›è¡Œä¼ é€’æ•°æ®å°±åƒè¯´ä¸åŒè¯­è¨€çš„äººæ²Ÿé€šä¸€æ ·ï¼Œåªè¦æœ‰ä¸€ç§å¤§å®¶éƒ½è®¤å¯éƒ½éµå®ˆçš„åè®®å³å¯ï¼Œé‚£ä¹ˆè¿™ä¸ªè®¡ç®—æœºéƒ½éµå®ˆçš„ç½‘ç»œé€šä¿¡åè®®å«åšTCP/IPåè®®TCP/IPåè®®(æ—)ä¸ºäº†æŠŠå…¨ä¸–ç•Œçš„æ‰€æœ‰ä¸åŒç±»åž‹çš„è®¡ç®—æœºéƒ½è¿žæŽ¥èµ·æ¥ï¼Œå°±å¿…é¡»è§„å®šä¸€å¥—å…¨çƒé€šç”¨çš„åè®®ï¼Œä¸ºäº†å®žçŽ°äº’è”ç½‘è¿™ä¸ªç›®æ ‡ï¼Œäº’è”ç½‘åè®®æ—ï¼ˆInternet Protocol Suiteï¼‰å°±æ˜¯é€šç”¨åè®®æ ‡å‡†ã€‚å› ä¸ºäº’è”ç½‘åè®®åŒ…å«äº†ä¸Šç™¾ç§åè®®æ ‡å‡†ï¼Œä½†æ˜¯æœ€é‡è¦çš„ä¸¤ä¸ªåè®®æ˜¯TCPå’ŒIPåè®®ï¼Œæ‰€ä»¥ï¼Œå¤§å®¶æŠŠäº’è”ç½‘çš„åè®®ç®€ç§°TCP/IPåè®®(æ—)å¸¸ç”¨çš„ç½‘ç»œåè®®å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šè¯´æ˜Žï¼šç½‘é™…å±‚ä¹Ÿç§°ä¸ºï¼šç½‘ç»œå±‚ç½‘ç»œæŽ¥å£å±‚ä¹Ÿç§°ä¸ºï¼šé“¾è·¯å±‚å¦å¤–ä¸€å¥—æ ‡å‡†:]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>tcp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[çˆ¬å–å¹²è´§é›†ä¸­è¥çš„å›¾ç‰‡]]></title>
    <url>%2F2019%2F12%2F31%2F%E7%88%AC%E5%8F%96%E5%B9%B2%E8%B4%A7%E9%9B%86%E4%B8%AD%E8%90%A5%E7%9A%84%E5%9B%BE%E7%89%87%2F</url>
    <content type="text"><![CDATA[ç½‘ç«™åœ°å€http://gank.io/ åˆ†æžç½‘ç«™ç½‘ç«™åœ°å€:https://gank.io/, è¦çˆ¬å–çš„æ˜¯ç½‘ç«™é¦–é¡µä¸Šå±•ç¤ºå‡ºæ¥çš„å›¾ç‰‡ åœ¨ç½‘ç«™é¦–é¡µåº•éƒ¨å·¦ä¸Šè§’æœ‰APIåœ°å€,ç‚¹å‡»è¿›å…¥åˆ°å¹²è´§é›†ä¸­è¥ API æ–‡æ¡£ å…¶ä¸­æœ‰è¿™æ ·çš„å†…å®¹æ˜¾ç¤º,å¦‚ä¸‹å›¾ï¼š å°è¯•è®¿é—®:https://gank.io/api/data/ç¦åˆ©/10/1, å‡ºæ¥å¦‚ä¸‹çš„jsonæ•°æ®ï¼š é€šè¿‡APIæ–‡æ¡£æè¿°,å¯ä»¥çŸ¥é“é“¾æŽ¥åœ°å€ä¸­çš„è¯·æ±‚ä¸ªæ•°å’Œè¯·æ±‚é¡µæ•°,èŽ·å–åˆ°æ‰€æœ‰çš„å›¾ç‰‡ä¿¡æ¯ã€‚ æ¯”å¦‚:https://gank.io/api/data/ç¦åˆ©/700/1, è¯·æ±‚700æ¡æ•°æ®,èŽ·å–ç¬¬ä¸€é¡µ,å‘çŽ°è¿”å›žçš„ç»“æžœä¸­æ€»å…±æœ‰670æ¡æ•°æ®(æˆªæ­¢åˆ°20190314),ç¬¬äºŒé¡µæ²¡æœ‰æ•°æ®. å†æ¬¡è¯·æ±‚:https://gank.io/api/data/ç¦åˆ©/600/1, è¯·æ±‚600æ¡æ•°æ®,èŽ·å–ç¬¬ä¸€é¡µ,å‘çŽ°ç¡®å®žæœ‰600æ¡æ•°æ®, ç„¶åŽå†è¯·æ±‚ç¬¬äºŒé¡µ(https://gank.io/api/data/ç¦åˆ©/600/2),æœ‰70æ¡æ•°æ®ã€‚ ç»“åˆä»¥ä¸Šåˆ†æž,æˆªæ­¢åˆ°ä»Šå¤©(20190314),å…±æœ‰670æ¡æ•°æ®,é¿å…ä½¿ç”¨ç¿»é¡µçš„æƒ…å†µ,å°±ç›´æŽ¥ä½¿ç”¨å¦‚ä¸‹ç½‘å€èŽ·å–å…¨éƒ¨æ•°æ®:https://gank.io/api/data/ç¦åˆ©/700/1 æ ¹æ®èŽ·å–åˆ°çš„sonæ•°æ®,æå–å‡ºæ‰€éœ€è¦çš„å›¾ç‰‡é“¾æŽ¥,æœ€åŽä¸‹è½½è¿™äº›å›¾ç‰‡å¹¶ä¿å­˜. å®žé™…ä»£ç #!/usr/bin/env python # -*- coding: utf-8 -*- import datetime import os from _md5 import md5 import requests from requests import RequestException def get_one_page(url): try: response = requests.get(url) if response.status_code == 200: return response.json() except: return None def utc_to_local(utc_time_str, utc_format=&apos;%Y-%m-%dT%H:%M:%S.%fZ&apos;): &quot;&quot;&quot; &quot;2015-06-05T03:54:29.403Z&quot;æ ¼å¼çš„æ—¶é—´è½¬æ¢æˆ2015-06-05 11:54:29 &quot;&quot;&quot; local_format = &quot;%Y-%m-%d %H:%M:%S&quot; utc_dt = datetime.datetime.strptime(utc_time_str, utc_format) local_dt = utc_dt + datetime.timedelta(hours=8) time_str = local_dt.strftime(local_format) return time_str def https_to_http(url): &quot;&quot;&quot; æŠŠå›¾ç‰‡é“¾æŽ¥æ˜¯httpsçš„æ¢æˆhttp &quot;&quot;&quot; if url[0:5] == &apos;https&apos;: url = url.replace(url[0:5], &apos;http&apos;) return url def parse_one_page(html): items = html[&apos;results&apos;] for item in items: yield { &apos;id&apos;: item[&apos;_id&apos;], &apos;publishedAt&apos;: utc_to_local(item[&apos;publishedAt&apos;]), &apos;url&apos;: https_to_http(item[&apos;url&apos;]) } # è¯·æ±‚å›¾ç‰‡url,èŽ·å–å›¾ç‰‡äºŒè¿›åˆ¶æ•°æ® def download_image(url): try: response = requests.get(url) if response.status_code == 200: save_image(response.content) # response.contenteräºŒè¿›åˆ¶æ•°æ® response.textæ–‡æœ¬æ•°æ® return None except RequestException: print(&apos;è¯·æ±‚å›¾ç‰‡å‡ºé”™&apos;, url) return None def save_image(content): &quot;&quot;&quot; éœ€è¦æå‰å»ºå¥½ç›®å½•D:\\pachong\\gank1\\ &quot;&quot;&quot; file_path = &apos;D:\\pachong\\gank1\\{1}.{2}&apos;.format(os.getcwd(), md5(content).hexdigest(), &apos;jpg&apos;) if not os.path.exists(file_path): with open(file_path, &apos;wb&apos;) as f: f.write(content) def main(): url = &apos;http://gank.io/api/data/ç¦åˆ©/700/1&apos; html = get_one_page(url) for item in parse_one_page(html): download_image(item[&apos;url&apos;]) if __name__ == &apos;__main__&apos;: main() ç»“æžœåˆ†æžæ€»å…±700æ¡jsonæ•°æ®,å®žé™…åªæœ‰564æ¡æ•°æ®,é€šè¿‡åˆ†æžèŽ·å–åˆ°çš„å›¾ç‰‡url,å‘çŽ°æœ‰äº›å›¾ç‰‡urlé“¾æŽ¥æœ¬èº«å·²å¤±æ•ˆ,ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€è¿™äº›å›¾ç‰‡é“¾æŽ¥ä¼šæŠ¥å¦‚ä¸‹é”™è¯¯: å¤±æ•ˆé“¾æŽ¥å±•ç¤º: å®žé™…ç»“æžœï¼š]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>çˆ¬è™«</tag>
        <tag>ç¾Žå¥³</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[çˆ¬å–ç¾Žå›¾å½•ç½‘ç«™å›¾ç‰‡]]></title>
    <url>%2F2019%2F12%2F31%2F%E7%88%AC%E5%8F%96%E7%BE%8E%E5%9B%BE%E5%BD%95%E7%BD%91%E7%AB%99%E5%9B%BE%E7%89%87%2F</url>
    <content type="text"><![CDATA[ç½‘ç«™åœ°å€https://www.meitulu.com/ åˆ†æžè¯¥ç½‘ç«™1. æ‰“å¼€ç½‘ç«™åœ°å€åŽï¼ŒæŸ¥çœ‹ç½‘ç«™å³ä¾§å¯¼èˆªèœå•ï¼Œç›®æ ‡æ˜¯æå–å‡ºçˆ¬å–ç½‘ç«™å›¾ç‰‡æ‰€éœ€çš„é“¾æŽ¥åœ°å€ï¼Œè¿™äº›é“¾æŽ¥åœ°å€æœ€å¥½æ˜¯åŒ…å«æ•´ä¸ªç½‘ç«™çš„é“¾æŽ¥åœ°å€ã€‚ 2. éšä¾¿ç‚¹å¼€ä¸€ä¸ªå›¾é›†åˆ†ç±»ä¸‹çš„ç±»åˆ«ï¼Œæ¯”å¦‚&quot;å¥³ç¥ž&quot;ï¼Œï¼Œè¿›å…¥åˆ°çš„é“¾æŽ¥åœ°å€æ˜¯ï¼šhttps://www.meitulu.com/t/nvshen/. 3. ä»Žä¸­éšä¾¿é€‰ä¸€ä¸ªå›¾é›†ç‚¹å¼€ï¼Œè¿›å…¥åˆ°è¯¥å›¾é›†çš„è¯¦æƒ…é¡µé¢ã€‚ä¸Šé¢æ˜¾ç¤ºçš„è¯¥å›¾é›†çš„ç›¸å…³ä¿¡æ¯ï¼Œä¸‹é¢æ˜¾ç¤ºçš„æ˜¯è¯¥å›¾é›†çš„æ¯å¼ å›¾ç‰‡ã€‚ å³ä¸Šè§’æ˜¾ç¤ºçš„æ˜¯è¯¥å›¾é›†çš„å½“å‰ä½ç½®ã€‚æ³¨æ„è¿™ä¸ªå½“å‰ä½ç½®ã€‚ 4. å†ä»Žå›¾é›†ç±»åˆ«ä¸­é€‰ä¸€ä¸ªè¿›å…¥åˆ°è¯¥å›¾é›†çš„è¯¦æƒ…é¡µé¢ï¼Œå‘çŽ°å³ä¸Šè§’ä¹Ÿæœ‰å½“å‰ä½ç½®ã€‚ 5. ç‚¹å‡»å¯¼èˆªèœå•ä¸­çš„ç²¾é€‰ç¾Žå¥³ï¼Œè¿›å…¥åˆ°æŸä¸€ä¸ªå›¾é›†è¯¦æƒ…é¡µé¢ï¼Œå‘çŽ°å³ä¸Šè§’ä¹Ÿæœ‰å½“å‰ä½ç½®ã€‚ 6. ç‚¹å‡»å¯¼èˆªèœå•ä¸­çš„æ—¥éŸ©ç¾Žå¥³ï¼Œè¿›å…¥åˆ°æŸä¸€ä¸ªå›¾é›†è¯¦æƒ…é¡µé¢ï¼Œå‘çŽ°å³ä¸Šè§’ä¹Ÿæœ‰å½“å‰ä½ç½®ã€‚ 7. ç»è¿‡ä»¥ä¸Šåˆ†æžå¯çŸ¥ï¼Œè¯¥ç½‘ç«™çš„å›¾é›†åˆ†ä¸ºå¦‚ä¸‹ä¸‰å¤§ç±»ï¼šæ—¥éŸ©ç¾Žå¥³ï¼Œæ¸¯å°ç¾Žå¥³å’Œå›½äº§ç¾Žå¥³ã€‚å›¾é›†åˆ†ç±»ä¸­æ˜¯æ¯ä¸€ä¸ªå›¾é›†çš„æ ‡ç­¾æ±‡æ€»ã€‚ 8. æå–å‡ºå›¾é›†ä¸‰å¤§ç±»çš„åœ°å€å¦‚ä¸‹ï¼š æ—¥éŸ©ç¾Žå¥³ï¼šhttps://www.meitulu.com/rihan/, æ¸¯å°ç¾Žå¥³ï¼šhttps://www.meitulu.com/gangtai/ï¼Œ å›½äº§ç¾Žå¥³ï¼šhttps://www.meitulu.com/guochan/, ç»æŸ¥çœ‹è¿™ä¸‰ä¸ªç½‘å€ï¼Œåªæœ‰æœ€åŽçš„ä¸ä¸€æ ·ï¼Œå‰é¢çš„ç½‘å€ç­‰éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¯ä»¥æž„é€ åˆ—è¡¨æ¥éåŽ†å¾ªçŽ¯ä½¿ç”¨ï¼Œ[&apos;rihan&apos;,&apos;gangtai&apos;,&apos;guochan&apos;] 9. å‡å¦‚è¿›å…¥å›½äº§ç¾Žå¥³é‡Œã€‚é€šè¿‡åˆ†æžé¡µé¢ä¿¡æ¯ï¼Œæ¯ä¸€ä¸ªå›¾é›†ä¿¡æ¯éƒ½æ˜¯åœ¨ä¸€ä¸ªliæ ‡ç­¾é‡Œï¼Œå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–å‡ºè¿™äº›liæ ‡ç­¾ã€‚ 10.ç‚¹å‡»å…¶ä¸­ä¸€ä¸ªå›¾é›†ï¼Œå…¶é“¾æŽ¥æ˜¯ï¼šhttps://www.meitulu.com/item/16889.html, è¿›å…¥åˆ°è¯¥å›¾é›†çš„è¯¦æƒ…é¡µé¢. æœ€ä¸Šé¢æ˜¾ç¤ºè¯¥å›¾é›†çš„å›¾ç‰‡å…±æœ‰96å¼ ï¼Œæ¯é¡µæ˜¾ç¤º4å¼ å›¾ç‰‡ï¼Œæ‹‰åˆ°æœ€åŽçš„ç¬¬24é¡µï¼Œ24*4=96å¼ ã€‚ 10.æŸ¥çœ‹è¯¥å›¾é›†ä¸‹çš„æ¯ä¸€ä¸ªå›¾ç‰‡é“¾æŽ¥ï¼Œå‘çŽ°æ˜¯åœ¨ä¸€ä¸ªimgæ ‡ç­¾é‡Œï¼Œç¬¬ä¸€ä¸ªçš„4å¼ å›¾ç‰‡åœ°å€ä¾æ¬¡æ˜¯ï¼š https://mtl.ttsqgs.com/images/img/16889/1.jpgï¼Œ https://mtl.ttsqgs.com/images/img/16889/2.jpgï¼Œ https://mtl.ttsqgs.com/images/img/16889/3.jpgï¼Œ https://mtl.ttsqgs.com/images/img/16889/4.jpgï¼Œ æœ€åŽ24é¡µçš„4å¼ å›¾ç‰‡åœ°å€é“¾æŽ¥æ˜¯ï¼šhttps://www.meitulu.com/item/16889_24.htmlï¼Œ æ¯ä¸€ä¸ªå›¾ç‰‡çš„åœ°å€ä¾æ¬¡æ˜¯ï¼š https://mtl.ttsqgs.com/images/img/16889/93.jpgï¼Œ https://mtl.ttsqgs.com/images/img/16889/94.jpgï¼Œ https://mtl.ttsqgs.com/images/img/16889/95.jpgï¼Œ https://mtl.ttsqgs.com/images/img/16889/96.jpg åŒæ—¶é¡µé¢æ˜¾ç¤ºçš„æœ‰&quot;ç¾Žå›¾å½•æç¤ºï¼šç‚¹å‡»å›¾ç‰‡ï¼ŒæŸ¥çœ‹åŽŸå°ºå¯¸é«˜æ¸…å¤§å›¾&quot;,jsä»£ç æ˜¯: function() { window.open(&quot;/img.html?img=&quot; + this.src + &quot;&quot;) } ç‚¹å‡»å›¾ç‰‡è¿›å…¥åŽŸå°ºå¯¸é«˜æ¸…å¤§å›¾ï¼Œå¤åˆ¶å‡ºç½‘å€å¦‚ä¸‹ï¼šhttps://www.meitulu.com/img.html?img=https://mtl.ttsqgs.com/images/img/16889/1.jpgã€‚ 11. åˆ†æžç¬¬10æ­¥çš„å›¾ç‰‡é“¾æŽ¥ï¼Œå¯ä»¥å‘çŽ°ï¼š (1)å›¾é›†é“¾æŽ¥åœ°å€(https://www.meitulu.com/item/16889.html)ä¸­çš„æ•°å­—16889è·Ÿè¯¥å›¾é›†ä¸­çš„æ¯ä¸€ä¸ªå¼ å›¾ç‰‡çš„é“¾æŽ¥åœ°å€(https://mtl.ttsqgs.com/images/img/16889/1.jpg)ç›¸å…³. (2)æ¯ä¸€ä¸ªå›¾ç‰‡çš„é“¾æŽ¥åœ°å€æœ€åŽçš„æ•°å­—æ˜¯ä»Ž1å¼€å§‹çš„ï¼Œä¸€ç›´åˆ°è¯¥å›¾é›†çš„æ€»æ•°ç¬¬96 (2)å›¾é›†è¯¦æƒ…é¡µä¸­çš„å›¾ç‰‡æ€»æ•°è·Ÿå›¾é›†åˆ†é¡µæ•°æœ‰å…³ï¼Œå›¾ç‰‡æ€»æ•°é™¤ä»¥4ï¼Œè‹¥æœ‰ä½™æ•°å†åŠ 1ï¼Œå¾—åˆ°çš„æ•°å­—å°±æ˜¯è¯¥å›¾é›†çš„åˆ†é¡µæ•°ã€‚ (3)è¯¥å›¾é›†çš„é“¾æŽ¥åœ°å€ä¹Ÿæœ‰è§„å¾‹ï¼Œæ¯”å¦‚å›¾é›†çš„ç¬¬ä¸€é¡µåœ°å€æ˜¯ï¼šhttps://www.meitulu.com/item/16889.htmlï¼Œ ç¬¬äºŒé¡µçš„æ˜¯ï¼šhttps://www.meitulu.com/item/16889_2.htmlï¼Œ æœ€åŽç¬¬24é¡µçš„æ˜¯ï¼šhttps://www.meitulu.com/item/16889_24.htmlã€‚ (4)ç»è¿‡ä»¥ä¸Šåˆ†æžï¼Œä¼˜å…ˆé‡‡ç”¨(1)å’Œ(2)ä¸­å¾—åˆ°çš„è§„å¾‹ï¼Œæå–å‡ºæ¯ä¸€ä¸ªå›¾é›†çš„åç§°ï¼Œå›¾é›†çš„é“¾æŽ¥å’Œå›¾ç‰‡æ€»æ•°ï¼Œç„¶åŽæž„é€ è¯¥å›¾é›†ä¸‹çš„æ¯ä¸€ä¸ªå›¾ç‰‡çš„é“¾æŽ¥ã€‚ (5)å›¾é›†çš„é“¾æŽ¥ä¹Ÿæœ‰è§„å¾‹ï¼Œæ¯”å¦‚å›½äº§ç¾Žå¥³åˆ†ç±»ï¼Œç¬¬ä¸€é¡µçš„åœ°å€æ˜¯ï¼šhttps://www.meitulu.com/guochan/ï¼Œ ç¬¬äºŒé¡µçš„åœ°å€æ˜¯ï¼šhttps://www.meitulu.com/guochan/2.htmlï¼Œ ç¬¬164é¡µçš„åœ°å€æ˜¯ï¼šhttps://www.meitulu.com/guochan/164.htmlã€‚ å¯ä»¥é‡‡ç”¨éåŽ†çš„æ–¹å¼ã€‚ å®žé™…æ“ä½œä¸­çš„å‘1. ä½¿ç”¨requestsçš„getæ–¹å¼è¯·æ±‚æ¯ä¸€ä¸ªå›¾ç‰‡çš„é“¾æŽ¥ï¼Œå¾—åˆ°çš„å›¾ç‰‡æ˜¯æŸåçš„ï¼Œå‘ç¾¤é‡Œå…¶ä»–äººè¯·æ•™å¾—çŸ¥ï¼Œè¯·æ±‚æ˜¯éœ€è¦åŠ ä¸Šheaderså¤´éƒ¨ä¿¡æ¯ï¼Œå¿…é¡»æœ‰Refererï¼Œä¸”Refererå‚æ•°å€¼è¿˜æœ‰è¦æ±‚ï¼Œæ¯”å¦‚è¯´æŸå¼ å›¾ç‰‡çš„å›¾ç‰‡åœ°å€æ˜¯ï¼šhttps://mtl.ttsqgs.com/images/img/16889/13.jpgï¼Œ åˆ™Refererçš„å€¼æ˜¯https://www.meitulu.com/img.html?img=https://mtl.ttsqgs.com/images/img/16889/13.jpgï¼Œ æ³¨æ„æŸ¥çœ‹è¿™ä¿©ç½‘å€ä¹‹é—´çš„å…³ç³»ã€‚ 2. è¯·æ±‚æ¬¡æ•°è¿‡å¤šä¼šæŠ¥403 Forbiddenï¼Œé€šè¿‡ä½¿ç”¨æ¨¡å—fake_useragentç”Ÿæˆéšæœºçš„User-Agentä¿¡æ¯ã€‚å¯ä»¥è§£å†³ä¸€å°éƒ¨åˆ†æƒ…å†µï¼Œæ—¶é—´ä¸€é•¿è¿˜æ˜¯ä¼šå†æ¬¡æŠ¥403 Forbiddenï¼Œåªèƒ½å†æ¬¡éšæœºç”Ÿæˆä¸åŒçš„User-Agentå€¼ã€‚ 3. æ—¶é—´é•¿çš„è¯ä¼šå‡ºçŽ°è¿™æ ·ä¸€ä¸ªæƒ…å†µï¼Œå¾€åŽçš„æ¯ä¸ªå›¾é›†åªèƒ½ä¸‹è½½ä¿å­˜å‰9å¼ å›¾ç‰‡ï¼Œä»¥åŽçš„å›¾ç‰‡è®¿é—®è¯·æ±‚å‡æŠ¥403 Forbiddenï¼Œè¿™ä¸ªä¼°è®¡æ˜¯å°IPäº†ï¼Œæ‰€ä»¥è¿˜éœ€è¦ä½¿ç”¨ä»£ç†æ‰è¡Œã€‚ 4. åœ¨ç½‘ä¸Šæ‰¾åˆ°çš„ä¸€ä¸ªèƒ½ç”¨çš„ä»£ç†è½¯ä»¶ï¼Œåœ°å€æ˜¯ï¼šhttps://github.com/chenjiandongx/async-proxy-poolï¼Œ è‹¥ä½¿ç”¨çš„redisç‰ˆæœ¬ä½ŽäºŽ3.0ï¼Œåˆ™ä»£ç†æ± ä»£ç å¯ä»¥ç›´æŽ¥è¿è¡Œä½¿ç”¨ï¼Œè‹¥é«˜äºŽ3.0ç‰ˆæœ¬ï¼Œåˆ™éœ€è¦ä¿®æ”¹å…¶ä¸­ä¸€ä¸ªæ–‡ä»¶ï¼Œå…·ä½“å¦‚ä¸‹ï¼šasync_proxy_pool/database.pyï¼Œä¿®æ”¹å…¶ä¸­çš„ç¬¬45è¡Œï¼ŒåŽŸå…ˆæ˜¯self.redis.zadd(REDIS_KEY, proxy, score)ï¼Œä¿®æ”¹æˆï¼šself.redis.zadd(REDIS_KEY, ï½›proxyï¼š scoreï½)ã€‚ 5. ä½¿ç”¨ä»£ç† (1)è¿è¡Œå®¢æˆ·ç«¯ï¼Œå¯åŠ¨æ”¶é›†å™¨å’Œæ ¡éªŒå™¨ï¼špython3 client.py (2)è¿è¡ŒæœåŠ¡å™¨ï¼Œå¯åŠ¨ web æœåŠ¡:python3 server_flask.py (3)èŽ·å–ä»£ç†åœ°å€ä¿¡æ¯ import requests proxy = requests.get(&apos;http://192.168.0.200:3289/pop&apos;) proxies = proxy.json() print(proxies) (4)çˆ¬è™«ä»£ç ä¸­ä½¿ç”¨ä»£ç† è·Ÿ(3)åˆäºŒä¸ºä¸€ import requests proxy = requests.get(&apos;http://192.168.0.200:3289/pop&apos;) requests.get(&quot;http://example.org&quot;, proxies=proxies) å®žé™…ä»£ç #!/usr/bin/env python # -*- coding: utf-8 -*- import os import random import re import requests from fake_useragent import UserAgent from requests.exceptions import RequestException â€‹# èŽ·å–ä¸‰å¤§åˆ†ç±»é¡µé¢è¯¦ç»†æ•°æ® def get_one_page(url): try: response = requests.get(url) if response.status_code == 200: response.encoding = &apos;utf8&apos; return response.text else: return None except RequestException: print(&apos;è¯·æ±‚å¤±è´¥&apos;) return None â€‹# è§£æžä¸‰å¤§åˆ†ç±»é¡µé¢æ•°æ®ï¼Œæå–éœ€è¦çš„æ•°æ® def parse_one_page(html): pattern = re.compile(&apos;&lt;li&gt;.*?&lt;p&gt;æ•°é‡ï¼š (.*?) å¼ &lt;/p&gt;.*?&lt;p class=p_title&gt;&lt;a href=&quot;(.*?)&quot;.*?&gt;(.*?)&lt;/a&gt;&lt;/p&gt;.*?&lt;/li&gt;&apos;, re.S | re.M) items = re.findall(pattern, html) for i in range(len(items)): yield { &apos;num&apos;: int(items[i][0]), # èŽ·å–å›¾é›†çš„å›¾ç‰‡æ€»æ•° &apos;name&apos;: items[i][2], # èŽ·å–å›¾é›†åç§° &apos;url&apos;: items[i][1].split(&apos;/&apos;)[4][:-5], # èŽ·å–å›¾é›†id } â€‹# èŽ·å–éšæœºè¯·æ±‚å¤´ def GetUserAgent(): ua = UserAgent() return random.choice([ua.safari, ua.firefox, ua.chrome, ua.opera, ua.ie, ua.random]) â€‹# èŽ·å–éšæœºä»£ç†åœ°å€,å› çˆ¬å–é€Ÿåº¦æ…¢ï¼Œæš‚ä¸ä½¿ç”¨ def GetProxy(): proxy = requests.get(&apos;http://192.168.0.200:3289/pop&apos;) proxies = proxy.json() return proxies â€‹# è¯·æ±‚å›¾ç‰‡é“¾æŽ¥åœ°å€ def download_image(item): try: file_path = item[&apos;name&apos;] # èŽ·å–å›¾é›†åç§° id = item[&apos;url&apos;] # èŽ·å–å›¾é›†id num = item[&apos;num&apos;] # èŽ·å–å›¾é›†çš„å›¾ç‰‡æ€»æ•° for i in range(1, num + 1): url = f&apos;https://mtl.ttsqgs.com/images/img/{id}/{i}.jpg&apos; # ä½¿ç”¨f-stringçš„æ–¹å¼æ‹¼æŽ¥å­—ç¬¦ä¸² headers = { # æž„é€ è¯·æ±‚å¤´ &apos;User-Agent&apos;: GetUserAgent(), &apos;Accept&apos;: &apos;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&apos;, &apos;Accept-Encoding&apos;: &apos;gzip, deflate, br&apos;, &apos;Accept-Language&apos;: &apos;zh-CN,en-US;q=0.8,zh;q=0.5,en;q=0.3&apos;, &apos;Referer&apos;: &apos;https://www.meitulu.com/img.html?img=%s&apos; % url, } yield { &apos;name&apos;: file_path, &apos;headers&apos;: headers, &apos;i&apos;: i, &apos;url&apos;: url, &apos;num&apos;: num } except RequestException: print(&apos;è¯·æ±‚å›¾ç‰‡å‡ºé”™&apos;) return None â€‹# ä¿å­˜å›¾ç‰‡ï¼Œä½¿ç”¨ç¬¬ä¸‰æ–¹é”™è¯¯é‡è¯•æ¨¡å—ï¼Œè¯¥æ¨¡å—éœ€è¦å¯¼å…¥ # @retry(stop_max_attempt_number=3) def save_image(path, x): name = x[&apos;name&apos;] i = x[&apos;i&apos;] headers = x[&apos;headers&apos;] url = x[&apos;url&apos;] num = x[&apos;num&apos;] base_path = f&apos;{os.getcwd()}{os.sep}{path}{os.sep}{name}&apos; if not os.path.exists(base_path): os.makedirs(base_path) save_path = f&apos;{base_path}{os.sep}{i}.jpg&apos; if not os.path.exists(save_path): try: requests.packages.urllib3.disable_warnings() response = requests.get(url, headers=headers, verify=False) except: print(f&apos;è¯·æ±‚{name}å›¾é›†çš„ç¬¬{i}å¼ å›¾ç‰‡é“¾æŽ¥åœ°å€å¤±è´¥,å…±{num}å¼ ,å›¾ç‰‡é“¾æŽ¥æ˜¯{url}&apos;) else: if response.status_code == 200: try: with open(save_path, &apos;wb&apos;) as f: f.write(response.content) print(f&apos;ä¿å­˜{name}å›¾é›†çš„ç¬¬{i}å¼ å›¾ç‰‡æˆåŠŸ,å…±{num}å¼ &apos;) except: print(f&apos;ä¿å­˜{name}å›¾é›†çš„ç¬¬{i}å¼ å›¾ç‰‡å¤±è´¥,å…±{num}å¼ ,å›¾ç‰‡é“¾æŽ¥æ˜¯{url}&apos;) else: print(f&apos;è¯·æ±‚{name}å›¾é›†çš„ç¬¬{i}å¼ å›¾ç‰‡é“¾æŽ¥åœ°å€çŠ¶æ€ä¸æ˜¯200,å…±{num}å¼ ,å›¾ç‰‡é“¾æŽ¥æ˜¯{url}&apos;) else: print(f&apos;{name}å›¾é›†æ–‡ä»¶å¤¹å·²å­˜åœ¨,è¯·æ±‚ä¸€ä¸‹å›¾é›†&apos;) # éåŽ†ä¸‰å¤§åˆ†ç±» def img_url(): img_ict = {&apos;rihan&apos;: 88, &apos;gangtai&apos;: 36, &apos;guochan&apos;: 165} for k, v in img_ict.items(): yield { &apos;name&apos;: k, &apos;num&apos;: v } # æ–°ä¼ åˆ†ç±»åç§° def main(): for img_u in img_url(): for i in range(1, img_u[&apos;num&apos;]): if i == 1: url = f&apos;https://www.meitulu.com/{img_u[&quot;name&quot;]}/&apos; else: url = f&apos;https://www.meitulu.com/{img_u[&quot;name&quot;]}/{i}.html&apos; html = get_one_page(url) for item in parse_one_page(html): for x in download_image(item): save_image(img_u[&apos;name&apos;], x) â€‹if name == â€˜mainâ€˜:main()æ•ˆæžœå±•ç¤º]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>çˆ¬è™«</tag>
        <tag>ç¾Žå¥³</tag>
        <tag>requests</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¤šä»»åŠ¡_è¿›ç¨‹]]></title>
    <url>%2F2019%2F12%2F31%2F%E5%A4%9A%E4%BB%BB%E5%8A%A1_%E8%BF%9B%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[è¿›ç¨‹ä»¥åŠçŠ¶æ€è¿›ç¨‹ç¨‹åºï¼šä¾‹å¦‚xxx.pyè¿™æ˜¯ç¨‹åºï¼Œæ˜¯ä¸€ä¸ªé™æ€çš„è¿›ç¨‹ï¼šä¸€ä¸ªç¨‹åºè¿è¡Œèµ·æ¥åŽï¼Œä»£ç +ç”¨åˆ°çš„èµ„æº ç§°ä¹‹ä¸ºè¿›ç¨‹ï¼Œå®ƒæ˜¯æ“ä½œç³»ç»Ÿåˆ†é…èµ„æºçš„åŸºæœ¬å•å…ƒã€‚ä¸ä»…å¯ä»¥é€šè¿‡çº¿ç¨‹å®Œæˆå¤šä»»åŠ¡ï¼Œè¿›ç¨‹ä¹Ÿæ˜¯å¯ä»¥çš„è¿›ç¨‹çš„çŠ¶æ€å·¥ä½œä¸­ï¼Œä»»åŠ¡æ•°å¾€å¾€å¤§äºŽcpuçš„æ ¸æ•°ï¼Œå³ä¸€å®šæœ‰ä¸€äº›ä»»åŠ¡æ­£åœ¨æ‰§è¡Œï¼Œè€Œå¦å¤–ä¸€äº›ä»»åŠ¡åœ¨ç­‰å¾…cpuè¿›è¡Œæ‰§è¡Œï¼Œå› æ­¤å¯¼è‡´äº†æœ‰äº†ä¸åŒçš„çŠ¶æ€å°±ç»ªæ€ï¼šè¿è¡Œçš„æ¡ä»¶éƒ½å·²ç»æ…¢åŽ»ï¼Œæ­£åœ¨ç­‰åœ¨cpuæ‰§è¡Œæ‰§è¡Œæ€ï¼šcpuæ­£åœ¨æ‰§è¡Œå…¶åŠŸèƒ½ç­‰å¾…æ€ï¼šç­‰å¾…æŸäº›æ¡ä»¶æ»¡è¶³ï¼Œä¾‹å¦‚ä¸€ä¸ªç¨‹åºsleepäº†ï¼Œæ­¤æ—¶å°±å¤„äºŽç­‰å¾…æ€è¿›ç¨‹çš„åˆ›å»º-multiprocessingmultiprocessingæ¨¡å—å°±æ˜¯è·¨å¹³å°ç‰ˆæœ¬çš„å¤šè¿›ç¨‹æ¨¡å—ï¼Œæä¾›äº†ä¸€ä¸ªProcessç±»æ¥ä»£è¡¨ä¸€ä¸ªè¿›ç¨‹å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ï¼Œå¯ä»¥æ‰§è¡Œå¦å¤–çš„äº‹æƒ…2ä¸ªwhileå¾ªçŽ¯ä¸€èµ·æ‰§è¡Œ1234567891011121314151617from multiprocessing import Processimport timedef run_proc(): """å­è¿›ç¨‹è¦æ‰§è¡Œçš„ä»£ç """ while True: print("----2----") time.sleep(1)if __name__=='__main__': p = Process(target=run_proc) p.start() while True: print("----1----") time.sleep(1)è¯´æ˜Žåˆ›å»ºå­è¿›ç¨‹æ—¶ï¼Œåªéœ€è¦ä¼ å…¥ä¸€ä¸ªæ‰§è¡Œå‡½æ•°å’Œå‡½æ•°çš„å‚æ•°ï¼Œåˆ›å»ºä¸€ä¸ªProcesså®žä¾‹ï¼Œç”¨start()æ–¹æ³•å¯åŠ¨è¿›ç¨‹pid12345678910111213from multiprocessing import Processimport osimport timedef run_proc(): """å­è¿›ç¨‹è¦æ‰§è¡Œçš„ä»£ç """ print('å­è¿›ç¨‹è¿è¡Œä¸­ï¼Œpid=%d...' % os.getpid()) # os.getpidèŽ·å–å½“å‰è¿›ç¨‹çš„è¿›ç¨‹å· print('å­è¿›ç¨‹å°†è¦ç»“æŸ...')if __name__ == '__main__': print('çˆ¶è¿›ç¨‹pid: %d' % os.getpid()) # os.getpidèŽ·å–å½“å‰è¿›ç¨‹çš„è¿›ç¨‹å· p = Process(target=run_proc) p.start()Processè¯­æ³•ç»“æž„Process([group [, target [, name [, args [, kwargs]]]]])targetï¼šå¦‚æžœä¼ é€’äº†å‡½æ•°çš„å¼•ç”¨ï¼Œå¯ä»¥ä»»åŠ¡è¿™ä¸ªå­è¿›ç¨‹å°±æ‰§è¡Œè¿™é‡Œçš„ä»£ç argsï¼šç»™targetæŒ‡å®šçš„å‡½æ•°ä¼ é€’çš„å‚æ•°ï¼Œä»¥å…ƒç»„çš„æ–¹å¼ä¼ é€’kwargsï¼šç»™targetæŒ‡å®šçš„å‡½æ•°ä¼ é€’å‘½åå‚æ•°nameï¼šç»™è¿›ç¨‹è®¾å®šä¸€ä¸ªåå­—ï¼Œå¯ä»¥ä¸è®¾å®šgroupï¼šæŒ‡å®šè¿›ç¨‹ç»„ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ç”¨ä¸åˆ°Processåˆ›å»ºçš„å®žä¾‹å¯¹è±¡çš„å¸¸ç”¨æ–¹æ³•ï¼šstart()ï¼šå¯åŠ¨å­è¿›ç¨‹å®žä¾‹ï¼ˆåˆ›å»ºå­è¿›ç¨‹ï¼‰is_alive()ï¼šåˆ¤æ–­è¿›ç¨‹å­è¿›ç¨‹æ˜¯å¦è¿˜åœ¨æ´»ç€join([timeout])ï¼šæ˜¯å¦ç­‰å¾…å­è¿›ç¨‹æ‰§è¡Œç»“æŸï¼Œæˆ–ç­‰å¾…å¤šå°‘ç§’terminate()ï¼šä¸ç®¡ä»»åŠ¡æ˜¯å¦å®Œæˆï¼Œç«‹å³ç»ˆæ­¢å­è¿›ç¨‹Processåˆ›å»ºçš„å®žä¾‹å¯¹è±¡çš„å¸¸ç”¨å±žæ€§ï¼šnameï¼šå½“å‰è¿›ç¨‹çš„åˆ«åï¼Œé»˜è®¤ä¸ºProcess-Nï¼ŒNä¸ºä»Ž1å¼€å§‹é€’å¢žçš„æ•´æ•°pidï¼šå½“å‰è¿›ç¨‹çš„pidï¼ˆè¿›ç¨‹å·ï¼‰ç»™å­è¿›ç¨‹æŒ‡å®šçš„å‡½æ•°ä¼ é€’å‚æ•°12345678910111213141516from multiprocessing import Processimport osfrom time import sleepdef run_proc(name, age, **kwargs): for i in range(10): print('å­è¿›ç¨‹è¿è¡Œä¸­ï¼Œname= %s,age=%d ,pid=%d...' % (name, age, os.getpid())) print(kwargs) sleep(0.2)if __name__=='__main__': p = Process(target=run_proc, args=('test',18), kwargs=&#123;"m":20&#125;) p.start() sleep(1) # 1ç§’ä¸­ä¹‹åŽï¼Œç«‹å³ç»“æŸå­è¿›ç¨‹ p.terminate() p.join()è¿›ç¨‹é—´ä¸å…±äº«å…¨å±€å˜é‡12345678910111213141516171819202122232425from multiprocessing import Processimport osimport timenums = [11, 22]def work1(): """å­è¿›ç¨‹è¦æ‰§è¡Œçš„ä»£ç """ print("in process1 pid=%d ,nums=%s" % (os.getpid(), nums)) for i in range(3): nums.append(i) time.sleep(1) print("in process1 pid=%d ,nums=%s" % (os.getpid(), nums))def work2(): """å­è¿›ç¨‹è¦æ‰§è¡Œçš„ä»£ç """ print("in process2 pid=%d ,nums=%s" % (os.getpid(), nums))if __name__ == '__main__': p1 = Process(target=work1) p1.start() p1.join() p2 = Process(target=work2) p2.start()è¿è¡Œç»“æžœ:12345in process1 pid=11349 ,nums=[11, 22]in process1 pid=11349 ,nums=[11, 22, 0]in process1 pid=11349 ,nums=[11, 22, 0, 1]in process1 pid=11349 ,nums=[11, 22, 0, 1, 2]in process2 pid=11350 ,nums=[11, 22]è¿›ç¨‹ã€çº¿ç¨‹å¯¹æ¯”åŠŸèƒ½è¿›ç¨‹ï¼Œèƒ½å¤Ÿå®Œæˆå¤šä»»åŠ¡ï¼Œæ¯”å¦‚ åœ¨ä¸€å°ç”µè„‘ä¸Šèƒ½å¤ŸåŒæ—¶è¿è¡Œå¤šä¸ªQQçº¿ç¨‹ï¼Œèƒ½å¤Ÿå®Œæˆå¤šä»»åŠ¡ï¼Œæ¯”å¦‚ ä¸€ä¸ªQQä¸­çš„å¤šä¸ªèŠå¤©çª—å£å®šä¹‰çš„ä¸åŒè¿›ç¨‹æ˜¯ç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„ä¸€ä¸ªç‹¬ç«‹å•ä½.çº¿ç¨‹æ˜¯è¿›ç¨‹çš„ä¸€ä¸ªå®žä½“,æ˜¯CPUè°ƒåº¦å’Œåˆ†æ´¾çš„åŸºæœ¬å•ä½,å®ƒæ˜¯æ¯”è¿›ç¨‹æ›´å°çš„èƒ½ç‹¬ç«‹è¿è¡Œçš„åŸºæœ¬å•ä½.çº¿ç¨‹è‡ªå·±åŸºæœ¬ä¸Šä¸æ‹¥æœ‰ç³»ç»Ÿèµ„æº,åªæ‹¥æœ‰ä¸€ç‚¹åœ¨è¿è¡Œä¸­å¿…ä¸å¯å°‘çš„èµ„æº(å¦‚ç¨‹åºè®¡æ•°å™¨,ä¸€ç»„å¯„å­˜å™¨å’Œæ ˆ),ä½†æ˜¯å®ƒå¯ä¸ŽåŒå±žä¸€ä¸ªè¿›ç¨‹çš„å…¶ä»–çš„çº¿ç¨‹å…±äº«è¿›ç¨‹æ‰€æ‹¥æœ‰çš„å…¨éƒ¨èµ„æº.åŒºåˆ«ä¸€ä¸ªç¨‹åºè‡³å°‘æœ‰ä¸€ä¸ªè¿›ç¨‹,ä¸€ä¸ªè¿›ç¨‹è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹.çº¿ç¨‹çš„åˆ’åˆ†å°ºåº¦å°äºŽè¿›ç¨‹(èµ„æºæ¯”è¿›ç¨‹å°‘)ï¼Œä½¿å¾—å¤šçº¿ç¨‹ç¨‹åºçš„å¹¶å‘æ€§é«˜ã€‚è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ‹¥æœ‰ç‹¬ç«‹çš„å†…å­˜å•å…ƒï¼Œè€Œå¤šä¸ªçº¿ç¨‹å…±äº«å†…å­˜ï¼Œä»Žè€Œæžå¤§åœ°æé«˜äº†ç¨‹åºçš„è¿è¡Œæ•ˆçŽ‡![]/images_jincheng/002.png)çº¿ç¨‹ä¸èƒ½å¤Ÿç‹¬ç«‹æ‰§è¡Œï¼Œå¿…é¡»ä¾å­˜åœ¨è¿›ç¨‹ä¸­å¯ä»¥å°†è¿›ç¨‹ç†è§£ä¸ºå·¥åŽ‚ä¸­çš„ä¸€æ¡æµæ°´çº¿ï¼Œè€Œå…¶ä¸­çš„çº¿ç¨‹å°±æ˜¯è¿™ä¸ªæµæ°´çº¿ä¸Šçš„å·¥äººä¼˜ç¼ºç‚¹çº¿ç¨‹å’Œè¿›ç¨‹åœ¨ä½¿ç”¨ä¸Šå„æœ‰ä¼˜ç¼ºç‚¹ï¼šçº¿ç¨‹æ‰§è¡Œå¼€é”€å°ï¼Œä½†ä¸åˆ©äºŽèµ„æºçš„ç®¡ç†å’Œä¿æŠ¤ï¼›è€Œè¿›ç¨‹æ­£ç›¸åã€‚è¿›ç¨‹é—´é€šä¿¡-QueueProcessä¹‹é—´æœ‰æ—¶éœ€è¦é€šä¿¡ï¼Œæ“ä½œç³»ç»Ÿæä¾›äº†å¾ˆå¤šæœºåˆ¶æ¥å®žçŽ°è¿›ç¨‹é—´çš„é€šä¿¡ã€‚Queueçš„ä½¿ç”¨å¯ä»¥ä½¿ç”¨multiprocessingæ¨¡å—çš„Queueå®žçŽ°å¤šè¿›ç¨‹ä¹‹é—´çš„æ•°æ®ä¼ é€’ï¼ŒQueueæœ¬èº«æ˜¯ä¸€ä¸ªæ¶ˆæ¯åˆ—é˜Ÿç¨‹åºï¼Œé¦–å…ˆç”¨ä¸€ä¸ªå°å®žä¾‹æ¥æ¼”ç¤ºä¸€ä¸‹Queueçš„å·¥ä½œåŽŸç†ï¼š123456789101112131415161718192021222324252627from multiprocessing import Queueq=Queue(3) #åˆå§‹åŒ–ä¸€ä¸ªQueueå¯¹è±¡ï¼Œæœ€å¤šå¯æŽ¥æ”¶ä¸‰æ¡putæ¶ˆæ¯q.put("æ¶ˆæ¯1") q.put("æ¶ˆæ¯2")print(q.full()) #Falseq.put("æ¶ˆæ¯3")print(q.full()) #True#å› ä¸ºæ¶ˆæ¯åˆ—é˜Ÿå·²æ»¡ä¸‹é¢çš„tryéƒ½ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œç¬¬ä¸€ä¸ªtryä¼šç­‰å¾…2ç§’åŽå†æŠ›å‡ºå¼‚å¸¸ï¼Œç¬¬äºŒä¸ªTryä¼šç«‹åˆ»æŠ›å‡ºå¼‚å¸¸try: q.put("æ¶ˆæ¯4",True,2)except: print("æ¶ˆæ¯åˆ—é˜Ÿå·²æ»¡ï¼ŒçŽ°æœ‰æ¶ˆæ¯æ•°é‡:%s"%q.qsize())try: q.put_nowait("æ¶ˆæ¯4")except: print("æ¶ˆæ¯åˆ—é˜Ÿå·²æ»¡ï¼ŒçŽ°æœ‰æ¶ˆæ¯æ•°é‡:%s"%q.qsize())#æŽ¨èçš„æ–¹å¼ï¼Œå…ˆåˆ¤æ–­æ¶ˆæ¯åˆ—é˜Ÿæ˜¯å¦å·²æ»¡ï¼Œå†å†™å…¥if not q.full(): q.put_nowait("æ¶ˆæ¯4")#è¯»å–æ¶ˆæ¯æ—¶ï¼Œå…ˆåˆ¤æ–­æ¶ˆæ¯åˆ—é˜Ÿæ˜¯å¦ä¸ºç©ºï¼Œå†è¯»å–if not q.empty(): for i in range(q.qsize()): print(q.get_nowait())è¿è¡Œç»“æžœ:1234567FalseTrueæ¶ˆæ¯åˆ—é˜Ÿå·²æ»¡ï¼ŒçŽ°æœ‰æ¶ˆæ¯æ•°é‡:3æ¶ˆæ¯åˆ—é˜Ÿå·²æ»¡ï¼ŒçŽ°æœ‰æ¶ˆæ¯æ•°é‡:3æ¶ˆæ¯1æ¶ˆæ¯2æ¶ˆæ¯3è¯´æ˜Žåˆå§‹åŒ–Queue()å¯¹è±¡æ—¶ï¼ˆä¾‹å¦‚ï¼šq=Queue()ï¼‰ï¼Œè‹¥æ‹¬å·ä¸­æ²¡æœ‰æŒ‡å®šæœ€å¤§å¯æŽ¥æ”¶çš„æ¶ˆæ¯æ•°é‡ï¼Œæˆ–æ•°é‡ä¸ºè´Ÿå€¼ï¼Œé‚£ä¹ˆå°±ä»£è¡¨å¯æŽ¥å—çš„æ¶ˆæ¯æ•°é‡æ²¡æœ‰ä¸Šé™ï¼ˆç›´åˆ°å†…å­˜çš„å°½å¤´ï¼‰ï¼›Queue.qsize()ï¼šè¿”å›žå½“å‰é˜Ÿåˆ—åŒ…å«çš„æ¶ˆæ¯æ•°é‡ï¼›Queue.empty()ï¼šå¦‚æžœé˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å›žTrueï¼Œåä¹‹False ï¼›Queue.full()ï¼šå¦‚æžœé˜Ÿåˆ—æ»¡äº†ï¼Œè¿”å›žTrue,åä¹‹Falseï¼›Queue.get([block[, timeout]])ï¼šèŽ·å–é˜Ÿåˆ—ä¸­çš„ä¸€æ¡æ¶ˆæ¯ï¼Œç„¶åŽå°†å…¶ä»Žåˆ—é˜Ÿä¸­ç§»é™¤ï¼Œblocké»˜è®¤å€¼ä¸ºTrueï¼›1ï¼‰å¦‚æžœblockä½¿ç”¨é»˜è®¤å€¼ï¼Œä¸”æ²¡æœ‰è®¾ç½®timeoutï¼ˆå•ä½ç§’ï¼‰ï¼Œæ¶ˆæ¯åˆ—é˜Ÿå¦‚æžœä¸ºç©ºï¼Œæ­¤æ—¶ç¨‹åºå°†è¢«é˜»å¡žï¼ˆåœåœ¨è¯»å–çŠ¶æ€ï¼‰ï¼Œç›´åˆ°ä»Žæ¶ˆæ¯åˆ—é˜Ÿè¯»åˆ°æ¶ˆæ¯ä¸ºæ­¢ï¼Œå¦‚æžœè®¾ç½®äº†timeoutï¼Œåˆ™ä¼šç­‰å¾…timeoutç§’ï¼Œè‹¥è¿˜æ²¡è¯»å–åˆ°ä»»ä½•æ¶ˆæ¯ï¼Œåˆ™æŠ›å‡ºâ€Queue.Emptyâ€å¼‚å¸¸ï¼›2ï¼‰å¦‚æžœblockå€¼ä¸ºFalseï¼Œæ¶ˆæ¯åˆ—é˜Ÿå¦‚æžœä¸ºç©ºï¼Œåˆ™ä¼šç«‹åˆ»æŠ›å‡ºâ€Queue.Emptyâ€å¼‚å¸¸ï¼›Queue.get_nowait()ï¼šç›¸å½“Queue.get(False)ï¼›Queue.put(item,[block[, timeout]])ï¼šå°†itemæ¶ˆæ¯å†™å…¥é˜Ÿåˆ—ï¼Œblocké»˜è®¤å€¼ä¸ºTrueï¼›1ï¼‰å¦‚æžœblockä½¿ç”¨é»˜è®¤å€¼ï¼Œä¸”æ²¡æœ‰è®¾ç½®timeoutï¼ˆå•ä½ç§’ï¼‰ï¼Œæ¶ˆæ¯åˆ—é˜Ÿå¦‚æžœå·²ç»æ²¡æœ‰ç©ºé—´å¯å†™å…¥ï¼Œæ­¤æ—¶ç¨‹åºå°†è¢«é˜»å¡žï¼ˆåœåœ¨å†™å…¥çŠ¶æ€ï¼‰ï¼Œç›´åˆ°ä»Žæ¶ˆæ¯åˆ—é˜Ÿè…¾å‡ºç©ºé—´ä¸ºæ­¢ï¼Œå¦‚æžœè®¾ç½®äº†timeoutï¼Œåˆ™ä¼šç­‰å¾…timeoutç§’ï¼Œè‹¥è¿˜æ²¡ç©ºé—´ï¼Œåˆ™æŠ›å‡ºâ€Queue.Fullâ€å¼‚å¸¸ï¼›2ï¼‰å¦‚æžœblockå€¼ä¸ºFalseï¼Œæ¶ˆæ¯åˆ—é˜Ÿå¦‚æžœæ²¡æœ‰ç©ºé—´å¯å†™å…¥ï¼Œåˆ™ä¼šç«‹åˆ»æŠ›å‡ºâ€Queue.Fullâ€å¼‚å¸¸ï¼›Queue.put_nowait(item)ï¼šç›¸å½“Queue.put(item, False)ï¼›Queueå®žä¾‹æˆ‘ä»¬ä»¥Queueä¸ºä¾‹ï¼Œåœ¨çˆ¶è¿›ç¨‹ä¸­åˆ›å»ºä¸¤ä¸ªå­è¿›ç¨‹ï¼Œä¸€ä¸ªå¾€Queueé‡Œå†™æ•°æ®ï¼Œä¸€ä¸ªä»ŽQueueé‡Œè¯»æ•°æ®ï¼š1234567891011121314151617181920212223242526272829303132333435from multiprocessing import Process, Queueimport os, time, random# å†™æ•°æ®è¿›ç¨‹æ‰§è¡Œçš„ä»£ç :def write(q): for value in ['A', 'B', 'C']: print('Put %s to queue...' % value) q.put(value) time.sleep(random.random())# è¯»æ•°æ®è¿›ç¨‹æ‰§è¡Œçš„ä»£ç :def read(q): while True: if not q.empty(): value = q.get(True) print('Get %s from queue.' % value) time.sleep(random.random()) else: breakif __name__=='__main__': # çˆ¶è¿›ç¨‹åˆ›å»ºQueueï¼Œå¹¶ä¼ ç»™å„ä¸ªå­è¿›ç¨‹ï¼š q = Queue() pw = Process(target=write, args=(q,)) pr = Process(target=read, args=(q,)) # å¯åŠ¨å­è¿›ç¨‹pwï¼Œå†™å…¥: pw.start() # ç­‰å¾…pwç»“æŸ: pw.join() # å¯åŠ¨å­è¿›ç¨‹prï¼Œè¯»å–: pr.start() pr.join() # prè¿›ç¨‹é‡Œæ˜¯æ­»å¾ªçŽ¯ï¼Œæ— æ³•ç­‰å¾…å…¶ç»“æŸï¼Œåªèƒ½å¼ºè¡Œç»ˆæ­¢: print('') print('æ‰€æœ‰æ•°æ®éƒ½å†™å…¥å¹¶ä¸”è¯»å®Œ')è¿›ç¨‹æ± Poolå½“éœ€è¦åˆ›å»ºçš„å­è¿›ç¨‹æ•°é‡ä¸å¤šæ—¶ï¼Œå¯ä»¥ç›´æŽ¥åˆ©ç”¨multiprocessingä¸­çš„ProcessåŠ¨æ€æˆç”Ÿå¤šä¸ªè¿›ç¨‹ï¼Œä½†å¦‚æžœæ˜¯ä¸Šç™¾ç”šè‡³ä¸Šåƒä¸ªç›®æ ‡ï¼Œæ‰‹åŠ¨çš„åŽ»åˆ›å»ºè¿›ç¨‹çš„å·¥ä½œé‡å·¨å¤§ï¼Œæ­¤æ—¶å°±å¯ä»¥ç”¨åˆ°multiprocessingæ¨¡å—æä¾›çš„Poolæ–¹æ³•ã€‚åˆå§‹åŒ–Poolæ—¶ï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ªæœ€å¤§è¿›ç¨‹æ•°ï¼Œå½“æœ‰æ–°çš„è¯·æ±‚æäº¤åˆ°Poolä¸­æ—¶ï¼Œå¦‚æžœæ± è¿˜æ²¡æœ‰æ»¡ï¼Œé‚£ä¹ˆå°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹ç”¨æ¥æ‰§è¡Œè¯¥è¯·æ±‚ï¼›ä½†å¦‚æžœæ± ä¸­çš„è¿›ç¨‹æ•°å·²ç»è¾¾åˆ°æŒ‡å®šçš„æœ€å¤§å€¼ï¼Œé‚£ä¹ˆè¯¥è¯·æ±‚å°±ä¼šç­‰å¾…ï¼Œç›´åˆ°æ± ä¸­æœ‰è¿›ç¨‹ç»“æŸï¼Œæ‰ä¼šç”¨ä¹‹å‰çš„è¿›ç¨‹æ¥æ‰§è¡Œæ–°çš„ä»»åŠ¡ï¼Œè¯·çœ‹ä¸‹é¢çš„å®žä¾‹ï¼š12345678910111213141516171819202122from multiprocessing import Poolimport os, time, randomdef worker(msg): t_start = time.time() print("%så¼€å§‹æ‰§è¡Œ,è¿›ç¨‹å·ä¸º%d" % (msg,os.getpid())) # random.random()éšæœºç”Ÿæˆ0~1ä¹‹é—´çš„æµ®ç‚¹æ•° time.sleep(random.random()*2) t_stop = time.time() print(msg,"æ‰§è¡Œå®Œæ¯•ï¼Œè€—æ—¶%0.2f" % (t_stop-t_start))if __name__ == '__main__': po = Pool(3) # å®šä¹‰ä¸€ä¸ªè¿›ç¨‹æ± ï¼Œæœ€å¤§è¿›ç¨‹æ•°3 for i in range(0, 10): # Pool().apply_async(è¦è°ƒç”¨çš„ç›®æ ‡,(ä¼ é€’ç»™ç›®æ ‡çš„å‚æ•°å…ƒç¥–,)) # æ¯æ¬¡å¾ªçŽ¯å°†ä¼šç”¨ç©ºé—²å‡ºæ¥çš„å­è¿›ç¨‹åŽ»è°ƒç”¨ç›®æ ‡ po.apply_async(worker, (i,)) print("----start----") po.close() # å…³é—­è¿›ç¨‹æ± ï¼Œå…³é—­åŽpoä¸å†æŽ¥æ”¶æ–°çš„è¯·æ±‚ po.join() # ç­‰å¾…poä¸­æ‰€æœ‰å­è¿›ç¨‹æ‰§è¡Œå®Œæˆï¼Œå¿…é¡»æ”¾åœ¨closeè¯­å¥ä¹‹åŽ print("-----end-----")è¿è¡Œç»“æžœ:12345678910111213141516171819202122----start----0å¼€å§‹æ‰§è¡Œ,è¿›ç¨‹å·ä¸º214661å¼€å§‹æ‰§è¡Œ,è¿›ç¨‹å·ä¸º214682å¼€å§‹æ‰§è¡Œ,è¿›ç¨‹å·ä¸º214670 æ‰§è¡Œå®Œæ¯•ï¼Œè€—æ—¶1.013å¼€å§‹æ‰§è¡Œ,è¿›ç¨‹å·ä¸º214662 æ‰§è¡Œå®Œæ¯•ï¼Œè€—æ—¶1.244å¼€å§‹æ‰§è¡Œ,è¿›ç¨‹å·ä¸º214673 æ‰§è¡Œå®Œæ¯•ï¼Œè€—æ—¶0.565å¼€å§‹æ‰§è¡Œ,è¿›ç¨‹å·ä¸º214661 æ‰§è¡Œå®Œæ¯•ï¼Œè€—æ—¶1.686å¼€å§‹æ‰§è¡Œ,è¿›ç¨‹å·ä¸º214684 æ‰§è¡Œå®Œæ¯•ï¼Œè€—æ—¶0.677å¼€å§‹æ‰§è¡Œ,è¿›ç¨‹å·ä¸º214675 æ‰§è¡Œå®Œæ¯•ï¼Œè€—æ—¶0.838å¼€å§‹æ‰§è¡Œ,è¿›ç¨‹å·ä¸º214666 æ‰§è¡Œå®Œæ¯•ï¼Œè€—æ—¶0.759å¼€å§‹æ‰§è¡Œ,è¿›ç¨‹å·ä¸º214687 æ‰§è¡Œå®Œæ¯•ï¼Œè€—æ—¶1.038 æ‰§è¡Œå®Œæ¯•ï¼Œè€—æ—¶1.059 æ‰§è¡Œå®Œæ¯•ï¼Œè€—æ—¶1.69-----end-----multiprocessing.Poolå¸¸ç”¨å‡½æ•°è§£æžï¼šapply_async(func[, args[, kwds]]) ï¼šä½¿ç”¨éžé˜»å¡žæ–¹å¼è°ƒç”¨funcï¼ˆå¹¶è¡Œæ‰§è¡Œï¼Œå µå¡žæ–¹å¼å¿…é¡»ç­‰å¾…ä¸Šä¸€ä¸ªè¿›ç¨‹é€€å‡ºæ‰èƒ½æ‰§è¡Œä¸‹ä¸€ä¸ªè¿›ç¨‹ï¼‰ï¼Œargsä¸ºä¼ é€’ç»™funcçš„å‚æ•°åˆ—è¡¨ï¼Œkwdsä¸ºä¼ é€’ç»™funcçš„å…³é”®å­—å‚æ•°åˆ—è¡¨ï¼›close()ï¼šå…³é—­Poolï¼Œä½¿å…¶ä¸å†æŽ¥å—æ–°çš„ä»»åŠ¡ï¼›terminate()ï¼šä¸ç®¡ä»»åŠ¡æ˜¯å¦å®Œæˆï¼Œç«‹å³ç»ˆæ­¢ï¼›join()ï¼šä¸»è¿›ç¨‹é˜»å¡žï¼Œç­‰å¾…å­è¿›ç¨‹çš„é€€å‡ºï¼Œ å¿…é¡»åœ¨closeæˆ–terminateä¹‹åŽä½¿ç”¨ï¼›è¿›ç¨‹æ± ä¸­çš„Queueå¦‚æžœè¦ä½¿ç”¨Poolåˆ›å»ºè¿›ç¨‹ï¼Œå°±éœ€è¦ä½¿ç”¨multiprocessing.Manager()ä¸­çš„Queue()ï¼Œè€Œä¸æ˜¯multiprocessing.Queue()ï¼Œå¦åˆ™ä¼šå¾—åˆ°ä¸€æ¡å¦‚ä¸‹çš„é”™è¯¯ä¿¡æ¯ï¼šRuntimeError: Queue objects should only be shared between processes through inheritance.ä¸‹é¢çš„å®žä¾‹æ¼”ç¤ºäº†è¿›ç¨‹æ± ä¸­çš„è¿›ç¨‹å¦‚ä½•é€šä¿¡ï¼š1234567891011121314151617181920212223242526# ä¿®æ”¹importä¸­çš„Queueä¸ºManagerfrom multiprocessing import Manager,Poolimport os,time,randomdef reader(q): print("readerå¯åŠ¨(%s),çˆ¶è¿›ç¨‹ä¸º(%s)" % (os.getpid(), os.getppid())) for i in range(q.qsize()): print("readerä»ŽQueueèŽ·å–åˆ°æ¶ˆæ¯ï¼š%s" % q.get(True))def writer(q): print("writerå¯åŠ¨(%s),çˆ¶è¿›ç¨‹ä¸º(%s)" % (os.getpid(), os.getppid())) for i in "itcast": q.put(i)if __name__=="__main__": print("(%s) start" % os.getpid()) q = Manager().Queue() # ä½¿ç”¨Managerä¸­çš„Queue po = Pool() po.apply_async(writer, (q,)) time.sleep(1) # å…ˆè®©ä¸Šé¢çš„ä»»åŠ¡å‘Queueå­˜å…¥æ•°æ®ï¼Œç„¶åŽå†è®©ä¸‹é¢çš„ä»»åŠ¡å¼€å§‹ä»Žä¸­å–æ•°æ® po.apply_async(reader, (q,)) po.close() po.join() print("(%s) End" % os.getpid())è¿è¡Œç»“æžœ:12345678910(11095) startwriterå¯åŠ¨(11097),çˆ¶è¿›ç¨‹ä¸º(11095)readerå¯åŠ¨(11098),çˆ¶è¿›ç¨‹ä¸º(11095)readerä»ŽQueueèŽ·å–åˆ°æ¶ˆæ¯ï¼šireaderä»ŽQueueèŽ·å–åˆ°æ¶ˆæ¯ï¼štreaderä»ŽQueueèŽ·å–åˆ°æ¶ˆæ¯ï¼šcreaderä»ŽQueueèŽ·å–åˆ°æ¶ˆæ¯ï¼šareaderä»ŽQueueèŽ·å–åˆ°æ¶ˆæ¯ï¼šsreaderä»ŽQueueèŽ·å–åˆ°æ¶ˆæ¯ï¼št(11095) Endåº”ç”¨ï¼šæ–‡ä»¶å¤¹copyå™¨ï¼ˆå¤šè¿›ç¨‹ç‰ˆï¼‰1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768import multiprocessingimport osimport timeimport randomdef copy_file(queue, file_name,source_folder_name, dest_folder_name): """copyæ–‡ä»¶åˆ°æŒ‡å®šçš„è·¯å¾„""" f_read = open(source_folder_name + "/" + file_name, "rb") f_write = open(dest_folder_name + "/" + file_name, "wb") while True: time.sleep(random.random()) content = f_read.read(1024) if content: f_write.write(content) else: break f_read.close() f_write.close() # å‘é€å·²ç»æ‹·è´å®Œæ¯•çš„æ–‡ä»¶åå­— queue.put(file_name)def main(): # èŽ·å–è¦å¤åˆ¶çš„æ–‡ä»¶å¤¹ source_folder_name = input("è¯·è¾“å…¥è¦å¤åˆ¶æ–‡ä»¶å¤¹åå­—:") # æ•´ç†ç›®æ ‡æ–‡ä»¶å¤¹ dest_folder_name = source_folder_name + "[å‰¯æœ¬]" # åˆ›å»ºç›®æ ‡æ–‡ä»¶å¤¹ try: os.mkdir(dest_folder_name) except: pass # å¦‚æžœæ–‡ä»¶å¤¹å·²ç»å­˜åœ¨ï¼Œé‚£ä¹ˆåˆ›å»ºä¼šå¤±è´¥ # èŽ·å–è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­æ‰€æœ‰çš„æ™®é€šæ–‡ä»¶å file_names = os.listdir(source_folder_name) # åˆ›å»ºQueue queue = multiprocessing.Manager().Queue() # åˆ›å»ºè¿›ç¨‹æ±  pool = multiprocessing.Pool(3) for file_name in file_names: # å‘è¿›ç¨‹æ± ä¸­æ·»åŠ ä»»åŠ¡ pool.apply_async(copy_file, args=(queue, file_name, source_folder_name, dest_folder_name)) # ä¸»è¿›ç¨‹æ˜¾ç¤ºè¿›åº¦ pool.close() all_file_num = len(file_names) while True: file_name = queue.get() if file_name in file_names: file_names.remove(file_name) copy_rate = (all_file_num-len(file_names))*100/all_file_num print("\r%.2f...(%s)" % (copy_rate, file_name) + " "*50, end="") if copy_rate &gt;= 100: break print()if __name__ == "__main__": main()]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¤šä»»åŠ¡_çº¿ç¨‹]]></title>
    <url>%2F2019%2F12%2F31%2F%E5%A4%9A%E4%BB%BB%E5%8A%A1_%E7%BA%BF%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[å¤šä»»åŠ¡çš„æ¦‚å¿µç®€å•åœ°è¯´ï¼Œå°±æ˜¯æ“ä½œç³»ç»Ÿå¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªä»»åŠ¡ã€‚çŽ°åœ¨ï¼Œå¤šæ ¸CPUå·²ç»éžå¸¸æ™®åŠäº†ï¼Œä½†æ˜¯ï¼Œå³ä½¿è¿‡åŽ»çš„å•æ ¸CPUï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œå¤šä»»åŠ¡ã€‚ç”±äºŽCPUæ‰§è¡Œä»£ç éƒ½æ˜¯é¡ºåºæ‰§è¡Œçš„ï¼Œé‚£ä¹ˆï¼Œå•æ ¸CPUæ˜¯æ€Žä¹ˆæ‰§è¡Œå¤šä»»åŠ¡çš„å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯æ“ä½œç³»ç»Ÿè½®æµè®©å„ä¸ªä»»åŠ¡äº¤æ›¿æ‰§è¡Œï¼Œä»»åŠ¡1æ‰§è¡Œ0.01ç§’ï¼Œåˆ‡æ¢åˆ°ä»»åŠ¡2ï¼Œä»»åŠ¡2æ‰§è¡Œ0.01ç§’ï¼Œå†åˆ‡æ¢åˆ°ä»»åŠ¡3ï¼Œæ‰§è¡Œ0.01ç§’â€¦â€¦è¿™æ ·åå¤æ‰§è¡Œä¸‹åŽ»ã€‚è¡¨é¢ä¸Šçœ‹ï¼Œæ¯ä¸ªä»»åŠ¡éƒ½æ˜¯äº¤æ›¿æ‰§è¡Œçš„ï¼Œä½†æ˜¯ï¼Œç”±äºŽCPUçš„æ‰§è¡Œé€Ÿåº¦å®žåœ¨æ˜¯å¤ªå¿«äº†ï¼Œæˆ‘ä»¬æ„Ÿè§‰å°±åƒæ‰€æœ‰ä»»åŠ¡éƒ½åœ¨åŒæ—¶æ‰§è¡Œä¸€æ ·ã€‚çœŸæ­£çš„å¹¶è¡Œæ‰§è¡Œå¤šä»»åŠ¡åªèƒ½åœ¨å¤šæ ¸CPUä¸Šå®žçŽ°ï¼Œä½†æ˜¯ï¼Œç”±äºŽä»»åŠ¡æ•°é‡è¿œè¿œå¤šäºŽCPUçš„æ ¸å¿ƒæ•°é‡ï¼Œæ‰€ä»¥ï¼Œæ“ä½œç³»ç»Ÿä¹Ÿä¼šè‡ªåŠ¨æŠŠå¾ˆå¤šä»»åŠ¡è½®æµè°ƒåº¦åˆ°æ¯ä¸ªæ ¸å¿ƒä¸Šæ‰§è¡Œã€‚æ³¨æ„ï¼šå¹¶å‘ï¼šæŒ‡çš„æ˜¯ä»»åŠ¡æ•°å¤šäºŽcpuæ ¸æ•°ï¼Œé€šè¿‡æ“ä½œç³»ç»Ÿçš„å„ç§ä»»åŠ¡è°ƒåº¦ç®—æ³•ï¼Œå®žçŽ°ç”¨å¤šä¸ªä»»åŠ¡â€œä¸€èµ·â€æ‰§è¡Œï¼ˆå®žé™…ä¸Šæ€»æœ‰ä¸€äº›ä»»åŠ¡ä¸åœ¨æ‰§è¡Œï¼Œå› ä¸ºåˆ‡æ¢ä»»åŠ¡çš„é€Ÿåº¦ç›¸å½“å¿«ï¼Œçœ‹ä¸ŠåŽ»ä¸€èµ·æ‰§è¡Œè€Œå·²ï¼‰å¹¶è¡Œï¼šæŒ‡çš„æ˜¯ä»»åŠ¡æ•°å°äºŽç­‰äºŽcpuæ ¸æ•°ï¼Œå³ä»»åŠ¡çœŸçš„æ˜¯ä¸€èµ·æ‰§è¡Œçš„çº¿ç¨‹pythonçš„threadæ¨¡å—æ˜¯æ¯”è¾ƒåº•å±‚çš„æ¨¡å—ï¼Œpythonçš„threadingæ¨¡å—æ˜¯å¯¹threadåšäº†ä¸€äº›åŒ…è£…çš„ï¼Œå¯ä»¥æ›´åŠ æ–¹ä¾¿çš„è¢«ä½¿ç”¨ä½¿ç”¨threadingæ¨¡å—å•çº¿ç¨‹æ‰§è¡Œ12345678910#coding=utf-8import timedef saySorry(): print("äº²çˆ±çš„ï¼Œæˆ‘é”™äº†ï¼Œæˆ‘èƒ½åƒé¥­äº†å—ï¼Ÿ") time.sleep(1)if __name__ == "__main__": for i in range(5): saySorry()å¤šçº¿ç¨‹æ‰§è¡Œ123456789101112#coding=utf-8import threadingimport timedef saySorry(): print("äº²çˆ±çš„ï¼Œæˆ‘é”™äº†ï¼Œæˆ‘èƒ½åƒé¥­äº†å—ï¼Ÿ") time.sleep(1)if __name__ == "__main__": for i in range(5): t = threading.Thread(target=saySorry) t.start() #å¯åŠ¨çº¿ç¨‹ï¼Œå³è®©çº¿ç¨‹å¼€å§‹æ‰§è¡Œè¯´æ˜Žå¯ä»¥æ˜Žæ˜¾çœ‹å‡ºä½¿ç”¨äº†å¤šçº¿ç¨‹å¹¶å‘çš„æ“ä½œï¼ŒèŠ±è´¹æ—¶é—´è¦çŸ­å¾ˆå¤šå½“è°ƒç”¨start()æ—¶ï¼Œæ‰ä¼šçœŸæ­£çš„åˆ›å»ºçº¿ç¨‹ï¼Œå¹¶ä¸”å¼€å§‹æ‰§è¡Œä¸»çº¿ç¨‹ä¼šç­‰å¾…æ‰€æœ‰çš„å­çº¿ç¨‹ç»“æŸåŽæ‰ç»“æŸ12345678910111213141516171819202122232425#coding=utf-8import threadingfrom time import sleep,ctimedef sing(): for i in range(3): print("æ­£åœ¨å”±æ­Œ...%d"%i) sleep(1)def dance(): for i in range(3): print("æ­£åœ¨è·³èˆž...%d"%i) sleep(1)if __name__ == '__main__': print('---å¼€å§‹---:%s'%ctime()) t1 = threading.Thread(target=sing) t2 = threading.Thread(target=dance) t1.start() t2.start() #sleep(5) # å±è”½æ­¤è¡Œä»£ç ï¼Œè¯•è¯•çœ‹ï¼Œç¨‹åºæ˜¯å¦ä¼šç«‹é©¬ç»“æŸï¼Ÿ print('---ç»“æŸ---:%s'%ctime())æŸ¥çœ‹çº¿ç¨‹æ•°é‡123456789101112131415161718192021222324252627282930#coding=utf-8import threadingfrom time import sleep,ctimedef sing(): for i in range(3): print("æ­£åœ¨å”±æ­Œ...%d"%i) sleep(1)def dance(): for i in range(3): print("æ­£åœ¨è·³èˆž...%d"%i) sleep(1)if __name__ == '__main__': print('---å¼€å§‹---:%s'%ctime()) t1 = threading.Thread(target=sing) t2 = threading.Thread(target=dance) t1.start() t2.start() while True: length = len(threading.enumerate()) print('å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°ä¸ºï¼š%d'%length) if length&lt;=1: break sleep(0.5)çº¿ç¨‹-æ³¨æ„ç‚¹çº¿ç¨‹æ‰§è¡Œä»£ç çš„å°è£…é€šè¿‡ä½¿ç”¨threadingæ¨¡å—èƒ½å®Œæˆå¤šä»»åŠ¡çš„ç¨‹åºå¼€å‘ï¼Œä¸ºäº†è®©æ¯ä¸ªçº¿ç¨‹çš„å°è£…æ€§æ›´å®Œç¾Žï¼Œæ‰€ä»¥ä½¿ç”¨threadingæ¨¡å—æ—¶ï¼Œå¾€å¾€ä¼šå®šä¹‰ä¸€ä¸ªæ–°çš„å­ç±»classï¼Œåªè¦ç»§æ‰¿threading.Threadå°±å¯ä»¥äº†ï¼Œç„¶åŽé‡å†™runæ–¹æ³•ç¤ºä¾‹å¦‚ä¸‹ï¼š123456789101112131415#coding=utf-8import threadingimport timeclass MyThread(threading.Thread): def run(self): for i in range(3): time.sleep(1) msg = "I'm "+self.name+' @ '+str(i) #nameå±žæ€§ä¸­ä¿å­˜çš„æ˜¯å½“å‰çº¿ç¨‹çš„åå­— print(msg)if __name__ == '__main__': t = MyThread() t.start()è¯´æ˜Žpythonçš„threading.Threadç±»æœ‰ä¸€ä¸ªrunæ–¹æ³•ï¼Œç”¨äºŽå®šä¹‰çº¿ç¨‹çš„åŠŸèƒ½å‡½æ•°ï¼Œå¯ä»¥åœ¨è‡ªå·±çš„çº¿ç¨‹ç±»ä¸­è¦†ç›–è¯¥æ–¹æ³•ã€‚è€Œåˆ›å»ºè‡ªå·±çš„çº¿ç¨‹å®žä¾‹åŽï¼Œé€šè¿‡Threadç±»çš„startæ–¹æ³•ï¼Œå¯ä»¥å¯åŠ¨è¯¥çº¿ç¨‹ï¼Œäº¤ç»™pythonè™šæ‹Ÿæœºè¿›è¡Œè°ƒåº¦ï¼Œå½“è¯¥çº¿ç¨‹èŽ·å¾—æ‰§è¡Œçš„æœºä¼šæ—¶ï¼Œå°±ä¼šè°ƒç”¨runæ–¹æ³•æ‰§è¡Œçº¿ç¨‹ã€‚çº¿ç¨‹çš„æ‰§è¡Œé¡ºåº12345678910111213141516#coding=utf-8import threadingimport timeclass MyThread(threading.Thread): def run(self): for i in range(3): time.sleep(1) msg = "I'm "+self.name+' @ '+str(i) print(msg)def test(): for i in range(5): t = MyThread() t.start()if __name__ == '__main__': test()è¯´æ˜Žä»Žä»£ç å’Œæ‰§è¡Œç»“æžœæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå¤šçº¿ç¨‹ç¨‹åºçš„æ‰§è¡Œé¡ºåºæ˜¯ä¸ç¡®å®šçš„ã€‚å½“æ‰§è¡Œåˆ°sleepè¯­å¥æ—¶ï¼Œçº¿ç¨‹å°†è¢«é˜»å¡žï¼ˆBlockedï¼‰ï¼Œåˆ°sleepç»“æŸåŽï¼Œçº¿ç¨‹è¿›å…¥å°±ç»ªï¼ˆRunnableï¼‰çŠ¶æ€ï¼Œç­‰å¾…è°ƒåº¦ã€‚è€Œçº¿ç¨‹è°ƒåº¦å°†è‡ªè¡Œé€‰æ‹©ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œã€‚ä¸Šé¢çš„ä»£ç ä¸­åªèƒ½ä¿è¯æ¯ä¸ªçº¿ç¨‹éƒ½è¿è¡Œå®Œæ•´ä¸ªrunå‡½æ•°ï¼Œä½†æ˜¯çº¿ç¨‹çš„å¯åŠ¨é¡ºåºã€runå‡½æ•°ä¸­æ¯æ¬¡å¾ªçŽ¯çš„æ‰§è¡Œé¡ºåºéƒ½ä¸èƒ½ç¡®å®šã€‚ä¿®æ”¹ä¸Šè¿°ä»£ç ,ä½¿ä¹‹èƒ½æŒ‰é¡ºåºæ‰§è¡Œ12345678910111213141516171819202122#!/usr/bin/env python# -*- coding: utf-8 -*-import threadingimport timeclass MyThread(threading.Thread): def run(self): for i in range(3): # time.sleep(1) msg = "I'm " + self.name + ' @ ' + str(i) print(msg)def test(): for i in range(5): t = MyThread() t.start() time.sleep(1) # å»¶è¿Ÿæ—¶é—´å¯é€‚å½“å»¶é•¿if __name__ == '__main__': test()æ€»ç»“æ¯ä¸ªçº¿ç¨‹é»˜è®¤æœ‰ä¸€ä¸ªåå­—ï¼Œå°½ç®¡ä¸Šé¢çš„ä¾‹å­ä¸­æ²¡æœ‰æŒ‡å®šçº¿ç¨‹å¯¹è±¡çš„nameï¼Œä½†æ˜¯pythonä¼šè‡ªåŠ¨ä¸ºçº¿ç¨‹æŒ‡å®šä¸€ä¸ªåå­—ã€‚å½“çº¿ç¨‹çš„run()æ–¹æ³•ç»“æŸæ—¶è¯¥çº¿ç¨‹å®Œæˆã€‚æ— æ³•æŽ§åˆ¶çº¿ç¨‹è°ƒåº¦ç¨‹åºï¼Œä½†å¯ä»¥é€šè¿‡åˆ«çš„æ–¹å¼æ¥å½±å“çº¿ç¨‹è°ƒåº¦çš„æ–¹å¼ã€‚å¤šçº¿ç¨‹-å…±äº«å…¨å±€å˜é‡1234567891011121314151617181920212223242526272829303132#!/usr/bin/env python# -*- coding: utf-8 -*-from threading import Threadimport timeg_num = 100def work1(): global g_num for i in range(3): g_num += 1 print("----in work1, g_num is %d---" % g_num)def work2(): global g_num print("----in work2, g_num is %d---" % g_num)print("---çº¿ç¨‹åˆ›å»ºä¹‹å‰g_num is %d---" % g_num)t1 = Thread(target=work1)t1.start()# å»¶æ—¶ä¸€ä¼šï¼Œä¿è¯t1çº¿ç¨‹ä¸­çš„äº‹æƒ…åšå®Œtime.sleep(1)t2 = Thread(target=work2)t2.start()åˆ—è¡¨å½“åšå®žå‚ä¼ é€’åˆ°çº¿ç¨‹ä¸­12345678910111213141516171819202122#!/usr/bin/env python# -*- coding: utf-8 -*-from threading import Threadimport timedef work1(nums): nums.append(44) print("----in work1---", nums)def work2(nums): # å»¶æ—¶ä¸€ä¼šï¼Œä¿è¯t1çº¿ç¨‹ä¸­çš„äº‹æƒ…åšå®Œ time.sleep(1) print("----in work2---", nums)g_nums = [11, 22, 33]t1 = Thread(target=work1, args=(g_nums,))t1.start()t2 = Thread(target=work2, args=(g_nums,))t2.start()æ€»ç»“åœ¨ä¸€ä¸ªè¿›ç¨‹å†…çš„æ‰€æœ‰çº¿ç¨‹å…±äº«å…¨å±€å˜é‡ï¼Œå¾ˆæ–¹ä¾¿åœ¨å¤šä¸ªçº¿ç¨‹é—´å…±äº«æ•°æ®ç¼ºç‚¹å°±æ˜¯ï¼Œçº¿ç¨‹æ˜¯å¯¹å…¨å±€å˜é‡éšæ„é‚æ”¹å¯èƒ½é€ æˆå¤šçº¿ç¨‹ä¹‹é—´å¯¹å…¨å±€å˜é‡çš„æ··ä¹±ï¼ˆå³çº¿ç¨‹éžå®‰å…¨ï¼‰å¤šçº¿ç¨‹-å…±äº«å…¨å±€å˜é‡é—®é¢˜å¤šçº¿ç¨‹å¼€å‘å¯èƒ½é‡åˆ°çš„é—®é¢˜å‡è®¾ä¸¤ä¸ªçº¿ç¨‹t1å’Œt2éƒ½è¦å¯¹å…¨å±€å˜é‡g_num(é»˜è®¤æ˜¯0)è¿›è¡ŒåŠ 1è¿ç®—ï¼Œt1å’Œt2éƒ½å„å¯¹g_numåŠ 10æ¬¡ï¼Œg_numçš„æœ€ç»ˆçš„ç»“æžœåº”è¯¥ä¸º20ã€‚ä½†æ˜¯ç”±äºŽæ˜¯å¤šçº¿ç¨‹åŒæ—¶æ“ä½œï¼Œæœ‰å¯èƒ½å‡ºçŽ°ä¸‹é¢æƒ…å†µï¼šåœ¨g_num=0æ—¶ï¼Œt1å–å¾—g_num=0ã€‚æ­¤æ—¶ç³»ç»ŸæŠŠt1è°ƒåº¦ä¸ºâ€sleepingâ€çŠ¶æ€ï¼ŒæŠŠt2è½¬æ¢ä¸ºâ€runningâ€çŠ¶æ€ï¼Œt2ä¹ŸèŽ·å¾—g_num=0ç„¶åŽt2å¯¹å¾—åˆ°çš„å€¼è¿›è¡ŒåŠ 1å¹¶èµ‹ç»™g_numï¼Œä½¿å¾—g_num=1ç„¶åŽç³»ç»ŸåˆæŠŠt2è°ƒåº¦ä¸ºâ€sleepingâ€ï¼ŒæŠŠt1è½¬ä¸ºâ€runningâ€ã€‚çº¿ç¨‹t1åˆæŠŠå®ƒä¹‹å‰å¾—åˆ°çš„0åŠ 1åŽèµ‹å€¼ç»™g_numã€‚è¿™æ ·å¯¼è‡´è™½ç„¶t1å’Œt2éƒ½å¯¹g_numåŠ 1ï¼Œä½†ç»“æžœä»ç„¶æ˜¯g_num=1æµ‹è¯•11234567891011121314151617181920212223242526272829303132333435#!/usr/bin/env python# -*- coding: utf-8 -*-import threadingimport timeg_num = 0def work1(num): global g_num for i in range(num): g_num += 1 print("----in work1, g_num is %d---" % g_num)def work2(num): global g_num for i in range(num): g_num += 1 print("----in work2, g_num is %d---" % g_num)print("---çº¿ç¨‹åˆ›å»ºä¹‹å‰g_num is %d---" % g_num)t1 = threading.Thread(target=work1, args=(100,))t1.start()t2 = threading.Thread(target=work2, args=(100,))t2.start()while len(threading.enumerate()) != 1: time.sleep(1)print("2ä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªå…¨å±€å˜é‡æ“ä½œä¹‹åŽçš„æœ€ç»ˆç»“æžœæ˜¯:%s" % g_num)è¿è¡Œç»“æžœ:1234---çº¿ç¨‹åˆ›å»ºä¹‹å‰g_num is 0-------in work1, g_num is 100-------in work2, g_num is 200---2ä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªå…¨å±€å˜é‡æ“ä½œä¹‹åŽçš„æœ€ç»ˆç»“æžœæ˜¯:200æµ‹è¯•212345678910111213141516171819202122232425262728293031323334353637#!/usr/bin/env python# -*- coding: utf-8 -*-import threadingimport timeg_num = 0def work1(num): global g_num for i in range(num): g_num += 1 print("----in work1, g_num is %d---" % g_num)def work2(num): global g_num for i in range(num): g_num += 1 print("----in work2, g_num is %d---" % g_num)print("---çº¿ç¨‹åˆ›å»ºä¹‹å‰g_num is %d---" % g_num)t1 = threading.Thread(target=work1, args=(1000000,))t1.start()# time.sleep(5) # å¯åŠ å»¶æ—¶ç¡®ä¿t1å…ˆæ‰§è¡Œå®Œt2 = threading.Thread(target=work2, args=(1000000,))t2.start()while len(threading.enumerate()) != 1: time.sleep(1)print("2ä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªå…¨å±€å˜é‡æ“ä½œä¹‹åŽçš„æœ€ç»ˆç»“æžœæ˜¯:%s" % g_num)è¿è¡Œç»“æžœ:1234---çº¿ç¨‹åˆ›å»ºä¹‹å‰g_num is 0-------in work2, g_num is 1306621-------in work1, g_num is 1329573---2ä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªå…¨å±€å˜é‡æ“ä½œä¹‹åŽçš„æœ€ç»ˆç»“æžœæ˜¯:1329573ç»“è®ºå¦‚æžœå¤šä¸ªçº¿ç¨‹åŒæ—¶å¯¹åŒä¸€ä¸ªå…¨å±€å˜é‡æ“ä½œï¼Œä¼šå‡ºçŽ°èµ„æºç«žäº‰é—®é¢˜ï¼Œä»Žè€Œæ•°æ®ç»“æžœä¼šä¸æ­£ç¡®åŒæ­¥çš„æ¦‚å¿µåŒæ­¥å°±æ˜¯ååŒæ­¥è°ƒï¼ŒæŒ‰é¢„å®šçš„å…ˆåŽæ¬¡åºè¿›è¡Œè¿è¡Œã€‚å¦‚:ä½ è¯´å®Œï¼Œæˆ‘å†è¯´ã€‚â€œåŒâ€å­—ä»Žå­—é¢ä¸Šå®¹æ˜“ç†è§£ä¸ºä¸€èµ·åŠ¨ä½œ,å…¶å®žä¸æ˜¯ï¼Œâ€åŒâ€å­—åº”æ˜¯æŒ‡ååŒã€ååŠ©ã€äº’ç›¸é…åˆã€‚å¦‚è¿›ç¨‹ã€çº¿ç¨‹åŒæ­¥ï¼Œå¯ç†è§£ä¸ºè¿›ç¨‹æˆ–çº¿ç¨‹Aå’ŒBä¸€å—é…åˆï¼ŒAæ‰§è¡Œåˆ°ä¸€å®šç¨‹åº¦æ—¶è¦ä¾é Bçš„æŸä¸ªç»“æžœï¼ŒäºŽæ˜¯åœä¸‹æ¥ï¼Œç¤ºæ„Bè¿è¡Œ;Bæ‰§è¡Œï¼Œå†å°†ç»“æžœç»™A;Aå†ç»§ç»­æ“ä½œã€‚è§£å†³çº¿ç¨‹åŒæ—¶ä¿®æ”¹å…¨å±€å˜é‡çš„æ–¹å¼å¯ä»¥é€šè¿‡çº¿ç¨‹åŒæ­¥æ¥è¿›è¡Œè§£å†³,æ€è·¯å¦‚ä¸‹:ç³»ç»Ÿè°ƒç”¨t1ï¼Œç„¶åŽèŽ·å–åˆ°g_numçš„å€¼ä¸º0ï¼Œæ­¤æ—¶ä¸Šä¸€æŠŠé”ï¼Œå³ä¸å…è®¸å…¶ä»–çº¿ç¨‹æ“ä½œg_numt1å¯¹g_numçš„å€¼è¿›è¡Œ+1t1è§£é”ï¼Œæ­¤æ—¶g_numçš„å€¼ä¸º1ï¼Œå…¶ä»–çš„çº¿ç¨‹å°±å¯ä»¥ä½¿ç”¨g_numäº†ï¼Œè€Œä¸”æ˜¯g_numçš„å€¼ä¸æ˜¯0è€Œæ˜¯1åŒç†å…¶ä»–çº¿ç¨‹åœ¨å¯¹g_numè¿›è¡Œä¿®æ”¹æ—¶ï¼Œéƒ½è¦å…ˆä¸Šé”ï¼Œå¤„ç†å®ŒåŽå†è§£é”ï¼Œåœ¨ä¸Šé”çš„æ•´ä¸ªè¿‡ç¨‹ä¸­ä¸å…è®¸å…¶ä»–çº¿ç¨‹è®¿é—®ï¼Œå°±ä¿è¯äº†æ•°æ®çš„æ­£ç¡®æ€§äº’æ–¥é”å½“å¤šä¸ªçº¿ç¨‹å‡ ä¹ŽåŒæ—¶ä¿®æ”¹æŸä¸€ä¸ªå…±äº«æ•°æ®çš„æ—¶å€™ï¼Œéœ€è¦è¿›è¡ŒåŒæ­¥æŽ§åˆ¶çº¿ç¨‹åŒæ­¥èƒ½å¤Ÿä¿è¯å¤šä¸ªçº¿ç¨‹å®‰å…¨è®¿é—®ç«žäº‰èµ„æºï¼Œæœ€ç®€å•çš„åŒæ­¥æœºåˆ¶æ˜¯å¼•å…¥äº’æ–¥é”ã€‚äº’æ–¥é”ä¸ºèµ„æºå¼•å…¥ä¸€ä¸ªçŠ¶æ€ï¼šé”å®š/éžé”å®šæŸä¸ªçº¿ç¨‹è¦æ›´æ”¹å…±äº«æ•°æ®æ—¶ï¼Œå…ˆå°†å…¶é”å®šï¼Œæ­¤æ—¶èµ„æºçš„çŠ¶æ€ä¸ºâ€œé”å®šâ€ï¼Œå…¶ä»–çº¿ç¨‹ä¸èƒ½æ›´æ”¹ï¼›ç›´åˆ°è¯¥çº¿ç¨‹é‡Šæ”¾èµ„æºï¼Œå°†èµ„æºçš„çŠ¶æ€å˜æˆâ€œéžé”å®šâ€ï¼Œå…¶ä»–çš„çº¿ç¨‹æ‰èƒ½å†æ¬¡é”å®šè¯¥èµ„æºã€‚äº’æ–¥é”ä¿è¯äº†æ¯æ¬¡åªæœ‰ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œå†™å…¥æ“ä½œï¼Œä»Žè€Œä¿è¯äº†å¤šçº¿ç¨‹æƒ…å†µä¸‹æ•°æ®çš„æ­£ç¡®æ€§ã€‚threadingæ¨¡å—ä¸­å®šä¹‰äº†Lockç±»ï¼Œå¯ä»¥æ–¹ä¾¿çš„å¤„ç†é”å®šï¼š123456# åˆ›å»ºé”mutex = threading.Lock()# é”å®šmutex.acquire()# é‡Šæ”¾mutex.release()æ³¨æ„ï¼šå¦‚æžœè¿™ä¸ªé”ä¹‹å‰æ˜¯æ²¡æœ‰ä¸Šé”çš„ï¼Œé‚£ä¹ˆacquireä¸ä¼šå µå¡žå¦‚æžœåœ¨è°ƒç”¨acquireå¯¹è¿™ä¸ªé”ä¸Šé”ä¹‹å‰ å®ƒå·²ç»è¢« å…¶ä»–çº¿ç¨‹ä¸Šäº†é”ï¼Œé‚£ä¹ˆæ­¤æ—¶acquireä¼šå µå¡žï¼Œç›´åˆ°è¿™ä¸ªé”è¢«è§£é”ä¸ºæ­¢ä½¿ç”¨äº’æ–¥é”å®Œæˆ2ä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªå…¨å±€å˜é‡å„åŠ 100ä¸‡æ¬¡çš„æ“ä½œ12345678910111213141516171819202122232425262728293031323334353637383940414243444546#!/usr/bin/env python# -*- coding: utf-8 -*-import threadingimport timeg_num = 0def test1(num): global g_num for i in range(num): mutex.acquire() # ä¸Šé” g_num += 1 mutex.release() # è§£é” print("---test1---g_num=%d" % g_num)def test2(num): global g_num for i in range(num): mutex.acquire() # ä¸Šé” g_num += 1 mutex.release() # è§£é” print("---test2---g_num=%d" % g_num)# åˆ›å»ºä¸€ä¸ªäº’æ–¥é”# é»˜è®¤æ˜¯æœªä¸Šé”çš„çŠ¶æ€mutex = threading.Lock()# åˆ›å»º2ä¸ªçº¿ç¨‹ï¼Œè®©ä»–ä»¬å„è‡ªå¯¹g_numåŠ 1000000æ¬¡p1 = threading.Thread(target=test1, args=(1000000,))p1.start()p2 = threading.Thread(target=test2, args=(1000000,))p2.start()# ç­‰å¾…è®¡ç®—å®Œæˆwhile len(threading.enumerate()) != 1: time.sleep(1)print("2ä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªå…¨å±€å˜é‡æ“ä½œä¹‹åŽçš„æœ€ç»ˆç»“æžœæ˜¯:%s" % g_num)è¿è¡Œç»“æžœï¼š123---test1---g_num=1940444---test2---g_num=20000002ä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªå…¨å±€å˜é‡æ“ä½œä¹‹åŽçš„æœ€ç»ˆç»“æžœæ˜¯:2000000å¯ä»¥çœ‹åˆ°æœ€åŽçš„ç»“æžœï¼ŒåŠ å…¥äº’æ–¥é”åŽï¼Œå…¶ç»“æžœä¸Žé¢„æœŸç›¸ç¬¦ã€‚ä¸Šé”è§£é”è¿‡ç¨‹å½“ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨é”çš„acquire()æ–¹æ³•èŽ·å¾—é”æ—¶ï¼Œé”å°±è¿›å…¥â€œlockedâ€çŠ¶æ€ã€‚æ¯æ¬¡åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥èŽ·å¾—é”ã€‚å¦‚æžœæ­¤æ—¶å¦ä¸€ä¸ªçº¿ç¨‹è¯•å›¾èŽ·å¾—è¿™ä¸ªé”ï¼Œè¯¥çº¿ç¨‹å°±ä¼šå˜ä¸ºâ€œblockedâ€çŠ¶æ€ï¼Œç§°ä¸ºâ€œé˜»å¡žâ€ï¼Œç›´åˆ°æ‹¥æœ‰é”çš„çº¿ç¨‹è°ƒç”¨é”çš„release()æ–¹æ³•é‡Šæ”¾é”ä¹‹åŽï¼Œé”è¿›å…¥â€œunlockedâ€çŠ¶æ€ã€‚çº¿ç¨‹è°ƒåº¦ç¨‹åºä»Žå¤„äºŽåŒæ­¥é˜»å¡žçŠ¶æ€çš„çº¿ç¨‹ä¸­é€‰æ‹©ä¸€ä¸ªæ¥èŽ·å¾—é”ï¼Œå¹¶ä½¿å¾—è¯¥çº¿ç¨‹è¿›å…¥è¿è¡Œï¼ˆrunningï¼‰çŠ¶æ€ã€‚æ€»ç»“é”çš„å¥½å¤„ï¼šç¡®ä¿äº†æŸæ®µå…³é”®ä»£ç åªèƒ½ç”±ä¸€ä¸ªçº¿ç¨‹ä»Žå¤´åˆ°å°¾å®Œæ•´åœ°æ‰§è¡Œé”çš„åå¤„ï¼šé˜»æ­¢äº†å¤šçº¿ç¨‹å¹¶å‘æ‰§è¡Œï¼ŒåŒ…å«é”çš„æŸæ®µä»£ç å®žé™…ä¸Šåªèƒ½ä»¥å•çº¿ç¨‹æ¨¡å¼æ‰§è¡Œï¼Œæ•ˆçŽ‡å°±å¤§å¤§åœ°ä¸‹é™äº†ç”±äºŽå¯ä»¥å­˜åœ¨å¤šä¸ªé”ï¼Œä¸åŒçš„çº¿ç¨‹æŒæœ‰ä¸åŒçš„é”ï¼Œå¹¶è¯•å›¾èŽ·å–å¯¹æ–¹æŒæœ‰çš„é”æ—¶ï¼Œå¯èƒ½ä¼šé€ æˆæ­»é”æ­»é”åœ¨çº¿ç¨‹é—´å…±äº«å¤šä¸ªèµ„æºçš„æ—¶å€™ï¼Œå¦‚æžœä¸¤ä¸ªçº¿ç¨‹åˆ†åˆ«å æœ‰ä¸€éƒ¨åˆ†èµ„æºå¹¶ä¸”åŒæ—¶ç­‰å¾…å¯¹æ–¹çš„èµ„æºï¼Œå°±ä¼šé€ æˆæ­»é”ã€‚å°½ç®¡æ­»é”å¾ˆå°‘å‘ç”Ÿï¼Œä½†ä¸€æ—¦å‘ç”Ÿå°±ä¼šé€ æˆåº”ç”¨çš„åœæ­¢å“åº”ã€‚ä¸‹é¢çœ‹ä¸€ä¸ªæ­»é”çš„ä¾‹å­123456789101112131415161718192021222324252627282930313233343536373839404142434445import threadingimport timeclass MyThread1(threading.Thread): def run(self): # å¯¹mutexAä¸Šé” mutexA.acquire() # mutexAä¸Šé”åŽï¼Œå»¶æ—¶1ç§’ï¼Œç­‰å¾…å¦å¤–é‚£ä¸ªçº¿ç¨‹ æŠŠmutexBä¸Šé” print(self.name+'----do1---up----') time.sleep(1) # æ­¤æ—¶ä¼šå µå¡žï¼Œå› ä¸ºè¿™ä¸ªmutexBå·²ç»è¢«å¦å¤–çš„çº¿ç¨‹æŠ¢å…ˆä¸Šé”äº† mutexB.acquire() print(self.name+'----do1---down----') mutexB.release() # å¯¹mutexAè§£é” mutexA.release()class MyThread2(threading.Thread): def run(self): # å¯¹mutexBä¸Šé” mutexB.acquire() # mutexBä¸Šé”åŽï¼Œå»¶æ—¶1ç§’ï¼Œç­‰å¾…å¦å¤–é‚£ä¸ªçº¿ç¨‹ æŠŠmutexAä¸Šé” print(self.name+'----do2---up----') time.sleep(1) # æ­¤æ—¶ä¼šå µå¡žï¼Œå› ä¸ºè¿™ä¸ªmutexAå·²ç»è¢«å¦å¤–çš„çº¿ç¨‹æŠ¢å…ˆä¸Šé”äº† mutexA.acquire() print(self.name+'----do2---down----') mutexA.release() # å¯¹mutexBè§£é” mutexB.release()mutexA = threading.Lock()mutexB = threading.Lock()if __name__ == '__main__': t1 = MyThread1() t2 = MyThread2() t1.start() t2.start()è¿è¡Œæ­¤ä»£ç ä¼šå‘çŽ°æ­¤æ—¶å·²ç»è¿›å…¥åˆ°äº†æ­»é”çŠ¶æ€ï¼Œå¯ä»¥ä½¿ç”¨ctrl-cé€€å‡ºé¿å…æ­»é”ç¨‹åºè®¾è®¡æ—¶è¦å°½é‡é¿å…ï¼ˆé“¶è¡Œå®¶ç®—æ³•ï¼‰æ·»åŠ è¶…æ—¶æ—¶é—´ç­‰é™„å½•-é“¶è¡Œå®¶ç®—æ³•[èƒŒæ™¯çŸ¥è¯†]ä¸€ä¸ªé“¶è¡Œå®¶å¦‚ä½•å°†ä¸€å®šæ•°ç›®çš„èµ„é‡‘å®‰å…¨åœ°å€Ÿç»™è‹¥å¹²ä¸ªå®¢æˆ·ï¼Œä½¿è¿™äº›å®¢æˆ·æ—¢èƒ½å€Ÿåˆ°é’±å®Œæˆè¦å¹²çš„äº‹ï¼ŒåŒæ—¶é“¶è¡Œå®¶åˆèƒ½æ”¶å›žå…¨éƒ¨èµ„é‡‘è€Œä¸è‡³äºŽç ´äº§ï¼Œè¿™å°±æ˜¯é“¶è¡Œå®¶é—®é¢˜ã€‚è¿™ä¸ªé—®é¢˜åŒæ“ä½œç³»ç»Ÿä¸­èµ„æºåˆ†é…é—®é¢˜ååˆ†ç›¸ä¼¼ï¼šé“¶è¡Œå®¶å°±åƒä¸€ä¸ªæ“ä½œç³»ç»Ÿï¼Œå®¢æˆ·å°±åƒè¿è¡Œçš„è¿›ç¨‹ï¼Œé“¶è¡Œå®¶çš„èµ„é‡‘å°±æ˜¯ç³»ç»Ÿçš„èµ„æºã€‚[é—®é¢˜çš„æè¿°]ä¸€ä¸ªé“¶è¡Œå®¶æ‹¥æœ‰ä¸€å®šæ•°é‡çš„èµ„é‡‘ï¼Œæœ‰è‹¥å¹²ä¸ªå®¢æˆ·è¦è´·æ¬¾ã€‚æ¯ä¸ªå®¢æˆ·é¡»åœ¨ä¸€å¼€å§‹å°±å£°æ˜Žä»–æ‰€éœ€è´·æ¬¾çš„æ€»é¢ã€‚è‹¥è¯¥å®¢æˆ·è´·æ¬¾æ€»é¢ä¸è¶…è¿‡é“¶è¡Œå®¶çš„èµ„é‡‘æ€»æ•°ï¼Œé“¶è¡Œå®¶å¯ä»¥æŽ¥æ”¶å®¢æˆ·çš„è¦æ±‚ã€‚å®¢æˆ·è´·æ¬¾æ˜¯ä»¥æ¯æ¬¡ä¸€ä¸ªèµ„é‡‘å•ä½ï¼ˆå¦‚1ä¸‡RMBç­‰ï¼‰çš„æ–¹å¼è¿›è¡Œçš„ï¼Œå®¢æˆ·åœ¨å€Ÿæ»¡æ‰€éœ€çš„å…¨éƒ¨å•ä½æ¬¾é¢ä¹‹å‰å¯èƒ½ä¼šç­‰å¾…ï¼Œä½†é“¶è¡Œå®¶é¡»ä¿è¯è¿™ç§ç­‰å¾…æ˜¯æœ‰é™çš„ï¼Œå¯å®Œæˆçš„ã€‚ä¾‹å¦‚ï¼šæœ‰ä¸‰ä¸ªå®¢æˆ·C1ï¼ŒC2ï¼ŒC3ï¼Œå‘é“¶è¡Œå®¶å€Ÿæ¬¾ï¼Œè¯¥é“¶è¡Œå®¶çš„èµ„é‡‘æ€»é¢ä¸º10ä¸ªèµ„é‡‘å•ä½ï¼Œå…¶ä¸­C1å®¢æˆ·è¦å€Ÿ9å„èµ„é‡‘å•ä½ï¼ŒC2å®¢æˆ·è¦å€Ÿ3ä¸ªèµ„é‡‘å•ä½ï¼ŒC3å®¢æˆ·è¦å€Ÿ8ä¸ªèµ„é‡‘å•ä½ï¼Œæ€»è®¡20ä¸ªèµ„é‡‘å•ä½ã€‚æŸä¸€æ—¶åˆ»çš„çŠ¶æ€å¦‚å›¾æ‰€ç¤ºã€‚å¯¹äºŽaå›¾çš„çŠ¶æ€ï¼ŒæŒ‰ç…§å®‰å…¨åºåˆ—çš„è¦æ±‚ï¼Œæˆ‘ä»¬é€‰çš„ç¬¬ä¸€ä¸ªå®¢æˆ·åº”æ»¡è¶³è¯¥å®¢æˆ·æ‰€éœ€çš„è´·æ¬¾å°äºŽç­‰äºŽé“¶è¡Œå®¶å½“å‰æ‰€å‰©ä½™çš„é’±æ¬¾ï¼Œå¯ä»¥çœ‹å‡ºåªæœ‰C2å®¢æˆ·èƒ½è¢«æ»¡è¶³ï¼šC2å®¢æˆ·éœ€1ä¸ªèµ„é‡‘å•ä½ï¼Œå°é“¶è¡Œå®¶æ‰‹ä¸­çš„2ä¸ªèµ„é‡‘å•ä½ï¼ŒäºŽæ˜¯é“¶è¡Œå®¶æŠŠ1ä¸ªèµ„é‡‘å•ä½å€Ÿç»™C2å®¢æˆ·ï¼Œä½¿ä¹‹å®Œæˆå·¥ä½œå¹¶å½’è¿˜æ‰€å€Ÿçš„3ä¸ªèµ„é‡‘å•ä½çš„é’±ï¼Œè¿›å…¥bå›¾ã€‚åŒç†ï¼Œé“¶è¡Œå®¶æŠŠ4ä¸ªèµ„é‡‘å•ä½å€Ÿç»™C3å®¢æˆ·ï¼Œä½¿å…¶å®Œæˆå·¥ä½œï¼Œåœ¨cå›¾ä¸­ï¼Œåªå‰©ä¸€ä¸ªå®¢æˆ·C1ï¼Œå®ƒéœ€7ä¸ªèµ„é‡‘å•ä½ï¼Œè¿™æ—¶é“¶è¡Œå®¶æœ‰8ä¸ªèµ„é‡‘å•ä½ï¼Œæ‰€ä»¥C1ä¹Ÿèƒ½é¡ºåˆ©å€Ÿåˆ°é’±å¹¶å®Œæˆå·¥ä½œã€‚æœ€åŽï¼ˆè§å›¾dï¼‰é“¶è¡Œå®¶æ”¶å›žå…¨éƒ¨10ä¸ªèµ„é‡‘å•ä½ï¼Œä¿è¯ä¸èµ”æœ¬ã€‚é‚£éº½å®¢æˆ·åºåˆ—{C1ï¼ŒC2ï¼ŒC3}å°±æ˜¯ä¸ªå®‰å…¨åºåˆ—ï¼ŒæŒ‰ç…§è¿™ä¸ªåºåˆ—è´·æ¬¾ï¼Œé“¶è¡Œå®¶æ‰æ˜¯å®‰å…¨çš„ã€‚å¦åˆ™çš„è¯ï¼Œè‹¥åœ¨å›¾bçŠ¶æ€æ—¶ï¼Œé“¶è¡Œå®¶æŠŠæ‰‹ä¸­çš„4ä¸ªèµ„é‡‘å•ä½å€Ÿç»™äº†C1ï¼Œåˆ™å‡ºçŽ°ä¸å®‰å…¨çŠ¶æ€ï¼šè¿™æ—¶C1ï¼ŒC3å‡ä¸èƒ½å®Œæˆå·¥ä½œï¼Œè€Œé“¶è¡Œå®¶æ‰‹ä¸­åˆæ²¡æœ‰é’±äº†ï¼Œç³»ç»Ÿé™·å…¥åƒµæŒå±€é¢ï¼Œé“¶è¡Œå®¶ä¹Ÿä¸èƒ½æ”¶å›žæŠ•èµ„ã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œé“¶è¡Œå®¶ç®—æ³•æ˜¯ä»Žå½“å‰çŠ¶æ€å‡ºå‘ï¼Œé€ä¸ªæŒ‰å®‰å…¨åºåˆ—æ£€æŸ¥å„å®¢æˆ·è°èƒ½å®Œæˆå…¶å·¥ä½œï¼Œç„¶åŽå‡å®šå…¶å®Œæˆå·¥ä½œä¸”å½’è¿˜å…¨éƒ¨è´·æ¬¾ï¼Œå†è¿›è€Œæ£€æŸ¥ä¸‹ä¸€ä¸ªèƒ½å®Œæˆå·¥ä½œçš„å®¢æˆ·ï¼Œâ€¦â€¦ã€‚å¦‚æžœæ‰€æœ‰å®¢æˆ·éƒ½èƒ½å®Œæˆå·¥ä½œï¼Œåˆ™æ‰¾åˆ°ä¸€ä¸ªå®‰å…¨åºåˆ—ï¼Œé“¶è¡Œå®¶æ‰æ˜¯å®‰å…¨çš„ã€‚æ¡ˆä¾‹ï¼šå¤šä»»åŠ¡ç‰ˆudpèŠå¤©å™¨è¯´æ˜Žç¼–å†™ä¸€ä¸ªæœ‰2ä¸ªçº¿ç¨‹çš„ç¨‹åºçº¿ç¨‹1ç”¨æ¥æŽ¥æ”¶æ•°æ®ç„¶åŽæ˜¾ç¤ºçº¿ç¨‹2ç”¨æ¥æ£€æµ‹é”®ç›˜æ•°æ®ç„¶åŽé€šè¿‡udpå‘é€æ•°æ®å‚è€ƒä»£ç :123456789101112131415161718192021222324252627282930313233343536373839404142import socketimport threadingdef send_msg(udp_socket): """èŽ·å–é”®ç›˜æ•°æ®ï¼Œå¹¶å°†å…¶å‘é€ç»™å¯¹æ–¹""" while True: # 1. ä»Žé”®ç›˜è¾“å…¥æ•°æ® msg = input("\nè¯·è¾“å…¥è¦å‘é€çš„æ•°æ®:") # 2. è¾“å…¥å¯¹æ–¹çš„ipåœ°å€ dest_ip = input("\nè¯·è¾“å…¥å¯¹æ–¹çš„ipåœ°å€:") # 3. è¾“å…¥å¯¹æ–¹çš„port dest_port = int(input("\nè¯·è¾“å…¥å¯¹æ–¹çš„port:")) # 4. å‘é€æ•°æ® udp_socket.sendto(msg.encode("utf-8"), (dest_ip, dest_port))def recv_msg(udp_socket): """æŽ¥æ”¶æ•°æ®å¹¶æ˜¾ç¤º""" while True: # 1. æŽ¥æ”¶æ•°æ® recv_msg = udp_socket.recvfrom(1024) # 2. è§£ç  recv_ip = recv_msg[1] recv_msg = recv_msg[0].decode("utf-8") # 3. æ˜¾ç¤ºæŽ¥æ”¶åˆ°çš„æ•°æ® print("&gt;&gt;&gt;%s:%s" % (str(recv_ip), recv_msg))def main(): # 1. åˆ›å»ºå¥—æŽ¥å­— udp_socket = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) # 2. ç»‘å®šæœ¬åœ°ä¿¡æ¯ udp_socket.bind(("", 7890)) # 3. åˆ›å»ºä¸€ä¸ªå­çº¿ç¨‹ç”¨æ¥æŽ¥æ”¶æ•°æ® t = threading.Thread(target=recv_msg, args=(udp_socket,)) t.start() # 4. è®©ä¸»çº¿ç¨‹ç”¨æ¥æ£€æµ‹é”®ç›˜æ•°æ®å¹¶ä¸”å‘é€ send_msg(udp_socket)if __name__ == "__main__": main()]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¤šä»»åŠ¡_åç¨‹]]></title>
    <url>%2F2019%2F12%2F31%2F%E5%A4%9A%E4%BB%BB%E5%8A%A1_%E5%8D%8F%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[è¿­ä»£å™¨è¿­ä»£æ˜¯è®¿é—®é›†åˆå…ƒç´ çš„ä¸€ç§æ–¹å¼ã€‚è¿­ä»£å™¨æ˜¯ä¸€ä¸ªå¯ä»¥è®°ä½éåŽ†çš„ä½ç½®çš„å¯¹è±¡ã€‚è¿­ä»£å™¨å¯¹è±¡ä»Žé›†åˆçš„ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹è®¿é—®ï¼Œç›´åˆ°æ‰€æœ‰çš„å…ƒç´ è¢«è®¿é—®å®Œç»“æŸã€‚è¿­ä»£å™¨åªèƒ½å¾€å‰ä¸ä¼šåŽé€€ã€‚1. å¯è¿­ä»£å¯¹è±¡æˆ‘ä»¬å·²ç»çŸ¥é“å¯ä»¥å¯¹listã€tupleã€strç­‰ç±»åž‹çš„æ•°æ®ä½¿ç”¨forâ€¦inâ€¦çš„å¾ªçŽ¯è¯­æ³•ä»Žå…¶ä¸­ä¾æ¬¡æ‹¿åˆ°æ•°æ®è¿›è¡Œä½¿ç”¨ï¼Œæˆ‘ä»¬æŠŠè¿™æ ·çš„è¿‡ç¨‹ç§°ä¸ºéåŽ†ï¼Œä¹Ÿå«è¿­ä»£ã€‚ä½†æ˜¯ï¼Œæ˜¯å¦æ‰€æœ‰çš„æ•°æ®ç±»åž‹éƒ½å¯ä»¥æ”¾åˆ°forâ€¦inâ€¦çš„è¯­å¥ä¸­ï¼Œç„¶åŽè®©forâ€¦inâ€¦æ¯æ¬¡ä»Žä¸­å–å‡ºä¸€æ¡æ•°æ®ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼Œå³ä¾›æˆ‘ä»¬è¿­ä»£å—ï¼Ÿ12345678910111213141516171819202122232425262728&gt;&gt;&gt; for i in 100:... print(i)...Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt;TypeError: 'int' object is not iterable&gt;&gt;&gt;# intæ•´åž‹ä¸æ˜¯iterableï¼Œå³intæ•´åž‹ä¸æ˜¯å¯ä»¥è¿­ä»£çš„# æˆ‘ä»¬è‡ªå®šä¹‰ä¸€ä¸ªå®¹å™¨MyListç”¨æ¥å­˜æ”¾æ•°æ®ï¼Œå¯ä»¥é€šè¿‡addæ–¹æ³•å‘å…¶ä¸­æ·»åŠ æ•°æ®&gt;&gt;&gt; class MyList(object):... def __init__(self):... self.container = []... def add(self, item):... self.container.append(item)...&gt;&gt;&gt; mylist = MyList()&gt;&gt;&gt; mylist.add(1)&gt;&gt;&gt; mylist.add(2)&gt;&gt;&gt; mylist.add(3)&gt;&gt;&gt; for num in mylist:... print(num)...Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt;TypeError: 'MyList' object is not iterable&gt;&gt;&gt;# MyListå®¹å™¨çš„å¯¹è±¡ä¹Ÿæ˜¯ä¸èƒ½è¿­ä»£çš„æˆ‘ä»¬è‡ªå®šä¹‰äº†ä¸€ä¸ªå®¹å™¨ç±»åž‹MyListï¼Œåœ¨å°†ä¸€ä¸ªå­˜æ”¾äº†å¤šä¸ªæ•°æ®çš„MyListå¯¹è±¡æ”¾åˆ°forâ€¦inâ€¦çš„è¯­å¥ä¸­ï¼Œå‘çŽ°forâ€¦inâ€¦å¹¶ä¸èƒ½ä»Žä¸­ä¾æ¬¡å–å‡ºä¸€æ¡æ•°æ®è¿”å›žç»™æˆ‘ä»¬ï¼Œä¹Ÿå°±è¯´æˆ‘ä»¬éšä¾¿å°è£…äº†ä¸€ä¸ªå¯ä»¥å­˜æ”¾å¤šæ¡æ•°æ®çš„ç±»åž‹å´å¹¶ä¸èƒ½è¢«è¿­ä»£ä½¿ç”¨ã€‚æˆ‘ä»¬æŠŠå¯ä»¥é€šè¿‡forâ€¦inâ€¦è¿™ç±»è¯­å¥è¿­ä»£è¯»å–ä¸€æ¡æ•°æ®ä¾›æˆ‘ä»¬ä½¿ç”¨çš„å¯¹è±¡ç§°ä¹‹ä¸ºå¯è¿­ä»£å¯¹è±¡ï¼ˆIterableï¼‰**ã€‚2. å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å¯ä»¥è¿­ä»£å¯ä»¥ä½¿ç”¨ isinstance() åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯ Iterable å¯¹è±¡ï¼š12345678910111213141516In [50]: from collections import IterableIn [51]: isinstance([], Iterable)Out[51]: TrueIn [52]: isinstance(&#123;&#125;, Iterable)Out[52]: TrueIn [53]: isinstance('abc', Iterable)Out[53]: TrueIn [54]: isinstance(mylist, Iterable)Out[54]: FalseIn [55]: isinstance(100, Iterable)Out[55]: False3. å¯è¿­ä»£å¯¹è±¡çš„æœ¬è´¨æˆ‘ä»¬åˆ†æžå¯¹å¯è¿­ä»£å¯¹è±¡è¿›è¡Œè¿­ä»£ä½¿ç”¨çš„è¿‡ç¨‹ï¼Œå‘çŽ°æ¯è¿­ä»£ä¸€æ¬¡ï¼ˆå³åœ¨forâ€¦inâ€¦ä¸­æ¯å¾ªçŽ¯ä¸€æ¬¡ï¼‰éƒ½ä¼šè¿”å›žå¯¹è±¡ä¸­çš„ä¸‹ä¸€æ¡æ•°æ®ï¼Œä¸€ç›´å‘åŽè¯»å–æ•°æ®ç›´åˆ°è¿­ä»£äº†æ‰€æœ‰æ•°æ®åŽç»“æŸã€‚é‚£ä¹ˆï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å°±åº”è¯¥æœ‰ä¸€ä¸ªâ€œäººâ€åŽ»è®°å½•æ¯æ¬¡è®¿é—®åˆ°äº†ç¬¬å‡ æ¡æ•°æ®ï¼Œä»¥ä¾¿æ¯æ¬¡è¿­ä»£éƒ½å¯ä»¥è¿”å›žä¸‹ä¸€æ¡æ•°æ®ã€‚æˆ‘ä»¬æŠŠè¿™ä¸ªèƒ½å¸®åŠ©æˆ‘ä»¬è¿›è¡Œæ•°æ®è¿­ä»£çš„â€œäººâ€ç§°ä¸ºè¿­ä»£å™¨(Iterator)ã€‚å¯è¿­ä»£å¯¹è±¡çš„æœ¬è´¨å°±æ˜¯å¯ä»¥å‘æˆ‘ä»¬æä¾›ä¸€ä¸ªè¿™æ ·çš„ä¸­é—´â€œäººâ€å³è¿­ä»£å™¨å¸®åŠ©æˆ‘ä»¬å¯¹å…¶è¿›è¡Œè¿­ä»£éåŽ†ä½¿ç”¨ã€‚å¯è¿­ä»£å¯¹è±¡é€šè¿‡__iter__æ–¹æ³•å‘æˆ‘ä»¬æä¾›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œæˆ‘ä»¬åœ¨è¿­ä»£ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡çš„æ—¶å€™ï¼Œå®žé™…ä¸Šå°±æ˜¯å…ˆèŽ·å–è¯¥å¯¹è±¡æä¾›çš„ä¸€ä¸ªè¿­ä»£å™¨ï¼Œç„¶åŽé€šè¿‡è¿™ä¸ªè¿­ä»£å™¨æ¥ä¾æ¬¡èŽ·å–å¯¹è±¡ä¸­çš„æ¯ä¸€ä¸ªæ•°æ®.é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªå…·å¤‡äº†__iter__æ–¹æ³•çš„å¯¹è±¡ï¼Œå°±æ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ã€‚12345678910111213141516&gt;&gt;&gt; class MyList(object):... def __init__(self):... self.container = []... def add(self, item):... self.container.append(item)... def __iter__(self):... """è¿”å›žä¸€ä¸ªè¿­ä»£å™¨"""... # æˆ‘ä»¬æš‚æ—¶å¿½ç•¥å¦‚ä½•æž„é€ ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡... pass...&gt;&gt;&gt; mylist = MyList()&gt;&gt;&gt; from collections import Iterable&gt;&gt;&gt; isinstance(mylist, Iterable)True&gt;&gt;&gt;# è¿™å›žæµ‹è¯•å‘çŽ°æ·»åŠ äº†__iter__æ–¹æ³•çš„mylistå¯¹è±¡å·²ç»æ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡äº†4. iter()å‡½æ•°ä¸Žnext()å‡½æ•°listã€tupleç­‰éƒ½æ˜¯å¯è¿­ä»£å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡iter()å‡½æ•°èŽ·å–è¿™äº›å¯è¿­ä»£å¯¹è±¡çš„è¿­ä»£å™¨ã€‚ç„¶åŽæˆ‘ä»¬å¯ä»¥å¯¹èŽ·å–åˆ°çš„è¿­ä»£å™¨ä¸æ–­ä½¿ç”¨next()å‡½æ•°æ¥èŽ·å–ä¸‹ä¸€æ¡æ•°æ®ã€‚iter()å‡½æ•°å®žé™…ä¸Šå°±æ˜¯è°ƒç”¨äº†å¯è¿­ä»£å¯¹è±¡çš„__iter__æ–¹æ³•ã€‚1234567891011121314151617&gt;&gt;&gt; li = [11, 22, 33, 44, 55]&gt;&gt;&gt; li_iter = iter(li)&gt;&gt;&gt; next(li_iter)11&gt;&gt;&gt; next(li_iter)22&gt;&gt;&gt; next(li_iter)33&gt;&gt;&gt; next(li_iter)44&gt;&gt;&gt; next(li_iter)55&gt;&gt;&gt; next(li_iter)Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt;StopIteration&gt;&gt;&gt;æ³¨æ„ï¼Œå½“æˆ‘ä»¬å·²ç»è¿­ä»£å®Œæœ€åŽä¸€ä¸ªæ•°æ®ä¹‹åŽï¼Œå†æ¬¡è°ƒç”¨next()å‡½æ•°ä¼šæŠ›å‡ºStopIterationçš„å¼‚å¸¸ï¼Œæ¥å‘Šè¯‰æˆ‘ä»¬æ‰€æœ‰æ•°æ®éƒ½å·²è¿­ä»£å®Œæˆï¼Œä¸ç”¨å†æ‰§è¡Œnext()å‡½æ•°äº†ã€‚5. å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯è¿­ä»£å™¨å¯ä»¥ä½¿ç”¨ isinstance() åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯ Iterator å¯¹è±¡ï¼š12345678910In [56]: from collections import IteratorIn [57]: isinstance([], Iterator)Out[57]: FalseIn [58]: isinstance(iter([]), Iterator)Out[58]: TrueIn [59]: isinstance(iter("abc"), Iterator)Out[59]: True6. è¿­ä»£å™¨Iteratoré€šè¿‡ä¸Šé¢çš„åˆ†æžï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œè¿­ä»£å™¨æ˜¯ç”¨æ¥å¸®åŠ©æˆ‘ä»¬è®°å½•æ¯æ¬¡è¿­ä»£è®¿é—®åˆ°çš„ä½ç½®ï¼Œå½“æˆ‘ä»¬å¯¹è¿­ä»£å™¨ä½¿ç”¨next()å‡½æ•°çš„æ—¶å€™ï¼Œè¿­ä»£å™¨ä¼šå‘æˆ‘ä»¬è¿”å›žå®ƒæ‰€è®°å½•ä½ç½®çš„ä¸‹ä¸€ä¸ªä½ç½®çš„æ•°æ®ã€‚å®žé™…ä¸Šï¼Œåœ¨ä½¿ç”¨next()å‡½æ•°çš„æ—¶å€™ï¼Œè°ƒç”¨çš„å°±æ˜¯è¿­ä»£å™¨å¯¹è±¡çš„__next__æ–¹æ³•ï¼ˆPython3ä¸­æ˜¯å¯¹è±¡çš„__next__æ–¹æ³•ï¼ŒPython2ä¸­æ˜¯å¯¹è±¡çš„next()æ–¹æ³•ï¼‰ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦æƒ³æž„é€ ä¸€ä¸ªè¿­ä»£å™¨ï¼Œå°±è¦å®žçŽ°å®ƒçš„nextæ–¹æ³•ã€‚ä½†è¿™è¿˜ä¸å¤Ÿï¼Œpythonè¦æ±‚è¿­ä»£å™¨æœ¬èº«ä¹Ÿæ˜¯å¯è¿­ä»£çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜è¦ä¸ºè¿­ä»£å™¨å®žçŽ°__iter__æ–¹æ³•ï¼Œè€Œ__iter__æ–¹æ³•è¦è¿”å›žä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¿­ä»£å™¨è‡ªèº«æ­£æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼Œæ‰€ä»¥è¿­ä»£å™¨çš„__iter__æ–¹æ³•è¿”å›žè‡ªèº«å³å¯ã€‚ä¸€ä¸ªå®žçŽ°äº†iteræ–¹æ³•å’Œnextæ–¹æ³•çš„å¯¹è±¡ï¼Œå°±æ˜¯è¿­ä»£å™¨ã€‚1234567891011121314151617181920212223242526272829303132333435363738394041class MyList(object): """è‡ªå®šä¹‰çš„ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡""" def __init__(self): self.items = [] def add(self, val): self.items.append(val) def __iter__(self): myiterator = MyIterator(self) return myiteratorclass MyIterator(object): """è‡ªå®šä¹‰çš„ä¾›ä¸Šé¢å¯è¿­ä»£å¯¹è±¡ä½¿ç”¨çš„ä¸€ä¸ªè¿­ä»£å™¨""" def __init__(self, mylist): self.mylist = mylist # currentç”¨æ¥è®°å½•å½“å‰è®¿é—®åˆ°çš„ä½ç½® self.current = 0 def __next__(self): if self.current &lt; len(self.mylist.items): item = self.mylist.items[self.current] self.current += 1 return item else: raise StopIteration def __iter__(self): return selfif __name__ == '__main__': mylist = MyList() mylist.add(1) mylist.add(2) mylist.add(3) mylist.add(4) mylist.add(5) for num in mylist: print(num)7. forâ€¦inâ€¦å¾ªçŽ¯çš„æœ¬è´¨for item in Iterable å¾ªçŽ¯çš„æœ¬è´¨å°±æ˜¯å…ˆé€šè¿‡iter()å‡½æ•°èŽ·å–å¯è¿­ä»£å¯¹è±¡Iterableçš„è¿­ä»£å™¨ï¼Œç„¶åŽå¯¹èŽ·å–åˆ°çš„è¿­ä»£å™¨ä¸æ–­è°ƒç”¨next()æ–¹æ³•æ¥èŽ·å–ä¸‹ä¸€ä¸ªå€¼å¹¶å°†å…¶èµ‹å€¼ç»™itemï¼Œå½“é‡åˆ°StopIterationçš„å¼‚å¸¸åŽå¾ªçŽ¯ç»“æŸã€‚8. è¿­ä»£å™¨çš„åº”ç”¨åœºæ™¯æˆ‘ä»¬å‘çŽ°è¿­ä»£å™¨æœ€æ ¸å¿ƒçš„åŠŸèƒ½å°±æ˜¯å¯ä»¥é€šè¿‡next()å‡½æ•°çš„è°ƒç”¨æ¥è¿”å›žä¸‹ä¸€ä¸ªæ•°æ®å€¼ã€‚å¦‚æžœæ¯æ¬¡è¿”å›žçš„æ•°æ®å€¼ä¸æ˜¯åœ¨ä¸€ä¸ªå·²æœ‰çš„æ•°æ®é›†åˆä¸­è¯»å–çš„ï¼Œè€Œæ˜¯é€šè¿‡ç¨‹åºæŒ‰ç…§ä¸€å®šçš„è§„å¾‹è®¡ç®—ç”Ÿæˆçš„ï¼Œé‚£ä¹ˆä¹Ÿå°±æ„å‘³ç€å¯ä»¥ä¸ç”¨å†ä¾èµ–ä¸€ä¸ªå·²æœ‰çš„æ•°æ®é›†åˆï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ç”¨å†å°†æ‰€æœ‰è¦è¿­ä»£çš„æ•°æ®éƒ½ä¸€æ¬¡æ€§ç¼“å­˜ä¸‹æ¥ä¾›åŽç»­ä¾æ¬¡è¯»å–ï¼Œè¿™æ ·å¯ä»¥èŠ‚çœå¤§é‡çš„å­˜å‚¨ï¼ˆå†…å­˜ï¼‰ç©ºé—´ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ï¼Œæ•°å­¦ä¸­æœ‰ä¸ªè‘—åçš„æ–æ³¢æ‹‰å¥‘æ•°åˆ—ï¼ˆFibonacciï¼‰ï¼Œæ•°åˆ—ä¸­ç¬¬ä¸€ä¸ªæ•°ä¸º0ï¼Œç¬¬äºŒä¸ªæ•°ä¸º1ï¼Œå…¶åŽçš„æ¯ä¸€ä¸ªæ•°éƒ½å¯ç”±å‰ä¸¤ä¸ªæ•°ç›¸åŠ å¾—åˆ°ï¼š0, 1, 1, 2, 3, 5, 8, 13, 21, 34, â€¦çŽ°åœ¨æˆ‘ä»¬æƒ³è¦é€šè¿‡forâ€¦inâ€¦å¾ªçŽ¯æ¥éåŽ†è¿­ä»£æ–æ³¢é‚£å¥‘æ•°åˆ—ä¸­çš„å‰nä¸ªæ•°ã€‚é‚£ä¹ˆè¿™ä¸ªæ–æ³¢é‚£å¥‘æ•°åˆ—æˆ‘ä»¬å°±å¯ä»¥ç”¨è¿­ä»£å™¨æ¥å®žçŽ°ï¼Œæ¯æ¬¡è¿­ä»£éƒ½é€šè¿‡æ•°å­¦è®¡ç®—æ¥ç”Ÿæˆä¸‹ä¸€ä¸ªæ•°ã€‚123456789101112131415161718192021222324252627282930313233class FibIterator(object): """æ–æ³¢é‚£å¥‘æ•°åˆ—è¿­ä»£å™¨""" def __init__(self, n): """ :param n: int, æŒ‡æ˜Žç”Ÿæˆæ•°åˆ—çš„å‰nä¸ªæ•° """ self.n = n # currentç”¨æ¥ä¿å­˜å½“å‰ç”Ÿæˆåˆ°æ•°åˆ—ä¸­çš„ç¬¬å‡ ä¸ªæ•°äº† self.current = 0 # num1ç”¨æ¥ä¿å­˜å‰å‰ä¸€ä¸ªæ•°ï¼Œåˆå§‹å€¼ä¸ºæ•°åˆ—ä¸­çš„ç¬¬ä¸€ä¸ªæ•°0 self.num1 = 0 # num2ç”¨æ¥ä¿å­˜å‰ä¸€ä¸ªæ•°ï¼Œåˆå§‹å€¼ä¸ºæ•°åˆ—ä¸­çš„ç¬¬äºŒä¸ªæ•°1 self.num2 = 1 def __next__(self): """è¢«next()å‡½æ•°è°ƒç”¨æ¥èŽ·å–ä¸‹ä¸€ä¸ªæ•°""" if self.current &lt; self.n: num = self.num1 self.num1, self.num2 = self.num2, self.num1+self.num2 self.current += 1 return num else: raise StopIteration def __iter__(self): """è¿­ä»£å™¨çš„__iter__è¿”å›žè‡ªèº«å³å¯""" return selfif __name__ == '__main__': fib = FibIterator(10) for num in fib: print(num, end=" ")9. å¹¶ä¸æ˜¯åªæœ‰forå¾ªçŽ¯èƒ½æŽ¥æ”¶å¯è¿­ä»£å¯¹è±¡é™¤äº†forå¾ªçŽ¯èƒ½æŽ¥æ”¶å¯è¿­ä»£å¯¹è±¡ï¼Œlistã€tupleç­‰ä¹Ÿèƒ½æŽ¥æ”¶ã€‚1234li = list(FibIterator(15))print(li)tp = tuple(FibIterator(6))print(tp)ç”Ÿæˆå™¨1. ç”Ÿæˆå™¨åˆ©ç”¨è¿­ä»£å™¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¯æ¬¡è¿­ä»£èŽ·å–æ•°æ®ï¼ˆé€šè¿‡next()æ–¹æ³•ï¼‰æ—¶æŒ‰ç…§ç‰¹å®šçš„è§„å¾‹è¿›è¡Œç”Ÿæˆã€‚ä½†æ˜¯æˆ‘ä»¬åœ¨å®žçŽ°ä¸€ä¸ªè¿­ä»£å™¨æ—¶ï¼Œå…³äºŽå½“å‰è¿­ä»£åˆ°çš„çŠ¶æ€éœ€è¦æˆ‘ä»¬è‡ªå·±è®°å½•ï¼Œè¿›è€Œæ‰èƒ½æ ¹æ®å½“å‰çŠ¶æ€ç”Ÿæˆä¸‹ä¸€ä¸ªæ•°æ®ã€‚ä¸ºäº†è¾¾åˆ°è®°å½•å½“å‰çŠ¶æ€ï¼Œå¹¶é…åˆnext()å‡½æ•°è¿›è¡Œè¿­ä»£ä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨æ›´ç®€ä¾¿çš„è¯­æ³•ï¼Œå³ç”Ÿæˆå™¨(generator)ã€‚ç”Ÿæˆå™¨æ˜¯ä¸€ç±»ç‰¹æ®Šçš„è¿­ä»£å™¨ã€‚2. åˆ›å»ºç”Ÿæˆå™¨æ–¹æ³•1è¦åˆ›å»ºä¸€ä¸ªç”Ÿæˆå™¨ï¼Œæœ‰å¾ˆå¤šç§æ–¹æ³•ã€‚ç¬¬ä¸€ç§æ–¹æ³•å¾ˆç®€å•ï¼Œåªè¦æŠŠä¸€ä¸ªåˆ—è¡¨ç”Ÿæˆå¼çš„ [ ] æ”¹æˆ ( )1234567891011In [15]: L = [ x*2 for x in range(5)]In [16]: LOut[16]: [0, 2, 4, 6, 8]In [17]: G = ( x*2 for x in range(5))In [18]: GOut[18]: &lt;generator object &lt;genexpr&gt; at 0x7f626c132db0&gt;In [19]:åˆ›å»º L å’Œ G çš„åŒºåˆ«ä»…åœ¨äºŽæœ€å¤–å±‚çš„ [ ] å’Œ ( ) ï¼Œ L æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œè€Œ G æ˜¯ä¸€ä¸ªç”Ÿæˆå™¨ã€‚æˆ‘ä»¬å¯ä»¥ç›´æŽ¥æ‰“å°å‡ºåˆ—è¡¨Lçš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œè€Œå¯¹äºŽç”Ÿæˆå™¨Gï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§è¿­ä»£å™¨çš„ä½¿ç”¨æ–¹æ³•æ¥ä½¿ç”¨ï¼Œå³å¯ä»¥é€šè¿‡next()å‡½æ•°ã€forå¾ªçŽ¯ã€list()ç­‰æ–¹æ³•ä½¿ç”¨ã€‚123456789101112131415161718192021222324252627282930313233343536In [19]: next(G)Out[19]: 0In [20]: next(G)Out[20]: 2In [21]: next(G)Out[21]: 4In [22]: next(G)Out[22]: 6In [23]: next(G)Out[23]: 8In [24]: next(G)---------------------------------------------------------------------------StopIteration Traceback (most recent call last)&lt;ipython-input-24-380e167d6934&gt; in &lt;module&gt;()----&gt; 1 next(G)StopIteration:In [25]:In [26]: G = ( x*2 for x in range(5))In [27]: for x in G: ....: print(x) ....: 02468In [28]:3. åˆ›å»ºç”Ÿæˆå™¨æ–¹æ³•2generatoréžå¸¸å¼ºå¤§ã€‚å¦‚æžœæŽ¨ç®—çš„ç®—æ³•æ¯”è¾ƒå¤æ‚ï¼Œç”¨ç±»ä¼¼åˆ—è¡¨ç”Ÿæˆå¼çš„ for å¾ªçŽ¯æ— æ³•å®žçŽ°çš„æ—¶å€™ï¼Œè¿˜å¯ä»¥ç”¨å‡½æ•°æ¥å®žçŽ°ã€‚æˆ‘ä»¬ä»ç„¶ç”¨ä¸Šä¸€èŠ‚æåˆ°çš„æ–æ³¢é‚£å¥‘æ•°åˆ—æ¥ä¸¾ä¾‹ï¼Œå›žæƒ³æˆ‘ä»¬åœ¨ä¸Šä¸€èŠ‚ç”¨è¿­ä»£å™¨çš„å®žçŽ°æ–¹å¼ï¼š123456789101112131415161718192021222324252627class FibIterator(object): """æ–æ³¢é‚£å¥‘æ•°åˆ—è¿­ä»£å™¨""" def __init__(self, n): """ :param n: int, æŒ‡æ˜Žç”Ÿæˆæ•°åˆ—çš„å‰nä¸ªæ•° """ self.n = n # currentç”¨æ¥ä¿å­˜å½“å‰ç”Ÿæˆåˆ°æ•°åˆ—ä¸­çš„ç¬¬å‡ ä¸ªæ•°äº† self.current = 0 # num1ç”¨æ¥ä¿å­˜å‰å‰ä¸€ä¸ªæ•°ï¼Œåˆå§‹å€¼ä¸ºæ•°åˆ—ä¸­çš„ç¬¬ä¸€ä¸ªæ•°0 self.num1 = 0 # num2ç”¨æ¥ä¿å­˜å‰ä¸€ä¸ªæ•°ï¼Œåˆå§‹å€¼ä¸ºæ•°åˆ—ä¸­çš„ç¬¬äºŒä¸ªæ•°1 self.num2 = 1 def __next__(self): """è¢«next()å‡½æ•°è°ƒç”¨æ¥èŽ·å–ä¸‹ä¸€ä¸ªæ•°""" if self.current &lt; self.n: num = self.num1 self.num1, self.num2 = self.num2, self.num1+self.num2 self.current += 1 return num else: raise StopIteration def __iter__(self): """è¿­ä»£å™¨çš„__iter__è¿”å›žè‡ªèº«å³å¯""" return selfæ³¨æ„ï¼Œåœ¨ç”¨è¿­ä»£å™¨å®žçŽ°çš„æ–¹å¼ä¸­ï¼Œæˆ‘ä»¬è¦å€ŸåŠ©å‡ ä¸ªå˜é‡(nã€currentã€num1ã€num2)æ¥ä¿å­˜è¿­ä»£çš„çŠ¶æ€ã€‚çŽ°åœ¨æˆ‘ä»¬ç”¨ç”Ÿæˆå™¨æ¥å®žçŽ°ä¸€ä¸‹ã€‚1234567891011121314151617181920212223242526272829303132333435In [30]: def fib(n): ....: current = 0 ....: num1, num2 = 0, 1 ....: while current &lt; n: ....: num = num1 ....: num1, num2 = num2, num1+num2 ....: current += 1 ....: yield num ....: return 'done' ....:In [31]: F = fib(5)In [32]: next(F)Out[32]: 1In [33]: next(F)Out[33]: 1In [34]: next(F)Out[34]: 2In [35]: next(F)Out[35]: 3In [36]: next(F)Out[36]: 5In [37]: next(F)---------------------------------------------------------------------------StopIteration Traceback (most recent call last)&lt;ipython-input-37-8c2b02b4361a&gt; in &lt;module&gt;()----&gt; 1 next(F)StopIteration: doneåœ¨ä½¿ç”¨ç”Ÿæˆå™¨å®žçŽ°çš„æ–¹å¼ä¸­ï¼Œæˆ‘ä»¬å°†åŽŸæœ¬åœ¨è¿­ä»£å™¨__next__æ–¹æ³•ä¸­å®žçŽ°çš„åŸºæœ¬é€»è¾‘æ”¾åˆ°ä¸€ä¸ªå‡½æ•°ä¸­æ¥å®žçŽ°ï¼Œä½†æ˜¯å°†æ¯æ¬¡è¿­ä»£è¿”å›žæ•°å€¼çš„returnæ¢æˆäº†yieldï¼Œæ­¤æ—¶æ–°å®šä¹‰çš„å‡½æ•°ä¾¿ä¸å†æ˜¯å‡½æ•°ï¼Œè€Œæ˜¯ä¸€ä¸ªç”Ÿæˆå™¨äº†ã€‚ç®€å•æ¥è¯´ï¼šåªè¦åœ¨defå‡½æ•°ä¸­æœ‰yieldå…³é”®å­—çš„ å°±ç§°ä¸º ç”Ÿæˆå™¨æ­¤æ—¶æŒ‰ç…§è°ƒç”¨å‡½æ•°çš„æ–¹å¼( æ¡ˆä¾‹ä¸­ä¸ºF = fib(5) )ä½¿ç”¨ç”Ÿæˆå™¨å°±ä¸å†æ˜¯æ‰§è¡Œå‡½æ•°ä½“äº†ï¼Œè€Œæ˜¯ä¼šè¿”å›žä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡ï¼ˆ æ¡ˆä¾‹ä¸­ä¸ºF ï¼‰ï¼Œç„¶åŽå°±å¯ä»¥æŒ‰ç…§ä½¿ç”¨è¿­ä»£å™¨çš„æ–¹å¼æ¥ä½¿ç”¨ç”Ÿæˆå™¨äº†ã€‚12345678910In [38]: for n in fib(5): ....: print(n) ....: 11235In [39]:ä½†æ˜¯ç”¨forå¾ªçŽ¯è°ƒç”¨generatoræ—¶ï¼Œå‘çŽ°æ‹¿ä¸åˆ°generatorçš„returnè¯­å¥çš„è¿”å›žå€¼ã€‚å¦‚æžœæƒ³è¦æ‹¿åˆ°è¿”å›žå€¼ï¼Œå¿…é¡»æ•èŽ·StopIterationé”™è¯¯ï¼Œè¿”å›žå€¼åŒ…å«åœ¨StopIterationçš„valueä¸­ï¼š123456789101112131415161718In [39]: g = fib(5)In [40]: while True: ....: try: ....: x = next(g) ....: print("value:%d"%x) ....: except StopIteration as e: ....: print("ç”Ÿæˆå™¨è¿”å›žå€¼:%s"%e.value) ....: break ....: value:1value:1value:2value:3value:5ç”Ÿæˆå™¨è¿”å›žå€¼:doneIn [41]:æ€»ç»“ä½¿ç”¨äº†yieldå…³é”®å­—çš„å‡½æ•°ä¸å†æ˜¯å‡½æ•°ï¼Œè€Œæ˜¯ç”Ÿæˆå™¨ã€‚ï¼ˆä½¿ç”¨äº†yieldçš„å‡½æ•°å°±æ˜¯ç”Ÿæˆå™¨ï¼‰yieldå…³é”®å­—æœ‰ä¸¤ç‚¹ä½œç”¨ï¼šä¿å­˜å½“å‰è¿è¡ŒçŠ¶æ€ï¼ˆæ–­ç‚¹ï¼‰ï¼Œç„¶åŽæš‚åœæ‰§è¡Œï¼Œå³å°†ç”Ÿæˆå™¨ï¼ˆå‡½æ•°ï¼‰æŒ‚èµ·å°†yieldå…³é”®å­—åŽé¢è¡¨è¾¾å¼çš„å€¼ä½œä¸ºè¿”å›žå€¼è¿”å›žï¼Œæ­¤æ—¶å¯ä»¥ç†è§£ä¸ºèµ·åˆ°äº†returnçš„ä½œç”¨å¯ä»¥ä½¿ç”¨next()å‡½æ•°è®©ç”Ÿæˆå™¨ä»Žæ–­ç‚¹å¤„ç»§ç»­æ‰§è¡Œï¼Œå³å”¤é†’ç”Ÿæˆå™¨ï¼ˆå‡½æ•°ï¼‰Python3ä¸­çš„ç”Ÿæˆå™¨å¯ä»¥ä½¿ç”¨returnè¿”å›žæœ€ç»ˆè¿è¡Œçš„è¿”å›žå€¼ï¼Œè€ŒPython2ä¸­çš„ç”Ÿæˆå™¨ä¸å…è®¸ä½¿ç”¨returnè¿”å›žä¸€ä¸ªè¿”å›žå€¼ï¼ˆå³å¯ä»¥ä½¿ç”¨returnä»Žç”Ÿæˆå™¨ä¸­é€€å‡ºï¼Œä½†returnåŽä¸èƒ½æœ‰ä»»ä½•è¡¨è¾¾å¼ï¼‰ã€‚4. ä½¿ç”¨sendå”¤é†’æˆ‘ä»¬é™¤äº†å¯ä»¥ä½¿ç”¨next()å‡½æ•°æ¥å”¤é†’ç”Ÿæˆå™¨ç»§ç»­æ‰§è¡Œå¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨send()å‡½æ•°æ¥å”¤é†’æ‰§è¡Œã€‚ä½¿ç”¨send()å‡½æ•°çš„ä¸€ä¸ªå¥½å¤„æ˜¯å¯ä»¥åœ¨å”¤é†’çš„åŒæ—¶å‘æ–­ç‚¹å¤„ä¼ å…¥ä¸€ä¸ªé™„åŠ æ•°æ®ã€‚ä¾‹å­ï¼šæ‰§è¡Œåˆ°yieldæ—¶ï¼Œgenå‡½æ•°ä½œç”¨æš‚æ—¶ä¿å­˜ï¼Œè¿”å›žiçš„å€¼; tempæŽ¥æ”¶ä¸‹æ¬¡c.send(â€œpythonâ€)ï¼Œsendå‘é€è¿‡æ¥çš„å€¼ï¼Œc.next()ç­‰ä»·c.send(None)1234567In [10]: def gen(): ....: i = 0 ....: while i&lt;5: ....: temp = yield i ....: print(temp) ....: i+=1 ....:ä½¿ç”¨send123456789101112131415161718In [43]: f = gen()In [44]: next(f)Out[44]: 0In [45]: f.send('haha')hahaOut[45]: 1In [46]: next(f)NoneOut[46]: 2In [47]: f.send('haha')hahaOut[47]: 3In [48]:ä½¿ç”¨nextå‡½æ•°1234567891011121314151617181920212223242526272829In [11]: f = gen()In [12]: next(f)Out[12]: 0In [13]: next(f)NoneOut[13]: 1In [14]: next(f)NoneOut[14]: 2In [15]: next(f)NoneOut[15]: 3In [16]: next(f)NoneOut[16]: 4In [17]: next(f)None---------------------------------------------------------------------------StopIteration Traceback (most recent call last)&lt;ipython-input-17-468f0afdf1b9&gt; in &lt;module&gt;()----&gt; 1 next(f)StopIteration:ä½¿ç”¨__next__()æ–¹æ³•ï¼ˆä¸å¸¸ä½¿ç”¨ï¼‰1234567891011121314151617181920212223242526272829In [18]: f = gen()In [19]: f.__next__()Out[19]: 0In [20]: f.__next__()NoneOut[20]: 1In [21]: f.__next__()NoneOut[21]: 2In [22]: f.__next__()NoneOut[22]: 3In [23]: f.__next__()NoneOut[23]: 4In [24]: f.__next__()None---------------------------------------------------------------------------StopIteration Traceback (most recent call last)&lt;ipython-input-24-39ec527346a9&gt; in &lt;module&gt;()----&gt; 1 f.__next__()StopIteration:åç¨‹åç¨‹ï¼Œåˆç§°å¾®çº¿ç¨‹ï¼Œçº¤ç¨‹ã€‚è‹±æ–‡åCoroutineã€‚1.åç¨‹æ˜¯å•¥åç¨‹æ˜¯pythonä¸ªä¸­å¦å¤–ä¸€ç§å®žçŽ°å¤šä»»åŠ¡çš„æ–¹å¼ï¼Œåªä¸è¿‡æ¯”çº¿ç¨‹æ›´å°å ç”¨æ›´å°æ‰§è¡Œå•å…ƒï¼ˆç†è§£ä¸ºéœ€è¦çš„èµ„æºï¼‰ã€‚ ä¸ºå•¥è¯´å®ƒæ˜¯ä¸€ä¸ªæ‰§è¡Œå•å…ƒï¼Œå› ä¸ºå®ƒè‡ªå¸¦CPUä¸Šä¸‹æ–‡ã€‚è¿™æ ·åªè¦åœ¨åˆé€‚çš„æ—¶æœºï¼Œ æˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªåç¨‹ åˆ‡æ¢åˆ°å¦ä¸€ä¸ªåç¨‹ã€‚ åªè¦è¿™ä¸ªè¿‡ç¨‹ä¸­ä¿å­˜æˆ–æ¢å¤ CPUä¸Šä¸‹æ–‡é‚£ä¹ˆç¨‹åºè¿˜æ˜¯å¯ä»¥è¿è¡Œçš„ã€‚é€šä¿—çš„ç†è§£ï¼šåœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­çš„æŸä¸ªå‡½æ•°ï¼Œå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä¿å­˜å½“å‰å‡½æ•°çš„ä¸€äº›ä¸´æ—¶å˜é‡ç­‰ä¿¡æ¯ï¼Œç„¶åŽåˆ‡æ¢åˆ°å¦å¤–ä¸€ä¸ªå‡½æ•°ä¸­æ‰§è¡Œï¼Œæ³¨æ„ä¸æ˜¯é€šè¿‡è°ƒç”¨å‡½æ•°çš„æ–¹å¼åšåˆ°çš„ï¼Œå¹¶ä¸”åˆ‡æ¢çš„æ¬¡æ•°ä»¥åŠä»€ä¹ˆæ—¶å€™å†åˆ‡æ¢åˆ°åŽŸæ¥çš„å‡½æ•°éƒ½ç”±å¼€å‘è€…è‡ªå·±ç¡®å®š2.åç¨‹å’Œçº¿ç¨‹å·®å¼‚åœ¨å®žçŽ°å¤šä»»åŠ¡æ—¶, çº¿ç¨‹åˆ‡æ¢ä»Žç³»ç»Ÿå±‚é¢è¿œä¸æ­¢ä¿å­˜å’Œæ¢å¤ CPUä¸Šä¸‹æ–‡è¿™ä¹ˆç®€å•ã€‚ æ“ä½œç³»ç»Ÿä¸ºäº†ç¨‹åºè¿è¡Œçš„é«˜æ•ˆæ€§æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±ç¼“å­˜Cacheç­‰ç­‰æ•°æ®ï¼Œæ“ä½œç³»ç»Ÿè¿˜ä¼šå¸®ä½ åšè¿™äº›æ•°æ®çš„æ¢å¤æ“ä½œã€‚ æ‰€ä»¥çº¿ç¨‹çš„åˆ‡æ¢éžå¸¸è€—æ€§èƒ½ã€‚ä½†æ˜¯åç¨‹çš„åˆ‡æ¢åªæ˜¯å•çº¯çš„æ“ä½œCPUçš„ä¸Šä¸‹æ–‡ï¼Œæ‰€ä»¥ä¸€ç§’é’Ÿåˆ‡æ¢ä¸ªä¸Šç™¾ä¸‡æ¬¡ç³»ç»Ÿéƒ½æŠ—çš„ä½ã€‚3.ç®€å•å®žçŽ°åç¨‹1234567891011121314151617181920212223import timedef work1(): while True: print("----work1---") yield time.sleep(0.5)def work2(): while True: print("----work2---") yield time.sleep(0.5)def main(): w1 = work1() w2 = work2() while True: next(w1) next(w2)if __name__ == "__main__": main()è¿è¡Œç»“æžœï¼š12345678910111213----work1-------work2-------work1-------work2-------work1-------work2-------work1-------work2-------work1-------work2-------work1-------work2---...çœç•¥...greenletä¸ºäº†æ›´å¥½ä½¿ç”¨åç¨‹æ¥å®Œæˆå¤šä»»åŠ¡ï¼Œpythonä¸­çš„greenletæ¨¡å—å¯¹å…¶å°è£…ï¼Œä»Žè€Œä½¿å¾—åˆ‡æ¢ä»»åŠ¡å˜çš„æ›´åŠ ç®€å•å®‰è£…æ–¹å¼ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£…greenletæ¨¡å—:1234567891011121314151617181920212223sudo pip3 install greenlet#coding=utf-8from greenlet import greenletimport timedef test1(): while True: print &quot;---A--&quot; gr2.switch() time.sleep(0.5)def test2(): while True: print &quot;---B--&quot; gr1.switch() time.sleep(0.5)gr1 = greenlet(test1)gr2 = greenlet(test2)#åˆ‡æ¢åˆ°gr1ä¸­è¿è¡Œgr1.switch()è¿è¡Œæ•ˆæžœ123456789---A-----B-----A-----B-----A-----B-----A-----B--...çœç•¥...geventgreenletå·²ç»å®žçŽ°äº†åç¨‹ï¼Œä½†æ˜¯è¿™ä¸ªè¿˜çš„äººå·¥åˆ‡æ¢ï¼Œæ˜¯ä¸æ˜¯è§‰å¾—å¤ªéº»çƒ¦äº†ï¼Œä¸è¦æ‰æ€¥ï¼Œpythonè¿˜æœ‰ä¸€ä¸ªæ¯”greenletæ›´å¼ºå¤§çš„å¹¶ä¸”èƒ½å¤Ÿè‡ªåŠ¨åˆ‡æ¢ä»»åŠ¡çš„æ¨¡å—geventå…¶åŽŸç†æ˜¯å½“ä¸€ä¸ªgreenleté‡åˆ°IO(æŒ‡çš„æ˜¯input output è¾“å…¥è¾“å‡ºï¼Œæ¯”å¦‚ç½‘ç»œã€æ–‡ä»¶æ“ä½œç­‰)æ“ä½œæ—¶ï¼Œæ¯”å¦‚è®¿é—®ç½‘ç»œï¼Œå°±è‡ªåŠ¨åˆ‡æ¢åˆ°å…¶ä»–çš„greenletï¼Œç­‰åˆ°IOæ“ä½œå®Œæˆï¼Œå†åœ¨é€‚å½“çš„æ—¶å€™åˆ‡æ¢å›žæ¥ç»§ç»­æ‰§è¡Œã€‚ç”±äºŽIOæ“ä½œéžå¸¸è€—æ—¶ï¼Œç»å¸¸ä½¿ç¨‹åºå¤„äºŽç­‰å¾…çŠ¶æ€ï¼Œæœ‰äº†geventä¸ºæˆ‘ä»¬è‡ªåŠ¨åˆ‡æ¢åç¨‹ï¼Œå°±ä¿è¯æ€»æœ‰greenletåœ¨è¿è¡Œï¼Œè€Œä¸æ˜¯ç­‰å¾…IOå®‰è£…1pip3 install gevent1. geventçš„ä½¿ç”¨123456789101112import geventdef f(n): for i in range(n): print(gevent.getcurrent(), i)g1 = gevent.spawn(f, 5)g2 = gevent.spawn(f, 5)g3 = gevent.spawn(f, 5)g1.join()g2.join()g3.join()è¿è¡Œç»“æžœ123456789101112131415&lt;Greenlet at 0x10e49f550: f(5)&gt; 0&lt;Greenlet at 0x10e49f550: f(5)&gt; 1&lt;Greenlet at 0x10e49f550: f(5)&gt; 2&lt;Greenlet at 0x10e49f550: f(5)&gt; 3&lt;Greenlet at 0x10e49f550: f(5)&gt; 4&lt;Greenlet at 0x10e49f910: f(5)&gt; 0&lt;Greenlet at 0x10e49f910: f(5)&gt; 1&lt;Greenlet at 0x10e49f910: f(5)&gt; 2&lt;Greenlet at 0x10e49f910: f(5)&gt; 3&lt;Greenlet at 0x10e49f910: f(5)&gt; 4&lt;Greenlet at 0x10e49f4b0: f(5)&gt; 0&lt;Greenlet at 0x10e49f4b0: f(5)&gt; 1&lt;Greenlet at 0x10e49f4b0: f(5)&gt; 2&lt;Greenlet at 0x10e49f4b0: f(5)&gt; 3&lt;Greenlet at 0x10e49f4b0: f(5)&gt; 4å¯ä»¥çœ‹åˆ°ï¼Œ3ä¸ªgreenletæ˜¯ä¾æ¬¡è¿è¡Œè€Œä¸æ˜¯äº¤æ›¿è¿è¡Œ2. geventåˆ‡æ¢æ‰§è¡Œ1234567891011121314import geventdef f(n): for i in range(n): print(gevent.getcurrent(), i) #ç”¨æ¥æ¨¡æ‹Ÿä¸€ä¸ªè€—æ—¶æ“ä½œï¼Œæ³¨æ„ä¸æ˜¯timeæ¨¡å—ä¸­çš„sleep gevent.sleep(1)g1 = gevent.spawn(f, 5)g2 = gevent.spawn(f, 5)g3 = gevent.spawn(f, 5)g1.join()g2.join()g3.join()è¿è¡Œç»“æžœ123456789101112131415&lt;Greenlet at 0x7fa70ffa1c30: f(5)&gt; 0&lt;Greenlet at 0x7fa70ffa1870: f(5)&gt; 0&lt;Greenlet at 0x7fa70ffa1eb0: f(5)&gt; 0&lt;Greenlet at 0x7fa70ffa1c30: f(5)&gt; 1&lt;Greenlet at 0x7fa70ffa1870: f(5)&gt; 1&lt;Greenlet at 0x7fa70ffa1eb0: f(5)&gt; 1&lt;Greenlet at 0x7fa70ffa1c30: f(5)&gt; 2&lt;Greenlet at 0x7fa70ffa1870: f(5)&gt; 2&lt;Greenlet at 0x7fa70ffa1eb0: f(5)&gt; 2&lt;Greenlet at 0x7fa70ffa1c30: f(5)&gt; 3&lt;Greenlet at 0x7fa70ffa1870: f(5)&gt; 3&lt;Greenlet at 0x7fa70ffa1eb0: f(5)&gt; 3&lt;Greenlet at 0x7fa70ffa1c30: f(5)&gt; 4&lt;Greenlet at 0x7fa70ffa1870: f(5)&gt; 4&lt;Greenlet at 0x7fa70ffa1eb0: f(5)&gt; 43. ç»™ç¨‹åºæ‰“è¡¥ä¸1234567891011121314from gevent import monkeyimport geventimport randomimport timedef coroutine_work(coroutine_name): for i in range(10): print(coroutine_name, i) time.sleep(random.random())gevent.joinall([ gevent.spawn(coroutine_work, "work1"), gevent.spawn(coroutine_work, "work2")])è¿è¡Œç»“æžœ1234567891011121314151617181920work1 0work1 1work1 2work1 3work1 4work1 5work1 6work1 7work1 8work1 9work2 0work2 1work2 2work2 3work2 4work2 5work2 6work2 7work2 8work2 91234567891011121314151617from gevent import monkeyimport geventimport randomimport time# æœ‰è€—æ—¶æ“ä½œæ—¶éœ€è¦monkey.patch_all() # å°†ç¨‹åºä¸­ç”¨åˆ°çš„è€—æ—¶æ“ä½œçš„ä»£ç ï¼Œæ¢ä¸ºgeventä¸­è‡ªå·±å®žçŽ°çš„æ¨¡å—def coroutine_work(coroutine_name): for i in range(10): print(coroutine_name, i) time.sleep(random.random())gevent.joinall([ gevent.spawn(coroutine_work, &quot;work1&quot;), gevent.spawn(coroutine_work, &quot;work2&quot;)])è¿è¡Œç»“æžœ1234567891011121314151617181920work1 0work2 0work1 1work1 2work1 3work2 1work1 4work2 2work1 5work2 3work1 6work1 7work1 8work2 4work2 5work1 9work2 6work2 7work2 8work2 9è¿›ç¨‹ã€çº¿ç¨‹ã€åç¨‹å¯¹æ¯”1.è¯·ä»”ç»†ç†è§£å¦‚ä¸‹çš„é€šä¿—æè¿°æœ‰ä¸€ä¸ªè€æ¿æƒ³è¦å¼€ä¸ªå·¥åŽ‚è¿›è¡Œç”Ÿäº§æŸä»¶å•†å“ï¼ˆä¾‹å¦‚å‰ªå­ï¼‰ä»–éœ€è¦èŠ±ä¸€äº›è´¢åŠ›ç‰©åŠ›åˆ¶ä½œä¸€æ¡ç”Ÿäº§çº¿ï¼Œè¿™ä¸ªç”Ÿäº§çº¿ä¸Šæœ‰å¾ˆå¤šçš„å™¨ä»¶ä»¥åŠææ–™è¿™äº›æ‰€æœ‰çš„ ä¸ºäº†èƒ½å¤Ÿç”Ÿäº§å‰ªå­è€Œå‡†å¤‡çš„èµ„æºç§°ä¹‹ä¸ºï¼šè¿›ç¨‹åªæœ‰ç”Ÿäº§çº¿æ˜¯ä¸èƒ½å¤Ÿè¿›è¡Œç”Ÿäº§çš„ï¼Œæ‰€ä»¥è€æ¿çš„æ‰¾ä¸ªå·¥äººæ¥è¿›è¡Œç”Ÿäº§ï¼Œè¿™ä¸ªå·¥äººèƒ½å¤Ÿåˆ©ç”¨è¿™äº›ææ–™æœ€ç»ˆä¸€æ­¥æ­¥çš„å°†å‰ªå­åšå‡ºæ¥ï¼Œè¿™ä¸ªæ¥åšäº‹æƒ…çš„å·¥äººç§°ä¹‹ä¸ºï¼šçº¿ç¨‹è¿™ä¸ªè€æ¿ä¸ºäº†æé«˜ç”Ÿäº§çŽ‡ï¼Œæƒ³åˆ°3ç§åŠžæ³•ï¼šåœ¨è¿™æ¡ç”Ÿäº§çº¿ä¸Šå¤šæ‹›äº›å·¥äººï¼Œä¸€èµ·æ¥åšå‰ªå­ï¼Œè¿™æ ·æ•ˆçŽ‡æ˜¯æˆå€å¢—é•¿ï¼Œå³å•è¿›ç¨‹ å¤šçº¿ç¨‹æ–¹å¼è€æ¿å‘çŽ°è¿™æ¡ç”Ÿäº§çº¿ä¸Šçš„å·¥äººä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œå› ä¸ºä¸€æ¡ç”Ÿäº§çº¿çš„èµ„æºä»¥åŠææ–™æ¯•ç«Ÿæœ‰é™ï¼Œæ‰€ä»¥è€æ¿åˆèŠ±äº†äº›è´¢åŠ›ç‰©åŠ›è´­ç½®äº†å¦å¤–ä¸€æ¡ç”Ÿäº§çº¿ï¼Œç„¶åŽå†æ‹›äº›å·¥äººè¿™æ ·æ•ˆçŽ‡åˆå†ä¸€æ­¥æé«˜äº†ï¼Œå³å¤šè¿›ç¨‹ å¤šçº¿ç¨‹æ–¹å¼è€æ¿å‘çŽ°ï¼ŒçŽ°åœ¨å·²ç»æœ‰äº†å¾ˆå¤šæ¡ç”Ÿäº§çº¿ï¼Œå¹¶ä¸”æ¯æ¡ç”Ÿäº§çº¿ä¸Šå·²ç»æœ‰å¾ˆå¤šå·¥äººäº†ï¼ˆå³ç¨‹åºæ˜¯å¤šè¿›ç¨‹çš„ï¼Œæ¯ä¸ªè¿›ç¨‹ä¸­åˆæœ‰å¤šä¸ªçº¿ç¨‹ï¼‰ï¼Œä¸ºäº†å†æ¬¡æé«˜æ•ˆçŽ‡ï¼Œè€æ¿æƒ³äº†ä¸ªæŸæ‹›ï¼Œè§„å®šï¼šå¦‚æžœæŸä¸ªå‘˜å·¥åœ¨ä¸Šç­æ—¶ä¸´æ—¶æ²¡äº‹æˆ–è€…å†ç­‰å¾…æŸäº›æ¡ä»¶ï¼ˆæ¯”å¦‚ç­‰å¾…å¦ä¸€ä¸ªå·¥äººç”Ÿäº§å®Œè°‹é“å·¥åº ä¹‹åŽä»–æ‰èƒ½å†æ¬¡å·¥ä½œï¼‰ ï¼Œé‚£ä¹ˆè¿™ä¸ªå‘˜å·¥å°±åˆ©ç”¨è¿™ä¸ªæ—¶é—´åŽ»åšå…¶å®ƒçš„äº‹æƒ…ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼šå¦‚æžœä¸€ä¸ªçº¿ç¨‹ç­‰å¾…æŸäº›æ¡ä»¶ï¼Œå¯ä»¥å……åˆ†åˆ©ç”¨è¿™ä¸ªæ—¶é—´åŽ»åšå…¶å®ƒäº‹æƒ…ï¼Œå…¶å®žè¿™å°±æ˜¯ï¼šåç¨‹æ–¹å¼2.ç®€å•æ€»ç»“è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„å•ä½çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿè°ƒåº¦çš„å•ä½è¿›ç¨‹åˆ‡æ¢éœ€è¦çš„èµ„æºå¾ˆæœ€å¤§ï¼Œæ•ˆçŽ‡å¾ˆä½Žçº¿ç¨‹åˆ‡æ¢éœ€è¦çš„èµ„æºä¸€èˆ¬ï¼Œæ•ˆçŽ‡ä¸€èˆ¬ï¼ˆå½“ç„¶äº†åœ¨ä¸è€ƒè™‘GILçš„æƒ…å†µä¸‹ï¼‰åç¨‹åˆ‡æ¢ä»»åŠ¡èµ„æºå¾ˆå°ï¼Œæ•ˆçŽ‡é«˜å¤šè¿›ç¨‹ã€å¤šçº¿ç¨‹æ ¹æ®cpuæ ¸æ•°ä¸ä¸€æ ·å¯èƒ½æ˜¯å¹¶è¡Œçš„ï¼Œä½†æ˜¯åç¨‹æ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ æ‰€ä»¥æ˜¯å¹¶å‘å¹¶å‘ä¸‹è½½å™¨1.å¹¶å‘ä¸‹è½½åŽŸç†123456789101112131415161718from gevent import monkeyimport geventimport urllib.request# æœ‰è€—æ—¶æ“ä½œæ—¶éœ€è¦monkey.patch_all()def my_downLoad(url): print('GET: %s' % url) resp = urllib.request.urlopen(url) data = resp.read() print('%d bytes received from %s.' % (len(data), url))gevent.joinall([ gevent.spawn(my_downLoad, 'http://www.baidu.com/'), gevent.spawn(my_downLoad, 'http://www.itcast.cn/'), gevent.spawn(my_downLoad, 'http://www.itheima.com/'),])è¿è¡Œç»“æžœ123456GET: http://www.baidu.com/GET: http://www.itcast.cn/GET: http://www.itheima.com/111327 bytes received from http://www.baidu.com/.172054 bytes received from http://www.itheima.com/.215035 bytes received from http://www.itcast.cn/.ä»Žä¸Šèƒ½å¤Ÿçœ‹åˆ°æ˜¯å…ˆå‘é€çš„èŽ·å–baiduçš„ç›¸å…³ä¿¡æ¯ï¼Œç„¶åŽä¾æ¬¡æ˜¯itcastã€itheimaï¼Œä½†æ˜¯æ”¶åˆ°æ•°æ®çš„å…ˆåŽé¡ºåºä¸ä¸€å®šä¸Žå‘é€é¡ºåºç›¸åŒï¼Œè¿™ä¹Ÿå°±ä½“çŽ°å‡ºäº†å¼‚æ­¥ï¼Œå³ä¸ç¡®å®šä»€ä¹ˆæ—¶å€™ä¼šæ”¶åˆ°æ•°æ®ï¼Œé¡ºåºä¸ä¸€å®š2.å®žçŽ°å¤šä¸ªè§†é¢‘ä¸‹è½½123456789101112131415161718192021from gevent import monkeyimport geventimport urllib.request#æœ‰IOæ‰åšæ—¶éœ€è¦è¿™ä¸€å¥monkey.patch_all()def my_downLoad(file_name, url): print('GET: %s' % url) resp = urllib.request.urlopen(url) data = resp.read() with open(file_name, "wb") as f: f.write(data) print('%d bytes received from %s.' % (len(data), url))gevent.joinall([ gevent.spawn(my_downLoad, "1.mp4", 'http://oo52bgdsl.bkt.clouddn.com/05day-08-%E3%80%90%E7%90%86%E8%A7%A3%E3%80%91%E5%87%BD%E6%95%B0%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93%EF%BC%88%E4%B8%80%EF%BC%89.mp4'), gevent.spawn(my_downLoad, "2.mp4", 'http://oo52bgdsl.bkt.clouddn.com/05day-03-%E3%80%90%E6%8E%8C%E6%8F%A1%E3%80%91%E6%97%A0%E5%8F%82%E6%95%B0%E6%97%A0%E8%BF%94%E5%9B%9E%E5%80%BC%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9A%E4%B9%89%E3%80%81%E8%B0%83%E7%94%A8%28%E4%B8%8B%29.mp4'),])ä¸Šé¢çš„urlå¯ä»¥æ¢ä¸ºè‡ªå·±éœ€è¦ä¸‹è½½è§†é¢‘ã€éŸ³ä¹ã€å›¾ç‰‡ç­‰ç½‘å€]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åœ¨pandas.DataFrame.to_sqlæ—¶æŒ‡å®šæ•°æ®åº“è¡¨çš„åˆ—ç±»åž‹]]></title>
    <url>%2F2019%2F12%2F31%2F%E5%9C%A8pandas.DataFrame.to_sql%E6%97%B6%E6%8C%87%E5%AE%9A%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E7%9A%84%E5%88%97%E7%B1%BB%E5%9E%8B%2F</url>
    <content type="text"><![CDATA[è¯¥æ–‡ç« è½¬è½½è‡ªä»¥ä¸‹é“¾æŽ¥ï¼šhttps://www.jianshu.com/p/4c5e1ebe8470?utm_source=oschina-appé—®é¢˜åœ¨æ•°æ®åˆ†æžå¹¶å­˜å‚¨åˆ°æ•°æ®åº“æ—¶ï¼ŒPythonçš„PandasåŒ…æä¾›äº†to_sql æ–¹æ³•ä½¿å­˜å‚¨çš„è¿‡ç¨‹æ›´ä¸ºä¾¿æ·ï¼Œä½†å¦‚æžœåœ¨ä½¿ç”¨to_sqlæ–¹æ³•å‰ä¸åœ¨æ•°æ®åº“å»ºå¥½ç›¸å¯¹åº”çš„è¡¨ï¼Œto_sqlåˆ™ä¼šé»˜è®¤ä¸ºä½ åˆ›å»ºä¸€ä¸ªæ–°è¡¨ï¼Œè¿™æ—¶æ–°è¡¨çš„åˆ—ç±»åž‹å¯èƒ½å¹¶ä¸æ˜¯ä½ æœŸæœ›çš„ã€‚ä¾‹å¦‚æˆ‘ä»¬é€šè¿‡ä¸‹æ®µä»£ç å¾€æ•°æ®åº“ä¸­æ’å…¥ä¸€éƒ¨åˆ†æ•°æ®ï¼š123456import pandas as pdfrom datetime import datetimedf = pd.DataFrame([['a', 1, 1, 2.0, datetime.now(), True]], columns=['str', 'int', 'float', 'datetime', 'boolean'])print(df.dtypes)é€šè¿‡dtypeså¯çŸ¥æ•°æ®ç±»åž‹ä¸ºobject, int64, float64, datetime64[ns], bool å¦‚æžœæŠŠæ•°æ®é€šè¿‡to_sqlæ–¹æ³•æ’å…¥åˆ°æ•°æ®åº“ä¸­ï¼š12345from sqlalchemy import create_engineengine = create_engine("mysql+mysqldb://&#123;&#125;:&#123;&#125;@&#123;&#125;/&#123;&#125;".format('username', 'password', 'host:port', 'database'))con = engine.connect()df.to_sql(name='test', con=con, if_exists='append', index=False)ç”¨MySQLçš„descå¯ä»¥å‘çŽ°æ•°æ®åº“è‡ªåŠ¨åˆ›å»ºäº†è¡¨å¹¶é»˜è®¤æŒ‡å®šäº†åˆ—çš„æ ¼å¼ï¼š12# åœ¨MySQLä¸­æŸ¥çœ‹è¡¨çš„åˆ—ç±»åž‹desc test;FiledTypeNullKeyDefaultExtrastrtextYESNULLintbigint(20)YESNULLfloatdoubleYESNULLdatetimedatetimeYESNULLbooleantinyint(1)YESNULLå…¶ä¸­strç±»åž‹çš„æ•°æ®åœ¨æ•°æ®åº“è¡¨ä¸­è¢«æ˜ å°„æˆtextï¼Œintç±»åž‹è¢«æ˜ å°„æˆbigint(20)ï¼Œ floatç±»åž‹è¢«æ˜ å°„æˆdoubleç±»åž‹ã€‚æ•°æ®åº“ä¸­çš„åˆ—ç±»åž‹å¯èƒ½å¹¶éžæ˜¯æˆ‘ä»¬æ‰€æœŸæœ›çš„æ ¼å¼ï¼Œä½†æˆ‘ä»¬åˆä¸æƒ³åœ¨æ•°æ®æ’å…¥å‰æ‰‹åŠ¨çš„åˆ›å»ºæ•°æ®åº“çš„è¡¨ï¼Œè€Œæ›´å¸Œæœ›æ ¹æ®DataFrameä¸­æ•°æ®çš„æ ¼å¼åŠ¨æ€åœ°æ”¹å˜æ•°æ®åº“ä¸­è¡¨æ ¼å¼ã€‚åˆ†æžé€šè¿‡æŸ¥é˜…pandas.DataFrame.to_sqlçš„apiæ–‡æ¡£[^footnote]ï¼Œå¯ä»¥é€šè¿‡æŒ‡å®šdtype å‚æ•°å€¼æ¥æ”¹å˜æ•°æ®åº“ä¸­åˆ›å»ºè¡¨çš„åˆ—ç±»åž‹ã€‚dtype : dict of column name to SQL type, default NoneOptional specifying the datatype for columns. The SQL type should be a SQLAlchemy type, or a string for sqlite3 fallback connection.æ ¹æ®æè¿°ï¼Œå¯ä»¥åœ¨æ‰§è¡Œto_sqlæ–¹æ³•æ—¶ï¼Œå°†æ˜ å°„å¥½åˆ—åå’ŒæŒ‡å®šç±»åž‹çš„dictèµ‹å€¼ç»™dtypeå‚æ•°å³å¯ä¸Šï¼Œå…¶ä¸­å¯¹äºŽMySQLè¡¨çš„åˆ—ç±»åž‹å¯ä»¥ä½¿ç”¨SQLAlchemyåŒ…ä¸­å°è£…å¥½çš„ç±»åž‹ã€‚12# æ‰§è¡Œå‰å…ˆåœ¨MySQLä¸­åˆ é™¤è¡¨drop table test;123456789from sqlalchemy.types import NVARCHAR, Float, Integerdtypedict = &#123; 'str': NVARCHAR(length=255), 'int': Integer(), 'float' Float()&#125;df.to_sql(name='test', con=con, if_exists='append', index=False, dtype=dtypedict)æ›´æ–°ä»£ç åŽï¼Œå†æŸ¥çœ‹æ•°æ®åº“ï¼Œå¯ä»¥çœ‹åˆ°æ•°æ®åº“åœ¨å»ºè¡¨æ—¶ä¼šæ ¹æ®dtypedictä¸­çš„åˆ—åæ¥æŒ‡å®šç›¸åº”çš„ç±»åž‹ã€‚12# åœ¨MySQLä¸­æŸ¥çœ‹è¡¨çš„åˆ—ç±»åž‹desc test;FiledTypeNullKeyDefaultExtrastrvarchar(255)YESNULLintint(11)YESNULLfloatfloatYESNULLdatetimedatetimeYESNULLbooleantinyint(1)YESNULLç­”æ¡ˆé€šè¿‡åˆ†æžï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“åœ¨æ‰§è¡Œto_sqlçš„æ–¹æ³•æ—¶ï¼Œå¯ä»¥é€šè¿‡åˆ›å»ºä¸€ä¸ªç±»ä¼¼â€œ{â€œcolumn_nameâ€ï¼šsqlalchemy_type}â€çš„æ˜ å°„ç»“æž„æ¥æŽ§åˆ¶æ•°æ®åº“ä¸­è¡¨çš„åˆ—ç±»åž‹ã€‚ä½†åœ¨å®žé™…ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬æ›´å¸Œæœ›èƒ½é€šè¿‡pandas.DataFrameä¸­çš„columnçš„æ•°æ®ç±»åž‹æ¥æ˜ å°„æ•°æ®åº“ä¸­çš„åˆ—ç±»åž‹ï¼Œè€Œä¸æ˜¯æ¯æ­¤éƒ½è¦åˆ—å‡ºpandas.DataFrameçš„columnåå­—ã€‚å†™ä¸€ä¸ªç®€å•çš„defå°†pandas.DataFrameä¸­åˆ—åå’Œé¢„æŒ‡å®šçš„ç±»åž‹æ˜ å°„èµ·æ¥å³å¯ï¼š12345678910def mapping_df_types(df): dtypedict = &#123;&#125; for i, j in zip(df.columns, df.dtypes): if "object" in str(j): dtypedict.update(&#123;i: NVARCHAR(length=255)&#125;) if "float" in str(j): dtypedict.update(&#123;i: Float(precision=2, asdecimal=True)&#125;) if "int" in str(j): dtypedict.update(&#123;i: Integer()&#125;) return dtypedictåªè¦åœ¨æ‰§è¡Œto_sqlå‰ä½¿ç”¨æ­¤æ–¹æ³•èŽ·å¾—ä¸€ä¸ªæ˜ å°„dictå†èµ‹å€¼ç»™to_sqlçš„dtypeå‚æ•°å³å¯ï¼Œæ‰§è¡Œçš„ç»“æžœä¸Žä¸Šä¸€èŠ‚ç›¸åŒï¼Œä¸å†ç´¯è¿°ã€‚1234df = pd.DataFrame([['a', 1, 1, 2.0, datetime.now(), True]], columns=['str', 'int', 'float', 'datetime', 'boolean'])dtypedict = mapping_df_types(df)df.to_sql(name='test', con=con, if_exists='append', index=False, dtype=dtypedict)å‚è€ƒ[^footnote]pandaså®˜æ–¹æ–‡æ¡£]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>pandas</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯çŸ¥è¯†æ±‡æ€»]]></title>
    <url>%2F2019%2F12%2F31%2F%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86%E6%B1%87%E6%80%BB%2F</url>
    <content type="text"><![CDATA[1. å‰ç«¯å¼€å‘æ¦‚è¿°åŒ…æ‹¬htmlã€cssã€PCç«¯åŠç§»åŠ¨ç«¯å¸ƒå±€æŠ€å·§ã€javascriptã€jqueryã€jsç‰¹æ•ˆåˆ¶ä½œã€ajaxå‰åŽå°äº¤äº’ç­‰ã€‚1.1 ä»€ä¹ˆæ˜¯å‰ç«¯å¼€å‘ï¼Ÿå‰ç«¯å¼€å‘ä¹Ÿå«åšwebå‰ç«¯å¼€å‘ï¼Œå®ƒæŒ‡çš„æ˜¯åŸºäºŽwebçš„äº’è”ç½‘äº§å“çš„é¡µé¢(ä¹Ÿå¯å«ç•Œé¢)å¼€å‘åŠåŠŸèƒ½å¼€å‘ã€‚1.2 ä»€ä¹ˆäº’è”ç½‘äº§å“ï¼Ÿäº’è”ç½‘äº§å“å°±æ˜¯æŒ‡ç½‘ç«™ä¸ºæ»¡è¶³ç”¨æˆ·éœ€æ±‚è€Œåˆ›å»ºçš„ç”¨äºŽè¿è¥çš„åŠŸèƒ½åŠæœåŠ¡ï¼Œç™¾åº¦æœç´¢ã€æ·˜å®ã€QQã€å¾®åšã€ç½‘æ˜“é‚®ç®±ç­‰éƒ½æ˜¯äº’è”ç½‘äº§å“ã€‚1.3 äº’è”ç½‘äº§å“å¼€å‘æµç¨‹åŠå‰ç«¯å¼€å‘å²—ä½ï¼Ÿ1.4 å‰ç«¯å¼€å‘éœ€è¦å“ªäº›æŠ€æœ¯ï¼Ÿå‰ç«¯å·¥ç¨‹å¸ˆå‚ç…§äº§å“çš„æ•ˆæžœå›¾æ¥å¼€å‘é¡µé¢(ä¹Ÿå¯å«ç•Œé¢)ï¼Œæ•ˆæžœå›¾æ˜¯ç”±UIè®¾è®¡å¸ˆç”¨Photoshop(å°‘é‡è®¾è®¡å¸ˆç”¨firework)æ¥è®¾è®¡çš„ï¼Œä¸ºäº†æ–¹ä¾¿ä¸ŽUIè®¾è®¡å¸ˆå¯¹æŽ¥å·¥ä½œï¼Œå‰ç«¯éœ€è¦æŽŒæ¡ä¸€äº›Photoshopçš„æŠ€èƒ½ï¼ŒPhotoshopè¿˜å¯ä»¥è¾…åŠ©é¡µé¢å¼€å‘ã€‚æŠŠæ•ˆæžœå›¾å¸ƒå±€æˆé¡µé¢ï¼Œéœ€è¦ç”¨åˆ°HTMLè¯­è¨€å’ŒCSSè¯­è¨€ï¼Œé¡µé¢åŠŸèƒ½çš„å¼€å‘éœ€è¦ç”¨åˆ°javascript,ä¸ºäº†å¿«é€Ÿå¼€å‘å’Œç³»ç»Ÿå¼€å‘ï¼Œè¿˜éœ€è¦å­¦ä¹ ä¸€äº›å‰ç«¯çš„javascriptåº“å’Œæ¡†æž¶ã€‚2. HTML2.1 htmlæ¦‚è¿°å’ŒåŸºæœ¬ç»“æž„2.1.1 htmlæ¦‚è¿°HTMLæ˜¯ HyperText Mark-up Language çš„é¦–å­—æ¯ç®€å†™ï¼Œæ„æ€æ˜¯è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ï¼Œè¶…æ–‡æœ¬æŒ‡çš„æ˜¯è¶…é“¾æŽ¥ï¼Œæ ‡è®°æŒ‡çš„æ˜¯æ ‡ç­¾ï¼Œæ˜¯ä¸€ç§ç”¨æ¥åˆ¶ä½œç½‘é¡µçš„è¯­è¨€ï¼Œè¿™ç§è¯­è¨€ç”±ä¸€ä¸ªä¸ªçš„æ ‡ç­¾ç»„æˆï¼Œç”¨è¿™ç§è¯­è¨€åˆ¶ä½œçš„æ–‡ä»¶ä¿å­˜çš„æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œæ–‡ä»¶çš„æ‰©å±•åä¸ºhtmlæˆ–è€…htmï¼Œä¸€ä¸ªhtmlæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªç½‘é¡µï¼Œhtmlæ–‡ä»¶ç”¨ç¼–è¾‘å™¨æ‰“å¼€æ˜¾ç¤ºçš„æ˜¯æ–‡æœ¬ï¼Œå¯ä»¥ç”¨æ–‡æœ¬çš„æ–¹å¼ç¼–è¾‘å®ƒï¼Œå¦‚æžœç”¨æµè§ˆå™¨æ‰“å¼€ï¼Œæµè§ˆå™¨ä¼šæŒ‰ç…§æ ‡ç­¾æè¿°å†…å®¹å°†æ–‡ä»¶æ¸²æŸ“æˆç½‘é¡µï¼Œæ˜¾ç¤ºçš„ç½‘é¡µå¯ä»¥ä»Žä¸€ä¸ªç½‘é¡µé“¾æŽ¥è·³è½¬åˆ°å¦å¤–ä¸€ä¸ªç½‘é¡µã€‚2.1.2 htmlåŸºæœ¬ç»“æž„ä¸€ä¸ªhtmlçš„åŸºæœ¬ç»“æž„å¦‚ä¸‹ï¼š12345678910&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt; &lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;ç½‘é¡µæ ‡é¢˜&lt;/title&gt; &lt;/head&gt; &lt;body&gt; ç½‘é¡µæ˜¾ç¤ºå†…å®¹ &lt;/body&gt;&lt;/html&gt;ç¬¬ä¸€è¡Œæ˜¯æ–‡æ¡£å£°æ˜Žï¼Œç¬¬äºŒè¡Œâ€œâ€æ ‡ç­¾å’Œæœ€åŽä¸€è¡Œâ€œâ€å®šä¹‰htmlæ–‡æ¡£çš„æ•´ä½“ï¼Œâ€œâ€æ ‡ç­¾ä¸­çš„â€˜lang=â€œenâ€â€™å®šä¹‰ç½‘é¡µçš„è¯­è¨€ä¸ºè‹±æ–‡ï¼Œå®šä¹‰æˆä¸­æ–‡æ˜¯â€™lang=â€zh-CNâ€â€˜,ä¸å®šä¹‰ä¹Ÿæ²¡ä»€ä¹ˆå½±å“ï¼Œå®ƒä¸€èˆ¬ä½œä¸ºåˆ†æžç»Ÿè®¡ç”¨ã€‚ â€œâ€æ ‡ç­¾å’Œâ€œâ€æ ‡ç­¾æ˜¯å®ƒçš„ç¬¬ä¸€å±‚å­å…ƒç´ ï¼Œâ€œâ€æ ‡ç­¾é‡Œé¢è´Ÿè´£å¯¹ç½‘é¡µè¿›è¡Œä¸€äº›è®¾ç½®ä»¥åŠå®šä¹‰æ ‡é¢˜ï¼Œè®¾ç½®åŒ…æ‹¬å®šä¹‰ç½‘é¡µçš„ç¼–ç æ ¼å¼ï¼Œå¤–é“¾cssæ ·å¼æ–‡ä»¶å’Œjavascriptæ–‡ä»¶ç­‰ï¼Œè®¾ç½®çš„å†…å®¹ä¸ä¼šæ˜¾ç¤ºåœ¨ç½‘é¡µä¸Šï¼Œæ ‡é¢˜çš„å†…å®¹ä¼šæ˜¾ç¤ºåœ¨æ ‡é¢˜ï¼Œâ€œâ€å†…ç¼–å†™ç½‘é¡µä¸Šæ˜¾ç¤ºçš„å†…å®¹ã€‚L2Dwidget.init({log:!1,pluginJsPath:"lib/",pluginModelPath:"assets/",pluginRootPath:"live2dw/",tagMode:!1})2.1.3 HTMLæ–‡æ¡£ç±»åž‹ç›®å‰å¸¸ç”¨çš„ä¸¤ç§æ–‡æ¡£ç±»åž‹æ˜¯xhtml 1.0å’Œhtml5xhtml 1.0xhtml 1.0 æ˜¯html5ä¹‹å‰çš„ä¸€ä¸ªå¸¸ç”¨çš„ç‰ˆæœ¬ï¼Œç›®å‰è®¸å¤šç½‘ç«™ä»ç„¶ä½¿ç”¨æ­¤ç‰ˆæœ¬ã€‚æ­¤ç‰ˆæœ¬æ–‡æ¡£ç”¨sublime textåˆ›å»ºæ–¹æ³•ï¼š html:xt + tabæ–‡æ¡£ç¤ºä¾‹ï¼š12345678910&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;&lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"&gt;&lt;head&gt; &lt;meta http-equiv="Content-Type" content="text/html;charset=UTF-8"&gt; &lt;title&gt; xhtml 1.0 æ–‡æ¡£ç±»åž‹ &lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;html5pcç«¯å¯ä»¥ä½¿ç”¨xhtml 1.0ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨html5ï¼Œhtml5æ˜¯å‘ä¸‹å…¼å®¹çš„æ­¤ç‰ˆæœ¬æ–‡æ¡£ç”¨sublime textåˆ›å»ºæ–¹æ³•ï¼š html:5 + tab æˆ–è€… ! + tabæ–‡æ¡£ç¤ºä¾‹ï¼š12345678910&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt; html5æ–‡æ¡£ç±»åž‹ &lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;ä¸¤ç§æ–‡æ¡£çš„åŒºåˆ«1ã€æ–‡æ¡£å£°æ˜Žå’Œç¼–ç å£°æ˜Ž2ã€html5æ–°å¢žäº†æ ‡ç­¾å…ƒç´ ä»¥åŠå…ƒç´ å±žæ€§htmlæ³¨é‡Šhtmlæ–‡æ¡£ä»£ç ä¸­å¯ä»¥æ’å…¥æ³¨é‡Šï¼Œæ³¨é‡Šæ˜¯å¯¹ä»£ç çš„è¯´æ˜Žå’Œè§£é‡Šï¼Œæ³¨é‡Šçš„å†…å®¹ä¸ä¼šæ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œhtmlä»£ç ä¸­æ’å…¥æ³¨é‡Šçš„æ–¹æ³•æ˜¯ï¼š1&lt;!-- è¿™æ˜¯ä¸€æ®µæ³¨é‡Š --&gt;2.2 htmlæ ‡é¢˜æ ‡ç­¾é€šè¿‡ &lt;h1&gt;ã€&lt;h2&gt;ã€&lt;h3&gt;ã€&lt;h4&gt;ã€&lt;h5&gt;ã€&lt;h6&gt;,æ ‡ç­¾å¯ä»¥åœ¨ç½‘é¡µä¸Šå®šä¹‰6ç§çº§åˆ«çš„æ ‡é¢˜ã€‚6ç§çº§åˆ«çš„æ ‡é¢˜è¡¨ç¤ºæ–‡æ¡£çš„6çº§ç›®å½•å±‚çº§å…³ç³»ï¼Œæ¯”å¦‚è¯´ï¼š &lt;h1&gt;ç”¨ä½œä¸»æ ‡é¢˜ï¼Œå…¶åŽæ˜¯ &lt;h2&gt;ï¼Œå†å…¶æ¬¡æ˜¯ &lt;h3&gt;ï¼Œä»¥æ­¤ç±»æŽ¨ã€‚æœç´¢å¼•æ“Žä¼šä½¿ç”¨æ ‡é¢˜å°†ç½‘é¡µçš„ç»“æž„å’Œå†…å®¹ç¼–åˆ¶ç´¢å¼•ï¼Œæ‰€ä»¥ç½‘é¡µä¸Šä½¿ç”¨æ ‡é¢˜æ˜¯å¾ˆé‡è¦çš„ã€‚123&lt;h1&gt;è¿™æ˜¯ä¸€çº§æ ‡é¢˜&lt;/h1&gt;&lt;h2&gt;è¿™æ˜¯äºŒçº§æ ‡é¢˜&lt;/h2&gt;&lt;h3&gt;è¿™æ˜¯ä¸‰çº§æ ‡é¢˜&lt;/h3&gt;2.3 htmlæ®µè½æ ‡ç­¾ã€æ¢è¡Œæ ‡ç­¾ä¸Žå­—ç¬¦å®žä½“2.3.1 htmlæ®µè½æ ‡ç­¾&lt;p&gt;æ ‡ç­¾å®šä¹‰ä¸€ä¸ªæ–‡æœ¬æ®µè½ï¼Œä¸€ä¸ªæ®µè½å«æœ‰é»˜è®¤çš„ä¸Šä¸‹é—´è·ï¼Œæ®µè½ä¹‹é—´ä¼šç”¨è¿™ç§é»˜è®¤é—´è·éš”å¼€ï¼Œä»£ç å¦‚ä¸‹ï¼š1234567891011121314151617&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;æ®µè½&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;p&gt;HTMLæ˜¯ HyperText Mark-up Language çš„é¦–å­—æ¯ç®€å†™ï¼Œæ„æ€æ˜¯è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ï¼Œè¶… æ–‡æœ¬æŒ‡çš„æ˜¯è¶…é“¾æŽ¥ï¼Œæ ‡è®°æŒ‡çš„æ˜¯æ ‡ç­¾ï¼Œæ˜¯ä¸€ç§ç”¨æ¥åˆ¶ä½œç½‘é¡µçš„è¯­è¨€ï¼Œè¿™ç§è¯­è¨€ç”±ä¸€ä¸ªä¸ªçš„ æ ‡ç­¾ç»„æˆï¼Œç”¨è¿™ç§è¯­è¨€åˆ¶ä½œçš„æ–‡ä»¶ä¿å­˜çš„æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œæ–‡ä»¶çš„æ‰©å±•åä¸ºhtmlæˆ–è€…htmã€‚ &lt;/p&gt; &lt;p&gt;ä¸€ä¸ªhtmlæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªç½‘é¡µï¼Œhtmlæ–‡ä»¶ç”¨ç¼–è¾‘å™¨æ‰“å¼€æ˜¾ç¤ºçš„æ˜¯æ–‡æœ¬ï¼Œå¯ä»¥ç”¨æ–‡æœ¬çš„æ–¹ å¼ç¼–è¾‘å®ƒï¼Œå¦‚æžœç”¨æµè§ˆå™¨æ‰“å¼€ï¼Œæµè§ˆå™¨ä¼šæŒ‰ç…§æ ‡ç­¾æè¿°å†…å®¹å°†æ–‡ä»¶æ¸²æŸ“æˆç½‘é¡µï¼Œæ˜¾ç¤ºçš„ç½‘ é¡µå¯ä»¥ä»Žä¸€ä¸ªç½‘é¡µé“¾æŽ¥è·³è½¬åˆ°å¦å¤–ä¸€ä¸ªç½‘é¡µã€‚&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;2.3.2 htmlæ¢è¡Œæ ‡ç­¾ä»£ç ä¸­æˆæ®µçš„æ–‡å­—ï¼Œç›´æŽ¥åœ¨ä»£ç ä¸­å›žè½¦æ¢è¡Œï¼Œåœ¨æ¸²æŸ“æˆç½‘é¡µæ—¶å€™ä¸è®¤è¿™ç§æ¢è¡Œï¼Œå¦‚æžœçœŸæƒ³æ¢è¡Œï¼Œå¯ä»¥åœ¨ä»£ç çš„æ®µè½ä¸­æ’å…¥&lt;br /&gt;æ¥å¼ºåˆ¶æ¢è¡Œï¼Œä»£ç å¦‚ä¸‹ï¼š12345&lt;p&gt;ä¸€ä¸ªhtmlæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªç½‘é¡µï¼Œhtmlæ–‡ä»¶ç”¨ç¼–è¾‘å™¨æ‰“å¼€æ˜¾ç¤ºçš„æ˜¯æ–‡æœ¬ï¼Œå¯ä»¥ç”¨&lt;br /&gt;æ–‡æœ¬çš„æ–¹å¼ç¼–è¾‘å®ƒï¼Œå¦‚æžœç”¨æµè§ˆå™¨æ‰“å¼€ï¼Œæµè§ˆå™¨ä¼šæŒ‰ç…§æ ‡ç­¾æè¿°å†…å®¹å°†æ–‡ä»¶&lt;br /&gt;æ¸²æŸ“æˆç½‘é¡µï¼Œæ˜¾ç¤ºçš„ç½‘é¡µå¯ä»¥ä»Žä¸€ä¸ªç½‘é¡µé“¾æŽ¥è·³è½¬åˆ°å¦å¤–ä¸€ä¸ªç½‘é¡µã€‚&lt;/p&gt;2.3.3 htmlå­—ç¬¦å®žä½“ä»£ç ä¸­æˆæ®µçš„æ–‡å­—ï¼Œå¦‚æžœæ–‡å­—é—´æƒ³ç©ºå¤šä¸ªç©ºæ ¼ï¼Œåœ¨ä»£ç ä¸­ç©ºå¤šä¸ªç©ºæ ¼ï¼Œåœ¨æ¸²æŸ“æˆç½‘é¡µæ—¶åªä¼šæ˜¾ç¤ºä¸€ä¸ªç©ºæ ¼ï¼Œå¦‚æžœæƒ³æ˜¾ç¤ºå¤šä¸ªç©ºæ ¼ï¼Œå¯ä»¥ä½¿ç”¨ç©ºæ ¼çš„å­—ç¬¦å®žä½“,ä»£ç å¦‚ä¸‹ï¼š12345&lt;!-- åœ¨æ®µè½å‰æƒ³ç¼©è¿›ä¸¤ä¸ªæ–‡å­—çš„ç©ºæ ¼ï¼Œä½¿ç”¨ç©ºæ ¼çš„å­—ç¬¦å®žä½“ï¼š&amp;nbsp; --&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;ä¸€ä¸ªhtmlæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªç½‘é¡µï¼Œhtmlæ–‡ä»¶ç”¨ç¼–è¾‘å™¨æ‰“å¼€æ˜¾ç¤ºçš„æ˜¯æ–‡æœ¬ï¼Œå¯ä»¥ç”¨&lt;br /&gt;æ–‡æœ¬çš„æ–¹å¼ç¼–è¾‘å®ƒï¼Œå¦‚æžœç”¨æµè§ˆå™¨æ‰“å¼€ï¼Œæµè§ˆå™¨ä¼šæŒ‰ç…§æ ‡ç­¾æè¿°å†…å®¹å°†æ–‡ä»¶&lt;br /&gt;æ¸²æŸ“æˆç½‘é¡µï¼Œæ˜¾ç¤ºçš„ç½‘é¡µå¯ä»¥ä»Žä¸€ä¸ªç½‘é¡µé“¾æŽ¥è·³è½¬åˆ°å¦å¤–ä¸€ä¸ªç½‘é¡µã€‚&lt;/p&gt;åœ¨ç½‘é¡µä¸Šæ˜¾ç¤º â€œ&lt;â€ å’Œ â€œ&gt;â€ ä¼šè¯¯è®¤ä¸ºæ˜¯æ ‡ç­¾ï¼Œæƒ³åœ¨ç½‘é¡µä¸Šæ˜¾ç¤ºâ€œ&lt;â€å’Œâ€œ&gt;â€å¯ä»¥ä½¿ç”¨å®ƒä»¬çš„å­—ç¬¦å®žä½“ï¼Œæ¯”å¦‚ï¼š12345&lt;!-- â€œ&lt;â€ å’Œ â€œ&gt;â€ çš„å­—ç¬¦å®žä½“ä¸º &amp;lt; å’Œ &amp;gt; --&gt;&lt;p&gt; 3 &amp;lt; 5 &lt;br&gt; 10 &amp;gt; 5&lt;/p&gt;2.4 htmlå—æ ‡ç­¾ã€å«æ ·å¼çš„æ ‡ç­¾2.4.1 htmlå—æ ‡ç­¾1ã€&lt;div&gt; æ ‡ç­¾ å—å…ƒç´ ï¼Œè¡¨ç¤ºä¸€å—å†…å®¹ï¼Œæ²¡æœ‰ä»»ä½•æ ·å¼ï¼Œä¸è¡¨ç¤ºå…·ä½“çš„è¯­ä¹‰ï¼Œé‡Œé¢å¯ä»¥åµŒå¥—å…¶ä»–æ ‡ç­¾ã€‚2ã€&lt;span&gt; æ ‡ç­¾ è¡Œå†…å…ƒç´ ï¼Œè¡¨ç¤ºä¸€è¡Œä¸­çš„ä¸€å°æ®µå†…å®¹ï¼Œæ²¡æœ‰å…·ä½“çš„è¯­ä¹‰ã€‚2.4.2 å«æ ·å¼å’Œè¯­ä¹‰çš„æ ‡ç­¾1ã€&lt;em&gt; æ ‡ç­¾ è¡Œå†…å…ƒç´ ï¼Œè¡¨ç¤ºè¯­æ°”ä¸­çš„å¼ºè°ƒè¯2ã€&lt;i&gt; æ ‡ç­¾ è¡Œå†…å…ƒç´ ï¼Œè¡¨ç¤ºä¸“ä¸šè¯æ±‡3ã€&lt;b&gt; æ ‡ç­¾ è¡Œå†…å…ƒç´ ï¼Œè¡¨ç¤ºæ–‡æ¡£ä¸­çš„å…³é”®å­—æˆ–è€…äº§å“å4ã€&lt;strong&gt; æ ‡ç­¾ è¡Œå†…å…ƒç´ ï¼Œè¡¨ç¤ºéžå¸¸é‡è¦çš„å†…å®¹2.4.3 è¯­ä¹‰åŒ–çš„æ ‡ç­¾è¯­ä¹‰åŒ–çš„æ ‡ç­¾ï¼Œå°±æ˜¯åœ¨å¸ƒå±€çš„æ—¶å€™å¤šä½¿ç”¨æœ‰è¯­ä¹‰çš„æ ‡ç­¾ï¼Œæœç´¢å¼•æ“Žåœ¨çˆ¬ç½‘çš„æ—¶å€™èƒ½è®¤è¯†è¿™äº›æ ‡ç­¾ï¼Œç†è§£æ–‡æ¡£çš„ç»“æž„ï¼Œæ–¹ä¾¿ç½‘ç«™çš„æ”¶å½•ã€‚æ¯”å¦‚ï¼šh1æ ‡ç­¾æ˜¯è¡¨ç¤ºæ ‡é¢˜ï¼Œpæ ‡ç­¾æ˜¯è¡¨ç¤ºæ®µè½ï¼Œulã€liæ ‡ç­¾æ˜¯è¡¨ç¤ºåˆ—è¡¨ï¼Œaæ ‡ç­¾è¡¨ç¤ºé“¾æŽ¥ï¼Œdlã€dtã€ddè¡¨ç¤ºå®šä¹‰åˆ—è¡¨ç­‰ï¼Œè¯­ä¹‰åŒ–çš„æ ‡ç­¾ä¸å¤šã€‚2.5 htmlå›¾åƒæ ‡ç­¾ã€ç»å¯¹è·¯å¾„å’Œç›¸å¯¹è·¯å¾„2.5.1 htmlå›¾åƒæ ‡ç­¾&lt;img&gt;æ ‡ç­¾å¯ä»¥åœ¨ç½‘é¡µä¸Šæ’å…¥ä¸€å¼ å›¾ç‰‡ï¼Œå®ƒæ˜¯ç‹¬ç«‹ä½¿ç”¨çš„æ ‡ç­¾ï¼Œå®ƒçš„å¸¸ç”¨å±žæ€§æœ‰ï¼šsrcå±žæ€§ å®šä¹‰å›¾ç‰‡çš„å¼•ç”¨åœ°å€altå±žæ€§ å®šä¹‰å›¾ç‰‡åŠ è½½å¤±è´¥æ—¶æ˜¾ç¤ºçš„æ–‡å­—ï¼Œæœç´¢å¼•æ“Žä¼šä½¿ç”¨è¿™ä¸ªæ–‡å­—æ”¶å½•å›¾ç‰‡ã€ç›²äººè¯»å±è½¯ä»¶ä¼šè¯»å–è¿™ä¸ªæ–‡å­—è®©ç›²äººè¯†åˆ«å›¾ç‰‡ï¼Œæ‰€ä»¥æ­¤å±žæ€§éžå¸¸é‡è¦ã€‚1&lt;img src="images/pic.jpg" alt="äº§å“å›¾ç‰‡" /&gt;2.5.2 ç»å¯¹è·¯å¾„å’Œç›¸å¯¹è·¯å¾„åƒç½‘é¡µä¸Šæ’å…¥å›¾ç‰‡è¿™ç§å¤–éƒ¨æ–‡ä»¶ï¼Œéœ€è¦å®šä¹‰æ–‡ä»¶çš„å¼•ç”¨åœ°å€ï¼Œå¼•ç”¨å¤–éƒ¨æ–‡ä»¶è¿˜åŒ…æ‹¬å¼•ç”¨å¤–éƒ¨æ ·å¼è¡¨ï¼Œjavascriptç­‰ç­‰ï¼Œå¼•ç”¨åœ°å€åˆ†ä¸ºç»å¯¹åœ°å€å’Œç›¸å¯¹åœ°å€ã€‚ç»å¯¹åœ°å€ï¼šç›¸å¯¹äºŽç£ç›˜çš„ä½ç½®åŽ»å®šä½æ–‡ä»¶çš„åœ°å€ç›¸å¯¹åœ°å€ï¼šç›¸å¯¹äºŽå¼•ç”¨æ–‡ä»¶æœ¬èº«åŽ»å®šä½è¢«å¼•ç”¨çš„æ–‡ä»¶åœ°å€ç»å¯¹åœ°å€åœ¨æ•´ä½“æ–‡ä»¶è¿ç§»æ—¶ä¼šå› ä¸ºç£ç›˜å’Œé¡¶å±‚ç›®å½•çš„æ”¹å˜è€Œæ‰¾ä¸åˆ°æ–‡ä»¶ï¼Œç›¸å¯¹è·¯å¾„å°±æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚ç›¸å¯¹è·¯å¾„çš„å®šä¹‰æŠ€å·§ï¼šâ€œ ./ â€ è¡¨ç¤ºå½“å‰æ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸‹ï¼Œæ¯”å¦‚ï¼šâ€œ./pic.jpgâ€ è¡¨ç¤ºå½“å‰ç›®å½•ä¸‹çš„pic.jpgçš„å›¾ç‰‡ï¼Œè¿™ä¸ªä½¿ç”¨æ—¶å¯ä»¥çœç•¥ã€‚â€œ ../ â€ è¡¨ç¤ºå½“å‰æ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸‹çš„ä¸Šä¸€çº§ç›®å½•ï¼Œæ¯”å¦‚ï¼šâ€œ../images/pic.jpgâ€ è¡¨ç¤ºå½“å‰ç›®å½•ä¸‹çš„ä¸Šä¸€çº§ç›®å½•ä¸‹çš„imagesæ–‡ä»¶å¤¹ä¸­çš„pic.jpgçš„å›¾ç‰‡ã€‚2.6 htmlé“¾æŽ¥æ ‡ç­¾æ ‡ç­¾å¯ä»¥åœ¨ç½‘é¡µä¸Šå®šä¹‰ä¸€ä¸ªé“¾æŽ¥åœ°å€ï¼Œå®ƒçš„å¸¸ç”¨å±žæ€§æœ‰ï¼šhrefå±žæ€§ å®šä¹‰è·³è½¬çš„åœ°å€titleå±žæ€§ å®šä¹‰é¼ æ ‡æ‚¬åœæ—¶å¼¹å‡ºçš„æç¤ºæ–‡å­—æ¡†targetå±žæ€§ å®šä¹‰é“¾æŽ¥çª—å£æ‰“å¼€çš„ä½ç½®target=â€_selfâ€ ç¼ºçœå€¼ï¼Œæ–°é¡µé¢æ›¿æ¢åŽŸæ¥çš„é¡µé¢ï¼Œåœ¨åŽŸæ¥ä½ç½®æ‰“å¼€target=â€_blankâ€ æ–°é¡µé¢ä¼šåœ¨æ–°å¼€çš„ä¸€ä¸ªæµè§ˆå™¨çª—å£æ‰“å¼€123&lt;a href="#"&gt;&lt;/a&gt; &lt;!-- # è¡¨ç¤ºé“¾æŽ¥åˆ°é¡µé¢é¡¶éƒ¨ --&gt;&lt;a href="https://www.baidu.com/" title="è·³è½¬çš„ç™¾åº¦ç½‘ç«™"&gt;ç™¾åº¦ä¸€ä¸‹&lt;/a&gt;&lt;a href="2.html" target="_blank"&gt;æµ‹è¯•é¡µé¢2&lt;/a&gt;2.7 htmlåˆ—è¡¨æ ‡ç­¾2.7.1 æœ‰åºåˆ—è¡¨åœ¨ç½‘é¡µä¸Šå®šä¹‰ä¸€ä¸ªæœ‰ç¼–å·çš„å†…å®¹åˆ—è¡¨å¯ä»¥ç”¨&lt;ol&gt;ã€&lt;li&gt;é…åˆä½¿ç”¨æ¥å®žçŽ°ï¼Œä»£ç å¦‚ä¸‹ï¼š12345&lt;ol&gt; &lt;li&gt;åˆ—è¡¨æ–‡å­—ä¸€&lt;/li&gt; &lt;li&gt;åˆ—è¡¨æ–‡å­—äºŒ&lt;/li&gt; &lt;li&gt;åˆ—è¡¨æ–‡å­—ä¸‰&lt;/li&gt;&lt;/ol&gt;åœ¨ç½‘é¡µä¸Šç”Ÿæˆçš„åˆ—è¡¨ï¼Œæ¯æ¡é¡¹ç›®ä¸Šä¼šæŒ‰1ã€2ã€3ç¼–å·ï¼Œæœ‰åºåˆ—è¡¨åœ¨å®žé™…å¼€å‘ä¸­è¾ƒå°‘ä½¿ç”¨ã€‚2.7.2 æ— åºåˆ—è¡¨åœ¨ç½‘é¡µä¸Šå®šä¹‰ä¸€ä¸ªæ— ç¼–å·çš„å†…å®¹åˆ—è¡¨å¯ä»¥ç”¨&lt;ul&gt;ã€&lt;li&gt;é…åˆä½¿ç”¨æ¥å®žçŽ°ï¼Œä»£ç å¦‚ä¸‹ï¼š12345&lt;ul&gt; &lt;li&gt;&lt;a href="#"&gt;æ–°é—»æ ‡é¢˜ä¸€&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;æ–°é—»æ ‡é¢˜äºŒ&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;æ–°é—»æ ‡é¢˜ä¸‰&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;åœ¨ç½‘é¡µä¸Šç”Ÿæˆçš„åˆ—è¡¨ï¼Œæ¯æ¡é¡¹ç›®ä¸Šä¼šæœ‰ä¸€ä¸ªå°å›¾æ ‡ï¼Œè¿™ä¸ªå°å›¾æ ‡åœ¨ä¸åŒæµè§ˆå™¨ä¸Šæ˜¾ç¤ºæ•ˆæžœä¸åŒï¼Œæ‰€ä»¥ä¸€èˆ¬ä¼šç”¨æ ·å¼åŽ»æŽ‰é»˜è®¤çš„å°å›¾æ ‡ï¼Œå¦‚æžœéœ€è¦å›¾æ ‡ï¼Œå¯ä»¥ç”¨æ ·å¼è‡ªå®šä¹‰å›¾æ ‡ï¼Œä»Žè€Œè¾¾åˆ°åœ¨ä¸åŒæµè§ˆå™¨ä¸Šæ˜¾ç¤ºçš„æ•ˆæžœç›¸åŒ,å®žé™…å¼€å‘ä¸­ä¸€èˆ¬ç”¨è¿™ç§åˆ—è¡¨ã€‚å®šä¹‰åˆ—è¡¨é€šå¸¸ç”¨äºŽæœ¯è¯­çš„å®šä¹‰ã€‚æ ‡ç­¾è¡¨ç¤ºåˆ—è¡¨çš„æ•´ä½“ã€‚æ ‡ç­¾å®šä¹‰æœ¯è¯­çš„é¢˜ç›®ã€‚æ ‡ç­¾æ˜¯æœ¯è¯­çš„è§£é‡Šã€‚ä¸€ä¸ªä¸­å¯ä»¥æœ‰å¤šä¸ªé¢˜ç›®å’Œè§£é‡Šï¼Œä»£ç å¦‚ä¸‹ï¼š1234567891011&lt;h3&gt;å‰ç«¯ä¸‰å¤§å—&lt;/h3&gt;&lt;dl&gt; &lt;dt&gt;html&lt;/dt&gt; &lt;dd&gt;è´Ÿè´£é¡µé¢çš„ç»“æž„&lt;/dd&gt; &lt;dt&gt;css&lt;/dt&gt; &lt;dd&gt;è´Ÿè´£é¡µé¢çš„è¡¨çŽ°&lt;/dd&gt; &lt;dt&gt;javascript&lt;/dt&gt; &lt;dd&gt;è´Ÿè´£é¡µé¢çš„è¡Œä¸º&lt;/dd&gt;&lt;/dl&gt;2.8 htmlè¡¨å•è¡¨å•ç”¨äºŽæœé›†ä¸åŒç±»åž‹çš„ç”¨æˆ·è¾“å…¥ï¼Œè¡¨å•ç”±ä¸åŒç±»åž‹çš„æ ‡ç­¾ç»„æˆï¼Œç›¸å…³æ ‡ç­¾åŠå±žæ€§ç”¨æ³•å¦‚ä¸‹ï¼š1ã€&lt;form&gt;æ ‡ç­¾ å®šä¹‰æ•´ä½“çš„è¡¨å•åŒºåŸŸactionå±žæ€§ å®šä¹‰è¡¨å•æ•°æ®æäº¤åœ°å€methodå±žæ€§ å®šä¹‰è¡¨å•æäº¤çš„æ–¹å¼ï¼Œä¸€èˆ¬æœ‰â€œgetâ€æ–¹å¼å’Œâ€œpostâ€æ–¹å¼2ã€&lt;label&gt;æ ‡ç­¾ ä¸ºè¡¨å•å…ƒç´ å®šä¹‰æ–‡å­—æ ‡æ³¨3ã€&lt;input&gt;æ ‡ç­¾ å®šä¹‰é€šç”¨çš„è¡¨å•å…ƒç´ typeå±žæ€§type=â€textâ€ å®šä¹‰å•è¡Œæ–‡æœ¬è¾“å…¥æ¡†type=â€passwordâ€ å®šä¹‰å¯†ç è¾“å…¥æ¡†type=â€radioâ€ å®šä¹‰å•é€‰æ¡†type=â€checkboxâ€ å®šä¹‰å¤é€‰æ¡†type=â€fileâ€ å®šä¹‰ä¸Šä¼ æ–‡ä»¶type=â€submitâ€ å®šä¹‰æäº¤æŒ‰é’®type=â€resetâ€ å®šä¹‰é‡ç½®æŒ‰é’®type=â€buttonâ€ å®šä¹‰ä¸€ä¸ªæ™®é€šæŒ‰é’®type=â€imageâ€ å®šä¹‰å›¾ç‰‡ä½œä¸ºæäº¤æŒ‰é’®ï¼Œç”¨srcå±žæ€§å®šä¹‰å›¾ç‰‡åœ°å€type=â€hiddenâ€ å®šä¹‰ä¸€ä¸ªéšè—çš„è¡¨å•åŸŸï¼Œç”¨æ¥å­˜å‚¨å€¼valueå±žæ€§ å®šä¹‰è¡¨å•å…ƒç´ çš„å€¼nameå±žæ€§ å®šä¹‰è¡¨å•å…ƒç´ çš„åç§°ï¼Œæ­¤åç§°æ˜¯æäº¤æ•°æ®æ—¶çš„é”®å4ã€&lt;textarea&gt;æ ‡ç­¾ å®šä¹‰å¤šè¡Œæ–‡æœ¬è¾“å…¥æ¡†5ã€&lt;select&gt;æ ‡ç­¾ å®šä¹‰ä¸‹æ‹‰è¡¨å•å…ƒç´ 6ã€&lt;option&gt;æ ‡ç­¾ ä¸Ž&lt;select&gt;æ ‡ç­¾é…åˆï¼Œå®šä¹‰ä¸‹æ‹‰è¡¨å•å…ƒç´ ä¸­çš„é€‰é¡¹2.8.1 æ³¨å†Œè¡¨å•å®žä¾‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344&lt;form action="http://www..." method="get"&gt;&lt;p&gt;&lt;label&gt;å§“åï¼š&lt;/label&gt;&lt;input type="text" name="username" /&gt;&lt;/p&gt;&lt;p&gt;&lt;label&gt;å¯†ç ï¼š&lt;/label&gt;&lt;input type="password" name="password" /&gt;&lt;/p&gt;&lt;p&gt;&lt;label&gt;æ€§åˆ«ï¼š&lt;/label&gt;&lt;input type="radio" name="gender" value="0" /&gt; ç”·&lt;input type="radio" name="gender" value="1" /&gt; å¥³&lt;/p&gt;&lt;p&gt;&lt;label&gt;çˆ±å¥½ï¼š&lt;/label&gt;&lt;input type="checkbox" name="like" value="sing" /&gt; å”±æ­Œ&lt;input type="checkbox" name="like" value="run" /&gt; è·‘æ­¥&lt;input type="checkbox" name="like" value="swiming" /&gt; æ¸¸æ³³&lt;/p&gt;&lt;p&gt;&lt;label&gt;ç…§ç‰‡ï¼š&lt;/label&gt;&lt;input type="file" name="person_pic"&gt;&lt;/p&gt;&lt;p&gt;&lt;label&gt;ä¸ªäººæè¿°ï¼š&lt;/label&gt;&lt;textarea name="about"&gt;&lt;/textarea&gt;&lt;/p&gt;&lt;p&gt;&lt;label&gt;ç±è´¯ï¼š&lt;/label&gt;&lt;select name="site"&gt; &lt;option value="0"&gt;åŒ—äº¬&lt;/option&gt; &lt;option value="1"&gt;ä¸Šæµ·&lt;/option&gt; &lt;option value="2"&gt;å¹¿å·ž&lt;/option&gt; &lt;option value="3"&gt;æ·±åœ³&lt;/option&gt;&lt;/select&gt;&lt;/p&gt;&lt;p&gt;&lt;input type="submit" name="" value="æäº¤"&gt;&lt;!-- inputç±»åž‹ä¸ºsubmitå®šä¹‰æäº¤æŒ‰é’® è¿˜å¯ä»¥ç”¨å›¾ç‰‡æŽ§ä»¶ä»£æ›¿submitæŒ‰é’®æäº¤ï¼Œä¸€èˆ¬ä¼šå¯¼è‡´æäº¤ä¸¤æ¬¡ï¼Œä¸å»ºè®®ä½¿ç”¨ã€‚å¦‚ï¼š &lt;input type="image" src="xxx.gif"&gt;--&gt;&lt;input type="reset" name="" value="é‡ç½®"&gt;&lt;/p&gt;&lt;/form&gt;2.9 htmlè¡¨æ ¼1ã€&lt;table&gt;æ ‡ç­¾ï¼šå£°æ˜Žä¸€ä¸ªè¡¨æ ¼ï¼Œå®ƒçš„å¸¸ç”¨å±žæ€§å¦‚ä¸‹ï¼šborderå±žæ€§ å®šä¹‰è¡¨æ ¼çš„è¾¹æ¡†ï¼Œè®¾ç½®å€¼æ˜¯æ•°å€¼cellpaddingå±žæ€§ å®šä¹‰å•å…ƒæ ¼å†…å®¹ä¸Žè¾¹æ¡†çš„è·ç¦»ï¼Œè®¾ç½®å€¼æ˜¯æ•°å€¼cellspacingå±žæ€§ å®šä¹‰å•å…ƒæ ¼ä¸Žå•å…ƒæ ¼ä¹‹é—´çš„è·ç¦»ï¼Œè®¾ç½®å€¼æ˜¯æ•°å€¼alignå±žæ€§ è®¾ç½®æ•´ä½“è¡¨æ ¼ç›¸å¯¹äºŽæµè§ˆå™¨çª—å£çš„æ°´å¹³å¯¹é½æ–¹å¼,è®¾ç½®å€¼æœ‰ï¼šleft | center | right ï¼Œé»˜è®¤left2ã€&lt;tr&gt;æ ‡ç­¾ï¼šå®šä¹‰è¡¨æ ¼ä¸­çš„ä¸€è¡Œ3ã€&lt;td&gt;å’Œ&lt;th&gt;æ ‡ç­¾ï¼šå®šä¹‰ä¸€è¡Œä¸­çš„ä¸€ä¸ªå•å…ƒæ ¼ï¼Œtdä»£è¡¨æ™®é€šå•å…ƒæ ¼ï¼Œthè¡¨ç¤ºè¡¨å¤´å•å…ƒæ ¼ï¼Œå®ƒä»¬çš„å¸¸ç”¨å±žæ€§å¦‚ä¸‹ï¼šalign è®¾ç½®å•å…ƒæ ¼ä¸­å†…å®¹çš„æ°´å¹³å¯¹é½æ–¹å¼,è®¾ç½®å€¼æœ‰ï¼šleft | center | right ï¼Œé»˜è®¤leftvalign è®¾ç½®å•å…ƒæ ¼ä¸­å†…å®¹çš„åž‚ç›´å¯¹é½æ–¹å¼ top | middle | bottom ï¼Œé»˜è®¤topcolspan è®¾ç½®å•å…ƒæ ¼æ°´å¹³åˆå¹¶ï¼Œè®¾ç½®å€¼æ˜¯æ•°å€¼rowspan è®¾ç½®å•å…ƒæ ¼åž‚ç›´åˆå¹¶ï¼Œè®¾ç½®å€¼æ˜¯æ•°å€¼è¡¨æ ¼åˆ¶ä½œç»ƒä¹ ï¼š12345678910111213141516171819202122232425262728293031323334353637&lt;h1&gt;è¡¨æ ¼&lt;/h1&gt;&lt;table border="1" width="600" height="300" align="center"&gt; &lt;tr&gt; &lt;td colspan="5"&gt;åŸºæœ¬æƒ…å†µ&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td width="25%"&gt;&lt;/td&gt; &lt;td width="15%"&gt;&lt;/td&gt; &lt;td width="25%"&gt;&lt;/td&gt; &lt;td width="15%"&gt;&lt;/td&gt; &lt;td rowspan="5" width="20%"&gt;&lt;img src="" alt="person"&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;å¿«é€Ÿåˆ›å»ºè¡¨æ ¼æ¡†æž¶123456789101112131415161718192021222324252627282930æ¯”å¦‚ï¼š1. è¾“å…¥tableåŽæŒ‰Tabé”®ï¼Œå°±ä¼šå‡ºæ¥ä¸€ä¸ª&lt;table&gt;&lt;/table&gt;2. è¾“å…¥table&gt;tråŽæŒ‰Tabé”®,å°±ä¼šå‡ºæ¥ä¸€ä¸ª&lt;table&gt; &lt;tr&gt;&lt;/tr&gt;&lt;/table&gt;3. è¾“å…¥table&gt;tr&gt;tdåŽæŒ‰Tabé”®,å°±ä¼šå‡ºæ¥ä¸€ä¸ª&lt;table&gt; &lt;tr&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;4. è¾“å…¥table&gt;tr&gt;td*2åŽæŒ‰Tabé”®,å°±ä¼šå‡ºæ¥ä¸€ä¸ª&lt;table&gt; &lt;tr&gt; &lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;5. è¾“å…¥table&gt;(tr&gt;td*2)*2åŽæŒ‰Tabé”®,å°±ä¼šå‡ºæ¥ä¸€ä¸ª&lt;table&gt; &lt;tr&gt; &lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;2.10 é¡µé¢å¸ƒå±€æ¦‚è¿°å¸ƒå±€ä¹Ÿå¯ä»¥å«åšæŽ’ç‰ˆï¼Œå®ƒæŒ‡çš„æ˜¯æŠŠæ–‡å­—å’Œå›¾ç‰‡ç­‰å…ƒç´ æŒ‰ç…§æˆ‘ä»¬çš„æ„æ„¿æœ‰æœºåœ°æŽ’åˆ—åœ¨é¡µé¢ä¸Šï¼Œå¸ƒå±€çš„æ–¹å¼åˆ†ä¸ºä¸¤ç§ï¼š1ã€tableå¸ƒå±€ï¼šé€šè¿‡tableå…ƒç´ å°†é¡µé¢ç©ºé—´åˆ’åˆ†æˆè‹¥å¹²ä¸ªå•å…ƒæ ¼ï¼Œå°†æ–‡å­—æˆ–å›¾ç‰‡ç­‰å…ƒç´ æ”¾å…¥å•å…ƒæ ¼ä¸­ï¼Œéšè—è¡¨æ ¼çš„è¾¹æ¡†ï¼Œä»Žè€Œå®žçŽ°å¸ƒå±€ã€‚è¿™ç§å¸ƒå±€æ–¹å¼ä¹Ÿå«ä¼ ç»Ÿå¸ƒå±€ï¼Œç›®å‰ä¸»è¦ä½¿ç”¨åœ¨EDM(å¹¿å‘Šé‚®ä»¶ä¸­çš„é¡µé¢)ä¸­ï¼Œä¸»æµçš„å¸ƒå±€æ–¹å¼ä¸ç”¨è¿™ç§ã€‚2ã€HTML+CSSå¸ƒå±€(DIV+CSS)ï¼šä¸»è¦é€šè¿‡CSSæ ·å¼è®¾ç½®æ¥å¸ƒå±€æ–‡å­—æˆ–å›¾ç‰‡ç­‰å…ƒç´ ï¼Œéœ€è¦ç”¨åˆ°CSSç›’å­æ¨¡åž‹ã€ç›’å­ç±»åž‹ã€CSSæµ®åŠ¨ã€CSSå®šä½ã€CSSèƒŒæ™¯å›¾å®šä½ç­‰çŸ¥è¯†æ¥å¸ƒå±€ï¼Œå®ƒæ¯”ä¼ ç»Ÿå¸ƒå±€è¦å¤æ‚ï¼Œç›®å‰æ˜¯ä¸»æµçš„å¸ƒå±€æ–¹å¼ã€‚2.11 tableå¸ƒå±€åŠå®žä¾‹tableæ¥åšæ•´ä½“é¡µé¢çš„å¸ƒå±€ï¼Œå¸ƒå±€çš„æŠ€å·§å½’çº³ä¸ºå¦‚ä¸‹å‡ ç‚¹ï¼š1ã€æŒ‰ç…§è®¾è®¡å›¾çš„å°ºå¯¸è®¾ç½®è¡¨æ ¼çš„å®½é«˜ä»¥åŠå•å…ƒæ ¼çš„å®½é«˜ã€‚2ã€å°†è¡¨æ ¼borderã€cellpaddingã€cellspacingå…¨éƒ¨è®¾ç½®ä¸º0ï¼Œè¡¨æ ¼çš„è¾¹æ¡†å’Œé—´è·å°±ä¸å æœ‰é¡µé¢ç©ºé—´ï¼Œå®ƒåªèµ·åˆ°åˆ’åˆ†ç©ºé—´çš„ä½œç”¨ã€‚3ã€é’ˆå¯¹å±€éƒ¨å¤æ‚çš„å¸ƒå±€ï¼Œå¯ä»¥åœ¨å•å…ƒæ ¼é‡Œé¢å†åµŒå¥—è¡¨æ ¼ï¼ŒåµŒå¥—è¡¨æ ¼åˆ’åˆ†å±€éƒ¨çš„ç©ºé—´ã€‚4ã€å•å…ƒæ ¼ä¸­çš„å…ƒç´ æˆ–è€…åµŒå¥—çš„è¡¨æ ¼ç”¨alignå’Œvalignè®¾ç½®å¯¹é½æ–¹å¼5ã€é€šè¿‡å±žæ€§æˆ–è€…cssæ ·å¼è®¾ç½®å•å…ƒæ ¼ä¸­å…ƒç´ çš„æ ·å¼3. CSSCSSæ˜¯ Cascading Style Sheets çš„é¦–å­—æ¯ç¼©å†™ï¼Œæ„æ€æ˜¯å±‚å æ ·å¼è¡¨ã€‚æœ‰äº†CSSï¼Œhtmlä¸­å¤§éƒ¨åˆ†è¡¨çŽ°æ ·å¼çš„æ ‡ç­¾å°±åºŸå¼ƒä¸ç”¨äº†ï¼Œhtmlåªè´Ÿè´£æ–‡æ¡£çš„ç»“æž„å’Œå†…å®¹ï¼Œè¡¨çŽ°å½¢å¼å®Œå…¨äº¤ç»™CSSï¼Œhtmlæ–‡æ¡£å˜å¾—æ›´åŠ ç®€æ´ã€‚3.1 cssåŸºæœ¬è¯­æ³•åŠé¡µé¢å¼•ç”¨3.1.1 cssåŸºæœ¬è¯­æ³•cssçš„å®šä¹‰æ–¹æ³•æ˜¯ï¼šé€‰æ‹©å™¨ { å±žæ€§:å€¼; å±žæ€§:å€¼; å±žæ€§:å€¼;}é€‰æ‹©å™¨æ˜¯å°†æ ·å¼å’Œé¡µé¢å…ƒç´ å…³è”èµ·æ¥çš„åç§°ï¼Œå±žæ€§æ˜¯å¸Œæœ›è®¾ç½®çš„æ ·å¼å±žæ€§æ¯ä¸ªå±žæ€§æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå€¼ã€‚ä»£ç ç¤ºä¾‹ï¼š12345678910/* cssæ³¨é‡Š ctrl+shift+"/"*/div&#123; width:100px; height:100px; color:red &#125;3.1.2 cssé¡µé¢å¼•å…¥æ–¹æ³•ï¼š1ã€å¤–è”å¼ï¼šé€šè¿‡linkæ ‡ç­¾ï¼Œé“¾æŽ¥åˆ°å¤–éƒ¨æ ·å¼è¡¨åˆ°é¡µé¢ä¸­ã€‚1&lt;link rel="stylesheet" type="text/css" href="css/main.css"&gt;2ã€åµŒå…¥å¼ï¼šé€šè¿‡styleæ ‡ç­¾ï¼Œåœ¨ç½‘é¡µä¸Šåˆ›å»ºåµŒå…¥çš„æ ·å¼è¡¨ã€‚1234&lt;style type="text/css"&gt; div&#123; width:100px; height:100px; color:red &#125; ......&lt;/style&gt;3ã€å†…è”å¼ï¼šé€šè¿‡æ ‡ç­¾çš„styleå±žæ€§ï¼Œåœ¨æ ‡ç­¾ä¸Šç›´æŽ¥å†™æ ·å¼ã€‚1&lt;div style="width:100px; height:100px; color:red "&gt;......&lt;/div&gt;3.2 cssæ–‡æœ¬è®¾ç½®å¸¸ç”¨çš„åº”ç”¨æ–‡æœ¬çš„cssæ ·å¼ï¼šcolor è®¾ç½®æ–‡å­—çš„é¢œè‰²ï¼Œå¦‚ï¼š color:red;font-size è®¾ç½®æ–‡å­—çš„å¤§å°ï¼Œå¦‚ï¼šfont-size:12px;font-family è®¾ç½®æ–‡å­—çš„å­—ä½“ï¼Œå¦‚ï¼šfont-family:â€™å¾®è½¯é›…é»‘â€™;font-style è®¾ç½®å­—ä½“æ˜¯å¦å€¾æ–œï¼Œå¦‚ï¼šfont-style:â€™normalâ€™; è®¾ç½®ä¸å€¾æ–œï¼Œfont-style:â€™italicâ€™;è®¾ç½®æ–‡å­—å€¾æ–œfont-weight è®¾ç½®æ–‡å­—æ˜¯å¦åŠ ç²—ï¼Œå¦‚ï¼šfont-weight:bold; è®¾ç½®åŠ ç²— font-weight:normal è®¾ç½®ä¸åŠ ç²—line-height è®¾ç½®æ–‡å­—çš„è¡Œé«˜ï¼Œè®¾ç½®è¡Œé«˜ç›¸å½“äºŽåœ¨æ¯è¡Œæ–‡å­—çš„ä¸Šä¸‹åŒæ—¶åŠ é—´è·ï¼Œ å¦‚ï¼šline-height:24px;font åŒæ—¶è®¾ç½®æ–‡å­—çš„å‡ ä¸ªå±žæ€§ï¼Œå†™çš„é¡ºåºæœ‰å…¼å®¹é—®é¢˜ï¼Œå»ºè®®æŒ‰ç…§å¦‚ä¸‹é¡ºåºå†™ï¼š fontï¼šæ˜¯å¦åŠ ç²— å­—å·/è¡Œé«˜ å­—ä½“ï¼›å¦‚ï¼š font:normal 12px/36px â€˜å¾®è½¯é›…é»‘â€™;text-decoration è®¾ç½®æ–‡å­—çš„ä¸‹åˆ’çº¿ï¼Œå¦‚ï¼štext-decoration:none; å°†æ–‡å­—ä¸‹åˆ’çº¿åŽ»æŽ‰text-indent è®¾ç½®æ–‡å­—é¦–è¡Œç¼©è¿›ï¼Œå¦‚ï¼štext-indent:24px; è®¾ç½®æ–‡å­—é¦–è¡Œç¼©è¿›24pxtext-align è®¾ç½®æ–‡å­—æ°´å¹³å¯¹é½æ–¹å¼ï¼Œå¦‚text-align:center è®¾ç½®æ–‡å­—æ°´å¹³å±…ä¸­3.3 cssé¢œè‰²è¡¨ç¤ºæ³•cssé¢œè‰²å€¼ä¸»è¦æœ‰ä¸‰ç§è¡¨ç¤ºæ–¹æ³•ï¼š1ã€é¢œè‰²åè¡¨ç¤ºï¼Œæ¯”å¦‚ï¼šred çº¢è‰²ï¼Œgold é‡‘è‰²2ã€rgbè¡¨ç¤ºï¼Œæ¯”å¦‚ï¼šrgb(255,0,0)è¡¨ç¤ºçº¢è‰²3ã€16è¿›åˆ¶æ•°å€¼è¡¨ç¤ºï¼Œæ¯”å¦‚ï¼š#ff0000 è¡¨ç¤ºçº¢è‰²ï¼Œè¿™ç§å¯ä»¥ç®€å†™æˆ #f003.4 cssé€‰æ‹©å™¨å¸¸ç”¨çš„é€‰æ‹©å™¨æœ‰å¦‚ä¸‹å‡ ç§ï¼š3.4.1 æ ‡ç­¾é€‰æ‹©å™¨æ ‡ç­¾é€‰æ‹©å™¨ï¼Œæ­¤ç§é€‰æ‹©å™¨å½±å“èŒƒå›´å¤§ï¼Œå»ºè®®å°½é‡åº”ç”¨åœ¨å±‚çº§é€‰æ‹©å™¨ä¸­ã€‚ä¸¾ä¾‹ï¼š123456*&#123;margin:0;padding:0&#125;div&#123;color:red&#125; &lt;div&gt;....&lt;/div&gt; &lt;!-- å¯¹åº”ä»¥ä¸Šä¸¤æ¡æ ·å¼ --&gt;&lt;div class="box"&gt;....&lt;/div&gt; &lt;!-- å¯¹åº”ä»¥ä¸Šä¸¤æ¡æ ·å¼ --&gt;3.4.2 idé€‰æ‹©å™¨é€šè¿‡idåæ¥é€‰æ‹©å…ƒç´ ï¼Œå…ƒç´ çš„idåç§°ä¸èƒ½é‡å¤ï¼Œæ‰€ä»¥ä¸€ä¸ªæ ·å¼è®¾ç½®é¡¹åªèƒ½å¯¹åº”äºŽé¡µé¢ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œä¸èƒ½å¤ç”¨ï¼Œidåä¸€èˆ¬ç»™ç¨‹åºä½¿ç”¨ï¼Œæ‰€ä»¥ä¸æŽ¨èä½¿ç”¨idä½œä¸ºé€‰æ‹©å™¨ã€‚ä¸¾ä¾‹ï¼š123#box&#123;color:red&#125; &lt;div id="box"&gt;....&lt;/div&gt; &lt;!-- å¯¹åº”ä»¥ä¸Šä¸€æ¡æ ·å¼ï¼Œå…¶å®ƒå…ƒç´ ä¸å…è®¸åº”ç”¨æ­¤æ ·å¼ --&gt;3.4.3 ç±»é€‰æ‹©å™¨é€šè¿‡ç±»åæ¥é€‰æ‹©å…ƒç´ ï¼Œä¸€ä¸ªç±»å¯åº”ç”¨äºŽå¤šä¸ªå…ƒç´ ï¼Œä¸€ä¸ªå…ƒç´ ä¸Šä¹Ÿå¯ä»¥ä½¿ç”¨å¤šä¸ªç±»ï¼Œåº”ç”¨çµæ´»ï¼Œå¯å¤ç”¨ï¼Œæ˜¯cssä¸­åº”ç”¨æœ€å¤šçš„ä¸€ç§é€‰æ‹©å™¨ã€‚ä¸¾ä¾‹ï¼š1234567.red&#123;color:red&#125;.big&#123;font-size:20px&#125;.mt10&#123;margin-top:10px&#125; &lt;div class="red"&gt;....&lt;/div&gt;&lt;h1 class="red big mt10"&gt;....&lt;/h1&gt;&lt;p class="red mt10"&gt;....&lt;/p&gt;3.4.4 å±‚çº§é€‰æ‹©å™¨ä¸»è¦åº”ç”¨åœ¨é€‰æ‹©çˆ¶å…ƒç´ ä¸‹çš„å­å…ƒç´ ï¼Œæˆ–è€…å­å…ƒç´ ä¸‹é¢çš„å­å…ƒç´ ï¼Œå¯ä¸Žæ ‡ç­¾å…ƒç´ ç»“åˆä½¿ç”¨ï¼Œå‡å°‘å‘½åï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é€šè¿‡å±‚çº§ï¼Œé˜²æ­¢å‘½åå†²çªã€‚ä¸¾ä¾‹ï¼š12345678910.box span&#123;color:red&#125;.box .red&#123;color:pink&#125;.red&#123;color:red&#125;&lt;div class="box"&gt; &lt;span&gt;....&lt;/span&gt; &lt;a href="#" class="red"&gt;....&lt;/a&gt;&lt;/div&gt;&lt;h3 class="red"&gt;....&lt;/h3&gt;3.4.5 ç»„é€‰æ‹©å™¨å¤šä¸ªé€‰æ‹©å™¨ï¼Œå¦‚æžœæœ‰åŒæ ·çš„æ ·å¼è®¾ç½®ï¼Œå¯ä»¥ä½¿ç”¨ç»„é€‰æ‹©å™¨ã€‚ä¸¾ä¾‹ï¼š12345678.box1,.box2,.box3&#123;width:100px;height:100px&#125;.box1&#123;background:red&#125;.box2&#123;background:pink&#125;.box3&#123;background:gold&#125;&lt;div class="box1"&gt;....&lt;/div&gt;&lt;div class="box2"&gt;....&lt;/div&gt;&lt;div class="box3"&gt;....&lt;/div&gt;3.4.6 ä¼ªç±»åŠä¼ªå…ƒç´ é€‰æ‹©å™¨å¸¸ç”¨çš„ä¼ªç±»é€‰æ‹©å™¨æœ‰hoverï¼Œè¡¨ç¤ºé¼ æ ‡æ‚¬æµ®åœ¨å…ƒç´ ä¸Šæ—¶çš„çŠ¶æ€ï¼Œä¼ªå…ƒç´ é€‰æ‹©å™¨æœ‰beforeå’Œafter,å®ƒä»¬å¯ä»¥é€šè¿‡æ ·å¼åœ¨å…ƒç´ ä¸­æ’å…¥å†…å®¹ã€‚12345678.box1:hover&#123;color:red&#125;.box2:before&#123;content:'è¡Œé¦–æ–‡å­—';&#125;.box3:after&#123;content:'è¡Œå°¾æ–‡å­—';&#125;&lt;div class="box1"&gt;....&lt;/div&gt;&lt;div class="box2"&gt;....&lt;/div&gt;&lt;div class="box3"&gt;....&lt;/div&gt;3.5 CSSç›’å­æ¨¡åž‹3.5.1 ç›’å­æ¨¡åž‹è§£é‡Šå…ƒç´ (æ ‡ç­¾)åœ¨é¡µé¢ä¸­æ˜¾ç¤ºæˆä¸€ä¸ªæ–¹å—ï¼Œç±»ä¼¼ä¸€ä¸ªç›’å­ï¼ŒCSSç›’å­æ¨¡åž‹å°±æ˜¯ä½¿ç”¨çŽ°å®žä¸­ç›’å­æ¥åšæ¯”å–»ï¼Œå¸®åŠ©æˆ‘ä»¬è®¾ç½®å…ƒç´ å¯¹åº”çš„æ ·å¼ã€‚ç›’å­æ¨¡åž‹ç¤ºæ„å›¾å¦‚ä¸‹ï¼šæŠŠå…ƒç´ å«åšç›’å­ï¼Œè®¾ç½®å¯¹åº”çš„æ ·å¼åˆ†åˆ«ä¸ºï¼šç›’å­çš„å®½åº¦(width)ã€ç›’å­çš„é«˜åº¦(height)ã€ç›’å­çš„è¾¹æ¡†(border)ã€ç›’å­å†…çš„å†…å®¹å’Œè¾¹æ¡†ä¹‹é—´çš„é—´è·(padding)ã€ç›’å­ä¸Žç›’å­ä¹‹é—´çš„é—´è·(margin)ã€‚3.5.2 è®¾ç½®å®½é«˜12width:200px; /* è®¾ç½®ç›’å­çš„å®½åº¦ï¼Œæ­¤å®½åº¦æ˜¯æŒ‡ç›’å­å†…å®¹çš„å®½åº¦ï¼Œä¸æ˜¯ç›’å­æ•´ä½“å®½åº¦(éš¾ç‚¹) */ height:200px; /* è®¾ç½®ç›’å­çš„é«˜åº¦ï¼Œæ­¤é«˜åº¦æ˜¯æŒ‡ç›’å­å†…å®¹çš„é«˜åº¦ï¼Œä¸æ˜¯ç›’å­æ•´ä½“é«˜åº¦(éš¾ç‚¹) */3.5.3 è®¾ç½®è¾¹æ¡†è®¾ç½®ä¸€è¾¹çš„è¾¹æ¡†ï¼Œæ¯”å¦‚é¡¶éƒ¨è¾¹æ¡†ï¼Œå¯ä»¥æŒ‰å¦‚ä¸‹è®¾ç½®ï¼š1234border-top-color:red; /* è®¾ç½®é¡¶éƒ¨è¾¹æ¡†é¢œè‰²ä¸ºçº¢è‰² */ border-top-width:10px; /* è®¾ç½®é¡¶éƒ¨è¾¹æ¡†ç²—ç»†ä¸º10px */ border-top-style:solid; /* è®¾ç½®é¡¶éƒ¨è¾¹æ¡†çš„çº¿æ€§ä¸ºå®žçº¿ï¼Œå¸¸ç”¨çš„æœ‰ï¼šsolid(å®žçº¿) dashed(è™šçº¿) dotted(ç‚¹çº¿); */ä¸Šé¢ä¸‰å¥å¯ä»¥ç®€å†™æˆä¸€å¥ï¼š1border-top:10px solid red; /* é¡ºåºæ— æ‰€è°“ï¼Œæ€Žä¹ˆå†™éƒ½å¯ä»¥ */è®¾ç½®å…¶å®ƒä¸‰ä¸ªè¾¹çš„æ–¹æ³•å’Œä¸Šé¢ä¸€æ ·ï¼ŒæŠŠä¸Šé¢çš„â€™topâ€™æ¢æˆâ€™leftâ€™å°±æ˜¯è®¾ç½®å·¦è¾¹ï¼Œæ¢æˆâ€™rightâ€™å°±æ˜¯è®¾ç½®å³è¾¹ï¼Œæ¢æˆâ€™bottomâ€™å°±æ˜¯è®¾ç½®åº•è¾¹ã€‚å››ä¸ªè¾¹å¦‚æžœè®¾ç½®ä¸€æ ·ï¼Œå¯ä»¥å°†å››ä¸ªè¾¹çš„è®¾ç½®åˆå¹¶æˆä¸€å¥ï¼š1border:10px solid red;3.5.4 è®¾ç½®å†…é—´è·paddingè®¾ç½®ç›’å­å››è¾¹çš„å†…é—´è·ï¼Œå¯è®¾ç½®å¦‚ä¸‹ï¼š1234padding-topï¼š20px; /* è®¾ç½®é¡¶éƒ¨å†…é—´è·20px */ padding-left:30px; /* è®¾ç½®å·¦è¾¹å†…é—´è·30px */ padding-right:40px; /* è®¾ç½®å³è¾¹å†…é—´è·40px */ padding-bottom:50px; /* è®¾ç½®åº•éƒ¨å†…é—´è·50px */ä¸Šé¢çš„è®¾ç½®å¯ä»¥ç®€å†™å¦‚ä¸‹ï¼š12paddingï¼š20px 40px 50px 30px; /* å››ä¸ªå€¼æŒ‰ç…§é¡ºæ—¶é’ˆæ–¹å‘ï¼Œåˆ†åˆ«è®¾ç½®çš„æ˜¯ ä¸Š å³ ä¸‹ å·¦ å››ä¸ªæ–¹å‘çš„å†…è¾¹è·å€¼ã€‚ */paddingåŽé¢è¿˜å¯ä»¥è·Ÿ3ä¸ªå€¼ï¼Œ2ä¸ªå€¼å’Œ1ä¸ªå€¼ï¼Œå®ƒä»¬åˆ†åˆ«è®¾ç½®çš„é¡¹ç›®å¦‚ä¸‹ï¼š123paddingï¼š20px 40px 50px; /* è®¾ç½®é¡¶éƒ¨å†…è¾¹è·ä¸º20pxï¼Œå·¦å³å†…è¾¹è·ä¸º40pxï¼Œåº•éƒ¨å†…è¾¹è·ä¸º50px */ paddingï¼š20px 40px; /* è®¾ç½®ä¸Šä¸‹å†…è¾¹è·ä¸º20pxï¼Œå·¦å³å†…è¾¹è·ä¸º40px*/ paddingï¼š20px; /* è®¾ç½®å››è¾¹å†…è¾¹è·ä¸º20px */3.5.5 è®¾ç½®å¤–é—´è·marginå¤–è¾¹è·çš„è®¾ç½®æ–¹æ³•å’Œpaddingçš„è®¾ç½®æ–¹æ³•ç›¸åŒï¼Œå°†ä¸Šé¢è®¾ç½®é¡¹ä¸­çš„â€™paddingâ€™æ¢æˆâ€™marginâ€™å°±æ˜¯å¤–è¾¹è·è®¾ç½®æ–¹æ³•ã€‚3.5.6 ç†è§£ç»ƒä¹ é€šè¿‡ç›’å­æ¨¡åž‹çš„åŽŸç†ï¼Œåˆ¶ä½œä¸‹é¢çš„ç›’å­ï¼š123456789.box &#123; width: 140px; height: 140px; background-color: gold; border: black 10px solid; padding: 20px;&#125;&lt;div class="box"&gt;ç›’å­é‡Œé¢çš„æ–‡å­—å†…å®¹ï¼Œè·ç¦»è¾¹æ¡†æœ‰ä¸€å®šè·ç¦»ã€‚&lt;/div&gt;3.6 ç›’æ¨¡åž‹çš„å®žé™…å°ºå¯¸æŒ‰ç…§ä¸‹é¢ä»£ç åˆ¶ä½œé¡µé¢ï¼š123456789101112131415161718192021&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;ç›’å­çš„çœŸå®žå°ºå¯¸&lt;/title&gt; &lt;style type="text/css"&gt; .box01&#123;width:50px;height:50px;background-color:gold;&#125; .box02&#123;width:50px;height:50px;background-color:gold;border:50px solid #000&#125; .box03&#123;width:50px;height:50px;background-color:gold;border:50px solid #000;padding: 50px;&#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="box01"&gt;1&lt;/div&gt; &lt;br /&gt; &lt;div class="box02"&gt;2&lt;/div&gt; &lt;br /&gt; &lt;div class="box03"&gt;3&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;é¡µé¢æ˜¾ç¤ºæ•ˆæžœå¦‚ä¸‹ï¼šé€šè¿‡ä¸Šé¢çš„é¡µé¢å¾—å‡ºç»“è®ºï¼šç›’å­çš„widthå’Œheightè®¾ç½®çš„æ˜¯ç›’å­å†…å®¹çš„å®½å’Œé«˜ï¼Œä¸æ˜¯ç›’å­æœ¬èº«çš„å®½å’Œé«˜ï¼Œç›’å­çš„çœŸå®žå°ºå¯¸è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼šç›’å­å®½åº¦ = width + paddingå·¦å³ + borderå·¦å³ç›’å­é«˜åº¦ = height + paddingä¸Šä¸‹ + borderä¸Šä¸‹ç†è§£ç»ƒä¹ é€šè¿‡ç›’å­æ¨¡åž‹çš„åŽŸç†ï¼Œåˆ¶ä½œä¸‹é¢çš„ç›’å­ï¼š1234567891011121314.box &#123; width: 380px; height: 35px; font-size: 20px; font-family: "Microsoft YaHei"; color: #333; border-top: 1px solid #ff0000; border-bottom: 3px solid #666666; padding-top: 15px; padding-left: 20px; line-height: 20px;&#125;&lt;div class="box"&gt;æ–°é—»åˆ—è¡¨&lt;/div&gt;3.7 ç›’æ¨¡åž‹ä½¿ç”¨æŠ€å·§åŠç›¸å…³é—®é¢˜3.7.1 marginç›¸å…³æŠ€å·§1ã€è®¾ç½®å…ƒç´ æ°´å¹³å±…ä¸­ï¼š margin:x auto;2ã€marginè´Ÿå€¼è®©å…ƒç´ ä½ç§»åŠè¾¹æ¡†åˆå¹¶ç†è§£ç»ƒä¹ 1ã€åˆ¶ä½œä¸€ä¸ª600*100çš„ç›’å­ï¼Œè¾¹æ¡†1åƒç´ é»‘è‰²ï¼Œè·ç¦»æµè§ˆå™¨é¡¶éƒ¨100pxï¼Œæ°´å¹³å±…ä¸­ã€‚123456789101112body &#123; margin: 0;&#125;.box &#123; width: 598px; height: 98px; border: 1px black solid; margin: 100px auto;&#125;&lt;div class="box"&gt;&lt;/div&gt;2ã€åˆ¶ä½œä¸‹é¢çš„èœå•æ•ˆæžœï¼š1234567891011121314151617181920212223242526body &#123; margin: 0; /* bodyæ ‡ç­¾æœ¬èº«å¸¦æœ‰8åƒç´ çš„é—´éš”ï¼Œéœ€è¦åŽ»æŽ‰è¿™ä¸ªç›’å­æ‰èƒ½è´´è¾¹ */&#125;.box &#123; width: 200px; height: 150px; margin: 50px auto 0; /* è®¾ç½®autoè¡¨ç¤ºæ°´å¹³å±…ä¸­ */ background-color: gold;&#125;.box div&#123; width: 200px; height: 30px; border: 1px green solid; background-color: gold; margin-top: -1px; /* è®¾ç½®è´Ÿå€¼è¡¨ç¤ºè¾¹æ¡†é‡å  */&#125;&lt;div class="box"&gt; &lt;div class="box1"&gt;&lt;/div&gt; &lt;div class="box2"&gt;&lt;/div&gt; &lt;div class="box3"&gt;&lt;/div&gt; &lt;div class="box4"&gt;&lt;/div&gt; &lt;div class="box5"&gt;&lt;/div&gt;&lt;/div&gt;3.7.2 å¤–è¾¹è·åˆå¹¶å¤–è¾¹è·åˆå¹¶æŒ‡çš„æ˜¯ï¼Œå½“ä¸¤ä¸ªåž‚ç›´å¤–è¾¹è·ç›¸é‡æ—¶ï¼Œå®ƒä»¬å°†å½¢æˆä¸€ä¸ªå¤–è¾¹è·ã€‚åˆå¹¶åŽçš„å¤–è¾¹è·çš„é«˜åº¦ç­‰äºŽä¸¤ä¸ªå‘ç”Ÿåˆå¹¶çš„å¤–è¾¹è·çš„é«˜åº¦ä¸­çš„è¾ƒå¤§è€…ã€‚è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š1ã€ä½¿ç”¨è¿™ç§ç‰¹æ€§2ã€è®¾ç½®ä¸€è¾¹çš„å¤–è¾¹è·ï¼Œä¸€èˆ¬è®¾ç½®margin-top3ã€å°†å…ƒç´ æµ®åŠ¨æˆ–è€…å®šä½ç†è§£ç»ƒä¹ ä½¿ç”¨divæ ‡ç­¾åˆ¶ä½œå¦‚ä¸‹å¸ƒå±€:123456789101112131415161718192021222324252627282930313233.box &#123; width: 500px; border: 1px solid black; margin: 50px auto 0;&#125;.box div &#123; margin-left: 20px; margin-right: 20px; margin-top: 20px; /* ä¸­é—´çš„é—´éš”åº”è¯¥æ˜¯40px,ä½†æ˜¯å› ä¸ºæ˜¯åˆå¹¶ï¼Œå®žé™…æ˜¯20px*/ margin-bottom: 20px;&#125;/* æˆ–è€…ä½¿ç”¨å¦‚ä¸‹çš„è¿™ä¸ªæ±‡æ€»å½¢å¼.box div &#123; margin: 20px;&#125;*/&lt;div class="box"&gt; &lt;div&gt; å¤–è¾¹è·åˆå¹¶æŒ‡çš„æ˜¯ï¼Œå½“ä¸¤ä¸ªåž‚ç›´å¤–è¾¹è·ç›¸é‡æ—¶ï¼Œå®ƒä»¬å°†å½¢æˆä¸€ä¸ªå¤–è¾¹è·ã€‚åˆå¹¶åŽçš„å¤–è¾¹è·çš„é«˜åº¦ç­‰äºŽä¸¤ä¸ªå‘ç”Ÿåˆå¹¶çš„å¤–è¾¹è·çš„é«˜åº¦ä¸­çš„è¾ƒå¤§è€…ã€‚ &lt;/div&gt; &lt;div&gt; å¤–è¾¹è·åˆå¹¶æŒ‡çš„æ˜¯ï¼Œå½“ä¸¤ä¸ªåž‚ç›´å¤–è¾¹è·ç›¸é‡æ—¶ï¼Œå®ƒä»¬å°†å½¢æˆä¸€ä¸ªå¤–è¾¹è·ã€‚åˆå¹¶åŽçš„å¤–è¾¹è·çš„é«˜åº¦ç­‰äºŽä¸¤ä¸ªå‘ç”Ÿåˆå¹¶çš„å¤–è¾¹è·çš„é«˜åº¦ä¸­çš„è¾ƒå¤§è€…ã€‚ &lt;/div&gt; &lt;div&gt; å¤–è¾¹è·åˆå¹¶æŒ‡çš„æ˜¯ï¼Œå½“ä¸¤ä¸ªåž‚ç›´å¤–è¾¹è·ç›¸é‡æ—¶ï¼Œå®ƒä»¬å°†å½¢æˆä¸€ä¸ªå¤–è¾¹è·ã€‚åˆå¹¶åŽçš„å¤–è¾¹è·çš„é«˜åº¦ç­‰äºŽä¸¤ä¸ªå‘ç”Ÿåˆå¹¶çš„å¤–è¾¹è·çš„é«˜åº¦ä¸­çš„è¾ƒå¤§è€…ã€‚ &lt;/div&gt; &lt;div&gt; å¤–è¾¹è·åˆå¹¶æŒ‡çš„æ˜¯ï¼Œå½“ä¸¤ä¸ªåž‚ç›´å¤–è¾¹è·ç›¸é‡æ—¶ï¼Œå®ƒä»¬å°†å½¢æˆä¸€ä¸ªå¤–è¾¹è·ã€‚åˆå¹¶åŽçš„å¤–è¾¹è·çš„é«˜åº¦ç­‰äºŽä¸¤ä¸ªå‘ç”Ÿåˆå¹¶çš„å¤–è¾¹è·çš„é«˜åº¦ä¸­çš„è¾ƒå¤§è€…ã€‚ &lt;/div&gt;&lt;/div&gt;3.7.3 margin-top å¡Œé™·åœ¨ä¸¤ä¸ªç›’å­åµŒå¥—æ—¶å€™ï¼Œå†…éƒ¨çš„ç›’å­è®¾ç½®çš„margin-topä¼šåŠ åˆ°å¤–è¾¹çš„ç›’å­ä¸Šï¼Œå¯¼è‡´å†…éƒ¨çš„ç›’å­margin-topè®¾ç½®å¤±è´¥ï¼Œè§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š1ã€å¤–éƒ¨ç›’å­è®¾ç½®ä¸€ä¸ªè¾¹æ¡†2ã€å¤–éƒ¨ç›’å­è®¾ç½® overflow:hidden3ã€ä½¿ç”¨ä¼ªå…ƒç´ ç±»ï¼š1234.clearfix:before&#123; content: ''; display:table;&#125;ç†è§£ç»ƒä¹ åˆ†åˆ«ä½¿ç”¨marginé—´è·å’Œpaddingé—´è·åˆ¶ä½œä¸‹é¢çš„ä¾‹å­ï¼š ç¬¬ä¸€ä¸ªå›¾123456789101112131415161718.box &#123; width: 200px; height: 200px; background-color: gold; border: 1px solid black;&#125;.box1 &#123; width: 120px; height: 50px; background-color: green; margin: 75px auto 40px;&#125;&lt;div class="box"&gt; &lt;div class="box1"&gt; &lt;/div&gt;&lt;/div&gt;ç¬¬äºŒä¸ªå›¾123456789101112131415161718192021222324.box &#123; width: 200px; height: 200px; background-color: gold; /*border: 1px solid black; ç¬¬ä¸€ç§è§£å†³å¡Œé™·çš„æ–¹æ³•ï¼šç»™å¤–éƒ¨ç›’å­åŠ ä¸ªè¾¹æ¡† */ /*overflow: hidden; ç¬¬äºŒç§è§£å†³å¡Œé™·çš„æ–¹æ³•ï¼šå¤„ç†csså¤–éƒ¨æº¢å‡º */&#125;.box1 &#123; width: 120px; height: 50px; background-color: green; margin: 75px auto 40px;&#125;.box:before&#123; /* ç¬¬ä¸‰ç§è§£å†³å¡Œé™·çš„æ–¹æ³•ï¼šä½¿ç”¨ä¼ªå…ƒç´ ç±»ï¼ŒæŽ¨èä½¿ç”¨è¿™ä¸ª*/ content: ''; display:table;&#125;&lt;div class="box"&gt; &lt;div class="box1"&gt; &lt;/div&gt;&lt;/div&gt;3.8 csså…ƒç´ æº¢å‡ºå½“å­å…ƒç´ çš„å°ºå¯¸è¶…è¿‡çˆ¶å…ƒç´ çš„å°ºå¯¸æ—¶ï¼Œéœ€è¦è®¾ç½®çˆ¶å…ƒç´ æ˜¾ç¤ºæº¢å‡ºçš„å­å…ƒç´ çš„æ–¹å¼ï¼Œè®¾ç½®çš„æ–¹æ³•æ˜¯é€šè¿‡overflowå±žæ€§æ¥è®¾ç½®ã€‚overflowçš„è®¾ç½®é¡¹ï¼š1ã€visible é»˜è®¤å€¼ã€‚å†…å®¹ä¸ä¼šè¢«ä¿®å‰ªï¼Œä¼šå‘ˆçŽ°åœ¨å…ƒç´ æ¡†ä¹‹å¤–ã€‚2ã€hidden å†…å®¹ä¼šè¢«ä¿®å‰ªï¼Œå¹¶ä¸”å…¶ä½™å†…å®¹æ˜¯ä¸å¯è§çš„ï¼Œæ­¤å±žæ€§è¿˜æœ‰æ¸…é™¤æµ®åŠ¨ã€æ¸…é™¤margin-topå¡Œé™·çš„åŠŸèƒ½ã€‚3ã€scroll å†…å®¹ä¼šè¢«ä¿®å‰ªï¼Œä½†æ˜¯æµè§ˆå™¨ä¼šæ˜¾ç¤ºæ»šåŠ¨æ¡ä»¥ä¾¿æŸ¥çœ‹å…¶ä½™çš„å†…å®¹ã€‚4ã€auto å¦‚æžœå†…å®¹è¢«ä¿®å‰ªï¼Œåˆ™æµè§ˆå™¨ä¼šæ˜¾ç¤ºæ»šåŠ¨æ¡ä»¥ä¾¿æŸ¥çœ‹å…¶ä½™çš„å†…å®¹ã€‚5ã€inherit è§„å®šåº”è¯¥ä»Žçˆ¶å…ƒç´ ç»§æ‰¿ overflow å±žæ€§çš„å€¼ã€‚å…ƒç´ æº¢å‡ºç¤ºä¾‹ï¼š3.9 å—å…ƒç´ ã€å†…è”å…ƒç´ ã€å†…è”å—å…ƒç´ å…ƒç´ å°±æ˜¯æ ‡ç­¾ï¼Œå¸ƒå±€ä¸­å¸¸ç”¨çš„æœ‰ä¸‰ç§æ ‡ç­¾ï¼Œå—å…ƒç´ ã€å†…è”å…ƒç´ ã€å†…è”å—å…ƒç´ ï¼Œäº†è§£è¿™ä¸‰ç§å…ƒç´ çš„ç‰¹æ€§ï¼Œæ‰èƒ½ç†Ÿç»ƒçš„è¿›è¡Œé¡µé¢å¸ƒå±€ã€‚3.9.1 å—å…ƒç´ å—å…ƒç´ ï¼Œä¹Ÿå¯ä»¥ç§°ä¸ºè¡Œå…ƒç´ ï¼Œå¸ƒå±€ä¸­å¸¸ç”¨çš„æ ‡ç­¾å¦‚ï¼šdivã€pã€ulã€liã€h1~h6ã€dlã€dtã€ddç­‰ç­‰éƒ½æ˜¯å—å…ƒç´ ï¼Œå®ƒåœ¨å¸ƒå±€ä¸­çš„è¡Œä¸ºï¼šæ”¯æŒå…¨éƒ¨çš„æ ·å¼å¦‚æžœæ²¡æœ‰è®¾ç½®å®½åº¦ï¼Œé»˜è®¤çš„å®½åº¦ä¸ºçˆ¶çº§å®½åº¦100%ç›’å­å æ®ä¸€è¡Œã€å³ä½¿è®¾ç½®äº†å®½åº¦3.9.2 å†…è”å…ƒç´ å†…è”å…ƒç´ ï¼Œä¹Ÿå¯ä»¥ç§°ä¸ºè¡Œå†…å…ƒç´ ï¼Œå¸ƒå±€ä¸­å¸¸ç”¨çš„æ ‡ç­¾å¦‚ï¼šaã€spanã€emã€bã€strongã€iç­‰ç­‰éƒ½æ˜¯å†…è”å…ƒç´ ï¼Œå®ƒä»¬åœ¨å¸ƒå±€ä¸­çš„è¡Œä¸ºï¼šæ”¯æŒéƒ¨åˆ†æ ·å¼ï¼ˆä¸æ”¯æŒå®½ã€é«˜ã€marginä¸Šä¸‹ã€paddingä¸Šä¸‹ï¼‰å®½é«˜ç”±å†…å®¹å†³å®šç›’å­å¹¶åœ¨ä¸€è¡Œä»£ç æ¢è¡Œï¼Œç›’å­ä¹‹é—´ä¼šäº§ç”Ÿé—´è·å­å…ƒç´ æ˜¯å†…è”å…ƒç´ ï¼Œçˆ¶å…ƒç´ å¯ä»¥ç”¨text-alignå±žæ€§è®¾ç½®å­å…ƒç´ æ°´å¹³å¯¹é½æ–¹å¼è§£å†³å†…è”å…ƒç´ é—´éš™çš„æ–¹æ³•1ã€åŽ»æŽ‰å†…è”å…ƒç´ ä¹‹é—´çš„æ¢è¡Œ2ã€å°†å†…è”å…ƒç´ çš„çˆ¶çº§è®¾ç½®font-sizeä¸º0ï¼Œå†…è”å…ƒç´ è‡ªèº«å†è®¾ç½®font-size3.9.3 å†…è”å—å…ƒç´ å†…è”å—å…ƒç´ ï¼Œä¹Ÿå«è¡Œå†…å—å…ƒç´ ï¼Œæ˜¯æ–°å¢žçš„å…ƒç´ ç±»åž‹ï¼ŒçŽ°æœ‰å…ƒç´ æ²¡æœ‰å½’äºŽæ­¤ç±»åˆ«çš„ï¼Œimgå’Œinputå…ƒç´ çš„è¡Œä¸ºç±»ä¼¼è¿™ç§å…ƒç´ ï¼Œä½†æ˜¯ä¹Ÿå½’ç±»äºŽå†…è”å…ƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨displayå±žæ€§å°†å—å…ƒç´ æˆ–è€…å†…è”å…ƒç´ è½¬åŒ–æˆè¿™ç§å…ƒç´ ã€‚å®ƒä»¬åœ¨å¸ƒå±€ä¸­è¡¨çŽ°çš„è¡Œä¸ºï¼šæ”¯æŒå…¨éƒ¨æ ·å¼å¦‚æžœæ²¡æœ‰è®¾ç½®å®½é«˜ï¼Œå®½é«˜ç”±å†…å®¹å†³å®šç›’å­å¹¶åœ¨ä¸€è¡Œä»£ç æ¢è¡Œï¼Œç›’å­ä¼šäº§ç”Ÿé—´è·å­å…ƒç´ æ˜¯å†…è”å—å…ƒç´ ï¼Œçˆ¶å…ƒç´ å¯ä»¥ç”¨text-alignå±žæ€§è®¾ç½®å­å…ƒç´ æ°´å¹³å¯¹é½æ–¹å¼ã€‚è¿™ä¸‰ç§å…ƒç´ ï¼Œå¯ä»¥é€šè¿‡displayå±žæ€§æ¥ç›¸äº’è½¬åŒ–ï¼Œä¸è¿‡å®žé™…å¼€å‘ä¸­ï¼Œå—å…ƒç´ ç”¨å¾—æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥æˆ‘ä»¬ç»å¸¸æŠŠå†…è”å…ƒç´ è½¬åŒ–ä¸ºå—å…ƒç´ ï¼Œå°‘é‡è½¬åŒ–ä¸ºå†…è”å—ï¼Œè€Œè¦ä½¿ç”¨å†…è”å…ƒç´ æ—¶ï¼Œç›´æŽ¥ä½¿ç”¨å†…è”å…ƒç´ ï¼Œè€Œä¸ç”¨å—å…ƒç´ è½¬åŒ–äº†ã€‚3.9.4 displayå±žæ€§displayå±žæ€§æ˜¯ç”¨æ¥è®¾ç½®å…ƒç´ çš„ç±»åž‹åŠéšè—çš„ï¼Œå¸¸ç”¨çš„å±žæ€§æœ‰ï¼š1ã€none å…ƒç´ éšè—ä¸”ä¸å ä½ç½®2ã€block å…ƒç´ ä»¥å—å…ƒç´ æ˜¾ç¤º3ã€inline å…ƒç´ ä»¥å†…è”å…ƒç´ æ˜¾ç¤º4ã€inline-block å…ƒç´ ä»¥å†…è”å—å…ƒç´ æ˜¾ç¤ºè¯¾å ‚ç»ƒä¹ è¯·åˆ¶ä½œå›¾ä¸­æ‰€ç¤ºçš„èœå•ï¼š123456789101112131415161718192021222324252627282930313233343536373839&lt;style type="text/css"&gt; .menu &#123; width: 694px; height: 50px; margin: 50px auto 0; font-size: 0; /* è§£å†³å†…è”å…ƒç´ é—´éš™ï¼šçˆ¶çº§è®¾ç½®font-sizeä¸º0ï¼Œå†…è”å…ƒç´ è‡ªèº«å†è®¾ç½®font-size */ &#125; .menu a &#123; width: 98px; height: 48px; background-color: #ffffff; /* èƒŒæ™¯è‰² */ display: inline-block; /* è¡Œå†…å— */ font-size: 16px; /* å­—ä½“å¤§å° */ font-family: "Microsoft YaHei"; /* å­—ä½“æ ·å¼ */ color: pink; /* å­—ä½“é¢œè‰² */ border: 1px solid gold; /* è¾¹æ¡†çº¿ */ margin-left: -1px; /* åŽ»æŽ‰é‡å çš„è¾¹æ¡†çº¿ */ text-align: center; /* æ–‡å­—æ°´å¹³å±…ä¸­ */ line-height: 48px; /* æ–‡å­—åž‚ç›´å±…ä¸­ */ text-decoration: none; /* åŽ»æŽ‰è¶…é“¾æŽ¥ä¸‹åˆ’çº¿ */ &#125; .menu a:hover &#123; /* ä¼ªç±» */ background-color: gold; color: white; &#125;&lt;/style&gt;&lt;div class="menu"&gt; &lt;a href="#"&gt;é¦–é¡µ&lt;/a&gt; &lt;a href="#"&gt;å…¬å¸ç®€ä»‹&lt;/a&gt; &lt;a href="#"&gt;è§£å†³æ–¹æ¡ˆ&lt;/a&gt; &lt;a href="#"&gt;å…¬å¸æ–°é—»&lt;/a&gt; &lt;a href="#"&gt;è¡Œä¸šåŠ¨æ€&lt;/a&gt; &lt;a href="#"&gt;æ‹›è´¤çº³å£«&lt;/a&gt; &lt;a href="#"&gt;è”ç³»æˆ‘ä»¬&lt;/a&gt;&lt;/div&gt;displayå±žæ€§æ‰©å±•none å…ƒç´ éšè—ä¸”ä¸å ä½ç½®ä»¥ä¸‹ç¤ºä¾‹æ˜¯å…ƒç´ é»˜è®¤éšè—ä¸æ˜¾ç¤ºï¼Œåªæœ‰å½“é¼ æ ‡æ”¾åœ¨å…ƒç´ ä¸Šæ—¶æ‰ä¼šæ˜¾ç¤ºå‡ºæ¥1234567891011121314151617181920212223.con &#123; width: 200px;&#125;.con h3&#123; font-size: 30px;&#125;.box2&#123; width: 200px; height: 200px; background-color: gold; font-size: 16px; display: none;&#125;.con:hover .box2&#123; display: block;&#125;&lt;div class="con"&gt; &lt;h3&gt;æ–‡å­—æ ‡é¢˜&lt;/h3&gt; &lt;div class="box2"&gt;æ–‡å­—æ ‡é¢˜çš„è¯´æ˜Ž&lt;/div&gt;&lt;/div&gt;3.10 æµ®åŠ¨3.10.1 æµ®åŠ¨ç‰¹æ€§1ã€æµ®åŠ¨å…ƒç´ æœ‰å·¦æµ®åŠ¨(float:left)å’Œå³æµ®åŠ¨(float:right)ä¸¤ç§2ã€æµ®åŠ¨çš„å…ƒç´ ä¼šå‘å·¦æˆ–å‘å³æµ®åŠ¨ï¼Œç¢°åˆ°çˆ¶å…ƒç´ è¾¹ç•Œã€å…¶ä»–å…ƒç´ æ‰åœä¸‹æ¥3ã€ç›¸é‚»æµ®åŠ¨çš„å—å…ƒç´ å¯ä»¥å¹¶åœ¨ä¸€è¡Œï¼Œè¶…å‡ºçˆ¶çº§å®½åº¦å°±æ¢è¡Œ4ã€æµ®åŠ¨è®©è¡Œå†…å…ƒç´ æˆ–å—å…ƒç´ è‡ªåŠ¨è½¬åŒ–ä¸ºè¡Œå†…å—å…ƒç´ (æ­¤æ—¶ä¸ä¼šæœ‰è¡Œå†…å—å…ƒç´ é—´éš™é—®é¢˜)5ã€æµ®åŠ¨å…ƒç´ åŽé¢æ²¡æœ‰æµ®åŠ¨çš„å…ƒç´ ä¼šå æ®æµ®åŠ¨å…ƒç´ çš„ä½ç½®ï¼Œæ²¡æœ‰æµ®åŠ¨çš„å…ƒç´ å†…çš„æ–‡å­—ä¼šé¿å¼€æµ®åŠ¨çš„å…ƒç´ ï¼Œå½¢æˆæ–‡å­—é¥¶å›¾çš„æ•ˆæžœ6ã€çˆ¶å…ƒç´ å¦‚æžœæ²¡æœ‰è®¾ç½®å°ºå¯¸(ä¸€èˆ¬æ˜¯é«˜åº¦ä¸è®¾ç½®)ï¼Œçˆ¶å…ƒç´ å†…æ•´ä½“æµ®åŠ¨çš„å…ƒç´ æ— æ³•æ’‘å¼€çˆ¶å…ƒç´ ï¼Œçˆ¶å…ƒç´ éœ€è¦æ¸…é™¤æµ®åŠ¨7ã€æµ®åŠ¨å…ƒç´ ä¹‹é—´æ²¡æœ‰åž‚ç›´marginçš„åˆå¹¶ç†è§£ç»ƒä¹ 1ã€ä¸¤ç«¯å¯¹é½æµ®åŠ¨12345678910111213141516171819202122232425262728293031323334&lt;style type="text/css"&gt; .con&#123; width: 400px; height: 80px; border: 1px solid gold; margin: 50px auto 0; &#125; .con div&#123; width: 60px; height: 60px; display: inline-block; margin: 10px; &#125; .box01&#123; background-color: #90ee90; float: left; &#125; .box02&#123; background-color: pink; float: right; &#125;&lt;/style&gt;&lt;!--div.con&gt;div.box01--&gt;&lt;div class="con"&gt; &lt;div class="box01"&gt;&lt;/div&gt; &lt;div class="box02"&gt;&lt;/div&gt;&lt;/div&gt;2ã€è¯·ä½¿ç”¨æµ®åŠ¨åˆ¶ä½œå›¾ä¸­æ‰€ç¤ºçš„èœå•ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344.menu &#123; width: 694px; height: 50px; list-style: none; /* åŽ»æŽ‰æ— åºåˆ—è¡¨å‰é¢çš„å°åœ†ç‚¹ */ margin: 50px auto 0; /* è¦†ç›–åŽŸå§‹çš„ul margin */ padding: 0; /* è¦†ç›–åŽŸå§‹çš„ul padding */&#125;.menu li&#123; width: 98px; height: 48px; border: 1px solid gold; background-color: white; /*display: inline-block;*/ float: left; margin-left: -1px;&#125;.menu li a&#123; display: block; width: 98px; height: 48px; text-align: center; line-height: 48px; text-decoration: none; font-size: 16px; font-family: "Microsoft YaHei"; color: pink;&#125;.menu li a:hover&#123; background-color: gold; color: white;&#125;&lt;ul class="menu"&gt; &lt;li&gt;&lt;a href="#"&gt;å…¬å¸ç®€ä»‹&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;å…¬å¸ç®€ä»‹&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;å…¬å¸ç®€ä»‹&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;å…¬å¸ç®€ä»‹&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;å…¬å¸ç®€ä»‹&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;å…¬å¸ç®€ä»‹&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;å…¬å¸ç®€ä»‹&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;3ã€æ–‡å­—é¥¶å›¾æ•ˆæžœ:123456789101112131415161718192021222324252627282930&lt;style type="text/css"&gt; .con&#123; width: 450px; height: 210px; border: 1px solid black; margin: 50px auto 0; &#125; .pic&#123; width: 80px; height: 80px; background-color: gold; float: left; margin: 10px; &#125; .text&#123; height: 130px; /*background-color: green;*/ color: #666; &#125;&lt;/style&gt;&lt;div class="con"&gt; &lt;div class="pic"&gt;&lt;/div&gt; &lt;div class="text"&gt;æµ®åŠ¨å…ƒç´ åŽé¢æ²¡æœ‰æµ®åŠ¨çš„å…ƒç´ ä¼šå æ®æµ®åŠ¨å…ƒç´ çš„ä½ç½®ï¼Œæ²¡æœ‰æµ®åŠ¨çš„å…ƒç´ å†…çš„æ–‡å­—ä¼šé¿å¼€æµ®åŠ¨çš„å…ƒç´ ï¼Œå½¢æˆæ–‡å­—é¥¶å›¾çš„æ•ˆæžœæµ®åŠ¨å…ƒç´ åŽé¢æ²¡æœ‰æµ®åŠ¨çš„å…ƒç´ ä¼šå æ®æµ®åŠ¨å…ƒç´ çš„ä½ç½®ï¼Œæ²¡æœ‰æµ®åŠ¨çš„å…ƒç´ å†…çš„æ–‡å­—ä¼šé¿å¼€æµ®åŠ¨çš„å…ƒç´ ï¼Œå½¢æˆæ–‡å­—é¥¶å›¾çš„æ•ˆæžœæµ®åŠ¨å…ƒç´ åŽé¢æ²¡æœ‰æµ®åŠ¨çš„å…ƒç´ ä¼šå æ®æµ®åŠ¨å…ƒç´ çš„ä½ç½®ï¼Œæ²¡æœ‰æµ®åŠ¨çš„å…ƒç´ å†…çš„æ–‡å­—ä¼šé¿å¼€æµ®åŠ¨çš„å…ƒç´ ï¼Œå½¢æˆæ–‡å­—é¥¶å›¾çš„æ•ˆæžœ&lt;/div&gt;&lt;/div&gt;3.10.2 æ¸…é™¤æµ®åŠ¨çˆ¶çº§ä¸Šå¢žåŠ å±žæ€§overflowï¼šhiddenåœ¨æœ€åŽä¸€ä¸ªå­å…ƒç´ çš„åŽé¢åŠ ä¸€ä¸ªç©ºçš„divï¼Œç»™å®ƒæ ·å¼å±žæ€§ clear:bothï¼ˆä¸æŽ¨èï¼‰ä½¿ç”¨æˆç†Ÿçš„æ¸…æµ®åŠ¨æ ·å¼ç±»ï¼Œclearfix123.clearfix:after,.clearfix:before&#123; content: "";display: table;&#125;.clearfix:after&#123; clear:both;&#125;.clearfix&#123;zoom:1;&#125;æ¸…é™¤æµ®åŠ¨çš„ä½¿ç”¨æ–¹æ³•ï¼š123.con2&#123;... overflow:hidden&#125;æˆ–è€…&lt;div class="con2 clearfix"&gt;ç†è§£ç»ƒä¹ çˆ¶çº§ç›’å­ä¸ç»™é«˜åº¦ï¼Œå­é›†ç›’å­æµ®åŠ¨ï¼Œçˆ¶çº§ç›’å­éœ€è¦æ¸…é™¤æµ®åŠ¨1234567891011121314151617181920212223242526272829303132333435363738394041424344454647.list&#123; width: 210px; /*height: 400px;*/ border: 1px solid #000000; margin: 50px auto 0; list-style: none; padding: 0; /* ç¬¬ä¸€ç§æ¸…é™¤æµ®åŠ¨çš„æ–¹æ³• */ /*overflow: hidden;*/&#125;.list li&#123; width: 50px; height: 50px; background-color: gold; margin: 10px; float: left;&#125;/* ç¬¬äºŒç§æ¸…é™¤æµ®åŠ¨çš„æ–¹æ³• */.clearfix:after,.clearfix:before&#123; content: ""; display: table;&#125;.clearfix:after&#123; clear:both;&#125;/* å…¼å®¹IEï¼Œç½‘é¡µä¸ç¼©æ”¾ */.clearfix&#123; zoom:1;&#125;&lt;!--ul.list&gt;li&#123;$&#125;*8--&gt;&lt;ul class="list clearfix"&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;3&lt;/li&gt; &lt;li&gt;4&lt;/li&gt; &lt;li&gt;5&lt;/li&gt; &lt;li&gt;6&lt;/li&gt; &lt;li&gt;7&lt;/li&gt; &lt;li&gt;8&lt;/li&gt; &lt;!--ç¬¬äºŒç§æ¸…é™¤æµ®åŠ¨çš„æ–¹æ³•--&gt; &lt;!--&lt;div style="clear: both"&gt;&lt;/div&gt;--&gt;&lt;/ul&gt;3.11 å®šä½3.11.1 æ–‡æ¡£æµæ–‡æ¡£æµï¼Œæ˜¯æŒ‡ç›’å­æŒ‰ç…§htmlæ ‡ç­¾ç¼–å†™çš„é¡ºåºä¾æ¬¡ä»Žä¸Šåˆ°ä¸‹ï¼Œä»Žå·¦åˆ°å³æŽ’åˆ—ï¼Œå—å…ƒç´ å ä¸€è¡Œï¼Œè¡Œå†…å…ƒç´ åœ¨ä¸€è¡Œä¹‹å†…ä»Žå·¦åˆ°å³æŽ’åˆ—ï¼Œå…ˆå†™çš„å…ˆæŽ’åˆ—ï¼ŒåŽå†™çš„æŽ’åœ¨åŽé¢ï¼Œæ¯ä¸ªç›’å­éƒ½å æ®è‡ªå·±çš„ä½ç½®ã€‚3.11.2 å…³äºŽå®šä½æˆ‘ä»¬å¯ä»¥ä½¿ç”¨cssçš„positionå±žæ€§æ¥è®¾ç½®å…ƒç´ çš„å®šä½ç±»åž‹ï¼Œpostionçš„è®¾ç½®é¡¹å¦‚ä¸‹ï¼šrelative ç”Ÿæˆç›¸å¯¹å®šä½å…ƒç´ ï¼Œå…ƒç´ æ‰€å æ®çš„æ–‡æ¡£æµçš„ä½ç½®ä¿ç•™ï¼Œå…ƒç´ æœ¬èº«ç›¸å¯¹è‡ªèº«åŽŸä½ç½®è¿›è¡Œåç§»ã€‚absolute ç”Ÿæˆç»å¯¹å®šä½å…ƒç´ ï¼Œå…ƒç´ è„±ç¦»æ–‡æ¡£æµï¼Œä¸å æ®æ–‡æ¡£æµçš„ä½ç½®ï¼Œå¯ä»¥ç†è§£ä¸ºæ¼‚æµ®åœ¨æ–‡æ¡£æµçš„ä¸Šæ–¹ï¼Œç›¸å¯¹äºŽä¸Šä¸€ä¸ªè®¾ç½®äº†å®šä½çš„çˆ¶çº§å…ƒç´ æ¥è¿›è¡Œå®šä½ï¼Œå¦‚æžœæ‰¾ä¸åˆ°ï¼Œåˆ™ç›¸å¯¹äºŽbodyå…ƒç´ è¿›è¡Œå®šä½ã€‚fixed ç”Ÿæˆå›ºå®šå®šä½å…ƒç´ ï¼Œå…ƒç´ è„±ç¦»æ–‡æ¡£æµï¼Œä¸å æ®æ–‡æ¡£æµçš„ä½ç½®ï¼Œå¯ä»¥ç†è§£ä¸ºæ¼‚æµ®åœ¨æ–‡æ¡£æµçš„ä¸Šæ–¹ï¼Œç›¸å¯¹äºŽæµè§ˆå™¨çª—å£è¿›è¡Œå®šä½ã€‚static é»˜è®¤å€¼ï¼Œæ²¡æœ‰å®šä½ï¼Œå…ƒç´ å‡ºçŽ°åœ¨æ­£å¸¸çš„æ–‡æ¡£æµä¸­ï¼Œç›¸å½“äºŽå–æ¶ˆå®šä½å±žæ€§æˆ–è€…ä¸è®¾ç½®å®šä½å±žæ€§ã€‚inherit ä»Žçˆ¶å…ƒç´ ç»§æ‰¿ position å±žæ€§çš„å€¼ã€‚123456789101112131415161718192021222324252627282930313233343536/* relative ç›¸å¯¹å®šä½å…ƒç´  */&lt;style type="text/css"&gt; .con&#123; width: 400px; height: 400px; border: 1px solid #000000; margin: 50px auto 0;&#125;.box01,.box02&#123; width: 300px; height: 100px; margin: 10px;&#125;.box01&#123; background-color: green; position: relative; left: 50px; top: 50px;&#125;.box02&#123; background-color: gold;&#125;&lt;/style&gt;&lt;div class="con"&gt; &lt;div class="box01"&gt; &lt;/div&gt; &lt;div class="box02"&gt; &lt;/div&gt;&lt;/div&gt;123456789101112131415161718192021222324252627282930313233343536/* absolute ç»å¯¹å®šä½å…ƒç´ :ç›¸å¯¹äºŽbodyå…ƒç´ è¿›è¡Œå®šä½ */&lt;style type="text/css"&gt; .con&#123; width: 400px; height: 400px; border: 1px solid #000000; margin: 50px auto 0; &#125; .box01,.box02&#123; width: 300px; height: 100px; margin: 10px; &#125; .box01&#123; background-color: green; position: absolute; left: 50px; top: 50px; &#125; .box02&#123; background-color: gold; &#125;&lt;/style&gt;&lt;div class="con"&gt; &lt;div class="box01"&gt; &lt;/div&gt; &lt;div class="box02"&gt; &lt;/div&gt;&lt;/div&gt;12345678910111213141516171819202122232425262728293031323334353637/* absolute ç»å¯¹å®šä½å…ƒç´ :ç›¸å¯¹äºŽä¸Šä¸€ä¸ªè®¾ç½®äº†å®šä½çš„çˆ¶çº§å…ƒç´ æ¥è¿›è¡Œå®šä½ */&lt;style type="text/css"&gt; .con&#123; width: 400px; height: 400px; border: 1px solid #000000; margin: 50px auto 0; position: relative;&#125; .box01,.box02&#123; width: 300px; height: 100px; margin: 10px; &#125; .box01&#123; background-color: green; position: absolute; left: 50px; top: 50px; &#125; .box02&#123; background-color: gold; &#125;&lt;/style&gt;&lt;div class="con"&gt; &lt;div class="box01"&gt; &lt;/div&gt; &lt;div class="box02"&gt; &lt;/div&gt;&lt;/div&gt;123456789101112131415161718192021222324252627282930313233343536/* fixed å›ºå®šå®šä½å…ƒç´ :ç›¸å¯¹äºŽæµè§ˆå™¨çª—å£è¿›è¡Œå®šä½ */&lt;style type="text/css"&gt; .con&#123; width: 400px; height: 400px; border: 1px solid #000000; margin: 50px auto 0;&#125;.box01,.box02&#123; width: 300px; height: 100px; margin: 10px;&#125;.box01&#123; background-color: green; position: fixed; left: 50px; top: 50px;&#125;.box02&#123; background-color: gold;&#125;&lt;/style&gt;&lt;div class="con"&gt; &lt;div class="box01"&gt; &lt;/div&gt; &lt;div class="box02"&gt; &lt;/div&gt;&lt;/div&gt;3.11.3 å®šä½å…ƒç´ çš„åç§»å®šä½çš„å…ƒç´ è¿˜éœ€è¦ç”¨leftã€rightã€topæˆ–è€…bottomæ¥è®¾ç½®ç›¸å¯¹äºŽå‚ç…§å…ƒç´ çš„åç§»å€¼ã€‚3.11.4 å®šä½å…ƒç´ å±‚çº§å®šä½å…ƒç´ æ˜¯æµ®åŠ¨çš„æ­£å¸¸çš„æ–‡æ¡£æµä¹‹ä¸Šçš„ï¼Œå¯ä»¥ç”¨z-indexå±žæ€§æ¥è®¾ç½®å…ƒç´ çš„å±‚çº§ä¼ªä»£ç å¦‚ä¸‹:1234567.box01&#123; ...... position:absolute; /* è®¾ç½®äº†ç»å¯¹å®šä½ */ left:200px; /* ç›¸å¯¹äºŽå‚ç…§å…ƒç´ å·¦è¾¹å‘å³åç§»200px */ top:100px; /* ç›¸å¯¹äºŽå‚ç…§å…ƒç´ é¡¶éƒ¨å‘ä¸‹åç§»100px */ z-index:10 /* å°†å…ƒç´ å±‚çº§è®¾ç½®ä¸º10(æ²¡æœ‰å•ä½) å¼¹æ¡†ä½¿ç”¨ï¼šç›–è¿‡æ‰€æœ‰çš„å…ƒç´  */&#125;1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950&lt;style type="text/css"&gt; .con&#123; width: 400px; height: 400px; border: 1px solid #000000; margin: 50px auto 0; position: relative; &#125; .con div&#123; width: 200px; height: 200px; position: absolute; &#125; .box01&#123; background-color: green; left: 20px; top: 20px; z-index: 10; &#125; .box02&#123; background-color: gold; left: 40px; top: 40px; z-index: 11; &#125; .box03&#123; background-color: rebeccapurple; left: 60px; top: 60px; z-index: 12; &#125; .box04&#123; background-color: pink; left: 80px; top: 80px; &#125;&lt;/style&gt;&lt;div class="con"&gt; &lt;div class="box01"&gt;&lt;/div&gt; &lt;div class="box02"&gt;&lt;/div&gt; &lt;div class="box03"&gt;&lt;/div&gt; &lt;div class="box04"&gt;&lt;/div&gt;&lt;/div&gt;3.11.5 å®šä½å…ƒç´ ç‰¹æ€§ç»å¯¹å®šä½å’Œå›ºå®šå®šä½çš„å—å…ƒç´ å’Œè¡Œå†…å…ƒç´ ä¼šè‡ªåŠ¨è½¬åŒ–ä¸ºè¡Œå†…å—å…ƒç´ 3.11.6 ç†è§£ç»ƒä¹ 1ã€åˆ¶ä½œå¦‚ä¸‹å¸ƒå±€ï¼š123456789101112131415161718192021222324252627282930313233&lt;style type="text/css"&gt; .con&#123; width: 100px; height: 100px; background-color: gold; margin: 50px auto 0; position: relative; /*åŽ»æŽ‰å°–è§’æˆåœ†çš„ï¼Œè‹¥æ˜¯åœ†å½¢éœ€è¦è®¾ç½®æˆ50px*/ border-radius: 14px; &#125; .box&#123; width: 28px; height: 28px; background-color: red; color: white; text-align: center; line-height: 28px; /* ä½ç½® */ position: absolute; left: 86px; top: -14px; /* å˜æˆåœ†çš„ */ border-radius: 14px; &#125;&lt;/style&gt;&lt;div class="con"&gt; &lt;div class="box"&gt;5&lt;/div&gt;&lt;/div&gt;2ã€å›ºå®šåœ¨é¡¶éƒ¨çš„æ°´å¹³å±…ä¸­çš„èœå•12345678910111213141516&lt;style type="text/css"&gt; .menu&#123; height: 80px; background-color: gold; position: fixed; width: 960px; top: 0px; /* æ ¹æ®çª—å£å¤§å°è®¾ç½®ç™¾åˆ†æ¯” */ left: 50%; /* æ ¹æ®å‰é¢çš„ç™¾åˆ†æ¯”å†è¿›è¡Œåç§»ï¼Œè´Ÿå€¼è¡¨ç¤ºå¾€å·¦ä¾§åç§» */ margin-left: -480px; &#125;&lt;/style&gt;&lt;div class="menu"&gt;èœå•æ–‡å­—&lt;/div&gt;3ã€ç›¸å¯¹äºŽæµè§ˆå™¨çª—å£æ°´å¹³åž‚ç›´å±…ä¸­çš„å¼¹æ¡†123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103&lt;style type="text/css"&gt; .menu&#123; height: 80px; background-color: gold; position: fixed; width: 960px; top: 0px; left: 50%; margin-left: -480px; &#125; p&#123; text-align: center; &#125; .popup&#123; width: 500px; height: 300px; border: 1px solid #000000; background-color: #ffffff; position: fixed; left: 50%; margin-left: -251px; top: 50%; margin-top: -151px; z-index: 9999; &#125; .popup h2&#123; background-color: gold; margin: 10px; height: 40px; &#125; .mask&#123; position: fixed; width: 100%; height: 100%; background-color: grey; left: 0; top: 0; /*é€æ˜Žåº¦*/ opacity: 0.5; z-index: 9998; &#125; .popup&#123; display: block; &#125;&lt;/style&gt;&lt;div class="menu"&gt;èœå•æ–‡å­—&lt;/div&gt;&lt;div class="pop_con"&gt; &lt;div class="popup"&gt; &lt;h2&gt;å¼¹æ¡†çš„æ ‡é¢˜&lt;/h2&gt; &lt;/div&gt; &lt;div class="mask"&gt;&lt;/div&gt;&lt;/div&gt;&lt;p&gt;ç½‘é¡µå†…å®¹&lt;/p&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;p&gt;ç½‘é¡µå†…å®¹&lt;/p&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;p&gt;ç½‘é¡µå†…å®¹&lt;/p&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;3.12 backgroundå±žæ€§3.12.1 å±žæ€§è§£é‡Šbackgroundå±žæ€§æ˜¯cssä¸­åº”ç”¨æ¯”è¾ƒå¤šï¼Œä¸”æ¯”è¾ƒé‡è¦çš„ä¸€ä¸ªå±žæ€§ï¼Œå®ƒæ˜¯è´Ÿè´£ç»™ç›’å­è®¾ç½®èƒŒæ™¯å›¾ç‰‡å’ŒèƒŒæ™¯é¢œè‰²çš„ï¼Œbackgroundæ˜¯ä¸€ä¸ªå¤åˆå±žæ€§ï¼Œå®ƒå¯ä»¥åˆ†è§£æˆå¦‚ä¸‹å‡ ä¸ªè®¾ç½®é¡¹ï¼šbackground-color è®¾ç½®èƒŒæ™¯é¢œè‰²background-image è®¾ç½®èƒŒæ™¯å›¾ç‰‡åœ°å€background-repeat è®¾ç½®èƒŒæ™¯å›¾ç‰‡å¦‚ä½•é‡å¤å¹³é“ºbackground-position è®¾ç½®èƒŒæ™¯å›¾ç‰‡çš„ä½ç½®background-attachment è®¾ç½®èƒŒæ™¯å›¾ç‰‡æ˜¯å›ºå®šè¿˜æ˜¯éšç€é¡µé¢æ»šåŠ¨æ¡æ»šåŠ¨å®žé™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨backgroundå±žæ€§å°†ä¸Šé¢æ‰€æœ‰çš„è®¾ç½®é¡¹æ”¾åœ¨ä¸€èµ·ï¼Œè€Œä¸”ä¹Ÿå»ºè®®è¿™ä¹ˆåšï¼Œè¿™æ ·åšæ€§èƒ½æ›´é«˜ï¼Œè€Œä¸”å…¼å®¹æ€§æ›´å¥½ï¼Œæ¯”å¦‚ï¼šâ€œbackground: #00FF00 url(bgimage.gif) no-repeat left center fixedâ€ï¼Œè¿™é‡Œé¢çš„â€œ#00ff00â€æ˜¯è®¾ç½®background-colorï¼›â€œurl(bgimage.gif)â€æ˜¯è®¾ç½®background-imageï¼›â€œno-repeatâ€æ˜¯è®¾ç½®background-repeatï¼›â€œleft centerâ€æ˜¯è®¾ç½®background-positionï¼›â€œfixedâ€æ˜¯è®¾ç½®background-attachmentï¼Œå„ä¸ªè®¾ç½®é¡¹ç”¨ç©ºæ ¼éš”å¼€ï¼Œæœ‰çš„è®¾ç½®é¡¹ä¸å†™ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œå®ƒä¼šä½¿ç”¨é»˜è®¤å€¼ã€‚3.12.2 ä¸¾ä¾‹ä¸‹é¢è¿™äº›ä¾‹å­ä½¿ç”¨ä¸‹é¢è¿™å¼ å›¾ç‰‡åšä¸ºèƒŒæ™¯å›¾ï¼š1ã€â€œbackground:url(bg.jpg)â€ï¼Œé»˜è®¤è®¾ç½®ä¸€ä¸ªå›¾ç‰‡åœ°å€ï¼Œå›¾ç‰‡ä¼šä»Žç›’å­çš„å·¦ä¸Šè§’å¼€å§‹å°†ç›’å­é“ºæ»¡ã€‚2ã€â€œbackground:cyan url(bg.jpg) repeat-xâ€ï¼Œæ¨ªå‘å¹³é“ºç›’å­ï¼Œç›’å­å…¶ä»–éƒ¨åˆ†æ˜¾ç¤ºèƒŒæ™¯é¢œè‰²â€œcyanâ€ã€‚3ã€â€œbackground:cyan url(bg.jpg) repeat-yâ€ï¼Œçºµå‘å¹³é“ºç›’å­ï¼Œç›’å­å…¶ä»–éƒ¨åˆ†æ˜¾ç¤ºèƒŒæ™¯é¢œè‰²â€œcyanâ€ã€‚4ã€â€œbackground:cyan url(bg.jpg) no-repeatâ€ï¼ŒèƒŒæ™¯ä¸é‡å¤ï¼ŒèƒŒæ™¯å’Œç›’å­å·¦ä¸Šè§’å¯¹é½ï¼Œç›’å­å…¶ä»–éƒ¨åˆ†æ˜¾ç¤ºèƒŒæ™¯é¢œè‰²â€œcyanâ€ã€‚5ã€â€œbackground:cyan url(bg.jpg) no-repeat left centerâ€ï¼ŒèƒŒæ™¯ä¸é‡å¤ï¼ŒèƒŒæ™¯å’Œç›’å­å·¦ä¸­å¯¹é½ï¼Œç›’å­å…¶ä»–éƒ¨åˆ†æ˜¾ç¤ºèƒŒæ™¯é¢œè‰²â€œcyanâ€ã€‚6ã€â€œbackground:cyan url(bg.jpg) no-repeat right centerâ€ï¼ŒèƒŒæ™¯ä¸é‡å¤ï¼ŒèƒŒæ™¯å’Œç›’å­å³ä¸­å¯¹é½ï¼Œä¹Ÿå°±æ˜¯èƒŒæ™¯å›¾ç‰‡çš„å³è¾¹å¯¹é½ç›’å­çš„å³è¾¹ï¼Œç›’å­å…¶ä»–éƒ¨åˆ†æ˜¾ç¤ºèƒŒæ™¯é¢œè‰²â€œcyanâ€ã€‚ç›¸å…³ä»£ç ï¼š123456789101112131415161718192021222324252627282930&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;test background&lt;/title&gt; &lt;style type="text/css"&gt; .backshow&#123; width:320px; height:160px; border:3px solid #333; float:left; margin:10px; &#125; .bg1&#123;background:cyan url(bg.jpg);&#125; .bg2&#123;background:cyan url(bg.jpg) repeat-x;&#125; .bg3&#123;background:cyan url(bg.jpg) repeat-y;&#125; .bg4&#123;background:cyan url(bg.jpg) no-repeat;&#125; .bg5&#123;background:cyan url(bg.jpg) no-repeat left center;&#125; .bg6&#123;background:cyan url(bg.jpg) no-repeat right center;&#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="backshow bg1"&gt;&lt;/div&gt; &lt;div class="backshow bg2"&gt;&lt;/div&gt; &lt;div class="backshow bg3"&gt;&lt;/div&gt; &lt;div class="backshow bg4"&gt;&lt;/div&gt; &lt;div class="backshow bg5"&gt;&lt;/div&gt; &lt;div class="backshow bg6"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;ä¾‹å­è¯´æ˜Žï¼šbackground-positionçš„è®¾ç½®ï¼Œå¯ä»¥åœ¨æ°´å¹³æ–¹å‘è®¾ç½®â€œleftâ€ã€â€œcenterâ€ã€â€œrightâ€ï¼Œåœ¨åž‚ç›´æ–¹å‘è®¾ç½®â€œtopâ€ã€â€œcenterâ€ã€â€œbottomâ€ï¼Œé™¤äº†è®¾ç½®è¿™äº›æ–¹ä½è¯ä¹‹å¤–ï¼Œè¿˜å¯ä»¥è®¾ç½®å…·ä½“çš„æ•°å€¼ã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬æƒ³æŠŠä¸‹è¾¹çš„ç›’å­ç”¨å³è¾¹çš„å›¾ç‰‡ä½œä¸ºèƒŒæ™¯ï¼Œå¹¶ä¸”è®©èƒŒæ™¯æ˜¾ç¤ºå›¾ç‰‡ä¸­é è¿‘åº•éƒ¨çš„é‚£æœµèŠ±ï¼šç”¨ä¸Šé¢ä¸­é—´é‚£å¼ å›¾ç‰‡ä½œä¸ºå·¦è¾¹é‚£ä¸ªæ¯”å®ƒå°ºå¯¸å°çš„ç›’å­çš„èƒŒæ™¯ï¼Œä¸Šé¢å³è¾¹çš„å®žçŽ°æ•ˆæžœè®¾ç½®ä¸ºï¼šâ€œbackground:url(location_bg.jpg) -110px -150pxâ€ï¼Œç¬¬ä¸€ä¸ªæ•°å€¼è¡¨ç¤ºèƒŒæ™¯å›¾ç›¸å¯¹äºŽè‡ªå·±çš„å·¦ä¸Šè§’å‘å·¦åç§»110pxï¼Œè´Ÿå€¼å‘å·¦ï¼Œæ­£å€¼å‘å³ï¼Œç¬¬äºŒä¸ªæ•°å€¼è¡¨ç¤ºèƒŒæ™¯å›¾ç›¸å¯¹äºŽè‡ªå·±çš„å·¦ä¸Šè§’å‘ä¸Šåç§»150pxï¼Œè´Ÿå€¼å‘ä¸Šï¼Œæ­£å€¼å‘ä¸‹ã€‚å®žçŽ°åŽŸç†ç¤ºæ„å›¾ï¼šå¯¹åº”ä»£ç ï¼š123456789101112131415161718192021222324&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;test background&lt;/title&gt; &lt;style type="text/css"&gt; .backshow&#123; width:320px; height:160px; border:3px solid #333; float:left; margin:10px; &#125; .bg&#123;width:94px; height:94px; border:3px solid #666; background:url(location_bg.jpg) -110px -150px; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="bg"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;ç†è§£ç»ƒä¹ ï¼šé€šè¿‡é›ªç¢§å›¾åˆ¶ä½œå¦‚ä¸‹å¸ƒå±€ï¼š3.13 ç‰¹å¾å¸ƒå±€å®žä¾‹è®²ä¹ ç»è¿‡å¯¹å‰é¢çŸ¥è¯†ç‚¹çš„å·©å›ºå’ŒåŠ æ·±ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‰é¢å­¦ä¹ åˆ°çš„çŸ¥è¯†æ¥åˆ¶ä½œå®žé™…å¼€å‘ä¸­ç¢°åˆ°çš„ä¸€äº›å…¸åž‹çš„å¸ƒå±€ï¼Œä»¥æ­¤æ¥è¾¾åˆ°ç»¼åˆåº”ç”¨çŸ¥è¯†çš„ç›®çš„ã€‚1ã€ç‰¹å¾å¸ƒå±€ï¼šç¿»é¡µï¼ˆæ‰€éœ€çŸ¥è¯†ç‚¹ï¼šç›’æ¨¡åž‹ã€å†…è”å…ƒç´ ï¼‰2ã€ç‰¹å¾å¸ƒå±€ï¼šå¯¼èˆªæ¡01ï¼ˆæ‰€éœ€çŸ¥è¯†ç‚¹ï¼šç›’æ¨¡åž‹ã€è¡Œå†…å…ƒç´ å¸ƒå±€ï¼‰3ã€ç‰¹å¾å¸ƒå±€ï¼šå¯¼èˆªæ¡02ï¼ˆæ‰€éœ€çŸ¥è¯†ç‚¹ï¼šç›’æ¨¡åž‹ã€æµ®åŠ¨ã€å®šä½ã€å­—ä½“å¯¹é½ï¼‰4ã€ç‰¹å¾å¸ƒå±€ï¼šå›¾ç‰‡åˆ—è¡¨ï¼ˆæ‰€éœ€çŸ¥è¯†ç‚¹ï¼šç›’æ¨¡åž‹ã€æµ®åŠ¨ï¼‰5ã€ç‰¹å¾å¸ƒå±€ï¼šæ–°é—»åˆ—è¡¨ï¼ˆæ‰€éœ€çŸ¥è¯†ç‚¹ï¼šç›’æ¨¡åž‹ã€æµ®åŠ¨ï¼‰è¯¾åŽç»ƒä¹ 4. Photoshop4.1 å¸¸ç”¨å›¾ç‰‡æ ¼å¼å›¾ç‰‡æ˜¯ç½‘é¡µåˆ¶ä½œä¸­å¾ˆé‡è¦çš„ç´ æï¼Œå›¾ç‰‡æœ‰ä¸åŒçš„æ ¼å¼ï¼Œæ¯ç§æ ¼å¼éƒ½æœ‰è‡ªå·±çš„ç‰¹æ€§ï¼Œäº†è§£è¿™äº›ç‰¹æ•ˆï¼Œå¯ä»¥æ–¹ä¾¿æˆ‘ä»¬åœ¨åˆ¶ä½œç½‘é¡µæ—¶é€‰å–é€‚åˆçš„å›¾ç‰‡æ ¼å¼ï¼Œå›¾ç‰‡æ ¼å¼åŠç‰¹æ€§å¦‚ä¸‹ï¼š1ã€psdphotoshopçš„ä¸“ç”¨æ ¼å¼ã€‚ä¼˜ç‚¹ï¼šå®Œæ•´ä¿å­˜å›¾åƒçš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬æœªåŽ‹ç¼©çš„å›¾åƒæ•°æ®ã€å›¾å±‚ã€é€æ˜Žç­‰ä¿¡æ¯ï¼Œæ–¹ä¾¿å›¾åƒçš„ç¼–è¾‘ã€‚ç¼ºç‚¹ï¼šåº”ç”¨èŒƒå›´çª„ï¼Œå›¾ç‰‡å®¹é‡ç›¸å¯¹æ¯”è¾ƒå¤§ã€‚2ã€jpgç½‘é¡µåˆ¶ä½œåŠæ—¥å¸¸ä½¿ç”¨æœ€æ™®éçš„å›¾åƒæ ¼å¼ã€‚ä¼˜ç‚¹ï¼šå›¾åƒåŽ‹ç¼©æ•ˆçŽ‡é«˜ï¼Œå›¾åƒå®¹é‡ç›¸å¯¹æœ€å°ã€‚ç¼ºç‚¹ï¼šæœ‰æŸåŽ‹ç¼©ï¼Œå›¾åƒä¼šä¸¢å¤±æ•°æ®è€Œå¤±çœŸï¼Œä¸æ”¯æŒé€æ˜ŽèƒŒæ™¯ï¼Œä¸èƒ½åˆ¶ä½œæˆåŠ¨ç”»ã€‚3ã€gifåˆ¶ä½œç½‘é¡µå°åŠ¨ç”»çš„å¸¸ç”¨å›¾åƒæ ¼å¼ã€‚ä¼˜ç‚¹ï¼šæ— æŸåŽ‹ç¼©ï¼Œå›¾åƒå®¹é‡å°ã€å¯ä»¥åˆ¶ä½œæˆåŠ¨ç”»ã€æ”¯æŒé€æ˜ŽèƒŒæ™¯ã€‚ç¼ºç‚¹ï¼šå›¾åƒè‰²å½©èŒƒå›´æœ€å¤šåªæœ‰256è‰²ï¼Œä¸èƒ½ä¿å­˜è‰²å½©ä¸°å¯Œçš„å›¾åƒï¼Œä¸æ”¯æŒåŠé€æ˜Žï¼Œé€æ˜Žå›¾åƒè¾¹ç¼˜æœ‰é”¯é½¿ã€‚4ã€pngç½‘é¡µåˆ¶ä½œåŠæ—¥å¸¸ä½¿ç”¨æ¯”è¾ƒæ™®éçš„å›¾åƒæ ¼å¼ã€‚ä¼˜ç‚¹ï¼šæ— æŸåŽ‹ç¼©ï¼Œå›¾åƒå®¹é‡å°ã€æ”¯æŒé€æ˜ŽèƒŒæ™¯å’ŒåŠé€æ˜Žè‰²å½©ã€é€æ˜Žå›¾åƒçš„è¾¹ç¼˜å…‰æ»‘ã€‚ç¼ºç‚¹ï¼šä¸èƒ½åˆ¶ä½œæˆåŠ¨ç”»5ã€webpå°†è¦å–ä»£jpgçš„å›¾åƒæ ¼å¼ã€‚ä¼˜ç‚¹ï¼šåŒjpgæ ¼å¼ï¼Œå®¹é‡ç›¸å¯¹æ¯”jpgè¿˜è¦å°ã€‚ç¼ºç‚¹ï¼šåŒjpgæ ¼å¼ï¼Œç›®å‰ä¸æ”¯æŒæ‰€æœ‰çš„æµè§ˆå™¨ã€‚ä½å›¾å’ŒçŸ¢é‡å›¾ä½å›¾ä¹Ÿå«ç‚¹é˜µå›¾ï¼Œæ˜¯ç”±ä¸€ä¸ªä¸ªçš„æ–¹å½¢çš„åƒç´ ç‚¹æŽ’åˆ—åœ¨ä¸€èµ·æ‹¼æŽ¥è€Œæˆçš„ï¼Œä½å›¾åœ¨æ”¾å¤§æ—¶ï¼Œå›¾åƒä¼šå¤±çœŸã€‚ä¸Šé¢è®²çš„5ç§å›¾åƒéƒ½å±žäºŽä½å›¾ã€‚çŸ¢é‡å›¾å’Œä½å›¾ç»„æˆå›¾åƒçš„åŽŸç†ä¸åŒï¼Œå®ƒçš„å›¾åƒè½®å»“æ˜¯ç”±å‡½æ•°æ›²çº¿ç”Ÿæˆçš„ï¼Œå½“æ”¾å¤§å›¾åƒæ—¶ï¼Œå®žé™…çš„åŽŸç†å°±æ˜¯å°†æ›²çº¿ä¹˜ä»¥ä¸€ä¸ªå€æ•°ï¼Œå›¾åƒå¯ä»¥è½»æ˜“åœ°æ”¾å¤§ï¼Œè€Œä¸”ä¸ä¼šå‡ºçŽ°åƒç´ å—ï¼Œå›¾åƒè¾¹ç¼˜ä¹Ÿä¸ä¼šå‡ºçŽ°é”¯é½¿ã€‚svgç›®å‰é¦–é€‰çš„ç½‘é¡µçŸ¢é‡å›¾æ ¼å¼ã€‚ä¼˜ç‚¹ï¼šå›¾åƒå®¹é‡å°ã€å›¾åƒæ”¾å¤§ä¸å¤±çœŸã€æ”¯æŒé€æ˜ŽèƒŒæ™¯å’ŒåŠé€æ˜Žè‰²å½©ã€å›¾åƒè¾¹ç¼˜å…‰æ»‘ã€‚ç¼ºç‚¹ï¼šè‰²å½©ä¸å¤Ÿä¸°å¯Œã€‚flashé€€å‡ºåŽ†å²çš„é‡é‡çº§ç½‘é¡µçŸ¢é‡å›¾æ ¼å¼ã€‚ä¼˜ç‚¹ï¼šå›¾åƒå®¹é‡å°ã€å›¾åƒæ”¾å¤§ä¸å¤±çœŸã€æ”¯æŒé€æ˜ŽèƒŒæ™¯å’ŒåŠé€æ˜Žè‰²å½©ã€å›¾åƒè¾¹ç¼˜å…‰æ»‘ã€è¿˜å¯ä»¥åˆ¶ä½œåŠ¨ç”»ã€å¯ç¼–å†™äº¤äº’ã€‚ç¼ºç‚¹ï¼šä¸æ”¯æŒæœç´¢å¼•æ“Žã€è¿è¡Œæ…¢ã€æµè§ˆå™¨éœ€è¦è£…æ’ä»¶æ‰å¯æ”¯æŒã€‚æ€»ç»“åœ¨ç½‘é¡µåˆ¶ä½œä¸­ï¼Œå¦‚ä½•é€‰æ‹©åˆé€‚çš„å›¾ç‰‡æ ¼å¼å‘¢ï¼Ÿ1ã€ä½¿ç”¨å¤§å¹…é¢å›¾ç‰‡æ—¶ï¼Œå¦‚æžœè¦ä½¿ç”¨ä¸é€æ˜ŽèƒŒæ™¯çš„å›¾ç‰‡ï¼Œå°±ä½¿ç”¨jpgå›¾ç‰‡ï¼›å¦‚æžœè¦ä½¿ç”¨é€æ˜Žæˆ–è€…åŠé€æ˜ŽèƒŒæ™¯çš„å›¾ç‰‡ï¼Œå°±ä½¿ç”¨pngå›¾ç‰‡ï¼›2ã€ä½¿ç”¨å°å¹…é¢å›¾ç‰‡æˆ–è€…å›¾æ ‡å›¾ç‰‡æ—¶ï¼Œå¦‚æžœå›¾ç‰‡å«å¤šç§é¢œè‰²ï¼Œå¯ä»¥ä½¿ç”¨gifæˆ–pngå›¾ç‰‡ï¼›å¦‚æžœå›¾ç‰‡æ˜¯å•è‰²ï¼Œè€Œä¸”è¦æ±‚æœ‰å¾ˆå¥½çš„æ˜¾ç¤ºæ•ˆæžœï¼Œå¯ä»¥ä½¿ç”¨svgï¼›å¦‚æžœæ˜¯å›¾ç‰‡æ—¶åŠ¨ç”»çš„ï¼Œå¯ä»¥ä½¿ç”¨gifã€‚4.2 photoshopå¸¸ç”¨å›¾ç‰‡å¤„ç†æŠ€å·§photoshopæ˜¯ä¸€æ¬¾ä¼˜ç§€çš„å›¾åƒå¤„ç†è½¯ä»¶ï¼Œä½œä¸ºå‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆï¼ŒæŽŒæ¡å®ƒçš„ä¸€äº›å¸¸ç”¨åŠŸèƒ½æ˜¯å¿…é¡»çš„ã€‚photoshopçš„å¸¸ç”¨åŠŸèƒ½æœ‰ï¼šé€‰æ‹©ã€è£å‰ªå›¾åƒã€ä¿®å›¾ã€å–è‰²ã€æ’å…¥æ–‡å­—ç­‰ç­‰ã€‚é™¤äº†è¿™äº›å¸¸ç”¨åŠŸèƒ½ï¼Œå‰ç«¯è¿˜éœ€è¦æŽŒæ¡åˆ¶ä½œæ–°å›¾åƒã€åˆ‡å›¾ç­‰æŠ€å·§ã€‚æœ¬æ¬¡è®²è§£çš„photoshopç‰ˆæœ¬ä¸ºcs6ã€‚4.2.1 å›¾ç‰‡æ ¼å¼è½¬æ¢ä¸ŽåŽ‹ç¼©1ã€æ–‡ä»¶/å­˜å‚¨ä¸º é€‰æ‹©å›¾ç‰‡ç±»åž‹ä»¥åŠåŽ‹ç¼©æ¯”ï¼›ï¼ˆä¸æŽ¨èï¼‰2ã€æ–‡ä»¶/å­˜å‚¨ä¸ºwebæ‰€ç”¨æ ¼å¼ é€‰æ‹©å›¾ç‰‡ç±»åž‹ä»¥åŠåŽ‹ç¼©æ¯” ï¼ˆæŽ¨èï¼‰ï¼›4.2.2 å›¾åƒæ”¾ç¼©ï¼Œå¹³ç§»1ã€ æ”¾ç¼©å·¥å…· å›¾åƒæ”¾å¤§ç¼©å°ï¼Œåœ¨å›¾åƒä¸Šç‚¹å‡»æ”¾å¤§ï¼ŒæŒ‰ä½alté”®ç‚¹å‡»ç¼©å°ï¼Œå¿«æ·é”®Ctrl+â€œ+â€æ”¾å¤§ Ctrl+â€œ-â€ç¼©å°ï¼ŒåŒå‡»æ­¤å·¥å…·å¯ä»¥è®©å›¾åƒæŒ‰ç…§åŽŸå§‹å¤§å°æ˜¾ç¤ºã€‚2ã€ å¹³ç§»å·¥å…· å¯¹å›¾åƒè¿›è¡Œç§»åŠ¨ï¼Œåœ¨ä½¿ç”¨å…¶ä»–å·¥å…·æ—¶ï¼ŒæŒ‰ä½ç©ºæ ¼é”®ç›˜çš„ç©ºæ ¼é”®ï¼Œå¯ä»¥åˆ‡æ¢åˆ°æ­¤å·¥å…·ï¼Œç§»åŠ¨å®ŒåŽæ¾å¼€ç©ºæ ¼é”®å›žåˆ°åŽŸæ¥çš„å·¥å…·ã€‚åŒå‡»æ­¤å·¥å…·å¯ä»¥è®©å›¾åƒæ”¾ç¼©åˆ°æ˜¾ç¤ºåŒºåŸŸå®Œå…¨æ˜¾ç¤ºã€‚4.2.3 æ–°å»ºå›¾åƒæ‰§è¡Œèœå•å‘½ä»¤ æ–‡ä»¶/æ–°å»º å¯ä»¥æ–°å»ºä¸€å¼ å›¾ç‰‡ï¼Œè®¾ç½®å¤§å°ï¼Œé¢œè‰²æ¨¡å¼é€‰RGBï¼Œç½‘é¡µå›¾ç‰‡ä¸€èˆ¬é€‰æ‹©72åƒç´ /è‹±å¯¸ï¼Œå¦‚æžœå›¾åƒè¦æ‰“å°ï¼Œå¯è®¾ä¸º300/è‹±å¯¸ã€‚èƒŒæ™¯æŒ‰æƒ…å†µé€‰é€æ˜Žæˆ–ç™½è‰²ã€‚4.2.4 ç§»åŠ¨é€‰æ‹©ä¸Žå›¾å±‚é¢æ¿1ã€æŒ‰ä½Ctrlï¼Œåœ¨å›¾åƒä¸Šç‚¹å‡»å¯ä»¥é€‰ä¸­å›¾å±‚2ã€ é€‰æ‹©æ­¤å·¥å…·ï¼Œå‹¾é€‰å·¥å…·å±žæ€§æ ä¸Šçš„â€œè‡ªåŠ¨é€‰æ‹©å›¾å±‚â€ï¼Œå¯ä»¥åœ¨å›¾åƒä¸Šç‚¹å‡»é€‰ä¸­å›¾å±‚3ã€ç§»åŠ¨å…ƒç´ åŒæ—¶æŒ‰ä½Alté”®å¯å¤åˆ¶ä¸€ä¸ªå›¾å±‚4ã€å›¾å±‚é¢æ¿çš„æ“ä½œï¼ŒåŒ…æ‹¬å›¾å±‚çš„æ˜¾ç¤ºéšè—ã€å›¾å±‚é¡ºåºã€æ–°å»ºå›¾å±‚ã€å›¾å±‚åˆ é™¤4.2.5 é’ˆå¯¹å›¾åƒä¸­é€‰ä¸­å›¾å±‚çš„æ“ä½œ1ã€ç§»åŠ¨2ã€è‡ªç”±å˜æ¢ æ‰§è¡Œèœå•å‘½ä»¤ ç¼–è¾‘/è‡ªç”±å˜æ¢3ã€æ‹–æ‹½åˆ°å¦ä¸€å¼ å›¾åƒä¸Šå®Œæˆå›¾å±‚æ‹·è´4.2.6 åŽ†å²è®°å½•é¢æ¿è®°å½•20éƒ¨æ“ä½œï¼Œå¯ä»¥ç‚¹å‡»å·²ç»è®°å½•çš„æ“ä½œæ­¥éª¤å›žåˆ°ä¹‹å‰4.2.7 é€‰æ‹©å·¥å…·1ã€ çŸ©å½¢é€‰æ‹©å·¥å…·2ã€ æ¤­åœ†é€‰æ‹©å·¥å…· æŒ‰ä½alt+shifté”®å¯ä»¥ä»Žä¸­å¿ƒæ‹‰å‡ºæ­£åœ†3ã€ ä»»æ„å¥—ç´¢å·¥å…· ç”¨æ‰‹ä»»æ„ç”»å‡ºé€‰åŒºï¼Œä¸ç²¾ç¡®ï¼Œä¸å¸¸ç”¨4ã€ å¤šè¾¹å½¢å¥—ç´¢ å¯ä»¥é€‰æ‹©å¤šè¾¹å½¢ç‰©ä½“ï¼Œå¯¹äºŽç»“æž„å¤æ‚çš„ç‰©ä½“ï¼Œå¯ä»¥ç‚¹å¤šä¸ªå°æ®µæ¥é€‰æ‹©ã€‚5ã€ ç£æ€§å¥—ç´¢ å¯ä»¥è‡ªåŠ¨åœ¨ç‰©ä½“è¾¹ç¼˜ç”Ÿæˆé€‰æ‹©çº¿ï¼Œä½†æ˜¯ç”±äºŽå¤ªè‡ªåŠ¨äº†ï¼Œæ‰€ä»¥ä¸å¤Ÿç²¾ç¡®ï¼Œä¹Ÿä¸å¸¸ç”¨ã€‚6ã€ é­”æœ¯æ£’é€‰æ‹©å·¥å…· æŒ‰ç…§ç‚¹å‡»çš„ç‚¹çš„é¢œè‰²èŒƒå›´æ¥é€‰æ‹©ï¼Œå¯ä»¥è®¾ç½®èŒƒå›´çš„å®¹å·®ï¼Œå®¹å·®è¶Šå¤§ï¼Œé€‰æ‹©åŒºåŸŸè¶Šå¤§ï¼Œå¯¹äºŽæœ‰å•è‰²èƒŒæ™¯çš„å›¾åƒä¸­çš„å…ƒç´ ï¼Œå¯ä»¥ç”¨å®ƒç‚¹é€‰èƒŒæ™¯ï¼Œç„¶åŽåé€‰ï¼Œä»Žè€Œé€‰ä¸­å…ƒç´ ã€‚7ã€ å¿«é€Ÿé€‰æ‹©å·¥å…· ç›´æŽ¥åœ¨è¦é€‰çš„å…ƒç´ ä¸Šç”»ï¼ŒæŒ‰ç…§ç”»çš„é¢œè‰²èŒƒå›´è¿›è¡Œé€‰æ‹©ã€‚8ã€å¯¹å›¾å±‚åˆ›å»ºé€‰åŒºï¼šæŒ‰ä½Ctrlï¼Œç”¨é¼ æ ‡ç‚¹å‡»å›¾å±‚é¢æ¿ä¸­å›¾å±‚çš„å›¾æ ‡ï¼Œåœ¨å›¾å±‚å¤–æ¡†ç”Ÿæˆé€‰åŒºã€‚4.2.8 é€‰åŒºçš„ç¼–è¾‘æŠ€å·§1ã€æ–°é€‰åŒºæ¨¡å¼ä¸‹ç§»åŠ¨é€‰åŒº2ã€é€‰åŒºçš„åŠ ã€å‡ã€ä¹˜ï¼Œå·¥å…·å±žæ€§æ ä¸Šè®¾ç½®3ã€è°ƒæ•´è¾¹ç¼˜ å·¥å…·å±žæ€§æ æˆ–è€…æ‰§è¡Œèœå•å‘½ä»¤ é€‰æ‹©/è°ƒæ•´è¾¹ç¼˜4ã€å˜æ¢é€‰åŒº æ‰§è¡Œèœå•å‘½ä»¤ é€‰æ‹©/å˜æ¢é€‰åŒºï¼Œå¯å¯¹é€‰åŒºè¿›è¡Œç¼©æ”¾ã€ç§»åŠ¨ç­‰5ã€åé€‰ æ‰§è¡Œèœå•å‘½ä»¤ é€‰æ‹©/åå‘6ã€å–æ¶ˆé€‰æ‹© æ‰§è¡Œèœå•å‘½ä»¤ é€‰æ‹©/å–æ¶ˆé€‰æ‹©ï¼Œå¿«æ·é”®ctrl+d4.2.9 é€‰åŒºç‰¹åˆ«æ³¨æ„é€‰åŒºï¼ˆèš‚èšçº¿ï¼‰åªå¯¹å½“å‰å›¾å±‚å™¨èµ·ä½œç”¨ï¼Œé€‰åŒºæ“ä½œå¤±è´¥ä¸€èˆ¬æ˜¯å½“å‰å›¾å±‚å¼„é”™äº†4.2.10 è£å‰ªå›¾åƒ1ã€ è£åˆ‡å·¥å…·2ã€å¯¹é€‰åŒºæ‰§è¡Œèœå•å‘½ä»¤ å›¾åƒ/è£å‰ª3ã€è®¾ç½®çŸ©å½¢æ¡†å¤§å°ï¼Œåˆ›å»ºå›ºå®šå®½é«˜çš„çŸ©å½¢æ¡†ï¼Œå¯è¿›è¡Œå›ºå®šå°ºå¯¸è£å‰ª4.2.11 é’ˆå¯¹ç¡®å®šé€‰åŒºçš„æ“ä½œæŠ€å·§1ã€å¤åˆ¶ æ‰§è¡Œèœå•å‘½ä»¤ ç¼–è¾‘/æ‹·è´ å¿«æ·é”®ctrl+c2ã€ç²˜è´´ æ‰§è¡Œèœå•å‘½ä»¤ ç¼–è¾‘/ç²˜è´´ å¿«æ·é”®ctrl+v3ã€å¡«å…… æ‰§è¡Œèœå•å‘½ä»¤ ç¼–è¾‘/å¡«å……4ã€æè¾¹ æ‰§è¡Œèœå•å‘½ä»¤ ç¼–è¾‘/æè¾¹5ã€åˆ é™¤ æ‰§è¡Œèœå•å‘½ä»¤ ç¼–è¾‘/æ¸…é™¤ å¿«æ·é”® delete6ã€è‡ªç”±å˜æ¢ æ‰§è¡Œèœå•å‘½ä»¤ ç¼–è¾‘/è‡ªç”±å˜æ¢ å¿«æ·é”® ctrl+t4.2.12 æ“¦é™¤ä¸Žä¿®å¤å·¥å…·1ã€ æ“¦é™¤å·¥å…·2ã€ æ±¡ç‚¹ä¿®å¤å·¥å…·4.2.13 å‚è€ƒçº¿æŠ€å·§1ã€è§†å›¾/æ ‡å°ºï¼Œæ˜¾ç¤ºæ ‡å°ºï¼Œåœ¨æ ‡å°ºä¸ŠæŒ‰ä½é¼ æ ‡æ‹–åŠ¨å¯ä»¥æ‹‰å‡ºå‚è€ƒçº¿2ã€è§†å›¾/å¯¹é½åˆ°/å‚è€ƒçº¿ è®©å‚è€ƒçº¿ç§»åŠ¨æ—¶è‡ªåŠ¨å¯¹é½åˆ°é€‰æ¡†æˆ–è€…å›¾åƒçš„è¾¹ç¼˜3ã€è§†å›¾/æ–°å»ºå‚è€ƒçº¿ å¯ä»¥ç²¾ç¡®åˆ›å»ºå‚è€ƒçº¿4.2.14 æ–‡æœ¬è¾“å…¥1ã€æ‰§è¡Œèœå•å‘½ä»¤ ç¼–è¾‘/é¦–é€‰é¡¹/å•ä½å’Œæ ‡å°º è®¾ç½®æ–‡å­—çš„å•ä½2ã€ æ–‡æœ¬è¾“å…¥3ã€æ–‡æœ¬ç¼–è¾‘ å±žæ€§å·¥å…·æ ä¸Šç‚¹å‡»æ–‡æœ¬ç¼–è¾‘æŒ‰é’®4.2.15 å–è‰²1ã€å–è‰²å·¥å…·ï¼Œç‚¹å‡»å‰æ™¯è‰²æŒ‰é’®ï¼Œå¼¹å‡ºå–è‰²å¯¹è¯æ¡†ï¼Œå½“å‰å·¥å…·åˆ‡æ¢æˆå–è‰²å·¥å…·ã€‚2ã€ç‚¹å‡»å‰æ™¯è‰²æŒ‰é’®ï¼Œå½“å‰å·¥å…·è‡ªåŠ¨åˆ‡æ¢åˆ°å–è‰²å·¥å…·4.2.16 å›¾åƒå¤§å°ä¸Žç”»å¸ƒå¤§å°1ã€å›¾åƒ/å›¾åƒå¤§å° æŸ¥çœ‹å’Œè®¾ç½®å›¾åƒçš„æ•´ä½“å¤§å°2ã€å›¾åƒ/ç”»å¸ƒå¤§å° æŸ¥çœ‹å’Œè®¾ç½®å›¾åƒçš„ç”»æ¿å¤§å°4.2.17 å°ºå¯¸æµ‹é‡1ã€ åˆ‡ç‰‡å·¥å…· åŒå‡»åˆ‡ç‰‡å¼¹å‡ºåˆ‡ç‰‡å¯¹è¯æ¡†2ã€ åˆ‡ç‰‡é€‰æ‹©å·¥å…·2ã€ çŸ©å½¢æ¡†å·¥å…·ï¼Œæ‰“å¼€ä¿¡æ¯é¢æ¿4.3 photoshopæ‰¹é‡åˆ‡å›¾æŠ€å·§åˆ‡å›¾ï¼Œå°±æ˜¯ä»Žæ•ˆæžœå›¾ä¸­æŠŠç½‘é¡µåˆ¶ä½œéœ€è¦çš„å°å›¾ç‰‡è£å‰ªå‡ºæ¥ã€‚1ã€ä½¿ç”¨psdæ ¼å¼å¹¶ä¸”å¸¦æœ‰å›¾å±‚çš„å›¾åƒåˆ‡å›¾2ã€åœ¨å›¾åƒä¸Šç”¨åˆ‡ç‰‡å·¥å…·åˆ‡å‡ºéœ€è¦çš„å°å›¾3ã€åŒå‡»åˆ‡ç‰‡ï¼Œç»™åˆ‡ç‰‡å‘½å4ã€å°†éœ€è¦åˆ¶ä½œé€æ˜ŽèƒŒæ™¯å›¾åƒçš„åˆ‡ç‰‡çš„èƒŒæ™¯éšè—5ã€æ‰§è¡Œèœå•å‘½ä»¤ å­˜å‚¨ä¸ºwebæ‰€ç”¨æ ¼å¼6ã€ç‚¹é€‰åˆ‡ç‰‡ï¼Œè®¾ç½®åˆ‡ç‰‡çš„å›¾ç‰‡æ ¼å¼7ã€å­˜å‚¨åˆ‡ç‰‡ï¼Œé€‰æ‹©â€œæ‰€æœ‰ç”¨æˆ·åˆ‡ç‰‡â€ï¼Œç‚¹å­˜å‚¨(å¤šä¸ªåˆ‡ç‰‡ä¼šè‡ªåŠ¨å­˜åˆ°æ‰€é€‰æ–‡ä»¶å¤¹ä¸­çš„imagesæ–‡ä»¶å¤¹ä¸­)4.4 Photoshopåˆ¶ä½œé›ªç¢§å›¾æŠ€å·§é›ªç¢§å›¾ï¼Œå°±æ˜¯å°†ç½‘é¡µåˆ¶ä½œä¸­ä½¿ç”¨çš„å¤šä¸ªå°å›¾ç‰‡åˆå¹¶æˆä¸€ä¸ªå›¾ç‰‡ï¼Œä½¿ç”¨cssæŠ€æœ¯å°†è¿™å¼ åˆæˆçš„å›¾ç‰‡åº”ç”¨åœ¨ç½‘é¡µä¸åŒçš„åœ°æ–¹ï¼Œé›ªç¢§å›¾å¯ä»¥å‡å°‘ç½‘é¡µåŠ è½½æ—¶çš„httpè¯·æ±‚æ•°ï¼Œä¼˜åŒ–ç½‘é¡µæ€§èƒ½ã€‚æ­¥éª¤ï¼š1ã€ä½¿ç”¨Photoshopæ–°å»ºä¸€å¼ èƒŒæ™¯é€æ˜Žçš„å›¾ç‰‡2ã€å°†å°å›¾ç‰‡å¤åˆ¶åˆ°æ­¤å›¾ç‰‡ä¸­ï¼ŒæŽ’åˆ—å¥½æ¯ä¸ªå›¾åƒçš„ä½ç½®ï¼Œå›¾ç‰‡å¹…é¢ä¸å¤Ÿå¯ä»¥ç”¨ç”»å¸ƒå¤§å°è°ƒæ•´å¤§å°3ã€æŒ‰ç…§æ‰€æœ‰å°å›¾ç‰‡çš„èŒƒå›´è£å‰ªå›¾ç‰‡ï¼Œå­˜ä¸ºé€æ˜ŽèƒŒæ™¯çš„pngå›¾ç‰‡5. å‰ç«¯é¡µé¢å¼€å‘æµç¨‹1ã€åˆ›å»ºé¡µé¢é¡¹ç›®ç›®å½•2ã€ä½¿ç”¨Photoshopå¯¹æ•ˆæžœå›¾åˆ‡å›¾ï¼Œåˆ‡å‡ºç½‘é¡µåˆ¶ä½œä¸­éœ€è¦çš„å°å›¾ç‰‡3ã€å°†è£…é¥°ç±»å›¾åƒåˆå¹¶ï¼Œåˆ¶ä½œæˆé›ªç¢§å›¾4ã€ç»“åˆPhotoshopå’Œä»£ç ç¼–è¾‘å™¨ï¼Œå‚ç…§æ•ˆæžœå›¾ï¼Œè¿›è¡Œhtmlå’Œcssä»£ç ä¹¦å†™ï¼Œåˆ¶ä½œé¡µé¢6. HTML5å’ŒCSS36.1 CSSæƒé‡CSSæƒé‡æŒ‡çš„æ˜¯æ ·å¼çš„ä¼˜å…ˆçº§ï¼Œæœ‰ä¸¤æ¡æˆ–å¤šæ¡æ ·å¼ä½œç”¨äºŽä¸€ä¸ªå…ƒç´ ï¼Œæƒé‡é«˜çš„é‚£æ¡æ ·å¼å¯¹å…ƒç´ èµ·ä½œç”¨,æƒé‡ç›¸åŒçš„ï¼ŒåŽå†™çš„æ ·å¼ä¼šè¦†ç›–å‰é¢å†™çš„æ ·å¼ã€‚6.1.1 æƒé‡çš„ç­‰çº§å¯ä»¥æŠŠæ ·å¼çš„åº”ç”¨æ–¹å¼åˆ†ä¸ºå‡ ä¸ªç­‰çº§ï¼ŒæŒ‰ç…§ç­‰çº§æ¥è®¡ç®—æƒé‡1ã€!importantï¼ŒåŠ åœ¨æ ·å¼å±žæ€§å€¼åŽï¼Œæƒé‡å€¼ä¸º 100002ã€å†…è”æ ·å¼ï¼Œå¦‚ï¼šstyle=â€â€ï¼Œæƒé‡å€¼ä¸º10003ã€IDé€‰æ‹©å™¨ï¼Œå¦‚ï¼š#contentï¼Œæƒé‡å€¼ä¸º1004ã€ç±»ï¼Œä¼ªç±»å’Œå±žæ€§é€‰æ‹©å™¨ï¼Œå¦‚ï¼š contentã€:hover æƒé‡å€¼ä¸º105ã€æ ‡ç­¾é€‰æ‹©å™¨å’Œä¼ªå…ƒç´ é€‰æ‹©å™¨ï¼Œå¦‚ï¼šdivã€pã€:before æƒé‡å€¼ä¸º16ã€é€šç”¨é€‰æ‹©å™¨ï¼ˆ*ï¼‰ã€å­é€‰æ‹©å™¨ï¼ˆ&gt;ï¼‰ã€ç›¸é‚»é€‰æ‹©å™¨ï¼ˆ+ï¼‰ã€åŒèƒžé€‰æ‹©å™¨ï¼ˆ~ï¼‰ã€æƒé‡å€¼ä¸º06.1.2 æƒé‡çš„è®¡ç®—å®žä¾‹1ã€å®žä¾‹ä¸€ï¼š1234567891011&lt;style type="text/css"&gt; div&#123; color:red !important; &#125; &lt;/style&gt;......&lt;div style="color:blue"&gt;è¿™æ˜¯ä¸€ä¸ªdivå…ƒç´ &lt;/div&gt;&lt;!-- ä¸¤æ¡æ ·å¼åŒæ—¶ä½œç”¨ä¸€ä¸ªdivï¼Œä¸Šé¢çš„æ ·å¼æƒé‡å€¼ä¸º10000+1ï¼Œä¸‹é¢çš„è¡Œé—´æ ·å¼çš„æƒé‡å€¼ä¸º1000ï¼Œæ‰€ä»¥æ–‡å­—çš„æœ€ç»ˆé¢œè‰²ä¸ºred --&gt;2ã€å®žä¾‹äºŒï¼š12345678910111213141516171819&lt;style type="text/css"&gt; #content div.main_content h2&#123; color:red; &#125; #content .main_content h2&#123; color:blue; &#125;&lt;/style&gt;......&lt;div id="content"&gt; &lt;div class="main_content"&gt; &lt;h2&gt;è¿™æ˜¯ä¸€ä¸ªh2æ ‡é¢˜&lt;/h2&gt; &lt;/div&gt;&lt;/div&gt;&lt;!-- ç¬¬ä¸€æ¡æ ·å¼çš„æƒé‡è®¡ç®—ï¼š 100+1+10+1ï¼Œç»“æžœä¸º112ï¼›ç¬¬äºŒæ¡æ ·å¼çš„æƒé‡è®¡ç®—ï¼š 100+10+1ï¼Œç»“æžœä¸º111ï¼›h2æ ‡é¢˜çš„æœ€ç»ˆé¢œè‰²ä¸ºred--&gt;6.2 CSS3æ–°å¢žé€‰æ‹©å™¨1ã€E:nth-child(n)ï¼šåŒ¹é…å…ƒç´ ç±»åž‹ä¸ºEä¸”æ˜¯çˆ¶å…ƒç´ çš„ç¬¬nä¸ªå­å…ƒç´ 123456789101112131415&lt;style type="text/css"&gt; .list div:nth-child(2)&#123; background-color:red; &#125;&lt;/style&gt;......&lt;div class="list"&gt; &lt;h2&gt;1&lt;/h2&gt; &lt;div&gt;2&lt;/div&gt; &lt;div&gt;3&lt;/div&gt; &lt;div&gt;4&lt;/div&gt; &lt;div&gt;5&lt;/div&gt;&lt;/div&gt;&lt;!-- ç¬¬2ä¸ªå­å…ƒç´ divåŒ¹é… --&gt;2ã€E:first-childï¼šåŒ¹é…å…ƒç´ ç±»åž‹ä¸ºEä¸”æ˜¯çˆ¶å…ƒç´ çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ 3ã€E:last-childï¼šåŒ¹é…å…ƒç´ ç±»åž‹ä¸ºEä¸”æ˜¯çˆ¶å…ƒç´ çš„æœ€åŽä¸€ä¸ªå­å…ƒç´ 4ã€E &gt; F Eå…ƒç´ ä¸‹é¢ç¬¬ä¸€å±‚å­é›†5ã€E ~ F Eå…ƒç´ åŽé¢çš„å…„å¼Ÿå…ƒç´ 6ã€E + F ç´§æŒ¨ç€çš„åŽé¢çš„å…„å¼Ÿå…ƒç´ å±žæ€§é€‰æ‹©å™¨ï¼š1ã€E[attr] å«æœ‰attrå±žæ€§çš„å…ƒç´ 1234567&lt;style type="text/css"&gt; div[data-attr='ok']&#123; color:red; &#125;&lt;/style&gt;......&lt;div data-attr="ok"&gt;è¿™æ˜¯ä¸€ä¸ªdivå…ƒç´ &lt;/div&gt;2ã€E[attr=â€™okâ€™] å«æœ‰attrå±žæ€§çš„å…ƒç´ ä¸”å®ƒçš„å€¼ä¸ºâ€œokâ€3ã€E[attr^=â€™okâ€™] å«æœ‰attrå±žæ€§çš„å…ƒç´ ä¸”å®ƒçš„å€¼çš„å¼€å¤´å«æœ‰â€œokâ€4ã€E[attr$=â€™okâ€™] å«æœ‰attrå±žæ€§çš„å…ƒç´ ä¸”å®ƒçš„å€¼çš„ç»“å°¾å«æœ‰â€œokâ€5ã€E[attr*=â€™okâ€™] å«æœ‰attrå±žæ€§çš„å…ƒç´ ä¸”å®ƒçš„å€¼ä¸­å«æœ‰â€œokâ€6.3 CSS3åœ†è§’ã€rgba6.3.1 CSS3åœ†è§’è®¾ç½®æŸä¸€ä¸ªè§’çš„åœ†è§’ï¼Œæ¯”å¦‚è®¾ç½®å·¦ä¸Šè§’çš„åœ†è§’ï¼šborder-top-left-radius:30px 60px;åŒæ—¶åˆ†åˆ«è®¾ç½®å››ä¸ªè§’ï¼š border-radius:30px 60px 120px 150px;è®¾ç½®å››ä¸ªåœ†è§’ç›¸åŒï¼šborder-radius:50%;6.3.2 rgbaï¼ˆæ–°çš„é¢œè‰²å€¼è¡¨ç¤ºæ³•ï¼‰1ã€ç›’å­é€æ˜Žåº¦è¡¨ç¤ºæ³•ï¼š12345.box &#123; opacity:0.1; /* å…¼å®¹IE */ filter:alpha(opacity=10); &#125;2ã€rgba(0,0,0,0.1) å‰ä¸‰ä¸ªæ•°å€¼è¡¨ç¤ºé¢œè‰²ï¼Œç¬¬å››ä¸ªæ•°å€¼è¡¨ç¤ºé¢œè‰²çš„é€æ˜Žåº¦6.4 CSS3 transitionåŠ¨ç”»1ã€transition-property è®¾ç½®è¿‡æ¸¡çš„å±žæ€§ï¼Œæ¯”å¦‚ï¼šwidth height background-color2ã€transition-duration è®¾ç½®è¿‡æ¸¡çš„æ—¶é—´ï¼Œæ¯”å¦‚ï¼š1s 500ms3ã€transition-timing-function è®¾ç½®è¿‡æ¸¡çš„è¿åŠ¨æ–¹å¼ï¼Œå¸¸ç”¨æœ‰ linear(åŒ€é€Ÿ)|ease(ç¼“å†²è¿åŠ¨)4ã€transition-delay è®¾ç½®åŠ¨ç”»çš„å»¶è¿Ÿ5ã€transition: property duration timing-function delay åŒæ—¶è®¾ç½®å››ä¸ªå±žæ€§ç»¼åˆç»ƒä¹ ï¼šåˆ¶ä½œé¼ æ ‡ç§»å…¥å›¾ç‰‡æ—¶ï¼Œå›¾ç‰‡è¯´æ˜Žæ»‘å…¥çš„æ•ˆæžœ6.5 CSS3 transformå˜æ¢1ã€translate(x,y) è®¾ç½®ç›’å­ä½ç§»2ã€scale(x,y) è®¾ç½®ç›’å­ç¼©æ”¾3ã€rotate(deg) è®¾ç½®ç›’å­æ—‹è½¬4ã€skew(x-angle,y-angle) è®¾ç½®ç›’å­æ–œåˆ‡5ã€perspective è®¾ç½®é€è§†è·ç¦»6ã€transform-style flat | preserve-3d è®¾ç½®ç›’å­æ˜¯å¦æŒ‰3dç©ºé—´æ˜¾ç¤º7ã€translateXã€translateYã€translateZ è®¾ç½®ä¸‰ç»´ç§»åŠ¨8ã€rotateXã€rotateYã€rotateZ è®¾ç½®ä¸‰ç»´æ—‹è½¬9ã€scaleXã€scaleYã€scaleZ è®¾ç½®ä¸‰ç»´ç¼©æ”¾10ã€tranform-origin è®¾ç½®å˜å½¢çš„ä¸­å¿ƒç‚¹11ã€backface-visibility è®¾ç½®ç›’å­èƒŒé¢æ˜¯å¦å¯è§ä¸¾ä¾‹ï¼šï¼ˆç¿»é¢æ•ˆæžœï¼‰12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;ç¿»é¢&lt;/title&gt; &lt;style type="text/css"&gt; .box&#123; width:300px; height:272px; margin:50px auto 0; transform-style:preserve-3d; position:relative; &#125; .box .pic&#123; width:300px; height:272px; position:absolute; background-color:cyan; left:0; top:0; transform:perspective(800px) rotateY(0deg); backface-visibility:hidden; transition:all 500ms ease; &#125; .box .back_info&#123; width:300px; height:272px; text-align:center; line-height:272px; background-color:gold; position:absolute; left:0; top:0; transform:rotateY(180deg); backface-visibility:hidden; transition:all 500ms ease; &#125; .box:hover .pic&#123; transform:perspective(800px) rotateY(180deg); &#125; .box:hover .back_info&#123; transform:perspective(800px) rotateY(0deg); &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="box"&gt; &lt;div class="pic"&gt;&lt;img src="images/location_bg.jpg"&gt;&lt;/div&gt; &lt;div class="back_info"&gt;èƒŒé¢æ–‡å­—è¯´æ˜Ž&lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;6.6 CSS3 animationåŠ¨ç”»1ã€@keyframes å®šä¹‰å…³é”®å¸§åŠ¨ç”»2ã€animation-name åŠ¨ç”»åç§°3ã€animation-duration åŠ¨ç”»æ—¶é—´4ã€animation-timing-function åŠ¨ç”»æ›²çº¿ linear(åŒ€é€Ÿ)|ease(ç¼“å†²)|steps(æ­¥æ•°)5ã€animation-delay åŠ¨ç”»å»¶è¿Ÿ6ã€animation-iteration-count åŠ¨ç”»æ’­æ”¾æ¬¡æ•° n|infinite7ã€animation-direction åŠ¨ç”»ç»“æŸåŽæ˜¯å¦åå‘è¿˜åŽŸ normal|alternate8ã€animation-play-state åŠ¨ç”»çŠ¶æ€ paused(åœæ­¢)|running(è¿åŠ¨)9ã€animation-fill-mode åŠ¨ç”»å‰åŽçš„çŠ¶æ€ none(ç¼ºçœ)|forwards(ç»“æŸæ—¶åœç•™åœ¨æœ€åŽä¸€å¸§)|backwards(å¼€å§‹æ—¶åœç•™åœ¨å®šä¹‰çš„å¼€å§‹å¸§)|both(å‰åŽéƒ½åº”ç”¨)10ã€animation:name duration timing-function delay iteration-count direction;åŒæ—¶è®¾ç½®å¤šä¸ªå±žæ€§ç†è§£ç»ƒä¹ ï¼š1ã€é£Žè½¦åŠ¨ç”»2ã€loadingåŠ¨ç”»3ã€äººç‰©èµ°è·¯åŠ¨ç”»123456789101112131415161718192021222324252627282930313233343536373839&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;èµ°è·¯åŠ¨ç”»&lt;/title&gt; &lt;style type="text/css"&gt; .box&#123; width:120px; height:180px; border:1px solid #ccc; margin:50px auto 0; position:relative; overflow:hidden; &#125; .box img&#123; display:block; width:960px; height:182px; position: absolute; left:0; top:0; animation:walking 1.0s steps(8) infinite; &#125; @keyframes walking&#123; from&#123; left:0px; &#125; to&#123; left:-960px; &#125; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="box"&gt;&lt;img src="images/walking.png"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;åŠ¨ç”»ä¸­ä½¿ç”¨çš„å›¾ç‰‡å¦‚ä¸‹ï¼š6.7 CSS3 æµè§ˆå™¨å‰ç¼€6.7.1 æµè§ˆå™¨æ ·å¼å‰ç¼€ä¸ºäº†è®©CSS3æ ·å¼å…¼å®¹ï¼Œéœ€è¦å°†æŸäº›æ ·å¼åŠ ä¸Šæµè§ˆå™¨å‰ç¼€ï¼š-ms- å…¼å®¹IEæµè§ˆå™¨-moz- å…¼å®¹firefox-o- å…¼å®¹opera-webkit- å…¼å®¹chrome å’Œ safariæ¯”å¦‚ï¼š12345678div&#123; -ms-transform: rotate(30deg); -webkit-transform: rotate(30deg); -o-transform: rotate(30deg); -moz-transform: rotate(30deg); transform: rotate(30deg);&#125;6.7.2 è‡ªåŠ¨æ·»åŠ æµè§ˆå™¨å‰ç¼€ç›®å‰çš„çŠ¶å†µæ˜¯ï¼Œæœ‰äº›CSS3å±žæ€§éœ€è¦åŠ å‰ç¼€ï¼Œæœ‰äº›ä¸éœ€è¦åŠ ï¼Œæœ‰äº›åªéœ€è¦åŠ ä¸€éƒ¨åˆ†ï¼Œè¿™äº›åŠ å‰ç¼€çš„å·¥ä½œå¯ä»¥äº¤ç»™æ’ä»¶æ¥å®Œæˆï¼Œæ¯”å¦‚å®‰è£…ï¼š autoprefixerå¯ä»¥åœ¨Sublime textä¸­é€šè¿‡package control å®‰è£… autoprefixer6.7.3 Autoprefixeråœ¨Sublime textä¸­çš„è®¾ç½®ï¼š1ã€preferences/key Bindings-User1&#123; "keys": ["ctrl+alt+x"], "command": "autoprefixer" &#125;2ã€Preferences&gt;package setting&gt;AutoPrefixer&gt;Setting-User12345&#123; "browsers": ["last 7 versions"], "cascade": true, "remove": true&#125;last 7 versionsï¼šæœ€æ–°çš„æµè§ˆå™¨çš„7ä¸ªç‰ˆæœ¬cascadeï¼šç¼©è¿›ç¾ŽåŒ–å±žæ€§å€¼removeï¼šæ˜¯å¦åŽ»æŽ‰ä¸å¿…è¦çš„å‰ç¼€6.8 HTML5æ–°å¢žæ ‡ç­¾6.8.1 æ–°å¢žè¯­ä¹‰æ ‡ç­¾1ã€&lt;header&gt; é¡µé¢å¤´éƒ¨ã€é¡µçœ‰2ã€&lt;nav&gt; é¡µé¢å¯¼èˆª3ã€&lt;article&gt; ä¸€ç¯‡æ–‡ç« 4ã€&lt;section&gt; æ–‡ç« ä¸­çš„ç« èŠ‚5ã€&lt;aside&gt; ä¾§è¾¹æ 6ã€&lt;footer&gt; é¡µé¢åº•éƒ¨ã€é¡µè„š6.8.2 éŸ³é¢‘è§†é¢‘1ã€&lt;audio&gt;2ã€&lt;video&gt;PCç«¯å…¼å®¹h5çš„æ–°æ ‡ç­¾çš„æ–¹æ³•ï¼Œåœ¨é¡µé¢ä¸­å¼•å…¥ä»¥ä¸‹jsæ–‡ä»¶:1&lt;script type="text/javascript" src="//cdn.bootcss.com/html5shiv/r29/html5.js"&gt;&lt;/script&gt;6.9 HTML5 æ–°å¢žè¡¨å•æŽ§ä»¶æ–°å¢žç±»åž‹ï¼šç½‘å€ é‚®ç®± æ—¥æœŸ æ—¶é—´ æ˜ŸæœŸ æ•°é‡ èŒƒå›´ ç”µè¯ é¢œè‰² æœç´¢12345678910&lt;label&gt;ç½‘å€:&lt;/label&gt;&lt;input type=&quot;url&quot; name=&quot;&quot; required&gt;&lt;br&gt;&lt;br&gt; &lt;label&gt;é‚®ç®±:&lt;/label&gt;&lt;input type=&quot;email&quot; name=&quot;&quot; required&gt;&lt;br&gt;&lt;br&gt; &lt;label&gt;æ—¥æœŸ:&lt;/label&gt;&lt;input type=&quot;date&quot; name=&quot;&quot;&gt;&lt;br&gt;&lt;br&gt; &lt;label&gt;æ—¶é—´:&lt;/label&gt;&lt;input type=&quot;time&quot; name=&quot;&quot;&gt;&lt;br&gt;&lt;br&gt; &lt;label&gt;æ˜ŸæœŸ:&lt;/label&gt;&lt;input type=&quot;week&quot; name=&quot;&quot;&gt;&lt;br&gt;&lt;br&gt; &lt;label&gt;æ•°é‡:&lt;/label&gt;&lt;input type=&quot;number&quot; name=&quot;&quot;&gt; &lt;br&gt;&lt;br&gt;&lt;label&gt;èŒƒå›´:&lt;/label&gt;&lt;input type=&quot;range&quot; name=&quot;&quot;&gt;&lt;br&gt;&lt;br&gt; &lt;label&gt;ç”µè¯:&lt;/label&gt;&lt;input type=&quot;tel&quot; name=&quot;&quot;&gt;&lt;br&gt;&lt;br&gt; &lt;label&gt;é¢œè‰²:&lt;/label&gt;&lt;input type=&quot;color&quot; name=&quot;&quot;&gt;&lt;br&gt;&lt;br&gt; &lt;label&gt;æœç´¢:&lt;/label&gt;&lt;input type=&quot;search&quot; name=&quot;&quot;&gt;&lt;br&gt;&lt;br&gt;æ–°å¢žå¸¸ç”¨è¡¨å•æŽ§ä»¶å±žæ€§ï¼š1ã€placeholder è®¾ç½®æ–‡æœ¬æ¡†é»˜è®¤æç¤ºæ–‡å­—2ã€autofocus è‡ªåŠ¨èŽ·å¾—ç„¦ç‚¹3ã€autocomplete è”æƒ³å…³é”®è¯7. ç§»åŠ¨ç«¯é¡µé¢å¼€å‘7.1 ç§»åŠ¨ç«¯ä¸ŽPCç«¯é¡µé¢å¸ƒå±€åŒºåˆ«7.1.1 è§†å£è§†å£æ˜¯ç§»åŠ¨è®¾å¤‡ä¸Šç”¨æ¥æ˜¾ç¤ºç½‘é¡µçš„åŒºåŸŸï¼Œä¸€èˆ¬ä¼šæ¯”ç§»åŠ¨è®¾å¤‡å¯è§†åŒºåŸŸå¤§ï¼Œå®½åº¦å¯èƒ½æ˜¯980pxæˆ–è€…1024pxï¼Œç›®çš„æ˜¯ä¸ºäº†æ˜¾ç¤ºä¸‹æ•´ä¸ªä¸ºPCç«¯è®¾è®¡çš„ç½‘é¡µï¼Œè¿™æ ·å¸¦æ¥çš„åŽæžœæ˜¯ç§»åŠ¨ç«¯ä¼šå‡ºçŽ°æ¨ªå‘æ»šåŠ¨æ¡ï¼Œä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œç§»åŠ¨ç«¯ä¼šå°†è§†å£ç¼©æ”¾åˆ°ç§»åŠ¨ç«¯çª—å£çš„å¤§å°ã€‚è¿™æ ·ä¼šè®©ç½‘é¡µä¸å®¹æ˜“è§‚çœ‹ï¼Œå¯ä»¥ç”¨ meta æ ‡ç­¾ï¼Œname=â€œviewport â€ æ¥è®¾ç½®è§†å£çš„å¤§å°ï¼Œå°†è§†å£çš„å¤§å°è®¾ç½®ä¸ºå’Œç§»åŠ¨è®¾å¤‡å¯è§†åŒºä¸€æ ·çš„å¤§å°ã€‚è®¾ç½®æ–¹æ³•å¦‚ä¸‹( å¿«æ·æ–¹å¼ï¼šmeta:vp + tab )ï¼š123456&lt;head&gt;......&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0&quot;&gt;......&lt;/head&gt;pcç«¯ä¸Žç§»åŠ¨ç«¯æ¸²æŸ“ç½‘é¡µè¿‡ç¨‹ï¼š7.1.2 è§†ç½‘è†œå±å¹•ï¼ˆretinaå±å¹•ï¼‰æ¸…æ™°åº¦è§£å†³æ–¹æ¡ˆè§†ç½‘è†œå±å¹•æŒ‡çš„æ˜¯å±å¹•çš„ç‰©ç†åƒç´ å¯†åº¦æ›´é«˜çš„å±å¹•ï¼Œç‰©ç†åƒç´ å¯ä»¥ç†è§£ä¸ºå±å¹•ä¸Šçš„ä¸€ä¸ªå‘å…‰ç‚¹ï¼Œæ— æ•°å‘å…‰çš„ç‚¹ç»„æˆçš„å±å¹•ï¼Œè§†ç½‘è†œå±å¹•æ¯”ä¸€èˆ¬å±å¹•çš„ç‰©ç†åƒç´ ç‚¹æ›´å°ï¼Œå¸¸è§æœ‰2å€çš„è§†ç½‘è†œå±å¹•å’Œ3å€çš„è§†ç½‘è†œå±å¹•ï¼Œ2å€çš„è§†ç½‘è†œå±å¹•ï¼Œå®ƒçš„ç‰©ç†åƒç´ ç‚¹å¤§å°æ˜¯ä¸€èˆ¬å±å¹•çš„1/4,3å€çš„è§†ç½‘è†œå±å¹•ï¼Œå®ƒçš„ç‰©ç†åƒç´ ç‚¹å¤§å°æ˜¯ä¸€èˆ¬å±å¹•çš„1/9ã€‚å›¾åƒåœ¨è§†ç½‘è†œå±å¹•ä¸Šæ˜¾ç¤ºçš„å¤§å°å’Œåœ¨ä¸€èˆ¬å±å¹•ä¸Šæ˜¾ç¤ºçš„å¤§å°ä¸€æ ·ï¼Œä½†æ˜¯ç”±äºŽè§†ç½‘è†œå±å¹•çš„ç‰©ç†åƒç´ ç‚¹æ¯”ä¸€èˆ¬çš„å±å¹•å°ï¼Œå›¾åƒåœ¨ä¸Šé¢å¥½åƒæ˜¯è¢«æ”¾å¤§äº†ï¼Œå›¾åƒä¼šå˜å¾—æ¨¡ç³Šï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨æ¯”åŽŸæ¥å¤§ä¸€å€çš„å›¾åƒï¼Œç„¶åŽç”¨cssæ ·å¼å¼ºåˆ¶æŠŠå›¾åƒçš„å°ºå¯¸è®¾ä¸ºåŽŸæ¥å›¾åƒå°ºå¯¸çš„å¤§å°ï¼Œå°±å¯ä»¥è§£å†³æ¨¡ç³Šçš„é—®é¢˜ã€‚æ¸…æ™°åº¦è§£å†³è¿‡ç¨‹ç¤ºæ„å›¾ï¼šèƒŒæ™¯å›¾å¼ºåˆ¶æ”¹å˜å¤§å°ï¼Œå¯ä»¥ä½¿ç”¨backgroundæ–°å±žæ€§backgroundæ–°å±žæ€§background-size:lengthï¼šç”¨é•¿åº¦å€¼æŒ‡å®šèƒŒæ™¯å›¾åƒå¤§å°ã€‚ä¸å…è®¸è´Ÿå€¼ã€‚percentageï¼šç”¨ç™¾åˆ†æ¯”æŒ‡å®šèƒŒæ™¯å›¾åƒå¤§å°ã€‚ä¸å…è®¸è´Ÿå€¼ã€‚autoï¼šèƒŒæ™¯å›¾åƒçš„çœŸå®žå¤§å°ã€‚coverï¼šå°†èƒŒæ™¯å›¾åƒç­‰æ¯”ç¼©æ”¾åˆ°å®Œå…¨è¦†ç›–å®¹å™¨ï¼ŒèƒŒæ™¯å›¾åƒæœ‰å¯èƒ½è¶…å‡ºå®¹å™¨ã€‚containï¼šå°†èƒŒæ™¯å›¾åƒç­‰æ¯”ç¼©æ”¾åˆ°å®½åº¦æˆ–é«˜åº¦ä¸Žå®¹å™¨çš„å®½åº¦æˆ–é«˜åº¦ç›¸ç­‰ï¼ŒèƒŒæ™¯å›¾åƒå§‹ç»ˆè¢«åŒ…å«åœ¨å®¹å™¨å†…ã€‚7.2 é€‚é…å¸ƒå±€ç±»åž‹7.2.1 PCåŠç§»åŠ¨ç«¯é¡µé¢é€‚é…æ–¹æ³•è®¾å¤‡å±å¹•æœ‰å¤šç§ä¸åŒçš„åˆ†è¾¨çŽ‡ï¼Œé¡µé¢é€‚é…æ–¹æ¡ˆæœ‰å¦‚ä¸‹å‡ ç§ï¼š1ã€å…¨é€‚é…ï¼šå“åº”å¼å¸ƒå±€+æµä½“å¸ƒå±€2ã€ç§»åŠ¨ç«¯é€‚é…ï¼šæµä½“å¸ƒå±€+å°‘é‡å“åº”å¼åŸºäºŽremçš„å¸ƒå±€7.2.2 æµä½“å¸ƒå±€æµä½“å¸ƒå±€ï¼Œå°±æ˜¯ä½¿ç”¨ç™¾åˆ†æ¯”æ¥è®¾ç½®å…ƒç´ çš„å®½åº¦ï¼Œå…ƒç´ çš„é«˜åº¦æŒ‰å®žé™…é«˜åº¦å†™å›ºå®šå€¼ï¼Œæµä½“å¸ƒå±€ä¸­ï¼Œå…ƒç´ çš„è¾¹çº¿æ— æ³•ç”¨ç™¾åˆ†æ¯”ï¼Œå¯ä»¥ä½¿ç”¨æ ·å¼ä¸­çš„è®¡ç®—å‡½æ•° calc() æ¥è®¾ç½®å®½åº¦ï¼Œæˆ–è€…ä½¿ç”¨ box-sizing å±žæ€§å°†ç›’å­è®¾ç½®ä¸ºä»Žè¾¹çº¿è®¡ç®—ç›’å­å°ºå¯¸ã€‚calc()å¯ä»¥é€šè¿‡è®¡ç®—çš„æ–¹å¼ç»™å…ƒç´ åŠ å°ºå¯¸ï¼Œæ¯”å¦‚ï¼š widthï¼šcalc(25% - 4px);box-sizing1ã€content-box é»˜è®¤çš„ç›’å­å°ºå¯¸è®¡ç®—æ–¹å¼2ã€border-box ç½®ç›’å­çš„å°ºå¯¸è®¡ç®—æ–¹å¼ä¸ºä»Žè¾¹æ¡†å¼€å§‹ï¼Œç›’å­çš„å°ºå¯¸ï¼Œè¾¹æ¡†å’Œå†…å¡«å……ç®—åœ¨ç›’å­å°ºå¯¸å†…7.2.3 å“åº”å¼å¸ƒå±€å“åº”å¼å¸ƒå±€å°±æ˜¯ä½¿ç”¨åª’ä½“æŸ¥è¯¢çš„æ–¹å¼ï¼Œé€šè¿‡æŸ¥è¯¢æµè§ˆå™¨å®½åº¦ï¼Œä¸åŒçš„å®½åº¦åº”ç”¨ä¸åŒçš„æ ·å¼å—ï¼Œæ¯ä¸ªæ ·å¼å—å¯¹åº”çš„æ˜¯è¯¥å®½åº¦ä¸‹çš„å¸ƒå±€æ–¹å¼ï¼Œä»Žè€Œå®žçŽ°å“åº”å¼å¸ƒå±€ã€‚å“åº”å¼å¸ƒå±€çš„é¡µé¢å¯ä»¥é€‚é…å¤šç§ç»ˆç«¯å±å¹•ï¼ˆpcã€å¹³æ¿ã€æ‰‹æœºï¼‰ã€‚ç›¸åº”å¸ƒå±€çš„ä¼ªä»£ç å¦‚ä¸‹ï¼š12345678@media (max-width:960px)&#123; .left_con&#123;width:58%;&#125; .right_con&#123;width:38%;&#125;&#125;@media (max-width:768px)&#123; .left_con&#123;width:100%;&#125; .right_con&#123;width:100%;&#125;&#125;7.2.4 åŸºäºŽremçš„å¸ƒå±€é¦–å…ˆäº†è§£emå•ä½ï¼Œemå•ä½æ˜¯å‚ç…§å…ƒç´ è‡ªèº«çš„æ–‡å­—å¤§å°æ¥è®¾ç½®å°ºå¯¸ï¼ŒremæŒ‡çš„æ˜¯å‚ç…§æ ¹èŠ‚ç‚¹çš„æ–‡å­—å¤§å°ï¼Œæ ¹èŠ‚ç‚¹æŒ‡çš„æ˜¯htmlæ ‡ç­¾ï¼Œè®¾ç½®htmlæ ‡ç­¾çš„æ–‡å­—å¤§å°ï¼Œå…¶ä»–çš„å…ƒç´ ç›¸å…³å°ºå¯¸è®¾ç½®ç”¨remï¼Œè¿™æ ·ï¼Œæ‰€æœ‰å…ƒç´ éƒ½æœ‰äº†ç»Ÿä¸€çš„å‚ç…§æ ‡å‡†ï¼Œæ”¹å˜htmlæ–‡å­—çš„å¤§å°ï¼Œå°±ä¼šæ”¹å˜æ‰€æœ‰å…ƒç´ ç”¨remè®¾ç½®çš„å°ºå¯¸å¤§å°ã€‚cssremå®‰è£…cssremæ’ä»¶å¯ä»¥åŠ¨æ€åœ°å°†pxå°ºå¯¸æ¢ç®—æˆremå°ºå¯¸ä¸‹è½½æœ¬é¡¹ç›®ï¼Œæ¯”å¦‚ï¼šgit clone https://github.com/flashlizi/cssrem è¿›å…¥packagesç›®å½•ï¼šSublime Text -&gt; Preferences -&gt; Browse Packagesâ€¦ å¤åˆ¶ä¸‹è½½çš„cssremç›®å½•åˆ°åˆšæ‰çš„packgesç›®å½•é‡Œã€‚ é‡å¯Sublime Textã€‚é…ç½®å‚æ•° å‚æ•°é…ç½®æ–‡ä»¶ï¼šSublime Text -&gt; Preferences -&gt; Package Settings -&gt; cssrem px_to_rem - pxè½¬remçš„å•ä½æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º40ã€‚ max_rem_fraction_length - pxè½¬remçš„å°æ•°éƒ¨åˆ†çš„æœ€å¤§é•¿åº¦ã€‚é»˜è®¤ä¸º6ã€‚ available_file_types - å¯ç”¨æ­¤æ’ä»¶çš„æ–‡ä»¶ç±»åž‹ã€‚é»˜è®¤ä¸ºï¼š[â€œ.cssâ€, â€œ.lessâ€, â€œ.sassâ€]ã€‚8. å¸¸ç”¨cssåˆ—è¡¨color è®¾ç½®æ–‡å­—çš„é¢œè‰²ï¼Œå¦‚ï¼š color:red;font-size è®¾ç½®æ–‡å­—çš„å¤§å°ï¼Œå¦‚ï¼šfont-size:12px;font-family è®¾ç½®æ–‡å­—çš„å­—ä½“ï¼Œå¦‚ï¼šfont-family:â€™å¾®è½¯é›…é»‘â€™;font-style è®¾ç½®å­—ä½“æ˜¯å¦å€¾æ–œï¼Œå¦‚ï¼šfont-style:â€™normalâ€™; è®¾ç½®ä¸å€¾æ–œï¼Œfont-style:â€™italicâ€™;è®¾ç½®æ–‡å­—å€¾æ–œfont-weight è®¾ç½®æ–‡å­—æ˜¯å¦åŠ ç²—ï¼Œå¦‚ï¼šfont-weight:bold; è®¾ç½®åŠ ç²— font-weight:normal è®¾ç½®ä¸åŠ ç²—line-height è®¾ç½®æ–‡å­—çš„è¡Œé«˜ï¼Œè®¾ç½®è¡Œé«˜ç›¸å½“äºŽåœ¨æ¯è¡Œæ–‡å­—çš„ä¸Šä¸‹åŒæ—¶åŠ é—´è·ï¼Œ å¦‚ï¼šline-height:24px;font åŒæ—¶è®¾ç½®æ–‡å­—çš„å‡ ä¸ªå±žæ€§ï¼Œå†™çš„é¡ºåºæœ‰å…¼å®¹é—®é¢˜ï¼Œå»ºè®®æŒ‰ç…§å¦‚ä¸‹é¡ºåºå†™ï¼š fontï¼šæ˜¯å¦åŠ ç²— å­—å·/è¡Œé«˜ å­—ä½“ï¼›å¦‚ï¼š font:normal 12px/36px â€˜å¾®è½¯é›…é»‘â€™;text-decoration è®¾ç½®æ–‡å­—çš„ä¸‹åˆ’çº¿ï¼Œå¦‚ï¼štext-decoration:none; å°†æ–‡å­—ä¸‹åˆ’çº¿åŽ»æŽ‰text-indent è®¾ç½®æ–‡å­—é¦–è¡Œç¼©è¿›ï¼Œå¦‚ï¼štext-indent:24px; è®¾ç½®æ–‡å­—é¦–è¡Œç¼©è¿›24pxtext-align è®¾ç½®æ–‡å­—æ°´å¹³å¯¹é½æ–¹å¼ï¼Œå¦‚text-align:center è®¾ç½®æ–‡å­—æ°´å¹³å±…ä¸­text-overflow è®¾ç½®ä¸€è¡Œæ–‡å­—å®½åº¦è¶…è¿‡å®¹å™¨å®½åº¦æ—¶çš„æ˜¾ç¤ºæ–¹å¼ï¼Œå¦‚ï¼štext-overflow:clip å°†å¤šå‡ºçš„æ–‡å­—è£å‰ªæŽ‰ text-overflow:ellipsis å°†å¤šå‡ºçš„æ–‡å­—æ˜¾ç¤ºæˆçœç•¥å·white-space ä¸€èˆ¬ç”¨æ¥è®¾ç½®æ–‡æœ¬ä¸æ¢è¡Œï¼Œå¦‚ï¼šwhite-space:nowrap è®¾ç½®æ–‡æœ¬ä¸æ¢è¡Œ ä¸€èˆ¬ä¸Žtext-overflowå’Œoverflowå±žæ€§é…åˆä½¿ç”¨æ¥è®©ä¸€è¡Œæ–‡å­—è¶…å‡ºå®½åº¦æ—¶æ˜¾ç¤ºçœç•¥å·list-style ä¸€èˆ¬ç”¨æ¥è®¾ç½®åŽ»æŽ‰ulæˆ–è€…olåˆ—è¡¨ä¸­çš„å°åœ†ç‚¹æˆ–æ•°å­— å¦‚ï¼šlist-style:nonewidth è®¾ç½®ç›’å­å†…å®¹çš„å®½åº¦ï¼Œå¦‚ï¼š widthï¼š100px;height è®¾ç½®ç›’å­å†…å®¹çš„é«˜åº¦ï¼Œå¦‚ï¼š heightï¼š100px;border-top è®¾ç½®ç›’å­é¡¶éƒ¨è¾¹æ¡†çš„ä¸‰ä¸ªå±žæ€§ å¦‚ï¼šborder-top:5px solid red;è®¾ç½®ç›’å­é¡¶éƒ¨è¾¹æ¡†ä¸º3åƒç´ å®½çš„çº¢è‰²çš„å®žçº¿ï¼Œè¯¦ç»†è®¾ç½®è¯´æ˜Žï¼šç›’å­æ¨¡åž‹border-left è®¾ç½®ç›’å­å·¦è¾¹è¾¹æ¡†çš„ä¸‰ä¸ªå±žæ€§ å¦‚ï¼šborder-left:3px dotted red;è®¾ç½®ç›’å­å·¦è¾¹è¾¹æ¡†ä¸º3åƒç´ å®½çš„çº¢è‰²çš„ç‚¹çº¿ï¼Œè¯¦ç»†è®¾ç½®è¯´æ˜Žï¼šç›’å­æ¨¡åž‹border-right è®¾ç½®ç›’å­å³è¾¹è¾¹æ¡†çš„ä¸‰ä¸ªå±žæ€§ å¦‚ï¼šborder-right:2px dashed red;è®¾ç½®ç›’å­å³è¾¹æ¡†ä¸º2åƒç´ å®½çš„çº¢è‰²çš„è™šçº¿ï¼Œè¯¦ç»†è®¾ç½®è¯´æ˜Žï¼šç›’å­æ¨¡åž‹border-bottom è®¾ç½®ç›’å­åº•éƒ¨è¾¹æ¡†çš„ä¸‰ä¸ªå±žæ€§ å¦‚ï¼šborder-bottom:1px solid red;è®¾ç½®ç›’å­åº•éƒ¨è¾¹æ¡†ä¸º1åƒç´ å®½çš„çº¢è‰²çš„å®žçº¿ï¼Œè¯¦ç»†è®¾ç½®è¯´æ˜Žï¼šç›’å­æ¨¡åž‹border åŒæ—¶è®¾ç½®ç›’å­çš„å››ä¸ªè¾¹æ¡†ï¼Œå¦‚æžœå››ä¸ªè¾¹çš„æ ·å¼ç»Ÿä¸€å°±ä½¿ç”¨å®ƒ å¦‚ï¼šborder:1px solid #000 è®¾ç½®ç›’å­å››ä¸ªè¾¹éƒ½æ˜¯1åƒç´ å®½çš„é»‘è‰²å®žçº¿ï¼Œè¯¦ç»†è®¾ç½®è¯´æ˜Žï¼šç›’å­æ¨¡åž‹padding è®¾ç½®ç›’å­å››ä¸ªè¾¹çš„å†…è¾¹è· å¦‚ï¼špadding:10px 20px 30px 40px åˆ†åˆ«è®¾ç½®ç›’å­ä¸Šè¾¹(10px)ã€å³è¾¹(20px)ã€ä¸‹è¾¹(30px)ã€å·¦è¾¹(40px)çš„å†…è¾¹è·(é¡ºæ—¶é’ˆ)ï¼Œè¯¦ç»†è®¾ç½®è¯´æ˜Žï¼šç›’å­æ¨¡åž‹margin è®¾ç½®ç›’å­å››ä¸ªè¾¹çš„å¤–è¾¹è· å¦‚ï¼šmargin:10px 20px 30px 40px åˆ†åˆ«è®¾ç½®ç›’å­ä¸Šè¾¹(10px)ã€å³è¾¹(20px)ã€ä¸‹è¾¹(30px)ã€å·¦è¾¹(40px)çš„å¤–è¾¹è·(é¡ºæ—¶é’ˆ)ï¼Œè¯¦ç»†è®¾ç½®è¯´æ˜Žï¼šç›’å­æ¨¡åž‹overflow è®¾ç½®å½“å­å…ƒç´ çš„å°ºå¯¸è¶…è¿‡çˆ¶å…ƒç´ çš„å°ºå¯¸æ—¶ï¼Œç›’å­åŠå­å…ƒç´ çš„æ˜¾ç¤ºæ–¹å¼ å¦‚ï¼šoverflow:hidden è¶…å‡ºçš„å­å…ƒç´ è¢«è£åˆ‡ï¼Œè¯¦ç»†è®¾ç½®è¯´æ˜Žï¼šå…ƒç´ æº¢å‡ºdisplay è®¾ç½®ç›’å­çš„æ˜¾ç¤ºç±»åž‹åŠéšè—ï¼Œå¦‚ï¼šdisplay:block å°†ç›’å­è®¾ç½®ä¸ºä»¥å—å…ƒç´ æ˜¾ç¤º display:none å°†å…ƒç´ éšè—ï¼Œè¯¦ç»†è®¾ç½®è¯´æ˜Žï¼šå…ƒç´ ç±»åž‹float è®¾ç½®å…ƒæµ®åŠ¨ å¦‚ï¼šfloat:left è®¾ç½®å·¦æµ®åŠ¨ float:right è®¾ç½®å³æµ®åŠ¨ï¼Œè¯¦ç»†è®¾ç½®è¯´æ˜Žï¼šå…ƒç´ æµ®åŠ¨clear åœ¨ç›’å­ä¸¤ä¾§æ¸…é™¤æµ®åŠ¨ å¦‚ï¼šclear:both åœ¨ç›’å­ä¸¤ä¾§éƒ½ä¸å…è®¸æµ®åŠ¨ï¼Œè¯¦ç»†è®¾ç½®è¯´æ˜Žï¼šå…ƒç´ æµ®åŠ¨position è®¾ç½®å…ƒç´ å®šä½ å¦‚ï¼šposition:relative è®¾ç½®å…ƒç´ ç›¸å¯¹å®šä½ï¼Œè¯¦ç»†è®¾ç½®è¯´æ˜Žï¼šå…ƒç´ å®šä½background è®¾ç½®å…ƒç´ çš„èƒŒæ™¯è‰²å’ŒèƒŒæ™¯å›¾ç‰‡ï¼Œå¦‚ï¼šbackground:url(bg.jpg) cyan;è®¾ç½®ç›’å­çš„èƒŒæ™¯å›¾ç‰‡ä¸ºbg.jpgï¼ŒèƒŒæ™¯è‰²ä¸ºcyanï¼Œè¯¦ç»†è®¾ç½®è¯´æ˜Žï¼šå…ƒç´ èƒŒæ™¯background-size è®¾ç½®ç›’å­èƒŒæ™¯å›¾çš„å°ºå¯¸ï¼Œå¦‚ï¼šbackground-size:30px 40px;è®¾ç½®èƒŒæ™¯å›¾çš„å°ºå¯¸å®½ä¸º30pxï¼Œé«˜ä¸º40pxï¼Œè¿™ä¸ªå±žæ€§ä¸èƒ½åˆåˆ°backgroundå±žæ€§ä¸­ï¼Œè¯¦ç»†è®¾ç½®è¯´æ˜Žï¼šretinaå±é€‚é…opacity è®¾ç½®å…ƒç´ æ•´ä½“é€æ˜Žåº¦ï¼Œä¸€èˆ¬ä¸ºäº†å…¼å®¹éœ€è¦åŠ ä¸Šfilterå±žæ€§è®¾ç½® å¦‚ï¼šopacity:0.1;filter:alpha(opacity=10)cursor è®¾ç½®é¼ æ ‡æ‚¬åœåœ¨å…ƒç´ ä¸Šæ—¶æŒ‡é’ˆçš„å½¢çŠ¶ å¦‚ï¼šcursor:pointer è®¾ç½®ä¸ºæ‰‹åž‹outline è®¾ç½®æ–‡æœ¬è¾“å…¥æ¡†å‘¨å›´å‡¸æ˜¾çš„è“è‰²çš„çº¿ï¼Œä¸€èˆ¬æ˜¯è®¾ä¸ºæ²¡æœ‰ å¦‚ï¼šoutline:noneborder-radius è®¾ç½®ç›’å­çš„åœ†è§’ å¦‚ï¼šborder-radius:10px è®¾ç½®ç›’å­çš„å››ä¸ªè§’ä¸º10pxåŠå¾„çš„åœ†è§’ï¼Œè¯¦ç»†è®¾ç½®è¯´æ˜Žï¼šcssåœ†è§’box-shadow è®¾ç½®ç›’å­çš„é˜´å½±ï¼Œå¦‚ï¼šbox-shadow:10px 10px 5px 2px pink;è®¾ç½®ç›’å­æœ‰ç²‰è‰²çš„é˜´å½±ï¼Œè¯¦ç»†è®¾ç½®è¯´æ˜Žï¼šcssé˜´å½±transition è®¾ç½®ç›’å­çš„è¿‡æ¸¡åŠ¨ç”»ï¼Œå¦‚ï¼štransition:all 1s ease;è®¾ç½®å…ƒç´ è¿‡æ¸¡åŠ¨ç”»ä¸º1ç§’å®Œæˆï¼Œæ‰€æœ‰å˜åŠ¨çš„å±žæ€§éƒ½åšåŠ¨ç”»ï¼Œè¯¦ç»†è®¾ç½®è¯´æ˜Žï¼šè¿‡æ¸¡åŠ¨ç”»animation è®¾ç½®ç›’å­çš„å…³é”®å¸§åŠ¨ç”»ï¼Œè¯¦ç»†è®¾ç½®è¯´æ˜Žï¼šå…³é”®å¸§åŠ¨ç”»transform è®¾ç½®ç›’å­çš„ä½ç§»ã€æ—‹è½¬ã€ç¼©æ”¾ã€æ–œåˆ‡ç­‰å˜å½¢ï¼Œå¦‚ï¼štransform:rotate(45deg);è®¾ç½®ç›’å­æ—‹è½¬45åº¦ï¼Œè¯¦ç»†è®¾ç½®è¯´æ˜Žï¼šå…ƒç´ å˜å½¢box-sizing è®¾ç½®ç›’å­çš„å°ºå¯¸è®¡ç®—æ–¹å¼ï¼Œå¦‚ï¼šbox-sizing:border-box å°†ç›’å­çš„å°ºå¯¸è®¡ç®—æ–¹æ³•è®¾ç½®ä¸ºæŒ‰è¾¹æ¡†è®¡ç®—ï¼Œæ­¤æ—¶widthå’Œheightçš„å€¼å°±æ˜¯ç›’å­çš„å®žé™…å°ºå¯¸border-collapse è®¾ç½®è¡¨æ ¼è¾¹æ¡†æ˜¯å¦åˆå¹¶ï¼Œå¦‚ï¼šborder-collapse:collapseï¼Œå°†è¡¨æ ¼è¾¹æ¡†åˆå¹¶ï¼Œè¿™æ ·å°±å¯ä»¥åˆ¶ä½œ1pxè¾¹æ¡†çš„è¡¨æ ¼ã€‚9. JavaScript9.1 JavaScriptä»‹ç»JavaScriptæ˜¯è¿è¡Œåœ¨æµè§ˆå™¨ç«¯çš„è„šæ­¥è¯­è¨€ï¼ŒJavaScriptä¸»è¦è§£å†³çš„æ˜¯å‰ç«¯ä¸Žç”¨æˆ·äº¤äº’çš„é—®é¢˜ï¼ŒåŒ…æ‹¬ä½¿ç”¨äº¤äº’ä¸Žæ•°æ®äº¤äº’ã€‚ JavaScriptæ˜¯æµè§ˆå™¨è§£é‡Šæ‰§è¡Œçš„ï¼Œå‰ç«¯è„šæœ¬è¯­è¨€è¿˜æœ‰JScriptï¼ˆå¾®è½¯ï¼ŒIEç‹¬æœ‰ï¼‰ï¼ŒActionScript( Adobeå…¬å¸ï¼Œéœ€è¦æ’ä»¶)ç­‰ã€‚å‰ç«¯ä¸‰å¤§å—1ã€HTMLï¼šé¡µé¢ç»“æž„2ã€CSSï¼šé¡µé¢è¡¨çŽ°ï¼šå…ƒç´ å¤§å°ã€é¢œè‰²ã€ä½ç½®ã€éšè—æˆ–æ˜¾ç¤ºã€éƒ¨åˆ†åŠ¨ç”»æ•ˆæžœ3ã€JavaScriptï¼šé¡µé¢è¡Œä¸ºï¼šéƒ¨åˆ†åŠ¨ç”»æ•ˆæžœã€é¡µé¢ä¸Žç”¨æˆ·çš„äº¤äº’ã€é¡µé¢åŠŸèƒ½9.2 JavaScriptåµŒå…¥é¡µé¢çš„æ–¹å¼1ã€è¡Œé—´äº‹ä»¶ï¼ˆä¸»è¦ç”¨äºŽäº‹ä»¶ï¼‰1&lt;input type="button" name="" onclick="alert('okï¼');"&gt;2ã€é¡µé¢scriptæ ‡ç­¾åµŒå…¥123&lt;script type="text/javascript"&gt; alert('okï¼');&lt;/script&gt;3ã€å¤–éƒ¨å¼•å…¥1&lt;script type="text/javascript" src="js/index.js"&gt;&lt;/script&gt;9.3 å˜é‡JavaScript æ˜¯ä¸€ç§å¼±ç±»åž‹è¯­è¨€ï¼Œjavascriptçš„å˜é‡ç±»åž‹ç”±å®ƒçš„å€¼æ¥å†³å®šã€‚ å®šä¹‰å˜é‡éœ€è¦ç”¨å…³é”®å­— â€˜varâ€™123456var iNum = 123;var sTr = 'asd';//åŒæ—¶å®šä¹‰å¤šä¸ªå˜é‡å¯ä»¥ç”¨","éš”å¼€ï¼Œå…¬ç”¨ä¸€ä¸ªâ€˜varâ€™å…³é”®å­—var iNum = 45,sTr='qwe',sCount='68';9.3.1 å˜é‡ç±»åž‹5ç§åŸºæœ¬æ•°æ®ç±»åž‹ï¼š1ã€number æ•°å­—ç±»åž‹2ã€string å­—ç¬¦ä¸²ç±»åž‹3ã€boolean å¸ƒå°”ç±»åž‹ true æˆ– false4ã€undefined undefinedç±»åž‹ï¼Œå˜é‡å£°æ˜Žæœªåˆå§‹åŒ–ï¼Œå®ƒçš„å€¼å°±æ˜¯undefined5ã€null nullç±»åž‹ï¼Œè¡¨ç¤ºç©ºå¯¹è±¡ï¼Œå¦‚æžœå®šä¹‰çš„å˜é‡å°†æ¥å‡†å¤‡ä¿å­˜å¯¹è±¡ï¼Œå¯ä»¥å°†å˜é‡åˆå§‹åŒ–ä¸ºnull,åœ¨é¡µé¢ä¸ŠèŽ·å–ä¸åˆ°å¯¹è±¡ï¼Œè¿”å›žçš„å€¼å°±æ˜¯null1ç§å¤åˆç±»åž‹ï¼šobject9.3.2 javascriptè¯­å¥ä¸Žæ³¨é‡Š1ã€ä¸€æ¡javascriptè¯­å¥åº”è¯¥ä»¥â€œ;â€ç»“å°¾12345678&lt;script type="text/javascript"&gt; var iNum = 123; var sTr = 'abc123'; function fnAlert()&#123; alert(sTr); &#125;; fnAlert();&lt;/script&gt;2ã€javascriptæ³¨é‡Š1234567891011&lt;script type="text/javascript"&gt; // å•è¡Œæ³¨é‡Š var iNum = 123; /* å¤šè¡Œæ³¨é‡Š 1ã€... 2ã€... */ var sTr = 'abc123';&lt;/script&gt;9.3.3 å˜é‡ã€å‡½æ•°ã€å±žæ€§ã€å‡½æ•°å‚æ•°å‘½åè§„èŒƒ1ã€åŒºåˆ†å¤§å°å†™2ã€ç¬¬ä¸€ä¸ªå­—ç¬¦å¿…é¡»æ˜¯å­—æ¯ã€ä¸‹åˆ’çº¿ï¼ˆ_ï¼‰æˆ–è€…ç¾Žå…ƒç¬¦å·ï¼ˆ$ï¼‰3ã€å…¶ä»–å­—ç¬¦å¯ä»¥æ˜¯å­—æ¯ã€ä¸‹åˆ’çº¿ã€ç¾Žå…ƒç¬¦æˆ–æ•°å­—9.3.4 åŒˆç‰™åˆ©å‘½åé£Žæ ¼å¯¹è±¡o Object æ¯”å¦‚ï¼šoDivæ•°ç»„a Array æ¯”å¦‚ï¼šaItemså­—ç¬¦ä¸²s String æ¯”å¦‚ï¼šsUserNameæ•´æ•°i Integer æ¯”å¦‚ï¼šiItemCountå¸ƒå°”å€¼b Boolean æ¯”å¦‚ï¼šbIsCompleteæµ®ç‚¹æ•°f Float æ¯”å¦‚ï¼šfPriceå‡½æ•°fn Function æ¯”å¦‚ï¼šfnHandleræ­£åˆ™è¡¨è¾¾å¼re RegExp æ¯”å¦‚ï¼šreEmailCheck9.4 èŽ·å–å…ƒç´ æ–¹æ³•ä¸€å¯ä»¥ä½¿ç”¨å†…ç½®å¯¹è±¡documentä¸Šçš„getElementByIdæ–¹æ³•æ¥èŽ·å–é¡µé¢ä¸Šè®¾ç½®äº†idå±žæ€§çš„å…ƒç´ ï¼ŒèŽ·å–åˆ°çš„æ˜¯ä¸€ä¸ªhtmlå¯¹è±¡ï¼Œç„¶åŽå°†å®ƒèµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ï¼Œæ¯”å¦‚ï¼š12345&lt;script type="text/javascript"&gt; var oDiv = document.getElementById('div1');&lt;/script&gt;....&lt;div id="div1"&gt;è¿™æ˜¯ä¸€ä¸ªdivå…ƒç´ &lt;/div&gt;ä¸Šé¢çš„è¯­å¥ï¼Œå¦‚æžœæŠŠjavascriptå†™åœ¨å…ƒç´ çš„ä¸Šé¢ï¼Œå°±ä¼šå‡ºé”™ï¼Œå› ä¸ºé¡µé¢ä¸Šä»Žä¸Šå¾€ä¸‹åŠ è½½æ‰§è¡Œçš„ï¼ŒjavascriptåŽ»é¡µé¢ä¸ŠèŽ·å–å…ƒç´ div1çš„æ—¶å€™ï¼Œå…ƒç´ div1è¿˜æ²¡æœ‰åŠ è½½ï¼Œè§£å†³æ–¹æ³•æœ‰ä¸¤ç§ï¼šç¬¬ä¸€ç§æ–¹æ³•ï¼šå°†javascriptæ”¾åˆ°é¡µé¢æœ€ä¸‹è¾¹12345678....&lt;div id="div1"&gt;è¿™æ˜¯ä¸€ä¸ªdivå…ƒç´ &lt;/div&gt;....&lt;script type="text/javascript"&gt; var oDiv = document.getElementById('div1');&lt;/script&gt;&lt;/body&gt;ç¬¬äºŒç§æ–¹æ³•ï¼šå°†javascriptè¯­å¥æ”¾åˆ°window.onloadè§¦å‘çš„å‡½æ•°é‡Œé¢,èŽ·å–å…ƒç´ çš„è¯­å¥ä¼šåœ¨é¡µé¢åŠ è½½å®ŒåŽæ‰æ‰§è¡Œï¼Œå°±ä¸ä¼šå‡ºé”™äº†ã€‚123456789&lt;script type="text/javascript"&gt; window.onload = function()&#123; var oDiv = document.getElementById('div1'); &#125;&lt;/script&gt;....&lt;div id="div1"&gt;è¿™æ˜¯ä¸€ä¸ªdivå…ƒç´ &lt;/div&gt;9.5 æ“ä½œå…ƒç´ å±žæ€§èŽ·å–çš„é¡µé¢å…ƒç´ ï¼Œå°±å¯ä»¥å¯¹é¡µé¢å…ƒç´ çš„å±žæ€§è¿›è¡Œæ“ä½œï¼Œå±žæ€§çš„æ“ä½œåŒ…æ‹¬å±žæ€§çš„è¯»å’Œå†™ã€‚9.5.1 æ“ä½œå±žæ€§çš„æ–¹æ³•1ã€â€œ.â€ æ“ä½œ2ã€â€œ[ ]â€æ“ä½œ9.5.2 å±žæ€§å†™æ³•1ã€htmlçš„å±žæ€§å’Œjsé‡Œé¢å±žæ€§å†™æ³•ä¸€æ ·2ã€â€œclassâ€ å±žæ€§å†™æˆ â€œclassNameâ€3ã€â€œstyleâ€ å±žæ€§é‡Œé¢çš„å±žæ€§ï¼Œæœ‰æ¨ªæ çš„æ”¹æˆé©¼å³°å¼ï¼Œæ¯”å¦‚ï¼šâ€œfont-sizeâ€ï¼Œæ”¹æˆâ€style.fontSizeâ€é€šè¿‡â€œ.â€æ“ä½œå±žæ€§ï¼šå…·ä½“æ¥è¯´æ˜¯æ“ä½œå±žæ€§çš„å€¼1234567891011121314151617181920212223242526272829303132333435363738394041&lt;script type="text/javascript"&gt; // å½“æ•´ä¸ªé¡µé¢åŠ è½½å®Œæ¯•ä¹‹åŽå†æ‰§è¡ŒèŠ±æ‹¬å·é‡Œé¢çš„è¯­å¥ window.onload = function () &#123; // é€šè¿‡IDåèŽ·å–å…ƒç´ èµ‹å€¼ç»™oDivå˜é‡ var oDiv = document.getElementById("div1"); var oA = document.getElementById("link"); var oDiv2 = document.getElementById("div2"); // æ”¹å˜å…ƒç´ çš„å±žæ€§ oDiv.style.color = "red"; oDiv.style.fontSize = "20px"; oA.href = "http://www.baidu.com"; oA.title = "è¿™æ˜¯ä¸€ä¸ªç™¾åº¦ç½‘çš„é“¾æŽ¥"; oDiv2.className = "box2"; // è¯»å–å…ƒç´ çš„å±žæ€§ var sId = oDiv.id; alert(sId) &#125;&lt;/script&gt;&lt;style type="text/css"&gt; .box&#123; font-size: 20px; color: gold; &#125; .box2&#123; font-size: 30px; color: pink; &#125;&lt;/style&gt;&lt;div id="div1"&gt;è¿™æ˜¯ä¸€ä¸ªdivå…ƒç´ &lt;/div&gt;&lt;a href="#" id="link"&gt;è¿™æ˜¯ä¸€ä¸ªé“¾æŽ¥&lt;/a&gt;&lt;div class="box" id="div2"&gt;è¿™æ˜¯ç¬¬äºŒä¸ªdivå…ƒç´ &lt;/div&gt;é€šè¿‡â€œ[ ]â€æ“ä½œå±žæ€§ï¼šå…·ä½“æ¥è¯´æ˜¯æ“ä½œå±žæ€§ï¼ŒæŠŠå±žæ€§ä½œä¸ºå˜é‡æ¥å¤„ç†ï¼Œè€Œä¸æ˜¯ä½œä¸ºä¸€ä¸ªå€¼æ¥å¤„ç†123456789101112131415161718192021&lt;script type="text/javascript"&gt; window.onload = function()&#123; var oInput1 = document.getElementById('input1'); var oInput2 = document.getElementById('input2'); var oA = document.getElementById('link1'); // è¯»å–å±žæ€§ var sVal1 = oInput1.value; var sVal2 = oInput2.value; // å†™(è®¾ç½®)å±žæ€§ // oA.style.val1 = val2; æ²¡ååº” oA.style[sVal1] = sVal2; &#125;&lt;/script&gt;......&lt;input type="text" name="setattr" id="input1" value="fontSize"&gt;&lt;input type="text" name="setnum" id="input2" value="30px"&gt;&lt;a href="http://www.baidu.com" id="link1"&gt;è¿™æ˜¯ç™¾åº¦ç½‘ç«™åœ°å€&lt;/a&gt;9.5.3 innerHTMLinnerHTMLå¯ä»¥è¯»å–æˆ–è€…å†™å…¥æ ‡ç­¾åŒ…è£¹çš„å†…å®¹1234567891011121314&lt;script type="text/javascript"&gt; window.onload = function()&#123; var oDiv = document.getElementById('div1'); //è¯»å– var sTxt = oDiv.innerHTML; alert(sTxt); //å†™å…¥ oDiv.innerHTML = '&lt;a href="http://http://www.baidu.com"&gt;è¿™æ˜¯ç™¾åº¦ç½‘ç«™åœ°å€&lt;a/&gt;'; &#125;&lt;/script&gt;......&lt;div id="div1"&gt;è¿™æ˜¯ä¸€ä¸ªdivå…ƒç´ &lt;/div&gt;9.6 å‡½æ•°å‡½æ•°å°±æ˜¯é‡å¤æ‰§è¡Œçš„ä»£ç ç‰‡ã€‚9.6.1 å‡½æ•°å®šä¹‰ä¸Žæ‰§è¡Œ123456789101112131415161718192021&lt;script type="text/javascript"&gt; // å‡½æ•°çš„å®šä¹‰ function fnMyalert() &#123; alert('Hello world!') &#125; function fnChange() &#123; var oDiv = document.getElementById("div1"); oDiv.style.color = "red"; oDiv.style.fontSize = "30px"; &#125; //å‡½æ•°æ‰§è¡Œ // fnChange();&lt;/script&gt;&lt;!--æ ‡ç­¾é‡Œè°ƒç”¨å‡½æ•°æ‰§è¡Œ--&gt;&lt;div id="div1" onclick="fnMyalert()"&gt;è¿™æ˜¯ä¸€ä¸ªdivå…ƒç´ &lt;/div&gt;&lt;input type="button" name="" value="æ”¹å˜div" onclick="fnChange()"&gt;9.6.2 å˜é‡ä¸Žå‡½æ•°é¢„è§£æžJavaScriptè§£æžè¿‡ç¨‹åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼Œå…ˆæ˜¯ç¼–è¯‘é˜¶æ®µï¼Œç„¶åŽæ‰§è¡Œé˜¶æ®µï¼Œåœ¨ç¼–è¯‘é˜¶æ®µä¼šå°†functionå®šä¹‰çš„å‡½æ•°æå‰ï¼Œå¹¶ä¸”å°†varå®šä¹‰çš„å˜é‡å£°æ˜Žæå‰ï¼Œå°†å®ƒèµ‹å€¼ä¸ºundefinedã€‚12345678&lt;script type="text/javascript"&gt; fnAlert(); // å¼¹å‡º helloï¼ alert(iNum); // å¼¹å‡º undefined function fnAlert()&#123; alert('hello!'); &#125; var iNum = 123;&lt;/script&gt;9.6.3 æå–è¡Œé—´äº‹ä»¶åœ¨htmlè¡Œé—´è°ƒç”¨çš„äº‹ä»¶å¯ä»¥æå–åˆ°javascriptä¸­è°ƒç”¨ï¼Œä»Žè€Œåšåˆ°ç»“æž„ä¸Žè¡Œä¸ºåˆ†ç¦»ã€‚è¯´ç™½äº†å°±æ˜¯åœ¨htmlçš„æ ‡ç­¾ä¸­ä¸å«æœ‰ä»»ä½•å…³äºŽjsçš„ä»£ç ï¼Œå¦‚ä¸‹ä¾‹ï¼Œé€šè¿‡htmlæ ‡ç­¾ä¸­çš„idè·Ÿjså…³è”èµ·æ¥ï¼Œä»Žè€Œä½¿ç”¨jsã€‚12345678910111213141516171819202122&lt;!--è¡Œé—´äº‹ä»¶è°ƒç”¨å‡½æ•° --&gt;&lt;script type="text/javascript"&gt; function fnAlert()&#123; alert('ok!'); &#125;&lt;/script&gt;......&lt;input type="button" name="" value="å¼¹å‡º" onclick="fnAlert()"&gt;&lt;!-- æå–è¡Œé—´äº‹ä»¶ --&gt;&lt;script type="text/javascript"&gt;window.onload = function()&#123; var oBtn = document.getElementById('btn1'); oBtn.onclick = fnAlert; function fnAlert()&#123; alert('ok!'); &#125;&#125; &lt;/script&gt;......&lt;input type="button" name="" value="å¼¹å‡º" id="btn1"&gt;9.6.4 åŒ¿åå‡½æ•°å®šä¹‰çš„å‡½æ•°å¯ä»¥ä¸ç»™åç§°ï¼Œè¿™ä¸ªå«åšåŒ¿åå‡½æ•°ï¼Œå¯ä»¥å°†åŒ¿åå‡½æ•°ç›´æŽ¥èµ‹å€¼ç»™å…ƒç´ ç»‘å®šçš„äº‹ä»¶æ¥å®ŒæˆåŒ¿åå‡½æ•°çš„è°ƒç”¨ã€‚123456789101112131415161718&lt;script type="text/javascript"&gt;window.onload = function()&#123; var oBtn = document.getElementById('btn1'); /* oBtn.onclick = myalert; function myalert()&#123; alert('ok!'); &#125; */ // ç›´æŽ¥å°†åŒ¿åå‡½æ•°èµ‹å€¼ç»™ç»‘å®šçš„äº‹ä»¶ oBtn.onclick = function ()&#123; alert('ok!'); &#125;&#125;&lt;/script&gt;9.6.5 ç»¼åˆç»ƒä¹ ç½‘é¡µæ¢è‚¤1234567891011121314151617181920212223242526272829303132333435&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Title&lt;/title&gt; &lt;link rel="stylesheet" href="css/004_01.css" id="link01"&gt; &lt;script type="text/javascript"&gt; window.onload = function () &#123; var oBtn01 = document.getElementById("btn01"); var oBtn02 = document.getElementById("btn01"); var oLink = document.getElementById("link01"); oBtn01.onclick = function () &#123; oLink.href = "css/004_01.css"; &#125;; oBtn02.onclick = function () &#123; oLink.href = "css/004_02.css"; &#125; &#125; &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;input type="button" name="" value="çš®è‚¤1" id="btn01"&gt;&lt;input type="button" name="" value="çš®è‚¤2" id="btn02"&gt;&lt;/body&gt;&lt;/html&gt;1234567891011/* css/004_01.css */body&#123; background-color: gold;&#125;input&#123; width: 200px; height: 50px; background-color: aqua; border: 0;&#125;12345678910/* css/004_02.css */body&#123; background-color: pink;&#125;input&#123; width: 200px; height: 50px; background-color: aqua; border: 0;&#125;9.6.6 å‡½æ•°ä¼ å‚123456&lt;script type="text/javascript"&gt; function fnAlert(a)&#123; alert(a); &#125; fnAlert(12345);&lt;/script&gt;9.6.7 å‡½æ•°â€™returnâ€™å…³é”®å­—å‡½æ•°ä¸­â€™returnâ€™å…³é”®å­—çš„ä½œç”¨ï¼š1ã€è¿”å›žå‡½æ•°æ‰§è¡Œçš„ç»“æžœ2ã€ç»“æŸå‡½æ•°çš„è¿è¡Œ3ã€é˜»æ­¢é»˜è®¤è¡Œä¸º1234567891011121314151617181920212223242526272829303132// å‡½æ•°è¿”å›žå€¼+ç»“æŸå‡½æ•°è¿è¡Œ&lt;script type="text/javascript"&gt; function fnAdd(a,b) &#123; var c = a + b; alert('hello-1'); // hello-1 // è¿”å›žcçš„å€¼ï¼Œç»“æŸå‡½æ•°çš„è¿è¡Œ return c; // è¿™ä¸€å¥ä¸å¼¹å‡º alert('hello-2'); &#125; var result = fnAdd(3,4); alert(result); // å¼¹å‡º7&lt;/script&gt;// å‡½æ•°ä¼ å‚&lt;script type="text/javascript"&gt; window.onload = function () &#123; function fnChangestyle(mystyle,val) &#123; var oDiv = document.getElementById("div1"); oDiv.style[mystyle] = val; &#125; fnChangestyle("color","pink"); fnChangestyle("fontSize","30px"); &#125;&lt;/script&gt;&lt;div id="div1"&gt;è¿™æ˜¯ä¸€ä¸ªdivå…ƒç´ &lt;/div&gt;9.7 æ¡ä»¶è¯­å¥é€šè¿‡æ¡ä»¶æ¥æŽ§åˆ¶ç¨‹åºçš„èµ°å‘ï¼Œå°±éœ€è¦ç”¨åˆ°æ¡ä»¶è¯­å¥ã€‚9.7.1 è¿ç®—ç¬¦1ã€ç®—æœ¯è¿ç®—ç¬¦ï¼š +(åŠ )ã€ -(å‡)ã€ (ä¹˜)ã€ /(é™¤)ã€ %(æ±‚ä½™æ•°)2ã€èµ‹å€¼è¿ç®—ç¬¦ï¼š=ã€ +=ã€ -=ã€ =ã€ /=ã€ %=3ã€æ¡ä»¶è¿ç®—ç¬¦ï¼š==ã€===ã€&gt;ã€&gt;=ã€&lt;ã€&lt;=ã€!=ã€&amp;&amp;(è€Œä¸”)ã€||(æˆ–è€…)ã€!(å¦)123456789101112131415161718192021&lt;script type="text/javascript"&gt; window.onload = function () &#123; var oInput01 = document.getElementById("input01"); var oInput02 = document.getElementById("input02"); var oBtn = document.getElementById("btn"); oBtn.onclick = function () &#123; // parseInt()å‡½æ•°è½¬æ¢æˆæ•°å­— var iVal01 = parseInt(oInput01.value); var iVal02 = parseInt(oInput02.value); var iBtn = iVal01 + iVal02; alert(iBtn); &#125; &#125;;&lt;/script&gt;&lt;input type="text" name="" id="input01"&gt; +&lt;input type="text" name="" id="input02"&gt;&lt;input type="button" name="" value="ç›¸åŠ " id="btn"&gt;9.7.2 if else1234567891011&lt;script type="text/javascript"&gt; var iNum01 = 3; var iNum02 = 5; var sTr; if (iNum01 &gt; iNum02) &#123; sTr = 'å¤§äºŽ'; &#125; else &#123; sTr = 'å°äºŽ'; &#125; alert(sTr);&lt;/script&gt;9.7.3 ç†è§£ç»ƒä¹ åˆ¶ä½œå•ä¸ªæŒ‰é’®ç‚¹å‡»åˆ‡æ¢å…ƒç´ çš„æ˜¾ç¤ºå’Œéšè—æ•ˆæžœ12345678910111213141516171819202122232425&lt;script type="text/javascript"&gt; window.onload = function () &#123; var oBtn = document.getElementById("btn01"); var oDiv = document.getElementById("box01"); oBtn.onclick = function () &#123; if (oDiv.style.display == "none") &#123; oDiv.style.display = 'block'; &#125; else &#123; oDiv.style.display = "none"; &#125; &#125; &#125;&lt;/script&gt;&lt;style type="text/css"&gt; .box &#123; width: 200px; height: 400px; background-color: gold; &#125;&lt;/style&gt;&lt;input type="button" value="åˆ‡æ¢" id="btn01"&gt;&lt;div class="box" id="box01"&gt;&lt;/div&gt;9.7.4 å¤šé‡if elseè¯­å¥12345678910111213var iNow = 1;if(iNow==1)&#123; ... ;&#125;else if(iNow==2)&#123; ... ;&#125;else&#123; ... ;&#125;9.7.5 switchè¯­å¥å¤šé‡if elseè¯­å¥å¯ä»¥æ¢æˆæ€§èƒ½æ›´é«˜çš„switchè¯­å¥123456789101112var iNow = 1;switch (iNow)&#123; case 1: ...; break; case 2: ...; break; default: ...;&#125;9.7.6 ç†è§£ç»ƒä¹ åˆ¶ä½œéšç€æ˜ŸæœŸæ¢èƒŒæ™¯çš„é¡µé¢123456789101112131415161718192021222324252627282930313233343536373839&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Title&lt;/title&gt; &lt;script type="text/javascript"&gt; window.onload = function () &#123; var iWeek = 5; var oBody = document.getElementById("body01"); switch (iWeek) &#123; case 1: oBody.style.backgroundColor = "gold"; break; case 2: oBody.style.backgroundColor = "pink"; break; case 3: oBody.style.backgroundColor = "red"; break; case 4: oBody.style.backgroundColor = "green"; break; case 5: oBody.style.backgroundColor = "yellow"; break; default : oBody.style.backgroundColor = "blue"; break; &#125; &#125; &lt;/script&gt;&lt;/head&gt;&lt;body id="body01"&gt;&lt;/body&gt;&lt;/html&gt;9.8 æ•°ç»„åŠæ“ä½œæ–¹æ³•æ•°ç»„å°±æ˜¯ä¸€ç»„æ•°æ®çš„é›†åˆï¼Œjavascriptä¸­ï¼Œæ•°ç»„é‡Œé¢çš„æ•°æ®å¯ä»¥æ˜¯ä¸åŒç±»åž‹çš„ã€‚9.8.1 å®šä¹‰æ•°ç»„çš„æ–¹æ³•12345//å¯¹è±¡çš„å®žä¾‹åˆ›å»ºvar aList = new Array(1,2,3);//ç›´æŽ¥é‡åˆ›å»ºvar aList2 = [1,2,3,'asd'];9.8.2 æ“ä½œæ•°ç»„ä¸­æ•°æ®çš„æ–¹æ³•1ã€èŽ·å–æ•°ç»„çš„é•¿åº¦ï¼šaList.length;12var aList = [1,2,3,4];alert(aList.length); // å¼¹å‡º42ã€ç”¨ä¸‹æ ‡æ“ä½œæ•°ç»„çš„æŸä¸ªæ•°æ®ï¼šaList[0];12var aList = [1,2,3,4];alert(aList[0]); // å¼¹å‡º13ã€join() å°†æ•°ç»„æˆå‘˜é€šè¿‡ä¸€ä¸ªåˆ†éš”ç¬¦åˆå¹¶æˆå­—ç¬¦ä¸²12var aList = [1,2,3,4];alert(aList.join('-')); // å¼¹å‡º 1-2-3-44ã€push() å’Œ pop() ä»Žæ•°ç»„æœ€åŽå¢žåŠ æˆå‘˜æˆ–åˆ é™¤æˆå‘˜12345var aList = [1,2,3,4];aList.push(5);alert(aList); //å¼¹å‡º1,2,3,4,5aList.pop();alert(aList); // å¼¹å‡º1,2,3,45ã€unshift()å’Œ shift() ä»Žæ•°ç»„å‰é¢å¢žåŠ æˆå‘˜æˆ–åˆ é™¤æˆå‘˜12345var aList = [1,2,3,4];aList.unshift(5);alert(aList); //å¼¹å‡º5,1,2,3,4aList.shift();alert(aList); // å¼¹å‡º1,2,3,46ã€reverse() å°†æ•°ç»„åè½¬123var aList = [1,2,3,4];aList.reverse();alert(aList); // å¼¹å‡º4,3,2,17ã€indexOf() è¿”å›žæ•°ç»„ä¸­å…ƒç´ ç¬¬ä¸€æ¬¡å‡ºçŽ°çš„ç´¢å¼•å€¼12var aList = [1,2,3,4,1,3,4];alert(aList.indexOf(1));8ã€splice() åœ¨æ•°ç»„ä¸­å¢žåŠ æˆ–åˆ é™¤æˆå‘˜123var aList = [1,2,3,4];aList.splice(2,1,7,8,9); //ä»Žç¬¬2ä¸ªå…ƒç´ å¼€å§‹ï¼Œåˆ é™¤1ä¸ªå…ƒç´ ï¼Œç„¶åŽåœ¨æ­¤ä½ç½®å¢žåŠ '7,8,9'ä¸‰ä¸ªå…ƒç´ alert(aList); //å¼¹å‡º 1,2,7,8,9,49.8.3 å¤šç»´æ•°ç»„å¤šç»´æ•°ç»„æŒ‡çš„æ˜¯æ•°ç»„çš„æˆå‘˜ä¹Ÿæ˜¯æ•°ç»„çš„æ•°ç»„ã€‚123var aList = [[1,2,3],['a','b','c']];alert(aList[0][1]); //å¼¹å‡º2;æ‰¹é‡æ“ä½œæ•°ç»„ä¸­çš„æ•°æ®ï¼Œéœ€è¦ç”¨åˆ°å¾ªçŽ¯è¯­å¥9.9 å¾ªçŽ¯è¯­å¥ç¨‹åºä¸­è¿›è¡Œæœ‰è§„å¾‹çš„é‡å¤æ€§æ“ä½œï¼Œéœ€è¦ç”¨åˆ°å¾ªçŽ¯è¯­å¥ã€‚9.9.1 forå¾ªçŽ¯1234for(var i=0;i&lt;len;i++)&#123; ......&#125;9.9.2 è¯¾å ‚ç»ƒä¹ 1ã€å°†æ•°ç»„ä¸­çš„æ•°æ®åˆ†åˆ«ç”¨å¼¹æ¡†å¼¹å‡º12345678910111213&lt;script type="text/javascript"&gt; for (var i = 0; i &lt; 5; i++) &#123; alert(i); &#125; var aList = ['a','b','c','d','e']; var iLen = aList.length; for (var i = 0; i &lt; iLen; i++) &#123; alert(aList[i]); &#125;&lt;/script&gt;2ã€å°†æ•°ç»„ä¸­çš„æ•°æ®æ”¾å…¥åˆ°é¡µé¢ä¸­çš„åˆ—è¡¨ä¸­1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556&lt;script type="text/javascript"&gt; window.onload = function () &#123; var oLl = document.getElementsByTagName("li"); var aList = ['apple', 'banana', 'orange', 'xigua', 'boluo']; var aLen = aList.length; for (var i = 0; i &lt; aLen; i++) &#123; var name = aList[i]; // èŽ·å–æ ‡ç­¾å†…çš„å€¼ oLl[i].innerHTML = name; &#125; &#125;&lt;/script&gt;&lt;ul&gt; &lt;li&gt;&lt;/li&gt; &lt;li&gt;&lt;/li&gt; &lt;li&gt;&lt;/li&gt; &lt;li&gt;&lt;/li&gt; &lt;li&gt;&lt;/li&gt;&lt;/ul&gt;// å¦ä¸€ç§æ–¹æ³•&lt;script type="text/javascript"&gt; window.onload = function () &#123; var oUl = document.getElementById('list'); var aList = ['apple', 'banana', 'orange', 'xigua', 'boluo']; var aLen = aList.length; var sTr = ''; for (var i = 0; i &lt; aLen; i++) &#123; sTr += '&lt;li&gt;' + aList[i] + '&lt;/li&gt;'; oUl.innerHTML = sTr; &#125; &#125;&lt;/script&gt;&lt;style type="text/css"&gt; .list &#123; list-style: none; margin: 50px auto 0; padding: 0; width: 300px; height: 305px; &#125; .list li &#123; height: 60px; border-bottom: 1px dotted #000; line-height: 60px; font-size: 16px; &#125;&lt;/style&gt;&lt;ul class="list" id="list"&gt;&lt;/ul&gt;9.9.3 whileå¾ªçŽ¯123456var i=0;while(i&lt;8)&#123; ...... i++;&#125;9.9.4 æ•°ç»„åŽ»é‡12345678910111213var aList = [1,2,3,4,4,3,2,1,2,3,4,5,6,5,5,3,3,4,2,1];var aList2 = [];for(var i=0;i&lt;aList.length;i++)&#123; if(aList.indexOf(aList[i])==i) &#123; aList2.push(aList[i]); &#125;&#125;alert(aList2);9.10 èŽ·å–å…ƒç´ æ–¹æ³•äºŒå¯ä»¥ä½¿ç”¨å†…ç½®å¯¹è±¡documentä¸Šçš„getElementsByTagNameæ–¹æ³•æ¥èŽ·å–é¡µé¢ä¸Šçš„æŸä¸€ç§æ ‡ç­¾ï¼ŒèŽ·å–çš„æ˜¯ä¸€ä¸ªé€‰æ‹©é›†ï¼Œä¸æ˜¯æ•°ç»„ï¼Œä½†æ˜¯å¯ä»¥ç”¨ä¸‹æ ‡çš„æ–¹å¼æ“ä½œé€‰æ‹©é›†é‡Œé¢çš„æ ‡ç­¾å…ƒç´ ã€‚1234567891011121314151617&lt;script type="text/javascript"&gt; window.onload = function()&#123; var aLi = document.getElementsByTagName('li'); // aLi.style.backgroundColor = 'gold'; // å‡ºé”™ï¼ä¸èƒ½åŒæ—¶è®¾ç½®å¤šä¸ªli alert(aLi.length); aLi[0].style.backgroundColor = 'gold'; &#125;&lt;/script&gt;....&lt;ul&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;3&lt;/li&gt; &lt;li&gt;4&lt;/li&gt; &lt;li&gt;5&lt;/li&gt; &lt;li&gt;6&lt;/li&gt;&lt;/ul&gt;è¯¾å ‚ç»ƒä¹ ä½¿ç”¨å¾ªçŽ¯æ“ä½œåˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859&lt;script type="text/javascript"&gt; window.onload = function () &#123; // é€šè¿‡æ ‡ç­¾åç§°èŽ·å–liå…ƒç´ ï¼Œç”Ÿæˆä¸€ä¸ªé€‰æ‹©é›†ï¼Œèµ‹å€¼ç»™aLi var aLi = document.getElementsByTagName('li'); // è¯»å–é€‰æ‹©é›†å†…å…ƒç´ çš„ä¸ªæ•° //alert(aLi.length); // å¼¹å‡º13 var iLen = aLi.length; //ç»™ä¸€ä¸ªliè®¾ç½®èƒŒæ™¯è‰² //aLi[0].style.backgroundColor = 'gold'; // ä¸èƒ½ç»™é€‰æ‹©é›†è®¾ç½®æ ·å¼å±žæ€§ //aLi.style.backgroundColor = 'gold'; /* åŒæ—¶ç»™æ‰€æœ‰çš„liåŠ èƒŒæ™¯è‰² for(var i=0;i&lt;iLen;i++) &#123; aLi[i].style.backgroundColor = 'gold'; &#125; */ var oUl = document.getElementById('list1'); var aLi2 = oUl.getElementsByTagName('li'); var iLen2 = aLi2.length; for (var i = 0; i &lt; iLen2; i++) &#123; if (i % 2 == 0) &#123; aLi2[i].style.backgroundColor = 'gold'; &#125; &#125; &#125;&lt;/script&gt;&lt;ul id="list1"&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;3&lt;/li&gt; &lt;li&gt;4&lt;/li&gt; &lt;li&gt;5&lt;/li&gt; &lt;li&gt;6&lt;/li&gt; &lt;li&gt;7&lt;/li&gt; &lt;li&gt;8&lt;/li&gt;&lt;/ul&gt;&lt;ul id="list2"&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;3&lt;/li&gt; &lt;li&gt;4&lt;/li&gt; &lt;li&gt;5&lt;/li&gt;&lt;/ul&gt;9.11 Javascriptç»„æˆ1ã€ECMAscript javascriptçš„è¯­æ³•ï¼ˆå˜é‡ã€å‡½æ•°ã€å¾ªçŽ¯è¯­å¥ç­‰è¯­æ³•ï¼‰2ã€DOM æ–‡æ¡£å¯¹è±¡æ¨¡åž‹ æ“ä½œhtmlå’Œcssçš„æ–¹æ³•3ã€BOM æµè§ˆå™¨å¯¹è±¡æ¨¡åž‹ æ“ä½œæµè§ˆå™¨çš„ä¸€äº›æ–¹æ³•9.12 å­—ç¬¦ä¸²å¤„ç†æ–¹æ³•1ã€å­—ç¬¦ä¸²åˆå¹¶æ“ä½œï¼šâ€œ + â€1234567var iNum01 = 12;var iNum02 = 24;var sNum03 = '12';var sTr = 'abc';alert(iNum01+iNum02); //å¼¹å‡º36alert(iNum01+sNum03); //å¼¹å‡º1212 æ•°å­—å’Œå­—ç¬¦ä¸²ç›¸åŠ ç­‰åŒäºŽå­—ç¬¦ä¸²ç›¸åŠ alert(sNum03+sTr); // å¼¹å‡º12abc2ã€parseInt() å°†æ•°å­—å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•´æ•°123456var sNum01 = '12';var sNum02 = '24';var sNum03 = '12.32';alert(sNum01+sNum02); //å¼¹å‡º1224alert(parseInt(sNum01)+parseInt(sNum02)) //å¼¹å‡º36alert(sNum03) //å¼¹å‡ºæ•°å­—12 å°†å­—ç¬¦ä¸²å°æ•°è½¬åŒ–ä¸ºæ•°å­—æ•´æ•°3ã€parseFloat() å°†æ•°å­—å­—ç¬¦ä¸²è½¬åŒ–ä¸ºå°æ•°12var sNum03 = '12.32'alert(parseFloat(sNum03)); //å¼¹å‡º 12.32 å°†å­—ç¬¦ä¸²å°æ•°è½¬åŒ–ä¸ºæ•°å­—å°æ•°4ã€split() æŠŠä¸€ä¸ªå­—ç¬¦ä¸²åˆ†éš”æˆå­—ç¬¦ä¸²ç»„æˆçš„æ•°ç»„123456var sTr = '2017-4-22';var aRr = sTr.split("-");var aRr2= sTr.split("");alert(aRr); //å¼¹å‡º['2017','4','2']alert(aRr2); //å¼¹å‡º['2','0','1','7','-','4','-','2','2']5ã€charAt() èŽ·å–å­—ç¬¦ä¸²ä¸­çš„æŸä¸€ä¸ªå­—ç¬¦123var sId = "#div1";var sTr = sId.charAt(0);alert(sTr); //å¼¹å‡º #6ã€indexOf() æŸ¥æ‰¾å­—ç¬¦ä¸²æ˜¯å¦å«æœ‰æŸå­—ç¬¦123var sTr = "abcdefgh";var iNum = sTr.indexOf("c");alert(iNum); //å¼¹å‡º27ã€substring() æˆªå–å­—ç¬¦ä¸² ç”¨æ³•ï¼š substring(start,end)ï¼ˆä¸åŒ…æ‹¬endï¼‰123456var sTr = "abcdefghijkl";var sTr2 = sTr.substring(3,5);var sTr3 = sTr.substring(1);alert(sTr2); //å¼¹å‡º dealert(sTr3); //å¼¹å‡º bcdefghijkl8ã€toUpperCase() å­—ç¬¦ä¸²è½¬å¤§å†™123var sTr = "abcdef";var sTr2 = sTr.toUpperCase();alert(sTr2); //å¼¹å‡ºABCDEF9ã€toLowerCase() å­—ç¬¦ä¸²è½¬å°å†™123var sTr = "ABCDEF";var sTr2 = sTr.toLowerCase();alert(sTr2); //å¼¹å‡ºabcdefå­—ç¬¦ä¸²åè½¬1234var str = 'asdfj12jlsdkf098';var str2 = str.split('').reverse().join('');alert(str2);9.13 ç±»åž‹è½¬æ¢1ã€ç›´æŽ¥è½¬æ¢ parseInt() ä¸Ž parseFloat()12345678alert('12'+7); //å¼¹å‡º127alert( parseInt('12') + 7 ); //å¼¹å‡º19 alert( parseInt(5.6)); // å¼¹å‡º5alert('5.6'+2.3); // å¼¹å‡º5.62.3alert(parseFloat('5.6')+2.3); // å¼¹å‡º7.8999999999999995alert(0.1+0.2); //å¼¹å‡º 0.3000000000000004alert((0.1*100+0.2*100)/100); //å¼¹å‡º0.3alert((parseFloat('5.6')*100+2.3*100)/100); //å¼¹å‡º7.92ã€éšå¼è½¬æ¢ â€œ==â€ å’Œ â€œ-â€1234567if('3'==3)&#123; alert('ç›¸ç­‰');&#125;// å¼¹å‡º'ç›¸ç­‰'alert('10'-3); // å¼¹å‡º73ã€NaN å’Œ isNaN12alert( parseInt('123abc') ); // å¼¹å‡º123alert( parseInt('abc123') ); // å¼¹å‡ºNaN9.14 è°ƒè¯•ç¨‹åºçš„æ–¹æ³•1ã€alertå¼¹å‡ºçš„æ—¶å€™ç¨‹åºä¼šå¡ä½ï¼Œä¹Ÿå°±æ˜¯ä¼šé˜»æ­¢ç¨‹åºçš„è¿è¡Œ2ã€console.log3ã€document.title12345678// æ”¹å˜çš„æ˜¯æ ‡ç­¾&lt;title&gt;çš„å€¼window.onload = function () &#123; var iNum01 = 20; setInterval(function () &#123; iNum01++; document.title = iNum01; &#125;,100);&#125;9.15 å®šæ—¶å™¨9.15.1 å®šæ—¶å™¨åœ¨javascriptä¸­çš„ä½œç”¨1ã€åˆ¶ä½œåŠ¨ç”»2ã€å¼‚æ­¥æ“ä½œ3ã€å‡½æ•°ç¼“å†²ä¸ŽèŠ‚æµå®šæ—¶å™¨ç±»åž‹åŠè¯­æ³•123456789101112131415161718/* å®šæ—¶å™¨ï¼š setTimeout åªæ‰§è¡Œä¸€æ¬¡çš„å®šæ—¶å™¨ clearTimeout å…³é—­åªæ‰§è¡Œä¸€æ¬¡çš„å®šæ—¶å™¨ setInterval åå¤æ‰§è¡Œçš„å®šæ—¶å™¨ clearInterval å…³é—­åå¤æ‰§è¡Œçš„å®šæ—¶å™¨*/var time1 = setTimeout(myalert,2000);var time2 = setInterval(myalert,2000);/*clearTimeout(time1);clearInterval(time2);*/function myalert()&#123; alert('ok!');&#125;9.15.2 è¯¾å ‚ç»ƒä¹ 1ã€å®šæ—¶å™¨åˆ¶ä½œç§»åŠ¨åŠ¨ç”»12345678910111213141516171819202122232425262728293031323334353637383940&lt;script type="text/javascript"&gt; window.onload = function () &#123; var oDiv = document.getElementById('div1'); var iLeft = 0; var iSpeed = 3; /* var timer = setInterval(moving,30); function moving()&#123; iLeft += 3; oDiv.style.left = iLeft + 'px'; &#125; */ var timer = setInterval(function () &#123; iLeft += iSpeed; oDiv.style.left = iLeft + 'px'; if (iLeft &gt; 700) &#123; // clearInterval(timer); // å®šæ—¶å™¨åœæ­¢æ‰§è¡Œ iSpeed = -3; // åŠ¨ç”»è¿”å›ž &#125; if (iLeft &lt; 0) &#123; // åŠ¨ç”»è¿”å›žä¹‹åŽå†æ¬¡æŠ˜è¿”è¿‡åŽ» iSpeed = 3; &#125; &#125;, 30); &#125;&lt;/script&gt;&lt;style type="text/css"&gt; .box &#123; width: 200px; height: 200px; background-color: gold; position: absolute; left: 0; top: 100px; &#125;&lt;/style&gt;&lt;div id="div1" class="box"&gt;&lt;/div&gt;2ã€å®šæ—¶å™¨åˆ¶ä½œæ— ç¼æ»šåŠ¨123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;æ— ç¼æ»šåŠ¨&lt;/title&gt; &lt;style type="text/css"&gt; *&#123; margin:0; padding:0; &#125; .list_con&#123; width:1000px; height:200px; border:1px solid #000; margin:10px auto 0; background-color:#f0f0f0; position:relative; overflow:hidden; &#125; .list_con ul&#123; list-style:none; width:2000px; height:200px; position:absolute; left:0; top:0; &#125; .list_con li&#123; width:180px; height:180px; float:left; margin:10px; &#125; .btns_con&#123; width:1000px; height:30px; margin:50px auto 0; position:relative; &#125; .left,.right&#123; width:30px; height:30px; background-color:gold; position:absolute; left:-40px; top:124px; font-size:30px; line-height:30px; color:#000; font-family: 'Arial'; text-align:center; cursor:pointer; border-radius:15px; opacity:0.5; &#125; .right&#123; left:1010px; top:124px; &#125; &lt;/style&gt; &lt;script type="text/javascript"&gt; window.onload = function()&#123; var oDiv = document.getElementById('slide'); var oBtn01 = document.getElementById('btn01'); var oBtn02 = document.getElementById('btn02'); //é€šè¿‡æ ‡ç­¾èŽ·å–å…ƒç´ ï¼ŒèŽ·å–çš„æ˜¯é€‰æ‹©é›†ï¼ŒåŠ ä¸Šä¸‹æ ‡æ‰èƒ½èŽ·å–åˆ°å…ƒç´  var oUl = oDiv.getElementsByTagName('ul')[0]; var iLeft = 0; var iSpeed = -2; var iNowspeed = 0; //å°†ulé‡Œé¢çš„å†…å®¹å¤åˆ¶ä¸€ä»½ï¼Œæ•´ä¸ªulé‡Œé¢å°±åŒ…å«äº†10ä¸ªli oUl.innerHTML = oUl.innerHTML + oUl.innerHTML; function moving()&#123; iLeft += iSpeed; // å½“ulå‘å·¦æ»šåŠ¨åˆ°ç¬¬5ä¸ªliæ—¶ï¼Œçž¬é—´å°†æ•´ä¸ªulæ‹‰å›žåˆ°åˆå§‹ä½ç½® if(iLeft&lt;-1000) &#123; iLeft=0; &#125; //å½“ulåœ¨èµ·å§‹ä½ç½®å¾€å³æ»šåŠ¨æ—¶å€™ï¼Œçž¬é—´å°†æ•´ä¸ªulæ‹‰å›žåˆ°å¾€å·¦çš„ç¬¬5ä¸ªliçš„ä½ç½® if(iLeft&gt;0) &#123; iLeft = -1000; &#125; oUl.style.left = iLeft + 'px'; &#125; var timer = setInterval(moving,30); oBtn01.onclick = function()&#123; iSpeed = -2; &#125; oBtn02.onclick = function()&#123; iSpeed = 2; &#125; // å½“é¼ æ ‡ç§»å…¥çš„æ—¶å€™ oDiv.onmouseover = function()&#123; iNowspeed = iSpeed; iSpeed = 0; &#125; // å½“é¼ æ ‡ç§»å‡ºçš„æ—¶å€™ oDiv.onmouseout = function()&#123; iSpeed = iNowspeed; &#125; &#125; &lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="btns_con"&gt; &lt;div class="left" id="btn01"&gt;&amp;lt;&lt;/div&gt; &lt;div class="right" id="btn02"&gt;&amp;gt;&lt;/div&gt; &lt;/div&gt; &lt;div class="list_con" id="slide"&gt; &lt;ul&gt; &lt;li&gt;&lt;a href=""&gt;&lt;img src="images/goods001.jpg" alt="å•†å“å›¾ç‰‡"&gt;&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=""&gt;&lt;img src="images/goods002.jpg" alt="å•†å“å›¾ç‰‡"&gt;&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=""&gt;&lt;img src="images/goods003.jpg" alt="å•†å“å›¾ç‰‡"&gt;&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=""&gt;&lt;img src="images/goods004.jpg" alt="å•†å“å›¾ç‰‡"&gt;&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=""&gt;&lt;img src="images/goods005.jpg" alt="å•†å“å›¾ç‰‡"&gt;&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;3ã€å®šæ—¶å™¨åˆ¶ä½œæ—¶é’Ÿ12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364&lt;script type="text/javascript"&gt; window.onload = function()&#123; var oDiv = document.getElementById('div1'); function timego()&#123; var now = new Date(); var year = now.getFullYear(); var month = now.getMonth()+1; var date = now.getDate(); var week = now.getDay(); var hour = now.getHours(); var minute = now.getMinutes(); var second = now.getSeconds(); var str = 'å½“å‰æ—¶é—´æ˜¯ï¼š'+ year + 'å¹´'+month+'æœˆ'+date+'æ—¥ '+toweek(week)+' '+todou(hour)+':'+todou(minute)+':'+todou(second); oDiv.innerHTML = str; &#125; timego(); setInterval(timego,1000); &#125; function toweek(n)&#123; if(n==0) &#123; return 'æ˜ŸæœŸæ—¥'; &#125; else if(n==1) &#123; return 'æ˜ŸæœŸä¸€'; &#125; else if(n==2) &#123; return 'æ˜ŸæœŸäºŒ'; &#125; else if(n==3) &#123; return 'æ˜ŸæœŸä¸‰'; &#125; else if(n==4) &#123; return 'æ˜ŸæœŸå››'; &#125; else if(n==5) &#123; return 'æ˜ŸæœŸäº”'; &#125; else &#123; return 'æ˜ŸæœŸå…­'; &#125; &#125; function todou(n)&#123; if(n&lt;10) &#123; return '0'+n; &#125; else &#123; return n; &#125; &#125;&lt;/script&gt;......&lt;div id="div1"&gt;&lt;/div&gt;4ã€å®šæ—¶å™¨åˆ¶ä½œå€’è®¡æ—¶123456789101112131415161718192021&lt;script type="text/javascript"&gt; window.onload = function()&#123; var oDiv = document.getElementById('div1'); function timeleft()&#123; var now = new Date(); var future = new Date(2016,8,12,24,0,0); var lefts = parseInt((future-now)/1000); var day = parseInt(lefts/86400); var hour = parseInt(lefts%86400/3600); var min = parseInt(lefts%86400%3600/60); var sec = lefts%60; str = 'è·ç¦»2016å¹´9æœˆ12æ—¥æ™š24ç‚¹è¿˜å‰©ä¸‹'+day+'å¤©'+hour+'æ—¶'+min+'åˆ†'+sec+'ç§’'; oDiv.innerHTML = str; &#125; timeleft(); setInterval(timeleft,1000); &#125;&lt;/script&gt;......&lt;div id="div1"&gt;&lt;/div&gt;9.16 å˜é‡ä½œç”¨åŸŸå˜é‡ä½œç”¨åŸŸæŒ‡çš„æ˜¯å˜é‡çš„ä½œç”¨èŒƒå›´ï¼Œjavascriptä¸­çš„å˜é‡åˆ†ä¸ºå…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡ã€‚1ã€å…¨å±€å˜é‡ï¼šåœ¨å‡½æ•°ä¹‹å¤–å®šä¹‰çš„å˜é‡ï¼Œä¸ºæ•´ä¸ªé¡µé¢å…¬ç”¨ï¼Œå‡½æ•°å†…éƒ¨å¤–éƒ¨éƒ½å¯ä»¥è®¿é—®ã€‚2ã€å±€éƒ¨å˜é‡ï¼šåœ¨å‡½æ•°å†…éƒ¨å®šä¹‰çš„å˜é‡ï¼Œåªèƒ½åœ¨å®šä¹‰è¯¥å˜é‡çš„å‡½æ•°å†…éƒ¨è®¿é—®ï¼Œå¤–éƒ¨æ— æ³•è®¿é—®ã€‚1234567891011121314&lt;script type="text/javascript"&gt; //å…¨å±€å˜é‡ var a = 12; function myalert() &#123; //å±€éƒ¨å˜é‡ var b = 23; alert(a); alert(b); &#125; myalert(); //å¼¹å‡º12å’Œ23 alert(a); //å¼¹å‡º12 alert(b); //å‡ºé”™&lt;/script&gt;9.17 å°é—­å‡½æ•°å°é—­å‡½æ•°æ˜¯javascriptä¸­åŒ¿åå‡½æ•°çš„å¦å¤–ä¸€ç§å†™æ³•ï¼Œåˆ›å»ºä¸€ä¸ªä¸€å¼€å§‹å°±æ‰§è¡Œè€Œä¸ç”¨å‘½åçš„å‡½æ•°ã€‚ä¸€èˆ¬å®šä¹‰çš„å‡½æ•°å’Œæ‰§è¡Œå‡½æ•°ï¼š12345function myalert()&#123; alert('hello!');&#125;;myalert();å°é—­å‡½æ•°ï¼š123(function myalert()&#123; alert('hello!');&#125;)();è¿˜å¯ä»¥åœ¨å‡½æ•°å®šä¹‰å‰åŠ ä¸Šâ€œ~â€å’Œâ€œ!â€ç­‰ç¬¦å·æ¥å®šä¹‰åŒ¿åå‡½æ•°123!function myalert()&#123; alert('hello!');&#125;()9.17.1 å°é—­å‡½æ•°çš„å¥½å¤„å°é—­å‡½æ•°å¯ä»¥åˆ›é€ ä¸€ä¸ªç‹¬ç«‹çš„ç©ºé—´ï¼Œåœ¨å°é—­å‡½æ•°å†…å®šä¹‰çš„å˜é‡å’Œå‡½æ•°ä¸ä¼šå½±å“å¤–éƒ¨åŒåçš„å‡½æ•°å’Œå˜é‡ï¼Œå¯ä»¥é¿å…å‘½åå†²çªï¼Œåœ¨é¡µé¢ä¸Šå¼•å…¥å¤šä¸ªjsæ–‡ä»¶æ—¶ï¼Œç”¨è¿™ç§æ–¹å¼æ·»åŠ jsæ–‡ä»¶æ¯”è¾ƒå®‰å…¨ï¼Œæ¯”å¦‚ï¼š1234567891011121314var iNum01 = 12;function myalert()&#123; alert('hello!');&#125;(function()&#123; var iNum01 = 24; function myalert()&#123; alert('hello!world'); &#125; alert(iNum01); myalert()&#125;)()alert(iNum01);myalert();9.18 å¸¸ç”¨å†…ç½®å¯¹è±¡1ã€document123document.getElementById //é€šè¿‡idèŽ·å–å…ƒç´ document.getElementsByTagName //é€šè¿‡æ ‡ç­¾åèŽ·å–å…ƒç´ document.referrer //èŽ·å–ä¸Šä¸€ä¸ªè·³è½¬é¡µé¢çš„åœ°å€(éœ€è¦æœåŠ¡å™¨çŽ¯å¢ƒ)2ã€location123window.location.href //èŽ·å–æˆ–è€…é‡å®šurlåœ°å€window.location.search //èŽ·å–åœ°å€å‚æ•°éƒ¨åˆ†window.location.hash //èŽ·å–é¡µé¢é”šç‚¹æˆ–è€…å«å“ˆå¸Œå€¼1234567891011121314&lt;script type="text/javascript"&gt; window.onload = function () &#123; // å­˜å‚¨ä¸Šä¸€ä¸ªé¡µé¢çš„åœ°å€ var sUrl = document.referrer; var oBtn = document.getElementById("btn01"); oBtn.onclick = function () &#123; window.location.href = "http://www.baidu.com"; &#125;; alert(window.location.search); &#125;&lt;/script&gt;&lt;input type="button" id="btn01" value="è·³è½¬" name=""&gt;è¯¾å ‚ç»ƒä¹ é€šè¿‡åœ°å€æ çš„å‚æ•°æ”¹å˜é¡µé¢çŠ¶æ€ï¼Œå¦‚ä¸‹çš„ç¤ºä¾‹æ˜¯é€šè¿‡åœ°å€æ ä¸­çš„å‚æ•°æ”¹å˜é¡µé¢èƒŒæ™¯è‰²1234567891011121314151617181920212223242526&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Test&lt;/title&gt; &lt;script type="text/javascript"&gt; window.onload = function () &#123; var oBody01 = document.getElementById("body01"); var sData = window.location.search; if (sData != '') &#123; var iNum = sData.split("=")[1]; // console.log(iNum); if (iNum == 1) &#123; oBody01.style.backgroundColor = "red"; &#125; else &#123; oBody01.style.backgroundColor = "pink"; &#125;; &#125;; &#125; &lt;/script&gt;&lt;/head&gt;&lt;body id="body01"&gt;&lt;input type="button" id="btn01" value="è·³è½¬" name=""&gt;&lt;/body&gt;&lt;/html&gt;3ã€Math123Math.random èŽ·å–0-1çš„éšæœºæ•°Math.floor å‘ä¸‹å–æ•´Math.ceil å‘ä¸Šå–æ•´123456789101112131415&lt;script type="text/javascript"&gt; // var iPi = Math.PI; // alert(iPi); var sList = []; for (var i = 0; i &lt; 20; i++) &#123; // Math.random è¿”å›ž0åˆ°1ä¹‹é—´çš„éšæœºæ•°,ä¸åŒ…æ‹¬1 var iNum = Math.random(); sList.push(iNum); &#125; console.log(sList); alert(Math.floor(5.6)); // å‘ä¸‹å–æ•´ï¼Œç»“æžœæ˜¯5 alert(Math.ceil(5.2)); // å‘ä¸Šå–æ•´ï¼Œç»“æžœæ˜¯6&lt;/script&gt;è¯¾å ‚ç»ƒä¹ åˆ¶ä½œä¸€å®šèŒƒå›´å†…çš„éšæœºæ•´æ•°12345// èŽ·å–10åˆ°20ä¹‹é—´çš„éšæœºæ•´æ•°var iN01 = 10;var iN02 = 20;var result = Math.floor((iN02 - iN01+1)*Math.random()) + iN01;alert(result)10.JQuery10.1 jqueryä»‹ç»jQueryæ˜¯ç›®å‰ä½¿ç”¨æœ€å¹¿æ³›çš„javascriptå‡½æ•°åº“ã€‚æ®ç»Ÿè®¡ï¼Œå…¨ä¸–ç•ŒæŽ’åå‰100ä¸‡çš„ç½‘ç«™ï¼Œæœ‰46%ä½¿ç”¨jQueryï¼Œè¿œè¿œè¶…è¿‡å…¶ä»–åº“ã€‚å¾®è½¯å…¬å¸ç”šè‡³æŠŠjQueryä½œä¸ºä»–ä»¬çš„å®˜æ–¹åº“ã€‚jQueryçš„ç‰ˆæœ¬åˆ†ä¸º1.xç³»åˆ—å’Œ2.xã€3.xç³»åˆ—ï¼Œ1.xç³»åˆ—å…¼å®¹ä½Žç‰ˆæœ¬çš„æµè§ˆå™¨ï¼Œ2.xã€3.xç³»åˆ—æ”¾å¼ƒæ”¯æŒä½Žç‰ˆæœ¬æµè§ˆå™¨ï¼Œç›®å‰ä½¿ç”¨æœ€å¤šçš„æ˜¯1.xç³»åˆ—çš„ã€‚jqueryæ˜¯ä¸€ä¸ªå‡½æ•°åº“ï¼Œä¸€ä¸ªjsæ–‡ä»¶ï¼Œé¡µé¢ç”¨scriptæ ‡ç­¾å¼•å…¥è¿™ä¸ªjsæ–‡ä»¶å°±å¯ä»¥ä½¿ç”¨ã€‚1&lt;script type=&quot;text/javascript&quot; src=&quot;js/jquery-1.12.2.js&quot;&gt;&lt;/script&gt;jqueryçš„å£å·å’Œæ„¿æœ› Write Less, Do Moreï¼ˆå†™å¾—å°‘ï¼Œåšå¾—å¤šï¼‰1ã€http://jquery.com/ å®˜æ–¹ç½‘ç«™2ã€https://code.jquery.com/ ç‰ˆæœ¬ä¸‹è½½10.2 jqueryåŠ è½½å°†èŽ·å–å…ƒç´ çš„è¯­å¥å†™åˆ°é¡µé¢å¤´éƒ¨ï¼Œä¼šå› ä¸ºå…ƒç´ è¿˜æ²¡æœ‰åŠ è½½è€Œå‡ºé”™ï¼Œjqueryæä¾›äº†readyæ–¹æ³•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®ƒçš„é€Ÿåº¦æ¯”åŽŸç”Ÿçš„ window.onload æ›´å¿«ã€‚123456789&lt;script type="text/javascript"&gt;$(document).ready(function()&#123; ......&#125;);&lt;/script&gt;å¯ä»¥ç®€å†™ä¸ºï¼š123456789&lt;script type="text/javascript"&gt;$(function()&#123; ......&#125;);&lt;/script&gt;1234567891011121314151617181920212223242526272829303132333435&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Title&lt;/title&gt; &lt;!--ä¸èƒ½ç›´æŽ¥åœ¨jqueryçš„å¼•å…¥æ ‡ç­¾é‡Œå†™jsä»£ç ï¼Œéœ€è¦å¦å†™ä¸€ä¸ªscriptæ ‡ç­¾ï¼Œåœ¨è¿™ä¸ªé‡Œé¢é‚£äº›jsä»£ç --&gt; &lt;script type="text/javascript" src="js/jquery-3.4.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; // åŽŸç”Ÿjså†™æ³•,onloadæ˜¯æ•´ä¸ªé¡µé¢åŠ è½½å®ŒåŽï¼Œå†æ¸²æŸ“å®Œä¹‹åŽæ‰è¿è¡Œ window.onload = function () &#123; var oDiv = document.getElementById("div1"); alert('è¿™æ˜¯åŽŸç”Ÿjså¼¹å‡ºçš„div' + oDiv); &#125;; // å®Œæ•´å†™æ³•ï¼Œreadyæ˜¯æ ‡ç­¾åŠ è½½å®Œå°±æ‰§è¡Œï¼Œé€Ÿåº¦æ¯”åŽŸç”Ÿjsçš„å¿« $(document).ready(function () &#123; var $div = $("#div1"); alert('è¿™æ˜¯jqueryå¼¹å‡ºçš„div-1' + $div); &#125;); // ç®€å•å†™æ³• $(function () &#123; var $div = $("#div1"); alert('è¿™æ˜¯jqueryå¼¹å‡ºçš„div-2' + $div); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div id="div1"&gt; è¿™æ˜¯ä¸€ä¸ªdivå…ƒç´ &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;10.3 jqueryé€‰æ‹©å™¨10.3.1 jqueryç”¨æ³•æ€æƒ³ä¸€é€‰æ‹©æŸä¸ªç½‘é¡µå…ƒç´ ï¼Œç„¶åŽå¯¹å®ƒè¿›è¡ŒæŸç§æ“ä½œ10.3.2 jqueryé€‰æ‹©å™¨jqueryé€‰æ‹©å™¨å¯ä»¥å¿«é€Ÿåœ°é€‰æ‹©å…ƒç´ ï¼Œé€‰æ‹©è§„åˆ™å’Œcssæ ·å¼ç›¸åŒï¼Œä½¿ç”¨lengthå±žæ€§åˆ¤æ–­æ˜¯å¦é€‰æ‹©æˆåŠŸã€‚12345$('#myId') //é€‰æ‹©idä¸ºmyIdçš„ç½‘é¡µå…ƒç´ $('.myClass') // é€‰æ‹©classä¸ºmyClassçš„å…ƒç´ $('li') //é€‰æ‹©æ‰€æœ‰çš„liå…ƒç´ $('#ul1 li span') //é€‰æ‹©idä¸ºul1å…ƒç´ ä¸‹çš„æ‰€æœ‰liä¸‹çš„spanå…ƒç´ $('input[name=first]') // é€‰æ‹©nameå±žæ€§ç­‰äºŽfirstçš„inputå…ƒç´ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Title&lt;/title&gt; &lt;!--ä¸èƒ½ç›´æŽ¥åœ¨jqueryçš„å¼•å…¥æ ‡ç­¾é‡Œå†™jsä»£ç ï¼Œéœ€è¦å¦å†™ä¸€ä¸ªscriptæ ‡ç­¾ï¼Œåœ¨è¿™ä¸ªé‡Œé¢é‚£äº›jsä»£ç --&gt; &lt;script type="text/javascript" src="js/jquery-3.4.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; var $div = $("#div1"); $div.css(&#123;"color":"red"&#125;); var $div2 = $(".box"); $div2.css(&#123;"color":"green"&#125;); var $li = $(".list li"); // å¸¦'-'çš„æ ·å¼å±žæ€§å¯ä»¥å†™æˆé©¼å³°å¼ï¼Œä¹Ÿå¯ä»¥å†™æˆåŽŸå§‹çš„ï¼Œå®¹é”™ // $li.css(&#123;"backgroundColor":"pink"&#125;); $li.css(&#123;"background-color":"pink"&#125;); &#125;); &lt;/script&gt; &lt;!--&lt;style type="text/css"&gt;--&gt; &lt;!--#div1&#123;--&gt; &lt;!--color: gold;--&gt; &lt;!--&#125;--&gt; &lt;!--.box&#123;--&gt; &lt;!--color: green;--&gt; &lt;!--&#125;--&gt; &lt;!--.list li&#123;--&gt; &lt;!--background-color: pink;--&gt; &lt;!--&#125;--&gt; &lt;!--&lt;/style&gt;--&gt;&lt;/head&gt;&lt;body&gt;&lt;div id="div1"&gt;è¿™æ˜¯ä¸€ä¸ªdivå…ƒç´ &lt;/div&gt;&lt;div class="box"&gt;è¿™æ˜¯ç¬¬äºŒä¸ªdivå…ƒç´ &lt;/div&gt;&lt;div class="box"&gt;è¿™æ˜¯ç¬¬ä¸‰ä¸ªdivå…ƒç´ &lt;/div&gt;&lt;!--ul.list&gt;li&#123;$&#125;*8--&gt;&lt;ul class="list"&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;3&lt;/li&gt; &lt;li&gt;4&lt;/li&gt; &lt;li&gt;5&lt;/li&gt; &lt;li&gt;6&lt;/li&gt; &lt;li&gt;7&lt;/li&gt; &lt;li&gt;8&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/html&gt;10.3.3å¯¹é€‰æ‹©é›†è¿›è¡Œè¿‡æ»¤1234$('div').has('p'); // é€‰æ‹©åŒ…å«på…ƒç´ çš„divå…ƒç´ $('div').not('.myClass'); //é€‰æ‹©classä¸ç­‰äºŽmyClassçš„divå…ƒç´ $('div').filter('.myClass'); //é€‰æ‹©classç­‰äºŽmyClassçš„divå…ƒç´ $('div').eq(5); //é€‰æ‹©ç¬¬6ä¸ªdivå…ƒç´ 12345678910111213141516171819202122232425262728293031&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Title&lt;/title&gt; &lt;!--ä¸èƒ½ç›´æŽ¥åœ¨jqueryçš„å¼•å…¥æ ‡ç­¾é‡Œå†™jsä»£ç ï¼Œéœ€è¦å¦å†™ä¸€ä¸ªscriptæ ‡ç­¾ï¼Œåœ¨è¿™ä¸ªé‡Œé¢é‚£äº›jsä»£ç --&gt; &lt;script type="text/javascript" src="js/jquery-3.4.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; // var $div = $("div"); // $div.css(&#123;"background-color":"red"&#125;); $("div").css(&#123;"background-color":"gold"&#125;); $("div").has('p').css(&#123;"background-color":"red"&#125;); $("div").eq(4).css(&#123;"text-indent":"30px"&#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div&gt;1&lt;/div&gt;&lt;div&gt;&lt;p&gt;2&lt;/p&gt;&lt;/div&gt;&lt;div&gt;3&lt;/div&gt;&lt;div&gt;4&lt;/div&gt;&lt;div&gt;5&lt;/div&gt;&lt;div&gt;6&lt;/div&gt;&lt;div&gt;7&lt;/div&gt;&lt;div&gt;8&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;10.3.4 é€‰æ‹©é›†è½¬ç§»12345678$('div').prev(); //é€‰æ‹©divå…ƒç´ å‰é¢ç´§æŒ¨çš„åŒè¾ˆå…ƒç´ $('div').prevAll(); //é€‰æ‹©divå…ƒç´ ä¹‹å‰æ‰€æœ‰çš„åŒè¾ˆå…ƒç´ $('div').next(); //é€‰æ‹©divå…ƒç´ åŽé¢ç´§æŒ¨çš„åŒè¾ˆå…ƒç´ $('div').nextAll(); //é€‰æ‹©divå…ƒç´ åŽé¢æ‰€æœ‰çš„åŒè¾ˆå…ƒç´ $('div').parent(); //é€‰æ‹©divçš„çˆ¶å…ƒç´ $('div').children(); //é€‰æ‹©divçš„æ‰€æœ‰å­å…ƒç´ $('div').siblings(); //é€‰æ‹©divçš„åŒçº§å…ƒç´ $('div').find('.myClass'); //é€‰æ‹©divå†…çš„classç­‰äºŽmyClassçš„å…ƒç´ 12345678910111213141516171819202122232425262728&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Title&lt;/title&gt; &lt;!--ä¸èƒ½ç›´æŽ¥åœ¨jqueryçš„å¼•å…¥æ ‡ç­¾é‡Œå†™jsä»£ç ï¼Œéœ€è¦å¦å†™ä¸€ä¸ªscriptæ ‡ç­¾ï¼Œåœ¨è¿™ä¸ªé‡Œé¢é‚£äº›jsä»£ç --&gt; &lt;script type="text/javascript" src="js/jquery-3.4.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; $("div").eq(4).prev().css(&#123;"color":"green"&#125;); $("div").find(".tip").css(&#123;"color":"red"&#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div&gt;1&lt;/div&gt;&lt;div&gt;&lt;p&gt;2&lt;/p&gt;&lt;/div&gt;&lt;div&gt;7&lt;/div&gt;&lt;div&gt; &lt;span&gt;8&lt;/span&gt; &lt;span class="tip"&gt;9&lt;/span&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;10.3.5 åˆ¤æ–­æ˜¯å¦é€‰æ‹©åˆ°äº†å…ƒç´ jqueryæœ‰å®¹é”™æœºåˆ¶ï¼Œå³ä½¿æ²¡æœ‰æ‰¾åˆ°å…ƒç´ ï¼Œä¹Ÿä¸ä¼šå‡ºé”™ï¼Œå¯ä»¥ç”¨lengthå±žæ€§æ¥åˆ¤æ–­æ˜¯å¦æ‰¾åˆ°äº†å…ƒç´ ,lengthç­‰äºŽ0ï¼Œå°±æ˜¯æ²¡é€‰æ‹©åˆ°å…ƒç´ ï¼Œlengthå¤§äºŽ0ï¼Œå°±æ˜¯é€‰æ‹©åˆ°äº†å…ƒç´ ã€‚123456789101112131415161718192021222324&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Title&lt;/title&gt; &lt;!--ä¸èƒ½ç›´æŽ¥åœ¨jqueryçš„å¼•å…¥æ ‡ç­¾é‡Œå†™jsä»£ç ï¼Œéœ€è¦å¦å†™ä¸€ä¸ªscriptæ ‡ç­¾ï¼Œåœ¨è¿™ä¸ªé‡Œé¢é‚£äº›jsä»£ç --&gt; &lt;script type="text/javascript" src="js/jquery-3.4.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; var $div1 = $('#div1'); // æ²¡æœ‰é€‰ä¸­å…ƒç´ ï¼Œä¹Ÿä¸ä¼šæŠ¥é”™ï¼Œç¨‹åºæ­£å¸¸è¿è¡Œ var $div2 = $('#div2'); alert($div1.length); // å¼¹å‡º1 alert($div2.length); // å¼¹å‡º0 &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div id="div1"&gt;divå…ƒç´ &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;10.4 jqueryæ ·å¼æ“ä½œ10.4.1 jqueryç”¨æ³•æ€æƒ³äºŒåŒä¸€ä¸ªå‡½æ•°å®Œæˆå–å€¼å’Œèµ‹å€¼10.4.2 æ“ä½œè¡Œé—´æ ·å¼12345678// èŽ·å–divçš„æ ·å¼$("div").css("width");$("div").css("color");//è®¾ç½®divçš„æ ·å¼$("div").css("width","30px");$("div").css("height","30px");$("div").css(&#123;fontSize:"30px",color:"red"&#125;);12345678910111213141516171819202122232425262728293031323334&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Title&lt;/title&gt; &lt;!--ä¸èƒ½ç›´æŽ¥åœ¨jqueryçš„å¼•å…¥æ ‡ç­¾é‡Œå†™jsä»£ç ï¼Œéœ€è¦å¦å†™ä¸€ä¸ªscriptæ ‡ç­¾ï¼Œåœ¨è¿™ä¸ªé‡Œé¢é‚£äº›jsä»£ç --&gt; &lt;script type="text/javascript" src="js/jquery-3.4.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; var $div1 = $('#div1'); $div1.css("width", "30px"); $div1.css("height", "30px"); $div1.css(&#123;fontSize: "30px", color: "red"&#125;); alert($div1.css('width')); alert($div1.css('color')); // åŽŸç”Ÿjsæ— æ³•è¯»å–è¡Œé—´æ²¡æœ‰å®šä¹‰çš„csså±žæ€§å€¼,ä½†æ˜¯å¯ä»¥è¯»å–è¡Œé—´å·²å®šä¹‰çš„csså±žæ€§å€¼ var oDiv = document.getElementById("box"); alert(oDiv.style.height); // ç©º alert(oDiv.style.fontSize); // 20px &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div id="div1"&gt;divå…ƒç´ &lt;/div&gt;&lt;div id="box" style="font-size: 20px;"&gt;divå…ƒç´ &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;ç‰¹åˆ«æ³¨æ„é€‰æ‹©å™¨èŽ·å–çš„å¤šä¸ªå…ƒç´ ï¼ŒèŽ·å–ä¿¡æ¯èŽ·å–çš„æ˜¯ç¬¬ä¸€ä¸ªï¼Œæ¯”å¦‚ï¼š$(â€œdivâ€).css(â€œwidthâ€)ï¼ŒèŽ·å–çš„æ˜¯ç¬¬ä¸€ä¸ªdivçš„widthã€‚123456789101112131415161718192021222324&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Title&lt;/title&gt; &lt;!--ä¸èƒ½ç›´æŽ¥åœ¨jqueryçš„å¼•å…¥æ ‡ç­¾é‡Œå†™jsä»£ç ï¼Œéœ€è¦å¦å†™ä¸€ä¸ªscriptæ ‡ç­¾ï¼Œåœ¨è¿™ä¸ªé‡Œé¢é‚£äº›jsä»£ç --&gt; &lt;script type="text/javascript" src="js/jquery-3.4.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; var $div = $('div'); alert($div.css("color")); // rgb(0,128,0) =&gt; green &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div style="color: green"&gt;1.divå…ƒç´ &lt;/div&gt;&lt;div style="color: red"&gt;2.divå…ƒç´ &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;10.4.3 æ“ä½œæ ·å¼ç±»å1234$("#div1").addClass("divClass2") //ä¸ºidä¸ºdiv1çš„å¯¹è±¡è¿½åŠ æ ·å¼divClass2,ä¸æ˜¯æ›¿æ¢æˆdivClass2$("#div1").removeClass("divClass") //ç§»é™¤idä¸ºdiv1çš„å¯¹è±¡çš„classåä¸ºdivClassçš„æ ·å¼$("#div1").removeClass("divClass divClass2") //ç§»é™¤å¤šä¸ªæ ·å¼$("#div1").toggleClass("anotherClass") //é‡å¤åˆ‡æ¢anotherClassæ ·å¼ï¼Œæ¯”å¦‚ç‚¹å‡»å¢žåŠ ï¼Œå†ç‚¹å‡»ç§»é™¤ç­‰æ“ä½œ12345678910111213141516171819202122232425262728293031323334353637&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Title&lt;/title&gt; &lt;!--ä¸èƒ½ç›´æŽ¥åœ¨jqueryçš„å¼•å…¥æ ‡ç­¾é‡Œå†™jsä»£ç ï¼Œéœ€è¦å¦å†™ä¸€ä¸ªscriptæ ‡ç­¾ï¼Œåœ¨è¿™ä¸ªé‡Œé¢é‚£äº›jsä»£ç --&gt; &lt;script type="text/javascript" src="js/jquery-3.4.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; var $div = $('.box'); $div.addClass("big"); $div.removeClass("box"); $div.toggleClass("box"); &#125;); &lt;/script&gt; &lt;style type="text/css"&gt; .box&#123; width: 100px; height: 100px; background-color: gold; &#125; .big&#123; font-size: 30px; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="box"&gt;divå…ƒç´ &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;10.5 ç»‘å®šclickäº‹ä»¶ç»™å…ƒç´ ç»‘å®šclickäº‹ä»¶ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹æ–¹æ³•ï¼š123456$('#btn1').click(function()&#123; // å†…éƒ¨çš„thisæŒ‡çš„æ˜¯åŽŸç”Ÿå¯¹è±¡ // ä½¿ç”¨jqueryå¯¹è±¡ç”¨ $(this)&#125;)1234567891011121314151617181920212223242526272829303132333435363738394041424344&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Title&lt;/title&gt; &lt;!--ä¸èƒ½ç›´æŽ¥åœ¨jqueryçš„å¼•å…¥æ ‡ç­¾é‡Œå†™jsä»£ç ï¼Œéœ€è¦å¦å†™ä¸€ä¸ªscriptæ ‡ç­¾ï¼Œåœ¨è¿™ä¸ªé‡Œé¢é‚£äº›jsä»£ç --&gt; &lt;script type="text/javascript" src="js/jquery-3.4.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; // ç»‘å®šclickäº‹ä»¶ $("#btn").click(function () &#123; // if ($(".box").hasClass("col01")) &#123; // $(".box").removeClass("col01"); // &#125; else &#123; // $(".box").addClass("col01"); // &#125; // ç®€åŒ–å†™æ³• $(".box").toggleClass("col01"); &#125;); &#125;); &lt;/script&gt; &lt;style type="text/css"&gt; .box &#123; width: 100px; height: 100px; background-color: gold; &#125; .col01 &#123; background-color: green; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;input type="button" name="" value="åˆ‡æ¢æ ·å¼" id="btn"&gt;&lt;div class="box"&gt;divå…ƒç´ &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;10.5.1 èŽ·å–å…ƒç´ çš„ç´¢å¼•å€¼æœ‰æ—¶å€™éœ€è¦èŽ·å¾—åŒ¹é…å…ƒç´ ç›¸å¯¹äºŽå…¶åŒèƒžå…ƒç´ çš„ç´¢å¼•ä½ç½®ï¼Œæ­¤æ—¶å¯ä»¥ç”¨index()æ–¹æ³•èŽ·å–12345678910var $li = $('.list li').eq(1);alert($li.index()); // å¼¹å‡º1......&lt;ul class="list"&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;4&lt;/li&gt; &lt;li&gt;5&lt;/li&gt; &lt;li&gt;6&lt;/li&gt;&lt;/ul&gt;è¯¾å ‚ç»ƒä¹ é€‰é¡¹å¡1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Title&lt;/title&gt; &lt;!--ä¸èƒ½ç›´æŽ¥åœ¨jqueryçš„å¼•å…¥æ ‡ç­¾é‡Œå†™jsä»£ç ï¼Œéœ€è¦å¦å†™ä¸€ä¸ªscriptæ ‡ç­¾ï¼Œåœ¨è¿™ä¸ªé‡Œé¢é‚£äº›jsä»£ç --&gt; &lt;script type="text/javascript" src="js/jquery-3.4.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; var $btn = $(".btns input"); var $div = $(".cons div"); $btn.click(function () &#123; // thisæŒ‡çš„æ˜¯åŽŸç”Ÿthis,å®ƒè¡¨ç¤ºå½“å‰ç‚¹å‡»çš„å¯¹è±¡ // å½“å‰ç‚¹å‡»çš„æŒ‰é’®åŠ ä¸Šcurrentæ ·å¼åŽï¼Œé™¤äº†å½“å‰ï¼Œå…¶ä»–çš„æŒ‰é’®åŽ»æŽ‰currentæ ·å¼ $(this).addClass("current").siblings().removeClass("current"); // alert($(this).index()); // æŸ¥çœ‹å½“å‰ç‚¹å‡»å¯¹è±¡çš„ç´¢å¼•å€¼ // å½“å‰ç‚¹å‡»çš„æŒ‰é’®å¯¹åº”ç´¢å¼•å€¼çš„divåŠ ä¸Šactiveæ ·å¼ï¼Œå…¶ä»–çš„åŽ»æŽ‰activeæ ·å¼ $div.eq($(this).index()).addClass("active").siblings().removeClass("active"); &#125;) &#125;); &lt;/script&gt; &lt;style type="text/css"&gt; .btns input &#123; width: 100px; height: 40px; background-color: #dddddd; &#125; .btns .current &#123; background-color: gold; &#125; .cons div &#123; width: 500px; height: 300px; background-color: gold; display: none; text-align: center; line-height: 300px; font-size: 30px; &#125; .cons .active &#123; display: block; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="btns"&gt; &lt;input type="button" name="" value="01" class="current"&gt; &lt;input type="button" name="" value="02"&gt; &lt;input type="button" name="" value="03"&gt;&lt;/div&gt;&lt;div class="cons"&gt; &lt;div class="active"&gt;é€‰é¡¹å¡ä¸€çš„å†…å®¹&lt;/div&gt; &lt;div&gt;é€‰é¡¹å¡äºŒçš„å†…å®¹&lt;/div&gt; &lt;div&gt;é€‰é¡¹å¡ä¸‰çš„å†…å®¹&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;10.6 jqueryç‰¹æ®Šæ•ˆæžœ123456789101112131415161718fadeIn() æ·¡å…¥ $btn.click(function()&#123; $('#div1').fadeIn(1000,'swing',function()&#123; alert('done!'); &#125;); &#125;);fadeOut() æ·¡å‡ºfadeToggle() åˆ‡æ¢æ·¡å…¥æ·¡å‡ºhide() éšè—å…ƒç´ show() æ˜¾ç¤ºå…ƒç´ toggle() åˆ‡æ¢å…ƒç´ çš„å¯è§çŠ¶æ€slideDown() å‘ä¸‹å±•å¼€slideUp() å‘ä¸Šå·èµ·slideToggle() ä¾æ¬¡å±•å¼€æˆ–å·èµ·æŸä¸ªå…ƒç´ 10.7 jqueryé“¾å¼è°ƒç”¨jqueryå¯¹è±¡çš„æ–¹æ³•ä¼šåœ¨æ‰§è¡Œå®ŒåŽè¿”å›žè¿™ä¸ªjqueryå¯¹è±¡ï¼Œæ‰€æœ‰jqueryå¯¹è±¡çš„æ–¹æ³•å¯ä»¥è¿žèµ·æ¥å†™ï¼š1234567$('#div1') // idä¸ºdiv1çš„å…ƒç´ .children('ul') //è¯¥å…ƒç´ ä¸‹é¢çš„ulå­å…ƒç´ .slideDown('fast') //é«˜åº¦ä»Žé›¶å˜åˆ°å®žé™…é«˜åº¦æ¥æ˜¾ç¤ºulå…ƒç´ .parent() //è·³åˆ°ulçš„çˆ¶å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯idä¸ºdiv1çš„å…ƒç´ .siblings() //è·³åˆ°div1å…ƒç´ å¹³çº§çš„æ‰€æœ‰å…„å¼Ÿå…ƒç´ .children('ul') //è¿™äº›å…„å¼Ÿå…ƒç´ ä¸­çš„ulå­å…ƒç´ .slideUp('fast'); //é«˜åº¦å®žé™…é«˜åº¦å˜æ¢åˆ°é›¶æ¥éšè—ulå…ƒç´ è¯¾å ‚ç»ƒä¹  - å±‚çº§èœå•123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Title&lt;/title&gt; &lt;!--ä¸èƒ½ç›´æŽ¥åœ¨jqueryçš„å¼•å…¥æ ‡ç­¾é‡Œå†™jsä»£ç ï¼Œéœ€è¦å¦å†™ä¸€ä¸ªscriptæ ‡ç­¾ï¼Œåœ¨è¿™ä¸ªé‡Œé¢é‚£äº›jsä»£ç --&gt; &lt;script type="text/javascript" src="js/jquery-3.4.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; $('.level1').click(function () &#123; //å½“å‰ç‚¹å‡»çš„å…ƒç´ ç´§æŒ¨çš„åŒè¾ˆå…ƒç´ å‘ä¸‹å±•å¼€ï¼Œå†è·³åˆ°æ­¤å…ƒç´ çš„çˆ¶çº§(li),å†è·³åˆ°æ­¤çˆ¶çº§çš„å…¶ä»–çš„åŒè¾ˆå…ƒç´ (li),é€‰æ‹©å…¶ä»–åŒè¾ˆå…ƒç´ (li)çš„å­å…ƒç´ ulï¼Œç„¶åŽå°†å®ƒå‘ä¸Šæ”¶èµ·ã€‚ // é€šè¿‡stop() å¯ä»¥ä¿®æ­£åå¤ç‚¹å‡»å¯¼è‡´çš„æŒç»­åŠ¨ç”»çš„é—®é¢˜ $(this).next().stop().slideToggle().parent().siblings().children('ul').slideUp(); &#125;) &#125;) &lt;/script&gt; &lt;style type="text/css"&gt; body &#123; font-family: 'Microsoft Yahei'; &#125; body, ul &#123; margin: 0px; padding: 0px; &#125; ul &#123; list-style: none; &#125; .menu &#123; width: 200px; margin: 20px auto 0; &#125; .menu .level1, .menu li ul a &#123; display: block; width: 200px; height: 30px; line-height: 30px; text-decoration: none; background-color: #3366cc; color: #fff; font-size: 16px; text-indent: 10px; &#125; .menu .level1 &#123; border-bottom: 1px solid #afc6f6; &#125; .menu li ul a &#123; font-size: 14px; text-indent: 20px; background-color: #7aa1ef; &#125; .menu li ul li &#123; border-bottom: 1px solid #afc6f6; &#125; .menu li ul &#123; display: none; &#125; .menu li ul.current &#123; display: block; &#125; .menu li ul li a:hover &#123; background-color: #f6b544; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;ul class="menu"&gt; &lt;li&gt; &lt;a href="#" class="level1"&gt;æ°´æžœ&lt;/a&gt; &lt;ul class="current"&gt; &lt;li&gt;&lt;a href="#"&gt;è‹¹æžœ&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;æ¢¨å­&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;è‘¡è„&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;ç«é¾™æžœ&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt; &lt;a href="#" class="level1"&gt;æµ·é²œ&lt;/a&gt; &lt;ul&gt; &lt;li&gt;&lt;a href="#"&gt;è›å­&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;æ‰‡è´&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;é¾™è™¾&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;è±¡æ‹”èšŒ&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt; &lt;a href="#" class="level1"&gt;è‚‰ç±»&lt;/a&gt; &lt;ul&gt; &lt;li&gt;&lt;a href="#"&gt;å†…è’™å¤ç¾Šè‚‰&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;è¿›å£ç‰›è‚‰&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;é‡ŽçŒªè‚‰&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt; &lt;a href="#" class="level1"&gt;è”¬èœ&lt;/a&gt; &lt;ul&gt; &lt;li&gt;&lt;a href="#"&gt;å¨ƒå¨ƒèœ&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;è¥¿çº¢æŸ¿&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;è¥¿èŠ¹&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;èƒ¡èåœ&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt; &lt;a href="#" class="level1"&gt;é€Ÿå†»&lt;/a&gt; &lt;ul&gt; &lt;li&gt;&lt;a href="#"&gt;å†°æ·‡æ·‹&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;æ¹¾ä»”ç å¤´&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;æµ·å‚&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;ç‰›è‚‰ä¸¸&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/html&gt;10.8 jqueryåŠ¨ç”»é€šè¿‡animateæ–¹æ³•å¯ä»¥è®¾ç½®å…ƒç´ æŸå±žæ€§å€¼ä¸Šçš„åŠ¨ç”»ï¼Œå¯ä»¥è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ªå±žæ€§å€¼ï¼ŒåŠ¨ç”»æ‰§è¡Œå®ŒæˆåŽä¼šæ‰§è¡Œä¸€ä¸ªå‡½æ•°ã€‚123456$('#div1').animate(&#123; width:300, height:300&#125;,1000,'swing',function()&#123; alert('done!');&#125;);å‚æ•°å¯ä»¥å†™æˆæ•°å­—è¡¨è¾¾å¼ï¼š123456$('#div1').animate(&#123; width:'+=100', height:300&#125;,1000,'swing',function()&#123; alert('done!');&#125;);10.9 å°ºå¯¸ç›¸å…³ã€æ»šåŠ¨äº‹ä»¶1ã€èŽ·å–å’Œè®¾ç½®å…ƒç´ çš„å°ºå¯¸1234width()ã€height() èŽ·å–å…ƒç´ widthå’Œheight innerWidth()ã€innerHeight() åŒ…æ‹¬paddingçš„widthå’Œheight outerWidth()ã€outerHeight() åŒ…æ‹¬paddingå’Œborderçš„widthå’Œheight outerWidth(true)ã€outerHeight(true) åŒ…æ‹¬paddingå’Œborderä»¥åŠmarginçš„widthå’Œheight2ã€èŽ·å–å…ƒç´ ç›¸å¯¹é¡µé¢çš„ç»å¯¹ä½ç½®1offset()3ã€èŽ·å–æµè§ˆå™¨å¯è§†åŒºå®½åº¦é«˜åº¦12$(window).width();$(window).height();4ã€èŽ·å–é¡µé¢æ–‡æ¡£çš„å®½åº¦é«˜åº¦12$(document).width();$(document).height();5ã€èŽ·å–é¡µé¢æ»šåŠ¨è·ç¦»12$(document).scrollTop(); $(document).scrollLeft();6ã€é¡µé¢æ»šåŠ¨äº‹ä»¶123$(window).scroll(function()&#123; ...... &#125;)10.10 jqueryå±žæ€§æ“ä½œ1ã€html() å–å‡ºæˆ–è®¾ç½®htmlå†…å®¹1234567// å–å‡ºhtmlå†…å®¹var $htm = $('#div1').html();// è®¾ç½®htmlå†…å®¹$('#div1').html('&lt;span&gt;æ·»åŠ æ–‡å­—&lt;/span&gt;');2ã€prop() å–å‡ºæˆ–è®¾ç½®æŸä¸ªå±žæ€§çš„å€¼1234567// å–å‡ºå›¾ç‰‡çš„åœ°å€var $src = $('#img1').prop('src');// è®¾ç½®å›¾ç‰‡çš„åœ°å€å’Œaltå±žæ€§$('#img1').prop(&#123;src: "test.jpg", alt: "Test Image" &#125;);10.11 jqueryå¾ªçŽ¯å¯¹jqueryé€‰æ‹©çš„å¯¹è±¡é›†åˆåˆ†åˆ«è¿›è¡Œæ“ä½œï¼Œéœ€è¦ç”¨åˆ°jqueryå¾ªçŽ¯æ“ä½œï¼Œæ­¤æ—¶å¯ä»¥ç”¨å¯¹è±¡ä¸Šçš„eachæ–¹æ³•ï¼š1234567891011121314$(function()&#123; $('.list li').each(function(i)&#123; $(this).html(i); &#125;)&#125;)......&lt;ul class="list"&gt; &lt;li&gt;&lt;/li&gt; &lt;li&gt;&lt;/li&gt; &lt;li&gt;&lt;/li&gt; &lt;li&gt;&lt;/li&gt; &lt;li&gt;&lt;/li&gt; &lt;li&gt;&lt;/li&gt;&lt;/ul&gt;10.12 jqueryäº‹ä»¶10.12.1 äº‹ä»¶å‡½æ•°åˆ—è¡¨ï¼š123456789101112blur() å…ƒç´ å¤±åŽ»ç„¦ç‚¹focus() å…ƒç´ èŽ·å¾—ç„¦ç‚¹click() é¼ æ ‡å•å‡»mouseover() é¼ æ ‡è¿›å…¥ï¼ˆè¿›å…¥å­å…ƒç´ ä¹Ÿè§¦å‘ï¼‰mouseout() é¼ æ ‡ç¦»å¼€ï¼ˆç¦»å¼€å­å…ƒç´ ä¹Ÿè§¦å‘ï¼‰mouseenter() é¼ æ ‡è¿›å…¥ï¼ˆè¿›å…¥å­å…ƒç´ ä¸è§¦å‘ï¼‰mouseleave() é¼ æ ‡ç¦»å¼€ï¼ˆç¦»å¼€å­å…ƒç´ ä¸è§¦å‘ï¼‰hover() åŒæ—¶ä¸ºmouseenterå’Œmouseleaveäº‹ä»¶æŒ‡å®šå¤„ç†å‡½æ•°ready() DOMåŠ è½½å®Œæˆresize() æµè§ˆå™¨çª—å£çš„å¤§å°å‘ç”Ÿæ”¹å˜scroll() æ»šåŠ¨æ¡çš„ä½ç½®å‘ç”Ÿå˜åŒ–submit() ç”¨æˆ·é€’äº¤è¡¨å•10.12.2 ç»‘å®šäº‹ä»¶çš„å…¶ä»–æ–¹å¼12345$(function()&#123; $('#div1').bind('mouseover click', function(event) &#123; alert($(this).html()); &#125;);&#125;);10.12.3 å–æ¶ˆç»‘å®šäº‹ä»¶123456789$(function()&#123; $('#div1').bind('mouseover click', function(event) &#123; alert($(this).html()); // $(this).unbind(); $(this).unbind('mouseover'); &#125;);&#125;);10.13 äº‹ä»¶å†’æ³¡10.13.1 ä»€ä¹ˆæ˜¯äº‹ä»¶å†’æ³¡åœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šè§¦å‘æŸç±»äº‹ä»¶ï¼ˆæ¯”å¦‚å•å‡»onclickäº‹ä»¶ï¼‰ï¼Œå¦‚æžœæ­¤å¯¹è±¡å®šä¹‰äº†æ­¤äº‹ä»¶çš„å¤„ç†ç¨‹åºï¼Œé‚£ä¹ˆæ­¤äº‹ä»¶å°±ä¼šè°ƒç”¨è¿™ä¸ªå¤„ç†ç¨‹åºï¼Œå¦‚æžœæ²¡æœ‰å®šä¹‰æ­¤äº‹ä»¶å¤„ç†ç¨‹åºæˆ–è€…äº‹ä»¶è¿”å›žtrueï¼Œé‚£ä¹ˆè¿™ä¸ªäº‹ä»¶ä¼šå‘è¿™ä¸ªå¯¹è±¡çš„çˆ¶çº§å¯¹è±¡ä¼ æ’­ï¼Œä»Žé‡Œåˆ°å¤–ï¼Œç›´è‡³å®ƒè¢«å¤„ç†ï¼ˆçˆ¶çº§å¯¹è±¡æ‰€æœ‰åŒç±»äº‹ä»¶éƒ½å°†è¢«æ¿€æ´»ï¼‰ï¼Œæˆ–è€…å®ƒåˆ°è¾¾äº†å¯¹è±¡å±‚æ¬¡çš„æœ€é¡¶å±‚ï¼Œå³documentå¯¹è±¡ï¼ˆæœ‰äº›æµè§ˆå™¨æ˜¯windowï¼‰ã€‚10.13.2 äº‹ä»¶å†’æ³¡çš„ä½œç”¨äº‹ä»¶å†’æ³¡å…è®¸å¤šä¸ªæ“ä½œè¢«é›†ä¸­å¤„ç†ï¼ˆæŠŠäº‹ä»¶å¤„ç†å™¨æ·»åŠ åˆ°ä¸€ä¸ªçˆ¶çº§å…ƒç´ ä¸Šï¼Œé¿å…æŠŠäº‹ä»¶å¤„ç†å™¨æ·»åŠ åˆ°å¤šä¸ªå­çº§å…ƒç´ ä¸Šï¼‰ï¼Œå®ƒè¿˜å¯ä»¥è®©ä½ åœ¨å¯¹è±¡å±‚çš„ä¸åŒçº§åˆ«æ•èŽ·äº‹ä»¶ã€‚10.13.3 é˜»æ­¢äº‹ä»¶å†’æ³¡äº‹ä»¶å†’æ³¡æœºåˆ¶æœ‰æ—¶å€™æ˜¯ä¸éœ€è¦çš„ï¼Œéœ€è¦é˜»æ­¢æŽ‰ï¼Œé€šè¿‡ event.stopPropagation() æ¥é˜»æ­¢123456789101112131415161718192021222324252627$(function()&#123; var $box1 = $('.father'); var $box2 = $('.son'); var $box3 = $('.grandson'); $box1.click(function() &#123; alert('father'); &#125;); $box2.click(function() &#123; alert('son'); &#125;); $box3.click(function(event) &#123; alert('grandson'); event.stopPropagation(); &#125;); $(document).click(function(event) &#123; alert('grandfather'); &#125;);&#125;)......&lt;div class="father"&gt; &lt;div class="son"&gt; &lt;div class="grandson"&gt;&lt;/div&gt; &lt;/div&gt;&lt;/div&gt;10.13.4 é˜»æ­¢é»˜è®¤è¡Œä¸ºé˜»æ­¢è¡¨å•æäº¤123$('#form1').submit(function(event)&#123; event.preventDefault();&#125;)10.14.5 åˆå¹¶é˜»æ­¢æ“ä½œå®žé™…å¼€å‘ä¸­ï¼Œä¸€èˆ¬æŠŠé˜»æ­¢å†’æ³¡å’Œé˜»æ­¢é»˜è®¤è¡Œä¸ºåˆå¹¶èµ·æ¥å†™ï¼Œåˆå¹¶å†™æ³•å¯ä»¥ç”¨12345// event.stopPropagation();// event.preventDefault();// åˆå¹¶å†™æ³•ï¼šreturn false;10.14 äº‹ä»¶å§”æ‰˜äº‹ä»¶å§”æ‰˜å°±æ˜¯åˆ©ç”¨å†’æ³¡çš„åŽŸç†ï¼ŒæŠŠäº‹ä»¶åŠ åˆ°çˆ¶çº§ä¸Šï¼Œé€šè¿‡åˆ¤æ–­äº‹ä»¶æ¥æºçš„å­é›†ï¼Œæ‰§è¡Œç›¸åº”çš„æ“ä½œï¼Œäº‹ä»¶å§”æ‰˜é¦–å…ˆå¯ä»¥æžå¤§å‡å°‘äº‹ä»¶ç»‘å®šæ¬¡æ•°ï¼Œæé«˜æ€§èƒ½ï¼›å…¶æ¬¡å¯ä»¥è®©æ–°åŠ å…¥çš„å­å…ƒç´ ä¹Ÿå¯ä»¥æ‹¥æœ‰ç›¸åŒçš„æ“ä½œã€‚10.14.1 ä¸€èˆ¬ç»‘å®šäº‹ä»¶çš„å†™æ³•1234567891011121314$(function()&#123; $ali = $('#list li'); $ali.click(function() &#123; $(this).css(&#123;background:'red'&#125;); &#125;);&#125;)...&lt;ul id="list"&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;3&lt;/li&gt; &lt;li&gt;4&lt;/li&gt; &lt;li&gt;5&lt;/li&gt;&lt;/ul&gt;10.14.2 äº‹ä»¶å§”æ‰˜çš„å†™æ³•1234567891011121314$(function()&#123; $list = $('#list'); $list.delegate('li', 'click', function() &#123; $(this).css(&#123;background:'red'&#125;); &#125;);&#125;)...&lt;ul id="list"&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;3&lt;/li&gt; &lt;li&gt;4&lt;/li&gt; &lt;li&gt;5&lt;/li&gt;&lt;/ul&gt;10.15 jqueryå…ƒç´ èŠ‚ç‚¹æ“ä½œ10.15.1 åˆ›å»ºèŠ‚ç‚¹12var $div = $('&lt;div&gt;');var $div2 = $('&lt;div&gt;è¿™æ˜¯ä¸€ä¸ªdivå…ƒç´ &lt;/div&gt;');10.15.2 æ’å…¥èŠ‚ç‚¹1ã€append()å’ŒappendTo()ï¼šåœ¨çŽ°å­˜å…ƒç´ çš„å†…éƒ¨ï¼Œä»ŽåŽé¢æ’å…¥å…ƒç´ 1234var $span = $('&lt;span&gt;è¿™æ˜¯ä¸€ä¸ªspanå…ƒç´ &lt;/span&gt;');$('#div1').append($span);......&lt;div id="div1"&gt;&lt;/div&gt;2ã€prepend()å’ŒprependTo()ï¼šåœ¨çŽ°å­˜å…ƒç´ çš„å†…éƒ¨ï¼Œä»Žå‰é¢æ’å…¥å…ƒç´ 3ã€after()å’ŒinsertAfter()ï¼šåœ¨çŽ°å­˜å…ƒç´ çš„å¤–éƒ¨ï¼Œä»ŽåŽé¢æ’å…¥å…ƒç´ 4ã€before()å’ŒinsertBefore()ï¼šåœ¨çŽ°å­˜å…ƒç´ çš„å¤–éƒ¨ï¼Œä»Žå‰é¢æ’å…¥å…ƒç´ 10.15.3 åˆ é™¤èŠ‚ç‚¹1$('#div1').remove();10.16 æ»šè½®äº‹ä»¶ä¸Žå‡½æ•°èŠ‚æµ10.16.1 jquery.mousewheelæ’ä»¶ä½¿ç”¨jqueryä¸­æ²¡æœ‰é¼ æ ‡æ»šè½®äº‹ä»¶ï¼ŒåŽŸç”Ÿjsä¸­çš„é¼ æ ‡æ»šè½®äº‹ä»¶ä¸å…¼å®¹ï¼Œå¯ä»¥ä½¿ç”¨jqueryçš„æ»šè½®äº‹ä»¶æ’ä»¶jquery.mousewheel.jsã€‚10.16.2 å‡½æ•°èŠ‚æµjavascriptä¸­æœ‰äº›äº‹ä»¶çš„è§¦å‘é¢‘çŽ‡éžå¸¸é«˜ï¼Œæ¯”å¦‚onresizeäº‹ä»¶(jqä¸­æ˜¯resize)ï¼Œonmousemoveäº‹ä»¶(jqä¸­æ˜¯mousemove)ä»¥åŠä¸Šé¢è¯´çš„é¼ æ ‡æ»šè½®äº‹ä»¶ï¼Œåœ¨çŸ­äº‹ä»¶å†…å¤šå¤„è§¦å‘æ‰§è¡Œç»‘å®šçš„å‡½æ•°ï¼Œå¯ä»¥å·§å¦™åœ°ä½¿ç”¨å®šæ—¶å™¨æ¥å‡å°‘è§¦å‘çš„æ¬¡æ•°ï¼Œå®žçŽ°å‡½æ•°èŠ‚æµã€‚10.17 jsonjsonæ˜¯ JavaScript Object Notation çš„é¦–å­—æ¯ç¼©å†™ï¼Œå•è¯çš„æ„æ€æ˜¯javascriptå¯¹è±¡è¡¨ç¤ºæ³•ï¼Œè¿™é‡Œè¯´çš„jsonæŒ‡çš„æ˜¯ç±»ä¼¼äºŽjavascriptå¯¹è±¡çš„ä¸€ç§æ•°æ®æ ¼å¼ï¼Œç›®å‰è¿™ç§æ•°æ®æ ¼å¼æ¯”è¾ƒæµè¡Œï¼Œé€æ¸æ›¿æ¢æŽ‰äº†ä¼ ç»Ÿçš„xmlæ•°æ®æ ¼å¼ã€‚javascriptè‡ªå®šä¹‰å¯¹è±¡ï¼š1234567var oMan = &#123; name:'tom', age:16, talk:function(s)&#123; alert('æˆ‘ä¼šè¯´'+s); &#125;&#125;jsonæ ¼å¼çš„æ•°æ®ï¼š1234&#123; "name":"tom", "age":18&#125;ä¸Žjsonå¯¹è±¡ä¸åŒçš„æ˜¯ï¼Œjsonæ•°æ®æ ¼å¼çš„å±žæ€§åç§°å’Œå­—ç¬¦ä¸²å€¼éœ€è¦ç”¨åŒå¼•å·å¼•èµ·æ¥ï¼Œç”¨å•å¼•å·æˆ–è€…ä¸ç”¨å¼•å·ä¼šå¯¼è‡´è¯»å–æ•°æ®é”™è¯¯ã€‚jsonçš„å¦å¤–ä¸€ä¸ªæ•°æ®æ ¼å¼æ˜¯æ•°ç»„ï¼Œå’Œjavascriptä¸­çš„æ•°ç»„å­—é¢é‡ç›¸åŒã€‚1["tom",18,"programmer"]10.18 ajaxä¸ŽjsonpajaxæŠ€æœ¯çš„ç›®çš„æ˜¯è®©javascriptå‘é€httpè¯·æ±‚ï¼Œä¸ŽåŽå°é€šä¿¡ï¼ŒèŽ·å–æ•°æ®å’Œä¿¡æ¯ã€‚ajaxæŠ€æœ¯çš„åŽŸç†æ˜¯å®žä¾‹åŒ–xmlhttpå¯¹è±¡ï¼Œä½¿ç”¨æ­¤å¯¹è±¡ä¸ŽåŽå°é€šä¿¡ã€‚ajaxé€šä¿¡çš„è¿‡ç¨‹ä¸ä¼šå½±å“åŽç»­javascriptçš„æ‰§è¡Œï¼Œä»Žè€Œå®žçŽ°å¼‚æ­¥ã€‚10.18.1 åŒæ­¥å’Œå¼‚æ­¥çŽ°å®žç”Ÿæ´»ä¸­ï¼ŒåŒæ­¥æŒ‡çš„æ˜¯åŒæ—¶åšå‡ ä»¶äº‹æƒ…ï¼Œå¼‚æ­¥æŒ‡çš„æ˜¯åšå®Œä¸€ä»¶äº‹åŽå†åšå¦å¤–ä¸€ä»¶äº‹ï¼Œç¨‹åºä¸­çš„åŒæ­¥å’Œå¼‚æ­¥æ˜¯æŠŠçŽ°å®žç”Ÿæ´»ä¸­çš„æ¦‚å¿µå¯¹è°ƒï¼Œä¹Ÿå°±æ˜¯ç¨‹åºä¸­çš„å¼‚æ­¥æŒ‡çš„æ˜¯çŽ°å®žç”Ÿæ´»ä¸­çš„åŒæ­¥ï¼Œç¨‹åºä¸­çš„åŒæ­¥æŒ‡çš„æ˜¯çŽ°å®žç”Ÿæ´»ä¸­çš„å¼‚æ­¥ã€‚10.18.2 å±€éƒ¨åˆ·æ–°å’Œæ— åˆ·æ–°ajaxå¯ä»¥å®žçŽ°å±€éƒ¨åˆ·æ–°ï¼Œä¹Ÿå«åšæ— åˆ·æ–°ï¼Œæ— åˆ·æ–°æŒ‡çš„æ˜¯æ•´ä¸ªé¡µé¢ä¸åˆ·æ–°ï¼Œåªæ˜¯å±€éƒ¨åˆ·æ–°ï¼Œajaxå¯ä»¥è‡ªå·±å‘é€httpè¯·æ±‚ï¼Œä¸ç”¨é€šè¿‡æµè§ˆå™¨çš„åœ°å€æ ï¼Œæ‰€ä»¥é¡µé¢æ•´ä½“ä¸ä¼šåˆ·æ–°ï¼ŒajaxèŽ·å–åˆ°åŽå°æ•°æ®ï¼Œæ›´æ–°é¡µé¢æ˜¾ç¤ºæ•°æ®çš„éƒ¨åˆ†ï¼Œå°±åšåˆ°äº†é¡µé¢å±€éƒ¨åˆ·æ–°ã€‚10.18.3 åŒæºç­–ç•¥ajaxè¯·æ±‚çš„é¡µé¢æˆ–èµ„æºåªèƒ½æ˜¯åŒä¸€ä¸ªåŸŸä¸‹é¢çš„èµ„æºï¼Œä¸èƒ½æ˜¯å…¶ä»–åŸŸçš„èµ„æºï¼Œè¿™æ˜¯åœ¨è®¾è®¡ajaxæ—¶åŸºäºŽå®‰å…¨çš„è€ƒè™‘ã€‚ç‰¹å¾æŠ¥é”™æç¤ºï¼š123XMLHttpRequest cannot load https://www.baidu.com/. No &apos;Access-Control-Allow-Origin&apos; header is present on the requested resource. Origin &apos;null&apos; is therefore not allowed access.10.18.4 $.ajaxä½¿ç”¨æ–¹æ³•å¸¸ç”¨å‚æ•°ï¼š1ã€url è¯·æ±‚åœ°å€2ã€type è¯·æ±‚æ–¹å¼ï¼Œé»˜è®¤æ˜¯â€™GETâ€™ï¼Œå¸¸ç”¨çš„è¿˜æœ‰â€™POSTâ€™3ã€dataType è®¾ç½®è¿”å›žçš„æ•°æ®æ ¼å¼ï¼Œå¸¸ç”¨çš„æ˜¯â€™jsonâ€™æ ¼å¼ï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä¸ºâ€™htmlâ€™4ã€data è®¾ç½®å‘é€ç»™æœåŠ¡å™¨çš„æ•°æ®5ã€success è®¾ç½®è¯·æ±‚æˆåŠŸåŽçš„å›žè°ƒå‡½æ•°6ã€error è®¾ç½®è¯·æ±‚å¤±è´¥åŽçš„å›žè°ƒå‡½æ•°7ã€async è®¾ç½®æ˜¯å¦å¼‚æ­¥ï¼Œé»˜è®¤å€¼æ˜¯â€™trueâ€™ï¼Œè¡¨ç¤ºå¼‚æ­¥ä»¥å‰çš„å†™æ³•ï¼š123456789101112$.ajax(&#123; url: 'js/data.json', type: 'GET', dataType: 'json', data:&#123;'aa':1&#125; success:function(data)&#123; alert(data.name); &#125;, error:function()&#123; alert('æœåŠ¡å™¨è¶…æ—¶ï¼Œè¯·é‡è¯•ï¼'); &#125;&#125;);æ–°çš„å†™æ³•(æŽ¨è)ï¼š1234567891011121314$.ajax(&#123; url: &apos;js/data.json&apos;, type: &apos;GET&apos;, dataType: &apos;json&apos;, data:&#123;&apos;aa&apos;:1&#125;&#125;).done(function(data) &#123; alert(data.name);&#125;).fail(function() &#123; alert(&apos;æœåŠ¡å™¨è¶…æ—¶ï¼Œè¯·é‡è¯•ï¼&apos;);&#125;);// data.jsoné‡Œé¢çš„æ•°æ®ï¼š &#123;&quot;name&quot;:&quot;tom&quot;,&quot;age&quot;:18&#125;10.18.5 jsonpajaxåªèƒ½è¯·æ±‚åŒä¸€ä¸ªåŸŸä¸‹çš„æ•°æ®æˆ–èµ„æºï¼Œæœ‰æ—¶å€™éœ€è¦è·¨åŸŸè¯·æ±‚æ•°æ®ï¼Œå°±éœ€è¦ç”¨åˆ°jsonpæŠ€æœ¯ï¼Œjsonpå¯ä»¥è·¨åŸŸè¯·æ±‚æ•°æ®ï¼Œå®ƒçš„åŽŸç†ä¸»è¦æ˜¯åˆ©ç”¨äº†æ ‡ç­¾å¯ä»¥è·¨åŸŸé“¾æŽ¥èµ„æºçš„ç‰¹æ€§ã€‚jsonpå’ŒajaxåŽŸç†å®Œå…¨ä¸ä¸€æ ·ï¼Œä¸è¿‡jqueryå°†å®ƒä»¬å°è£…æˆåŒä¸€ä¸ªå‡½æ•°ã€‚ 1234567891011121314$.ajax(&#123; url:'js/data.js', type:'get', dataType:'jsonp', jsonpCallback:'fnBack'&#125;).done(function(data)&#123; alert(data.name);&#125;).fail(function() &#123; alert('æœåŠ¡å™¨è¶…æ—¶ï¼Œè¯·é‡è¯•ï¼');&#125;);// data.jsé‡Œé¢çš„æ•°æ®ï¼š fnBack(&#123;"name":"tom","age":18&#125;); 12345678910111213141516171819202122232425$(function()&#123; $('#txt01').keyup(function()&#123; var sVal = $(this).val(); $.ajax(&#123; url:'https://sug.so.360.cn/suggest?', type:'get', dataType:'jsonp', data: &#123;word: sVal&#125; &#125;) .done(function(data)&#123; var aData = data.s; $('.list').empty(); for(var i=0;i&lt;aData.length;i++) &#123; var $li = $('&lt;li&gt;'+ aData[i] +'&lt;/li&gt;'); $li.appendTo($('.list')); &#125; &#125;) &#125;)&#125;)//......&lt;input type="text" name="" id="txt01"&gt;&lt;ul class="list"&gt;&lt;/ul&gt; 10.19 æœ¬åœ°å­˜å‚¨æœ¬åœ°å­˜å‚¨åˆ†ä¸ºcookieï¼Œä»¥åŠæ–°å¢žçš„localStorageå’ŒsessionStorage 1ã€cookie å­˜å‚¨åœ¨æœ¬åœ°ï¼Œå®¹é‡æœ€å¤§4kï¼Œåœ¨åŒæºçš„httpè¯·æ±‚æ—¶æºå¸¦ä¼ é€’ï¼ŒæŸè€—å¸¦å®½ï¼Œå¯è®¾ç½®è®¿é—®è·¯å¾„ï¼Œåªæœ‰æ­¤è·¯å¾„åŠæ­¤è·¯å¾„çš„å­è·¯å¾„æ‰èƒ½è®¿é—®æ­¤cookieï¼Œåœ¨è®¾ç½®çš„è¿‡æœŸæ—¶é—´ä¹‹å‰æœ‰æ•ˆã€‚ 1234jquery è®¾ç½®cookie$.cookie('mycookie','123',&#123;expires:7,path:'/'&#125;);jquery èŽ·å–cookie$.cookie('mycookie'); 2ã€localStorage å­˜å‚¨åœ¨æœ¬åœ°ï¼Œå®¹é‡ä¸º5Mæˆ–è€…æ›´å¤§ï¼Œä¸ä¼šåœ¨è¯·æ±‚æ—¶å€™æºå¸¦ä¼ é€’ï¼Œåœ¨æ‰€æœ‰åŒæºçª—å£ä¸­å…±äº«ï¼Œæ•°æ®ä¸€ç›´æœ‰æ•ˆï¼Œé™¤éžäººä¸ºåˆ é™¤ï¼Œå¯ä½œä¸ºé•¿æœŸæ•°æ®ã€‚ 12345678910//è®¾ç½®ï¼šlocalStorage.setItem("dat", "456");localStorage.dat = '456';//èŽ·å–ï¼šlocalStorage.getItem("dat");localStorage.dat//åˆ é™¤localStorage.removeItem("dat"); 3ã€sessionStorage å­˜å‚¨åœ¨æœ¬åœ°ï¼Œå®¹é‡ä¸º5Mæˆ–è€…æ›´å¤§ï¼Œä¸ä¼šåœ¨è¯·æ±‚æ—¶å€™æºå¸¦ä¼ é€’ï¼Œåœ¨åŒæºçš„å½“å‰çª—å£å…³é—­å‰æœ‰æ•ˆã€‚ localStorage å’Œ sessionStorage åˆç§°ä¸ºWeb Storage , Web Storageæ”¯æŒäº‹ä»¶é€šçŸ¥æœºåˆ¶ï¼Œå¯ä»¥å°†æ•°æ®æ›´æ–°çš„é€šçŸ¥ç›‘å¬è€…ï¼ŒWeb Storageçš„apiæŽ¥å£ä½¿ç”¨æ›´æ–¹ä¾¿ã€‚ iPhoneçš„æ— ç—•æµè§ˆä¸æ”¯æŒWeb Storageï¼Œåªèƒ½ç”¨cookieã€‚ 10.20 jqueryUIjQuery UIæ˜¯ä»¥ jQuery ä¸ºåŸºç¡€çš„ä»£ç åº“ã€‚åŒ…å«åº•å±‚ç”¨æˆ·äº¤äº’ã€åŠ¨ç”»ã€ç‰¹æ•ˆå’Œå¯æ›´æ¢ä¸»é¢˜çš„å¯è§†æŽ§ä»¶ã€‚æˆ‘ä»¬å¯ä»¥ç›´æŽ¥ç”¨å®ƒæ¥æž„å»ºå…·æœ‰å¾ˆå¥½äº¤äº’æ€§çš„webåº”ç”¨ç¨‹åºã€‚ jqueryUI ç½‘å€http://jqueryui.com/ 11.ç§»åŠ¨ç«¯åº“å’Œæ¡†æž¶11.1 ç§»åŠ¨ç«¯jsäº‹ä»¶ç§»åŠ¨ç«¯çš„æ“ä½œæ–¹å¼å’ŒPCç«¯æ˜¯ä¸åŒçš„ï¼Œç§»åŠ¨ç«¯ä¸»è¦ç”¨æ‰‹æŒ‡æ“ä½œï¼Œæ‰€ä»¥æœ‰ç‰¹æ®Šçš„touchäº‹ä»¶ï¼Œtouchäº‹ä»¶åŒ…æ‹¬å¦‚ä¸‹å‡ ä¸ªäº‹ä»¶ï¼š 1ã€touchstart: //æ‰‹æŒ‡æ”¾åˆ°å±å¹•ä¸Šæ—¶è§¦å‘2ã€touchmove: //æ‰‹æŒ‡åœ¨å±å¹•ä¸Šæ»‘åŠ¨å¼è§¦å‘3ã€touchend: //æ‰‹æŒ‡ç¦»å¼€å±å¹•æ—¶è§¦å‘4ã€touchcancel: //ç³»ç»Ÿå–æ¶ˆtouchäº‹ä»¶çš„æ—¶å€™è§¦å‘ï¼Œæ¯”è¾ƒå°‘ç”¨ ç§»åŠ¨ç«¯ä¸€èˆ¬æœ‰ä¸‰ç§æ“ä½œï¼Œç‚¹å‡»ã€æ»‘åŠ¨ã€æ‹–åŠ¨ï¼Œè¿™ä¸‰ç§æ“ä½œä¸€èˆ¬æ˜¯ç»„åˆä½¿ç”¨ä¸Šé¢çš„å‡ ä¸ªäº‹ä»¶æ¥å®Œæˆçš„ï¼Œæ‰€æœ‰ä¸Šé¢çš„4ä¸ªäº‹ä»¶ä¸€èˆ¬å¾ˆå°‘å•ç‹¬ä½¿ç”¨ï¼Œä¸€èˆ¬æ˜¯å°è£…ä½¿ç”¨æ¥å®žçŽ°è¿™ä¸‰ç§æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨å°è£…æˆç†Ÿçš„jsåº“ã€‚ 11.2 zeptojsZeptoæ˜¯ä¸€ä¸ªè½»é‡çº§çš„é’ˆå¯¹çŽ°ä»£é«˜çº§æµè§ˆå™¨çš„JavaScriptåº“ï¼Œ å®ƒä¸Žjqueryæœ‰ç€ç±»ä¼¼çš„apiã€‚ å¦‚æžœä½ ä¼šç”¨jqueryï¼Œé‚£ä¹ˆä½ ä¹Ÿä¼šç”¨zeptoã€‚Zeptoçš„ä¸€äº›å¯é€‰åŠŸèƒ½æ˜¯ä¸“é—¨é’ˆå¯¹ç§»åŠ¨ç«¯æµè§ˆå™¨çš„ï¼›å®ƒçš„æœ€åˆç›®æ ‡æ˜¯åœ¨ç§»åŠ¨ç«¯æä¾›ä¸€ä¸ªç²¾ç®€çš„ç±»ä¼¼jqueryçš„jsåº“ã€‚ zeptoå®˜ç½‘ï¼šhttp://zeptojs.com/zeptoä¸­æ–‡apiï¼šhttp://www.css88.com/doc/zeptojs_api/zeptoåŒ…å«å¾ˆå¤šæ¨¡å—ï¼Œé»˜è®¤ä¸‹è½½ç‰ˆæœ¬åŒ…å«çš„æ¨¡å—æœ‰Core, Ajax, Event, Form, IEæ¨¡å—ï¼Œå¦‚æžœè¿˜éœ€è¦å…¶ä»–çš„æ¨¡å—ï¼Œå¯ä»¥è‡ªå®šä¹‰æž„å»ºã€‚zeptoè‡ªå®šä¹‰æž„å»ºåœ°å€ï¼šhttp://github.e-sites.nl/zeptobuilder/ 11.3 swiperswiper.jsæ˜¯ä¸€æ¬¾æˆç†Ÿç¨³å®šçš„åº”ç”¨äºŽPCç«¯å’Œç§»åŠ¨ç«¯çš„æ»‘åŠ¨æ•ˆæžœæ’ä»¶ï¼Œä¸€èˆ¬ç”¨æ¥è§¦å±ç„¦ç‚¹å›¾ã€è§¦å±æ•´å±æ»šåŠ¨ç­‰æ•ˆæžœã€‚ swiperåˆ†ä¸º2.xç‰ˆæœ¬å’Œ3.xç‰ˆæœ¬ï¼Œ2.xç‰ˆæœ¬æ”¯æŒä½Žç‰ˆæœ¬æµè§ˆå™¨(IE7)ï¼Œ3.xæ”¾å¼ƒæ”¯æŒä½Žç‰ˆæœ¬æµè§ˆå™¨ï¼Œé€‚åˆåº”ç”¨åœ¨ç§»åŠ¨ç«¯ã€‚ 2.xç‰ˆæœ¬ä¸­æ–‡ç½‘å€ï¼šhttp://2.swiper.com.cn/3.xç‰ˆæœ¬ä¸­æ–‡ç½‘åœ°å€ï¼šhttp://www.swiper.com.cn/ 11.3.1 swiperä½¿ç”¨æ–¹æ³•ï¼š123456789101112131415161718192021222324252627282930313233343536&lt;script type="text/javascript" src="js/swiper.min.js"&gt;&lt;/script&gt;&lt;!-- å¦‚æžœé¡µé¢å¼•ç”¨äº†jqueryæˆ–è€…zeptoï¼Œå°±å¼•ç”¨ swiper.jquery.min.js,å®ƒçš„å®¹é‡æ¯”swiper.min.js &lt;script src="path/to/swiper.jquery.min.js"&gt;&lt;/script&gt;--&gt;......&lt;link rel="stylesheet" type="text/css" href="css/swiper.min.css"&gt;......&lt;div class="swiper-container"&gt; &lt;div class="swiper-wrapper"&gt; &lt;div class="swiper-slide"&gt;slider1&lt;/div&gt; &lt;div class="swiper-slide"&gt;slider2&lt;/div&gt; &lt;div class="swiper-slide"&gt;slider3&lt;/div&gt; &lt;/div&gt; &lt;div class="swiper-pagination"&gt;&lt;/div&gt; &lt;div class="swiper-button-prev"&gt;&lt;/div&gt; &lt;div class="swiper-button-next"&gt;&lt;/div&gt;&lt;/div&gt;&lt;script&gt; var swiper = new Swiper('.swiper-container', &#123; pagination: '.swiper-pagination', prevButton: '.swiper-button-prev', nextButton: '.swiper-button-next', initialSlide :1, paginationClickable: true, loop: true, autoplay:3000, autoplayDisableOnInteraction:false&#125;);&lt;/script&gt; 11.13.2 swiperä½¿ç”¨å‚æ•°ï¼š1ã€initialSlideï¼šåˆå§‹ç´¢å¼•å€¼ï¼Œä»Ž0å¼€å§‹2ã€directionï¼šæ»‘åŠ¨æ–¹å‘ horizontal | vertical3ã€speedï¼šæ»‘åŠ¨é€Ÿåº¦ï¼Œå•ä½ms4ã€autoplayï¼šè®¾ç½®è‡ªåŠ¨æ’­æ”¾åŠæ’­æ”¾æ—¶é—´5ã€autoplayDisableOnInteractionï¼šç”¨æˆ·æ“ä½œswipeåŽæ˜¯å¦è¿˜è‡ªåŠ¨æ’­æ”¾ï¼Œé»˜è®¤æ˜¯trueï¼Œä¸å†è‡ªåŠ¨æ’­æ”¾6ã€paginationï¼šåˆ†é¡µåœ†ç‚¹7ã€paginationClickableï¼šåˆ†é¡µåœ†ç‚¹æ˜¯å¦ç‚¹å‡»8ã€prevButtonï¼šä¸Šä¸€é¡µç®­å¤´9ã€nextButtonï¼šä¸‹ä¸€é¡µç®­å¤´10ã€loopï¼šæ˜¯å¦é¦–å°¾è¡”æŽ¥ 11.4 bootstrapç®€å•ã€ç›´è§‚ã€å¼ºæ‚çš„å‰ç«¯å¼€å‘æ¡†æž¶ï¼Œè®©webå¼€å‘æ›´è¿…é€Ÿã€ç®€å•ã€‚ æ¥è‡ªTwitterï¼Œæ˜¯ç›®å‰å¾ˆå—æ¬¢è¿Žçš„å‰ç«¯æ¡†æž¶ä¹‹ä¸€ã€‚ Bootrstrapæ˜¯åŸºäºŽHTMLã€CSSã€JavaScriptçš„ï¼Œè®©ä¹¦å†™ä»£ç æ›´å®¹æ˜“ã€‚ ç§»åŠ¨ä¼˜å…ˆï¼Œå“åº”å¼å¸ƒå±€å¼€å‘ã€‚ bootstrapä¸­æ–‡ç½‘å€ï¼šhttp://www.bootcss.com/ 11.4.1 bootstrap å®¹å™¨ container-fluid æµä½“ container 1170 970 750 100% 12&lt;div class=&quot;container-fluid&quot;&gt;æµä½“å®¹å™¨&lt;/div&gt;&lt;div class=&quot;container&quot;&gt;å“åº”å¼å›ºå®šå®¹å™¨&lt;/div&gt; 11.4.2 bootstrapå“åº”å¼æŸ¥è¯¢åŒºé—´1ã€å¤§äºŽç­‰äºŽ7682ã€å¤§äºŽç­‰äºŽ9923ã€å¤§äºŽç­‰äºŽ1200 11.4.3 bootstrap æ …æ ¼ç³»ç»Ÿbootstrapå°†é¡µé¢æ¨ªå‘åˆ†ä¸º12ç­‰åˆ†ï¼ŒæŒ‰ç…§12ç­‰åˆ†å®šä¹‰äº†é€‚åº”ä¸åŒå®½åº¦ç­‰åˆ†çš„æ ·å¼ç±»ï¼Œè¿™äº›æ ·å¼ç±»ç»„æˆäº†ä¸€å¥—å“åº”å¼ã€ç§»åŠ¨è®¾å¤‡ä¼˜å…ˆçš„æµå¼æ …æ ¼ç³»ç»Ÿï¼š 1ã€col-lg- å¤§äºŽ1200æŽ’æˆä¸€è¡Œï¼Œå°äºŽ1200åˆ†åˆ«å ä¸€è¡Œ2ã€col-md- å¤§äºŽ992æŽ’æˆä¸€è¡Œï¼Œå°äºŽ992åˆ†åˆ«å ä¸€è¡Œ3ã€col-sm- å¤§äºŽ768æŽ’æˆä¸€è¡Œï¼Œå°äºŽ768åˆ†åˆ«å ä¸€è¡Œ4ã€col-xs- å§‹ç»ˆæŽ’åˆ—æˆä¸€è¡Œ 12345678910111213141516171819202122232425262728293031323334353637383940414243&lt;style type="text/css"&gt; div[class*='col-']&#123; background-color:cyan; border:1px solid #ddd; height:50px; &#125;&lt;/style&gt;......&lt;div class="container"&gt; &lt;div class="row"&gt; &lt;div class="col-lg-3"&gt;col-lg-3&lt;/div&gt; &lt;div class="col-lg-3"&gt;col-lg-3&lt;/div&gt; &lt;div class="col-lg-5"&gt;col-lg-5&lt;/div&gt; &lt;div class="col-lg-1"&gt;col-lg-1&lt;/div&gt; &lt;/div&gt; &lt;br&gt; &lt;br&gt; &lt;div class="row"&gt; &lt;div class="col-md-3"&gt;col-md-3&lt;/div&gt; &lt;div class="col-md-3"&gt;col-md-3&lt;/div&gt; &lt;div class="col-md-3"&gt;col-md-3&lt;/div&gt; &lt;div class="col-md-3"&gt;col-md-3&lt;/div&gt; &lt;/div&gt; &lt;br&gt; &lt;br&gt; &lt;div class="row"&gt; &lt;div class="col-sm-3"&gt;col-sm-3&lt;/div&gt; &lt;div class="col-sm-3"&gt;col-sm-3&lt;/div&gt; &lt;div class="col-sm-3"&gt;col-sm-3&lt;/div&gt; &lt;div class="col-sm-3"&gt;col-sm-3&lt;/div&gt; &lt;/div&gt; &lt;br&gt; &lt;br&gt; &lt;div class="row"&gt; &lt;div class="col-xs-3"&gt;col-xs-3&lt;/div&gt; &lt;div class="col-xs-3"&gt;col-xs-3&lt;/div&gt; &lt;div class="col-xs-3"&gt;col-xs-3&lt;/div&gt; &lt;div class="col-xs-3"&gt;col-xs-3&lt;/div&gt; &lt;/div&gt;&lt;/div&gt; 11.4.4 åˆ—åç§»1ã€col-lg-offset-2ã€col-md-offset-3ã€col-sm-offset-4ã€col-xs-offset- 11.4.5 bootstrap æŒ‰é’®1ã€btn å£°æ˜ŽæŒ‰é’®2ã€btn-default é»˜è®¤æŒ‰é’®æ ·å¼3ã€btn-primay4ã€btn-success5ã€btn-info6ã€btn-warning7ã€btn-danger8ã€btn-link9ã€btn-lg10ã€btn-md11ã€btn-xs12ã€btn-block å®½åº¦æ˜¯çˆ¶çº§å®½100%çš„æŒ‰é’®13ã€active14ã€disabled15ã€btn-group å®šä¹‰æŒ‰é’®ç»„ 1234567891011121314151617181920212223242526272829&lt;!-- ä¸€èˆ¬æŒ‰é’®ç»„ --&gt;&lt;div class="btn-group"&gt; &lt;input type="button" name="" value="æŒ‰é’®ä¸€" class="btn btn-primary"&gt; &lt;input type="button" name="" value="æŒ‰é’®äºŒ" class="btn btn-warning"&gt; &lt;input type="button" name="" value="æŒ‰é’®ä¸‰" class="btn btn-danger"&gt;&lt;/div&gt;&lt;!-- é€šæ æŒ‰é’®ç»„ å¦‚æžœç”¨inputæ ‡ç­¾åšæŒ‰é’®ï¼Œéœ€è¦å°†å®ƒç”¨ btn-groupçš„å®¹å™¨åŒ…èµ·æ¥--&gt;&lt;div class="btn-group btn-group-justified"&gt; &lt;div class="btn-group"&gt; &lt;input type="button" name="" value="æŒ‰é’®ä¸€" class="btn btn-primary"&gt; &lt;/div&gt; &lt;div class="btn-group"&gt; &lt;input type="button" name="" value="æŒ‰é’®äºŒ" class="btn btn-warning"&gt; &lt;/div&gt; &lt;div class="btn-group"&gt; &lt;input type="button" name="" value="æŒ‰é’®ä¸‰" class="btn btn-danger"&gt; &lt;/div&gt;&lt;/div&gt;&lt;!-- é€šæ æŒ‰é’®ç»„ï¼Œå¦‚æžœç”¨aæ ‡ç­¾åšæŒ‰é’®ï¼Œå°±ä¸ç”¨ä¸Šé¢çš„ç»“æž„ï¼Œç›´æŽ¥å†™--&gt;&lt;div class="btn-group btn-group-justified"&gt; &lt;a href="#" class="btn btn-primary"&gt;æŒ‰é’®ä¸€&lt;/a&gt; &lt;a href="#" class="btn btn-default"&gt;æŒ‰é’®äºŒ&lt;/a&gt; &lt;a href="#" class="btn btn-default"&gt;æŒ‰é’®ä¸‰&lt;/a&gt;&lt;/div&gt; 11.4.6 bootstrap è¡¨å•1ã€form å£°æ˜Žä¸€ä¸ªè¡¨å•åŸŸ2ã€form-inline å†…è”è¡¨å•åŸŸ3ã€form-horizontal æ°´å¹³æŽ’åˆ—è¡¨å•åŸŸ4ã€form-group è¡¨å•ç»„ã€åŒ…æ‹¬è¡¨å•æ–‡å­—å’Œè¡¨å•æŽ§ä»¶5ã€form-control æ–‡æœ¬è¾“å…¥æ¡†ã€ä¸‹æ‹‰åˆ—è¡¨æŽ§ä»¶æ ·å¼6ã€checkbox checkbox-inline å¤šé€‰æ¡†æ ·å¼7ã€radio radio-inline å•é€‰æ¡†æ ·å¼8ã€input-group è¡¨å•æŽ§ä»¶ç»„9ã€input-group-addon è¡¨å•æŽ§ä»¶ç»„ç‰©ä»¶æ ·å¼10ã€input-group-btn è¡¨å•æŽ§ä»¶ç»„ç‰©ä»¶ä¸ºæŒ‰é’®çš„æ ·å¼11ã€form-group-lg å¤§å°ºå¯¸è¡¨å•12ã€form-group-sm å°å°ºå¯¸è¡¨å• 123456789101112131415161718192021222324252627282930313233343536&lt;!-- è¡¨å• --&gt;&lt;form role="form"&gt; &lt;div class="form-group form-group-lg"&gt; &lt;label for="exampleInputEmail1"&gt;Email address&lt;/label&gt; &lt;input type="email" class="form-control" id="exampleInputEmail1" placeholder="Enter email"&gt; &lt;/div&gt; &lt;div class="form-group"&gt; &lt;label for="exampleInputPassword1"&gt;Password&lt;/label&gt; &lt;input type="password" class="form-control" id="exampleInputPassword1" placeholder="Password"&gt; &lt;/div&gt; &lt;div class="form-group"&gt; &lt;label for="exampleInputFile"&gt;File input&lt;/label&gt; &lt;input type="file" id="exampleInputFile"&gt; &lt;p class="help-block"&gt;Example block-level help text here.&lt;/p&gt; &lt;/div&gt; &lt;div class="checkbox"&gt; &lt;label&gt; &lt;input type="checkbox"&gt; Check me out &lt;/label&gt; &lt;/div&gt; &lt;button type="submit" class="btn btn-default"&gt;Submit&lt;/button&gt;&lt;/form&gt;&lt;!-- è¡¨å•æŽ§ä»¶ç»„ --&gt;&lt;div class="input-group"&gt; &lt;input type="text" class="form-control"&gt; &lt;span class="input-group-addon"&gt;@&lt;/span&gt;&lt;/div&gt;&lt;!-- è¡¨å•æŽ§ä»¶ç»„ --&gt;&lt;div class="input-group"&gt; &lt;input type="text" class="form-control"&gt; &lt;span class="input-group-btn"&gt; &lt;button class="btn btn-default" type="button"&gt;Go!&lt;/button&gt; &lt;/span&gt;&lt;/div&gt; 11.4.7 bootstrap å›¾ç‰‡img-responsive å£°æ˜Žå“åº”å¼å›¾ç‰‡ 11.4.8 bootstrap å­—ä½“å›¾æ ‡é€šè¿‡å­—ä½“ä»£æ›¿å›¾æ ‡ï¼Œfontæ–‡ä»¶å¤¹éœ€è¦å’Œcssæ–‡ä»¶å¤¹åœ¨åŒä¸€ç›®å½• 11.4.9 bootstrap å¯¼èˆªæ¡1ã€navbar å£°æ˜Žå¯¼èˆªæ¡2ã€navbar-default å£°æ˜Žé»˜è®¤çš„å¯¼èˆªæ¡æ ·å¼3ã€navbar-inverse å£°æ˜Žåç™½çš„å¯¼èˆªæ¡æ ·å¼4ã€navbar-static-top åŽ»æŽ‰å¯¼èˆªæ¡çš„åœ†è§’5ã€navbar-fixed-top å›ºå®šåˆ°é¡¶éƒ¨çš„å¯¼èˆªæ¡6ã€navbar-fixed-bottom å›ºå®šåˆ°åº•éƒ¨çš„å¯¼èˆªæ¡7ã€navbar-header ç”³æ˜Žlogoçš„å®¹å™¨8ã€navbar-brand é’ˆå¯¹logoç­‰å›ºå®šå†…å®¹çš„æ ·å¼11ã€nav navbar-nav å®šä¹‰å¯¼èˆªæ¡ä¸­çš„èœå•12ã€navbar-form å®šä¹‰å¯¼èˆªæ¡ä¸­çš„è¡¨å•13ã€navbar-btn å®šä¹‰å¯¼èˆªæ¡ä¸­çš„æŒ‰é’®14ã€navbar-text å®šä¹‰å¯¼èˆªæ¡ä¸­çš„æ–‡æœ¬15ã€navbar-left èœå•é å·¦16ã€navbar-right èœå•é å³ 123456789101112131415161718192021222324252627282930&lt;!-- å¯ä¼¸ç¼©èœå• data-target="#.." éœ€è¦åŠ # --&gt;&lt;div class="navbar navbar-inverse navbar-static-top "&gt; &lt;div class="container"&gt; &lt;div class="navbar-header"&gt; &lt;button class="navbar-toggle" data-toggle="collapse" data-target="#mymenu"&gt; &lt;span class="icon-bar"&gt;&lt;/span&gt; &lt;span class="icon-bar"&gt;&lt;/span&gt; &lt;span class="icon-bar"&gt;&lt;/span&gt; &lt;/button&gt; &lt;a href="#" class="navbar-brand"&gt;LOGO&lt;/a&gt; &lt;/div&gt; &lt;div class="collapse navbar-collapse" id="mymenu"&gt; &lt;ul class="nav navbar-nav"&gt; &lt;li class="active"&gt;&lt;a href="#"&gt;é¦–é¡µ&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;å…¬å¸æ–°é—»&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;è¡Œä¸šåŠ¨æ€&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;form class="navbar-form navbar-right"&gt; &lt;div class="form-group"&gt; &lt;div class="input-group"&gt; &lt;input type="text" class="form-control"&gt; &lt;span class="input-group-btn"&gt; &lt;button class="btn btn-default" type="button"&gt;Go!&lt;/button&gt; &lt;/span&gt; &lt;/div&gt; &lt;/div&gt; &lt;/form&gt; &lt;/div&gt; &lt;/div&gt;&lt;/div&gt; 11.4.10 è·¯å¾„å¯¼èˆª12345&lt;ol class="breadcrumb"&gt; &lt;li&gt;&lt;a href="#"&gt;Home&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;Library&lt;/a&gt;&lt;/li&gt; &lt;li class="active"&gt;Data&lt;/li&gt;&lt;/ol&gt; 11.4.11 å·¨å¹•12345&lt;div class="jumbotron"&gt; &lt;div class="container"&gt; ... &lt;/div&gt;&lt;/div&gt; 11.4.12 bootstrap æ¨¡æ€æ¡†1ã€modal å£°æ˜Žä¸€ä¸ªæ¨¡æ€æ¡†2ã€modal-dialog å®šä¹‰æ¨¡æ€æ¡†å°ºå¯¸3ã€modal-lg å®šä¹‰å¤§å°ºå¯¸æ¨¡æ€æ¡†4ã€modal-sm å®šä¹‰å°å°ºå¯¸æ¨¡æ€æ¡†5ã€modal-header6ã€modal-body7ã€modal-footer 123456789101112131415161718&lt;button class="btn btn-primary" data-toggle="modal" data-target="#mymodal"&gt;å¤§å¼¹å‡ºæ¡†æŒ‰é’®&lt;/button&gt;&lt;div class="modal fade" id="mymodal"&gt; &lt;div class="modal-dialog modal-lg"&gt; &lt;div class="modal-content"&gt; &lt;div class="modal-header"&gt; å¤§å°ºå¯¸å¼¹å‡ºæ¡† &lt;/div&gt; &lt;div class="modal-body"&gt; æ¨¡æ€æ¡†ä¸»ä½“ &lt;/div&gt; &lt;div class="modal-footer"&gt; &lt;button type="button" class="btn btn-default" data-dismiss="modal"&gt;Close&lt;/button&gt; &lt;button type="button" class="btn btn-primary"&gt;Save changes&lt;/button&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/div&gt; 11.4.13 bootstrap ä¸‹æ‹‰èœå•1ã€dropdown-toggle2ã€dropdown-menu 12345678910111213&lt;div class="row"&gt; &lt;div class="dropdown"&gt; &lt;div class="btn btn-primary dropdown-toggle" data-toggle="dropdown"&gt; ä¸‹æ‹‰èœå• &lt;span class="caret"&gt;&lt;/span&gt; &lt;/div&gt; &lt;ul class="dropdown-menu"&gt; &lt;li&gt;&lt;a href="#"&gt;èœå•ä¸€&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;èœå•äºŒ&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;èœå•ä¸‰&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;&lt;/div&gt; 11.4.14 bootstrap éšè—ç±»1ã€hidden-xs2ã€hidden-sm3ã€hidden-md4ã€hidden-lg 12. æ­£åˆ™è¡¨è¾¾å¼12.1 ä»€ä¹ˆæ˜¯æ­£åˆ™è¡¨è¾¾å¼èƒ½è®©è®¡ç®—æœºè¯»æ‡‚çš„å­—ç¬¦ä¸²åŒ¹é…è§„åˆ™ã€‚ 12.2 æ­£åˆ™è¡¨è¾¾å¼çš„å†™æ³•var re=new RegExp(â€˜è§„åˆ™â€™, â€˜å¯é€‰å‚æ•°â€™);var re=/è§„åˆ™/å‚æ•°; 12.3 è§„åˆ™ä¸­çš„å­—ç¬¦1ï¼‰æ™®é€šå­—ç¬¦åŒ¹é…ï¼šå¦‚ï¼š/a/ åŒ¹é…å­—ç¬¦ â€˜aâ€™ï¼Œ/a,b/ åŒ¹é…å­—ç¬¦ â€˜a,bâ€™ 2ï¼‰è½¬ä¹‰å­—ç¬¦åŒ¹é…ï¼š\d åŒ¹é…ä¸€ä¸ªæ•°å­—ï¼Œå³0-9\D åŒ¹é…ä¸€ä¸ªéžæ•°å­—ï¼Œå³é™¤äº†0-9\w åŒ¹é…ä¸€ä¸ªå•è¯å­—ç¬¦ï¼ˆå­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼‰\W åŒ¹é…ä»»ä½•éžå•è¯å­—ç¬¦ã€‚ç­‰ä»·äºŽ[^A-Za-z0-9_]\s åŒ¹é…ä¸€ä¸ªç©ºç™½ç¬¦\S åŒ¹é…ä¸€ä¸ªéžç©ºç™½ç¬¦\b åŒ¹é…å•è¯è¾¹ç•Œ\B åŒ¹é…éžå•è¯è¾¹ç•Œ. åŒ¹é…ä¸€ä¸ªä»»æ„å­—ç¬¦ 123456var sTr01 = '123456asdf';var re01 = /\d+/;//åŒ¹é…çº¯æ•°å­—å­—ç¬¦ä¸²var re02 = /^\d+$/;alert(re01.test(sTr01)); //å¼¹å‡ºtruealert(re02.test(sTr01)); //å¼¹å‡ºfalse 12.4 é‡è¯ï¼šå¯¹å·¦è¾¹çš„åŒ¹é…å­—ç¬¦å®šä¹‰ä¸ªæ•°? å‡ºçŽ°é›¶æ¬¡æˆ–ä¸€æ¬¡ï¼ˆæœ€å¤šå‡ºçŽ°ä¸€æ¬¡ï¼‰+ å‡ºçŽ°ä¸€æ¬¡æˆ–å¤šæ¬¡ï¼ˆè‡³å°‘å‡ºçŽ°ä¸€æ¬¡ï¼‰* å‡ºçŽ°é›¶æ¬¡æˆ–å¤šæ¬¡ï¼ˆä»»æ„æ¬¡ï¼‰{n} å‡ºçŽ°næ¬¡{n,m} å‡ºçŽ°nåˆ°mæ¬¡{n,} è‡³å°‘å‡ºçŽ°næ¬¡ 12.5 ä»»æ„ä¸€ä¸ªæˆ–è€…èŒƒå›´[abc123] : åŒ¹é…â€˜abc123â€™ä¸­çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦[a-z0-9] : åŒ¹é…aåˆ°zæˆ–è€…0åˆ°9ä¸­çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ 12.6 é™åˆ¶å¼€å¤´ç»“å°¾^ ä»¥ç´§æŒ¨çš„å…ƒç´ å¼€å¤´$ ä»¥ç´§æŒ¨çš„å…ƒç´ ç»“å°¾ 12.7 ä¿®é¥°å‚æ•°gï¼š globalï¼Œå…¨æ–‡æœç´¢ï¼Œé»˜è®¤æœç´¢åˆ°ç¬¬ä¸€ä¸ªç»“æžœæŽ¥åœæ­¢iï¼š ingore caseï¼Œå¿½ç•¥å¤§å°å†™ï¼Œé»˜è®¤å¤§å°å†™æ•æ„Ÿ 12.8 å¸¸ç”¨å‡½æ•°1ã€testç”¨æ³•ï¼šæ­£åˆ™.test(å­—ç¬¦ä¸²) åŒ¹é…æˆåŠŸï¼Œå°±è¿”å›žçœŸï¼Œå¦åˆ™å°±è¿”å›žå‡ 2ã€replaceç”¨æ³•ï¼šå­—ç¬¦ä¸².replace(æ­£åˆ™ï¼Œæ–°çš„å­—ç¬¦ä¸²) åŒ¹é…æˆåŠŸçš„å­—ç¬¦åŽ»æ›¿æ¢æ–°çš„å­—ç¬¦ 12.9 æ­£åˆ™é»˜è®¤è§„åˆ™åŒ¹é…æˆåŠŸå°±ç»“æŸï¼Œä¸ä¼šç»§ç»­åŒ¹é…ï¼ŒåŒºåˆ†å¤§å°å†™ 1234567891011var sTr01 = 'abcdefedcbaCef';var re01 = /c/;var re02 = /c/g;var re03 = /c/gi;var sTr02 = sTr01.replace(re01,'*');var sTr03 = sTr01.replace(re02,'*');var sTr04 = sTr01.replace(re03,'*');alert(sTr02); // å¼¹å‡º ab*defedcbaCefalert(sTr03); // å¼¹å‡º ab*defed*baCefalert(sTr04); // å¼¹å‡º ab*defed*ba*ef 12.10 å¸¸ç”¨æ­£åˆ™è§„åˆ™1234567891011//ç”¨æˆ·åéªŒè¯ï¼š(æ•°å­—å­—æ¯æˆ–ä¸‹åˆ’çº¿6åˆ°20ä½)var reUser = /^\w&#123;6,20&#125;$/;//é‚®ç®±éªŒè¯ï¼š var reMail = /^[a-z0-9][\w\.\-]*@[a-z0-9\-]+(\.[a-z]&#123;2,5&#125;)&#123;1,2&#125;$/i;//å¯†ç éªŒè¯ï¼švar rePass = /^[\w!@#$%^&amp;*]&#123;6,20&#125;$/;//æ‰‹æœºå·ç éªŒè¯ï¼švar rePhone = /^1[3458]\d&#123;9&#125;$/; 13. å‰ç«¯æ€§èƒ½ä¼˜åŒ–ä»Žç”¨æˆ·è®¿é—®èµ„æºåˆ°èµ„æºå®Œæ•´çš„å±•çŽ°åœ¨ç”¨æˆ·é¢å‰çš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡æŠ€æœ¯æ‰‹æ®µå’Œä¼˜åŒ–ç­–ç•¥ï¼Œç¼©çŸ­æ¯ä¸ªæ­¥éª¤çš„å¤„ç†æ—¶é—´ä»Žè€Œæå‡æ•´ä¸ªèµ„æºçš„è®¿é—®å’Œå‘ˆçŽ°é€Ÿåº¦ã€‚ç½‘ç«™çš„æ€§èƒ½ç›´æŽ¥ä¼šå½±å“åˆ°ç”¨æˆ·çš„æ•°é‡ï¼Œæ‰€æœ‰å‰ç«¯æ€§èƒ½ä¼˜åŒ–å¾ˆé‡è¦ã€‚ å‰ç«¯æ€§èƒ½ä¼˜åŒ–åˆ†ä¸ºå¦‚ä¸‹å‡ ä¸ªæ–¹é¢ï¼š 13.1ä»£ç éƒ¨ç½²1ã€ä»£ç çš„åŽ‹ç¼©ä¸Žåˆå¹¶2ã€å›¾ç‰‡ã€jsã€cssç­‰é™æ€èµ„æºä½¿ç”¨å’Œä¸»ç«™ä¸åŒåŸŸååœ°å€å­˜å‚¨ï¼Œä»Žè€Œä½¿å¾—åœ¨ä¼ è¾“èµ„æºæ—¶ä¸ä¼šå¸¦ä¸Šä¸å¿…è¦çš„cookieä¿¡æ¯ã€‚3ã€ä½¿ç”¨å†…å®¹åˆ†å‘ç½‘ç»œ CDN4ã€ä¸ºæ–‡ä»¶è®¾ç½®Last-Modifiedã€Expireså’ŒEtag5ã€ä½¿ç”¨GZIPåŽ‹ç¼©ä¼ é€6ã€æƒè¡¡DNSæŸ¥æ‰¾æ¬¡æ•°(ä½¿ç”¨ä¸åŒåŸŸåä¼šå¢žåŠ DNSæŸ¥æ‰¾)7ã€é¿å…ä¸å¿…è¦çš„é‡å®šå‘(åŠ â€/â€œ) 13.2 ç¼–ç 13.2.1 html1ã€ä½¿ç”¨ç»“æž„æ¸…æ™°ï¼Œç®€å•ï¼Œè¯­ä¹‰åŒ–æ ‡ç­¾2ã€é¿å…ç©ºçš„srcå’Œhref3ã€ä¸è¦åœ¨HTMLä¸­ç¼©æ”¾å›¾ç‰‡ 13.2.2 css1ã€ç²¾ç®€cssé€‰æ‹©å™¨2ã€æŠŠCSSæ”¾åˆ°é¡¶éƒ¨3ã€é¿å…@importæ–¹å¼å¼•å…¥æ ·å¼4ã€cssä¸­ä½¿ç”¨base64å›¾ç‰‡æ•°æ®å–ä»£å›¾ç‰‡æ–‡ä»¶ï¼Œå‡å°‘è¯·æ±‚æ•°ï¼Œåœ¨çº¿è½¬base64ç½‘ç«™ï¼šhttp://tool.css-js.com/base64.html5ã€ä½¿ç”¨cssåŠ¨ç”»æ¥å–ä»£javascriptåŠ¨ç”»6ã€ä½¿ç”¨å­—ä½“å›¾æ ‡7ã€ä½¿ç”¨css sprite(é›ªç¢§å›¾)8ã€ä½¿ç”¨svgå›¾å½¢9ã€é¿å…ä½¿ç”¨CSSè¡¨è¾¾å¼ 123body&#123; background-color: expression( (new Date()).getSeconds()%2 ? "#B8D4FF" : "#F08A00" ); &#125; 10ã€é¿å…ä½¿ç”¨cssæ»¤é•œ 13.2.3 javascript1ã€å‡å°‘å¼•ç”¨åº“çš„ä¸ªæ•°2ã€ä½¿ç”¨requirejsæˆ–seajså¼‚æ­¥åŠ è½½js3ã€JSæ”¾åˆ°é¡µé¢åº•éƒ¨å¼•å…¥4ã€é¿å…å…¨å±€æŸ¥æ‰¾5ã€ä½¿ç”¨åŽŸç”Ÿæ–¹æ³•6ã€ç”¨switchè¯­å¥ä»£æ›¿å¤æ‚çš„if elseè¯­å¥7ã€å‡å°‘è¯­å¥æ•°ï¼Œæ¯”å¦‚è¯´å¤šä¸ªå˜é‡å£°æ˜Žå¯ä»¥å†™æˆä¸€å¥8ã€ä½¿ç”¨å­—é¢é‡è¡¨è¾¾å¼æ¥åˆå§‹åŒ–æ•°ç»„æˆ–è€…å¯¹è±¡9ã€ä½¿ç”¨innerHTMLå–ä»£å¤æ‚çš„å…ƒç´ æ³¨å…¥10ã€ä½¿ç”¨äº‹ä»¶ä»£ç†(äº‹ä»¶å§”æ‰˜)11ã€é¿å…å¤šæ¬¡è®¿é—®domé€‰æ‹©é›†12ã€é«˜é¢‘è§¦å‘äº‹ä»¶è®¾ç½®ä½¿ç”¨å‡½æ•°èŠ‚æµ13ã€ä½¿ç”¨Web Storageç¼“å­˜æ•°æ®]]></content>
      <categories>
        <category>HTML&amp;CSS&amp;JavaScript|JQuery</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
        <tag>HTML</tag>
        <tag>CSS</tag>
        <tag>JQuery</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨ncä¼ è¾“è¶…å¤§æ–‡ä»¶]]></title>
    <url>%2F2019%2F12%2F31%2F%E4%BD%BF%E7%94%A8nc%E4%BC%A0%E8%BE%93%E8%B6%85%E5%A4%A7%E6%96%87%E4%BB%B6%2F</url>
    <content type="text"><![CDATA[è¯´æ˜Žlinuxä¸‹çš„æ–‡ä»¶ä¼ è¾“ï¼Œå¤§å®¶é¦–å…ˆä¼šæƒ³åˆ°rsyncã€scpä¹‹ç±»çš„å·¥å…·ï¼Œä½†è¿™ç±»å·¥å…·æœ‰ä¸€ä¸ªç‰¹ç‚¹â€”â€”æ…¢ï¼Œ å› ä¸ºè¿™ç±»å·¥å…·éƒ½æ˜¯åŠ å¯†ä¼ è¾“ï¼Œå‘é€ç«¯åŠ å¯†ï¼ŒæŽ¥æ”¶ç«¯è§£å¯†ï¼Œå½“æˆ‘ä»¬ä¼ è¾“ä¸€äº›éžæ•æ„Ÿæ–‡ä»¶çš„æ—¶å€™ï¼Œå®Œå…¨å¯ä»¥ä¸åŠ å¯†ï¼Œç›´æŽ¥åœ¨ç½‘ç»œä¸Šä¼ è¾“ã€‚ å®‰è£…1. linuxç³»ç»Ÿå®‰è£… # yum install -y nc | nmap-ncat ps.ubuntuè‡ªå¸¦çš„ncæ˜¯netcat-openbsdç‰ˆ,ä¸å¸¦-c/-eå‚æ•°ã€‚ 2. windowsç³»ç»Ÿå®‰è£… (1)ä¸‹è½½ ä¸‹è½½netcatã€‚ä¸‹è½½åœ°å€ï¼šhttps://eternallybored.org/misc/netcat/, (2)è§£åŽ‹æ–‡ä»¶å¤¹ (3)å°†æ–‡ä»¶å¤¹æ‰€åœ¨è·¯å¾„æ·»åŠ åˆ°ç”¨æˆ·çŽ¯å¢ƒå˜é‡é‡Œ (4)æ‰“å¼€å‘½ä»¤ç•Œé¢ï¼šWindows+R cmdã€‚è¾“å…¥nc å‘½ä»¤å³å¯ å‚æ•°æƒ³è¦è¿žæŽ¥åˆ°æŸå¤„: nc [-options] hostname port[s] [ports] â€¦ ç»‘å®šç«¯å£ç­‰å¾…è¿žæŽ¥: nc -l port [-options] [hostname] [port] -g&lt;ç½‘å…³&gt;ï¼šè®¾ç½®è·¯ç”±å™¨è·ƒç¨‹é€šä¿¡ç½‘å…³ï¼Œæœ€å¤šè®¾ç½®8ä¸ª; -G&lt;æŒ‡å‘å™¨æ•°ç›®&gt;ï¼šè®¾ç½®æ¥æºè·¯ç”±æŒ‡å‘å™¨ï¼Œå…¶æ•°å€¼ä¸º4çš„å€æ•°; -hï¼šåœ¨çº¿å¸®åŠ©; -i&lt;å»¶è¿Ÿç§’æ•°&gt;ï¼šè®¾ç½®æ—¶é—´é—´éš”ï¼Œä»¥ä¾¿ä¼ é€ä¿¡æ¯åŠæ‰«æé€šä¿¡ç«¯å£; -lï¼šä½¿ç”¨ç›‘å¬æ¨¡å¼ï¼Œç›‘æŽ§ä¼ å…¥çš„èµ„æ–™; -nï¼šç›´æŽ¥ä½¿ç”¨ipåœ°å€ï¼Œè€Œä¸é€šè¿‡åŸŸåæœåŠ¡å™¨; -o&lt;è¾“å‡ºæ–‡ä»¶&gt;ï¼šæŒ‡å®šæ–‡ä»¶åç§°ï¼ŒæŠŠå¾€æ¥ä¼ è¾“çš„æ•°æ®ä»¥16è¿›åˆ¶å­—ç å€¾å€’æˆè¯¥æ–‡ä»¶ä¿å­˜; -p&lt;é€šä¿¡ç«¯å£&gt;ï¼šè®¾ç½®æœ¬åœ°ä¸»æœºä½¿ç”¨çš„é€šä¿¡ç«¯å£; -rï¼šæŒ‡å®šæºç«¯å£å’Œç›®çš„ç«¯å£éƒ½è¿›è¡Œéšæœºçš„é€‰æ‹©; -s&lt;æ¥æºä½å€&gt;ï¼šè®¾ç½®æœ¬åœ°ä¸»æœºé€å‡ºæ•°æ®åŒ…çš„IPåœ°å€; -uï¼šä½¿ç”¨UDPä¼ è¾“åè®®; -vï¼šæ˜¾ç¤ºæŒ‡ä»¤æ‰§è¡Œè¿‡ç¨‹; -w&lt;è¶…æ—¶ç§’æ•°&gt;ï¼šè®¾ç½®ç­‰å¾…è¿žçº¿çš„æ—¶é—´; -zï¼šä½¿ç”¨0è¾“å…¥/è¾“å‡ºæ¨¡å¼ï¼Œåªåœ¨æ‰«æé€šä¿¡ç«¯å£æ—¶ä½¿ç”¨ã€‚ ç”¨æ³•è¿žæŽ¥è¿œç¨‹ä¸»æœºClientè¿žæŽ¥åˆ°Serverçš„TCP 80ç«¯å£: $nc -nvv 192.168.x.x 8000 Serverç›‘å¬æœ¬æœºçš„TCP8000ç«¯å£: $nc -l 8000 è¶…æ—¶æŽ§åˆ¶: å¤šæ•°æƒ…å†µæˆ‘ä»¬ä¸å¸Œæœ›è¿žæŽ¥ä¸€ç›´ä¿æŒï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ -w å‚æ•°æ¥æŒ‡å®šè¿žæŽ¥çš„ç©ºé—²è¶…æ—¶æ—¶é—´ï¼Œè¯¥å‚æ•°ç´§æŽ¥ä¸€ä¸ªæ•°å€¼ï¼Œä»£è¡¨ç§’æ•°ï¼Œå¦‚æžœè¿žæŽ¥è¶…è¿‡æŒ‡å®šæ—¶é—´åˆ™è¿žæŽ¥ä¼šè¢«ç»ˆæ­¢ã€‚ Server: $nc -l 2389 Client: $nc -w 10 localhost 2389 è¯¥è¿žæŽ¥å°†åœ¨ 10 ç§’åŽä¸­æ–­ã€‚æ³¨æ„: ä¸è¦åœ¨æœåŠ¡å™¨ç«¯åŒæ—¶ä½¿ç”¨ -w å’Œ -l å‚æ•°ï¼Œå› ä¸º -w å‚æ•°å°†åœ¨æœåŠ¡å™¨ç«¯æ— æ•ˆæžœã€‚ ç«¯å£æ‰«æç«¯å£æ‰«æç»å¸¸è¢«ç³»ç»Ÿç®¡ç†å‘˜å’Œé»‘å®¢ç”¨æ¥å‘çŽ°åœ¨ä¸€äº›æœºå™¨ä¸Šå¼€æ”¾çš„ç«¯å£ï¼Œå¸®åŠ©ä»–ä»¬è¯†åˆ«ç³»ç»Ÿä¸­çš„æ¼æ´žã€‚ $nc -z -v -n 192.168.1.1 21-25 å¯ä»¥è¿è¡Œåœ¨TCPæˆ–è€…UDPæ¨¡å¼ï¼Œé»˜è®¤æ˜¯TCPï¼Œ-uå‚æ•°è°ƒæ•´ä¸ºudp. z å‚æ•°å‘Šè¯‰netcatä½¿ç”¨0 IO,è¿žæŽ¥æˆåŠŸåŽç«‹å³å…³é—­è¿žæŽ¥ï¼Œ ä¸è¿›è¡Œæ•°æ®äº¤æ¢. v å‚æ•°æŒ‡è¯¦ç»†è¾“å‡º. n å‚æ•°å‘Šè¯‰netcat ä¸è¦ä½¿ç”¨DNSåå‘æŸ¥è¯¢IPåœ°å€çš„åŸŸå. ä»¥ä¸Šå‘½ä»¤ä¼šæ‰“å°21åˆ°25 æ‰€æœ‰å¼€æ”¾çš„ç«¯å£ã€‚ $nc -v 127.0.0.1 22 localhost [127.0.0.1] 22 (ssh) open SSH-2.0-OpenSSH_5.9p1 Debian-5ubuntu1.4 &quot;SSH-2.0-OpenSSH_5.9p1 Debian-5ubuntu1.4&quot;ä¸ºBannerä¿¡æ¯ã€‚ Banneræ˜¯ä¸€ä¸ªæ–‡æœ¬ï¼ŒBanneræ˜¯ä¸€ä¸ªä½ è¿žæŽ¥çš„æœåŠ¡å‘é€ç»™ä½ çš„æ–‡æœ¬ä¿¡æ¯ã€‚å½“ä½ è¯•å›¾é‰´åˆ«æ¼æ´žæˆ–è€…æœåŠ¡çš„ç±»åž‹å’Œç‰ˆæœ¬çš„æ—¶å€™ï¼ŒBannerä¿¡æ¯æ˜¯éžå¸¸æœ‰ç”¨çš„ã€‚ ä½†æ˜¯ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„æœåŠ¡éƒ½ä¼šå‘é€banner.ä¸€æ—¦ä½ å‘çŽ°å¼€æ”¾çš„ç«¯å£ï¼Œä½ å¯ä»¥å®¹æ˜“çš„ä½¿ç”¨netcat è¿žæŽ¥æœåŠ¡æŠ“å–ä»–ä»¬çš„bannerã€‚ Chat Serverå†…ç½‘èŠå¤©,netcatæä¾›äº†è¿™æ ·ä¸€ç§æ–¹æ³•ï¼Œåªéœ€è¦åˆ›å»ºä¸€ä¸ªChatæœåŠ¡å™¨ï¼Œä¸€ä¸ªé¢„å…ˆç¡®å®šå¥½çš„ç«¯å£ï¼Œè¿™æ ·å­å°±å¯ä»¥åœ¨å†…ç½‘èŠå¤©æ²Ÿé€šäº†. Server: $nc -l 20000 netcat å‘½ä»¤åœ¨20000ç«¯å£å¯åŠ¨äº†ä¸€ä¸ªtcp æœåŠ¡å™¨ï¼Œæ‰€æœ‰çš„æ ‡å‡†è¾“å‡ºå’Œè¾“å…¥ä¼šè¾“å‡ºåˆ°è¯¥ç«¯å£ã€‚è¾“å‡ºå’Œè¾“å…¥éƒ½åœ¨æ­¤shellä¸­å±•ç¤ºã€‚ Client:$nc 192.168.1.1 20000 ä¸ç®¡ä½ åœ¨æœºå™¨Clientä¸Šé”®å…¥ä»€ä¹ˆéƒ½ä¼šå‡ºçŽ°åœ¨æœºå™¨Serverä¸Šã€‚ æ–‡ä»¶ä¼ è¾“linuxä¸‹çš„æ–‡ä»¶ä¼ è¾“ï¼Œå¤§å®¶é¦–å…ˆä¼šæƒ³åˆ°rsyncã€scpä¹‹ç±»çš„å·¥å…·ï¼Œä½†è¿™ç±»å·¥å…·æœ‰ä¸€ä¸ªç‰¹ç‚¹â€”â€”æ…¢ï¼Œå› ä¸ºè¿™ç±»å·¥å…·éƒ½æ˜¯åŠ å¯†ä¼ è¾“ï¼Œå‘é€ç«¯åŠ å¯†ï¼ŒæŽ¥æ”¶ç«¯è§£å¯†ï¼Œå½“æˆ‘ä»¬ä¼ è¾“ä¸€äº›éžæ•æ„Ÿæ–‡ä»¶çš„æ—¶å€™ï¼Œå®Œå…¨å¯ä»¥ä¸åŠ å¯†ï¼Œç›´æŽ¥åœ¨ç½‘ç»œä¸Šä¼ è¾“ã€‚ Server: $ time nc -l 20000 &lt; file.txt å‘½ä»¤æœ€å‰é¢çš„timeæ˜¯ç”¨æ¥æ£€æµ‹è¯¥å‘½ä»¤è¿è¡Œè€—æ—¶çš„ã€‚ Client: $nc -n 192.168.1.1 20000 &gt; file.txt æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæœåŠ¡å™¨åœ¨Aä¸Šå¹¶ä¸”é‡å®šå‘netcatçš„è¾“å…¥ä¸ºæ–‡ä»¶file.txtï¼Œé‚£ä¹ˆå½“ä»»ä½•æˆåŠŸè¿žæŽ¥åˆ°è¯¥ç«¯å£ï¼Œnetcatä¼šå‘é€fileçš„æ–‡ä»¶å†…å®¹ã€‚ åœ¨å®¢æˆ·ç«¯æˆ‘ä»¬é‡å®šå‘è¾“å‡ºåˆ°file.txtï¼Œå½“Bè¿žæŽ¥åˆ°Aï¼ŒAå‘é€æ–‡ä»¶å†…å®¹ï¼ŒBä¿å­˜æ–‡ä»¶å†…å®¹åˆ°file.txt.æ²¡æœ‰å¿…è¦åˆ›å»ºæ–‡ä»¶æºä½œä¸ºServerï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›¸åçš„æ–¹æ³•ä½¿ç”¨ã€‚ åƒä¸‹é¢çš„æˆ‘ä»¬å‘é€æ–‡ä»¶ä»ŽBåˆ°Aï¼Œä½†æ˜¯æœåŠ¡å™¨åˆ›å»ºåœ¨Aä¸Šï¼Œè¿™æ¬¡æˆ‘ä»¬ä»…éœ€è¦é‡å®šå‘netcatçš„è¾“å‡ºå¹¶ä¸”é‡å®šå‘Bçš„è¾“å…¥æ–‡ä»¶ã€‚ Bä½œä¸ºServer Server: $nc -l 20000 &gt; file.txt Client: $nc 192.168.1.2 20000 &lt; file.txt ç”¨ncä¼ è¾“æœ‰ä¸¤ä¸ªç‰¹ç‚¹ï¼š âž¤é€Ÿåº¦å¿« âž¤ä¼ è¾“ç®€å•ï¼Œä¸éœ€è¦ç™»å½•å¯¹æ–¹æœåŠ¡å™¨ï¼Œä¸éœ€è¦éªŒè¯ä¿¡æ¯ã€‚ ncè¿›åº¦æ˜¾ç¤º è‹¥ä½ æ–‡ä»¶å®žåœ¨å¤ªå¤§ï¼Œæƒ³çœ‹åˆ°ä¼ è¾“è¿›åº¦ï¼Œç”¨PV yum install epel-release -y yum install pv -y cat file.txt |pv -b | nc 192.168.1.1 20000 ä¸­è½¬æ–‡ä»¶Aã€Bã€Cä¸‰å°ä¸»æœºï¼ŒAç¾Žå›½ï¼ŒCæ—¥æœ¬ï¼ŒCåªèƒ½è®¿é—®åˆ°Bï¼Œä¸èƒ½ç›´æŽ¥è®¿é—®Aï¼ŒBå’ŒACäº’é€šã€‚Cè¦æ€Žä¹ˆæ‰èƒ½æ‹¿åˆ°Aä¸Šçš„æ–‡ä»¶å‘¢ï¼Ÿ Cä¸Šæ‰§è¡Œï¼šnc -l 9999 &gt; google_file.txt Bä¸Šæ‰§è¡Œï¼šnc -l 9999 | nc (Cçš„å¤–ç½‘IP) 9999 Aä¸Šæ‰§è¡Œï¼šnc (Bçš„å¤–ç½‘IP) 9999 &lt; google_file.txt ç›®å½•ä¼ è¾“æƒ³è¦å‘é€å¤šä¸ªæ–‡ä»¶ï¼Œæˆ–è€…æ•´ä¸ªç›®å½•ï¼Œä¸€æ ·å¾ˆç®€å•ï¼Œåªéœ€è¦ä½¿ç”¨åŽ‹ç¼©å·¥å…·tarï¼ŒåŽ‹ç¼©åŽå‘é€åŽ‹ç¼©åŒ…ã€‚ å¦‚æžœä½ æƒ³è¦é€šè¿‡ç½‘ç»œä¼ è¾“ä¸€ä¸ªç›®å½•ä»ŽAåˆ°Bã€‚ Server: $tar -cvf â€“ dir_name | nc -l 20000 Client: $nc -n 192.168.1.1 20000 | tar -xvf - åœ¨AæœåŠ¡å™¨ä¸Šï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªtarå½’æ¡£åŒ…å¹¶ä¸”é€šè¿‡-åœ¨æŽ§åˆ¶å°é‡å®šå‘å®ƒï¼Œç„¶åŽä½¿ç”¨ç®¡é“ï¼Œé‡å®šå‘ç»™netcatï¼Œnetcatå¯ä»¥é€šè¿‡ç½‘ç»œå‘é€å®ƒã€‚ åœ¨å®¢æˆ·ç«¯æˆ‘ä»¬ä¸‹è½½è¯¥åŽ‹ç¼©åŒ…é€šè¿‡netcat ç®¡é“ç„¶åŽæ‰“å¼€æ–‡ä»¶ã€‚ å¦‚æžœæƒ³è¦èŠ‚çœå¸¦å®½ä¼ è¾“åŽ‹ç¼©åŒ…ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨bzip2æˆ–è€…å…¶ä»–å·¥å…·åŽ‹ç¼©ã€‚ Server: $tar -cvf â€“ dir_name| bzip2 -z | nc -l 20000 é€šè¿‡bzip2åŽ‹ç¼© Client: $nc -n 192.168.1.1 20000 | bzip2 -d |tar -xvf - è¿˜å¯ä»¥æŠŠç›®å½•åˆ¶ä½œæˆisoæ–‡ä»¶è¿›è¡Œä¼ è¾“ $ yum install mkisofs mkisofs -r -o è·¯å¾„/ISO æ–‡ä»¶å ç›®å½•æ–‡ä»¶è·¯å¾„ ä¾‹å­ï¼šmkisofs -r -o /opt/mycd.iso /home åŠ å¯†é€šè¿‡ç½‘ç»œå‘é€çš„æ•°æ®å¦‚æžœæ‹…å¿ƒä½ åœ¨ç½‘ç»œä¸Šå‘é€æ•°æ®çš„å®‰å…¨ï¼Œå¯ä»¥åœ¨å‘é€ä½ çš„æ•°æ®ä¹‹å‰ç”¨å¦‚mcryptçš„å·¥å…·åŠ å¯†ã€‚ ä½¿ç”¨mcryptå·¥å…·åŠ å¯†æ•°æ®ã€‚ Server: $nc localhost 20000 | mcrypt â€“flush â€“bare -F -q -d -m ecb &gt; file.txt ä½¿ç”¨mcryptå·¥å…·è§£å¯†æ•°æ®ã€‚ Client: $mcrypt â€“flush â€“bare -F -q -m ecb &lt; file.txt | nc -l 20000 ä»¥ä¸Šä¸¤ä¸ªå‘½ä»¤ä¼šæç¤ºéœ€è¦å¯†ç ï¼Œç¡®ä¿ä¸¤ç«¯ä½¿ç”¨ç›¸åŒçš„å¯†ç ã€‚ è¿™é‡Œæˆ‘ä»¬æ˜¯ä½¿ç”¨mcryptç”¨æ¥åŠ å¯†ï¼Œä½¿ç”¨å…¶å®ƒä»»æ„åŠ å¯†å·¥å…·éƒ½å¯ä»¥ã€‚ æµè§†é¢‘è™½ç„¶ä¸æ˜¯ç”Ÿæˆæµè§†é¢‘çš„æœ€å¥½æ–¹æ³•ï¼Œä½†å¦‚æžœæœåŠ¡å™¨ä¸Šæ²¡æœ‰ç‰¹å®šçš„å·¥å…·ï¼Œä½¿ç”¨netcatï¼Œæˆ‘ä»¬ä»ç„¶æœ‰å¸Œæœ›åšæˆè¿™ä»¶äº‹ã€‚ è¿™é‡Œæˆ‘ä»¬åªæ˜¯ä»Žä¸€ä¸ªè§†é¢‘æ–‡ä»¶ä¸­è¯»å…¥å¹¶é‡å®šå‘è¾“å‡ºåˆ°netcatå®¢æˆ·ç«¯ Server: $cat video.avi | nc -l 20000 è¿™é‡Œæˆ‘ä»¬ä»Žsocketä¸­è¯»å…¥æ•°æ®å¹¶é‡å®šå‘åˆ°mplayerã€‚ Client: $nc 192.168.1.1 20000 | mplayer -vo x11 -cache 3000 - å…‹éš†ä¸€ä¸ªè®¾å¤‡å¦‚æžœä½ å·²ç»å®‰è£…é…ç½®ä¸€å°Linuxæœºå™¨å¹¶ä¸”éœ€è¦é‡å¤åŒæ ·çš„æ“ä½œå¯¹å…¶ä»–çš„æœºå™¨ï¼Œè€Œä½ ä¸æƒ³åœ¨é‡å¤é…ç½®ä¸€éã€‚ ä¸åœ¨éœ€è¦é‡å¤é…ç½®å®‰è£…çš„è¿‡ç¨‹ï¼Œåªå¯åŠ¨å¦ä¸€å°æœºå™¨çš„ä¸€äº›å¼•å¯¼å¯ä»¥éšèº«ç¢Ÿå’Œå…‹éš†ä½ çš„æœºå™¨ã€‚ å…‹éš†Linux PCå¾ˆç®€å•ï¼Œå‡å¦‚ä½ çš„ç³»ç»Ÿåœ¨ç£ç›˜/dev/sdaä¸Š Server: $dd if=/dev/sda | nc -l 20000 Client: $nc -n 192.168.1.1 20000 | dd of=/dev/sda ddæ˜¯ä¸€ä¸ªä»Žç£ç›˜è¯»å–åŽŸå§‹æ•°æ®çš„å·¥å…·ï¼Œæˆ‘é€šè¿‡netcatæœåŠ¡å™¨é‡å®šå‘å®ƒçš„è¾“å‡ºæµåˆ°å…¶ä»–æœºå™¨å¹¶ä¸”å†™å…¥åˆ°ç£ç›˜ä¸­ï¼Œå®ƒä¼šéšç€åˆ†åŒºè¡¨æ‹·è´æ‰€æœ‰çš„ä¿¡æ¯ã€‚ ä½†æ˜¯å¦‚æžœæˆ‘ä»¬å·²ç»åšè¿‡åˆ†åŒºå¹¶ä¸”åªéœ€è¦å…‹éš†rootåˆ†åŒºï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®æˆ‘ä»¬ç³»ç»Ÿrootåˆ†åŒºçš„ä½ç½®ï¼Œæ›´æ”¹sda ä¸ºsda1ï¼Œsda2.ç­‰ç­‰ã€‚ æ‰“å¼€ä¸€ä¸ªshellå‡è®¾ä½ çš„netcatæ”¯æŒ -c -e å‚æ•°(åŽŸç”Ÿ netcat) Server: $nc -l 20000 -e /bin/bash -i Client: $nc 192.168.1.1 20000 è¿™é‡Œæˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ªnetcatæœåŠ¡å™¨å¹¶ä¸”è¡¨ç¤ºå½“å®ƒè¿žæŽ¥æˆåŠŸæ—¶æ‰§è¡Œ/bin/bash å‡å¦‚netcat ä¸æ”¯æŒ-c æˆ–è€… -e å‚æ•°ï¼ˆopenbsd netcatï¼‰,æˆ‘ä»¬ä»ç„¶èƒ½å¤Ÿåˆ›å»ºè¿œç¨‹shell Server: $mkfifo /tmp/tmp_fifo $cat /tmp/tmp_fifo | /bin/sh -i 2&gt;&amp;1 | nc -l 20000 &gt; /tmp/tmp_fifo è¿™é‡Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªfifoæ–‡ä»¶ï¼Œç„¶åŽä½¿ç”¨ç®¡é“å‘½ä»¤æŠŠè¿™ä¸ªfifoæ–‡ä»¶å†…å®¹å®šå‘åˆ°shell 2&gt;&amp;1ä¸­ã€‚ 2&gt;&amp;1æ˜¯ç”¨æ¥é‡å®šå‘æ ‡å‡†é”™è¯¯è¾“å‡ºå’Œæ ‡å‡†è¾“å‡ºï¼Œç„¶åŽç®¡é“åˆ°netcat è¿è¡Œçš„ç«¯å£20000ä¸Šã€‚è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»æŠŠnetcatçš„è¾“å‡ºé‡å®šå‘åˆ°fifoæ–‡ä»¶ä¸­ã€‚ è¯´æ˜Žï¼š ä»Žç½‘ç»œæ”¶åˆ°çš„è¾“å…¥å†™åˆ°fifoæ–‡ä»¶ä¸­ cat å‘½ä»¤è¯»å–fifoæ–‡ä»¶å¹¶ä¸”å…¶å†…å®¹å‘é€ç»™shå‘½ä»¤ shå‘½ä»¤è¿›ç¨‹å—åˆ°è¾“å…¥å¹¶æŠŠå®ƒå†™å›žåˆ°netcatã€‚ netcat é€šè¿‡ç½‘ç»œå‘é€è¾“å‡ºåˆ°client è‡³äºŽä¸ºä»€ä¹ˆä¼šæˆåŠŸæ˜¯å› ä¸ºç®¡é“ä½¿å‘½ä»¤å¹³è¡Œæ‰§è¡Œï¼Œfifoæ–‡ä»¶ç”¨æ¥æ›¿ä»£æ­£å¸¸æ–‡ä»¶ï¼Œå› ä¸ºfifoä½¿è¯»å–ç­‰å¾…è€Œå¦‚æžœæ˜¯ä¸€ä¸ªæ™®é€šæ–‡ä»¶ï¼Œcatå‘½ä»¤ä¼šå°½å¿«ç»“æŸå¹¶å¼€å§‹è¯»å–ç©ºæ–‡ä»¶ã€‚ åœ¨å®¢æˆ·ç«¯ä»…ä»…ç®€å•è¿žæŽ¥åˆ°æœåŠ¡å™¨ Client: $nc -n 192.168.1.1 20000 ä½ ä¼šå¾—åˆ°ä¸€ä¸ªshellæç¤ºç¬¦åœ¨å®¢æˆ·ç«¯ åå‘shellåå‘shellæ˜¯æŒ‡åœ¨å®¢æˆ·ç«¯æ‰“å¼€çš„shellã€‚åå‘shellè¿™æ ·å‘½åæ˜¯å› ä¸ºä¸åŒäºŽå…¶ä»–é…ç½®ï¼Œè¿™é‡ŒæœåŠ¡å™¨ä½¿ç”¨çš„æ˜¯ç”±å®¢æˆ·æä¾›çš„æœåŠ¡ã€‚ Server: $nc -l 20000 åœ¨å®¢æˆ·ç«¯ï¼Œç®€å•åœ°å‘Šè¯‰netcatåœ¨è¿žæŽ¥å®ŒæˆåŽï¼Œæ‰§è¡Œshellã€‚ Client: $nc 192.168.1.1 20000 -e /bin/bash çŽ°åœ¨ï¼Œä»€ä¹ˆæ˜¯åå‘shellçš„ç‰¹åˆ«ä¹‹å¤„å‘¢ åå‘shellç»å¸¸è¢«ç”¨æ¥ç»•è¿‡é˜²ç«å¢™çš„é™åˆ¶ï¼Œå¦‚é˜»æ­¢å…¥ç«™è¿žæŽ¥ã€‚ ä¾‹å¦‚ï¼Œæˆ‘æœ‰ä¸€ä¸ªä¸“ç”¨IPåœ°å€ä¸º192.168.1.1ï¼Œæˆ‘ä½¿ç”¨ä»£ç†æœåŠ¡å™¨è¿žæŽ¥åˆ°å¤–éƒ¨ç½‘ç»œã€‚å¦‚æžœæˆ‘æƒ³ä»Žç½‘ç»œå¤–éƒ¨è®¿é—® è¿™å°æœºå™¨å¦‚1.2.3.4çš„shellï¼Œé‚£ä¹ˆæˆ‘ä¼šç”¨åå‘å¤–å£³ç”¨äºŽè¿™ä¸€ç›®çš„ã€‚ #### æŒ‡å®šæºç«¯å£å‡è®¾ä½ çš„é˜²ç«å¢™è¿‡æ»¤é™¤25ç«¯å£å¤–å…¶å®ƒæ‰€æœ‰ç«¯å£ï¼Œä½ éœ€è¦ä½¿ç”¨-pé€‰é¡¹æŒ‡å®šæºç«¯å£ã€‚Serverï¼š$nc -l 20000Clientï¼š$nc 192.168.1.1 20000 25ä½¿ç”¨1024ä»¥å†…çš„ç«¯å£éœ€è¦rootæƒé™ã€‚ è¯¥å‘½ä»¤å°†åœ¨å®¢æˆ·ç«¯å¼€å¯25ç«¯å£ç”¨äºŽé€šè®¯ï¼Œå¦åˆ™å°†ä½¿ç”¨éšæœºç«¯å£ã€‚ æŒ‡å®šæºåœ°å€å‡è®¾ä½ çš„æœºå™¨æœ‰å¤šä¸ªåœ°å€ï¼Œå¸Œæœ›æ˜Žç¡®æŒ‡å®šä½¿ç”¨å“ªä¸ªåœ°å€ç”¨äºŽå¤–éƒ¨æ•°æ®é€šè®¯ã€‚æˆ‘ä»¬å¯ä»¥åœ¨netcatä¸­ä½¿ç”¨-sé€‰é¡¹æŒ‡å®šipåœ°å€ã€‚ Server: $nc -u -l 20000 &lt; file.txt Client: $nc -u 192.168.1.1 20000 -s 172.31.100.5 &gt; file.txt è¯¥å‘½ä»¤å°†ç»‘å®šåœ°å€172.31.100.5ã€‚ é™æ€webé¡µé¢æœåŠ¡å™¨æ–°å»ºä¸€ä¸ªç½‘é¡µ,å‘½åä¸ºsomepage.html; æ–°å»ºä¸€ä¸ªshell script: while true; do nc -l 80 -q 1 &lt; somepage.html; done ç”¨rootæƒé™æ‰§è¡Œï¼Œç„¶åŽåœ¨æµè§ˆå™¨ä¸­è¾“å…¥127.0.0.1æ‰“å¼€çœ‹çœ‹æ˜¯å¦æ­£ç¡®è¿è¡Œã€‚ nc æŒ‡ä»¤é€šå¸¸éƒ½æ˜¯ç»™ç®¡ç†è€…è¿›è¡Œé™¤é”™æˆ–æµ‹è¯•ç­‰ä½œç”¨çš„ï¼Œæ‰€ä»¥å¦‚æžœåªæ˜¯å•çº¯éœ€è¦ä¸´æ—¶çš„ç½‘é¡µæœåŠ¡å™¨ï¼Œä½¿ç”¨ Python çš„ SimpleHTTPServer ç»„ä¼šæ¯”è¾ƒæ–¹ä¾¿ã€‚ æ¨¡æ‹ŸHTTP Headers$nc www.huanxiangwu.com 80 GET / HTTP/1.1 Host: ispconfig.org Referrer: mypage.com User-Agent: my-browser HTTP/1.1 200 OK Date: Tue, 16 Dec 2008 07:23:24 GMT Server: Apache/2.2.6 (Unix) DAV/2 mod_mono/1.2.1 mod_python/3.2.8 Python/2.4.3 mod_perl/2.0.2 Perl/v5.8.8 Set-Cookie: PHPSESSID=bbadorbvie1gn037iih6lrdg50; path=/ Expires: 0 Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 Pragma: no-cache Cache-Control: private, post-check=0, pre-check=0, max-age=0 Set-Cookie: oWn_sid=xRutAY; expires=Tue, 23-Dec-2008 07:23:24 GMT; path=/ Vary: Accept-Encoding Transfer-Encoding: chunked Content-Type: text/html [......] åœ¨ncå‘½ä»¤åŽï¼Œè¾“å…¥çº¢è‰²éƒ¨åˆ†çš„å†…å®¹(å‘½ä»¤ä¸‹æ–¹çš„4è¡Œå†…å®¹)ï¼Œç„¶åŽæŒ‰ä¸¤æ¬¡å›žè½¦ï¼Œå³å¯ä»Žå¯¹æ–¹èŽ·å¾—HTTP Headerså†…å®¹ã€‚ Netcatæ”¯æŒIPv6netcat çš„ -4 å’Œ -6 å‚æ•°ç”¨æ¥æŒ‡å®š IP åœ°å€ç±»åž‹ï¼Œåˆ†åˆ«æ˜¯ IPv4 å’Œ IPv6ï¼š Server: $ nc -4 -l 2389 Client: $ nc -4 localhost 2389 ç„¶åŽæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ netstat å‘½ä»¤æ¥æŸ¥çœ‹ç½‘ç»œçš„æƒ…å†µï¼š $ netstat | grep 2389 tcp 0 0 localhost:2389 localhost:50851 ESTABLISHED tcp 0 0 localhost:50851 localhost:2389 ESTABLISHED æŽ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹IPv6 çš„æƒ…å†µï¼š Server: $ nc -6 -l 2389 Client: $ nc -6 localhost 2389 å†æ¬¡è¿è¡Œ netstat å‘½ä»¤ï¼š $ netstat | grep 2389 tcp6 0 0 localhost:2389 localhost:33234 ESTABLISHED tcp6 0 0 localhost:33234 localhost:2389 ESTABLISHED å‰ç¼€æ˜¯ tcp6 è¡¨ç¤ºä½¿ç”¨çš„æ˜¯ IPv6 çš„åœ°å€ã€‚ åœ¨ Netcat ä¸­ç¦æ­¢ä»Žæ ‡å‡†è¾“å…¥ä¸­è¯»å–æ•°æ®è¯¥åŠŸèƒ½ä½¿ç”¨ -d å‚æ•°ï¼Œè¯·çœ‹ä¸‹é¢ä¾‹å­ï¼š Server: $ nc -l 2389 Client: $ nc -d localhost 2389 Hi ä½ è¾“å…¥çš„ Hi æ–‡æœ¬å¹¶ä¸ä¼šé€åˆ°æœåŠ¡å™¨ç«¯ å¼ºåˆ¶ Netcat æœåŠ¡å™¨ç«¯ä¿æŒå¯åŠ¨çŠ¶æ€å¦‚æžœè¿žæŽ¥åˆ°æœåŠ¡å™¨çš„å®¢æˆ·ç«¯æ–­å¼€è¿žæŽ¥ï¼Œé‚£ä¹ˆæœåŠ¡å™¨ç«¯ä¹Ÿä¼šè·Ÿç€é€€å‡ºã€‚ Server: $ nc -l 2389 Client: $ nc localhost 2389 ^C Server: $ nc -l 2389 ä¸Šè¿°ä¾‹å­ä¸­ï¼Œä½†å®¢æˆ·ç«¯æ–­å¼€æ—¶æœåŠ¡å™¨ç«¯ä¹Ÿç«‹å³é€€å‡ºã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡ -k å‚æ•°æ¥æŽ§åˆ¶è®©æœåŠ¡å™¨ä¸ä¼šå› ä¸ºå®¢æˆ·ç«¯çš„æ–­å¼€è¿žæŽ¥è€Œé€€å‡ºã€‚ Server: $ nc -k -l 2389 Client: $ nc localhost 2389 ^C Server: $ nc -k -l 2389 é…ç½® Netcat å®¢æˆ·ç«¯ä¸ä¼šå› ä¸º EOF è€Œé€€å‡ºNetcat å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡ -q å‚æ•°æ¥æŽ§åˆ¶æŽ¥æ”¶åˆ° EOF åŽéš”å¤šé•¿æ—¶é—´æ‰é€€å‡ºï¼Œè¯¥å‚æ•°çš„å•ä½æ˜¯ç§’ï¼š Client: $nc -q 5 localhost 2389 çŽ°åœ¨å¦‚æžœå®¢æˆ·ç«¯æŽ¥æ”¶åˆ° EOF ï¼Œå®ƒå°†ç­‰å¾… 5 ç§’åŽé€€å‡ºã€‚ æ‰‹åŠ¨ä½¿ç”¨ SMTP åè®®å¯„ä¿¡åœ¨æµ‹è¯•é‚®ä»¶æœåŠ¡å™¨æ˜¯å¦æ­£å¸¸æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™æ ·çš„æ–¹å¼æ‰‹åŠ¨å‘é€ Emailï¼š $nc localhost 25 &lt;&lt; EOF HELO host.example.com MAIL FROM: &lt;user@host.example.com&gt; RCPT TO: &lt;user2@host.example.com&gt; DATA Body of email. . QUIT EOF é€è¿‡ä»£ç†æœåŠ¡å™¨ï¼ˆProxyï¼‰è¿žçº¿è¿™æŒ‡ä»¤ä¼šä½¿ç”¨ 10.2.3.4:8080 è¿™ä¸ªä»£ç†æœåŠ¡å™¨ï¼Œè¿žçº¿è‡³ host.example.com çš„42ç«¯å£ã€‚ $nc -x10.2.3.4:8080 -Xconnect host.example.com 42 ä½¿ç”¨ Unix Domain Socketè¿™è¡ŒæŒ‡ä»¤ä¼šå»ºç«‹ä¸€ä¸ª Unix Domain Socketï¼Œå¹¶æŽ¥æ”¶èµ„æ–™ï¼š $nc -lU /var/tmp/dsocket]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>nc</tag>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸Žæˆ¿å±‹ä¸­ä»‹å…¬å¸è¦æŠ¼é‡‘çš„æ–—æ™ºæ–—å‹‡]]></title>
    <url>%2F2019%2F12%2F31%2F%E4%B8%8E%E6%88%BF%E5%B1%8B%E4%B8%AD%E4%BB%8B%E5%85%AC%E5%8F%B8%E8%A6%81%E6%8A%BC%E9%87%91%E7%9A%84%E6%96%97%E6%99%BA%E6%96%97%E5%8B%87%2F</url>
    <content type="text"><![CDATA[æˆ‘æ˜¯åœ¨2017å¹´3æœˆ15å·å¼€å§‹å…¥ä½åˆ°ç¦å…ƒè·¯çŽ‰å‡¤è·¯æˆ˜å‹è‹‘å°åŒºå—åŒºçš„ï¼Œç­¾äº†ä¸€å¹´çš„åˆåŒï¼Œå½“æ—¶è¿˜æ˜¯çº¸è´¨ç‰ˆçš„åˆåŒï¼Œè¿™ä¸€å¹´ç»“äº¤äº†å‡ ä½æœ‹å‹ï¼Œå…¶ä½™æ²¡å•¥è¯´çš„ï¼Œç›´æŽ¥ç•¥è¿‡ã€‚è¿›å…¥åˆ°2018å¹´ï¼Œç§Ÿæˆ¿å¿«åˆ°æœŸäº†ï¼Œæˆ‘åˆç»­è´¹ä¸€å¹´ï¼Œè¿™ä¸€å¹´å°±æ²¡æœ‰çº¸è´¨åˆåŒäº†ï¼Œè€Œæ˜¯ç”µå­åˆåŒï¼Œæ”¯ä»˜å®è˜‘è‡ç§Ÿæˆ¿çš„é‚£ç§ï¼Œåœ¨çº¿æŸ¥çœ‹åˆåŒç§Ÿçº¦ï¼Œåœ¨çº¿ç¼´è´¹ç­‰ã€‚åˆåŒä¸Šå†™æ˜Žçš„æœ‰æ¯æ¬¡ç¼´è´¹çš„æ—¥æœŸå’Œé‡‘é¢ã€‚è´¹ç”¨å‘¢ï¼Œæˆ¿ç§Ÿè¿˜æ˜¯è·Ÿä¸Šä¸€å¹´çš„ä¸€æ ·ï¼ŒæŠ¼ä¸€ä»˜ä¸‰ï¼Œç‰©ä¸šè´¹ä¸€æ¬¡æ€§äº¤ä¸€å¹´ï¼Œè¿˜æœ‰æ°´ç”µç‡ƒæ°”æŠ¼é‡‘200å…ƒã€‚æ•™è®­ç¬¬ä¸€æ¡ï¼šç‰©ä¸šè´¹ï¼šä¸åŒçš„å°åŒºç‰©ä¸šè´¹ä¸ä¸€æ ·ï¼Œæˆ‘è¿™ä¸ªç§Ÿçš„ç‰©ä¸šè´¹TTMDçš„è´µäº†ï¼Œä¸€å¹´730å…ƒã€‚åŽæ¥æˆ‘æ¢åœ°æ–¹ç§Ÿï¼Œä¹Ÿå°±æ˜¯æˆ‘çŽ°åœ¨ç§Ÿçš„è¿™ä¸ªï¼Œä¸€å¹´çš„ç‰©ä¸šè´¹åˆè®¡396å…ƒï¼Œç›¸å·®334å…ƒã€‚ç§Ÿæˆ¿å­çš„æ—¶å€™ç‰©ä¸šè´¹è¿™ä¸ªä¸€å®šè¦è´§æ¯”ä¸‰å®¶ã€‚å› 2017å¹´çš„ç§Ÿæˆ·ç§ŸæœŸåˆ°äº†é™†ç»­éƒ½æ¬èµ°äº†ï¼Œæ–°æ¬è¿›æ¥å…¶ä»–ç§Ÿæˆ·ï¼Œæˆ‘å°±è‡ªå‘çš„è®©æ–°ç§Ÿæˆ·åŠ å…¥å¾®ä¿¡ç¾¤ï¼Œå¿«åˆ°ç¼´è´¹çš„æ—¶å€™å°±ç»„ç»‡å¤§å®¶åˆè®¡ç¼´è´¹ï¼Œä½†æ˜¯äº‹æƒ…å‘ç”Ÿäº†ï¼Œéƒ¨åˆ†ç§Ÿæˆ·å¯¹è´¹ç”¨åˆ†æ‘Šæœ‰å¾ˆå¤§æŠµè§¦ï¼Œå„ç§åˆéš¾ï¼Œæœ‰æ—¶è”ç³»ä¸ä¸Šï¼Œæœ‰æ—¶è”ç³»ä¸Šäº†æ•…æ„æ‹–å»¶è½¬è´¦ï¼Œè€½è¯¯äº†ç¼´è´¹çš„æ—¶é—´ï¼Œå¯¼è‡´è¢«å¼ºè¡Œæ–­ç”µï¼Œæˆ‘ç§Ÿä½äº†ç¬¬ä¸€æ¬¡ç¼´è´¹ï¼Œå®žåœ¨åŽŒæ¶è¿™æ ·çš„ï¼Œç´¢æ€§æ‡’å¾—ç®¡ï¼Œçˆ±å’‹åœ°å’‹åœ°ï¼Œä»¥åŽå°±ä¸ç®¡ç¼´è´¹è¿™äº‹å„¿äº†ã€‚åŽæ¥ç”±ä¸­ä»‹é‚£è¾¹åŠ©ç†è´Ÿè´£è¿™ä»¶äº‹å„¿ï¼Œæ¯æ¬¡åˆ°ç¼´è´¹çš„æ—¶å€™å°±åœ¨ç¾¤é‡Œå¤§å£°ç–¾å‘¼ï¼Œä½†æ˜¯è¿˜æ˜¯ä¼šå‡ºçŽ°å¼ºè¡Œæ–­ç”µçš„æƒ…å†µã€‚å…³äºŽåœç”µï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼šå› æ¬ ç‰©ä¸šè´¹è€Œåœç”µç§Ÿæˆ·æŠŠç‰©ä¸šè´¹äº¤ç»™ä¸­ä»‹ï¼Œä¸­ä»‹å†æŠŠç‰©ä¸šè´¹äº¤ç»™å°åŒºçš„ç‰©ä¸šç®¡ç†ä¸­å¿ƒï¼Œå½“å±‹å†…æˆ¿é—´æ²¡æœ‰ç§Ÿå®Œæ—¶ï¼Œä¸­ä»‹æœ‰æ—¶ä¼šä¸äº¤ç‰©ä¸šè´¹ç»™ç‰©ä¸šç®¡ç†ä¸­å¿ƒï¼Œç­‰æœ‰äººç§Ÿæˆ¿å­äº¤äº†ç‰©ä¸šè´¹ä¸­ä»‹å…¬å¸å†æŠŠç‰©ä¸šè´¹ç»™ç‰©ä¸šç®¡ç†ä¸­å¿ƒï¼Œè¿™ä¸­é—´çš„æ—¶é—´é—´éš”ä¸€é•¿ï¼Œå°±ä¼šå‘ç”Ÿç‰©ä¸šç®¡ç†ä¸­å¿ƒå› ä¸­ä»‹æœªäº¤ç‰©ä¸šè´¹è€Œå¼ºè¡Œç»™æˆ¿é—´æ–­ç”µçš„æƒ…å†µã€‚å› æ¬ ç”µè´¹è€Œåœç”µ2017å¹´çš„ç¼´è´¹æ˜¯ç§Ÿæˆ·åœ¨å¾®ä¿¡ç¾¤é‡Œè‡ªå‘ç»„ç»‡åœ¨æ”¯ä»˜å®é‡Œç¼´è´¹çš„ï¼Œå¤§å®¶ç›¸å¤„çš„ä¹Ÿå¾ˆèžæ´½ï¼Œä¸´èµ°æ—¶è¿˜æµ·åº•æžèšé¤æ¥ç€ã€‚ä»Žæœªå‘ç”Ÿè¿‡å› æ¬ ç”µè´¹ã€æ°´è´¹æˆ–ç‡ƒæ°”è´¹è€Œè¢«ç‰©ä¸šç®¡ç†ä¸­å¿ƒå¼ºè¡Œåœç”µçš„æƒ…å†µï¼Œ2018å¹´åˆ™æ°æ°ç›¸åã€‚æ•™è®­ç¬¬äºŒæ¡ï¼šæ°´ç”µå’Œç‡ƒæ°”è´¹ï¼šçŽ°åœ¨è¿™äº›è´¹ç”¨éƒ½å¯ä»¥é€šè¿‡æˆ·å·åœ¨æ”¯ä»˜å®é‡Œç¼´çº³ï¼Œæ°´ç”µå’Œç‡ƒæ°”çš„ç¼´çº³æˆ·å·éƒ½ä¸ä¸€æ ·ï¼Œå…·ä½“å¯ä»¥é—®ç‰©ä¸šç®¡ç†ä¸­å¿ƒã€‚è¿™ä¸ªç¼´è´¹ä¸€å®šè¦è·Ÿå…¶ä»–ç§Ÿæˆ·æå‰å•†é‡å¥½ç”±ç§Ÿæˆ·è´Ÿè´£ï¼Œå¤©çŸ¥é“ä¸­ä»‹åŠ©ç†å“ªå¤©è„‘è¢‹æŠ½ç­‹å¿˜äº†è¿™èŒ¬äº‹å„¿ï¼Œæœ€ä¸»è¦çš„æ˜¯åŠ©ç†æ‘†ä¸å¹³é‚£äº›åˆéš¾çš„ç§Ÿæˆ·ã€‚æˆ‘çŽ°åœ¨ç§Ÿçš„è¿™ä¸ªæˆ¿å­ï¼Œæ°´ç”µå’Œç‡ƒæ°”å„æ¯å¤©ä¸€å—é’±ï¼Œåˆè®¡ä¸‰è€…æ¯æœˆ90å…ƒï¼Œç„¶åŽå°±éšä¾¿ç”¨ã€‚æ³¨æ„è¿™ä¸ªç”µæ˜¯æŒ‡å…¬ç”¨çš„ç”¨ç”µï¼Œæ¯”å¦‚èµ°å»Šã€åŽ¨æˆ¿ï¼Œå«ç”Ÿé—´ç­‰ç”¨ç”µã€‚æ¯ä¸ªæˆ¿é—´å†…æœ‰å•ç‹¬çš„ä¸€ä¸ªç”µè¡¨ï¼Œè¿˜æœ‰ä¸€ä¸ªæ€»ç”µè¡¨ã€‚è¿™æ ·ä¸€æ¥ï¼Œè´¹ç”¨è¿™ä¸ªå°±å¾ˆå¥½è®¡ç®—ï¼Œä¹Ÿä¸ä¼šå‡ºçŽ°è´¹ç”¨åˆ†æ‘Šä¸åˆç†çš„æƒ…å†µã€‚å»¶ä¼¸ä¸€ä¸‹ï¼šä¹‹å‰ç§Ÿçš„æˆ¿é—´å†…æœ‰ä¸€ä¸ªè€æ—§çš„ä¸­å¤®ç©ºè°ƒï¼Œåˆ°å¤å¤©çš„æ—¶å€™ï¼Œå…³äºŽæ˜¯å¦ç”¨è¿™ä¸ªç©ºè°ƒçš„é—®é¢˜ä¹Ÿäº§ç”Ÿè¿‡æ¿€çƒˆçš„äº‰æ–—ã€‚è¿™ç©ºè°ƒä¸ä»…åˆ¶å†·æ•ˆæžœä¸å¥½ï¼Œè¿˜å¾ˆè´¹ç”µã€‚å› éƒ¨åˆ†ç§Ÿæˆ·ä¸Šå¤œç­ï¼Œè¿™å°±ä½¿ç©ºè°ƒçš„ä½¿ç”¨é¢‡è´¹å‘¨æŠ˜ã€‚ç»“æžœå¯¼è‡´ç©ºè°ƒç™½å¤©é»‘å¤œè¿žè½´è½¬ï¼Œå› åˆ¶å†·æ•ˆæžœä¸å¥½ï¼Œæ¸©åº¦è¿˜è°ƒçš„å¾ˆä½Žï¼Œå¯¼è‡´ç”¨ç”µé‡å¤§å¤§å¤§å¤§å¢žã€‚ç„¶åŽå°±å› ç”µè´¹åˆ†æ‘Šè¿™ä¸ªäº’ç›¸æ‰¯çš®ã€‚æ•™è®­ç¬¬ä¸‰æ¡ï¼šå…³äºŽæˆ¿é—´å†…çš„å…¬ç”¨è®¾æ–½ï¼Œæ¯”å¦‚ç©ºå‡‹ï¼Œæ´—è¡£æœºç­‰ï¼Œå°¤å…¶æ˜¯ç©ºè°ƒè¿™ä¸ªç”µè€è™Žï¼Œæˆ–è€…ä¸ç”¨ï¼Œæˆ–è€…ä¸ç§Ÿè¿™ç±»çš„æˆ¿å­ã€‚æˆ‘çŽ°åœ¨ç§Ÿçš„è¿™ä¸ªï¼Œæ¯ä¸ªæˆ¿é—´æœ‰ä¸€ä¸ªç”µè¡¨ï¼Œè¿˜æœ‰ä¸€ä¸ªæ€»ç”µè¡¨ï¼Œè¿™æ ·ä¸€æ¥å°±æŠŠå…¬ç”¨ç”µå’Œæ¯ä¸ªæˆ¿é—´çš„ç”¨ç”µç»™åˆ†éš”å¼€äº†ã€‚è°æƒ³ç”¨ç©ºè°ƒè°è‡ªå·±å®‰è£…ï¼Œç”µè´¹è‡ªå·±ç¼´çº³ï¼Œè·Ÿå…¶ä»–è´¹ç”¨éƒ½ä¸æŽºå’Œã€‚è¯´çš„æœ‰ç‚¹å¤šäº†ï¼Œè¯é¢˜æ‰¯çš„æœ‰ç‚¹è¿œï¼ŒæŽ¥ä¸‹æ¥ç»§ç»­è¯´æ­£äº‹å„¿ã€‚æˆ¿ç§Ÿä¸æ˜¯å¿«åˆ°æœŸäº†ä¹ˆï¼Œå°±ä»¥ä¸Šæƒ…å†µï¼Œéƒ½ä¸æƒ³å†ç»­ç§Ÿäº†ï¼Œæå‰å¥½å‡ å¤©å°±è·Ÿä¸­ä»‹å…¬å¸è”ç³»ï¼Œè®©ä»–ä»¬è¿‡æ¥éªŒæ”¶ä¸€ä¸‹æˆ¿å±‹ï¼Œç»™æˆ‘å°½å¿«åŠžç†é€€æˆ¿æ‰‹ç»­ã€‚è¿žç»­ä¸‰å¤©æ”¾æˆ‘é¸½å­ï¼Œæ˜Žæ˜Žç™½å¤©è¯´å¥½äº†ï¼Œè¯´æ˜¯æ™šä¸Šå‡ ç‚¹å‡ ç‚¹è¿‡æ¥éªŒæ”¶åŠžç†é€€æˆ¿æ‰‹ç»­ï¼Œå¯åˆ°ç‚¹äº†äººæ²¡æ¥ï¼Œä¹Ÿæ²¡ç»™æˆ‘æ‰“ç”µè¯ï¼Œæˆ‘ç›´æŽ¥æ‰“ç”µè¯è¿‡åŽ»ï¼Œå¯¹æ–¹ä¸æ˜¯è¯´å¿™ï¼Œå°±æ˜¯è¯´åœ¨å¼€ä¼šï¼Œæˆ‘å½“æ—¶å°±æœ‰ç‚¹ç”Ÿæ°”ï¼Œæ¥ä¸äº†æ€Žä¹ˆä¸æ‰“ç”µè¯æˆ–å‘å¾®ä¿¡è¯´ä¸€å£°ã€‚ç»åŽ†è¿‡è¿™ä»¶äº‹å„¿ï¼Œå½»åº•å¯¹è¿™ä¸ªä¸­ä»‹å…¬å¸å¾ˆå¤±æœ›ï¼Œå½“æ—¶å¿ƒé‡Œæƒ³ç€èµ¶ç´§åŠžå®Œè¿™ä¸ªäº‹å„¿ï¼Œä¸æƒ³è·Ÿè¿™æ ·çš„å…¬å¸å‘˜å·¥æ‰“äº¤é“ã€‚ç»ˆäºŽåˆ°æˆ¿ç§Ÿåˆ°æœŸçš„é‚£ä¸€å¤©ä»–ä»¬æ¥äº†ï¼ŒéªŒæ”¶ä¸€ä¸‹æˆ¿å±‹æƒ…å†µï¼Œå†™äº†ä¸€ä¸ªè´¹ç”¨æ¸…å•ï¼Œå†™äº†ä¸‰é¡¹ï¼Œæˆ¿é—´å«ç”Ÿï¼ŒåŽ¨æˆ¿å«ç”Ÿå’ŒåºŠæ¿æ–­è£‚ã€‚ç„¶åŽåˆè®©æˆ‘ç›´æŽ¥åœ¨ä¸‹é¢å†™ä¸Šæˆ‘çš„é“¶è¡Œè´¦æˆ·ï¼Œç­¾ä¸Šå­—ã€‚æˆ‘é—®ä»–ä»¬ï¼Œè¯´æ˜¯æˆ¿é—´å«ç”Ÿè¦æ‰£å¤šå°‘ï¼ŒåŽ¨æˆ¿å«ç”Ÿè¦æ‰£å¤šå°‘ï¼Œä»–ä»¬ä¸è¯´ï¼Œåªè¯´æ”¾å¿ƒå§ï¼Œè¿™è´¹ç”¨æ‰£çš„å¾ˆå°‘ã€‚æˆ‘åˆé—®å•¥æ—¶å€™èƒ½æŠŠæŠ¼é‡‘ç»™é€€å›žæ¥ï¼Œä»–ä»¬è¯´åäº”å¤©ä¹‹å†…ã€‚æˆ‘æŠŠæˆ¿é—´é’¥åŒ™äº¤ç»™ä»–ä»¬å°±èµ°äº†ã€‚å¿ƒæƒ³æ€»ç®—äº¤æŽ¥å®Œäº†ï¼ŒæŽ¥ä¸‹æ¥ç­‰ç€å¯¹æ–¹é€€è¿˜æŠ¼é‡‘å°±æ˜¯äº†ã€‚æ•™è®­ç¬¬å››æ¡ï¼šå…³äºŽé€€æˆ¿éªŒæ”¶è¿™ä¸ªï¼Œå‡¡æ˜¯éœ€è¦æ‰£æ¬¾çš„åœ°æ–¹ä¸€å®šè¦è¯¦ç»†çš„é—®æ¸…æ¥šï¼Œæ¯”å¦‚æˆ¿å±‹æ‰“æ‰«è´¹ç”¨è¦æ‰£å¤šå°‘ï¼Œæ–­è£‚ä¸€ä¸ªåºŠæ¿è¦æ‰£å¤šå°‘ï¼Œè¿™ä¸ªä»–ä»¬è‚¯å®šçŸ¥é“ï¼Œä¸ç»™ä½ çš„è¯è¿™é‡Œé¢è‚¯å®šæœ‰ä»–ä»¬çš„é˜´è°‹ã€‚æŽ¥ä¸‹æ¥çš„äº‹æƒ…åå°±ååœ¨è‡ªå·±æƒ³çš„å¤ªæƒ³å½“ç„¶äº†ã€‚åäº”å¤©çš„æˆªæ­¢æ—¥æœŸå¿«åˆ°äº†ï¼Œæˆ‘è·Ÿä¸­ä»‹åŠ©ç†è”ç³»ï¼Œè¯´æ˜¯å¿«åˆ°æœŸäº†ï¼ŒæŠ¼é‡‘å•¥æ—¶å€™é€€è¿˜ï¼Œä»–è¯´è¿˜æœ‰ä¸ªæ°´è´¹æ²¡æœ‰ç»“ç®—ï¼Œè®©å†ç­‰å‡ å¤©ã€‚æ²¡åŠžæ³•ï¼Œé’±åœ¨åˆ«äººæ‰‹é‡Œï¼Œåˆ«äººå°±æ˜¯å¤§çˆ·ï¼Œæˆ‘åªèƒ½è€å¿ƒç­‰äº†ã€‚æ¯å¤©å‚¬ä¿ƒä»–ä»¬åŽ»æŠ„æ°´è¡¨ï¼Œæ¯æ¬¡æˆ‘é—®éƒ½æœ‰ä¸åŒçš„å›žå¤ï¼Œæœ‰ä¸€æ¬¡æ˜¯æœ‰ä¸ªè½¦åŽ‹ç€æ°´è¡¨äº•ç›–äº†ï¼Œè¿˜å¾—ç­‰ç­‰ã€‚æœ‰ä¸€æ¬¡æ˜¯æŠ„é”™æ°´è¡¨äº†ï¼Œè¿˜å¾—å†åŽ»ä¸€è¶Ÿã€‚çœ‹æ ·å­ç›®å‰å°±å¡åœ¨æ°´è´¹è¿™ä¸€å—å„¿äº†ã€‚ä»¤æˆ‘å¾ˆä¸è§£çš„æ˜¯éƒ½æ˜¯æˆ‘ä¸»åŠ¨è”ç³»ä»–ä»¬é‚£è¾¹ï¼Œé—®å•¥æƒ…å†µä»–ä»¬æ‰è¯´ï¼Œæœ‰å•¥æ–°æƒ…å†µä»Žä¸ä¸»åŠ¨è·Ÿæˆ‘æ‰“ç”µè¯è¯´ã€‚å…¬å¸å°±æç©·ä¹ˆï¼Œè¿žä¸ªç”µè¯éƒ½èˆä¸å¾—æ‰“ã€‚ã€‚ã€‚è¿™ä¸ªéš¾äº§çš„æ°´è´¹ç»ˆäºŽè®¡ç®—å‡ºæ¥äº†ï¼Œé—®ä¸­ä»‹åŠ©ç†å•¥æ—¶å€™é€€æŠ¼é‡‘ï¼Œä»–è¯´å¡åœ¨ä»–ä»¬æ€»ç›‘é‚£è¾¹äº†ï¼Œä»–è¿™è¾¹å¤„ç†ä¸äº†ï¼Œå¾—ï¼Œæˆ‘ç›´æŽ¥æ‰¾ä»–æ€»ç›‘è”ç³»ã€‚æ­¤æ—¶å·²ç»è¿›å…¥4æœˆä»½äº†ï¼Œæˆ‘æ˜¯3æœˆ15å·é€€çš„æˆ¿ï¼Œè¯´å¥½çš„15å¤©ä¹‹å†…é€€æŠ¼é‡‘è¿™éƒ½å·²ç»è¶…å¥½å‡ å¤©äº†ã€‚è·Ÿä»–ä»¬æ€»ç›‘è”ç³»çš„æ—¶å€™æˆ‘å½“æ—¶æ­£åœ¨å—é˜³å‡ºå·®ï¼Œè®©ä»–æŠŠè´¹ç”¨æ¸…å•å‘è¿‡æ¥ï¼ŒæŒ‰ä»–è¿™æ¸…å•çš„è´¹ç”¨æƒ…å†µï¼Œæˆ‘é‚£æŠ¼é‡‘ä¸ä»…ä¸€åˆ†éƒ½è¦ä¸è¿‡æ¥ï¼Œç›¸åè¿˜è¦å€’è´´ä»–ä»¬éƒ¨åˆ†è´¹ç”¨ã€‚æ˜¯å¯å¿å­°ä¸å¯å¿ï¼Œç«‹é©¬å°±å¼€å§‹è·Ÿä»–æ€¼èµ·æ¥äº†ã€‚æˆ¿é—´æ‰“æ‰«è´¹ç”¨æ‰£50ï¼Œæˆ‘è®¤äº†ï¼›åŽ¨æˆ¿æ‰“æ‰«è´¹ç”¨æ‰£50ï¼Œæˆ‘ä¹Ÿè®¤äº†ï¼›é©¬æ¡¶ç»´ä¿®è´¹æ˜¯å•¥ï¼Œå½“æ—¶éªŒæ”¶çš„æ—¶å€™æ˜Žæ˜Žæ²¡è¿™ä¸ªçš„ï¼Œä»–ä»¬ç«Ÿç§è‡ªåŠ ä¸ŠåŽ»ä¹Ÿä¸è·Ÿæˆ‘è¯´ä¸€å£°ï¼Œå½“æ—¶å°±è¡¨æ˜Žè¿™ä¸ªè´¹ç”¨æˆ‘ä¸è®¤ï¼›æ–­è£‚äº†ä¸€å—åºŠæ¿æ‰£200ï¼Œæˆ‘ä¸€é—®æ‰çŸ¥é“ï¼Œä»–ä»¬è¯´æ–­è£‚ä¸€å—åºŠæ¿ç›´æŽ¥ç»™æ–°æ¢ä¸€ä¸ªåºŠï¼ŒTMDï¼Œè¿˜å¾—è¿™æ ·å¤„ç†çš„ï¼ŒåºŠæ¿æˆ‘è‡ªå·±éƒ½èƒ½æ¢ï¼Œç”¨å¾—ç€æ¢æ–°çš„ä¹ˆï¼›é‡å¤´æˆè¿˜åœ¨åŽé¢ï¼Œè¿˜è¦æ‰£æˆ‘ä¸¤å¤©çš„æ»žçº³é‡‘ï¼Œè¯´æ˜¯æˆ‘æœ‰ä¸€æ¬¡æ™šäº¤å‡ å¤©æˆ¿ç§Ÿï¼Œæˆ‘å½“æ—¶å°±å¾ˆçº³é—·ï¼Œæˆ‘è¿™ä¹ˆä¸€ä¸ªè¯šå®žå®ˆä¿¡çš„äººï¼Œåšäº‹æƒ…éƒ½æ˜¯æœ‰æ—¶é—´è®¡åˆ’çš„ï¼Œç»ä¸å¯èƒ½å‡ºçŽ°æ™šäº¤æˆ¿ç§Ÿçš„æƒ…å†µï¼Œä»–è¿˜ç†ç›´æ°”å£®çš„è¯´çœ‹åˆåŒï¼Œçœ‹åˆåŒï¼ŒæŒ‰åˆåŒåŠžäº‹ã€‚ã€‚ã€‚å‡ºçŽ°è¿™ç§æƒ…å†µçœ‹æ¥è·Ÿæˆ‘å½“æ—¶é€€æˆ¿æ—¶çš„é‚£ç§æƒ³å½“ç„¶çš„ç»“æžœæœ‰å¾ˆå¤§å·®è·æˆ‘å½“æ—¶åœ¨å—é˜³å‡ºå·®ï¼Œä¸èƒ½å› ä¸ºè¿™ä¸ªåˆ†å¿ƒï¼Œå½“æ—¶å°±å†³å®šè¿™ä»¶äº‹å„¿å…ˆæ”¾ä¸€æ”¾ï¼Œç­‰æˆ‘å‡ºå·®çš„äº‹å„¿åŠžå¥½å›žéƒ‘å·žä¹‹åŽå†æ…¢æ…¢æ¢³ç†ã€‚å›žéƒ‘å·žåŽæˆ‘ä»”ç»†æŸ¥çœ‹åˆåŒï¼Œç»ˆäºŽå‘çŽ°è¿™å…¶ä¸­çš„å…³çªæ‰€åœ¨äº†ã€‚å¯¹æ–¹æƒ³çš„æ˜¯ï¼šæˆ‘æ˜¯15å·ç§Ÿçš„æˆ¿å­ï¼ŒæŒ‰ç†è¯´åº”è¯¥æ˜¯åˆ°ç¬¬ä¸‰ä¸ªæœˆçš„15å·äº¤ä¸‹ä¸‰ä¸ªæœˆçš„æˆ¿ç§Ÿï¼Œæˆ‘æœ‰ä¸€æ¬¡æ˜¯åœ¨17å·äº¤çš„æˆ¿ç§Ÿï¼Œå…¶ä½™ä¸‰æ¬¡éƒ½æ˜¯åœ¨15å·äº¤çš„æˆ¿ç§Ÿã€‚æ™šäº¤ä¸¤å¤©ç†åº”è¦æ‰£æ»žçº³é‡‘ã€‚å¯åˆåŒå¾ˆæ‰“è„¸ï¼ŒåˆåŒä¸­æ˜Žæ˜Žå†™çš„æœ‰æˆ‘æ¯æ¬¡éœ€è¦äº¤æˆ¿ç§Ÿçš„å…·ä½“æ—¶é—´ï¼Œéƒ½æ˜¯17å·ï¼Œä»Žæ¥æ²¡æœ‰15å·è¿™ä¸€è¯´ï¼Œæˆ‘é‚£ä¸‰æ¬¡15å·äº¤çš„è¿˜æ˜¯æå‰ä¸¤å¤©äº¤çš„å‘¢ã€‚æ’‡å¼€è¿™ä¸ªä¸è¯´ï¼Œå‡å¦‚å°±ç®—æˆ‘åº”è¯¥åœ¨15å·äº¤æˆ¿ç§Ÿï¼Œå¯æ˜¯è¿çº¦è´£ä»»ä¸­å†™çš„ä¹Ÿå¾ˆæ¸…æ¥šï¼Œè‹¥è¶…è¿‡äº¤ç§Ÿæ—¥æœŸï¼Œè´°æ—¥å†…ä»ä¸ç¼´çº³çš„ï¼Œæ‰ç®—æˆ‘è¿çº¦ã€‚TDYDï¼Œç»™æˆ‘å£å£å£°å£°è¯´çœ‹åˆåŒï¼ŒæŒ‰åˆåŒåŠžäº‹å„¿ï¼Œä½ éƒ½æ²¡çœ‹åˆåŒè¿˜å¥½æ„æ€è¿™æ ·è¯´ã€‚ç­‰æˆ‘æŠŠåˆåŒæˆªå›¾ç»™ä»–å‘è¿‡åŽ»ï¼Œå°¤å…¶æ˜¯ç»™ä»–æ³¨æ˜Žäº¤ç§Ÿæ—¥æœŸå’Œè¿çº¦è´£ä»»æ¡æ¬¾æ—¶ï¼Œå°±ä¸ä¿¡ä½ ä¸è®¤ã€‚ç»ˆäºŽè¿™ä¸ªæ»žçº³é‡‘ä¸æ‰£äº†ã€‚ä¸è¿‡æŸ¥çœ‹åˆåŒæˆ‘æ‰å‘çŽ°ï¼ŒåˆåŒä¸­æœ‰ä¸€ä¸ªä¸è¶³ä¹‹å¤„ï¼Œè¿çº¦è´£ä»»ä¸­åªè¯´æ˜Žå¯¹ç§Ÿæˆ·è¿çº¦è´£ä»»çš„å¤„ç½šï¼Œå¯¹ä»–ä»¬è¿çº¦è´£ä»»çš„å¤„ç½šåˆ™æ²¡æœ‰ã€‚è¿™ä¸€ç‚¹å°¤å…¶è¦æ³¨æ„ï¼Œå°±ç®—æŠŠä»–ä»¬å‘Šä¸Šæ³•åº­ï¼ŒåˆåŒä¸­å¹¶æ²¡æœ‰å¯¹ä»–ä»¬çš„è¿çº¦å¤„ç½šï¼Œç©¶ç«Ÿè¦å¦‚ä½•å¤„ç½šä»–ä»¬ä¼°è®¡ä»å…ä¸äº†ä¸€ä»½å”‡æžªèˆŒå‰‘ã€‚è¿™ä¸ªè€ƒè™‘ä¹Ÿæ˜¯æˆ‘åŽæ¥å¦¥åçš„åŽŸå› ï¼Œå› ä¸ºè¿™ä»¶äº‹å„¿æˆ‘è€½æçš„æ—¶é—´å¤ªå¤šäº†ï¼Œä»–ä»¬çš„æ—¶é—´ä¸çæƒœï¼Œæˆ‘å¾—çæƒœæˆ‘çš„æ—¶é—´æ‰è¡Œã€‚æ•™è®­ç¬¬äº”æ¡ï¼šç§Ÿæˆ¿å­ä¹‹å‰å·²ç»è¦çœ‹è¯·åˆåŒå†…å®¹ï¼Œçœ‹ä»”ç»†åˆåŒå†…å®¹ï¼Œçœ‹æ˜Žç™½åˆåŒå†…å®¹ã€‚å°±ç®—åŽæœŸç»´æƒä¹Ÿæ˜¯ä»¥è¿™ä¸ªåˆåŒä¸ºå‡†ï¼Œå½“æ—¶çš„å£å¤´åè®®å°±æ€•åˆ°æ—¶å€™ä»–ä»¬ç¿»è„¸ä¸è®¤ã€‚ç»´ä¿®é©¬æ¡¶è´¹ç”¨ä¸æ‰£äº†ï¼Œæ»žçº³é‡‘è´¹ç”¨ä¸æ‰£äº†ï¼Œè¿˜å‰©ä¸€ä¸ªæ–­è£‚çš„åºŠæ¿å„¿ï¼ŒåºŠæ¿æ–­è£‚ä¸€å—å„¿ï¼Œæˆ‘æ˜¯åº”è¯¥èµ”å¿çš„ï¼Œå¯æ˜¯ç”¨å¾—ç€ç›´æŽ¥èµ”ä¸€ä¸ªæ–°åºŠä¹ˆï¼Œå°±ç®—è¦èµ”ä¸€ä¸ªæ–°åºŠï¼Œæœ€èµ·ç ä¹Ÿå¾—è·Ÿæˆ‘æ‰“ç”µè¯è¯´ä¸€å£°å§ï¼Œå¯æ˜¯æ²¡ç»™æˆ‘æ‰“ç”µè¯ã€‚ç„¶åŽé—®ä»–æ–°åºŠæ˜¯è°æ¢çš„ï¼Œæœ‰æ”¶æ®æ²¡ï¼Œå¯¹æ–¹ä¹Ÿä¸æä¾›ï¼Œåªè¯´ä½ æŸåäº†ä½ å°±å¾—èµ”å¿ï¼ŒåŽé¢çš„ç”¨ä¸ç€ä½ ç®¡ï¼Œä½ åªç®¡èµ”å¿å°±è¡Œã€‚æˆ‘åé—®æ‹–æ¬ æˆ‘æé•¿æ—¶é—´æŠ¼é‡‘ä¸é€€æ¢ä½ ä»¬å’‹èµ”å¿ï¼Œå“‘å·´äº†å§ã€‚ã€‚æ‡’å¾—å†è·Ÿä»–ä»¬æ‰¯çš®äº†ï¼Œæˆ‘æµªè´¹ä¸èµ·è¿™å°±æ—¶é—´ï¼Œ è¿™ä¸ªè´¹ç”¨æˆ‘è®¤äº†ï¼Œä¹Ÿè®¤æ ½äº†ã€‚å•†é‡å¥½åº”è¯¥é€€è¿˜çš„å‰©ä½™è´¹ç”¨åŽï¼Œè¯´å¥½æ˜¯ä¸¤å¤©ä¹‹å†…é€€è¿˜åˆ°æˆ‘è´¦æˆ·ï¼Œé‚£æˆ‘å°±æ²¡å•¥å¯è¯´çš„äº†ï¼Œç­‰å¾…åˆ°è´¦å°±è¡Œäº†ã€‚å¯æ˜¯æˆ‘æƒ³çš„è¿˜æ˜¯å¤ªå•çº¯äº†ï¼Œä¸¤å¤©ä¹‹å†…çš„ç¬¬äºŒå¤©æˆ‘å¿«ä¸‹ç­çš„æ—¶å€™è¿˜æ²¡åˆ°è´¦ï¼Œå†æ¬¡ä¸€ä¸ªç”µè¯æ‰“è¿‡åŽ»ï¼Œå¯¹æ–¹è¯´è¿™å‡ å¤©è´¢åŠ¡ä¼‘æ¯ï¼Œæ²¡æ³•è½¬è´¦ã€‚æ²¡å‘è½¬è´¦ä½ å€’æ˜¯ç»™æˆ‘æ‰“ç”µè¯è¯´å‘€ï¼Œæˆ‘ä¸ä¸»åŠ¨æ‰“ç”µè¯é—®å°±å•¥éƒ½ä¸è¯´ã€‚æ­£å¥½é‚£ä¸€å¤©çš„æ˜Žå¤©æˆ‘ä¼‘æ¯ï¼Œæ­£å¥½åˆ°ä»–ä»¬å…¬å¸åŽ»è¦è´¦åŽ»ã€‚æŽ¥å¾…æˆ‘çš„æ˜¯å¦ä¸€ä¸ªï¼Œé—®äº†æƒ…å†µä¹‹åŽè¯´æ˜¯ä»–ä»Šå¤©ä¸‹åˆ6ç‚¹ä¹‹å‰ä¸€å®šè½¬è´¦ï¼Œè‹¥ä¸è½¬è´¦æ˜Žå¤©å†è¿‡æ¥ç›´æŽ¥ç»™ä½ çŽ°é‡‘ã€‚æˆ‘ç»™ä»–è¯´è¦ç•™ä¸€ä¸‹ä»–çš„æ‰‹æœºå·ï¼Œä»–è¿˜è®©æˆ‘è”ç³»ä¹‹å‰é‚£ä¸€ä¸ªäººï¼Œå‘µå‘µã€‚ã€‚ã€‚æˆ‘è¿˜ç‰¹æ„ä¸Šç½‘æœç´¢äº†ä¸€ä¸‹è¿™ä¸ªä¸­ä»‹å…¬å¸ï¼Œä¸€æŸ¥ä¸å¾—äº†ï¼Œ2019å¹´è¿˜æ²¡è¿‡å‡ ä¸ªæœˆå‘¢ï¼Œéƒ½å·²ç»è¢«å‘Šä¸Šå¤šæ¬¡äº†ã€‚ç™¾åº¦è´´å§éƒ‘å·žå§æˆªå›¾æ•™è®­ç¬¬å…­æ¡ï¼šå½“è‡ªå·±çš„åˆæ³•æƒç›Šæ”¶åˆ°ä¾µå®³æ—¶ï¼Œä¸è¦é€€ç¼©ï¼Œè¦å‹‡äºŽç«™å‡ºæ¥è·Ÿä»–ä»¬æŠ—äº‰ï¼Œæ®ç¤¼ä»¥æï¼Œå°±ç®—ç»“æžœä¸æ€Žä¹ˆå¦‚æ„ï¼Œæœ€èµ·ç å¿ƒé‡Œå‡ºäº†è¿™å£æ°”ï¼Œä¹Ÿä¸èƒ½è®©ä»–ä»¬è¿‡çš„å¤ªå®‰ç”Ÿã€‚ã€‚ã€‚]]></content>
      <categories>
        <category>ç”Ÿæ´»</category>
      </categories>
      <tags>
        <tag>ç”Ÿæ´»</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[scrapyå­¦ä¹ ]]></title>
    <url>%2F2019%2F12%2F31%2Fscrapy%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[scrapyæ˜¯ä»€ä¹ˆScrapy æ˜¯ç”¨ Python å®žçŽ°çš„ä¸€ä¸ªä¸ºäº†çˆ¬å–ç½‘ç«™æ•°æ®ã€æå–ç»“æž„æ€§æ•°æ®è€Œç¼–å†™çš„åº”ç”¨æ¡†æž¶ã€‚å¸¸åº”ç”¨åœ¨åŒ…æ‹¬æ•°æ®æŒ–æŽ˜ï¼Œä¿¡æ¯å¤„ç†æˆ–å­˜å‚¨åŽ†å²æ•°æ®ç­‰ä¸€ç³»åˆ—çš„ç¨‹åºä¸­ã€‚é€šå¸¸æˆ‘ä»¬å¯ä»¥å¾ˆç®€å•çš„é€šè¿‡ Scrapy æ¡†æž¶å®žçŽ°ä¸€ä¸ªçˆ¬è™«ï¼ŒæŠ“å–æŒ‡å®šç½‘ç«™çš„å†…å®¹æˆ–å›¾ç‰‡ã€‚ scrapyæž¶æž„å›¾ç»¿çº¿æ˜¯æ•°æ®æµå‘ Scrapy Engine(å¼•æ“Ž): è´Ÿè´£Spiderã€ItemPipelineã€Downloaderã€Schedulerä¸­é—´çš„é€šè®¯ï¼Œä¿¡å·ã€æ•°æ®ä¼ é€’ç­‰ã€‚ Scheduler(è°ƒåº¦å™¨): å®ƒè´Ÿè´£æŽ¥å—å¼•æ“Žå‘é€è¿‡æ¥çš„Requestè¯·æ±‚ï¼Œå¹¶æŒ‰ç…§ä¸€å®šçš„æ–¹å¼è¿›è¡Œæ•´ç†æŽ’åˆ—ï¼Œå…¥é˜Ÿï¼Œå½“å¼•æ“Žéœ€è¦æ—¶ï¼Œäº¤è¿˜ç»™å¼•æ“Žã€‚ Downloaderï¼ˆä¸‹è½½å™¨ï¼‰ï¼šè´Ÿè´£ä¸‹è½½Scrapy Engine(å¼•æ“Ž)å‘é€çš„æ‰€æœ‰Requestsè¯·æ±‚ï¼Œå¹¶å°†å…¶èŽ·å–åˆ°çš„Responsesäº¤è¿˜ç»™Scrapy Engine(å¼•æ“Ž)ï¼Œç”±å¼•æ“Žäº¤ç»™Spideræ¥å¤„ç†ï¼Œ Spiderï¼ˆçˆ¬è™«ï¼‰ï¼šå®ƒè´Ÿè´£å¤„ç†æ‰€æœ‰Responses,ä»Žä¸­åˆ†æžæå–æ•°æ®ï¼ŒèŽ·å–Itemå­—æ®µéœ€è¦çš„æ•°æ®ï¼Œå¹¶å°†éœ€è¦è·Ÿè¿›çš„URLæäº¤ç»™å¼•æ“Žï¼Œå†æ¬¡è¿›å…¥Scheduler(è°ƒåº¦å™¨). Item Pipeline(ç®¡é“)ï¼šå®ƒè´Ÿè´£å¤„ç†Spiderä¸­èŽ·å–åˆ°çš„Itemï¼Œå¹¶è¿›è¡Œè¿›è¡ŒåŽæœŸå¤„ç†ï¼ˆè¯¦ç»†åˆ†æžã€è¿‡æ»¤ã€å­˜å‚¨ç­‰ï¼‰çš„åœ°æ–¹ã€‚ Downloader Middlewaresï¼ˆä¸‹è½½ä¸­é—´ä»¶ï¼‰ï¼šä½ å¯ä»¥å½“ä½œæ˜¯ä¸€ä¸ªå¯ä»¥è‡ªå®šä¹‰æ‰©å±•ä¸‹è½½åŠŸèƒ½çš„ç»„ä»¶ã€‚ Spider Middlewaresï¼ˆSpiderä¸­é—´ä»¶ï¼‰ï¼šä½ å¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€ä¸ªå¯ä»¥è‡ªå®šæ‰©å±•å’Œæ“ä½œå¼•æ“Žå’ŒSpiderä¸­é—´é€šä¿¡çš„åŠŸèƒ½ç»„ä»¶ï¼ˆæ¯”å¦‚è¿›å…¥Spiderçš„Responses;å’Œä»ŽSpiderå‡ºåŽ»çš„Requestsï¼‰ æ³¨æ„ï¼åªæœ‰å½“è°ƒåº¦å™¨ä¸­ä¸å­˜åœ¨ä»»ä½•requestäº†ï¼Œæ•´ä¸ªç¨‹åºæ‰ä¼šåœæ­¢ï¼Œï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºŽä¸‹è½½å¤±è´¥çš„URLï¼ŒScrapyä¹Ÿä¼šé‡æ–°ä¸‹è½½ã€‚ï¼‰ åˆ¶ä½œ Scrapy çˆ¬è™« ä¸€å…±éœ€è¦4æ­¥ï¼š æ–°å»ºé¡¹ç›® (scrapy startproject xxx)ï¼šæ–°å»ºä¸€ä¸ªæ–°çš„çˆ¬è™«é¡¹ç›® æ˜Žç¡®ç›®æ ‡ ï¼ˆç¼–å†™items.pyï¼‰ï¼šæ˜Žç¡®ä½ æƒ³è¦æŠ“å–çš„ç›®æ ‡ åˆ¶ä½œçˆ¬è™« ï¼ˆspiders/xxspider.pyï¼‰ï¼šåˆ¶ä½œçˆ¬è™«å¼€å§‹çˆ¬å–ç½‘é¡µ å­˜å‚¨å†…å®¹ ï¼ˆpipelines.pyï¼‰ï¼šè®¾è®¡ç®¡é“å­˜å‚¨çˆ¬å–å†…å®¹ scrapyå®‰è£…1. å¦‚æžœä½ ç”¨çš„æ˜¯Anacondaæˆ–è€…Mincondaï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼šconda install -c conda-forge scrapy 2. å¦‚æžœä½ å·²ç»å®‰è£…äº†pythonåŒ…ç®¡ç†å·¥å…·PyPIï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤è¿›è¡Œå®‰è£…ï¼špip install Scrapyã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æžœä½ ä½¿ç”¨çš„æ˜¯pipå®‰è£…ï¼Œä½ éœ€è¦è§£å†³ç›¸åº”çš„åŒ…ä¾èµ–ã€‚ scrapyä¾èµ–çš„ä¸€äº›åŒ…ï¼š lxmlï¼šä¸€ç§é«˜æ•ˆçš„XMLå’ŒHTMLè§£æžå™¨ï¼Œ PARSELï¼šä¸€ä¸ªHTML / XMLæ•°æ®æå–åº“ï¼ŒåŸºäºŽä¸Šé¢çš„lxmlï¼Œ w3libï¼šä¸€ç§å¤„ç†URLå’Œç½‘é¡µç¼–ç å¤šåŠŸèƒ½è¾…åŠ© twisted,ï¼šä¸€ä¸ªå¼‚æ­¥ç½‘ç»œæ¡†æž¶ cryptography and pyOpenSSLï¼Œå¤„ç†å„ç§ç½‘ç»œçº§å®‰å…¨éœ€æ±‚ ä»¥ä¸ŠåŒ…éœ€è¦çš„æœ€ä½Žç‰ˆæœ¬ï¼š Twisted 14.0 lxml 3.4 pyOpenSSL 0.14 å¸¸è§ä¾èµ–é—®é¢˜: 1.é”™è¯¯æç¤ºï¼šModuleNotFoundError: No module named &apos;win32api&apos; è§£å†³æ–¹æ³•ï¼š (1)åˆ°è¿™ä¸ªç½‘ç«™ä¸‹è½½è·Ÿä½¿ç”¨çš„Pythonç‰ˆæœ¬ç›¸åŒ¹é…çš„è½¯ä»¶ï¼šhttps://github.com/mhammond/pywin32/releases (2)è¿›å…¥ä½¿ç”¨çš„Pythonè§£é‡Šå™¨é‡Œçš„Scriptsç›®å½•ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªeasy_install.exeæ–‡ä»¶ (3)æ‰“å¼€å‘½ä»¤è¡Œï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼šeasy_install.exe pywin32-224.win-amd64-py3.6.exe 2.é”™è¯¯æç¤ºï¼šbuilding &apos;twisted.test.raiser&apos; extension è§£å†³æ–¹æ³•ï¼š (1)åˆ°è¿™ä¸ªç½‘ç«™ä¸‹è½½è·Ÿä½¿ç”¨çš„Pythonç‰ˆæœ¬ç›¸åŒ¹é…çš„è½¯ä»¶ï¼šhttps://www.lfd.uci.edu/~gohlke/pythonlibs/#twisted (2)è¿›å…¥ä½¿ç”¨çš„Pythonè§£é‡Šå™¨é‡Œçš„Scriptsç›®å½•ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªpip.exeæ–‡ä»¶ (3)æ‰“å¼€å‘½ä»¤è¡Œï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼špip.exe Twisted-18.9.0-cp36-cp36m-win_amd64.whl win7å®‰è£…scrapyæŽ¨èä½¿ç”¨Anacondaè¿›è¡Œå®‰è£… CentOS 7å®‰è£…scrapyCentOS 7ç³»ç»Ÿè‡ªå¸¦çš„pythonç‰ˆæœ¬æ˜¯2.7ï¼Œè‹¥æ˜¯python3.5+ç‰ˆæœ¬ï¼Œåˆ™ä¸ç”¨å†å®‰è£…pipäº†ã€‚ (1)å®‰è£…pip # yum -y install epel-release # yum install python-pip # pip install --upgrade pip (2)å®‰è£…ä¾èµ–åŒ… # yum install gcc libffi-devel python-devel openssl-devel -y (3)å®‰è£…scrapy # pip install scrapy scrapyå…¥é—¨æ–°å»ºé¡¹ç›®åœ¨å¼€å§‹çˆ¬å–ä¹‹å‰ï¼Œé¦–å…ˆè¦åˆ›å»ºä¸€ä¸ªscrapyé¡¹ç›®ï¼Œåœ¨å‘½ä»¤è¡Œè¾“å…¥ä¸€ä¸‹å‘½ä»¤å³å¯åˆ›å»º: # scrapy startproject mySpider scrapy startprojectæ˜¯å›ºå®šå†™æ³•ï¼Œæ³¨æ„scrapyå’Œstartprojectå’ŒmySpiderä¸­é—´æ˜¯æœ‰ç©ºæ ¼çš„ï¼ mySpider ä¸ºé¡¹ç›®åç§°ï¼Œå¯ä»¥çœ‹åˆ°å°†ä¼šåˆ›å»ºä¸€ä¸ª mySpider æ–‡ä»¶å¤¹ï¼Œç›®å½•ç»“æž„å¤§è‡´å¦‚ä¸‹ï¼š mySpider/ scrapy.cfg mySpider/ __init__.py items.py pipelines.py settings.py spiders/ __init__.py ...... è¿™äº›æ–‡ä»¶åˆ†åˆ«æ˜¯: scrapy.cfg: é¡¹ç›®çš„é…ç½®æ–‡ä»¶ã€‚ mySpider/: é¡¹ç›®çš„Pythonæ¨¡å—ï¼Œå°†ä¼šä»Žè¿™é‡Œå¼•ç”¨ä»£ç ã€‚ mySpider/items.py: é¡¹ç›®çš„ç›®æ ‡æ–‡ä»¶ã€‚ mySpider/pipelines.py: é¡¹ç›®çš„ç®¡é“æ–‡ä»¶ã€‚ mySpider/settings.py: é¡¹ç›®çš„è®¾ç½®æ–‡ä»¶ã€‚ mySpider/spiders/: å­˜å‚¨çˆ¬è™«ä»£ç ç›®å½•ã€‚ æ˜Žç¡®ç›®æ ‡æ‰“å¼€ mySpider ç›®å½•ä¸‹çš„ items.pyï¼Œ Item å®šä¹‰ç»“æž„åŒ–æ•°æ®å­—æ®µï¼Œç”¨æ¥ä¿å­˜çˆ¬å–åˆ°çš„æ•°æ®ï¼Œæœ‰ç‚¹åƒ Python ä¸­çš„ dictï¼Œä½†æ˜¯æä¾›äº†ä¸€äº›é¢å¤–çš„ä¿æŠ¤å‡å°‘é”™è¯¯ã€‚ å¯ä»¥é€šè¿‡åˆ›å»ºä¸€ä¸ª scrapy.Item ç±»ï¼Œ å¹¶ä¸”å®šä¹‰ç±»åž‹ä¸º scrapy.Field çš„ç±»å±žæ€§æ¥å®šä¹‰ä¸€ä¸ª Itemï¼ˆå¯ä»¥ç†è§£æˆç±»ä¼¼äºŽ ORM çš„æ˜ å°„å…³ç³»ï¼‰ã€‚ åˆ›å»ºä¸€ä¸ª ItcastItem ç±»ï¼Œå’Œæž„å»º item æ¨¡åž‹ï¼ˆmodelï¼‰ï¼š import scrapy class ItcastItem(scrapy.Item): name = scrapy.Field() title = scrapy.Field() info = scrapy.Field() åˆ¶ä½œçˆ¬è™«å‘½ä»¤ï¼šscrapy genspider mingyan2 mingyan2.com mingyan2ä¸ºèœ˜è››åï¼Œmingyan2.comä¸ºè¦çˆ¬å–çš„ç½‘ç«™åœ°å€ è¿è¡Œèœ˜è››å‘½ä»¤ï¼šscrapy crawl mingyan2 è¦é‡ç‚¹æé†’ä¸€ä¸‹ï¼Œæˆ‘ä»¬ä¸€å®šè¦è¿›å…¥ï¼šmingyan è¿™ä¸ªç›®å½•ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åˆ›å»ºçš„èœ˜è››é¡¹ç›®ç›®å½•ï¼Œä»¥ä¸Šå‘½ä»¤æ‰æœ‰æ•ˆï¼è¿˜æœ‰ crawl åŽé¢è·Ÿçš„mingyan2æ˜¯ä½ ç±»é‡Œé¢å®šä¹‰çš„èœ˜è››åï¼Œä¹Ÿå°±æ˜¯ï¼šnameï¼Œå¹¶ä¸æ˜¯é¡¹ç›®åã€ä¹Ÿä¸æ˜¯ç±»åã€‚ scrapy start_urlï¼ˆåˆå§‹é“¾æŽ¥ï¼‰çš„ä¸¤ç§ä¸åŒå†™æ³•ç¬¬ä¸€ç§ï¼š start_urls = [ # å¦å¤–ä¸€ç§å†™æ³•ï¼Œæ— éœ€å®šä¹‰start_requestsæ–¹æ³• &apos;http://lab.scrapyd.cn/page/1/&apos;, &apos;http://lab.scrapyd.cn/page/2/&apos;, ]ï¼Œ å¿…é¡»å®šä¹‰ä¸€ä¸ªæ–¹æ³•ä¸ºï¼šdef parse(self, response)ï¼Œæ–¹æ³•åä¸€å®šæ˜¯ï¼šparse ç¬¬äºŒç§ï¼š è‡ªå·±å®šä¹‰ä¸€ä¸ªstart_requests()æ–¹æ³• ç¤ºä¾‹ä»£ç ï¼š &quot;&quot;&quot; scrapyåˆå§‹Urlçš„ä¸¤ç§å†™æ³•ï¼Œ ä¸€ç§æ˜¯å¸¸é‡start_urlsï¼Œå¹¶ä¸”éœ€è¦å®šä¹‰ä¸€ä¸ªæ–¹æ³•parseï¼ˆï¼‰ å¦ä¸€ç§æ˜¯ç›´æŽ¥å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼šstar_requests() &quot;&quot;&quot; import scrapy class simpleUrl(scrapy.Spider): name = &quot;simpleUrl&quot; start_urls = [ #å¦å¤–ä¸€ç§å†™æ³•ï¼Œæ— éœ€å®šä¹‰start_requestsæ–¹æ³• &apos;http://lab.scrapyd.cn/page/1/&apos;, &apos;http://lab.scrapyd.cn/page/2/&apos;, ] # å¦å¤–ä¸€ç§åˆå§‹é“¾æŽ¥å†™æ³• # def start_requests(self): # urls = [ #çˆ¬å–çš„é“¾æŽ¥ç”±æ­¤æ–¹æ³•é€šè¿‡ä¸‹é¢é“¾æŽ¥çˆ¬å–é¡µé¢ # &apos;http://lab.scrapyd.cn/page/1/&apos;, # &apos;http://lab.scrapyd.cn/page/2/&apos;, # ] # for url in urls: # yield scrapy.Request(url=url, callback=self.parse) # å¦‚æžœæ˜¯ç®€å†™åˆå§‹urlï¼Œæ­¤æ–¹æ³•åå¿…é¡»ä¸ºï¼šparse def parse(self, response): page = response.url.split(&quot;/&quot;)[-2] filename = &apos;mingyan-%s.html&apos; % page with open(filename, &apos;wb&apos;) as f: f.write(response.body) self.log(&apos;ä¿å­˜æ–‡ä»¶: %s&apos; % filename) scrapyè°ƒè¯•å·¥å…·ï¼šscrapy shellä½¿ç”¨æ–¹æ³•è¿›å…¥scrapy shellè°ƒè¯•å‘½ä»¤ï¼šscrapy shell http://lab.scrapyd.cn scrapy shell æ˜¯å›ºå®šæ ¼å¼ï¼ŒåŽé¢è·Ÿçš„æ˜¯ä½ è¦è°ƒè¯•çš„é¡µé¢ã€‚è¿™æ®µä»£ç å°±æ˜¯ä¸€ä¸ªä¸‹è½½çš„è¿‡ç¨‹ï¼Œä¸€æ‰§è¡Œè¿™ä¹ˆä¸€æ®µä»£ç scrapyå°±ç«‹é©¬æŠŠæˆ‘ä»¬ç›¸åº”é“¾æŽ¥çš„ç›¸åº”é¡µé¢ç»™æ‹¿åˆ°äº† scrapy cssé€‰æ‹©å™¨ä½¿ç”¨è¿›å…¥scrapy shellè°ƒè¯•å‘½ä»¤ï¼šscrapy shell http://lab.scrapyd.cn åœ¨å‘½ä»¤è¡Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š &gt;&gt;&gt; response.css(&apos;title&apos;) [&lt;Selector xpath=&apos;descendant-or-self::title&apos; data=&apos;&lt;title&gt;SCRAPYçˆ¬è™«å®žéªŒå®¤ - SCRAPYä¸­æ–‡ç½‘æä¾›&lt;/title&gt;&apos;&gt;] ä½¿ç”¨è¿™ä¸ªå‘½ä»¤æå–çš„ä¸€ä¸ªSelectorçš„åˆ—è¡¨ï¼Œå¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„æ•°æ®ï¼›é‚£æˆ‘ä»¬å†ä½¿ç”¨scrapyç»™æˆ‘ä»¬å‡†å¤‡çš„ä¸€äº›å‡½æ•°æ¥è¿›ä¸€æ­¥æå–ï¼Œé‚£æˆ‘ä»¬æ”¹å˜ä¸€ä¸‹ä¸Šé¢çš„å†™æ³•ï¼Œ &gt;&gt;&gt; response.css(&apos;title&apos;).extract() [&apos;&lt;title&gt;SCRAPYçˆ¬è™«å®žéªŒå®¤ - SCRAPYä¸­æ–‡ç½‘æä¾›&lt;/title&gt;&apos;] æˆ‘ä»¬åªæ˜¯åœ¨åŽé¢åŠ å…¥äº†ï¼šextract() è¿™ä¹ˆä¸€ä¸ªå‡½æ•°ä½ å°±æå–åˆ°äº†æˆ‘ä»¬æ ‡ç­¾çš„ä¸€ä¸ªåˆ—è¡¨ï¼Œæ›´è¿‘ä¸€æ­¥äº†ï¼Œé‚£å¦‚æžœæˆ‘ä»¬ä¸è¦åˆ—è¡¨ï¼Œåªè¦titleè¿™ä¸ªæ ‡ç­¾ï¼Œè¦æ€Žä¹ˆå¤„ç†å‘¢ï¼Œçœ‹æˆ‘ä»¬çš„è¾“å…¥ï¼š &gt;&gt;&gt; response.css(&apos;title&apos;).extract()[0] &apos;&lt;title&gt;çˆ¬è™«å®žéªŒå®¤ - SCRAPYä¸­æ–‡ç½‘æä¾›&lt;/title&gt;&apos; è¿™é‡Œçš„è¯ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨åŽé¢æ·»åŠ ï¼š[0]ï¼Œé‚£ä»£è¡¨æå–è¿™ä¸ªåˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œé‚£å°±å¾—åˆ°äº†æˆ‘ä»¬çš„titleå­—ç¬¦ä¸²ï¼›è¿™é‡Œçš„è¯scrapyä¹Ÿç»™æˆ‘æä¾›äº†å¦å¤–ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥è¿™æ ·æ¥å†™ï¼Œä¸€æ ·çš„æ•ˆæžœï¼š &gt;&gt;&gt; response.css(&apos;title&apos;).extract_first() &apos;&lt;title&gt;çˆ¬è™«å®žéªŒå®¤ - SCRAPYä¸­æ–‡ç½‘æä¾›&lt;/title&gt;&apos; extract_first()å°±ä»£è¡¨æå–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå’Œæˆ‘ä»¬çš„ï¼š[0]ï¼Œä¸€æ ·çš„æ•ˆæžœï¼Œåªæ˜¯æ›´ç®€æ´äº›ï¼Œ è‡³æ­¤æˆ‘ä»¬å·²ç»æˆåŠŸæå–åˆ°äº†æˆ‘ä»¬çš„titleï¼Œä½†æ˜¯ä½ ä¼šå‘çŽ°ï¼Œè‚¿ä¹ˆå¤šäº†ä¸€ä¸ªtitleæ ‡ç­¾ï¼Œè¿™å¹¶ä¸æ˜¯ä½ éœ€è¦çš„ï¼Œé‚£è¦è‚¿ä¹ˆåŠžå‘¢ï¼Œ æˆ‘ä»¬å¯ä»¥ç»§ç»­æ”¹å˜ä¸€ä¸‹ä»¥ä¸Šçš„è¾“å…¥ï¼š &gt;&gt;&gt; response.css(&apos;title::text&apos;).extract_first() &apos;çˆ¬è™«å®žéªŒå®¤ - SCRAPYä¸­æ–‡ç½‘æä¾›&apos; åœ¨titleåŽé¢åŠ ä¸Šäº† ::text ,è¿™ä»£è¡¨æå–æ ‡ç­¾é‡Œé¢çš„æ•°æ®ï¼Œè‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»æˆåŠŸæå–åˆ°äº†æˆ‘ä»¬éœ€è¦çš„æ•°æ®ï¼š &apos;çˆ¬è™«å®žéªŒå®¤ - SCRAPYä¸­æ–‡ç½‘æä¾›&apos; æ€»ç»“ä¸€ä¸‹ï¼Œå…¶å®žå°±è¿™ä¹ˆä¸€æ®µä»£ç ï¼š response.css(&apos;title::text&apos;).extract_first() scrapyæå–ä¸€ç»„æ•°æ®classé€‰æ‹©å™¨ä½¿ç”¨çš„æ˜¯&quot;.&quot;,æ¯”å¦‚.text ï¼Œå¦‚æžœæ˜¯idé€‰æ‹©å™¨çš„è¯ï¼šä½¿ç”¨&quot;#&quot;,æ¯”å¦‚ #text ç¤ºä¾‹ä»£ç ï¼š import scrapy class itemSpider(scrapy.Spider): name = &apos;itemSpider&apos; start_urls = [&apos;http://lab.scrapyd.cn&apos;] def parse(self, response): mingyan = response.css(&apos;div.quote&apos;)[0] text = mingyan.css(&apos;.text::text&apos;).extract_first() # æå–åè¨€ autor = mingyan.css(&apos;.author::text&apos;).extract_first() # æå–ä½œè€… tags = mingyan.css(&apos;.tags .tag::text&apos;).extract() # æå–æ ‡ç­¾ tags = &apos;,&apos;.join(tags) # æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸² fileName = &apos;%s-è¯­å½•.txt&apos; % autor # çˆ¬å–çš„å†…å®¹å­˜å…¥æ–‡ä»¶ï¼Œæ–‡ä»¶åä¸ºï¼šä½œè€…-è¯­å½•.txt f = open(fileName, &quot;a+&quot;) # è¿½åŠ å†™å…¥æ–‡ä»¶ f.write(text) # å†™å…¥åè¨€å†…å®¹ f.write(&apos;\n&apos;) # æ¢è¡Œ f.write(&apos;æ ‡ç­¾ï¼š&apos;+tags) # å†™å…¥æ ‡ç­¾ f.close() # å…³é—­æ–‡ä»¶æ“ä½œ scrapy çˆ¬å–å¤šæ¡æ•°æ®è¿™æ¬¡æ¯”ä¸Šæ¬¡å”¯ä¸€å¤šäº†ä¸ªé€’å½’è°ƒç”¨ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å…³é”®å˜åŒ–ï¼ŒåŽŸå…ˆæˆ‘ä»¬å–å‡ºä¸€æ¡æ•°æ®ï¼Œç”¨çš„æ˜¯å¦‚ä¸‹è¡¨è¾¾å¼ï¼šmingyan = response.css(&apos;div.quote&apos;)[0] æˆ‘ä»¬åœ¨åŽé¢æ·»åŠ äº†æ¸¸æ ‡ [0] è¡¨ç¤ºåªå–å‡ºç¬¬ä¸€æ¡ï¼Œé‚£æˆ‘ä»¬è¦å–å‡ºå…¨éƒ¨ï¼Œé‚£æˆ‘ä»¬å°±ä¸ç”¨åŠ äº†ï¼Œç›´æŽ¥ï¼šmingyan = response.css(&apos;div.quote&apos;) é‚£çŽ°åœ¨çš„å˜é‡å°±æ˜¯ä¸€ä¸ªæ•°æ®é›†ï¼Œé‡Œé¢æœ‰å¤šæ¡æ•°æ®äº†ï¼Œé‚£æŽ¥ä¸‹æ¥æˆ‘ä»¬è¦åšçš„å°±æ˜¯å¾ªçŽ¯å–å‡ºæ•°æ®é›†é‡Œé¢çš„æ¯ä¸€æ¡æ•°æ®ï¼Œé‚£æˆ‘ä»¬çœ‹ä¸€ä¸‹æ€Žä¹ˆåšï¼š mingyan = response.css(&apos;div.quote&apos;) # æå–é¦–é¡µæ‰€æœ‰åè¨€ï¼Œä¿å­˜è‡³å˜é‡mingyan for v in mingyan: # å¾ªçŽ¯èŽ·å–æ¯ä¸€æ¡åè¨€é‡Œé¢çš„ï¼šåè¨€å†…å®¹ã€ä½œè€…ã€æ ‡ç­¾ text = v.css(&apos;.text::text&apos;).extract_first() # æå–åè¨€ autor = v.css(&apos;.author::text&apos;).extract_first() # æå–ä½œè€… tags = v.css(&apos;.tags .tag::text&apos;).extract() # æå–æ ‡ç­¾ tags = &apos;,&apos;.join(tags) # æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸² # æŽ¥ä¸‹æ¥ï¼Œè¿›è¡Œä¿å­˜ å¯ä»¥çœ‹åˆ°ï¼Œå…³é”®æ˜¯ï¼šfor v in mingyan: è¡¨ç¤ºæŠŠ mingyan è¿™ä¸ªæ•°æ®é›†é‡Œé¢çš„æ•°æ®ï¼Œå¾ªçŽ¯èµ‹å€¼ç»™ï¼šv ï¼Œç¬¬ä¸€æ¬¡å¾ªçŽ¯çš„è¯ v å°±ä»£è¡¨ç¬¬ä¸€æ¡æ•°æ®ï¼Œ é‚£text = v.css(&apos;.text::text&apos;).extract_first() å°±ä»£è¡¨ç¬¬ä¸€æ¡æ•°æ®çš„åè¨€å†…å®¹ï¼Œä»¥æ­¤ç±»æŽ¨ï¼ŒæŠŠæ‰€æœ‰æ•°æ®éƒ½å–äº†å‡ºæ¥ï¼Œæœ€ç»ˆè¿›è¡Œä¿å­˜ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹å®Œæ•´çš„ä»£ç ï¼š import scrapy class itemSpider(scrapy.Spider): name = &apos;listSpider&apos; start_urls = [&apos;http://lab.scrapyd.cn&apos;] def parse(self, response): mingyan = response.css(&apos;div.quote&apos;) # æå–é¦–é¡µæ‰€æœ‰åè¨€ï¼Œä¿å­˜è‡³å˜é‡mingyan for v in mingyan: # å¾ªçŽ¯èŽ·å–æ¯ä¸€æ¡åè¨€é‡Œé¢çš„ï¼šåè¨€å†…å®¹ã€ä½œè€…ã€æ ‡ç­¾ text = v.css(&apos;.text::text&apos;).extract_first() # æå–åè¨€ autor = v.css(&apos;.author::text&apos;).extract_first() # æå–ä½œè€… tags = v.css(&apos;.tags .tag::text&apos;).extract() # æå–æ ‡ç­¾ tags = &apos;,&apos;.join(tags) # æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸² &quot;&quot;&quot; æŽ¥ä¸‹æ¥è¿›è¡Œå†™æ–‡ä»¶æ“ä½œï¼Œæ¯ä¸ªåäººçš„åè¨€å‚¨å­˜åœ¨ä¸€ä¸ªtxtæ–‡æ¡£é‡Œé¢ &quot;&quot;&quot; fileName = &apos;%s-è¯­å½•.txt&apos; % autor # å®šä¹‰æ–‡ä»¶å,å¦‚ï¼šæœ¨å¿ƒ-è¯­å½•.txt with open(fileName, &quot;a+&quot;) as f: # ä¸åŒäººçš„åè¨€ä¿å­˜åœ¨ä¸åŒçš„txtæ–‡æ¡£ï¼Œâ€œa+â€ä»¥è¿½åŠ çš„å½¢å¼ f.write(text) f.write(&apos;\n&apos;) # â€˜\nâ€™ è¡¨ç¤ºæ¢è¡Œ f.write(&apos;æ ‡ç­¾ï¼š&apos; + tags) f.write(&apos;\n-------\n&apos;) f.close() scrapy çˆ¬å–ä¸‹ä¸€é¡µè¦çˆ¬å–ä¸‹ä¸€é¡µï¼Œé‚£æˆ‘ä»¬é¦–å…ˆè¦åˆ†æžé“¾æŽ¥æ ¼å¼ï¼Œæ‰¾åˆ°ä¸‹ä¸€é¡µçš„é“¾æŽ¥ï¼Œé‚£çˆ¬å–å°±ç®€å•äº†ã€‚ä¸‹ä¸€é¡µçš„é“¾æŽ¥å¦‚ä¸‹ï¼š &lt;li class=&quot;next&quot;&gt; &lt;a href=&quot;http://lab.scrapyd.cn/page/2/&quot;&gt;ä¸‹ä¸€é¡µ Â»&lt;/a&gt; &lt;/li&gt; æ¯çˆ¬ä¸€é¡µå°±ç”¨cssé€‰æ‹©å™¨æ¥æŸ¥è¯¢ï¼Œæ˜¯å¦å­˜åœ¨ä¸‹ä¸€é¡µé“¾æŽ¥ï¼Œå­˜åœ¨ï¼šåˆ™çˆ¬å–ä¸‹ä¸€é¡µé“¾æŽ¥ï¼šhttp://lab.scrapyd.cn/page/*/ï¼Œ ç„¶åŽæŠŠä¸‹ä¸€é¡µé“¾æŽ¥æäº¤ç»™å½“å‰çˆ¬å–çš„å‡½æ•°ï¼Œç»§ç»­çˆ¬å–ï¼Œç»§ç»­æŸ¥æ‰¾ä¸‹ä¸€é¡µï¼ŒçŸ¥é“æ‰¾ä¸åˆ°ä¸‹ä¸€é¡µï¼Œè¯´æ˜Žæ‰€æœ‰é¡µé¢å·²ç»çˆ¬å®Œï¼Œé‚£ç»“æŸçˆ¬è™«ã€‚ çˆ¬å–å†…å®¹çš„ä»£ç å’Œä¸Šä¸€æ–‡æ¡£ï¼ˆlistSpiderï¼‰ä¸€æ¨¡ä¸€æ ·ï¼Œå”¯ä¸€åŒºåˆ«çš„æ˜¯è¿™ä¹ˆä¸€ä¸ªåœ°æ–¹ï¼Œæˆ‘ä»¬åœ¨ï¼šlistSpider èœ˜è››ä¸‹é¢æ·»åŠ äº†è¿™ä¹ˆå‡ æ®µä»£ç ï¼š next_page = response.css(&apos;li.next a::attr(href)&apos;).extract_first() if next_page is not None: next_page = response.urljoin(next_page) yield scrapy.Request(next_page, callback=self.parse) é¦–å…ˆï¼šæˆ‘ä»¬ä½¿ç”¨ï¼šresponse.css(&apos;li.next a::attr(href)&apos;).extract_first()æŸ¥çœ‹æœ‰æœ¨æœ‰å­˜åœ¨ä¸‹ä¸€é¡µé“¾æŽ¥ï¼Œå¦‚æžœå­˜åœ¨çš„è¯ï¼Œæˆ‘ä»¬ä½¿ç”¨ï¼šurljoin(next_page)æŠŠç›¸å¯¹è·¯å¾„ï¼Œå¦‚ï¼špage/1è½¬æ¢ä¸ºç»å¯¹è·¯å¾„ï¼Œå…¶å®žä¹Ÿå°±æ˜¯åŠ ä¸Šç½‘ç«™åŸŸåï¼Œå¦‚ï¼šhttp://lab.scrapyd.cn/page/1ï¼› æŽ¥ä¸‹æ¥å°±æ˜¯çˆ¬å–ä¸‹ä¸€é¡µæˆ–æ˜¯å†…å®¹é¡µçš„ç§˜è¯€æ‰€åœ¨ï¼Œscrapyç»™æˆ‘ä»¬æä¾›äº†è¿™ä¹ˆä¸€ä¸ªæ–¹æ³•ï¼šscrapy.Request() è¿™ä¸ªæ–¹æ³•è¿˜æœ‰è®¸å¤šå‚æ•°ï¼ŒåŽé¢æˆ‘ä»¬æ…¢æ…¢è¯´ï¼Œè¿™é‡Œæˆ‘ä»¬åªä½¿ç”¨äº†ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯ï¼šæˆ‘ä»¬ç»§ç»­çˆ¬å–çš„é“¾æŽ¥ï¼ˆnext_pageï¼‰ï¼Œ è¿™é‡Œæ˜¯ä¸‹ä¸€é¡µé“¾æŽ¥ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ˜¯å†…å®¹é¡µï¼›å¦ä¸€ä¸ªæ˜¯ï¼šæˆ‘ä»¬è¦æŠŠé“¾æŽ¥æäº¤ç»™å“ªä¸€ä¸ªå‡½æ•°çˆ¬å–ï¼Œè¿™é‡Œæ˜¯parseå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯æœ¬å‡½æ•°ï¼› å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ä¸‹é¢å¦å†™ä¸€ä¸ªå‡½æ•°ï¼Œæ¯”å¦‚ï¼šå†…å®¹é¡µï¼Œä¸“é—¨å¤„ç†å†…å®¹é¡µçš„æ•°æ®ã€‚ ç»è¿‡è¿™ä¹ˆä¸€ä¸ªå‡½æ•°ï¼Œä¸‹ä¸€é¡µé“¾æŽ¥åˆæäº¤ç»™äº†parseï¼Œé‚£å°±å¯ä»¥ä¸æ–­çš„çˆ¬å–äº†ï¼Œç›´åˆ°ä¸å­˜åœ¨ä¸‹ä¸€é¡µï¼› scrapy argumentsï¼šæŒ‡å®šèœ˜è››å‚æ•°çˆ¬å–scrapyæä¾›äº†å¯ä¼ å‚çš„çˆ¬è™«ï¼Œé¦–å…ˆæŒ‰scrapy å‚æ•°æ ¼å¼å®šä¹‰å¥½å‚æ•°ï¼Œå¦‚ä¸‹ï¼š def start_requests(self): url = &apos;http://lab.scrapyd.cn/&apos; tag = getattr(self, &apos;tag&apos;, None) # èŽ·å–tagå€¼ï¼Œä¹Ÿå°±æ˜¯çˆ¬å–æ—¶ä¼ è¿‡æ¥çš„å‚æ•° if tag is not None: # åˆ¤æ–­æ˜¯å¦å­˜åœ¨tagï¼Œè‹¥å­˜åœ¨ï¼Œé‡æ–°æž„é€ url url = url + &apos;tag/&apos; + tag # æž„é€ urlè‹¥tag=çˆ±æƒ…ï¼Œurl= &quot;http://lab.scrapyd.cn/tag/çˆ±æƒ…&quot; yield scrapy.Request(url, self.parse) # å‘é€è¯·æ±‚çˆ¬å–å‚æ•°å†…å®¹ å¯ä»¥çœ‹åˆ° tag = getattr(self, &apos;tag&apos;, None) å°±æ˜¯èŽ·å–ä¼ è¿‡æ¥çš„å‚æ•°ï¼Œç„¶åŽæ ¹æ®ä¸åŒçš„å‚æ•°ï¼Œæž„é€ ä¸åŒçš„urlï¼Œç„¶åŽè¿›è¡Œä¸åŒçš„çˆ¬å–ï¼Œç»è¿‡è¿™ä¹ˆä¸€ä¸ªå¤„ç†ï¼Œæˆ‘ä»¬çš„èœ˜è››å°±ç°å¸¸çš„çµæ´»äº†ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å®Œæ•´ä»£ç ï¼š # -*- coding: utf-8 -*- import scrapy class ArgsspiderSpider(scrapy.Spider): name = &quot;argsSpider&quot; def start_requests(self): url = &apos;http://lab.scrapyd.cn/&apos; tag = getattr(self, &apos;tag&apos;, None) # èŽ·å–tagå€¼ï¼Œä¹Ÿå°±æ˜¯çˆ¬å–æ—¶ä¼ è¿‡æ¥çš„å‚æ•° if tag is not None: # åˆ¤æ–­æ˜¯å¦å­˜åœ¨tagï¼Œè‹¥å­˜åœ¨ï¼Œé‡æ–°æž„é€ url url = url + &apos;tag/&apos; + tag # æž„é€ urlè‹¥tag=çˆ±æƒ…ï¼Œurl= &quot;http://lab.scrapyd.cn/tag/çˆ±æƒ…&quot; yield scrapy.Request(url, self.parse) # å‘é€è¯·æ±‚çˆ¬å–å‚æ•°å†…å®¹ &quot;&quot;&quot; ä»¥ä¸‹å†…å®¹ä¸ºä¸Šä¸€è®²çŸ¥è¯†ï¼Œè‹¥ä¸æ¸…æ¥šå…·ä½“ç»†èŠ‚ï¼Œè¯·æŸ¥çœ‹ä¸Šä¸€è®²ï¼ &quot;&quot;&quot; def parse(self, response): mingyan = response.css(&apos;div.quote&apos;) for v in mingyan: text = v.css(&apos;.text::text&apos;).extract_first() tags = v.css(&apos;.tags .tag::text&apos;).extract() tags = &apos;,&apos;.join(tags) fileName = &apos;%s-è¯­å½•.txt&apos; % tags with open(fileName, &quot;a+&quot;) as f: f.write(text) f.write(&apos;\n&apos;) f.write(&apos;æ ‡ç­¾ï¼š&apos; + tags) f.write(&apos;\n-------\n&apos;) f.close() next_page = response.css(&apos;li.next a::attr(href)&apos;).extract_first() if next_page is not None: next_page = response.urljoin(next_page) yield scrapy.Request(next_page, callback=self.parse) è¦å¦‚ä½•ä¼ å‚,å¯ä»¥è¿™æ ·ï¼šscrapy crawl argsSpider -a tag=çˆ±æƒ… è¯¦è§£scrapyscrapyå¦‚ä½•æ‰“å¼€é¡µé¢é‚£èœ˜è››è¦å‘é€è¯·æ±‚ï¼Œé‚£æ€»å¾—è¦æœ‰è¯·æ±‚é“¾æŽ¥ï¼Œå¦‚æžœæœ¨æœ‰ï¼Œèœ˜è››è‚¯å®šå¾—ä¸åˆ°è¿”å›žï¼Œé‚£é¡µé¢ä¹Ÿå°±æ‰“ä¸å¼€äº†ï¼Œå› æ­¤å¼•å‡ºäº†scrapy spidersçš„ç¬¬ä¸€ä¸ªå¿…é¡»çš„å¸¸é‡ï¼šstart_urls URLæœ‰ä¸¤ç§å†™æ³•ï¼Œä¸€ç§ä½œä¸ºç±»çš„å¸¸é‡ã€ä¸€ç§ä½œä¸ºstart_requests(self)æ–¹æ³•çš„å¸¸é‡ï¼Œæ— è®ºå“ªä¸€ç§å†™æ³•ï¼ŒURLéƒ½æ˜¯å¿…é¡»çš„ï¼ æœ‰äº†URLé‚£å°±å¯ä»¥å‘é€è¯·æ±‚äº†ï¼Œå¦‚æžœURLæ˜¯å®šä¹‰åœ¨start_request(self)è¿™ä¸ªæ–¹æ³•é‡Œé¢ï¼Œé‚£æˆ‘ä»¬å°±è¦ä½¿ç”¨ï¼š yield scrapy.Request æ–¹æ³•å‘é€è¯·æ±‚ï¼šå¦‚ä¸‹ï¼š import scrapy class simpleUrl(scrapy.Spider): name = &quot;simpleUrl&quot; # å¦å¤–ä¸€ç§åˆå§‹é“¾æŽ¥å†™æ³• def start_requests(self): urls = [ #çˆ¬å–çš„é“¾æŽ¥ç”±æ­¤æ–¹æ³•é€šè¿‡ä¸‹é¢é“¾æŽ¥çˆ¬å–é¡µé¢ &apos;http://lab.scrapyd.cn/page/1/&apos;, &apos;http://lab.scrapyd.cn/page/2/&apos;, ] for url in urls: #å‘é€è¯·æ±‚ yield scrapy.Request(url=url, callback=self.parse) è¿™æ ·å†™çš„ä¸€ä¸ªéº»çƒ¦ä¹‹å¤„å°±æ˜¯æˆ‘ä»¬éœ€è¦å¤„ç†æˆ‘ä»¬çš„è¿”å›žï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¿˜éœ€è¦å†™ä¸€ä¸ªcallbackæ–¹æ³•æ¥å¤„ç†responseï¼› å› æ­¤å¤§å¤šæ•°æˆ‘ä»¬éƒ½æ˜¯æŠŠURLä½œä¸ºç±»çš„å¸¸é‡ï¼Œç„¶åŽå†åŠ ä¸Šå¦å¤–ä¸€ä¸ªæ–¹æ³•ï¼š parse(response) ä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ¥å‘é€è¯·æ±‚ï¼Œå¯ä»¥çœ‹åˆ°é‡Œé¢æœ‰ä¸ªå‚æ•°å·²ç»æ˜¯ï¼šresponseï¼ˆè¿”å›žï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªæ–¹æ³•è‡ªåŠ¨åŒ–çš„å®Œæˆäº†ï¼šrequestï¼ˆè¯·æ±‚é¡µé¢ï¼‰-responseï¼ˆè¿”å›žé¡µé¢ï¼‰çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬å°±ä¸å¿…è¦å†å†™å‡½æ•°æŽ¥å—è¿”å›ž import scrapy class simpleUrl(scrapy.Spider): name = &quot;simpleUrl&quot; start_urls = [ #å¦å¤–ä¸€ç§å†™æ³•ï¼Œæ— éœ€å®šä¹‰start_requestsæ–¹æ³• &apos;http://lab.scrapyd.cn/page/1/&apos;, &apos;http://lab.scrapyd.cn/page/2/&apos;, ] def parse(self, response): page = response.url.split(&quot;/&quot;)[-2] filename = &apos;mingyan-%s.html&apos; % page with open(filename, &apos;wb&apos;) as f: f.write(response.body) self.log(&apos;ä¿å­˜æ–‡ä»¶: %s&apos; % filename) scrapy cssé€‰æ‹©å™¨å’Œscrapyç›¸å…³çš„å‡½æ•°å°±è¿™ä¹ˆä¸‰ä¸ªè€Œå·²ï¼šresponse.css(&quot;cssè¡¨è¾¾å¼&quot;)ã€extract()ã€extract_first()ã€‚ æœ‰å˜åŒ–çš„å°±æ˜¯ï¼šcssè¡¨è¾¾å¼çš„å†™æ³•,æŒ‰ç…§HTMLæ ‡ç­¾çš„ç»“æž„å¯ä»¥åˆ†ä¸ºï¼šæ ‡ç­¾å±žæ€§å€¼æå–ã€æ ‡ç­¾å†…å®¹æå– 1. æ ‡ç­¾å±žæ€§å€¼çš„æå– æå–å±žæ€§æ˜¯ç”¨ï¼šâ€œæ ‡ç­¾å::attr(å±žæ€§å)â€ï¼Œé¦–å…ˆæ‰¾åˆ°è¦æå–çš„æ ‡ç­¾æœ€è¿‘çš„classæˆ–idï¼Œç¼©å°èŒƒå›´ï¼ æ¯”å¦‚æˆ‘ä»¬è¦æå–urlè¡¨è¾¾å¼å°±æ˜¯ï¼ša::attr(href)ï¼Œè¦æå–å›¾ç‰‡åœ°å€çš„è¡¨è¾¾å¼å°±æ˜¯ï¼šimg::attr(src) é™å®šä¸€ä¸‹æå–çš„èŒƒå›´ï¼Œæœ€å¥½çš„æ–¹æ³•å°±æ˜¯æ‰¾åˆ°è¦æå–ç›®æ ‡æœ€è¿‘çš„classæˆ–æ˜¯idï¼Œå¯ä»¥çœ‹åˆ°è¿™æ®µä»£ç ä¸­æœ‰ä¸ªclass=&quot;page-navigator&quot;ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥è¿™æ ·æ¥å†™ï¼šresponse.css(&quot;.page-navigator a::attr(href)&quot;).extract() è¯´æ˜Žï¼š.page-navigatorï¼Œå…¶ä¸­ç‚¹ä»£è¡¨classé€‰æ‹©å™¨ï¼Œå¦‚æžœä»£ç ä¸­æ˜¯ï¼šid=â€œpage-navigatorâ€ï¼Œé‚£æˆ‘ä»¬è¿™é‡Œå°±è¦å†™æˆï¼šâ€œ#page-navigatorâ€ 2. æ ‡ç­¾å†…å®¹çš„æå– æå–æ ‡ç­¾å†…å®¹æ˜¯ç”¨ï¼šâ€œ::textâ€ å«æœ‰åµŒå¥—æ ‡ç­¾æ–‡å­—çš„æå–ï¼šresponse.css(&quot;.post-content *::text&quot;).extract() å¯ä»¥çœ‹åˆ°ï¼Œâ€œ::texâ€œtå‰é¢æœ‰ä¸ªâ€œ*â€å·ï¼Œè¡¨ç¤ºå½“å‰classæˆ–idä¸‹æ‰€æœ‰æ ‡ç­¾ 3. CSS é«˜çº§ç”¨æ³• CSSé€‰æ‹©å™¨ç”¨äºŽé€‰æ‹©ä½ æƒ³è¦çš„å…ƒç´ çš„æ ·å¼çš„æ¨¡å¼ã€‚&quot;CSS&quot;åˆ—è¡¨ç¤ºåœ¨CSSç‰ˆæœ¬çš„å±žæ€§å®šä¹‰ï¼ˆCSS1ï¼ŒCSS2ï¼Œæˆ–å¯¹CSS3ï¼‰ scrapy xpathé€‰æ‹©å™¨ä»Žå‡ ä¸ªæ–¹é¢è¯´ï¼šä¸€ã€å±žæ€§æå–ï¼›äºŒã€å†…å®¹æå–ï¼›ä¸‰ã€æ ‡ç­¾å†…åŒ…å«æ ‡ç­¾åˆåŒ…å«æ ‡ç­¾çš„æœ€å¤–å±‚æ ‡ç­¾é‡Œçš„æ‰€æœ‰å†…å®¹æå–ï¼› 1. scrapy xpath å±žæ€§æå– XPath ä½¿ç”¨è·¯å¾„è¡¨è¾¾å¼åœ¨ XML æ–‡æ¡£ä¸­é€‰å–èŠ‚ç‚¹ã€‚èŠ‚ç‚¹æ˜¯é€šè¿‡æ²¿ç€è·¯å¾„æˆ–è€… step æ¥é€‰å–çš„ã€‚ ä¸‹é¢åˆ—å‡ºäº†æœ€æœ‰ç”¨çš„è·¯å¾„è¡¨è¾¾å¼ï¼š è°ƒè¯•çš„è¯æˆ‘ä»¬è¿˜æ˜¯åœ¨å‘½ä»¤è¡Œä½¿ç”¨ä¸‹é¢å‘½ä»¤ï¼šscrapy shell lab.scrapyd.cn å‡½æ•°ï¼šresponse.xpath(&quot;è¡¨è¾¾å¼&quot;)ï¼Œæå–å±žæ€§çš„è¯æ—¢ç„¶ä½¿ç”¨ï¼š@ï¼Œé‚£æˆ‘ä»¬è¦æå–hrefå°±æ˜¯ï¼š@hrefï¼Œè¯•ä¸€ä¸‹ï¼šresponse.xpath(&quot;//@href&quot;) é™å®šæˆ‘ä»¬çš„å±žæ€§ï¼Œä½¿ç”¨çš„æ˜¯ï¼šæ ‡ç­¾[@å±žæ€§å=&apos;å±žæ€§å€¼&apos;]ï¼› è¡¨è¾¾å¼å°±æ˜¯ï¼š//@å±žæ€§åï¼Œç¼©å°æ ‡ç­¾èŒƒå›´ã€é™å®šå±žæ€§çš„æ–¹å¼ 2. scrapy xpath æ ‡ç­¾å†…å®¹æå– è¡¨è¾¾å¼ä¸ºï¼š//text() 3. åŒ…å«HTMLæ ‡ç­¾çš„æ‰€æœ‰æ–‡å­—å†…å®¹æå– è¿™ç§ç”¨æ³•ä¸»è¦æ˜¯æå–ä¸€äº›å†…å®¹é¡µï¼Œæ ‡ç­¾é‡Œå¤¹æ‚ç€æ–‡å­—ï¼Œä½†æˆ‘ä»¬åªè¦æ–‡å­—ï¼æ¯”å¦‚ä¸‹é¢çš„è¿™æ®µä»£ç ï¼š &lt;div class=&quot;post-content&quot; itemprop=&quot;articleBody&quot;&gt; &lt;p&gt;å¦‚æžœä½ å› å¤±åŽ»äº†å¤ªé˜³è€Œæµæ³ªï¼Œé‚£ä¹ˆä½ ä¹Ÿå°†å¤±åŽ»ç¾¤æ˜Ÿäº†ã€‚ &lt;br&gt;If you shed tears when you miss the sun, you also miss the stars. &lt;/p&gt; &lt;p&gt;&lt;a href=&quot;http://www.scrapyd.cn&quot;&gt;scrapyä¸­æ–‡ç½‘ï¼ˆ&lt;/a&gt;&lt;a href=&quot;http://www.scrapyd.cn&quot;&gt;http://www.scrapyd.cn&lt;/a&gt;ï¼‰æ•´ç†&lt;/p&gt; &lt;/div&gt; å¦‚æžœæˆ‘ä»¬ç”¨è¡¨è¾¾å¼ï¼š//div[@class=&apos;post-content&apos;]//text()ï¼Œä½ ä¼šå‘çŽ°è™½ç„¶èƒ½æå–ä½†æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œä¸æ˜¯æ•´æ®µæ–‡å­—ã€‚ é‚£å°±ç”¨åˆ°ä¸€ä¸ªxpathå‡½æ•°ï¼šstring()ï¼Œå¯ä»¥æŠŠè¡¨è¾¾å¼è¿™æ ·å†™ï¼šresponse.xpath(&quot;string(//div[@class=&apos;post-content&apos;])&quot;).extract()ï¼Œå¯çœ‹åˆ°æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨ï¼štext()ï¼Œè€Œæ˜¯ç”¨ï¼šstring(è¦æå–å†…å®¹çš„æ ‡ç­¾)ï¼Œè¿™æ ·çš„è¯å°±èƒ½æŠŠæ•°æ®éƒ½æå–å‡ºæ¥äº†ï¼Œè€Œä¸”éƒ½åˆæˆä¸ºä¸€æ¡ï¼Œå¹¶éžä¸€ä¸ªåˆ—è¡¨ã€‚ è¿™ä¸€ç§ç”¨æ³•åœ¨æˆ‘ä»¬æå–å•†å“è¯¦æƒ…ã€å°è¯´å†…å®¹çš„æ—¶å€™ç»å¸¸ç”¨åˆ° 4. xpathå®žä¾‹ scrapyå‘½ä»¤è¡Œå·¥å…·1. scrapyå…¨å±€å‘½ä»¤ scrapy startproject project_name scrapy genspider example example.com (cd project_name) scrapy crawl XXï¼ˆè¿è¡ŒXXèœ˜è››ï¼‰ scrapy shell www.example.com (1)startproject åˆ›å»ºé¡¹ç›®çš„ï¼Œå¦‚ï¼Œåˆ›å»ºä¸€ä¸ªåä¸ºï¼šscrapyChinaçš„é¡¹ç›®ï¼šscrapy strartproject scrapychina (2)genspider æ ¹æ®èœ˜è››æ¨¡æ¿åˆ›å»ºèœ˜è››çš„å‘½ä»¤ (3)settings scrayè®¾ç½®å‚æ•°,æ¯”å¦‚æˆ‘ä»¬æƒ³å¾—åˆ°èœ˜è››çš„ä¸‹è½½å»¶è¿Ÿï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ï¼šscrapy settings --get DOWNLOAD_DELAY;æ¯”å¦‚æˆ‘ä»¬æƒ³å¾—åˆ°èœ˜è››çš„åå­—ï¼šscrapy settings --get BOT_NAME (4)runspider è¿è¡Œèœ˜è››é™¤äº†ä½¿ç”¨ï¼šscrapy crawl XXä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜èƒ½ç”¨ï¼šrunspiderï¼Œ å‰è€…æ˜¯åŸºäºŽé¡¹ç›®è¿è¡Œï¼ŒåŽè€…æ˜¯åŸºäºŽæ–‡ä»¶è¿è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´ä½ æŒ‰ç…§scrapyçš„èœ˜è››æ ¼å¼ç¼–å†™äº†ä¸€ä¸ªpyæ–‡ä»¶ï¼Œé‚£ä½ ä¸æƒ³åˆ›å»ºé¡¹ç›®ï¼Œé‚£ä½ å°±å¯ä»¥ä½¿ç”¨runspiderï¼Œæ¯”å¦‚ä½ ç¼–å†™äº†ä¸€ä¸ªï¼šscrapyd_cn.pyçš„èœ˜è››ï¼Œä½ è¦ç›´æŽ¥è¿è¡Œå°±æ˜¯ï¼šscrapy runspider scrapy_cn.py (5)shell ä¸»è¦æ˜¯è°ƒè¯•ç”¨ (6)fetch æ¨¡æ‹Ÿèœ˜è››ä¸‹è½½é¡µé¢ï¼Œä¹Ÿå°±æ˜¯è¯´ç”¨è¿™ä¸ªå‘½ä»¤ä¸‹è½½çš„é¡µé¢å°±æ˜¯èœ˜è››è¿è¡Œæ—¶ä¸‹è½½çš„é¡µé¢ï¼Œå¥½å¤„æ˜¯èƒ½å‡†ç¡®è¯Šæ–­å‡ºï¼Œå¾—åˆ°çš„htmlç»“æž„åˆ°åº•æ˜¯ä¸æ˜¯æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œç„¶åŽèƒ½åŠæ—¶è°ƒæ•´æˆ‘ä»¬ç¼–å†™çˆ¬è™«çš„ç­–ç•¥ã€‚æ¼”ç¤ºwindowä¸‹å¦‚ä¸‹å¦‚ä½•æŠŠä¸‹è½½çš„é¡µé¢ä¿å­˜ï¼šscrapy fetch http://www.scrapyd.cn &gt;d:/3.html (7)view å’Œfetchç±»ä¼¼éƒ½æ˜¯æŸ¥çœ‹èœ˜è››çœ‹åˆ°çš„æ˜¯å¦å’Œä½ çœ‹åˆ°çš„ä¸€è‡´ï¼Œä¾¿äºŽæŽ’é”™ï¼Œç”¨æ³•ï¼šscrapy view http://www.scrapyd.cn (8)version æŸ¥çœ‹scrapyç‰ˆæœ¬ï¼Œç”¨æ³•ï¼šscrapy version 2. scrapyé¡¹ç›®å‘½ä»¤ éœ€è¦åœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹é¢æ‰“å¼€CMDå‘½ä»¤ï¼Œç„¶åŽå†æ‰§è¡Œä¸‹é¢çš„è¿™äº›å‘½ä»¤ (1)crawl è¿è¡Œèœ˜è›› (2)check æ£€æŸ¥èœ˜è›› (3)list æ˜¾ç¤ºæœ‰å¤šå°‘ä¸ªèœ˜è››,è¿™é‡Œçš„èœ˜è››å°±æ˜¯æŒ‡spideræ–‡ä»¶å¤¹ä¸‹é¢xx.pyæ–‡ä»¶ä¸­å®šä¹‰çš„nameï¼Œä½ æœ‰10ä¸ªpyæ–‡ä»¶ä½†æ˜¯åªæœ‰ä¸€ä¸ªå®šä¹‰äº†èœ˜è››çš„nameï¼Œé‚£åªç®—ä¸€ä¸ªèœ˜è››]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Scrapy</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python_é¢å‘å¯¹è±¡]]></title>
    <url>%2F2019%2F12%2F31%2Fpython_%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%2F</url>
    <content type="text"><![CDATA[é¢å‘å¯¹è±¡(OOP)åŸºæœ¬æ¦‚å¿µé¢å‘å¯¹è±¡ç¼–ç¨‹ â€”â€” Object Oriented Programming ç®€å†™ OOP01. é¢å‘å¯¹è±¡åŸºæœ¬æ¦‚å¿µæˆ‘ä»¬ä¹‹å‰å­¦ä¹ çš„ç¼–ç¨‹æ–¹å¼å°±æ˜¯ é¢å‘è¿‡ç¨‹ çš„é¢ç›¸è¿‡ç¨‹ å’Œ é¢ç›¸å¯¹è±¡ï¼Œæ˜¯ä¸¤ç§ä¸åŒçš„ ç¼–ç¨‹æ–¹å¼å¯¹æ¯” é¢å‘è¿‡ç¨‹ çš„ç‰¹ç‚¹ï¼Œå¯ä»¥æ›´å¥½åœ°äº†è§£ä»€ä¹ˆæ˜¯ é¢å‘å¯¹è±¡1.1 è¿‡ç¨‹å’Œå‡½æ•°ï¼ˆç§‘æ™®ï¼‰è¿‡ç¨‹ æ˜¯æ—©æœŸçš„ä¸€ä¸ªç¼–ç¨‹æ¦‚å¿µè¿‡ç¨‹ ç±»ä¼¼äºŽå‡½æ•°ï¼Œåªèƒ½æ‰§è¡Œï¼Œä½†æ˜¯æ²¡æœ‰è¿”å›žå€¼å‡½æ•° ä¸ä»…èƒ½æ‰§è¡Œï¼Œè¿˜å¯ä»¥è¿”å›žç»“æžœ1.2 é¢ç›¸è¿‡ç¨‹ å’Œ é¢ç›¸å¯¹è±¡ åŸºæœ¬æ¦‚å¿µ1) é¢ç›¸è¿‡ç¨‹ â€”â€” æ€Žä¹ˆåšï¼Ÿ1. æŠŠå®ŒæˆæŸä¸€ä¸ªéœ€æ±‚çš„ æ‰€æœ‰æ­¥éª¤ ä»Žå¤´åˆ°å°¾ é€æ­¥å®žçŽ° 2. æ ¹æ®å¼€å‘éœ€æ±‚ï¼Œå°†æŸäº› åŠŸèƒ½ç‹¬ç«‹ çš„ä»£ç  å°è£… æˆä¸€ä¸ªåˆä¸€ä¸ª å‡½æ•° 3. æœ€åŽå®Œæˆçš„ä»£ç ï¼Œå°±æ˜¯é¡ºåºåœ°è°ƒç”¨ ä¸åŒçš„å‡½æ•° ç‰¹ç‚¹1. æ³¨é‡ æ­¥éª¤ä¸Žè¿‡ç¨‹ï¼Œä¸æ³¨é‡èŒè´£åˆ†å·¥ 2. å¦‚æžœéœ€æ±‚å¤æ‚ï¼Œä»£ç ä¼šå˜å¾—å¾ˆå¤æ‚ 3. å¼€å‘å¤æ‚é¡¹ç›®ï¼Œæ²¡æœ‰å›ºå®šçš„å¥—è·¯ï¼Œå¼€å‘éš¾åº¦å¾ˆå¤§ï¼ 2) é¢å‘å¯¹è±¡ â€”â€” è°æ¥åšï¼Ÿç›¸æ¯”è¾ƒå‡½æ•°ï¼Œé¢å‘å¯¹è±¡ æ˜¯ æ›´å¤§ çš„ å°è£…ï¼Œæ ¹æ® èŒè´£ åœ¨ ä¸€ä¸ªå¯¹è±¡ä¸­ å°è£… å¤šä¸ªæ–¹æ³•åœ¨å®ŒæˆæŸä¸€ä¸ªéœ€æ±‚å‰ï¼Œé¦–å…ˆç¡®å®š èŒè´£ â€”â€” è¦åšçš„äº‹æƒ…ï¼ˆæ–¹æ³•ï¼‰æ ¹æ® èŒè´£ ç¡®å®šä¸åŒçš„ å¯¹è±¡ï¼Œåœ¨ å¯¹è±¡ å†…éƒ¨å°è£…ä¸åŒçš„ æ–¹æ³•ï¼ˆå¤šä¸ªï¼‰æœ€åŽå®Œæˆçš„ä»£ç ï¼Œå°±æ˜¯é¡ºåºåœ°è®© ä¸åŒçš„å¯¹è±¡ è°ƒç”¨ ä¸åŒçš„æ–¹æ³•ç‰¹ç‚¹1. æ³¨é‡ å¯¹è±¡å’ŒèŒè´£ï¼Œä¸åŒçš„å¯¹è±¡æ‰¿æ‹…ä¸åŒçš„èŒè´£ 2. æ›´åŠ é€‚åˆåº”å¯¹å¤æ‚çš„éœ€æ±‚å˜åŒ–ï¼Œæ˜¯ä¸“é—¨åº”å¯¹å¤æ‚é¡¹ç›®å¼€å‘ï¼Œæä¾›çš„å›ºå®šå¥—è·¯ 3. éœ€è¦åœ¨é¢å‘è¿‡ç¨‹åŸºç¡€ä¸Šï¼Œå†å­¦ä¹ ä¸€äº›é¢å‘å¯¹è±¡çš„è¯­æ³• ç±»å’Œå¯¹è±¡01. ç±»å’Œå¯¹è±¡çš„æ¦‚å¿µç±» å’Œ å¯¹è±¡ æ˜¯ é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ ä¸¤ä¸ª æ ¸å¿ƒæ¦‚å¿µ1.1 ç±»ç±» æ˜¯å¯¹ä¸€ç¾¤å…·æœ‰ ç›¸åŒ ç‰¹å¾ æˆ–è€… è¡Œä¸º çš„äº‹ç‰©çš„ä¸€ä¸ªç»Ÿç§°ï¼Œæ˜¯æŠ½è±¡çš„ï¼Œä¸èƒ½ç›´æŽ¥ä½¿ç”¨ç‰¹å¾ è¢«ç§°ä¸º å±žæ€§è¡Œä¸º è¢«ç§°ä¸º æ–¹æ³•ç±» å°±ç›¸å½“äºŽåˆ¶é€ é£žæœºæ—¶çš„å›¾çº¸ï¼Œæ˜¯ä¸€ä¸ª æ¨¡æ¿ï¼Œæ˜¯ è´Ÿè´£åˆ›å»ºå¯¹è±¡çš„1.2 å¯¹è±¡å¯¹è±¡ æ˜¯ ç”±ç±»åˆ›å»ºå‡ºæ¥çš„ä¸€ä¸ªå…·ä½“å­˜åœ¨ï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨ç”± å“ªä¸€ä¸ªç±» åˆ›å»ºå‡ºæ¥çš„ å¯¹è±¡ï¼Œå°±æ‹¥æœ‰åœ¨ å“ªä¸€ä¸ªç±» ä¸­å®šä¹‰çš„ï¼šå±žæ€§æ–¹æ³•å¯¹è±¡ å°±ç›¸å½“äºŽç”¨ å›¾çº¸ åˆ¶é€  çš„é£žæœºåœ¨ç¨‹åºå¼€å‘ä¸­ï¼Œåº”è¯¥ å…ˆæœ‰ç±»ï¼Œå†æœ‰å¯¹è±¡02. ç±»å’Œå¯¹è±¡çš„å…³ç³»ç±»æ˜¯æ¨¡æ¿ï¼Œå¯¹è±¡ æ˜¯æ ¹æ® ç±» è¿™ä¸ªæ¨¡æ¿åˆ›å»ºå‡ºæ¥çš„ï¼Œåº”è¯¥ å…ˆæœ‰ç±»ï¼Œå†æœ‰å¯¹è±¡ç±» åªæœ‰ä¸€ä¸ªï¼Œè€Œ å¯¹è±¡ å¯ä»¥æœ‰å¾ˆå¤šä¸ªä¸åŒçš„å¯¹è±¡ ä¹‹é—´ å±žæ€§ å¯èƒ½ä¼šå„ä¸ç›¸åŒç±» ä¸­å®šä¹‰äº†ä»€ä¹ˆ å±žæ€§å’Œæ–¹æ³•ï¼Œå¯¹è±¡ ä¸­å°±æœ‰ä»€ä¹ˆå±žæ€§å’Œæ–¹æ³•ï¼Œä¸å¯èƒ½å¤šï¼Œä¹Ÿä¸å¯èƒ½å°‘03. ç±»çš„è®¾è®¡åœ¨ä½¿ç”¨é¢ç›¸å¯¹è±¡å¼€å‘å‰ï¼Œåº”è¯¥é¦–å…ˆåˆ†æžéœ€æ±‚ï¼Œç¡®å®šä¸€ä¸‹ï¼Œç¨‹åºä¸­éœ€è¦åŒ…å«å“ªäº›ç±»ï¼åœ¨ç¨‹åºå¼€å‘ä¸­ï¼Œè¦è®¾è®¡ä¸€ä¸ªç±»ï¼Œé€šå¸¸éœ€è¦æ»¡è¶³ä¸€ä¸‹ä¸‰ä¸ªè¦ç´ ï¼š1. ç±»å è¿™ç±»äº‹ç‰©çš„åå­—ï¼Œæ»¡è¶³å¤§é©¼å³°å‘½åæ³• 2. å±žæ€§ è¿™ç±»äº‹ç‰©å…·æœ‰ä»€ä¹ˆæ ·çš„ç‰¹å¾ 3. æ–¹æ³• è¿™ç±»äº‹ç‰©å…·æœ‰ä»€ä¹ˆæ ·çš„è¡Œä¸º å¤§é©¼å³°å‘½åæ³•æ¯ä¸€ä¸ªå•è¯çš„é¦–å­—æ¯å¤§å†™å•è¯ä¸Žå•è¯ä¹‹é—´æ²¡æœ‰ä¸‹åˆ’çº¿3.1 ç±»åçš„ç¡®å®šåè¯æç‚¼æ³• åˆ†æž æ•´ä¸ªä¸šåŠ¡æµç¨‹ï¼Œå‡ºçŽ°çš„ åè¯ï¼Œé€šå¸¸å°±æ˜¯æ‰¾åˆ°çš„ç±»3.2 å±žæ€§å’Œæ–¹æ³•çš„ç¡®å®šå¯¹ å¯¹è±¡çš„ç‰¹å¾æè¿°ï¼Œé€šå¸¸å¯ä»¥å®šä¹‰æˆ å±žæ€§å¯¹è±¡å…·æœ‰çš„è¡Œä¸ºï¼ˆåŠ¨è¯ï¼‰ï¼Œé€šå¸¸å¯ä»¥å®šä¹‰æˆ æ–¹æ³•æç¤ºï¼šéœ€æ±‚ä¸­æ²¡æœ‰æ¶‰åŠçš„å±žæ€§æˆ–è€…æ–¹æ³•åœ¨è®¾è®¡ç±»æ—¶ï¼Œä¸éœ€è¦è€ƒè™‘é¢ç›¸å¯¹è±¡åŸºç¡€è¯­æ³•01. dir å†…ç½®å‡½æ•°ï¼ˆçŸ¥é“ï¼‰åœ¨ Python ä¸­ å¯¹è±¡å‡ ä¹Žæ˜¯æ— æ‰€ä¸åœ¨çš„ï¼Œæˆ‘ä»¬ä¹‹å‰å­¦ä¹ çš„ å˜é‡ã€æ•°æ®ã€å‡½æ•° éƒ½æ˜¯å¯¹è±¡åœ¨ Python ä¸­å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•éªŒè¯ï¼š1. åœ¨ æ ‡è¯†ç¬¦ / æ•°æ® åŽè¾“å…¥ä¸€ä¸ª .ï¼Œç„¶åŽæŒ‰ä¸‹ TAB é”®ï¼ŒiPython ä¼šæç¤ºè¯¥å¯¹è±¡èƒ½å¤Ÿè°ƒç”¨çš„ æ–¹æ³•åˆ—è¡¨ 2. ä½¿ç”¨å†…ç½®å‡½æ•° dir ä¼ å…¥ æ ‡è¯†ç¬¦ / æ•°æ®ï¼Œå¯ä»¥æŸ¥çœ‹å¯¹è±¡å†…çš„ æ‰€æœ‰å±žæ€§åŠæ–¹æ³• 3. æç¤º `__æ–¹æ³•å__` æ ¼å¼çš„æ–¹æ³•æ˜¯ Python æä¾›çš„ å†…ç½®æ–¹æ³• / å±žæ€§ï¼Œç¨åŽä¼šç»™å¤§å®¶ä»‹ç»ä¸€äº›å¸¸ç”¨çš„ å†…ç½®æ–¹æ³• / å±žæ€§ | åºå· | æ–¹æ³•å | ç±»åž‹ | ä½œç”¨ || â€”- | â€”â€”â€”- | â€”- | â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“ || 01 | __new__ | æ–¹æ³• | åˆ›å»ºå¯¹è±¡æ—¶ï¼Œä¼šè¢« è‡ªåŠ¨ è°ƒç”¨ || 02 | __init__ | æ–¹æ³• | å¯¹è±¡è¢«åˆå§‹åŒ–æ—¶ï¼Œä¼šè¢« è‡ªåŠ¨ è°ƒç”¨ || 03 | __del__ | æ–¹æ³• | å¯¹è±¡è¢«ä»Žå†…å­˜ä¸­é”€æ¯å‰ï¼Œä¼šè¢« è‡ªåŠ¨ è°ƒç”¨ || 04 | __str__ | æ–¹æ³• | è¿”å›žå¯¹è±¡çš„æè¿°ä¿¡æ¯ï¼Œprint å‡½æ•°è¾“å‡ºä½¿ç”¨ |02.å®šä¹‰ç®€å•çš„ç±»ï¼ˆåªåŒ…å«æ–¹æ³•ï¼‰é¢å‘å¯¹è±¡ æ˜¯ æ›´å¤§ çš„ å°è£…ï¼Œåœ¨ ä¸€ä¸ªç±»ä¸­ å°è£… å¤šä¸ªæ–¹æ³•ï¼Œè¿™æ · é€šè¿‡è¿™ä¸ªç±»åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡ï¼Œå°±å¯ä»¥ç›´æŽ¥è°ƒç”¨è¿™äº›æ–¹æ³•äº†ï¼2.1 å®šä¹‰åªåŒ…å«æ–¹æ³•çš„ç±»åœ¨ Python ä¸­è¦å®šä¹‰ä¸€ä¸ªåªåŒ…å«æ–¹æ³•çš„ç±»ï¼Œè¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š1234567class ç±»å: def æ–¹æ³•1(self, å‚æ•°åˆ—è¡¨): pass def æ–¹æ³•2(self, å‚æ•°åˆ—è¡¨): passæ–¹æ³• çš„å®šä¹‰æ ¼å¼å’Œä¹‹å‰å­¦ä¹ è¿‡çš„å‡½æ•° å‡ ä¹Žä¸€æ ·åŒºåˆ«åœ¨äºŽç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯ selfï¼Œå¤§å®¶æš‚æ—¶å…ˆè®°ä½ï¼Œç¨åŽä»‹ç» selfæ³¨æ„ï¼šç±»å çš„ å‘½åè§„åˆ™ è¦ç¬¦åˆ å¤§é©¼å³°å‘½åæ³•2.2 åˆ›å»ºå¯¹è±¡å½“ä¸€ä¸ªç±»å®šä¹‰å®Œæˆä¹‹åŽï¼Œè¦ä½¿ç”¨è¿™ä¸ªç±»æ¥åˆ›å»ºå¯¹è±¡ï¼Œè¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š1å¯¹è±¡å˜é‡ = ç±»å()2.3 ç¬¬ä¸€ä¸ªé¢å‘å¯¹è±¡ç¨‹åºéœ€æ±‚å°çŒ« çˆ± åƒ é±¼ï¼Œå°çŒ« è¦ å– æ°´åˆ†æžå®šä¹‰ä¸€ä¸ªçŒ«ç±» Catå®šä¹‰ä¸¤ä¸ªæ–¹æ³• eat å’Œ drinkæŒ‰ç…§éœ€æ±‚ â€”â€” ä¸éœ€è¦å®šä¹‰å±žæ€§123456789101112class Cat(): """è¿™æ˜¯ä¸€ä¸ªçŒ«ç±»""" def eat(self): print("å°çŒ«çˆ±åƒé±¼") def drink(self): print("å°çŒ«åœ¨å–æ°´")tom = Cat()tom.drink()tom.eat()å¼•ç”¨æ¦‚å¿µçš„å¼ºè°ƒåœ¨é¢å‘å¯¹è±¡å¼€å‘ä¸­ï¼Œå¼•ç”¨çš„æ¦‚å¿µæ˜¯åŒæ ·é€‚ç”¨çš„ï¼åœ¨ Python ä¸­ä½¿ç”¨ç±» åˆ›å»ºå¯¹è±¡ä¹‹åŽï¼Œtom å˜é‡ä¸­ ä»ç„¶è®°å½•çš„æ˜¯ å¯¹è±¡åœ¨å†…å­˜ä¸­çš„åœ°å€ä¹Ÿå°±æ˜¯ tom å˜é‡ å¼•ç”¨ äº† æ–°å»ºçš„çŒ«å¯¹è±¡ä½¿ç”¨ print è¾“å‡º å¯¹è±¡å˜é‡ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ˜¯èƒ½å¤Ÿè¾“å‡ºè¿™ä¸ªå˜é‡ å¼•ç”¨çš„å¯¹è±¡ æ˜¯ ç”±å“ªä¸€ä¸ªç±»åˆ›å»ºçš„å¯¹è±¡ï¼Œä»¥åŠ åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼ˆåå…­è¿›åˆ¶è¡¨ç¤ºï¼‰æç¤ºï¼šåœ¨è®¡ç®—æœºä¸­ï¼Œé€šå¸¸ä½¿ç”¨ åå…­è¿›åˆ¶ è¡¨ç¤º å†…å­˜åœ°å€åè¿›åˆ¶ å’Œ åå…­è¿›åˆ¶ éƒ½æ˜¯ç”¨æ¥è¡¨è¾¾æ•°å­—çš„ï¼Œåªæ˜¯è¡¨ç¤ºçš„æ–¹å¼ä¸ä¸€æ ·åè¿›åˆ¶ å’Œ åå…­è¿›åˆ¶ çš„æ•°å­—ä¹‹é—´å¯ä»¥æ¥å›žè½¬æ¢%d å¯ä»¥ä»¥ 10 è¿›åˆ¶ è¾“å‡ºæ•°å­—%x å¯ä»¥ä»¥ 16 è¿›åˆ¶ è¾“å‡ºæ•°å­—03.æ–¹æ³•ä¸­çš„ self å‚æ•°3.1 æ¡ˆä¾‹æ”¹é€  â€”â€” ç»™å¯¹è±¡å¢žåŠ å±žæ€§åœ¨ Python ä¸­ï¼Œè¦ ç»™å¯¹è±¡è®¾ç½®å±žæ€§ï¼Œéžå¸¸çš„å®¹æ˜“ï¼Œä½†æ˜¯ä¸æŽ¨èä½¿ç”¨å› ä¸ºï¼šå¯¹è±¡å±žæ€§çš„å°è£…åº”è¯¥å°è£…åœ¨ç±»çš„å†…éƒ¨åªéœ€è¦åœ¨ ç±»çš„å¤–éƒ¨çš„ä»£ç  ä¸­ç›´æŽ¥é€šè¿‡ . è®¾ç½®ä¸€ä¸ªå±žæ€§å³å¯æ³¨æ„ï¼šè¿™ç§æ–¹å¼è™½ç„¶ç®€å•ï¼Œä½†æ˜¯ä¸æŽ¨èä½¿ç”¨ï¼123tom.name = "Tom"...lazy_cat.name = "å¤§æ‡’çŒ«"3.2 ä½¿ç”¨ self åœ¨æ–¹æ³•å†…éƒ¨è¾“å‡ºæ¯ä¸€åªçŒ«çš„åå­—ç”± å“ªä¸€ä¸ªå¯¹è±¡ è°ƒç”¨çš„æ–¹æ³•ï¼Œæ–¹æ³•å†…çš„ self å°±æ˜¯ å“ªä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨åœ¨ç±»å°è£…çš„æ–¹æ³•å†…éƒ¨ï¼Œself å°±è¡¨ç¤º å½“å‰è°ƒç”¨æ–¹æ³•çš„å¯¹è±¡è‡ªå·±è°ƒç”¨æ–¹æ³•æ—¶ï¼Œç¨‹åºå‘˜ä¸éœ€è¦ä¼ é€’ self å‚æ•°åœ¨æ–¹æ³•å†…éƒ¨å¯ä»¥é€šè¿‡ self. è®¿é—®å¯¹è±¡çš„å±žæ€§ä¹Ÿå¯ä»¥é€šè¿‡ self. è°ƒç”¨å…¶ä»–çš„å¯¹è±¡æ–¹æ³•æ”¹é€ ä»£ç å¦‚ä¸‹ï¼š123456789101112class Cat: def eat(self): print("%s çˆ±åƒé±¼" % self.name)tom = Cat()tom.name = "Tom"tom.eat()lazy_cat = Cat()lazy_cat.name = "å¤§æ‡’çŒ«"lazy_cat.eat()åœ¨ ç±»çš„å¤–éƒ¨ï¼Œé€šè¿‡ å˜é‡å. è®¿é—®å¯¹è±¡çš„ å±žæ€§å’Œæ–¹æ³•(tom.name)åœ¨ ç±»å°è£…çš„æ–¹æ³•ä¸­ï¼Œé€šè¿‡ self. è®¿é—®å¯¹è±¡çš„ å±žæ€§å’Œæ–¹æ³•(self.name)04. åˆå§‹åŒ–æ–¹æ³•4.1 ä¹‹å‰ä»£ç å­˜åœ¨çš„é—®é¢˜ â€”â€” åœ¨ç±»çš„å¤–éƒ¨ç»™å¯¹è±¡å¢žåŠ å±žæ€§å°†æ¡ˆä¾‹ä»£ç è¿›è¡Œè°ƒæ•´ï¼Œå…ˆè°ƒç”¨æ–¹æ³• å†è®¾ç½®å±žæ€§ï¼Œè§‚å¯Ÿä¸€ä¸‹æ‰§è¡Œæ•ˆæžœ12345tom = Cat()tom.drink()tom.eat()tom.name = "Tom"print(tom)ç¨‹åºæ‰§è¡ŒæŠ¥é”™å¦‚ä¸‹ï¼š12AttributeError: 'Cat' object has no attribute 'name'å±žæ€§é”™è¯¯ï¼š'Cat' å¯¹è±¡æ²¡æœ‰ 'name' å±žæ€§æç¤ºåœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œä¸æŽ¨èåœ¨ ç±»çš„å¤–éƒ¨ ç»™å¯¹è±¡å¢žåŠ å±žæ€§å¦‚æžœåœ¨è¿è¡Œæ—¶ï¼Œæ²¡æœ‰æ‰¾åˆ°å±žæ€§ï¼Œç¨‹åºä¼šæŠ¥é”™å¯¹è±¡åº”è¯¥åŒ…å«æœ‰å“ªäº›å±žæ€§ï¼Œåº”è¯¥ å°è£…åœ¨ç±»çš„å†…éƒ¨4.2 åˆå§‹åŒ–æ–¹æ³•å½“ä½¿ç”¨ ç±»å() åˆ›å»ºå¯¹è±¡æ—¶ï¼Œä¼š è‡ªåŠ¨ æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼šä¸ºå¯¹è±¡åœ¨å†…å­˜ä¸­ åˆ†é…ç©ºé—´ â€”â€” åˆ›å»ºå¯¹è±¡ä¸ºå¯¹è±¡çš„å±žæ€§ è®¾ç½®åˆå§‹å€¼ â€”â€” åˆå§‹åŒ–æ–¹æ³•(init)è¿™ä¸ª åˆå§‹åŒ–æ–¹æ³• å°±æ˜¯ init æ–¹æ³•ï¼Œinit æ˜¯å¯¹è±¡çš„å†…ç½®æ–¹æ³•init æ–¹æ³•æ˜¯ ä¸“é—¨ ç”¨æ¥å®šä¹‰ä¸€ä¸ªç±» å…·æœ‰å“ªäº›å±žæ€§çš„æ–¹æ³•ï¼åœ¨ Cat ä¸­å¢žåŠ  init æ–¹æ³•ï¼ŒéªŒè¯è¯¥æ–¹æ³•åœ¨åˆ›å»ºå¯¹è±¡æ—¶ä¼šè¢«è‡ªåŠ¨è°ƒç”¨12345class Cat: """è¿™æ˜¯ä¸€ä¸ªçŒ«ç±»""" def __init__(self): print("åˆå§‹åŒ–æ–¹æ³•")4.3 åœ¨åˆå§‹åŒ–æ–¹æ³•å†…éƒ¨å®šä¹‰å±žæ€§åœ¨ init æ–¹æ³•å†…éƒ¨ä½¿ç”¨ self.å±žæ€§å = å±žæ€§çš„åˆå§‹å€¼ å°±å¯ä»¥ å®šä¹‰å±žæ€§å®šä¹‰å±žæ€§ä¹‹åŽï¼Œå†ä½¿ç”¨ Cat ç±»åˆ›å»ºçš„å¯¹è±¡ï¼Œéƒ½ä¼šæ‹¥æœ‰è¯¥å±žæ€§12345678910111213class Cat: def __init__(self): print("è¿™æ˜¯ä¸€ä¸ªåˆå§‹åŒ–æ–¹æ³•") # å®šä¹‰ç”¨ Cat ç±»åˆ›å»ºçš„çŒ«å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª name çš„å±žæ€§ self.name = "Tom" def eat(self): print("%s çˆ±åƒé±¼" % self.name)# ä½¿ç”¨ç±»å()åˆ›å»ºå¯¹è±¡çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨åˆå§‹åŒ–æ–¹æ³• __init__tom = Cat()tom.eat()4.4 æ”¹é€ åˆå§‹åŒ–æ–¹æ³• â€”â€” åˆå§‹åŒ–çš„åŒæ—¶è®¾ç½®åˆå§‹å€¼åœ¨å¼€å‘ä¸­ï¼Œå¦‚æžœå¸Œæœ›åœ¨ åˆ›å»ºå¯¹è±¡çš„åŒæ—¶ï¼Œå°±è®¾ç½®å¯¹è±¡çš„å±žæ€§ï¼Œå¯ä»¥å¯¹ init æ–¹æ³•è¿›è¡Œ æ”¹é€ æŠŠå¸Œæœ›è®¾ç½®çš„å±žæ€§å€¼ï¼Œå®šä¹‰æˆ init æ–¹æ³•çš„å‚æ•°åœ¨æ–¹æ³•å†…éƒ¨ä½¿ç”¨ self.å±žæ€§ = å½¢å‚ æŽ¥æ”¶å¤–éƒ¨ä¼ é€’çš„å‚æ•°åœ¨åˆ›å»ºå¯¹è±¡æ—¶ï¼Œä½¿ç”¨ ç±»å(å±žæ€§1, å±žæ€§2â€¦) è°ƒç”¨12345678910class Cat: def __init__(self, name): print("åˆå§‹åŒ–æ–¹æ³• %s" % name) self.name = name ... tom = Cat("Tom")...lazy_cat = Cat("å¤§æ‡’çŒ«")...05. å†…ç½®æ–¹æ³•å’Œå±žæ€§åºå·æ–¹æ³•åç±»åž‹ä½œç”¨01__del__æ–¹æ³•å¯¹è±¡è¢«ä»Žå†…å­˜ä¸­é”€æ¯å‰ï¼Œä¼šè¢« è‡ªåŠ¨ è°ƒç”¨02__str__æ–¹æ³•è¿”å›žå¯¹è±¡çš„æè¿°ä¿¡æ¯ï¼Œprint å‡½æ•°è¾“å‡ºä½¿ç”¨5.1 del æ–¹æ³•ï¼ˆçŸ¥é“ï¼‰åœ¨ Python ä¸­å½“ä½¿ç”¨ ç±»å() åˆ›å»ºå¯¹è±¡æ—¶ï¼Œä¸ºå¯¹è±¡ åˆ†é…å®Œç©ºé—´åŽï¼Œè‡ªåŠ¨ è°ƒç”¨ init æ–¹æ³•å½“ä¸€ä¸ª å¯¹è±¡è¢«ä»Žå†…å­˜ä¸­é”€æ¯ å‰ï¼Œä¼š è‡ªåŠ¨ è°ƒç”¨ del æ–¹æ³•åº”ç”¨åœºæ™¯init æ”¹é€ åˆå§‹åŒ–æ–¹æ³•ï¼Œå¯ä»¥è®©åˆ›å»ºå¯¹è±¡æ›´åŠ çµæ´»del å¦‚æžœå¸Œæœ›åœ¨å¯¹è±¡è¢«é”€æ¯å‰ï¼Œå†åšä¸€äº›äº‹æƒ…ï¼Œå¯ä»¥è€ƒè™‘ä¸€ä¸‹ del æ–¹æ³•ç”Ÿå‘½å‘¨æœŸä¸€ä¸ªå¯¹è±¡ä»Žè°ƒç”¨ ç±»å() åˆ›å»ºï¼Œç”Ÿå‘½å‘¨æœŸå¼€å§‹ä¸€ä¸ªå¯¹è±¡çš„ del æ–¹æ³•ä¸€æ—¦è¢«è°ƒç”¨ï¼Œç”Ÿå‘½å‘¨æœŸç»“æŸåœ¨å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå†…ï¼Œå¯ä»¥è®¿é—®å¯¹è±¡å±žæ€§ï¼Œæˆ–è€…è®©å¯¹è±¡è°ƒç”¨æ–¹æ³•12345678910111213141516class Cat: def __init__(self, new_name): self.name = new_name print("%s æ¥äº†" % self.name) def __del__(self): print("%s åŽ»äº†" % self.name)# tom æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡tom = Cat("Tom")print(tom.name)# del å…³é”®å­—å¯ä»¥åˆ é™¤ä¸€ä¸ªå¯¹è±¡del tomprint("-" * 50)5.2 str æ–¹æ³•åœ¨ Python ä¸­ï¼Œä½¿ç”¨ print è¾“å‡º å¯¹è±¡å˜é‡ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œä¼šè¾“å‡ºè¿™ä¸ªå˜é‡ å¼•ç”¨çš„å¯¹è±¡ æ˜¯ ç”±å“ªä¸€ä¸ªç±»åˆ›å»ºçš„å¯¹è±¡ï¼Œä»¥åŠ åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼ˆåå…­è¿›åˆ¶è¡¨ç¤ºï¼‰å¦‚æžœåœ¨å¼€å‘ä¸­ï¼Œå¸Œæœ›ä½¿ç”¨ print è¾“å‡º å¯¹è±¡å˜é‡ æ—¶ï¼Œèƒ½å¤Ÿæ‰“å° è‡ªå®šä¹‰çš„å†…å®¹ï¼Œå°±å¯ä»¥åˆ©ç”¨ str è¿™ä¸ªå†…ç½®æ–¹æ³•äº†æ³¨æ„ï¼šstr æ–¹æ³•å¿…é¡»è¿”å›žä¸€ä¸ªå­—ç¬¦ä¸²12345678910111213class Cat: def __init__(self, new_name): self.name = new_name print("%s æ¥äº†" % self.name) def __del__(self): print("%s åŽ»äº†" % self.name) def __str__(self): return "æˆ‘æ˜¯å°çŒ«ï¼š%s" % self.nametom = Cat("Tom")print(tom)è¿”å›žç»“æžœï¼š123Tom æ¥äº†æˆ‘æ˜¯å°çŒ«ï¼šTomTom åŽ»äº†è§£é‡Šï¼š123__del__ç”¨äºŽå½“å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ä¸º0æ—¶è‡ªåŠ¨è°ƒç”¨ã€‚__del__ä¸€èˆ¬å‡ºçŽ°åœ¨ä¸¤ä¸ªåœ°æ–¹ï¼š1ã€æ‰‹å·¥ä½¿ç”¨delå‡å°‘å¯¹è±¡å¼•ç”¨è®¡æ•°è‡³0ï¼Œè¢«åžƒåœ¾å›žæ”¶å¤„ç†æ—¶è°ƒç”¨ã€‚2ã€ç¨‹åºç»“æŸæ—¶è°ƒç”¨ã€‚__del__ä¸€èˆ¬ç”¨äºŽéœ€è¦å£°æ˜Žåœ¨å¯¹è±¡è¢«åˆ é™¤å‰éœ€è¦å¤„ç†çš„èµ„æºå›žæ”¶æ“ä½œ12345678910# æ‰‹å·¥è°ƒç”¨del å¯ä»¥å°†å¯¹è±¡å¼•ç”¨è®¡æ•°å‡ä¸€ï¼Œå¦‚æžœå‡åˆ°0ï¼Œå°†ä¼šè§¦å‘åžƒåœ¾å›žæ”¶class Student: def __del__(self): print('è°ƒç”¨å¯¹è±¡çš„delæ–¹æ³•ï¼Œæ­¤æ–¹æ³•å°†ä¼šå›žæ”¶æ­¤å¯¹è±¡å†…å­˜åœ°å€')stu = Student() # è°ƒç”¨å¯¹è±¡çš„__del__æ–¹æ³•å›žæ”¶æ­¤å¯¹è±¡å†…å­˜åœ°å€del stuprint('ä¸‹é¢è¿˜æœ‰ç¨‹åºå…¶ä»–ä»£ç ')12345class Student: def __del__(self): print('è°ƒç”¨å¯¹è±¡çš„delæ–¹æ³•ï¼Œæ­¤æ–¹æ³•å°†ä¼šå›žæ”¶æ­¤å¯¹è±¡å†…å­˜åœ°å€')stu = Student() # ç¨‹åºç›´æŽ¥ç»“æŸï¼Œä¹Ÿä¼šè°ƒç”¨å¯¹è±¡çš„__del__æ–¹æ³•å›žæ”¶åœ°å€é¢å‘å¯¹è±¡å°è£…æ¡ˆä¾‹01. å°è£…å°è£… æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¸€å¤§ç‰¹ç‚¹é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ ç¬¬ä¸€æ­¥ â€”â€” å°† å±žæ€§ å’Œ æ–¹æ³• å°è£… åˆ°ä¸€ä¸ªæŠ½è±¡çš„ ç±» ä¸­å¤–ç•Œ ä½¿ç”¨ ç±» åˆ›å»º å¯¹è±¡ï¼Œç„¶åŽ è®©å¯¹è±¡è°ƒç”¨æ–¹æ³•å¯¹è±¡æ–¹æ³•çš„ç»†èŠ‚ éƒ½è¢« å°è£… åœ¨ ç±»çš„å†…éƒ¨02. å°æ˜Žçˆ±è·‘æ­¥éœ€æ±‚å°æ˜Ž ä½“é‡ 75.0 å…¬æ–¤å°æ˜Žæ¯æ¬¡ è·‘æ­¥ ä¼šå‡è‚¥ 0.5 å…¬æ–¤å°æ˜Žæ¯æ¬¡ åƒä¸œè¥¿ ä½“é‡å¢žåŠ  1 å…¬æ–¤Personnameweight__init__(self,name,weight):__str__(self):run(self):eat(self):æç¤ºï¼šåœ¨ å¯¹è±¡çš„æ–¹æ³•å†…éƒ¨ï¼Œæ˜¯å¯ä»¥ ç›´æŽ¥è®¿é—®å¯¹è±¡çš„å±žæ€§ çš„ï¼ä»£ç å®žçŽ°ï¼š1234567891011121314151617181920212223242526272829303132class Person: """äººç±»""" def __init__(self, name, weight): self.name = name self.weight = weight def __str__(self): return "æˆ‘çš„åå­—å« %s ä½“é‡ %.2f å…¬æ–¤" % (self.name, self.weight) def run(self): """è·‘æ­¥""" print("%s çˆ±è·‘æ­¥ï¼Œè·‘æ­¥é”»ç‚¼èº«ä½“" % self.name) self.weight -= 0.5 def eat(self): """åƒä¸œè¥¿""" print("%s æ˜¯åƒè´§ï¼Œåƒå®Œè¿™é¡¿å†å‡è‚¥" % self.name) self.weight += 1xiaoming = Person("å°æ˜Ž", 75)xiaoming.run()xiaoming.eat()xiaoming.eat()print(xiaoming)2.1 å°æ˜Žçˆ±è·‘æ­¥æ‰©å±• â€”â€” å°ç¾Žä¹Ÿçˆ±è·‘æ­¥éœ€æ±‚å°æ˜Ž å’Œ å°ç¾Ž éƒ½çˆ±è·‘æ­¥å°æ˜Ž ä½“é‡ 75.0 å…¬æ–¤å°ç¾Ž ä½“é‡ 45.0 å…¬æ–¤æ¯æ¬¡ è·‘æ­¥ éƒ½ä¼šå‡å°‘ 0.5 å…¬æ–¤æ¯æ¬¡ åƒä¸œè¥¿ éƒ½ä¼šå¢žåŠ  1 å…¬æ–¤Personnameweight__init__(self,name,weight):__str__(self):run(self):eat(self):æç¤º1. åœ¨ å¯¹è±¡çš„æ–¹æ³•å†…éƒ¨ï¼Œæ˜¯å¯ä»¥ ç›´æŽ¥è®¿é—®å¯¹è±¡çš„å±žæ€§ çš„ 2. åŒä¸€ä¸ªç±» åˆ›å»ºçš„ å¤šä¸ªå¯¹è±¡ ä¹‹é—´ï¼Œå±žæ€§ äº’ä¸å¹²æ‰°ï¼ 03. æ‘†æ”¾å®¶å…·éœ€æ±‚æˆ¿å­(House) æœ‰ æˆ·åž‹ã€æ€»é¢ç§¯ å’Œ å®¶å…·åç§°åˆ—è¡¨æ–°æˆ¿å­æ²¡æœ‰ä»»ä½•çš„å®¶å…·å®¶å…·(HouseItem) æœ‰ åå­— å’Œ å åœ°é¢ç§¯ï¼Œå…¶ä¸­å¸­æ¢¦æ€(bed) å åœ° 4 å¹³ç±³è¡£æŸœ(chest) å åœ° 2 å¹³ç±³é¤æ¡Œ(table) å åœ° 1.5 å¹³ç±³å°†ä»¥ä¸Šä¸‰ä»¶ å®¶å…· æ·»åŠ  åˆ° æˆ¿å­ ä¸­æ‰“å°æˆ¿å­æ—¶ï¼Œè¦æ±‚è¾“å‡ºï¼šæˆ·åž‹ã€æ€»é¢ç§¯ã€å‰©ä½™é¢ç§¯ã€å®¶å…·åç§°åˆ—è¡¨HouseItemnamearea__init__(self,name,area):__str__(self):Househouse_typeareafree_areaitem_list__init__(self,house_type,area):__str__(self):add_item(self):å‰©ä½™é¢ç§¯åœ¨åˆ›å»ºæˆ¿å­å¯¹è±¡æ—¶ï¼Œå®šä¹‰ä¸€ä¸ª å‰©ä½™é¢ç§¯çš„å±žæ€§ï¼Œåˆå§‹å€¼å’Œæ€»é¢ç§¯ç›¸ç­‰å½“è°ƒç”¨ add_item æ–¹æ³•ï¼Œå‘æˆ¿é—´ æ·»åŠ å®¶å…· æ—¶ï¼Œè®© å‰©ä½™é¢ç§¯ -= å®¶å…·é¢ç§¯æ€è€ƒï¼šåº”è¯¥å…ˆå¼€å‘å“ªä¸€ä¸ªç±»ï¼Ÿç­”æ¡ˆ â€”â€” å®¶å…·ç±»å®¶å…·ç®€å•æˆ¿å­è¦ä½¿ç”¨åˆ°å®¶å…·ï¼Œè¢«ä½¿ç”¨çš„ç±»ï¼Œé€šå¸¸åº”è¯¥å…ˆå¼€å‘3.1 åˆ›å»ºå®¶å…·123456789101112131415161718192021class HouseItem: def __init__(self, name, area): """ :param name: å®¶å…·åç§° :param area: å åœ°é¢ç§¯ """ self.name = name self.area = area def __str__(self): return "[%s] å åœ°é¢ç§¯ %.2f" % (self.name, self.area)# 1. åˆ›å»ºå®¶å…·bed = HouseItem("å¸­æ¢¦æ€", 4)chest = HouseItem("è¡£æŸœ", 2)table = HouseItem("é¤æ¡Œ", 1.5)print(bed)print(chest)print(table)å°ç»“åˆ›å»ºäº†ä¸€ä¸ª å®¶å…·ç±»ï¼Œä½¿ç”¨åˆ° init å’Œ str ä¸¤ä¸ªå†…ç½®æ–¹æ³•ä½¿ç”¨ å®¶å…·ç±» åˆ›å»ºäº† ä¸‰ä¸ªå®¶å…·å¯¹è±¡ï¼Œå¹¶ä¸” è¾“å‡ºå®¶å…·ä¿¡æ¯3.2 åˆ›å»ºæˆ¿é—´123456789101112131415161718192021222324252627282930313233class House: def __init__(self, house_type, area): """ :param house_type: æˆ·åž‹ :param area: æ€»é¢ç§¯ """ self.house_type = house_type self.area = area # å‰©ä½™é¢ç§¯é»˜è®¤å’Œæ€»é¢ç§¯ä¸€è‡´ self.free_area = area # é»˜è®¤æ²¡æœ‰ä»»ä½•çš„å®¶å…· self.item_list = [] def __str__(self): # Python èƒ½å¤Ÿè‡ªåŠ¨çš„å°†ä¸€å¯¹æ‹¬å·å†…éƒ¨çš„ä»£ç è¿žæŽ¥åœ¨ä¸€èµ· return ("æˆ·åž‹ï¼š%s\næ€»é¢ç§¯ï¼š%.2f[å‰©ä½™ï¼š%.2f]\nå®¶å…·ï¼š%s" % (self.house_type, self.area, self.free_area, self.item_list)) def add_item(self, item): print("è¦æ·»åŠ  %s" % item)...# 2. åˆ›å»ºæˆ¿å­å¯¹è±¡my_home = House("ä¸¤å®¤ä¸€åŽ…", 60)my_home.add_item(bed)my_home.add_item(chest)my_home.add_item(table)print(my_home)å°ç»“åˆ›å»ºäº†ä¸€ä¸ª æˆ¿å­ç±»ï¼Œä½¿ç”¨åˆ° init å’Œ str ä¸¤ä¸ªå†…ç½®æ–¹æ³•å‡†å¤‡äº†ä¸€ä¸ª add_item æ–¹æ³• å‡†å¤‡æ·»åŠ å®¶å…·ä½¿ç”¨ æˆ¿å­ç±» åˆ›å»ºäº† ä¸€ä¸ªæˆ¿å­å¯¹è±¡è®© æˆ¿å­å¯¹è±¡ è°ƒç”¨äº†ä¸‰æ¬¡ add_item æ–¹æ³•ï¼Œå°† ä¸‰ä»¶å®¶å…· ä»¥å®žå‚ä¼ é€’åˆ° add_item å†…éƒ¨3.3 æ·»åŠ å®¶å…·éœ€æ±‚1&gt; åˆ¤æ–­ å®¶å…·çš„é¢ç§¯ æ˜¯å¦ è¶…è¿‡å‰©ä½™é¢ç§¯ï¼Œå¦‚æžœè¶…è¿‡ï¼Œæç¤ºä¸èƒ½æ·»åŠ è¿™ä»¶å®¶å…·2&gt; å°† å®¶å…·çš„åç§° è¿½åŠ åˆ° å®¶å…·åç§°åˆ—è¡¨ ä¸­3&gt; ç”¨ æˆ¿å­çš„å‰©ä½™é¢ç§¯ - å®¶å…·é¢ç§¯12345678910111213def add_item(self, item): print("è¦æ·»åŠ  %s" % item) # 1. åˆ¤æ–­å®¶å…·é¢ç§¯æ˜¯å¦å¤§äºŽå‰©ä½™é¢ç§¯ if item.area &gt; self.free_area: print("%s çš„é¢ç§¯å¤ªå¤§ï¼Œä¸èƒ½æ·»åŠ åˆ°æˆ¿å­ä¸­" % item.name) return # 2. å°†å®¶å…·çš„åç§°è¿½åŠ åˆ°åç§°åˆ—è¡¨ä¸­ self.item_list.append(item.name) # 3. è®¡ç®—å‰©ä½™é¢ç§¯ self.free_area -= item.area3.4 å°ç»“ä¸»ç¨‹åºåªè´Ÿè´£åˆ›å»º æˆ¿å­ å¯¹è±¡å’Œ å®¶å…· å¯¹è±¡è®© æˆ¿å­ å¯¹è±¡è°ƒç”¨ add_item æ–¹æ³• å°†å®¶å…·æ·»åŠ åˆ°æˆ¿å­ä¸­é¢ç§¯è®¡ç®—ã€å‰©ä½™é¢ç§¯ã€å®¶å…·åˆ—è¡¨ ç­‰å¤„ç†éƒ½è¢« å°è£… åˆ° æˆ¿å­ç±»çš„å†…éƒ¨é¢å‘å¯¹è±¡å°è£…æ¡ˆä¾‹ IIå°è£…å°è£… æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¸€å¤§ç‰¹ç‚¹é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ ç¬¬ä¸€æ­¥ â€”â€” å°† å±žæ€§ å’Œ æ–¹æ³• å°è£… åˆ°ä¸€ä¸ªæŠ½è±¡çš„ ç±» ä¸­å¤–ç•Œ ä½¿ç”¨ ç±» åˆ›å»º å¯¹è±¡ï¼Œç„¶åŽ è®©å¯¹è±¡è°ƒç”¨æ–¹æ³•ç»†èŠ‚ éƒ½è¢« å°è£… åœ¨ ç±»çš„å†…éƒ¨ä¸€ä¸ªå¯¹è±¡çš„ å±žæ€§ å¯ä»¥æ˜¯ å¦å¤–ä¸€ä¸ªç±»åˆ›å»ºçš„å¯¹è±¡01. å£«å…µçªå‡»éœ€æ±‚è®¸ä¸‰å¤š æœ‰ä¸€æŠŠ AK47å¯ä»¥ å¼€ç«å¤Ÿ å‘å°„ å­å¼¹å¡« è£…å¡«å­å¼¹ â€”â€” å¢žåŠ å­å¼¹æ•°é‡Soldiernamegun__init__(self):fire(self):Gunmodelbullet_count__init__(self,model):add_bullet(self,count):shoot(self):1.1 å¼€å‘æžªç±»shoot æ–¹æ³•éœ€æ±‚1&gt; åˆ¤æ–­æ˜¯å¦æœ‰å­å¼¹ï¼Œæ²¡æœ‰å­å¼¹æ— æ³•å°„å‡»2&gt; ä½¿ç”¨ print æç¤ºå°„å‡»ï¼Œå¹¶ä¸”è¾“å‡ºå­å¼¹æ•°é‡1234567891011121314151617181920212223class Gun: def __init__(self, model): # æžªçš„åž‹å· self.model = model # å­å¼¹æ•°é‡ self.bullet_count = 0 def add_bullet(self, count): self.bullet_count += count def shoot(self): # åˆ¤æ–­æ˜¯å¦è¿˜æœ‰å­å¼¹ if self.bullet_count &lt;= 0: print("æ²¡æœ‰å­å¼¹äº†...") return # å‘å°„ä¸€é¢—å­å¼¹ self.bullet_count -= 1 print("%s å‘å°„å­å¼¹[%d]..." % (self.model, self.bullet_count))# åˆ›å»ºæžªå¯¹è±¡ak47 = Gun("ak47")ak47.add_bullet(50)ak47.shoot()1.2 å¼€å‘å£«å…µç±»å‡è®¾ï¼šæ¯ä¸€ä¸ªæ–°å…µ éƒ½ æ²¡æœ‰æžªå®šä¹‰æ²¡æœ‰åˆå§‹å€¼çš„å±žæ€§åœ¨å®šä¹‰å±žæ€§æ—¶ï¼Œå¦‚æžœ ä¸çŸ¥é“è®¾ç½®ä»€ä¹ˆåˆå§‹å€¼ï¼Œå¯ä»¥è®¾ç½®ä¸º NoneNone å…³é”®å­— è¡¨ç¤º ä»€ä¹ˆéƒ½æ²¡æœ‰è¡¨ç¤ºä¸€ä¸ª ç©ºå¯¹è±¡ï¼Œæ²¡æœ‰æ–¹æ³•å’Œå±žæ€§ï¼Œæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å¸¸é‡å¯ä»¥å°† None èµ‹å€¼ç»™ä»»ä½•ä¸€ä¸ªå˜é‡fire æ–¹æ³•éœ€æ±‚1&gt; åˆ¤æ–­æ˜¯å¦æœ‰æžªï¼Œæ²¡æœ‰æžªæ²¡æ³•å†²é”‹2&gt; å–Šä¸€å£°å£å·3&gt; è£…å¡«å­å¼¹4&gt; å°„å‡»123456789101112131415161718class Soldier: def __init__(self, name): # å§“å self.name = name # æžªï¼Œå£«å…µåˆå§‹æ²¡æœ‰æžª None å…³é”®å­—è¡¨ç¤ºä»€ä¹ˆéƒ½æ²¡æœ‰ self.gun = None def fire(self): # 1. åˆ¤æ–­å£«å…µæ˜¯å¦æœ‰æžª if self.gun is None: print("[%s] è¿˜æ²¡æœ‰æžª..." % self.name) return # 2. é«˜å–Šå£å· print("å†²å•Š...[%s]" % self.name) # 3. è®©æžªè£…å¡«å­å¼¹ self.gun.add_bullet(50) # 4. è®©æžªå‘å°„å­å¼¹ self.gun.shoot()å°ç»“åˆ›å»ºäº†ä¸€ä¸ª å£«å…µç±»ï¼Œä½¿ç”¨åˆ° init å†…ç½®æ–¹æ³•åœ¨å®šä¹‰å±žæ€§æ—¶ï¼Œå¦‚æžœ ä¸çŸ¥é“è®¾ç½®ä»€ä¹ˆåˆå§‹å€¼ï¼Œå¯ä»¥è®¾ç½®ä¸º Noneåœ¨ å°è£…çš„ æ–¹æ³•å†…éƒ¨ï¼Œè¿˜å¯ä»¥è®© è‡ªå·±çš„ ä½¿ç”¨å…¶ä»–ç±»åˆ›å»ºçš„å¯¹è±¡å±žæ€§ è°ƒç”¨å·²ç» å°è£…å¥½çš„æ–¹æ³•02. èº«ä»½è¿ç®—ç¬¦èº«ä»½è¿ç®—ç¬¦ç”¨äºŽ æ¯”è¾ƒ ä¸¤ä¸ªå¯¹è±¡çš„ å†…å­˜åœ°å€ æ˜¯å¦ä¸€è‡´ â€”â€” æ˜¯å¦æ˜¯å¯¹åŒä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨åœ¨ Python ä¸­é’ˆå¯¹ None æ¯”è¾ƒæ—¶ï¼Œå»ºè®®ä½¿ç”¨ is åˆ¤æ–­è¿ç®—ç¬¦æè¿°å®žä¾‹isis æ˜¯åˆ¤æ–­ä¸¤ä¸ªæ ‡è¯†ç¬¦æ˜¯ä¸æ˜¯å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡x is yï¼Œç±»ä¼¼ id(x) == id(y)is notis not æ˜¯åˆ¤æ–­ä¸¤ä¸ªæ ‡è¯†ç¬¦æ˜¯ä¸æ˜¯å¼•ç”¨ä¸åŒå¯¹è±¡x is not yï¼Œç±»ä¼¼ id(a) != id(b)is ä¸Ž == åŒºåˆ«ï¼šis ç”¨äºŽåˆ¤æ–­ ä¸¤ä¸ªå˜é‡ å¼•ç”¨å¯¹è±¡æ˜¯å¦ä¸ºåŒä¸€ä¸ª== ç”¨äºŽåˆ¤æ–­ å¼•ç”¨å˜é‡çš„å€¼ æ˜¯å¦ç›¸ç­‰123456&gt;&gt;&gt; a = [1, 2, 3]&gt;&gt;&gt; b = [1, 2, 3]&gt;&gt;&gt; b is a False&gt;&gt;&gt; b == aTrueç§æœ‰å±žæ€§å’Œç§æœ‰æ–¹æ³•01. åº”ç”¨åœºæ™¯åŠå®šä¹‰æ–¹å¼åº”ç”¨åœºæ™¯åœ¨å®žé™…å¼€å‘ä¸­ï¼Œå¯¹è±¡ çš„ æŸäº›å±žæ€§æˆ–æ–¹æ³• å¯èƒ½åªå¸Œæœ› åœ¨å¯¹è±¡çš„å†…éƒ¨è¢«ä½¿ç”¨ï¼Œè€Œ ä¸å¸Œæœ›åœ¨å¤–éƒ¨è¢«è®¿é—®åˆ°ç§æœ‰å±žæ€§ å°±æ˜¯ å¯¹è±¡ ä¸å¸Œæœ›å…¬å¼€çš„ å±žæ€§ç§æœ‰æ–¹æ³• å°±æ˜¯ å¯¹è±¡ ä¸å¸Œæœ›å…¬å¼€çš„ æ–¹æ³•å®šä¹‰æ–¹å¼åœ¨ å®šä¹‰å±žæ€§æˆ–æ–¹æ³•æ—¶ï¼Œåœ¨ å±žæ€§åæˆ–è€…æ–¹æ³•åå‰ å¢žåŠ  ä¸¤ä¸ªä¸‹åˆ’çº¿ï¼Œå®šä¹‰çš„å°±æ˜¯ ç§æœ‰ å±žæ€§æˆ–æ–¹æ³•12345678910111213141516class Women: def __init__(self, name): self.name = name # ä¸è¦é—®å¥³ç”Ÿçš„å¹´é¾„ self.__age = 18 def __secret(self): print("æˆ‘çš„å¹´é¾„æ˜¯ %d" % self.__age)xiaofang = Women("å°èŠ³")# ç§æœ‰å±žæ€§ï¼Œå¤–éƒ¨ä¸èƒ½ç›´æŽ¥è®¿é—®# print(xiaofang.__age)# ç§æœ‰æ–¹æ³•ï¼Œå¤–éƒ¨ä¸èƒ½ç›´æŽ¥è°ƒç”¨# xiaofang.__secret()02. ä¼ªç§æœ‰å±žæ€§å’Œç§æœ‰æ–¹æ³•ï¼ˆçŸ¥è¯†ç‚¹ï¼‰æç¤ºï¼šåœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œä¸è¦ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œè®¿é—®å¯¹è±¡çš„ ç§æœ‰å±žæ€§ æˆ– ç§æœ‰æ–¹æ³•Python ä¸­ï¼Œå¹¶æ²¡æœ‰ çœŸæ­£æ„ä¹‰ çš„ ç§æœ‰åœ¨ç»™ å±žæ€§ã€æ–¹æ³• å‘½åæ—¶ï¼Œå®žé™…æ˜¯å¯¹ åç§° åšäº†ä¸€äº›ç‰¹æ®Šå¤„ç†ï¼Œä½¿å¾—å¤–ç•Œæ— æ³•è®¿é—®åˆ°å¤„ç†æ–¹å¼ï¼šåœ¨ åç§° å‰é¢åŠ ä¸Š _ç±»å =&gt; _ç±»å__åç§°12345# ç§æœ‰å±žæ€§ï¼Œå¤–éƒ¨ä¸èƒ½ç›´æŽ¥è®¿é—®åˆ°print(xiaofang._Women__age)# ç§æœ‰æ–¹æ³•ï¼Œå¤–éƒ¨ä¸èƒ½ç›´æŽ¥è°ƒç”¨xiaofang._Women__secret()ç»§æ‰¿é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§å°è£… æ ¹æ® èŒè´£ å°† å±žæ€§ å’Œ æ–¹æ³• å°è£… åˆ°ä¸€ä¸ªæŠ½è±¡çš„ ç±» ä¸­ç»§æ‰¿ å®žçŽ°ä»£ç çš„é‡ç”¨ï¼Œç›¸åŒçš„ä»£ç ä¸éœ€è¦é‡å¤çš„ç¼–å†™å¤šæ€ ä¸åŒçš„å¯¹è±¡è°ƒç”¨ç›¸åŒçš„æ–¹æ³•ï¼Œäº§ç”Ÿä¸åŒçš„æ‰§è¡Œç»“æžœï¼Œå¢žåŠ ä»£ç çš„çµæ´»åº¦01. å•ç»§æ‰¿1.1 ç»§æ‰¿çš„æ¦‚å¿µã€è¯­æ³•å’Œç‰¹ç‚¹ç»§æ‰¿çš„æ¦‚å¿µï¼šå­ç±» æ‹¥æœ‰ çˆ¶ç±» çš„æ‰€æœ‰ æ–¹æ³• å’Œ å±žæ€§1) ç»§æ‰¿çš„è¯­æ³•12class ç±»å(çˆ¶ç±»å): passå­ç±» ç»§æ‰¿è‡ª çˆ¶ç±»ï¼Œå¯ä»¥ç›´æŽ¥ äº«å— çˆ¶ç±»ä¸­å·²ç»å°è£…å¥½çš„æ–¹æ³•ï¼Œä¸éœ€è¦å†æ¬¡å¼€å‘å­ç±» ä¸­åº”è¯¥æ ¹æ® èŒè´£ï¼Œå°è£… å­ç±»ç‰¹æœ‰çš„ å±žæ€§å’Œæ–¹æ³•2) ä¸“ä¸šæœ¯è¯­Dog ç±»æ˜¯ Animal ç±»çš„å­ç±»ï¼ŒAnimal ç±»æ˜¯ Dog ç±»çš„çˆ¶ç±»ï¼ŒDog ç±»ä»Ž Animal ç±»ç»§æ‰¿Dog ç±»æ˜¯ Animal ç±»çš„æ´¾ç”Ÿç±»ï¼ŒAnimal ç±»æ˜¯ Dog ç±»çš„åŸºç±»ï¼ŒDog ç±»ä»Ž Animal ç±»æ´¾ç”Ÿ3) ç»§æ‰¿çš„ä¼ é€’æ€§C ç±»ä»Ž B ç±»ç»§æ‰¿ï¼ŒB ç±»åˆä»Ž A ç±»ç»§æ‰¿é‚£ä¹ˆ C ç±»å°±å…·æœ‰ B ç±»å’Œ A ç±»çš„æ‰€æœ‰å±žæ€§å’Œæ–¹æ³•å­ç±» æ‹¥æœ‰ çˆ¶ç±» ä»¥åŠ çˆ¶ç±»çš„çˆ¶ç±» ä¸­å°è£…çš„æ‰€æœ‰ å±žæ€§ å’Œ æ–¹æ³•1.2 æ–¹æ³•çš„é‡å†™å­ç±» æ‹¥æœ‰ çˆ¶ç±» çš„æ‰€æœ‰ æ–¹æ³• å’Œ å±žæ€§å­ç±» ç»§æ‰¿è‡ª çˆ¶ç±»ï¼Œå¯ä»¥ç›´æŽ¥ äº«å— çˆ¶ç±»ä¸­å·²ç»å°è£…å¥½çš„æ–¹æ³•ï¼Œä¸éœ€è¦å†æ¬¡å¼€å‘åº”ç”¨åœºæ™¯å½“ çˆ¶ç±» çš„æ–¹æ³•å®žçŽ°ä¸èƒ½æ»¡è¶³å­ç±»éœ€æ±‚æ—¶ï¼Œå¯ä»¥å¯¹æ–¹æ³•è¿›è¡Œ é‡å†™(override)é‡å†™ çˆ¶ç±»æ–¹æ³•æœ‰ä¸¤ç§æƒ…å†µï¼šè¦†ç›– çˆ¶ç±»çš„æ–¹æ³•å¯¹çˆ¶ç±»æ–¹æ³•è¿›è¡Œ æ‰©å±•1) è¦†ç›–çˆ¶ç±»çš„æ–¹æ³•å¦‚æžœåœ¨å¼€å‘ä¸­ï¼Œçˆ¶ç±»çš„æ–¹æ³•å®žçŽ° å’Œ å­ç±»çš„æ–¹æ³•å®žçŽ°ï¼Œå®Œå…¨ä¸åŒå°±å¯ä»¥ä½¿ç”¨ è¦†ç›– çš„æ–¹å¼ï¼Œåœ¨å­ç±»ä¸­ é‡æ–°ç¼–å†™ çˆ¶ç±»çš„æ–¹æ³•å®žçŽ°å…·ä½“çš„å®žçŽ°æ–¹å¼ï¼Œå°±ç›¸å½“äºŽåœ¨ å­ç±»ä¸­ å®šä¹‰äº†ä¸€ä¸ª å’Œçˆ¶ç±»åŒåçš„æ–¹æ³•å¹¶ä¸”å®žçŽ°é‡å†™ä¹‹åŽï¼Œåœ¨è¿è¡Œæ—¶ï¼Œåªä¼šè°ƒç”¨ å­ç±»ä¸­é‡å†™çš„æ–¹æ³•ï¼Œè€Œä¸å†ä¼šè°ƒç”¨ çˆ¶ç±»å°è£…çš„æ–¹æ³•2) å¯¹çˆ¶ç±»æ–¹æ³•è¿›è¡Œ æ‰©å±•å¦‚æžœåœ¨å¼€å‘ä¸­ï¼Œå­ç±»çš„æ–¹æ³•å®žçŽ° ä¸­ åŒ…å« çˆ¶ç±»çš„æ–¹æ³•å®žçŽ°çˆ¶ç±»åŽŸæœ¬å°è£…çš„æ–¹æ³•å®žçŽ° æ˜¯ å­ç±»æ–¹æ³•çš„ä¸€éƒ¨åˆ†å°±å¯ä»¥ä½¿ç”¨ æ‰©å±• çš„æ–¹å¼åœ¨å­ç±»ä¸­ é‡å†™ çˆ¶ç±»çš„æ–¹æ³•åœ¨éœ€è¦çš„ä½ç½®ä½¿ç”¨ super().çˆ¶ç±»æ–¹æ³• æ¥è°ƒç”¨çˆ¶ç±»æ–¹æ³•çš„æ‰§è¡Œä»£ç å…¶ä»–çš„ä½ç½®é’ˆå¯¹å­ç±»çš„éœ€æ±‚ï¼Œç¼–å†™ å­ç±»ç‰¹æœ‰çš„ä»£ç å®žçŽ°å…³äºŽ superåœ¨ Python ä¸­ super æ˜¯ä¸€ä¸ª ç‰¹æ®Šçš„ç±»super() å°±æ˜¯ä½¿ç”¨ super ç±»åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡æœ€å¸¸ ä½¿ç”¨çš„åœºæ™¯å°±æ˜¯åœ¨ é‡å†™çˆ¶ç±»æ–¹æ³•æ—¶ï¼Œè°ƒç”¨ åœ¨çˆ¶ç±»ä¸­å°è£…çš„æ–¹æ³•å®žçŽ°è°ƒç”¨çˆ¶ç±»æ–¹æ³•çš„å¦å¤–ä¸€ç§æ–¹å¼ï¼ˆçŸ¥é“ï¼‰åœ¨ Python 2.x æ—¶ï¼Œå¦‚æžœéœ€è¦è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼ï¼š1çˆ¶ç±»å.æ–¹æ³•(self)è¿™ç§æ–¹å¼ï¼Œç›®å‰åœ¨ Python 3.x è¿˜æ”¯æŒè¿™ç§æ–¹å¼è¿™ç§æ–¹æ³• ä¸æŽ¨èä½¿ç”¨ï¼Œå› ä¸ºä¸€æ—¦ çˆ¶ç±»å‘ç”Ÿå˜åŒ–ï¼Œæ–¹æ³•è°ƒç”¨ä½ç½®çš„ ç±»å åŒæ ·éœ€è¦ä¿®æ”¹æç¤ºåœ¨å¼€å‘æ—¶ï¼Œçˆ¶ç±»å å’Œ super() ä¸¤ç§æ–¹å¼ä¸è¦æ··ç”¨å¦‚æžœä½¿ç”¨ å½“å‰å­ç±»å è°ƒç”¨æ–¹æ³•ï¼Œä¼šå½¢æˆé€’å½’è°ƒç”¨ï¼Œå‡ºçŽ°æ­»å¾ªçŽ¯1.3 çˆ¶ç±»çš„ ç§æœ‰å±žæ€§ å’Œ ç§æœ‰æ–¹æ³•å­ç±»å¯¹è±¡ ä¸èƒ½ åœ¨è‡ªå·±çš„æ–¹æ³•å†…éƒ¨ï¼Œç›´æŽ¥ è®¿é—® çˆ¶ç±»çš„ ç§æœ‰å±žæ€§ æˆ– ç§æœ‰æ–¹æ³•å­ç±»å¯¹è±¡ å¯ä»¥é€šè¿‡ çˆ¶ç±» çš„ å…¬æœ‰æ–¹æ³• é—´æŽ¥ è®¿é—®åˆ° ç§æœ‰å±žæ€§ æˆ– ç§æœ‰æ–¹æ³•ç§æœ‰å±žæ€§ã€æ–¹æ³• æ˜¯å¯¹è±¡çš„éšç§ï¼Œä¸å¯¹å¤–å…¬å¼€ï¼Œå¤–ç•Œ ä»¥åŠ å­ç±» éƒ½ä¸èƒ½ç›´æŽ¥è®¿é—®ç§æœ‰å±žæ€§ã€æ–¹æ³• é€šå¸¸ç”¨äºŽåšä¸€äº›å†…éƒ¨çš„äº‹æƒ…02. å¤šç»§æ‰¿æ¦‚å¿µå­ç±» å¯ä»¥æ‹¥æœ‰ å¤šä¸ªçˆ¶ç±»ï¼Œå¹¶ä¸”å…·æœ‰ æ‰€æœ‰çˆ¶ç±» çš„ å±žæ€§ å’Œ æ–¹æ³•ä¾‹å¦‚ï¼šå­©å­ ä¼šç»§æ‰¿è‡ªå·± çˆ¶äº² å’Œ æ¯äº² çš„ ç‰¹æ€§è¯­æ³•12class å­ç±»å(çˆ¶ç±»å1, çˆ¶ç±»å2...) pass2.1 å¤šç»§æ‰¿çš„ä½¿ç”¨æ³¨æ„äº‹é¡¹å¦‚æžœ ä¸åŒçš„çˆ¶ç±» ä¸­å­˜åœ¨ åŒåçš„æ–¹æ³•ï¼Œå­ç±»å¯¹è±¡ åœ¨è°ƒç”¨æ–¹æ³•æ—¶ï¼Œä¼šè°ƒç”¨ å“ªä¸€ä¸ªçˆ¶ç±»ä¸­çš„æ–¹æ³•å‘¢ï¼Ÿå¼€å‘æ—¶ï¼Œåº”è¯¥å°½é‡é¿å…è¿™ç§å®¹æ˜“äº§ç”Ÿæ··æ·†çš„æƒ…å†µï¼ â€”â€” å¦‚æžœ çˆ¶ç±»ä¹‹é—´ å­˜åœ¨ åŒåçš„å±žæ€§æˆ–è€…æ–¹æ³•ï¼Œåº”è¯¥ å°½é‡é¿å… ä½¿ç”¨å¤šç»§æ‰¿Python ä¸­çš„ MRO â€”â€” æ–¹æ³•æœç´¢é¡ºåºï¼ˆçŸ¥é“ï¼‰Python ä¸­é’ˆå¯¹ ç±» æä¾›äº†ä¸€ä¸ª å†…ç½®å±žæ€§ mro å¯ä»¥æŸ¥çœ‹ æ–¹æ³• æœç´¢é¡ºåºMRO æ˜¯ method resolution orderï¼Œä¸»è¦ç”¨äºŽ åœ¨å¤šç»§æ‰¿æ—¶åˆ¤æ–­ æ–¹æ³•ã€å±žæ€§ çš„è°ƒç”¨ è·¯å¾„1print(ç±»å.__mro__)åœ¨æœç´¢æ–¹æ³•æ—¶ï¼Œæ˜¯æŒ‰ç…§ mro çš„è¾“å‡ºç»“æžœ ä»Žå·¦è‡³å³ çš„é¡ºåºæŸ¥æ‰¾çš„å¦‚æžœåœ¨å½“å‰ç±»ä¸­ æ‰¾åˆ°æ–¹æ³•ï¼Œå°±ç›´æŽ¥æ‰§è¡Œï¼Œä¸å†æœç´¢å¦‚æžœ æ²¡æœ‰æ‰¾åˆ°ï¼Œå°±æŸ¥æ‰¾ä¸‹ä¸€ä¸ªç±» ä¸­æ˜¯å¦æœ‰å¯¹åº”çš„æ–¹æ³•ï¼Œå¦‚æžœæ‰¾åˆ°ï¼Œå°±ç›´æŽ¥æ‰§è¡Œï¼Œä¸å†æœç´¢å¦‚æžœæ‰¾åˆ°æœ€åŽä¸€ä¸ªç±»ï¼Œè¿˜æ²¡æœ‰æ‰¾åˆ°æ–¹æ³•ï¼Œç¨‹åºæŠ¥é”™2.2 æ–°å¼ç±»ä¸Žæ—§å¼ï¼ˆç»å…¸ï¼‰ç±»object æ˜¯ Python ä¸ºæ‰€æœ‰å¯¹è±¡æä¾›çš„ åŸºç±»ï¼Œæä¾›æœ‰ä¸€äº›å†…ç½®çš„å±žæ€§å’Œæ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨ dir å‡½æ•°æŸ¥çœ‹æ–°å¼ç±»ï¼šä»¥ object ä¸ºåŸºç±»çš„ç±»ï¼ŒæŽ¨èä½¿ç”¨ç»å…¸ç±»ï¼šä¸ä»¥ object ä¸ºåŸºç±»çš„ç±»ï¼Œä¸æŽ¨èä½¿ç”¨åœ¨ Python 3.x ä¸­å®šä¹‰ç±»æ—¶ï¼Œå¦‚æžœæ²¡æœ‰æŒ‡å®šçˆ¶ç±»ï¼Œä¼š é»˜è®¤ä½¿ç”¨ object ä½œä¸ºè¯¥ç±»çš„ åŸºç±» â€”â€” Python 3.x ä¸­å®šä¹‰çš„ç±»éƒ½æ˜¯ æ–°å¼ç±»åœ¨ Python 2.x ä¸­å®šä¹‰ç±»æ—¶ï¼Œå¦‚æžœæ²¡æœ‰æŒ‡å®šçˆ¶ç±»ï¼Œåˆ™ä¸ä¼šä»¥ object ä½œä¸º åŸºç±»æ–°å¼ç±» å’Œ ç»å…¸ç±» åœ¨å¤šç»§æ‰¿æ—¶ â€”â€” ä¼šå½±å“åˆ°æ–¹æ³•çš„æœç´¢é¡ºåºä¸ºäº†ä¿è¯ç¼–å†™çš„ä»£ç èƒ½å¤ŸåŒæ—¶åœ¨ Python 2.x å’Œ Python 3.x è¿è¡Œï¼ä»ŠåŽåœ¨å®šä¹‰ç±»æ—¶ï¼Œå¦‚æžœæ²¡æœ‰çˆ¶ç±»ï¼Œå»ºè®®ç»Ÿä¸€ç»§æ‰¿è‡ª object12class ç±»å(object): passå¤šæ€é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§å°è£… æ ¹æ® èŒè´£ å°† å±žæ€§ å’Œ æ–¹æ³• å°è£… åˆ°ä¸€ä¸ªæŠ½è±¡çš„ ç±» ä¸­å®šä¹‰ç±»çš„å‡†åˆ™ç»§æ‰¿ å®žçŽ°ä»£ç çš„é‡ç”¨ï¼Œç›¸åŒçš„ä»£ç ä¸éœ€è¦é‡å¤çš„ç¼–å†™è®¾è®¡ç±»çš„æŠ€å·§å­ç±»é’ˆå¯¹è‡ªå·±ç‰¹æœ‰çš„éœ€æ±‚ï¼Œç¼–å†™ç‰¹å®šçš„ä»£ç å¤šæ€ ä¸åŒçš„ å­ç±»å¯¹è±¡ è°ƒç”¨ç›¸åŒçš„ çˆ¶ç±»æ–¹æ³•ï¼Œäº§ç”Ÿä¸åŒçš„æ‰§è¡Œç»“æžœå¤šæ€ å¯ä»¥ å¢žåŠ ä»£ç çš„çµæ´»åº¦ä»¥ ç»§æ‰¿ å’Œ é‡å†™çˆ¶ç±»æ–¹æ³• ä¸ºå‰ææ˜¯è°ƒç”¨æ–¹æ³•çš„æŠ€å·§ï¼Œä¸ä¼šå½±å“åˆ°ç±»çš„å†…éƒ¨è®¾è®¡å¤šæ€æ¡ˆä¾‹æ¼”ç»ƒéœ€æ±‚åœ¨ Dog ç±»ä¸­å°è£…æ–¹æ³• gameæ™®é€šç‹—åªæ˜¯ç®€å•çš„çŽ©è€å®šä¹‰ XiaoTianDog ç»§æ‰¿è‡ª Dogï¼Œå¹¶ä¸”é‡å†™ game æ–¹æ³•å“®å¤©çŠ¬éœ€è¦åœ¨å¤©ä¸ŠçŽ©è€å®šä¹‰ Person ç±»ï¼Œå¹¶ä¸”å°è£…ä¸€ä¸ª å’Œç‹—çŽ© çš„æ–¹æ³•åœ¨æ–¹æ³•å†…éƒ¨ï¼Œç›´æŽ¥è®© ç‹—å¯¹è±¡ è°ƒç”¨ game æ–¹æ³•æ¡ˆä¾‹å°ç»“Person ç±»ä¸­åªéœ€è¦è®© ç‹—å¯¹è±¡ è°ƒç”¨ game æ–¹æ³•ï¼Œè€Œä¸å…³å¿ƒå…·ä½“æ˜¯ ä»€ä¹ˆç‹—game æ–¹æ³•æ˜¯åœ¨ Dog çˆ¶ç±»ä¸­å®šä¹‰çš„åœ¨ç¨‹åºæ‰§è¡Œæ—¶ï¼Œä¼ å…¥ä¸åŒçš„ ç‹—å¯¹è±¡ å®žå‚ï¼Œå°±ä¼šäº§ç”Ÿä¸åŒçš„æ‰§è¡Œæ•ˆæžœå¤šæ€ æ›´å®¹æ˜“ç¼–å†™å‡ºå‡ºé€šç”¨çš„ä»£ç ï¼Œåšå‡ºé€šç”¨çš„ç¼–ç¨‹ï¼Œä»¥é€‚åº”éœ€æ±‚çš„ä¸æ–­å˜åŒ–ï¼1234567891011121314151617181920212223242526272829class Dog(object): def __init__(self, name): self.name = name def game(self): print("%s è¹¦è¹¦è·³è·³çš„çŽ©è€..." % self.name)class XiaoTianDog(Dog): def game(self): print("%s é£žåˆ°å¤©ä¸ŠåŽ»çŽ©è€..." % self.name)class Person(object): def __init__(self, name): self.name = name def game_with_dog(self, dog): print("%s å’Œ %s å¿«ä¹çš„çŽ©è€..." % (self.name, dog.name)) # è®©ç‹—çŽ©è€ dog.game()# 1. åˆ›å»ºä¸€ä¸ªç‹—å¯¹è±¡# wangcai = Dog("æ—ºè´¢")wangcai = XiaoTianDog("é£žå¤©æ—ºè´¢")# 2. åˆ›å»ºä¸€ä¸ªå°æ˜Žå¯¹è±¡xiaoming = Person("å°æ˜Ž")# 3. è®©å°æ˜Žè°ƒç”¨å’Œç‹—çŽ©çš„æ–¹æ³•xiaoming.game_with_dog(wangcai)ç±»å±žæ€§å’Œç±»æ–¹æ³•01. ç±»çš„ç»“æž„1.1 æœ¯è¯­ â€”â€” å®žä¾‹ä½¿ç”¨é¢ç›¸å¯¹è±¡å¼€å‘ï¼Œç¬¬ 1 æ­¥ æ˜¯è®¾è®¡ ç±»ä½¿ç”¨ ç±»å() åˆ›å»ºå¯¹è±¡ï¼Œåˆ›å»ºå¯¹è±¡ çš„åŠ¨ä½œæœ‰ä¸¤æ­¥ï¼š1) åœ¨å†…å­˜ä¸­ä¸ºå¯¹è±¡ åˆ†é…ç©ºé—´2) è°ƒç”¨åˆå§‹åŒ–æ–¹æ³• init ä¸º å¯¹è±¡åˆå§‹åŒ–å¯¹è±¡åˆ›å»ºåŽï¼Œå†…å­˜ ä¸­å°±æœ‰äº†ä¸€ä¸ªå¯¹è±¡çš„ å®žå®žåœ¨åœ¨ çš„å­˜åœ¨ â€”â€” å®žä¾‹å› æ­¤ï¼Œé€šå¸¸ä¹Ÿä¼šæŠŠï¼šåˆ›å»ºå‡ºæ¥çš„ å¯¹è±¡ å«åš ç±» çš„ å®žä¾‹åˆ›å»ºå¯¹è±¡çš„ åŠ¨ä½œ å«åš å®žä¾‹åŒ–å¯¹è±¡çš„å±žæ€§ å«åš å®žä¾‹å±žæ€§å¯¹è±¡è°ƒç”¨çš„æ–¹æ³• å«åš å®žä¾‹æ–¹æ³•åœ¨ç¨‹åºæ‰§è¡Œæ—¶ï¼šå¯¹è±¡å„è‡ªæ‹¥æœ‰è‡ªå·±çš„ å®žä¾‹å±žæ€§è°ƒç”¨å¯¹è±¡æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡ self.è®¿é—®è‡ªå·±çš„å±žæ€§è°ƒç”¨è‡ªå·±çš„æ–¹æ³•ç»“è®ºæ¯ä¸€ä¸ªå¯¹è±¡ éƒ½æœ‰è‡ªå·± ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ï¼Œä¿å­˜å„è‡ªä¸åŒçš„å±žæ€§å¤šä¸ªå¯¹è±¡çš„æ–¹æ³•ï¼Œåœ¨å†…å­˜ä¸­åªæœ‰ä¸€ä»½ï¼Œåœ¨è°ƒç”¨æ–¹æ³•æ—¶ï¼Œéœ€è¦æŠŠå¯¹è±¡çš„å¼•ç”¨ ä¼ é€’åˆ°æ–¹æ³•å†…éƒ¨1.2 ç±»æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å¯¹è±¡Python ä¸­ ä¸€åˆ‡çš†å¯¹è±¡ï¼šclass AAA: å®šä¹‰çš„ç±»å±žäºŽ ç±»å¯¹è±¡obj1 = AAA() å±žäºŽ å®žä¾‹å¯¹è±¡åœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œç±» åŒæ · ä¼šè¢«åŠ è½½åˆ°å†…å­˜åœ¨ Python ä¸­ï¼Œç±» æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å¯¹è±¡ â€”â€” ç±»å¯¹è±¡åœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œç±»å¯¹è±¡ åœ¨å†…å­˜ä¸­ åªæœ‰ä¸€ä»½ï¼Œä½¿ç”¨ ä¸€ä¸ªç±» å¯ä»¥åˆ›å»ºå‡º å¾ˆå¤šä¸ªå¯¹è±¡å®žä¾‹é™¤äº†å°è£… å®žä¾‹ çš„ å±žæ€§ å’Œ æ–¹æ³•å¤–ï¼Œç±»å¯¹è±¡ è¿˜å¯ä»¥æ‹¥æœ‰è‡ªå·±çš„ å±žæ€§ å’Œ æ–¹æ³•ç±»å±žæ€§ç±»æ–¹æ³•é€šè¿‡ ç±»å. çš„æ–¹å¼å¯ä»¥ è®¿é—®ç±»çš„å±žæ€§ æˆ–è€… è°ƒç”¨ç±»çš„æ–¹æ³•02. ç±»å±žæ€§å’Œå®žä¾‹å±žæ€§2.1 æ¦‚å¿µå’Œä½¿ç”¨ç±»å±žæ€§ å°±æ˜¯ç»™ ç±»å¯¹è±¡ ä¸­å®šä¹‰çš„ å±žæ€§é€šå¸¸ç”¨æ¥è®°å½• ä¸Žè¿™ä¸ªç±»ç›¸å…³ çš„ç‰¹å¾ç±»å±žæ€§ ä¸ä¼šç”¨äºŽè®°å½• å…·ä½“å¯¹è±¡çš„ç‰¹å¾ç¤ºä¾‹éœ€æ±‚å®šä¹‰ä¸€ä¸ª å·¥å…·ç±»æ¯ä»¶å·¥å…·éƒ½æœ‰è‡ªå·±çš„ nameéœ€æ±‚ â€”â€” çŸ¥é“ä½¿ç”¨è¿™ä¸ªç±»ï¼Œåˆ›å»ºäº†å¤šå°‘ä¸ªå·¥å…·å¯¹è±¡ï¼Ÿ12345678910111213141516class Tool(object): # ä½¿ç”¨èµ‹å€¼è¯­å¥ï¼Œå®šä¹‰ç±»å±žæ€§ï¼Œè®°å½•åˆ›å»ºå·¥å…·å¯¹è±¡çš„æ€»æ•° count = 0 def __init__(self, name): self.name = name # é’ˆå¯¹ç±»å±žæ€§åšä¸€ä¸ªè®¡æ•°+1 Tool.count += 1# åˆ›å»ºå·¥å…·å¯¹è±¡tool1 = Tool("æ–§å¤´")tool2 = Tool("æ¦”å¤´")tool3 = Tool("é“é”¹")# çŸ¥é“ä½¿ç”¨ Tool ç±»åˆ°åº•åˆ›å»ºäº†å¤šå°‘ä¸ªå¯¹è±¡?print("çŽ°åœ¨åˆ›å»ºäº† %d ä¸ªå·¥å…·" % Tool.count)2.2 å±žæ€§çš„èŽ·å–æœºåˆ¶ï¼ˆç§‘æ™®ï¼‰åœ¨ Python ä¸­ å±žæ€§çš„èŽ·å– å­˜åœ¨ä¸€ä¸ª å‘ä¸ŠæŸ¥æ‰¾æœºåˆ¶å› æ­¤ï¼Œè¦è®¿é—®ç±»å±žæ€§æœ‰ä¸¤ç§æ–¹å¼ï¼šç±»å.ç±»å±žæ€§å¯¹è±¡.ç±»å±žæ€§ ï¼ˆä¸æŽ¨èï¼‰æ³¨æ„å¦‚æžœä½¿ç”¨ å¯¹è±¡.ç±»å±žæ€§ = å€¼ èµ‹å€¼è¯­å¥ï¼Œåªä¼š ç»™å¯¹è±¡æ·»åŠ ä¸€ä¸ªå±žæ€§ï¼Œè€Œä¸ä¼šå½±å“åˆ° ç±»å±žæ€§çš„å€¼03. ç±»æ–¹æ³•å’Œé™æ€æ–¹æ³•3.1 ç±»æ–¹æ³•ç±»å±žæ€§ å°±æ˜¯é’ˆå¯¹ ç±»å¯¹è±¡ å®šä¹‰çš„å±žæ€§ä½¿ç”¨ èµ‹å€¼è¯­å¥ åœ¨ class å…³é”®å­—ä¸‹æ–¹å¯ä»¥å®šä¹‰ ç±»å±žæ€§ç±»å±žæ€§ ç”¨äºŽè®°å½• ä¸Žè¿™ä¸ªç±»ç›¸å…³ çš„ç‰¹å¾ç±»æ–¹æ³• å°±æ˜¯é’ˆå¯¹ ç±»å¯¹è±¡ å®šä¹‰çš„æ–¹æ³•åœ¨ ç±»æ–¹æ³• å†…éƒ¨å¯ä»¥ç›´æŽ¥è®¿é—® ç±»å±žæ€§ æˆ–è€…è°ƒç”¨å…¶ä»–çš„ ç±»æ–¹æ³•è¯­æ³•å¦‚ä¸‹123@classmethoddef ç±»æ–¹æ³•å(cls): passç±»æ–¹æ³•éœ€è¦ç”¨ ä¿®é¥°å™¨ @classmethod æ¥æ ‡è¯†ï¼Œå‘Šè¯‰è§£é‡Šå™¨è¿™æ˜¯ä¸€ä¸ªç±»æ–¹æ³•ç±»æ–¹æ³•çš„ ç¬¬ä¸€ä¸ªå‚æ•° åº”è¯¥æ˜¯ clsç”± å“ªä¸€ä¸ªç±» è°ƒç”¨çš„æ–¹æ³•ï¼Œæ–¹æ³•å†…çš„ cls å°±æ˜¯ å“ªä¸€ä¸ªç±»çš„å¼•ç”¨è¿™ä¸ªå‚æ•°å’Œ å®žä¾‹æ–¹æ³• çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ self ç±»ä¼¼æç¤º ä½¿ç”¨å…¶ä»–åç§°ä¹Ÿå¯ä»¥ï¼Œä¸è¿‡ä¹ æƒ¯ä½¿ç”¨ clsé€šè¿‡ ç±»å. è°ƒç”¨ ç±»æ–¹æ³•ï¼Œè°ƒç”¨æ–¹æ³•æ—¶ï¼Œä¸éœ€è¦ä¼ é€’ cls å‚æ•°åœ¨æ–¹æ³•å†…éƒ¨å¯ä»¥é€šè¿‡ cls. è®¿é—®ç±»çš„å±žæ€§ä¹Ÿå¯ä»¥é€šè¿‡ cls. è°ƒç”¨å…¶ä»–çš„ç±»æ–¹æ³•ç¤ºä¾‹éœ€æ±‚å®šä¹‰ä¸€ä¸ª å·¥å…·ç±»æ¯ä»¶å·¥å…·éƒ½æœ‰è‡ªå·±çš„ nameéœ€æ±‚ â€”â€” åœ¨ ç±» å°è£…ä¸€ä¸ª show_tool_count çš„ç±»æ–¹æ³•ï¼Œè¾“å‡ºä½¿ç”¨å½“å‰è¿™ä¸ªç±»ï¼Œåˆ›å»ºçš„å¯¹è±¡ä¸ªæ•°1234@classmethoddef show_tool_count(cls): """æ˜¾ç¤ºå·¥å…·å¯¹è±¡çš„æ€»æ•°""" print("å·¥å…·å¯¹è±¡çš„æ€»æ•° %d" % cls.count)åœ¨ç±»æ–¹æ³•å†…éƒ¨ï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨ cls è®¿é—® ç±»å±žæ€§ æˆ–è€… è°ƒç”¨ç±»æ–¹æ³•3.2 é™æ€æ–¹æ³•åœ¨å¼€å‘æ—¶ï¼Œå¦‚æžœéœ€è¦åœ¨ ç±» ä¸­å°è£…ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ï¼šæ—¢ ä¸éœ€è¦ è®¿é—® å®žä¾‹å±žæ€§ æˆ–è€…è°ƒç”¨ å®žä¾‹æ–¹æ³•ä¹Ÿ ä¸éœ€è¦ è®¿é—® ç±»å±žæ€§ æˆ–è€…è°ƒç”¨ ç±»æ–¹æ³•è¿™ä¸ªæ—¶å€™ï¼Œå¯ä»¥æŠŠè¿™ä¸ªæ–¹æ³•å°è£…æˆä¸€ä¸ª é™æ€æ–¹æ³•è¯­æ³•å¦‚ä¸‹ï¼š123@staticmethoddef é™æ€æ–¹æ³•å(): passé™æ€æ–¹æ³• éœ€è¦ç”¨ ä¿®é¥°å™¨ @staticmethod æ¥æ ‡è¯†ï¼Œå‘Šè¯‰è§£é‡Šå™¨è¿™æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•é€šè¿‡ ç±»å. è°ƒç”¨ é™æ€æ–¹æ³•1234567891011class Dog(object): # ç‹—å¯¹è±¡è®¡æ•° dog_count = 0 @staticmethod def run(): # ä¸éœ€è¦è®¿é—®å®žä¾‹å±žæ€§ä¹Ÿä¸éœ€è¦è®¿é—®ç±»å±žæ€§çš„æ–¹æ³• print("ç‹—åœ¨è·‘...") def __init__(self, name): self.name = name3.3 æ–¹æ³•ç»¼åˆæ¡ˆä¾‹éœ€æ±‚è®¾è®¡ä¸€ä¸ª Game ç±»å±žæ€§ï¼šå®šä¹‰ä¸€ä¸ª ç±»å±žæ€§ top_score è®°å½•æ¸¸æˆçš„ åŽ†å²æœ€é«˜åˆ†å®šä¹‰ä¸€ä¸ª å®žä¾‹å±žæ€§ player_name è®°å½• å½“å‰æ¸¸æˆçš„çŽ©å®¶å§“åæ–¹æ³•ï¼šé™æ€æ–¹æ³• show_help æ˜¾ç¤ºæ¸¸æˆå¸®åŠ©ä¿¡æ¯ç±»æ–¹æ³• show_top_score æ˜¾ç¤ºåŽ†å²æœ€é«˜åˆ†å®žä¾‹æ–¹æ³• start_game å¼€å§‹å½“å‰çŽ©å®¶çš„æ¸¸æˆä¸»ç¨‹åºæ­¥éª¤1) æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯2) æŸ¥çœ‹åŽ†å²æœ€é«˜åˆ†3) åˆ›å»ºæ¸¸æˆå¯¹è±¡ï¼Œå¼€å§‹æ¸¸æˆæ¡ˆä¾‹å°ç»“å®žä¾‹æ–¹æ³• â€”â€” æ–¹æ³•å†…éƒ¨éœ€è¦è®¿é—® å®žä¾‹å±žæ€§å®žä¾‹æ–¹æ³• å†…éƒ¨å¯ä»¥ä½¿ç”¨ ç±»å. è®¿é—®ç±»å±žæ€§ç±»æ–¹æ³• â€”â€” æ–¹æ³•å†…éƒ¨ åª éœ€è¦è®¿é—® ç±»å±žæ€§é™æ€æ–¹æ³• â€”â€” æ–¹æ³•å†…éƒ¨ï¼Œä¸éœ€è¦è®¿é—® å®žä¾‹å±žæ€§ å’Œ ç±»å±žæ€§æé—®å¦‚æžœæ–¹æ³•å†…éƒ¨ å³éœ€è¦è®¿é—® å®žä¾‹å±žæ€§ï¼Œåˆéœ€è¦è®¿é—® ç±»å±žæ€§ï¼Œåº”è¯¥å®šä¹‰æˆä»€ä¹ˆæ–¹æ³•ï¼Ÿç­”æ¡ˆåº”è¯¥å®šä¹‰ å®žä¾‹æ–¹æ³•å› ä¸ºï¼Œç±»åªæœ‰ä¸€ä¸ªï¼Œåœ¨ å®žä¾‹æ–¹æ³• å†…éƒ¨å¯ä»¥ä½¿ç”¨ ç±»å. è®¿é—®ç±»å±žæ€§123456789101112131415161718192021222324252627282930313233class Game(object): # æ¸¸æˆæœ€é«˜åˆ†ï¼Œç±»å±žæ€§ top_score = 0 @staticmethod def show_help(): print("å¸®åŠ©ä¿¡æ¯ï¼šè®©åƒµå°¸èµ°è¿›æˆ¿é—´") @classmethod def show_top_score(cls): print("æ¸¸æˆæœ€é«˜åˆ†æ˜¯ %d" % cls.top_score) def __init__(self, player_name): self.player_name = player_name def start_game(self): print("[%s] å¼€å§‹æ¸¸æˆ..." % self.player_name) # ä½¿ç”¨ç±»å.ä¿®æ”¹åŽ†å²æœ€é«˜åˆ† Game.top_score = 999# 1. æŸ¥çœ‹æ¸¸æˆå¸®åŠ©Game.show_help()# 2. æŸ¥çœ‹æ¸¸æˆæœ€é«˜åˆ†Game.show_top_score()# 3. åˆ›å»ºæ¸¸æˆå¯¹è±¡ï¼Œå¼€å§‹æ¸¸æˆgame = Game("å°æ˜Ž")game.start_game()# 4. æ¸¸æˆç»“æŸï¼ŒæŸ¥çœ‹æ¸¸æˆæœ€é«˜åˆ†Game.show_top_score()å•ä¾‹01. å•ä¾‹è®¾è®¡æ¨¡å¼è®¾è®¡æ¨¡å¼è®¾è®¡æ¨¡å¼ æ˜¯ å‰äººå·¥ä½œçš„æ€»ç»“å’Œæç‚¼ï¼Œé€šå¸¸ï¼Œè¢«äººä»¬å¹¿æ³›æµä¼ çš„è®¾è®¡æ¨¡å¼éƒ½æ˜¯é’ˆå¯¹ æŸä¸€ç‰¹å®šé—®é¢˜ çš„æˆç†Ÿçš„è§£å†³æ–¹æ¡ˆä½¿ç”¨ è®¾è®¡æ¨¡å¼ æ˜¯ä¸ºäº†å¯é‡ç”¨ä»£ç ã€è®©ä»£ç æ›´å®¹æ˜“è¢«ä»–äººç†è§£ã€ä¿è¯ä»£ç å¯é æ€§å•ä¾‹è®¾è®¡æ¨¡å¼ç›®çš„ â€”â€” è®© ç±» åˆ›å»ºçš„å¯¹è±¡ï¼Œåœ¨ç³»ç»Ÿä¸­ åªæœ‰ å”¯ä¸€çš„ä¸€ä¸ªå®žä¾‹æ¯ä¸€æ¬¡æ‰§è¡Œ ç±»å() è¿”å›žçš„å¯¹è±¡ï¼Œå†…å­˜åœ°å€æ˜¯ç›¸åŒçš„å•ä¾‹è®¾è®¡æ¨¡å¼çš„åº”ç”¨åœºæ™¯éŸ³ä¹æ’­æ”¾ å¯¹è±¡å›žæ”¶ç«™ å¯¹è±¡æ‰“å°æœº å¯¹è±¡â€¦â€¦02. new æ–¹æ³•ä½¿ç”¨ ç±»å() åˆ›å»ºå¯¹è±¡æ—¶ï¼ŒPython çš„è§£é‡Šå™¨ é¦–å…ˆ ä¼š è°ƒç”¨ new æ–¹æ³•ä¸ºå¯¹è±¡ åˆ†é…ç©ºé—´__new__ æ˜¯ä¸€ä¸ª ç”± object åŸºç±»æä¾›çš„ å†…ç½®çš„é™æ€æ–¹æ³•ï¼Œä¸»è¦ä½œç”¨æœ‰ä¸¤ä¸ªï¼š1) åœ¨å†…å­˜ä¸­ä¸ºå¯¹è±¡ åˆ†é…ç©ºé—´2)è¿”å›ž å¯¹è±¡çš„å¼•ç”¨Python çš„è§£é‡Šå™¨èŽ·å¾—å¯¹è±¡çš„ å¼•ç”¨ åŽï¼Œå°†å¼•ç”¨ä½œä¸º ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä¼ é€’ç»™ init æ–¹æ³•é‡å†™ new æ–¹æ³• çš„ä»£ç éžå¸¸å›ºå®šï¼é‡å†™ new æ–¹æ³• ä¸€å®šè¦ return super().new(cls)å¦åˆ™ Python çš„è§£é‡Šå™¨ å¾—ä¸åˆ° åˆ†é…äº†ç©ºé—´çš„ å¯¹è±¡å¼•ç”¨ï¼Œå°±ä¸ä¼šè°ƒç”¨å¯¹è±¡çš„åˆå§‹åŒ–æ–¹æ³•æ³¨æ„ï¼šnew æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œåœ¨è°ƒç”¨æ—¶éœ€è¦ ä¸»åŠ¨ä¼ é€’ cls å‚æ•°ç¤ºä¾‹ä»£ç :12345678910class MusicPlayer(object): def __new__(cls, *args, **kwargs): # å¦‚æžœä¸è¿”å›žä»»ä½•ç»“æžœï¼Œ return super().__new__(cls) def __init__(self): print("åˆå§‹åŒ–éŸ³ä¹æ’­æ”¾å¯¹è±¡")player = MusicPlayer()print(player)03. Python ä¸­çš„å•ä¾‹å•ä¾‹ â€”â€” è®© ç±» åˆ›å»ºçš„å¯¹è±¡ï¼Œåœ¨ç³»ç»Ÿä¸­ åªæœ‰ å”¯ä¸€çš„ä¸€ä¸ªå®žä¾‹å®šä¹‰ä¸€ä¸ª ç±»å±žæ€§ï¼Œåˆå§‹å€¼æ˜¯ Noneï¼Œç”¨äºŽè®°å½• å•ä¾‹å¯¹è±¡çš„å¼•ç”¨é‡å†™ new æ–¹æ³•å¦‚æžœ ç±»å±žæ€§ is Noneï¼Œè°ƒç”¨çˆ¶ç±»æ–¹æ³•åˆ†é…ç©ºé—´ï¼Œå¹¶åœ¨ç±»å±žæ€§ä¸­è®°å½•ç»“æžœè¿”å›ž ç±»å±žæ€§ ä¸­è®°å½•çš„ å¯¹è±¡å¼•ç”¨1234567891011class MusicPlayer(object): # å®šä¹‰ç±»å±žæ€§è®°å½•å•ä¾‹å¯¹è±¡å¼•ç”¨ instance = None def __new__(cls, *args, **kwargs): # 1. åˆ¤æ–­ç±»å±žæ€§æ˜¯å¦å·²ç»è¢«èµ‹å€¼ if cls.instance is None: cls.instance = super().__new__(cls) # 2. è¿”å›žç±»å±žæ€§çš„å•ä¾‹å¼•ç”¨ return cls.instance3.1åªæ‰§è¡Œä¸€æ¬¡åˆå§‹åŒ–å·¥ä½œåœ¨æ¯æ¬¡ä½¿ç”¨ ç±»å() åˆ›å»ºå¯¹è±¡æ—¶ï¼ŒPython çš„è§£é‡Šå™¨éƒ½ä¼šè‡ªåŠ¨è°ƒç”¨ä¸¤ä¸ªæ–¹æ³•ï¼šnew åˆ†é…ç©ºé—´init å¯¹è±¡åˆå§‹åŒ–åœ¨ä¸Šä¸€å°èŠ‚å¯¹ new æ–¹æ³•æ”¹é€ ä¹‹åŽï¼Œæ¯æ¬¡éƒ½ä¼šå¾—åˆ° ç¬¬ä¸€æ¬¡è¢«åˆ›å»ºå¯¹è±¡çš„å¼•ç”¨ä½†æ˜¯ï¼šåˆå§‹åŒ–æ–¹æ³•è¿˜ä¼šè¢«å†æ¬¡è°ƒç”¨éœ€æ±‚è®© åˆå§‹åŒ–åŠ¨ä½œ åªè¢« æ‰§è¡Œä¸€æ¬¡è§£å†³åŠžæ³•å®šä¹‰ä¸€ä¸ªç±»å±žæ€§ init_flag æ ‡è®°æ˜¯å¦ æ‰§è¡Œè¿‡åˆå§‹åŒ–åŠ¨ä½œï¼Œåˆå§‹å€¼ä¸º Falseåœ¨ init æ–¹æ³•ä¸­ï¼Œåˆ¤æ–­ init_flagï¼Œå¦‚æžœä¸º False å°±æ‰§è¡Œåˆå§‹åŒ–åŠ¨ä½œç„¶åŽå°† init_flag è®¾ç½®ä¸º Trueè¿™æ ·ï¼Œå†æ¬¡ è‡ªåŠ¨ è°ƒç”¨ init æ–¹æ³•æ—¶ï¼Œåˆå§‹åŒ–åŠ¨ä½œå°±ä¸ä¼šè¢«å†æ¬¡æ‰§è¡Œ äº†12345678910111213141516171819202122232425262728class MusicPlayer(object): # è®°å½•ç¬¬ä¸€ä¸ªè¢«åˆ›å»ºå¯¹è±¡çš„å¼•ç”¨ instance = None # è®°å½•æ˜¯å¦æ‰§è¡Œè¿‡åˆå§‹åŒ–åŠ¨ä½œ init_flag = False def __new__(cls, *args, **kwargs): # 1. åˆ¤æ–­ç±»å±žæ€§æ˜¯å¦æ˜¯ç©ºå¯¹è±¡ if cls.instance is None: # 2. è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•ï¼Œä¸ºç¬¬ä¸€ä¸ªå¯¹è±¡åˆ†é…ç©ºé—´ cls.instance = super().__new__(cls) # 3. è¿”å›žç±»å±žæ€§ä¿å­˜çš„å¯¹è±¡å¼•ç”¨ return cls.instance def __init__(self): if not MusicPlayer.init_flag: print("åˆå§‹åŒ–éŸ³ä¹æ’­æ”¾å™¨") MusicPlayer.init_flag = True# åˆ›å»ºå¤šä¸ªå¯¹è±¡player1 = MusicPlayer()print(player1)player2 = MusicPlayer()print(player2)]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python_é—­åŒ…å’Œè£…é¥°å™¨]]></title>
    <url>%2F2019%2F12%2F31%2Fpython_%E9%97%AD%E5%8C%85%E5%92%8C%E8%A3%85%E9%A5%B0%E5%99%A8%2F</url>
    <content type="text"><![CDATA[é—­åŒ…1. å‡½æ•°å¼•ç”¨1234567891011121314def test1(): print("--- in test1 func----")# è°ƒç”¨å‡½æ•°test1()# å¼•ç”¨å‡½æ•°ret = test1print(id(ret))print(id(test1))#é€šè¿‡å¼•ç”¨è°ƒç”¨å‡½æ•°ret()è¿è¡Œç»“æžœ:1234--- in test1 func----140212571149040140212571149040--- in test1 func----2. ä»€ä¹ˆæ˜¯é—­åŒ…12345678910111213141516171819# å®šä¹‰ä¸€ä¸ªå‡½æ•°def test(number): # åœ¨å‡½æ•°å†…éƒ¨å†å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”è¿™ä¸ªå‡½æ•°ç”¨åˆ°äº†å¤–è¾¹å‡½æ•°çš„å˜é‡ï¼Œé‚£ä¹ˆå°†è¿™ä¸ªå‡½æ•°ä»¥åŠç”¨åˆ°çš„ä¸€äº›å˜é‡ç§°ä¹‹ä¸ºé—­åŒ… def test_in(number_in): print("in test_in å‡½æ•°, number_in is %d" % number_in) return number+number_in # å…¶å®žè¿™é‡Œè¿”å›žçš„å°±æ˜¯é—­åŒ…çš„ç»“æžœ return test_in# ç»™testå‡½æ•°èµ‹å€¼ï¼Œè¿™ä¸ª20å°±æ˜¯ç»™å‚æ•°numberret = test(20)# æ³¨æ„è¿™é‡Œçš„100å…¶å®žç»™å‚æ•°number_inprint(ret(100))#æ³¨ æ„è¿™é‡Œçš„200å…¶å®žç»™å‚æ•°number_inprint(ret(200))è¿è¡Œç»“æžœï¼š12345in test_in å‡½æ•°, number_in is 100120in test_in å‡½æ•°, number_in is 2002203. çœ‹ä¸€ä¸ªé—­åŒ…çš„å®žé™…ä¾‹å­ï¼š123456789def line_conf(a, b): def line(x): return a*x + b return lineline1 = line_conf(1, 1)line2 = line_conf(4, 5)print(line1(5))print(line2(5))è¿™ä¸ªä¾‹å­ä¸­ï¼Œå‡½æ•°lineä¸Žå˜é‡a,bæž„æˆé—­åŒ…ã€‚åœ¨åˆ›å»ºé—­åŒ…çš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šè¿‡line_confçš„å‚æ•°a,bè¯´æ˜Žäº†è¿™ä¸¤ä¸ªå˜é‡çš„å–å€¼ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å°±ç¡®å®šäº†å‡½æ•°çš„æœ€ç»ˆå½¢å¼(y = x + 1å’Œy = 4x + 5)ã€‚æˆ‘ä»¬åªéœ€è¦å˜æ¢å‚æ•°a,bï¼Œå°±å¯ä»¥èŽ·å¾—ä¸åŒçš„ç›´çº¿è¡¨è¾¾å‡½æ•°ã€‚ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œé—­åŒ…ä¹Ÿå…·æœ‰æé«˜ä»£ç å¯å¤ç”¨æ€§çš„ä½œç”¨ã€‚å¦‚æžœæ²¡æœ‰é—­åŒ…ï¼Œæˆ‘ä»¬éœ€è¦æ¯æ¬¡åˆ›å»ºç›´çº¿å‡½æ•°çš„æ—¶å€™åŒæ—¶è¯´æ˜Ža,b,xã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±éœ€è¦æ›´å¤šçš„å‚æ•°ä¼ é€’ï¼Œä¹Ÿå‡å°‘äº†ä»£ç çš„å¯ç§»æ¤æ€§ã€‚æ³¨æ„ç‚¹:ç”±äºŽé—­åŒ…å¼•ç”¨äº†å¤–éƒ¨å‡½æ•°çš„å±€éƒ¨å˜é‡ï¼Œåˆ™å¤–éƒ¨å‡½æ•°çš„å±€éƒ¨å˜é‡æ²¡æœ‰åŠæ—¶é‡Šæ”¾ï¼Œæ¶ˆè€—å†…å­˜4. ä¿®æ”¹å¤–éƒ¨å‡½æ•°ä¸­çš„å˜é‡python3çš„æ–¹æ³•1234567891011121314151617181920def counter(start=0): def incr(): nonlocal start start += 1 return start return incrc1 = counter(5)print(c1())print(c1())c2 = counter(50)print(c2())print(c2())print(c1())print(c1())print(c2())print(c2())python2çš„æ–¹æ³•12345678910111213def counter(start=0): count=[start] def incr(): count[0] += 1 return count[0] return incrc1 = closeure.counter(5)print(c1()) # 6print(c1()) # 7c2 = closeure.counter(100)print(c2()) # 101print(c2()) # 102è£…é¥°å™¨è£…é¥°å™¨æ˜¯ç¨‹åºå¼€å‘ä¸­ç»å¸¸ä¼šç”¨åˆ°çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œç”¨å¥½äº†è£…é¥°å™¨ï¼Œå¼€å‘æ•ˆçŽ‡å¦‚è™Žæ·»ç¿¼ï¼Œæ‰€ä»¥è¿™ä¹Ÿæ˜¯Pythoné¢è¯•ä¸­å¿…é—®çš„é—®é¢˜ï¼Œä½†å¯¹äºŽå¥½å¤šåˆæ¬¡æŽ¥è§¦è¿™ä¸ªçŸ¥è¯†çš„äººæ¥è®²ï¼Œè¿™ä¸ªåŠŸèƒ½æœ‰ç‚¹ç»•ï¼Œè‡ªå­¦æ—¶ç›´æŽ¥ç»•è¿‡åŽ»äº†ï¼Œç„¶åŽé¢è¯•é—®åˆ°äº†å°±æŒ‚äº†ï¼Œå› ä¸ºè£…é¥°å™¨æ˜¯ç¨‹åºå¼€å‘çš„åŸºç¡€çŸ¥è¯†ï¼Œè¿™ä¸ªéƒ½ä¸ä¼šï¼Œåˆ«è·Ÿäººå®¶è¯´ä½ ä¼šPython, çœ‹äº†ä¸‹é¢çš„æ–‡ç« ï¼Œä¿è¯ä½ å­¦ä¼šè£…é¥°å™¨ã€‚1ã€å…ˆæ˜Žç™½è¿™æ®µä»£ç 1234567891011121314#### ç¬¬ä¸€æ³¢ ####def foo(): print('foo')foo # è¡¨ç¤ºæ˜¯å‡½æ•°foo() # è¡¨ç¤ºæ‰§è¡Œfooå‡½æ•°#### ç¬¬äºŒæ³¢ ####def foo(): print('foo')foo = lambda x: x + 1foo() # æ‰§è¡Œlambdaè¡¨è¾¾å¼ï¼Œè€Œä¸å†æ˜¯åŽŸæ¥çš„fooå‡½æ•°ï¼Œå› ä¸ºfooè¿™ä¸ªåå­—è¢«é‡æ–°æŒ‡å‘äº†å¦å¤–ä¸€ä¸ªåŒ¿åå‡½æ•°å‡½æ•°åä»…ä»…æ˜¯ä¸ªå˜é‡ï¼Œåªä¸è¿‡æŒ‡å‘äº†å®šä¹‰çš„å‡½æ•°è€Œå·²ï¼Œæ‰€ä»¥æ‰èƒ½é€šè¿‡ å‡½æ•°å()è°ƒç”¨ï¼Œå¦‚æžœ å‡½æ•°å=xxxè¢«ä¿®æ”¹äº†ï¼Œé‚£ä¹ˆå½“åœ¨æ‰§è¡Œ å‡½æ•°å()æ—¶ï¼Œè°ƒç”¨çš„å°±ä¸çŸ¥ä¹‹å‰çš„é‚£ä¸ªå‡½æ•°äº†2ã€éœ€æ±‚æ¥äº†åˆåˆ›å…¬å¸æœ‰Nä¸ªä¸šåŠ¡éƒ¨é—¨ï¼ŒåŸºç¡€å¹³å°éƒ¨é—¨è´Ÿè´£æä¾›åº•å±‚çš„åŠŸèƒ½ï¼Œå¦‚ï¼šæ•°æ®åº“æ“ä½œã€redisè°ƒç”¨ã€ç›‘æŽ§APIç­‰åŠŸèƒ½ã€‚ä¸šåŠ¡éƒ¨é—¨ä½¿ç”¨åŸºç¡€åŠŸèƒ½æ—¶ï¼Œåªéœ€è°ƒç”¨åŸºç¡€å¹³å°æä¾›çš„åŠŸèƒ½å³å¯ã€‚å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627############### åŸºç¡€å¹³å°æä¾›çš„åŠŸèƒ½å¦‚ä¸‹ ###############def f1(): print('f1')def f2(): print('f2')def f3(): print('f3')def f4(): print('f4')############### ä¸šåŠ¡éƒ¨é—¨A è°ƒç”¨åŸºç¡€å¹³å°æä¾›çš„åŠŸèƒ½ ###############f1()f2()f3()f4()############### ä¸šåŠ¡éƒ¨é—¨B è°ƒç”¨åŸºç¡€å¹³å°æä¾›çš„åŠŸèƒ½ ###############f1()f2()f3()f4()ç›®å‰å…¬å¸æœ‰æ¡ä¸ç´Šçš„è¿›è¡Œç€ï¼Œä½†æ˜¯ï¼Œä»¥å‰åŸºç¡€å¹³å°çš„å¼€å‘äººå‘˜åœ¨å†™ä»£ç æ—¶å€™æ²¡æœ‰å…³æ³¨éªŒè¯ç›¸å…³çš„é—®é¢˜ï¼Œå³ï¼šåŸºç¡€å¹³å°çš„æä¾›çš„åŠŸèƒ½å¯ä»¥è¢«ä»»ä½•äººä½¿ç”¨ã€‚çŽ°åœ¨éœ€è¦å¯¹åŸºç¡€å¹³å°çš„æ‰€æœ‰åŠŸèƒ½è¿›è¡Œé‡æž„ï¼Œä¸ºå¹³å°æä¾›çš„æ‰€æœ‰åŠŸèƒ½æ·»åŠ éªŒè¯æœºåˆ¶ï¼Œå³ï¼šæ‰§è¡ŒåŠŸèƒ½å‰ï¼Œå…ˆè¿›è¡ŒéªŒè¯ã€‚è€å¤§æŠŠå·¥ä½œäº¤ç»™ Low Bï¼Œä»–æ˜¯è¿™ä¹ˆåšçš„ï¼šè·Ÿæ¯ä¸ªä¸šåŠ¡éƒ¨é—¨äº¤æ¶‰ï¼Œæ¯ä¸ªä¸šåŠ¡éƒ¨é—¨è‡ªå·±å†™ä»£ç ï¼Œè°ƒç”¨åŸºç¡€å¹³å°çš„åŠŸèƒ½ä¹‹å‰å…ˆéªŒè¯ã€‚è¯¶ï¼Œè¿™æ ·ä¸€æ¥åŸºç¡€å¹³å°å°±ä¸éœ€è¦åšä»»ä½•ä¿®æ”¹äº†ã€‚å¤ªæ£’äº†ï¼Œæœ‰å……è¶³çš„æ—¶é—´æ³¡å¦¹å­â€¦å½“å¤©Low B è¢«å¼€é™¤äº†â€¦è€å¤§æŠŠå·¥ä½œäº¤ç»™ Low BBï¼Œä»–æ˜¯è¿™ä¹ˆåšçš„ï¼š12345678910111213141516171819202122232425262728293031323334353637383940############### åŸºç¡€å¹³å°æä¾›çš„åŠŸèƒ½å¦‚ä¸‹ ############### def f1(): # éªŒè¯1 # éªŒè¯2 # éªŒè¯3 print('f1')def f2(): # éªŒè¯1 # éªŒè¯2 # éªŒè¯3 print('f2')def f3(): # éªŒè¯1 # éªŒè¯2 # éªŒè¯3 print('f3')def f4(): # éªŒè¯1 # éªŒè¯2 # éªŒè¯3 print('f4')############### ä¸šåŠ¡éƒ¨é—¨ä¸å˜ ############### ### ä¸šåŠ¡éƒ¨é—¨A è°ƒç”¨åŸºç¡€å¹³å°æä¾›çš„åŠŸèƒ½### f1()f2()f3()f4()### ä¸šåŠ¡éƒ¨é—¨B è°ƒç”¨åŸºç¡€å¹³å°æä¾›çš„åŠŸèƒ½ ### f1()f2()f3()f4()è¿‡äº†ä¸€å‘¨ Low BB è¢«å¼€é™¤äº†â€¦è€å¤§æŠŠå·¥ä½œäº¤ç»™ Low BBBï¼Œä»–æ˜¯è¿™ä¹ˆåšçš„ï¼šåªå¯¹åŸºç¡€å¹³å°çš„ä»£ç è¿›è¡Œé‡æž„ï¼Œå…¶ä»–ä¸šåŠ¡éƒ¨é—¨æ— éœ€åšä»»ä½•ä¿®æ”¹1234567891011121314151617181920212223242526272829303132############### åŸºç¡€å¹³å°æä¾›çš„åŠŸèƒ½å¦‚ä¸‹ ############### def check_login(): # éªŒè¯1 # éªŒè¯2 # éªŒè¯3 passdef f1(): check_login() print('f1')def f2(): check_login() print('f2')def f3(): check_login() print('f3')def f4(): check_login() print('f4')è€å¤§çœ‹äº†ä¸‹Low BBB çš„å®žçŽ°ï¼Œå˜´è§’æ¼å‡ºäº†ä¸€ä¸çš„æ¬£æ…°çš„ç¬‘ï¼Œè¯­é‡å¿ƒé•¿çš„è·ŸLow BBBèŠäº†ä¸ªå¤©ï¼šè€å¤§è¯´ï¼šå†™ä»£ç è¦éµå¾ªå¼€æ”¾å°é—­åŽŸåˆ™ï¼Œè™½ç„¶åœ¨è¿™ä¸ªåŽŸåˆ™æ˜¯ç”¨çš„é¢å‘å¯¹è±¡å¼€å‘ï¼Œä½†æ˜¯ä¹Ÿé€‚ç”¨äºŽå‡½æ•°å¼ç¼–ç¨‹ï¼Œç®€å•æ¥è¯´ï¼Œå®ƒè§„å®šå·²ç»å®žçŽ°çš„åŠŸèƒ½ä»£ç ä¸å…è®¸è¢«ä¿®æ”¹ï¼Œä½†å¯ä»¥è¢«æ‰©å±•ï¼Œå³ï¼šå°é—­ï¼šå·²å®žçŽ°çš„åŠŸèƒ½ä»£ç å—å¼€æ”¾ï¼šå¯¹æ‰©å±•å¼€å‘å¦‚æžœå°†å¼€æ”¾å°é—­åŽŸåˆ™åº”ç”¨åœ¨ä¸Šè¿°éœ€æ±‚ä¸­ï¼Œé‚£ä¹ˆå°±ä¸å…è®¸åœ¨å‡½æ•° f1 ã€f2ã€f3ã€f4çš„å†…éƒ¨è¿›è¡Œä¿®æ”¹ä»£ç ï¼Œè€æ¿å°±ç»™äº†Low BBBä¸€ä¸ªå®žçŽ°æ–¹æ¡ˆï¼š1234567891011121314151617181920def w1(func): def inner(): # éªŒè¯1 # éªŒè¯2 # éªŒè¯3 func() return inner@w1def f1(): print('f1')@w1def f2(): print('f2')@w1def f3(): print('f3')@w1def f4(): print('f4')å¯¹äºŽä¸Šè¿°ä»£ç ï¼Œä¹Ÿæ˜¯ä»…ä»…å¯¹åŸºç¡€å¹³å°çš„ä»£ç è¿›è¡Œä¿®æ”¹ï¼Œå°±å¯ä»¥å®žçŽ°åœ¨å…¶ä»–äººè°ƒç”¨å‡½æ•° f1 f2 f3 f4 ä¹‹å‰éƒ½è¿›è¡Œã€éªŒè¯ã€‘æ“ä½œï¼Œå¹¶ä¸”å…¶ä»–ä¸šåŠ¡éƒ¨é—¨æ— éœ€åšä»»ä½•æ“ä½œã€‚Low BBBå¿ƒæƒŠèƒ†æˆ˜çš„é—®äº†ä¸‹ï¼Œè¿™æ®µä»£ç çš„å†…éƒ¨æ‰§è¡ŒåŽŸç†æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè€å¤§æ­£è¦ç”Ÿæ°”ï¼Œçªç„¶Low BBBçš„æ‰‹æœºæŽ‰åˆ°åœ°ä¸Šï¼Œæ°å·§å±ä¿å°±æ˜¯Low BBBçš„å¥³å‹ç…§ç‰‡ï¼Œè€å¤§ä¸€çœ‹ä¸€ç´§ä¸€æŠ–ï¼Œå–œç¬‘é¢œå¼€ï¼Œå†³å®šå’ŒLow BBBäº¤ä¸ªå¥½æœ‹å‹ã€‚è¯¦ç»†çš„å¼€å§‹è®²è§£äº†ï¼šå•ç‹¬ä»¥f1ä¸ºä¾‹ï¼š1234567891011def w1(func): def inner(): # éªŒè¯1 # éªŒè¯2 # éªŒè¯3 func() return inner@w1def f1(): print('f1')pythonè§£é‡Šå™¨å°±ä¼šä»Žä¸Šåˆ°ä¸‹è§£é‡Šä»£ç ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼šdef w1(func): ==&gt;å°†w1å‡½æ•°åŠ è½½åˆ°å†…å­˜@w1æ²¡é”™ï¼Œ ä»Žè¡¨é¢ä¸Šçœ‹è§£é‡Šå™¨ä»…ä»…ä¼šè§£é‡Šè¿™ä¸¤å¥ä»£ç ï¼Œå› ä¸ºå‡½æ•°åœ¨ æ²¡æœ‰è¢«è°ƒç”¨ä¹‹å‰å…¶å†…éƒ¨ä»£ç ä¸ä¼šè¢«æ‰§è¡Œã€‚ä»Žè¡¨é¢ä¸Šçœ‹è§£é‡Šå™¨ç€å®žä¼šæ‰§è¡Œè¿™ä¸¤å¥ï¼Œä½†æ˜¯ @w1 è¿™ä¸€å¥ä»£ç é‡Œå´æœ‰å¤§æ–‡ç« ï¼Œ @å‡½æ•°å æ˜¯pythonçš„ä¸€ç§è¯­æ³•ç³–ã€‚ä¸Šä¾‹@w1å†…éƒ¨ä¼šæ‰§è¡Œä¸€ä¸‹æ“ä½œï¼šæ‰§è¡Œw1å‡½æ•°æ‰§è¡Œw1å‡½æ•° ï¼Œå¹¶å°† @w1 ä¸‹é¢çš„å‡½æ•°ä½œä¸ºw1å‡½æ•°çš„å‚æ•°ï¼Œå³ï¼š@w1 ç­‰ä»·äºŽ w1(f1) æ‰€ä»¥ï¼Œå†…éƒ¨å°±ä¼šåŽ»æ‰§è¡Œï¼š1234567&gt; def inner(): &gt; #éªŒè¯ 1&gt; #éªŒè¯ 2&gt; #éªŒè¯ 3&gt; f1() # funcæ˜¯å‚æ•°ï¼Œæ­¤æ—¶ func ç­‰äºŽ f1 &gt; return inner# è¿”å›žçš„ innerï¼Œinnerä»£è¡¨çš„æ˜¯å‡½æ•°ï¼Œéžæ‰§è¡Œå‡½æ•° ,å…¶å®žå°±æ˜¯å°†åŽŸæ¥çš„ f1 å‡½æ•°å¡žè¿›å¦å¤–ä¸€ä¸ªå‡½æ•°ä¸­&gt;w1çš„è¿”å›žå€¼å°†æ‰§è¡Œå®Œçš„w1å‡½æ•°è¿”å›žå€¼ èµ‹å€¼ ç»™@w1ä¸‹é¢çš„å‡½æ•°çš„å‡½æ•°åf1 å³å°†w1çš„è¿”å›žå€¼å†é‡æ–°èµ‹å€¼ç»™ f1ï¼Œå³ï¼š1234567&gt; æ–°f1 = def inner(): &gt; #éªŒè¯ 1&gt; #éªŒè¯ 2&gt; #éªŒè¯ 3&gt; åŽŸæ¥f1()&gt; return inner&gt;æ‰€ä»¥ï¼Œä»¥åŽä¸šåŠ¡éƒ¨é—¨æƒ³è¦æ‰§è¡Œ f1 å‡½æ•°æ—¶ï¼Œå°±ä¼šæ‰§è¡Œ æ–°f1 å‡½æ•°ï¼Œåœ¨æ–°f1 å‡½æ•°å†…éƒ¨å…ˆæ‰§è¡ŒéªŒè¯ï¼Œå†æ‰§è¡ŒåŽŸæ¥çš„f1å‡½æ•°ï¼Œç„¶åŽå°†åŽŸæ¥f1 å‡½æ•°çš„è¿”å›žå€¼è¿”å›žç»™äº†ä¸šåŠ¡è°ƒç”¨è€…ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œ å³æ‰§è¡Œäº†éªŒè¯çš„åŠŸèƒ½ï¼Œåˆæ‰§è¡Œäº†åŽŸæ¥f1å‡½æ•°çš„å†…å®¹ï¼Œå¹¶å°†åŽŸf1å‡½æ•°è¿”å›žå€¼ è¿”å›žç»™ä¸šåŠ¡è°ƒç”¨ç€Low BBB ä½ æ˜Žç™½äº†å—ï¼Ÿè¦æ˜¯æ²¡æ˜Žç™½çš„è¯ï¼Œæˆ‘æ™šä¸ŠåŽ»ä½ å®¶å¸®ä½ è§£å†³å§ï¼ï¼ï¼3. å†è®®è£…é¥°å™¨12345678910111213141516171819202122232425262728# å®šä¹‰å‡½æ•°ï¼šå®ŒæˆåŒ…è£¹æ•°æ®def makeBold(fn): def wrapped(): return "&lt;b&gt;" + fn() + "&lt;/b&gt;" return wrapped# å®šä¹‰å‡½æ•°ï¼šå®ŒæˆåŒ…è£¹æ•°æ®def makeItalic(fn): def wrapped(): return "&lt;i&gt;" + fn() + "&lt;/i&gt;" return wrapped@makeBolddef test1(): return "hello world-1"@makeItalicdef test2(): return "hello world-2"@makeBold@makeItalicdef test3(): return "hello world-3"print(test1())print(test2())print(test3())è¿è¡Œç»“æžœ:123&lt;b&gt;hello world-1&lt;/b&gt;&lt;i&gt;hello world-2&lt;/i&gt;&lt;b&gt;&lt;i&gt;hello world-3&lt;/i&gt;&lt;/b&gt;4. è£…é¥°å™¨(decorator)åŠŸèƒ½å¼•å…¥æ—¥å¿—å‡½æ•°æ‰§è¡Œæ—¶é—´ç»Ÿè®¡æ‰§è¡Œå‡½æ•°å‰é¢„å¤‡å¤„ç†æ‰§è¡Œå‡½æ•°åŽæ¸…ç†åŠŸèƒ½æƒé™æ ¡éªŒç­‰åœºæ™¯ç¼“å­˜5. è£…é¥°å™¨ç¤ºä¾‹ä¾‹1:æ— å‚æ•°çš„å‡½æ•°123456789101112131415from time import ctime, sleepdef timefun(func): def wrapped_func(): print("%s called at %s" % (func.__name__, ctime())) func() return wrapped_func@timefundef foo(): print("I am foo")foo()sleep(2)foo()ä¸Šé¢ä»£ç ç†è§£è£…é¥°å™¨æ‰§è¡Œè¡Œä¸ºå¯ç†è§£æˆ123456foo = timefun(foo)# fooå…ˆä½œä¸ºå‚æ•°èµ‹å€¼ç»™funcåŽ,fooæŽ¥æ”¶æŒ‡å‘timefunè¿”å›žçš„wrapped_funcfoo()# è°ƒç”¨foo(),å³ç­‰ä»·è°ƒç”¨wrapped_func()# å†…éƒ¨å‡½æ•°wrapped_funcè¢«å¼•ç”¨ï¼Œæ‰€ä»¥å¤–éƒ¨å‡½æ•°çš„funcå˜é‡(è‡ªç”±å˜é‡)å¹¶æ²¡æœ‰é‡Šæ”¾# funcé‡Œä¿å­˜çš„æ˜¯åŽŸfooå‡½æ•°å¯¹è±¡ä¾‹2:è¢«è£…é¥°çš„å‡½æ•°æœ‰å‚æ•°12345678910111213141516from time import ctime, sleepdef timefun(func): def wrapped_func(a, b): print("%s called at %s" % (func.__name__, ctime())) print(a, b) func(a, b) return wrapped_func@timefundef foo(a, b): print(a+b)foo(3,5)sleep(2)foo(2,4)ä¾‹3:è¢«è£…é¥°çš„å‡½æ•°æœ‰ä¸å®šé•¿å‚æ•°123456789101112131415from time import ctime, sleepdef timefun(func): def wrapped_func(*args, **kwargs): print("%s called at %s"%(func.__name__, ctime())) func(*args, **kwargs) return wrapped_func@timefundef foo(a, b, c): print(a+b+c)foo(3,5,7)sleep(2)foo(2,4,9)ä¾‹4:è£…é¥°å™¨ä¸­çš„return12345678910111213141516171819202122from time import ctime, sleepdef timefun(func): def wrapped_func(): print("%s called at %s" % (func.__name__, ctime())) func() return wrapped_func@timefundef foo(): print("I am foo")@timefundef getInfo(): return '----hahah---'foo()sleep(2)foo()print(getInfo())æ‰§è¡Œç»“æžœ:123456foo called at Fri Nov 4 21:55:35 2016I am foofoo called at Fri Nov 4 21:55:37 2016I am foogetInfo called at Fri Nov 4 21:55:37 2016Noneå¦‚æžœä¿®æ”¹è£…é¥°å™¨ä¸ºreturn func()ï¼Œåˆ™è¿è¡Œç»“æžœï¼š123456foo called at Fri Nov 4 21:55:57 2016I am foofoo called at Fri Nov 4 21:55:59 2016I am foogetInfo called at Fri Nov 4 21:55:59 2016----hahah---æ€»ç»“ï¼šä¸€èˆ¬æƒ…å†µä¸‹ä¸ºäº†è®©è£…é¥°å™¨æ›´é€šç”¨ï¼Œå¯ä»¥æœ‰returnä¾‹5:è£…é¥°å™¨å¸¦å‚æ•°,åœ¨åŽŸæœ‰è£…é¥°å™¨çš„åŸºç¡€ä¸Šï¼Œè®¾ç½®å¤–éƒ¨å˜é‡1234567891011121314151617181920212223242526272829303132#decorator2.pyfrom time import ctime, sleepdef timefun_arg(pre="hello"): def timefun(func): def wrapped_func(): print("%s called at %s %s" % (func.__name__, ctime(), pre)) return func() return wrapped_func return timefun# ä¸‹é¢çš„è£…é¥°è¿‡ç¨‹# 1. è°ƒç”¨timefun_arg("itcast")# 2. å°†æ­¥éª¤1å¾—åˆ°çš„è¿”å›žå€¼ï¼Œå³time_funè¿”å›žï¼Œ ç„¶åŽtime_fun(foo)# 3. å°†time_fun(foo)çš„ç»“æžœè¿”å›žï¼Œå³wrapped_func# 4. è®©foo = wrapped_funï¼Œå³fooçŽ°åœ¨æŒ‡å‘wrapped_func@timefun_arg("itcast")def foo(): print("I am foo")@timefun_arg("python")def too(): print("I am too")foo()sleep(2)foo()too()sleep(2)too()å¯ä»¥ç†è§£ä¸º1foo()==timefun_arg(&quot;itcast&quot;)(foo)()ä¾‹6ï¼šç±»è£…é¥°å™¨ï¼ˆæ‰©å±•ï¼Œéžé‡ç‚¹ï¼‰è£…é¥°å™¨å‡½æ•°å…¶å®žæ˜¯è¿™æ ·ä¸€ä¸ªæŽ¥å£çº¦æŸï¼Œå®ƒå¿…é¡»æŽ¥å—ä¸€ä¸ªcallableå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œç„¶åŽè¿”å›žä¸€ä¸ªcallableå¯¹è±¡ã€‚åœ¨Pythonä¸­ä¸€èˆ¬callableå¯¹è±¡éƒ½æ˜¯å‡½æ•°ï¼Œä½†ä¹Ÿæœ‰ä¾‹å¤–ã€‚åªè¦æŸä¸ªå¯¹è±¡é‡å†™äº† __call__() æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡å°±æ˜¯callableçš„ã€‚123456class Test(): def __call__(self): print('call me!')t = Test()t() # call meç±»è£…é¥°å™¨demo123456789101112131415161718192021222324class Test(object): def __init__(self, func): print("---åˆå§‹åŒ–---") print("func name is %s"%func.__name__) self.__func = func def __call__(self): print("---è£…é¥°å™¨ä¸­çš„åŠŸèƒ½---") self.__func()#è¯´æ˜Žï¼š#1. å½“ç”¨Testæ¥è£…ä½œè£…é¥°å™¨å¯¹testå‡½æ•°è¿›è¡Œè£…é¥°çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šåˆ›å»ºTestçš„å®žä¾‹å¯¹è±¡# å¹¶ä¸”ä¼šæŠŠtestè¿™ä¸ªå‡½æ•°åå½“åšå‚æ•°ä¼ é€’åˆ°__init__æ–¹æ³•ä¸­# å³åœ¨__init__æ–¹æ³•ä¸­çš„å±žæ€§__funcæŒ‡å‘äº†testæŒ‡å‘çš„å‡½æ•°##2. testæŒ‡å‘äº†ç”¨Teståˆ›å»ºå‡ºæ¥çš„å®žä¾‹å¯¹è±¡##3. å½“åœ¨ä½¿ç”¨test()è¿›è¡Œè°ƒç”¨æ—¶ï¼Œå°±ç›¸å½“äºŽè®©è¿™ä¸ªå¯¹è±¡()ï¼Œå› æ­¤ä¼šè°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„__call__æ–¹æ³•##4. ä¸ºäº†èƒ½å¤Ÿåœ¨__call__æ–¹æ³•ä¸­è°ƒç”¨åŽŸæ¥testæŒ‡å‘çš„å‡½æ•°ä½“ï¼Œæ‰€ä»¥åœ¨__init__æ–¹æ³•ä¸­å°±éœ€è¦ä¸€ä¸ªå®žä¾‹å±žæ€§æ¥ä¿å­˜è¿™ä¸ªå‡½æ•°ä½“çš„å¼•ç”¨# æ‰€ä»¥æ‰æœ‰äº†self.__func = funcè¿™å¥ä»£ç ï¼Œä»Žè€Œåœ¨è°ƒç”¨__call__æ–¹æ³•ä¸­èƒ½å¤Ÿè°ƒç”¨åˆ°testä¹‹å‰çš„å‡½æ•°ä½“@Testdef test(): print("----test---")test()showpy()#å¦‚æžœæŠŠè¿™å¥è¯æ³¨é‡Šï¼Œé‡æ–°è¿è¡Œç¨‹åºï¼Œä¾ç„¶ä¼šçœ‹åˆ°"--åˆå§‹åŒ–--"è¿è¡Œç»“æžœå¦‚ä¸‹ï¼š1234---åˆå§‹åŒ–---func name is test---è£…é¥°å™¨ä¸­çš„åŠŸèƒ½-------test---]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python_æ­£åˆ™è¡¨è¾¾å¼]]></title>
    <url>%2F2019%2F12%2F31%2Fpython_%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[æ­£åˆ™è¡¨è¾¾å¼reæ¨¡å—æ“ä½œåœ¨Pythonä¸­éœ€è¦é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼å¯¹å­—ç¬¦ä¸²è¿›è¡ŒåŒ¹é…çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ¨¡å—ï¼Œåå­—ä¸ºre1. reæ¨¡å—çš„ä½¿ç”¨è¿‡ç¨‹12345678910#coding=utf-8# å¯¼å…¥reæ¨¡å—import re# ä½¿ç”¨matchæ–¹æ³•è¿›è¡ŒåŒ¹é…æ“ä½œresult = re.match(æ­£åˆ™è¡¨è¾¾å¼,è¦åŒ¹é…çš„å­—ç¬¦ä¸²)# å¦‚æžœä¸Šä¸€æ­¥åŒ¹é…åˆ°æ•°æ®çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨groupæ–¹æ³•æ¥æå–æ•°æ®result.group()2. reæ¨¡å—ç¤ºä¾‹(åŒ¹é…ä»¥itcastå¼€å¤´çš„è¯­å¥)1234567#coding=utf-8import reresult = re.match("itcast","itcast.cn")result.group()è¿è¡Œç»“æžœä¸ºï¼š1itcast3. è¯´æ˜Žre.match() èƒ½å¤ŸåŒ¹é…å‡ºä»¥xxxå¼€å¤´çš„å­—ç¬¦ä¸²åŒ¹é…å•ä¸ªå­—ç¬¦å­—ç¬¦åŠŸèƒ½.åŒ¹é…ä»»æ„1ä¸ªå­—ç¬¦ï¼ˆé™¤äº†\nï¼‰[ ]åŒ¹é…[ ]ä¸­åˆ—ä¸¾çš„å­—ç¬¦\dåŒ¹é…æ•°å­—ï¼Œå³0-9\DåŒ¹é…éžæ•°å­—ï¼Œå³ä¸æ˜¯æ•°å­—\såŒ¹é…ç©ºç™½ï¼Œå³ ç©ºæ ¼ï¼Œtabé”®\SåŒ¹é…éžç©ºç™½\wåŒ¹é…å•è¯å­—ç¬¦ï¼Œå³a-zã€A-Zã€0-9ã€_\WåŒ¹é…éžå•è¯å­—ç¬¦ç¤ºä¾‹1ï¼š .123456789101112#coding=utf-8import reret = re.match(".","M")print(ret.group())ret = re.match("t.o","too")print(ret.group())ret = re.match("t.o","two")print(ret.group())è¿è¡Œç»“æžœä¸ºï¼š123Mtootwoç¤ºä¾‹2ï¼š[ ]1234567891011121314151617181920212223242526272829303132333435#coding=utf-8import re# å¦‚æžœhelloçš„é¦–å­—ç¬¦å°å†™ï¼Œé‚£ä¹ˆæ­£åˆ™è¡¨è¾¾å¼éœ€è¦å°å†™çš„hret = re.match("h","hello Python") print(ret.group())# å¦‚æžœhelloçš„é¦–å­—ç¬¦å¤§å†™ï¼Œé‚£ä¹ˆæ­£åˆ™è¡¨è¾¾å¼éœ€è¦å¤§å†™çš„Hret = re.match("H","Hello Python") print(ret.group())# å¤§å°å†™héƒ½å¯ä»¥çš„æƒ…å†µret = re.match("[hH]","hello Python")print(ret.group())ret = re.match("[hH]","Hello Python")print(ret.group())ret = re.match("[hH]ello Python","Hello Python")print(ret.group())# åŒ¹é…0åˆ°9ç¬¬ä¸€ç§å†™æ³•ret = re.match("[0123456789]Hello Python","7Hello Python")print(ret.group())# åŒ¹é…0åˆ°9ç¬¬äºŒç§å†™æ³•ret = re.match("[0-9]Hello Python","7Hello Python")print(ret.group())ret = re.match("[0-35-9]Hello Python","7Hello Python")print(ret.group())# ä¸‹é¢è¿™ä¸ªæ­£åˆ™ä¸èƒ½å¤ŸåŒ¹é…åˆ°æ•°å­—4ï¼Œå› æ­¤retä¸ºNoneret = re.match("[0-35-9]Hello Python","4Hello Python")# print(ret.group())è¿è¡Œç»“æžœä¸ºï¼š12345678hHhHHello Python7Hello Python7Hello Python7Hello Pythonç¤ºä¾‹3ï¼š\d1234567891011121314151617181920212223#coding=utf-8import re# æ™®é€šçš„åŒ¹é…æ–¹å¼ret = re.match("å«¦å¨¥1å·","å«¦å¨¥1å·å‘å°„æˆåŠŸ") print(ret.group())ret = re.match("å«¦å¨¥2å·","å«¦å¨¥2å·å‘å°„æˆåŠŸ") print(ret.group())ret = re.match("å«¦å¨¥3å·","å«¦å¨¥3å·å‘å°„æˆåŠŸ") print(ret.group())# ä½¿ç”¨\dè¿›è¡ŒåŒ¹é…ret = re.match("å«¦å¨¥\då·","å«¦å¨¥1å·å‘å°„æˆåŠŸ") print(ret.group())ret = re.match("å«¦å¨¥\då·","å«¦å¨¥2å·å‘å°„æˆåŠŸ") print(ret.group())ret = re.match("å«¦å¨¥\då·","å«¦å¨¥3å·å‘å°„æˆåŠŸ") print(ret.group())è¿è¡Œç»“æžœä¸ºï¼š123456å«¦å¨¥1å·å«¦å¨¥2å·å«¦å¨¥3å·å«¦å¨¥1å·å«¦å¨¥2å·å«¦å¨¥3å·nåŒ¹é…å¤šä¸ªå­—ç¬¦å­—ç¬¦åŠŸèƒ½*åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦å‡ºçŽ°0æ¬¡æˆ–è€…æ— é™æ¬¡ï¼Œå³å¯æœ‰å¯æ— +åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦å‡ºçŽ°1æ¬¡æˆ–è€…æ— é™æ¬¡ï¼Œå³è‡³å°‘æœ‰1æ¬¡?åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦å‡ºçŽ°1æ¬¡æˆ–è€…0æ¬¡ï¼Œå³è¦ä¹ˆæœ‰1æ¬¡ï¼Œè¦ä¹ˆæ²¡æœ‰{m}åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦å‡ºçŽ°mæ¬¡{m,n}åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦å‡ºçŽ°ä»Žmåˆ°næ¬¡ç¤ºä¾‹1ï¼š*éœ€æ±‚ï¼šåŒ¹é…å‡ºï¼Œä¸€ä¸ªå­—ç¬¦ä¸²ç¬¬ä¸€ä¸ªå­—æ¯ä¸ºå¤§å°å­—ç¬¦ï¼ŒåŽé¢éƒ½æ˜¯å°å†™å­—æ¯å¹¶ä¸”è¿™äº›å°å†™å­—æ¯å¯æœ‰å¯æ— 1234567891011#coding=utf-8import reret = re.match("[A-Z][a-z]*","M")print(ret.group())ret = re.match("[A-Z][a-z]*","MnnM")print(ret.group())ret = re.match("[A-Z][a-z]*","Aabcdef")print(ret.group())è¿è¡Œç»“æžœï¼š123MMnnAabcdefç¤ºä¾‹2ï¼š+éœ€æ±‚ï¼šåŒ¹é…å‡ºï¼Œå˜é‡åæ˜¯å¦æœ‰æ•ˆ1234567891011#coding=utf-8import renames = ["name1", "_name", "2_name", "__name__"]for name in names: ret = re.match("[a-zA-Z_]+[\w]*",name) if ret: print("å˜é‡å %s ç¬¦åˆè¦æ±‚" % ret.group()) else: print("å˜é‡å %s éžæ³•" % name)è¿è¡Œç»“æžœï¼š1234å˜é‡å name1 ç¬¦åˆè¦æ±‚å˜é‡å _name ç¬¦åˆè¦æ±‚å˜é‡å 2_name éžæ³•å˜é‡å __name__ ç¬¦åˆè¦æ±‚ç¤ºä¾‹3ï¼š?éœ€æ±‚ï¼šåŒ¹é…å‡ºï¼Œ0åˆ°99ä¹‹é—´çš„æ•°å­—1234567891011#coding=utf-8import reret = re.match("[1-9]?[0-9]","7")print(ret.group())ret = re.match("[1-9]?\d","33")print(ret.group())ret = re.match("[1-9]?\d","09")print(ret.group())è¿è¡Œç»“æžœï¼š1237330 # è¿™ä¸ªç»“æžœå¹¶ä¸æ˜¯æƒ³è¦çš„ï¼Œåˆ©ç”¨$æ‰èƒ½è§£å†³ç¤ºä¾‹4ï¼š{m}éœ€æ±‚ï¼šåŒ¹é…å‡ºï¼Œ8åˆ°20ä½çš„å¯†ç ï¼Œå¯ä»¥æ˜¯å¤§å°å†™è‹±æ–‡å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿12345678#coding=utf-8import reret = re.match("[a-zA-Z0-9_]&#123;6&#125;","12a3g45678")print(ret.group())ret = re.match("[a-zA-Z0-9_]&#123;8,20&#125;","1ad12f23s34455ff66")print(ret.group())è¿è¡Œç»“æžœï¼š1212a3g41ad12f23s34455ff66åŒ¹é…å¼€å¤´ç»“å°¾å­—ç¬¦åŠŸèƒ½^åŒ¹é…å­—ç¬¦ä¸²å¼€å¤´$åŒ¹é…å­—ç¬¦ä¸²ç»“å°¾ç¤ºä¾‹1ï¼š$éœ€æ±‚ï¼šåŒ¹é…163.comçš„é‚®ç®±åœ°å€123456789101112#coding=utf-8import reemail_list = ["xiaoWang@163.com", "xiaoWang@163.comheihei", ".com.xiaowang@qq.com"]for email in email_list: ret = re.match("[\w]&#123;4,20&#125;@163\.com", email) if ret: print("%s æ˜¯ç¬¦åˆè§„å®šçš„é‚®ä»¶åœ°å€,åŒ¹é…åŽçš„ç»“æžœæ˜¯:%s" % (email, ret.group())) else: print("%s ä¸ç¬¦åˆè¦æ±‚" % email)è¿è¡Œç»“æžœ:123xiaoWang@163.com æ˜¯ç¬¦åˆè§„å®šçš„é‚®ä»¶åœ°å€,åŒ¹é…åŽçš„ç»“æžœæ˜¯:xiaoWang@163.comxiaoWang@163.comheihei æ˜¯ç¬¦åˆè§„å®šçš„é‚®ä»¶åœ°å€,åŒ¹é…åŽçš„ç»“æžœæ˜¯:xiaoWang@163.com.com.xiaowang@qq.com ä¸ç¬¦åˆè¦æ±‚å®Œå–„åŽ12345678email_list = ["xiaoWang@163.com", "xiaoWang@163.comheihei", ".com.xiaowang@qq.com"]for email in email_list: ret = re.match("[\w]&#123;4,20&#125;@163\.com$", email) if ret: print("%s æ˜¯ç¬¦åˆè§„å®šçš„é‚®ä»¶åœ°å€,åŒ¹é…åŽçš„ç»“æžœæ˜¯:%s" % (email, ret.group())) else: print("%s ä¸ç¬¦åˆè¦æ±‚" % email)è¿è¡Œç»“æžœï¼š123xiaoWang@163.com æ˜¯ç¬¦åˆè§„å®šçš„é‚®ä»¶åœ°å€,åŒ¹é…åŽçš„ç»“æžœæ˜¯:xiaoWang@163.comxiaoWang@163.comheihei ä¸ç¬¦åˆè¦æ±‚.com.xiaowang@qq.com ä¸ç¬¦åˆè¦æ±‚åŒ¹é…åˆ†ç»„å­—ç¬¦åŠŸèƒ½\åŒ¹é…å·¦å³ä»»æ„ä¸€ä¸ªè¡¨è¾¾å¼(ab)å°†æ‹¬å·ä¸­å­—ç¬¦ä½œä¸ºä¸€ä¸ªåˆ†ç»„\numå¼•ç”¨åˆ†ç»„numåŒ¹é…åˆ°çš„å­—ç¬¦ä¸²(?P&lt;name&gt;)åˆ†ç»„èµ·åˆ«å(?P=name)å¼•ç”¨åˆ«åä¸ºnameåˆ†ç»„åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²ç¤ºä¾‹1ï¼š|éœ€æ±‚ï¼šåŒ¹é…å‡º0-100ä¹‹é—´çš„æ•°å­—123456789101112131415161718192021222324252627282930313233#coding=utf-8import reret = re.match("[1-9]?\d","8")print(ret.group()) # 8ret = re.match("[1-9]?\d","78")print(ret.group()) # 78# ä¸æ­£ç¡®çš„æƒ…å†µret = re.match("[1-9]?\d","08")print(ret.group()) # 0# ä¿®æ­£ä¹‹åŽçš„ret = re.match("[1-9]?\d$","08")if ret: print(ret.group())else: print("ä¸åœ¨0-100ä¹‹é—´")# æ·»åŠ |ret = re.match("[1-9]?\d$|100","8")print(ret.group()) # 8ret = re.match("[1-9]?\d$|100","78")print(ret.group()) # 78ret = re.match("[1-9]?\d$|100","08")# print(ret.group()) # ä¸æ˜¯0-100ä¹‹é—´ret = re.match("[1-9]?\d$|100","100")print(ret.group()) # 100ç¤ºä¾‹2ï¼š( )éœ€æ±‚ï¼šåŒ¹é…å‡º163ã€126ã€qqé‚®ç®±123456789101112131415161718#coding=utf-8import reret = re.match("\w&#123;4,20&#125;@163\.com", "test@163.com")print(ret.group()) # test@163.comret = re.match("\w&#123;4,20&#125;@(163|126|qq)\.com", "test@126.com")print(ret.group()) # test@126.comret = re.match("\w&#123;4,20&#125;@(163|126|qq)\.com", "test@qq.com")print(ret.group()) # test@qq.comret = re.match("\w&#123;4,20&#125;@(163|126|qq)\.com", "test@gmail.com")if ret: print(ret.group())else: print("ä¸æ˜¯163ã€126ã€qqé‚®ç®±") # ä¸æ˜¯163ã€126ã€qqé‚®ç®±ä¸æ˜¯ä»¥4ã€7ç»“å°¾çš„æ‰‹æœºå·ç (11ä½)12345678910import retels = ["13100001234", "18912344321", "10086", "18800007777"]for tel in tels: ret = re.match("1\d&#123;9&#125;[0-35-68-9]", tel) if ret: print(ret.group()) else: print("%s ä¸æ˜¯æƒ³è¦çš„æ‰‹æœºå·" % tel)æå–åŒºå·å’Œç”µè¯å·ç 1234567&gt;&gt;&gt; ret = re.match("([^-]*)-(\d+)","010-12345678")&gt;&gt;&gt; ret.group()'010-12345678'&gt;&gt;&gt; ret.group(1)'010'&gt;&gt;&gt; ret.group(2)'12345678'ç¤ºä¾‹3ï¼š\éœ€æ±‚ï¼šåŒ¹é…å‡º&lt;html&gt;hh&lt;/html&gt;12345678910111213141516171819202122232425#coding=utf-8import re# èƒ½å¤Ÿå®Œæˆå¯¹æ­£ç¡®çš„å­—ç¬¦ä¸²çš„åŒ¹é…ret = re.match("&lt;[a-zA-Z]*&gt;\w*&lt;/[a-zA-Z]*&gt;", "&lt;html&gt;hh&lt;/html&gt;")print(ret.group())# å¦‚æžœé‡åˆ°éžæ­£å¸¸çš„htmlæ ¼å¼å­—ç¬¦ä¸²ï¼ŒåŒ¹é…å‡ºé”™ret = re.match("&lt;[a-zA-Z]*&gt;\w*&lt;/[a-zA-Z]*&gt;", "&lt;html&gt;hh&lt;/htmlbalabala&gt;")print(ret.group())# æ­£ç¡®çš„ç†è§£æ€è·¯ï¼šå¦‚æžœåœ¨ç¬¬ä¸€å¯¹&lt;&gt;ä¸­æ˜¯ä»€ä¹ˆï¼ŒæŒ‰ç†è¯´åœ¨åŽé¢çš„é‚£å¯¹&lt;&gt;ä¸­å°±åº”è¯¥æ˜¯ä»€ä¹ˆ# é€šè¿‡å¼•ç”¨åˆ†ç»„ä¸­åŒ¹é…åˆ°çš„æ•°æ®å³å¯ï¼Œä½†æ˜¯è¦æ³¨æ„æ˜¯å…ƒå­—ç¬¦ä¸²ï¼Œå³ç±»ä¼¼ r""è¿™ç§æ ¼å¼ret = re.match(r"&lt;([a-zA-Z]*)&gt;\w*&lt;/\1&gt;", "&lt;html&gt;hh&lt;/html&gt;")print(ret.group())# å› ä¸º2å¯¹&lt;&gt;ä¸­çš„æ•°æ®ä¸ä¸€è‡´ï¼Œæ‰€ä»¥æ²¡æœ‰åŒ¹é…å‡ºæ¥test_label = "&lt;html&gt;hh&lt;/htmlbalabala&gt;"ret = re.match(r"&lt;([a-zA-Z]*)&gt;\w*&lt;/\1&gt;", test_label)if ret: print(ret.group())else: print("%s è¿™æ˜¯ä¸€å¯¹ä¸æ­£ç¡®çš„æ ‡ç­¾" % test_label)è¿è¡Œç»“æžœï¼š1234&lt;html&gt;hh&lt;/html&gt;&lt;html&gt;hh&lt;/htmlbalabala&gt;&lt;html&gt;hh&lt;/html&gt;&lt;html&gt;hh&lt;/htmlbalabala&gt; è¿™æ˜¯ä¸€å¯¹ä¸æ­£ç¡®çš„æ ‡ç­¾ç¤ºä¾‹4ï¼š\numberéœ€æ±‚ï¼šåŒ¹é…å‡º&lt;html&gt;&lt;h1&gt;www.itcast.cn&lt;/h1&gt;&lt;/html&gt;123456789101112#coding=utf-8import relabels = ["&lt;html&gt;&lt;h1&gt;www.itcast.cn&lt;/h1&gt;&lt;/html&gt;", "&lt;html&gt;&lt;h1&gt;www.itcast.cn&lt;/h2&gt;&lt;/html&gt;"]for label in labels: ret = re.match(r"&lt;(\w*)&gt;&lt;(\w*)&gt;.*&lt;/\2&gt;&lt;/\1&gt;", label) if ret: print("%s æ˜¯ç¬¦åˆè¦æ±‚çš„æ ‡ç­¾" % ret.group()) else: print("%s ä¸ç¬¦åˆè¦æ±‚" % label)è¿è¡Œç»“æžœï¼š12&lt;html&gt;&lt;h1&gt;www.itcast.cn&lt;/h1&gt;&lt;/html&gt; æ˜¯ç¬¦åˆè¦æ±‚çš„æ ‡ç­¾&lt;html&gt;&lt;h1&gt;www.itcast.cn&lt;/h2&gt;&lt;/html&gt; ä¸ç¬¦åˆè¦æ±‚ç¤ºä¾‹5ï¼š(?P&lt;name&gt;) (?P=name)éœ€æ±‚ï¼šåŒ¹é…å‡º&lt;html&gt;&lt;h1&gt;www.itcast.cn&lt;/h1&gt;&lt;/html&gt;123456789#coding=utf-8import reret = re.match(r"&lt;(?P&lt;name1&gt;\w*)&gt;&lt;(?P&lt;name2&gt;\w*)&gt;.*&lt;/(?P=name2)&gt;&lt;/(?P=name1)&gt;", "&lt;html&gt;&lt;h1&gt;www.itcast.cn&lt;/h1&gt;&lt;/html&gt;")ret.group()ret = re.match(r"&lt;(?P&lt;name1&gt;\w*)&gt;&lt;(?P&lt;name2&gt;\w*)&gt;.*&lt;/(?P=name2)&gt;&lt;/(?P=name1)&gt;", "&lt;html&gt;&lt;h1&gt;www.itcast.cn&lt;/h2&gt;&lt;/html&gt;")ret.group()æ³¨æ„ï¼š(?P&lt;name&gt;)å’Œ(?P=name)ä¸­çš„å­—æ¯på¤§å†™reæ¨¡å—çš„é«˜çº§ç”¨æ³•searchéœ€æ±‚ï¼šåŒ¹é…å‡ºæ–‡ç« é˜…è¯»çš„æ¬¡æ•°12345#coding=utf-8import reret = re.search(r"\d+", "é˜…è¯»æ¬¡æ•°ä¸º 9999")ret.group()è¿è¡Œç»“æžœï¼š1'9999'findalléœ€æ±‚ï¼šç»Ÿè®¡å‡ºpythonã€cã€c++ç›¸åº”æ–‡ç« é˜…è¯»çš„æ¬¡æ•°12345#coding=utf-8import reret = re.findall(r"\d+", "python = 9999, c = 7890, c++ = 12345")print(ret)è¿è¡Œç»“æžœï¼š1['9999', '7890', '12345']sub å°†åŒ¹é…åˆ°çš„æ•°æ®è¿›è¡Œæ›¿æ¢éœ€æ±‚ï¼šå°†åŒ¹é…åˆ°çš„é˜…è¯»æ¬¡æ•°åŠ 1æ–¹æ³•1ï¼š12345#coding=utf-8import reret = re.sub(r"\d+", '998', "python = 997")print(ret)è¿è¡Œç»“æžœï¼š1python = 998æ–¹æ³•2ï¼š12345678910111213#coding=utf-8import redef add(temp): strNum = temp.group() num = int(strNum) + 1 return str(num)ret = re.sub(r"\d+", add, "python = 997")print(ret)ret = re.sub(r"\d+", add, "python = 99")print(ret)è¿è¡Œç»“æžœï¼š12python = 998python = 100ä»Žä¸‹é¢çš„å­—ç¬¦ä¸²ä¸­å–å‡ºæ–‡æœ¬123456789101112131415161718&lt;div&gt; &lt;p&gt;å²—ä½èŒè´£ï¼š&lt;/p&gt;&lt;p&gt;å®ŒæˆæŽ¨èç®—æ³•ã€æ•°æ®ç»Ÿè®¡ã€æŽ¥å£ã€åŽå°ç­‰æœåŠ¡å™¨ç«¯ç›¸å…³å·¥ä½œ&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;å¿…å¤‡è¦æ±‚ï¼š&lt;/p&gt;&lt;p&gt;è‰¯å¥½çš„è‡ªæˆ‘é©±åŠ¨åŠ›å’ŒèŒä¸šç´ å…»ï¼Œå·¥ä½œç§¯æžä¸»åŠ¨ã€ç»“æžœå¯¼å‘&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;br&gt;&lt;/p&gt;&lt;p&gt;æŠ€æœ¯è¦æ±‚ï¼š&lt;/p&gt;&lt;p&gt;1ã€ä¸€å¹´ä»¥ä¸Š Python å¼€å‘ç»éªŒï¼ŒæŽŒæ¡é¢å‘å¯¹è±¡åˆ†æžå’Œè®¾è®¡ï¼Œäº†è§£è®¾è®¡æ¨¡å¼&lt;/p&gt;&lt;p&gt;2ã€æŽŒæ¡HTTPåè®®ï¼Œç†Ÿæ‚‰MVCã€MVVMç­‰æ¦‚å¿µä»¥åŠç›¸å…³WEBå¼€å‘æ¡†æž¶&lt;/p&gt;&lt;p&gt;3ã€æŽŒæ¡å…³ç³»æ•°æ®åº“å¼€å‘è®¾è®¡ï¼ŒæŽŒæ¡ SQLï¼Œç†Ÿç»ƒä½¿ç”¨ MySQL/PostgreSQL ä¸­çš„ä¸€ç§&lt;br&gt;&lt;/p&gt;&lt;p&gt;4ã€æŽŒæ¡NoSQLã€MQï¼Œç†Ÿç»ƒä½¿ç”¨å¯¹åº”æŠ€æœ¯è§£å†³æ–¹æ¡ˆ&lt;/p&gt;&lt;p&gt;5ã€ç†Ÿæ‚‰ Javascript/CSS/HTML5ï¼ŒJQueryã€Reactã€Vue.js&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;br&gt;&lt;/p&gt;&lt;p&gt;åŠ åˆ†é¡¹ï¼š&lt;/p&gt;&lt;p&gt;å¤§æ•°æ®ï¼Œæ•°ç†ç»Ÿè®¡ï¼Œæœºå™¨å­¦ä¹ ï¼Œsklearnï¼Œé«˜æ€§èƒ½ï¼Œå¤§å¹¶å‘ã€‚&lt;/p&gt; &lt;/div&gt;å‚è€ƒç­”æ¡ˆ:1re.sub(r"&lt;[^&gt;]*&gt;|&amp;nbsp;|\n", "", test_str)split æ ¹æ®åŒ¹é…è¿›è¡Œåˆ‡å‰²å­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›žä¸€ä¸ªåˆ—è¡¨éœ€æ±‚ï¼šåˆ‡å‰²å­—ç¬¦ä¸²â€œinfo:xiaoZhang 33 shandongâ€12345#coding=utf-8import reret = re.split(r":| ","info:xiaoZhang 33 shandong")print(ret)è¿è¡Œç»“æžœï¼š1['info', 'xiaoZhang', '33', 'shandong']pythonè´ªå©ªå’Œéžè´ªå©ªPythoné‡Œæ•°é‡è¯é»˜è®¤æ˜¯è´ªå©ªçš„ï¼ˆåœ¨å°‘æ•°è¯­è¨€é‡Œä¹Ÿå¯èƒ½æ˜¯é»˜è®¤éžè´ªå©ªï¼‰ï¼Œæ€»æ˜¯å°è¯•åŒ¹é…å°½å¯èƒ½å¤šçš„å­—ç¬¦ï¼›éžè´ªå©ªåˆ™ç›¸åï¼Œæ€»æ˜¯å°è¯•åŒ¹é…å°½å¯èƒ½å°‘çš„å­—ç¬¦ã€‚åœ¨â€*â€,â€?â€,â€+â€,â€{m,n}â€åŽé¢åŠ ä¸Šï¼Ÿï¼Œä½¿è´ªå©ªå˜æˆéžè´ªå©ªã€‚12345678&gt;&gt;&gt; s="This is a number 234-235-22-423"&gt;&gt;&gt; r=re.match(".+(\d+-\d+-\d+-\d+)",s)&gt;&gt;&gt; r.group(1)'4-235-22-423'&gt;&gt;&gt; r=re.match(".+?(\d+-\d+-\d+-\d+)",s)&gt;&gt;&gt; r.group(1)'234-235-22-423'&gt;&gt;&gt;æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­ä½¿ç”¨åˆ°é€šé…å­—ï¼Œé‚£å®ƒåœ¨ä»Žå·¦åˆ°å³çš„é¡ºåºæ±‚å€¼æ—¶ï¼Œä¼šå°½é‡â€œæŠ“å–â€æ»¡è¶³åŒ¹é…æœ€é•¿å­—ç¬¦ä¸²ï¼Œåœ¨æˆ‘ä»¬ä¸Šé¢çš„ä¾‹å­é‡Œé¢ï¼Œâ€œ.+â€ä¼šä»Žå­—ç¬¦ä¸²çš„å¯å§‹å¤„æŠ“å–æ»¡è¶³æ¨¡å¼çš„æœ€é•¿å­—ç¬¦ï¼Œå…¶ä¸­åŒ…æ‹¬æˆ‘ä»¬æƒ³å¾—åˆ°çš„ç¬¬ä¸€ä¸ªæ•´åž‹å­—æ®µçš„ä¸­çš„å¤§éƒ¨åˆ†ï¼Œâ€œ\d+â€åªéœ€ä¸€ä½å­—ç¬¦å°±å¯ä»¥åŒ¹é…ï¼Œæ‰€ä»¥å®ƒåŒ¹é…äº†æ•°å­—â€œ4â€ï¼Œè€Œâ€œ.+â€åˆ™åŒ¹é…äº†ä»Žå­—ç¬¦ä¸²èµ·å§‹åˆ°è¿™ä¸ªç¬¬ä¸€ä½æ•°å­—4ä¹‹å‰çš„æ‰€æœ‰å­—ç¬¦ã€‚è§£å†³æ–¹å¼ï¼šéžè´ªå©ªæ“ä½œç¬¦â€œï¼Ÿâ€ï¼Œè¿™ä¸ªæ“ä½œç¬¦å¯ä»¥ç”¨åœ¨â€*â€,â€+â€,â€?â€çš„åŽé¢ï¼Œè¦æ±‚æ­£åˆ™åŒ¹é…çš„è¶Šå°‘è¶Šå¥½ã€‚123456789&gt;&gt;&gt; re.match(r"aa(\d+)","aa2343ddd").group(1)'2343'&gt;&gt;&gt; re.match(r"aa(\d+?)","aa2343ddd").group(1)'2'&gt;&gt;&gt; re.match(r"aa(\d+)ddd","aa2343ddd").group(1) '2343'&gt;&gt;&gt; re.match(r"aa(\d+?)ddd","aa2343ddd").group(1)'2343'&gt;&gt;&gt;rçš„ä½œç”¨123456789101112131415161718192021&gt;&gt;&gt; mm = "c:\\a\\b\\c"&gt;&gt;&gt; mm'c:\\a\\b\\c'&gt;&gt;&gt; print(mm)c:\a\b\c&gt;&gt;&gt; re.match("c:\\\\",mm).group()'c:\\'&gt;&gt;&gt; ret = re.match("c:\\\\",mm).group()&gt;&gt;&gt; print(ret)c:\&gt;&gt;&gt; ret = re.match("c:\\\\a",mm).group()&gt;&gt;&gt; print(ret)c:\a&gt;&gt;&gt; ret = re.match(r"c:\\a",mm).group()&gt;&gt;&gt; print(ret)c:\a&gt;&gt;&gt; ret = re.match(r"c:\a",mm).group()Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt;AttributeError: 'NoneType' object has no attribute 'group'&gt;&gt;&gt;è¯´æ˜ŽPythonä¸­å­—ç¬¦ä¸²å‰é¢åŠ ä¸Š r è¡¨ç¤ºåŽŸç”Ÿå­—ç¬¦ä¸²ï¼Œä¸Žå¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ç›¸åŒï¼Œæ­£åˆ™è¡¨è¾¾å¼é‡Œä½¿ç”¨&quot;\&quot;ä½œä¸ºè½¬ä¹‰å­—ç¬¦ï¼Œè¿™å°±å¯èƒ½é€ æˆåæ–œæ å›°æ‰°ã€‚å‡å¦‚ä½ éœ€è¦åŒ¹é…æ–‡æœ¬ä¸­çš„å­—ç¬¦â€\â€ï¼Œé‚£ä¹ˆä½¿ç”¨ç¼–ç¨‹è¯­è¨€è¡¨ç¤ºçš„æ­£åˆ™è¡¨è¾¾å¼é‡Œå°†éœ€è¦4ä¸ªåæ–œæ â€\â€œï¼šå‰ä¸¤ä¸ªå’ŒåŽä¸¤ä¸ªåˆ†åˆ«ç”¨äºŽåœ¨ç¼–ç¨‹è¯­è¨€é‡Œè½¬ä¹‰æˆåæ–œæ ï¼Œè½¬æ¢æˆä¸¤ä¸ªåæ–œæ åŽå†åœ¨æ­£åˆ™è¡¨è¾¾å¼é‡Œè½¬ä¹‰æˆä¸€ä¸ªåæ–œæ ã€‚Pythoné‡Œçš„åŽŸç”Ÿå­—ç¬¦ä¸²å¾ˆå¥½åœ°è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œæœ‰äº†åŽŸç”Ÿå­—ç¬¦ä¸²ï¼Œä½ å†ä¹Ÿä¸ç”¨æ‹…å¿ƒæ˜¯ä¸æ˜¯æ¼å†™äº†åæ–œæ ï¼Œå†™å‡ºæ¥çš„è¡¨è¾¾å¼ä¹Ÿæ›´ç›´è§‚ã€‚123&gt;&gt;&gt; ret = re.match(r"c:\\a",mm).group()&gt;&gt;&gt; print(ret)c:\a]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python_æ¨¡å—å’ŒåŒ…]]></title>
    <url>%2F2019%2F12%2F31%2Fpython_%E6%A8%A1%E5%9D%97%E5%92%8C%E5%8C%85%2F</url>
    <content type="text"><![CDATA[æ¨¡å—å’ŒåŒ…01. æ¨¡å—1.1 æ¨¡å—çš„æ¦‚å¿µæ¨¡å—æ˜¯ Python ç¨‹åºæž¶æž„çš„ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µæ¯ä¸€ä¸ªä»¥æ‰©å±•å py ç»“å°¾çš„ Python æºä»£ç æ–‡ä»¶éƒ½æ˜¯ä¸€ä¸ª æ¨¡å—æ¨¡å—å åŒæ ·ä¹Ÿæ˜¯ä¸€ä¸ª æ ‡è¯†ç¬¦ï¼Œéœ€è¦ç¬¦åˆæ ‡è¯†ç¬¦çš„å‘½åè§„åˆ™åœ¨æ¨¡å—ä¸­å®šä¹‰çš„ å…¨å±€å˜é‡ ã€å‡½æ•°ã€ç±» éƒ½æ˜¯æä¾›ç»™å¤–ç•Œç›´æŽ¥ä½¿ç”¨çš„ å·¥å…·æ¨¡å— å°±å¥½æ¯”æ˜¯ å·¥å…·åŒ…ï¼Œè¦æƒ³ä½¿ç”¨è¿™ä¸ªå·¥å…·åŒ…ä¸­çš„å·¥å…·ï¼Œå°±éœ€è¦å…ˆ å¯¼å…¥ è¿™ä¸ªæ¨¡å—1.2 æ¨¡å—çš„ä¸¤ç§å¯¼å…¥æ–¹å¼1ï¼‰import å¯¼å…¥1import æ¨¡å—å1, æ¨¡å—å2æç¤ºï¼šåœ¨å¯¼å…¥æ¨¡å—æ—¶ï¼Œæ¯ä¸ªå¯¼å…¥åº”è¯¥ç‹¬å ä¸€è¡Œ12import æ¨¡å—å1import æ¨¡å—å2å¯¼å…¥ä¹‹åŽé€šè¿‡ æ¨¡å—å. ä½¿ç”¨ æ¨¡å—æä¾›çš„å·¥å…· â€”â€” å…¨å±€å˜é‡ã€å‡½æ•°ã€ç±»ä½¿ç”¨ as æŒ‡å®šæ¨¡å—çš„åˆ«åå¦‚æžœæ¨¡å—çš„åå­—å¤ªé•¿ï¼Œå¯ä»¥ä½¿ç”¨ as æŒ‡å®šæ¨¡å—çš„åç§°ï¼Œä»¥æ–¹ä¾¿åœ¨ä»£ç ä¸­çš„ä½¿ç”¨1import æ¨¡å—å1 as æ¨¡å—åˆ«åæ³¨æ„ï¼šæ¨¡å—åˆ«å åº”è¯¥ç¬¦åˆ å¤§é©¼å³°å‘½åæ³•2ï¼‰fromâ€¦import å¯¼å…¥å¦‚æžœå¸Œæœ› ä»ŽæŸä¸€ä¸ªæ¨¡å— ä¸­ï¼Œå¯¼å…¥ éƒ¨åˆ† å·¥å…·ï¼Œå°±å¯ä»¥ä½¿ç”¨ from â€¦ import çš„æ–¹å¼import æ¨¡å—å æ˜¯ ä¸€æ¬¡æ€§ æŠŠæ¨¡å—ä¸­ æ‰€æœ‰å·¥å…·å…¨éƒ¨å¯¼å…¥ï¼Œå¹¶ä¸”é€šè¿‡ æ¨¡å—å/åˆ«å è®¿é—®12# ä»Ž æ¨¡å— å¯¼å…¥ æŸä¸€ä¸ªå·¥å…·from æ¨¡å—å1 import å·¥å…·åå¯¼å…¥ä¹‹åŽä¸éœ€è¦ é€šè¿‡ æ¨¡å—å.å¯ä»¥ç›´æŽ¥ä½¿ç”¨ æ¨¡å—æä¾›çš„å·¥å…· â€”â€” å…¨å±€å˜é‡ã€å‡½æ•°ã€ç±»æ³¨æ„å¦‚æžœ ä¸¤ä¸ªæ¨¡å—ï¼Œå­˜åœ¨ åŒåçš„å‡½æ•°ï¼Œé‚£ä¹ˆ åŽå¯¼å…¥æ¨¡å—çš„å‡½æ•°ï¼Œä¼š è¦†ç›–æŽ‰å…ˆå¯¼å…¥çš„å‡½æ•°å¼€å‘æ—¶ import ä»£ç åº”è¯¥ç»Ÿä¸€å†™åœ¨ ä»£ç çš„é¡¶éƒ¨ï¼Œæ›´å®¹æ˜“åŠæ—¶å‘çŽ°å†²çªä¸€æ—¦å‘çŽ°å†²çªï¼Œå¯ä»¥ä½¿ç”¨ as å…³é”®å­— ç»™å…¶ä¸­ä¸€ä¸ªå·¥å…·èµ·ä¸€ä¸ªåˆ«åfromâ€¦import *ï¼ˆçŸ¥é“ï¼‰12# ä»Ž æ¨¡å— å¯¼å…¥ æ‰€æœ‰å·¥å…·from æ¨¡å—å1 import *æ³¨æ„è¿™ç§æ–¹å¼ä¸æŽ¨èä½¿ç”¨ï¼Œå› ä¸ºå‡½æ•°é‡åå¹¶æ²¡æœ‰ä»»ä½•çš„æç¤ºï¼Œå‡ºçŽ°é—®é¢˜ä¸å¥½æŽ’æŸ¥1.3 æ¨¡å—çš„æœç´¢é¡ºåº[æ‰©å±•]Python çš„è§£é‡Šå™¨åœ¨ å¯¼å…¥æ¨¡å— æ—¶ï¼Œä¼šï¼šæœç´¢ å½“å‰ç›®å½• æŒ‡å®šæ¨¡å—åçš„æ–‡ä»¶ï¼Œå¦‚æžœæœ‰å°±ç›´æŽ¥å¯¼å…¥å¦‚æžœæ²¡æœ‰ï¼Œå†æœç´¢ ç³»ç»Ÿç›®å½•åœ¨å¼€å‘æ—¶ï¼Œç»™æ–‡ä»¶èµ·åï¼Œä¸è¦å’Œ ç³»ç»Ÿçš„æ¨¡å—æ–‡ä»¶ é‡åPython ä¸­æ¯ä¸€ä¸ªæ¨¡å—éƒ½æœ‰ä¸€ä¸ªå†…ç½®å±žæ€§ _file__å¯ä»¥ æŸ¥çœ‹æ¨¡å— çš„ å®Œæ•´è·¯å¾„ç¤ºä¾‹123456import random# ç”Ÿæˆä¸€ä¸ª 0ï½ž10 çš„æ•°å­—rand = random.randint(0, 10)print(rand)æ³¨æ„ï¼šå¦‚æžœå½“å‰ç›®å½•ä¸‹ï¼Œå­˜åœ¨ä¸€ä¸ª random.py çš„æ–‡ä»¶ï¼Œç¨‹åºå°±æ— æ³•æ­£å¸¸æ‰§è¡Œäº†ï¼è¿™ä¸ªæ—¶å€™ï¼ŒPython çš„è§£é‡Šå™¨ä¼š åŠ è½½å½“å‰ç›®å½• ä¸‹çš„ random.py è€Œä¸ä¼šåŠ è½½ ç³»ç»Ÿçš„ random æ¨¡å—1.4 åŽŸåˆ™ â€”â€” æ¯ä¸€ä¸ªæ–‡ä»¶éƒ½åº”è¯¥æ˜¯å¯ä»¥è¢«å¯¼å…¥çš„ä¸€ä¸ª ç‹¬ç«‹çš„ Python æ–‡ä»¶ å°±æ˜¯ä¸€ä¸ª æ¨¡å—åœ¨å¯¼å…¥æ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶ä¸­ æ‰€æœ‰æ²¡æœ‰ä»»ä½•ç¼©è¿›çš„ä»£ç  éƒ½ä¼šè¢«æ‰§è¡Œä¸€éï¼å®žé™…å¼€å‘åœºæ™¯åœ¨å®žé™…å¼€å‘ä¸­ï¼Œæ¯ä¸€ä¸ªæ¨¡å—éƒ½æ˜¯ç‹¬ç«‹å¼€å‘çš„ï¼Œå¤§å¤šéƒ½æœ‰ä¸“äººè´Ÿè´£å¼€å‘äººå‘˜ é€šå¸¸ä¼šåœ¨ æ¨¡å—ä¸‹æ–¹ å¢žåŠ ä¸€äº›æµ‹è¯•ä»£ç ä»…åœ¨æ¨¡å—å†…ä½¿ç”¨ï¼Œè€Œè¢«å¯¼å…¥åˆ°å…¶ä»–æ–‡ä»¶ä¸­ä¸éœ€è¦æ‰§è¡Œ__name__å±žæ€§name å±žæ€§å¯ä»¥åšåˆ°ï¼Œæµ‹è¯•æ¨¡å—çš„ä»£ç  åªåœ¨æµ‹è¯•æƒ…å†µä¸‹è¢«è¿è¡Œï¼Œè€Œåœ¨ è¢«å¯¼å…¥æ—¶ä¸ä¼šè¢«æ‰§è¡Œï¼__name__æ˜¯ Python çš„ä¸€ä¸ªå†…ç½®å±žæ€§ï¼Œè®°å½•ç€ä¸€ä¸ª å­—ç¬¦ä¸²å¦‚æžœ æ˜¯è¢«å…¶ä»–æ–‡ä»¶å¯¼å…¥çš„ï¼Œ__name__å°±æ˜¯ æ¨¡å—åå¦‚æžœ æ˜¯å½“å‰æ‰§è¡Œçš„ç¨‹åº __name__æ˜¯__main__åœ¨å¾ˆå¤š Python æ–‡ä»¶ä¸­éƒ½ä¼šçœ‹åˆ°ä»¥ä¸‹æ ¼å¼çš„ä»£ç ï¼š12345678910111213# å¯¼å…¥æ¨¡å—# å®šä¹‰å…¨å±€å˜é‡# å®šä¹‰ç±»# å®šä¹‰å‡½æ•°# åœ¨ä»£ç çš„æœ€ä¸‹æ–¹def main(): # ... pass# æ ¹æ® __name__ åˆ¤æ–­æ˜¯å¦æ‰§è¡Œä¸‹æ–¹ä»£ç if __name__ == "__main__": main()02. åŒ…ï¼ˆPackageï¼‰æ¦‚å¿µåŒ… æ˜¯ä¸€ä¸ª åŒ…å«å¤šä¸ªæ¨¡å— çš„ ç‰¹æ®Šç›®å½•ç›®å½•ä¸‹æœ‰ä¸€ä¸ª ç‰¹æ®Šçš„æ–‡ä»¶ __init__.pyåŒ…åçš„ å‘½åæ–¹å¼ å’Œå˜é‡åä¸€è‡´ï¼Œå°å†™å­—æ¯ + _å¥½å¤„ä½¿ç”¨ import åŒ…å å¯ä»¥ä¸€æ¬¡æ€§å¯¼å…¥ åŒ… ä¸­ æ‰€æœ‰çš„æ¨¡å—æ¡ˆä¾‹æ¼”ç»ƒæ–°å»ºä¸€ä¸ª hm_message çš„ åŒ…åœ¨ç›®å½•ä¸‹ï¼Œæ–°å»ºä¸¤ä¸ªæ–‡ä»¶ send_message å’Œ receive_messageåœ¨ send_message æ–‡ä»¶ä¸­å®šä¹‰ä¸€ä¸ª send å‡½æ•°åœ¨ receive_message æ–‡ä»¶ä¸­å®šä¹‰ä¸€ä¸ª receive å‡½æ•°åœ¨å¤–éƒ¨ç›´æŽ¥å¯¼å…¥ hm_message çš„åŒ…__init__.pyè¦åœ¨å¤–ç•Œä½¿ç”¨ åŒ… ä¸­çš„æ¨¡å—ï¼Œéœ€è¦åœ¨ init.py ä¸­æŒ‡å®š å¯¹å¤–ç•Œæä¾›çš„æ¨¡å—åˆ—è¡¨123# ä»Ž å½“å‰ç›®å½• å¯¼å…¥ æ¨¡å—åˆ—è¡¨from . import send_messagefrom . import receive_message03. å‘å¸ƒæ¨¡å—ï¼ˆçŸ¥é“ï¼‰å¦‚æžœå¸Œæœ›è‡ªå·±å¼€å‘çš„æ¨¡å—ï¼Œåˆ†äº« ç»™å…¶ä»–äººï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œ3.1 åˆ¶ä½œå‘å¸ƒåŽ‹ç¼©åŒ…æ­¥éª¤1) åˆ›å»º setup.py- setup.py çš„æ–‡ä»¶ 1234567891011from distutils.core import setupsetup(name="hm_message", # åŒ…å version="1.0", # ç‰ˆæœ¬ description="itheima's å‘é€å’ŒæŽ¥æ”¶æ¶ˆæ¯æ¨¡å—", # æè¿°ä¿¡æ¯ long_description="å®Œæ•´çš„å‘é€å’ŒæŽ¥æ”¶æ¶ˆæ¯æ¨¡å—", # å®Œæ•´æè¿°ä¿¡æ¯ author="itheima", # ä½œè€… author_email="itheima@itheima.com", # ä½œè€…é‚®ç®± url="www.itheima.com", # ä¸»é¡µ py_modules=["hm_message.send_message", "hm_message.receive_message"])æœ‰å…³å­—å…¸å‚æ•°çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¯ä»¥å‚é˜…å®˜æ–¹ç½‘ç«™ï¼šhttps://docs.python.org/2/distutils/apiref.html2) æž„å»ºæ¨¡å—1$ python3 setup.py build3) ç”Ÿæˆå‘å¸ƒåŽ‹ç¼©åŒ…1$ python3 setup.py sdistæ³¨æ„ï¼šè¦åˆ¶ä½œå“ªä¸ªç‰ˆæœ¬çš„æ¨¡å—ï¼Œå°±ä½¿ç”¨å“ªä¸ªç‰ˆæœ¬çš„è§£é‡Šå™¨æ‰§è¡Œï¼3.2 å®‰è£…æ¨¡å—12$ tar -zxvf hm_message-1.0.tar.gz $ sudo python3 setup.py installå¸è½½æ¨¡å—ç›´æŽ¥ä»Žå®‰è£…ç›®å½•ä¸‹ï¼ŒæŠŠå®‰è£…æ¨¡å—çš„ ç›®å½• åˆ é™¤å°±å¯ä»¥12$ cd /usr/local/lib/python3.5/dist-packages/$ sudo rm -r hm_message*3.3 pip å®‰è£…ç¬¬ä¸‰æ–¹æ¨¡å—ç¬¬ä¸‰æ–¹æ¨¡å— é€šå¸¸æ˜¯æŒ‡ç”± çŸ¥åçš„ç¬¬ä¸‰æ–¹å›¢é˜Ÿ å¼€å‘çš„ å¹¶ä¸”è¢« ç¨‹åºå‘˜å¹¿æ³›ä½¿ç”¨ çš„ Python åŒ… / æ¨¡å—ä¾‹å¦‚ pygame å°±æ˜¯ä¸€å¥—éžå¸¸æˆç†Ÿçš„ æ¸¸æˆå¼€å‘æ¨¡å—pip æ˜¯ä¸€ä¸ªçŽ°ä»£çš„ï¼Œé€šç”¨çš„ Python åŒ…ç®¡ç†å·¥å…·,æä¾›äº†å¯¹ Python åŒ…çš„æŸ¥æ‰¾ã€ä¸‹è½½ã€å®‰è£…ã€å¸è½½ç­‰åŠŸèƒ½å®‰è£…å’Œå¸è½½å‘½ä»¤å¦‚ä¸‹ï¼š1234567# å°†æ¨¡å—å®‰è£…åˆ° Python 2.x çŽ¯å¢ƒ$ sudo pip install pygame$ sudo pip uninstall pygame# å°†æ¨¡å—å®‰è£…åˆ° Python 3.x çŽ¯å¢ƒ$ sudo pip3 install pygame$ sudo pip3 uninstall pygameåœ¨ Mac ä¸‹å®‰è£… iPython1$ sudo pip install ipythonåœ¨ Linux ä¸‹å®‰è£… iPython12$ sudo apt install ipython$ sudo apt install ipython3]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python_æ‰©å±•çŸ¥è¯†ç‚¹]]></title>
    <url>%2F2019%2F12%2F31%2Fpython_%E6%89%A9%E5%B1%95%E7%9F%A5%E8%AF%86%E7%82%B9%2F</url>
    <content type="text"><![CDATA[GILï¼ˆå…¨å±€è§£é‡Šå™¨é”ï¼‰GILé¢è¯•é¢˜å¦‚ä¸‹æè¿°Python GILçš„æ¦‚å¿µï¼Œ ä»¥åŠå®ƒå¯¹pythonå¤šçº¿ç¨‹çš„å½±å“ï¼Ÿç¼–å†™ä¸€ä¸ªå¤šçº¿ç¨‹æŠ“å–ç½‘é¡µçš„ç¨‹åºï¼Œå¹¶é˜æ˜Žå¤šçº¿ç¨‹æŠ“å–ç¨‹åºæ˜¯å¦å¯æ¯”å•çº¿ç¨‹æ€§èƒ½æœ‰æå‡ï¼Œå¹¶è§£é‡ŠåŽŸå› ã€‚Guidoçš„å£°æ˜Žï¼šhttp://www.artima.com/forums/flat.jsp?forum=106&amp;thread=214235he language doesnâ€™t require the GIL â€“ itâ€™s only the CPython virtual machine that has historically been unable to shed it.å•çº¿ç¨‹æ­»å¾ªçŽ¯å•ç‹¬æ‰§è¡Œè¯¥æ–‡ä»¶ä¼šå æ»¡ä¸€ä¸ªCPUæ ¸å¿ƒæ•°(ç›¸å½“äºŽå•è¿›ç¨‹å•çº¿ç¨‹)ï¼Œä¸¤ä¸ªçª—å£æ‰§è¡Œè¯¥æ–‡ä»¶ä¼šå æ»¡ä¸¤ä¸ªCPUæ ¸å¿ƒæ•°(ç›¸å½“äºŽä¸¤è¿›ç¨‹ä¸¤çº¿ç¨‹)123456#!/usr/bin/env python#-*- coding: utf-8 -*-# ä¸»çº¿ç¨‹æ­»å¾ªçŽ¯ï¼Œå æ»¡CPUwhile True: pass # å ä½ç¬¦ï¼Œç©ºè¯­å¥ï¼Œè¿˜æ˜¯è¦æ‰§è¡Œçš„ä¸¤ä¸ªçº¿ç¨‹æ­»å¾ªçŽ¯å•ç‹¬æ‰§è¡Œè¯¥æ–‡ä»¶æ¯ä¸ªCPUæ ¸å¿ƒä¼šå ä¸€åŠ(å•è¿›ç¨‹ä¸¤çº¿ç¨‹)12345678910111213141516#!/usr/bin/env python#-*- coding: utf-8 -*-from threading import Thread# å­çº¿ç¨‹æ­»å¾ªçŽ¯def a(): while True: passt = Thread(target=a)t.start()# ä¸»çº¿ç¨‹æ­»å¾ªçŽ¯while True: passä¸¤ä¸ªè¿›ç¨‹æ­»å¾ªçŽ¯å•ç‹¬æ‰§è¡Œè¯¥æ–‡ä»¶ä¼šå æ»¡äºŒä¸ªCPUæ ¸å¿ƒæ•°12345678910111213141516#!/usr/bin/env python#-*- coding: utf-8 -*-from multiprocessing import Process# å­è¿›ç¨‹æ­»å¾ªçŽ¯def a(): while True: passif __name__ == '__main__': t = Process(target=a) t.start() # ä¸»è¿›ç¨‹æ­»å¾ªçŽ¯ while True: passæ€»ç»“ï¼šå¤šçº¿ç¨‹å¹¶ä¸æ˜¯çœŸæ­£çš„å¹¶è¡Œï¼Œè€Œæ˜¯ä¼ªå¹¶è¡Œï¼Œä¹Ÿå°±æ˜¯å¹¶å‘ã€‚åŽŸå› å°±æ˜¯å› ä¸ºçº¿ç¨‹æœ‰GILå…¨å±€è§£é‡Šå™¨é”ã€‚åªæœ‰è¿›ç¨‹æ‰æ˜¯çœŸæ­£çš„å¹¶è¡Œå‚è€ƒç­”æ¡ˆPythonè¯­è¨€å’ŒGILæ²¡æœ‰åŠæ¯›é’±å…³ç³»ã€‚ä»…ä»…æ˜¯ç”±äºŽåŽ†å²åŽŸå› åœ¨Cpythonè™šæ‹Ÿæœº(Cè¯­è¨€è§£é‡Šå™¨)ä¸­éš¾ä»¥ç§»é™¤GILã€‚(å…¶ä»–pythonè§£é‡Šå™¨æ²¡æœ‰GILï¼Œæ¯”å¦‚javaè¯­è¨€å†™çš„jpythonè§£é‡Šå™¨)GILï¼šå…¨å±€è§£é‡Šå™¨é”ã€‚æ¯ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œçš„è¿‡ç¨‹éƒ½éœ€è¦å…ˆèŽ·å–GILï¼Œä¿è¯åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥æ‰§è¡Œä»£ç ã€‚çº¿ç¨‹é‡Šæ”¾GILé”çš„æƒ…å†µï¼š åœ¨IOæ“ä½œç­‰å¯èƒ½ä¼šå¼•èµ·é˜»å¡žçš„system callä¹‹å‰,å¯ä»¥æš‚æ—¶é‡Šæ”¾GIL,ä½†åœ¨æ‰§è¡Œå®Œæ¯•åŽ,å¿…é¡»é‡æ–°èŽ·å–GIL Python 3.xä½¿ç”¨è®¡æ—¶å™¨ï¼ˆæ‰§è¡Œæ—¶é—´è¾¾åˆ°é˜ˆå€¼åŽï¼Œå½“å‰çº¿ç¨‹é‡Šæ”¾GILï¼‰æˆ–Python 2.xï¼Œticketsè®¡æ•°è¾¾åˆ°100è®¡ç®—å¯†é›†åž‹ï¼šç¨‹åºæ²¡æœ‰å»¶æ—¶ï¼Œä¸€ç›´åœ¨è®¡ç®—æ•°æ®ï¼›IOå¯†é›†åž‹ï¼šè¾“å…¥è¾“å‡ºï¼Œè¯»å†™æ“ä½œçº¿ç¨‹å’Œåç¨‹é€‚ç”¨äºŽIOå¯†é›†åž‹ï¼Œè®¡ç®—å¯†é›†åž‹è€ƒè™‘ä½¿ç”¨è¿›ç¨‹ã€‚Pythonä½¿ç”¨å¤šè¿›ç¨‹æ˜¯å¯ä»¥åˆ©ç”¨å¤šæ ¸çš„CPUèµ„æºçš„ã€‚å¤šçº¿ç¨‹çˆ¬å–æ¯”å•çº¿ç¨‹æ€§èƒ½æœ‰æå‡ï¼Œå› ä¸ºé‡åˆ°IOé˜»å¡žä¼šè‡ªåŠ¨é‡Šæ”¾GILé”ä½¿ç”¨cè¯­è¨€æ¥è§£å†³GILé—®é¢˜å­çº¿ç¨‹ä½¿ç”¨çš„æ˜¯cè¯­è¨€çš„å‡½æ•°ï¼Œæ­¤æ—¶å•ç‹¬æ‰§è¡Œè¯¥æ–‡ä»¶ï¼Œä¼šå æ»¡ä¸¤ä¸ªCPUæ ¸å¿ƒ123456789101112131415from ctypes import *from threading import Thread# åŠ è½½åŠ¨æ€åº“# æŠŠä¸€ä¸ªCè¯­è¨€ç¼–è¯‘æˆä¸€ä¸ªåŠ¨æ€åº“æ–‡ä»¶çš„å‘½ä»¤(linuxå¹³å°)# gcc libdead_loop.c -shared -o libdead_loop.solib = cdll.LoadLibrary("./libdead_loop.so")# åˆ›å»ºä¸€ä¸ªå­çº¿ç¨‹ï¼Œè®©å…¶æ‰§è¡Œcè¯­è¨€ç¼–å†™çš„å‡½æ•°(DeadLoop)ï¼Œæ­¤å‡½æ•°æ˜¯ä¸€ä¸ªæ­»å¾ªçŽ¯t = Thread(target=lib.DeadLoop)t.start()# ä¸»çº¿ç¨‹while True: passå¦‚ä½•è§£å†³GILæ¢pythonè§£é‡Šå™¨ï¼Œä¸ä½¿ç”¨Cpythonè§£é‡Šå™¨ï¼Œä½¿ç”¨jpythonè§£é‡Šå™¨ç­‰ç”¨å…¶ä»–è¯­è¨€æ¥æ›¿ä»£çº¿ç¨‹ä¸­çš„ä»£ç ï¼Œä¸å¦‚ä¸Šä¾‹ä¸­çš„cè¯­è¨€ï¼Œ(èƒ¶æ°´è¯­è¨€)æ·±æ‹·è´ã€æµ…æ‹·è´1. æµ…æ‹·è´æµ…æ‹·è´æ˜¯å¯¹äºŽä¸€ä¸ªå¯¹è±¡çš„é¡¶å±‚æ‹·è´é€šä¿—çš„ç†è§£æ˜¯ï¼šæ‹·è´äº†å¼•ç”¨ï¼Œå¹¶æ²¡æœ‰æ‹·è´å†…å®¹2. æ·±æ‹·è´æ·±æ‹·è´æ˜¯å¯¹äºŽä¸€ä¸ªå¯¹è±¡æ‰€æœ‰å±‚æ¬¡çš„æ‹·è´(é€’å½’)è¿›ä¸€æ­¥ç†è§£æ·±æ‹·è´3. æ‹·è´çš„å…¶ä»–æ–¹å¼åˆ†ç‰‡è¡¨è¾¾å¼å¯ä»¥èµ‹å€¼ä¸€ä¸ªåºåˆ—å­—å…¸çš„copyæ–¹æ³•å¯ä»¥æ‹·è´ä¸€ä¸ªå­—å…¸4. æ³¨æ„ç‚¹æµ…æ‹·è´å¯¹ä¸å¯å˜ç±»åž‹å’Œå¯å˜ç±»åž‹çš„copyä¸åŒcopy.copyå¯¹äºŽå¯å˜ç±»åž‹ï¼Œä¼šè¿›è¡Œæµ…æ‹·è´copy.copyå¯¹äºŽä¸å¯å˜ç±»åž‹ï¼Œä¸ä¼šæ‹·è´ï¼Œä»…ä»…æ˜¯æŒ‡å‘æ¯”å¦‚ï¼šå¦‚æžœcopy.copyæ‹·è´çš„æ˜¯å…ƒç»„ï¼Œé‚£ä¹ˆå®ƒä¸ä¼šè¿›è¡Œæµ…æ‹·è´ï¼Œä»…ä»…æ˜¯æŒ‡å‘åŽŸå› ï¼šå› ä¸ºå…ƒç»„æ˜¯ä¸å¯å˜ç±»åž‹ï¼Œé‚£ä¹ˆæ„å‘³ç€æ•°æ®ä¸€å®šä¸èƒ½ä¿®æ”¹ï¼Œå› æ­¤ç”¨copy.copyçš„æ—¶å€™å®ƒä¼šè‡ªåŠ¨åˆ¤æ–­ï¼Œå¦‚æžœæ˜¯å…ƒç»„å®ƒå°±æŒ‡å‘äº†å®ƒ123456789101112131415161718In [88]: a = [11,22,33]In [89]: b = copy.copy(a)In [90]: id(a)Out[90]: 59275144In [91]: id(b)Out[91]: 59525600In [92]: a.append(44)In [93]: aOut[93]: [11, 22, 33, 44]In [94]: bOut[94]: [11, 22, 33]In [95]: a = (11,22,33)In [96]: b = copy.copy(a)In [97]: id(a)Out[97]: 58890680In [98]: id(b)Out[98]: 58890680å¦‚æžœç”¨copy.copyæˆ–è€…copy.deepcopyå¯¹ä¸€ä¸ªå…¨éƒ¨éƒ½æ˜¯ä¸å¯å˜ç±»åž‹çš„æ•°æ®è¿›è¡Œæ‹·è´ï¼Œé‚£ä¹ˆä»–ä»¬ç»“æžœç›¸åŒçš„ï¼Œéƒ½æ˜¯å¼•ç”¨æŒ‡å‘å¦‚æžœæ‹·è´çš„æ˜¯ä¸€ä¸ªæ‹¥æœ‰å¯å˜ç±»åž‹çš„æ•°æ®ï¼Œå³ä½¿å…ƒç»„æ˜¯æœ€é¡¶å±‚ï¼Œcopy.deepcopyä¾ç„¶æ˜¯æ·±æ‹·è´ï¼Œè€Œcopy.copyè¿˜æ˜¯æŒ‡å‘ã€‚123456789101112131415161718192021In[37]: a = [11,22]In[38]: b = [33,44]In[39]: c = (a,b)In[40]: import copyIn[41]: d = copy.copy(c)In[42]: id(c)Out[42]: 86387080In[43]: id(d)Out[43]: 86387080In[44]: e = copy.deepcopy(c)In[45]: id(e)Out[45]: 87301192In[46]: cOut[46]: ([11, 22], [33, 44])In[47]: eOut[47]: ([11, 22], [33, 44])In[48]: a.append(55)In[49]: cOut[49]: ([11, 22, 55], [33, 44])In[50]: eOut[50]: ([11, 22], [33, 44])copy.copyå’Œcopy.deepcopyçš„åŒºåˆ«copy.copycopy.deepcopyç§æœ‰åŒ–xx: å…¬æœ‰å˜é‡_x: å•å‰ç½®ä¸‹åˆ’çº¿,ç§æœ‰åŒ–å±žæ€§æˆ–æ–¹æ³•ï¼Œfrom module import * ç¦æ­¢å¯¼å…¥,ç±»å¯¹è±¡å’Œå­ç±»å¯ä»¥è®¿é—®__xxï¼šåŒå‰ç½®ä¸‹åˆ’çº¿,é¿å…ä¸Žå­ç±»ä¸­çš„å±žæ€§å‘½åå†²çªï¼Œæ— æ³•åœ¨å¤–éƒ¨ç›´æŽ¥è®¿é—®(åå­—é‡æ•´æ‰€ä»¥è®¿é—®ä¸åˆ°)__xx__:åŒå‰åŽä¸‹åˆ’çº¿,ç”¨æˆ·åå­—ç©ºé—´çš„é­”æ³•å¯¹è±¡æˆ–å±žæ€§ã€‚ä¾‹å¦‚:__init__ , __ ä¸è¦è‡ªå·±å‘æ˜Žè¿™æ ·çš„åå­—xx_:å•åŽç½®ä¸‹åˆ’çº¿,ç”¨äºŽé¿å…ä¸ŽPythonå…³é”®è¯çš„å†²çªé€šè¿‡name manglingï¼ˆåå­—é‡æ•´(ç›®çš„å°±æ˜¯ä»¥é˜²å­ç±»æ„å¤–é‡å†™åŸºç±»çš„æ–¹æ³•æˆ–è€…å±žæ€§)å¦‚ï¼š_Classobjectï¼‰æœºåˆ¶å°±å¯ä»¥è®¿é—®privateäº†ã€‚(åœ¨ åç§° å‰é¢åŠ ä¸Š _ç±»å =&gt; _ç±»ååç§°)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859#coding=utf-8class Person(object): def __init__(self, name, age, taste): self.name = name self._age = age self.__taste = taste def showperson(self): print(self.name) print(self._age) print(self.__taste) def dowork(self): self._work() self.__away() def _work(self): print('my _work') def __away(self): print('my __away')class Student(Person): def construction(self, name, age, taste): self.name = name self._age = age self.__taste = taste def showstudent(self): print(self.name) print(self._age) print(self.__taste) @staticmethod def testbug(): _Bug.showbug()# æ¨¡å—å†…å¯ä»¥è®¿é—®ï¼Œå½“from cur_module import *æ—¶ï¼Œä¸å¯¼å…¥class _Bug(object): @staticmethod def showbug(): print("showbug")s1 = Student('jack', 25, 'football')s1.showperson()print('*'*20)# æ— æ³•è®¿é—®__taste,å¯¼è‡´æŠ¥é”™# s1.showstudent() s1.construction('rose', 30, 'basketball')s1.showperson()print('*'*20)s1.showstudent()print('*'*20)Student.testbug()æ€»ç»“_åçš„å˜é‡ã€å‡½æ•°ã€ç±»åœ¨ä½¿ç”¨from xxx import *æ—¶éƒ½ä¸ä¼šè¢«å¯¼å…¥ï¼Œç±»å¯¹è±¡å’Œå­ç±»å¯ä»¥è®¿é—®çˆ¶ç±»ä¸­å±žæ€§åä¸º__åå­—çš„ï¼Œå­ç±»ä¸ç»§æ‰¿ï¼Œå­ç±»ä¸èƒ½è®¿é—®ï¼Œå­ç±»å¯ä»¥é€šè¿‡çˆ¶ç±»ä¸­çš„å…¶ä»–æ–¹æ³•é—´æŽ¥è®¿é—®å¦‚æžœåœ¨å­ç±»ä¸­å‘__åå­—èµ‹å€¼ï¼Œé‚£ä¹ˆä¼šåœ¨å­ç±»ä¸­å®šä¹‰ä¸€ä¸ªä¸Žçˆ¶ç±»ç›¸åŒåå­—çš„å±žæ€§importå¯¼å…¥æ¨¡å—1. import æœç´¢è·¯å¾„è·¯å¾„æœç´¢ä»Žä¸Šé¢åˆ—å‡ºçš„ç›®å½•é‡Œä¾æ¬¡æŸ¥æ‰¾è¦å¯¼å…¥çš„æ¨¡å—æ–‡ä»¶å¼€å¤´çš„ç¬¬ä¸€ä¸ªâ€˜â€™ è¡¨ç¤ºå½“å‰è·¯å¾„åˆ—è¡¨ä¸­çš„è·¯å¾„çš„å…ˆåŽé¡ºåºä»£è¡¨äº†pythonè§£é‡Šå™¨åœ¨æœç´¢æ¨¡å—æ—¶çš„å…ˆåŽé¡ºåºç¨‹åºæ‰§è¡Œæ—¶æ·»åŠ æ–°çš„æ¨¡å—è·¯å¾„12345678910111213141516sys.path.append('/home/itcast/xxx')sys.path.insert(0, '/home/itcast/xxx') # å¯ä»¥ç¡®ä¿å…ˆæœç´¢è¿™ä¸ªè·¯å¾„In [37]: sys.path.insert(0,"/home/python/xxxx")In [38]: sys.pathOut[38]: ['/home/python/xxxx', '', '/usr/bin', '/usr/lib/python35.zip', '/usr/lib/python3.5', '/usr/lib/python3.5/plat-x86_64-linux-gnu', '/usr/lib/python3.5/lib-dynload', '/usr/local/lib/python3.5/dist-packages', '/usr/lib/python3/dist-packages', '/usr/lib/python3/dist-packages/IPython/extensions', '/home/python/.ipython']2. é‡æ–°å¯¼å…¥æ¨¡å—æ¨¡å—è¢«å¯¼å…¥åŽï¼Œimport moduleä¸èƒ½é‡æ–°å¯¼å…¥æ¨¡å—ï¼Œé‡æ–°å¯¼å…¥éœ€ç”¨reload3. å¤šæ¨¡å—å¼€å‘æ—¶çš„æ³¨æ„ç‚¹12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273recv_msg.pyæ¨¡å—from common import RECV_DATA_LIST# from common import HANDLE_FLAGimport commondef recv_msg(): &quot;&quot;&quot;æ¨¡æ‹ŸæŽ¥æ”¶åˆ°æ•°æ®ï¼Œç„¶åŽæ·»åŠ åˆ°commonæ¨¡å—ä¸­çš„åˆ—è¡¨ä¸­&quot;&quot;&quot; print(&quot;---&gt;recv_msg&quot;) for i in range(5): RECV_DATA_LIST.append(i)def test_recv_data(): &quot;&quot;&quot;æµ‹è¯•æŽ¥æ”¶åˆ°çš„æ•°æ®&quot;&quot;&quot; print(&quot;---&gt;test_recv_data&quot;) print(RECV_DATA_LIST)def recv_msg_next(): &quot;&quot;&quot;å·²ç»å¤„ç†å®ŒæˆåŽï¼Œå†æŽ¥æ”¶å¦å¤–çš„å…¶ä»–æ•°æ®&quot;&quot;&quot; print(&quot;---&gt;recv_msg_next&quot;) # if HANDLE_FLAG: if common.HANDLE_FLAG: print(&quot;------å‘çŽ°ä¹‹å‰çš„æ•°æ®å·²ç»å¤„ç†å®Œæˆï¼Œè¿™é‡Œè¿›è¡ŒæŽ¥æ”¶å…¶ä»–çš„æ•°æ®(æ¨¡æ‹Ÿè¿‡ç¨‹...)----&quot;) else: print(&quot;------å‘çŽ°ä¹‹å‰çš„æ•°æ®æœªå¤„ç†å®Œï¼Œç­‰å¾…ä¸­....------&quot;)handle_msg.pyæ¨¡å—from common import RECV_DATA_LIST# from common import HANDLE_FLAGimport commondef handle_data(): &quot;&quot;&quot;æ¨¡æ‹Ÿå¤„ç†recv_msgæ¨¡å—æŽ¥æ”¶çš„æ•°æ®&quot;&quot;&quot; print(&quot;---&gt;handle_data&quot;) for i in RECV_DATA_LIST: print(i) # æ—¢ç„¶å¤„ç†å®Œæˆäº†ï¼Œé‚£ä¹ˆå°†å˜é‡HANDLE_FLAGè®¾ç½®ä¸ºTrueï¼Œæ„å‘³ç€å¤„ç†å®Œæˆ # global HANDLE_FLAG # HANDLE_FLAG = True common.HANDLE_FLAG = Truedef test_handle_data(): &quot;&quot;&quot;æµ‹è¯•å¤„ç†æ˜¯å¦å®Œæˆï¼Œå˜é‡æ˜¯å¦è®¾ç½®ä¸ºTrue&quot;&quot;&quot; print(&quot;---&gt;test_handle_data&quot;) # if HANDLE_FLAG: if common.HANDLE_FLAG: print(&quot;=====å·²ç»å¤„ç†å®Œæˆ====&quot;) else: print(&quot;=====æœªå¤„ç†å®Œæˆ====&quot;)main.pyæ¨¡å—from recv_msg import *from handle_msg import *def main(): # 1. æŽ¥æ”¶æ•°æ® recv_msg() # 2. æµ‹è¯•æ˜¯å¦æŽ¥æ”¶å®Œæ¯• test_recv_data() # 3. åˆ¤æ–­å¦‚æžœå¤„ç†å®Œæˆï¼Œåˆ™æŽ¥æ”¶å…¶å®ƒæ•°æ® recv_msg_next() # 4. å¤„ç†æ•°æ® handle_data() # 5. æµ‹è¯•æ˜¯å¦å¤„ç†å®Œæ¯• test_handle_data() # 6. åˆ¤æ–­å¦‚æžœå¤„ç†å®Œæˆï¼Œåˆ™æŽ¥æ”¶å…¶å®ƒæ•°æ® recv_msg_next()if __name__ == &quot;__main__&quot;: main()å†è®® å°è£…ã€ç»§æ‰¿ã€å¤šæ€å°è£…ã€ç»§æ‰¿ã€å¤šæ€ æ˜¯é¢å‘å¯¹è±¡çš„3å¤§ç‰¹æ€§ä¸ºå•¥è¦å°è£…å¥½å¤„åœ¨ä½¿ç”¨é¢å‘è¿‡ç¨‹ç¼–ç¨‹æ—¶ï¼Œå½“éœ€è¦å¯¹æ•°æ®å¤„ç†æ—¶ï¼Œéœ€è¦è€ƒè™‘ç”¨å“ªä¸ªæ¨¡æ¿ä¸­å“ªä¸ªå‡½æ•°æ¥è¿›è¡Œæ“ä½œï¼Œä½†æ˜¯å½“ç”¨é¢å‘å¯¹è±¡ç¼–ç¨‹æ—¶ï¼Œå› ä¸ºå·²ç»å°†æ•°æ®å­˜å‚¨åˆ°äº†è¿™ä¸ªç‹¬ç«‹çš„ç©ºé—´ä¸­ï¼Œè¿™ä¸ªç‹¬ç«‹çš„ç©ºé—´ï¼ˆå³å¯¹è±¡ï¼‰ä¸­é€šè¿‡ä¸€ä¸ªç‰¹æ®Šçš„å˜é‡ï¼ˆclassï¼‰èƒ½å¤ŸèŽ·å–åˆ°ç±»ï¼ˆæ¨¡æ¿ï¼‰ï¼Œè€Œä¸”è¿™ä¸ªç±»ä¸­çš„æ–¹æ³•æ˜¯æœ‰ä¸€å®šæ•°é‡çš„ï¼Œä¸Žæ­¤ç±»æ— å…³çš„å°†ä¸ä¼šå‡ºçŽ°åœ¨æœ¬ç±»ä¸­ï¼Œå› æ­¤éœ€è¦å¯¹æ•°æ®å¤„ç†æ—¶ï¼Œå¯ä»¥å¾ˆå¿«é€Ÿçš„å®šä½åˆ°éœ€è¦çš„æ–¹æ³•æ˜¯è° è¿™æ ·æ›´æ–¹ä¾¿å…¨å±€å˜é‡æ˜¯åªèƒ½æœ‰1ä»½çš„ï¼Œå¤šå¾ˆå¤šä¸ªå‡½æ•°éœ€è¦å¤šä¸ªå¤‡ä»½æ—¶ï¼Œå¾€å¾€éœ€è¦åˆ©ç”¨å…¶å®ƒçš„å˜é‡æ¥è¿›è¡Œå‚¨å­˜ï¼›è€Œé€šè¿‡å°è£… ä¼šå°†ç”¨æ¥å­˜å‚¨æ•°æ®çš„è¿™ä¸ªå˜é‡ å˜ä¸ºäº†å¯¹è±¡ä¸­çš„ä¸€ä¸ªâ€œå…¨å±€â€å˜é‡ï¼Œåªè¦å¯¹è±¡ä¸ä¸€æ ·é‚£ä¹ˆè¿™ä¸ªå˜é‡å°±å¯ä»¥å†æœ‰1ä»½ï¼Œæ‰€ä»¥è¿™æ ·æ›´æ–¹ä¾¿ä»£ç åˆ’åˆ†æ›´æ¸…æ™°é¢å‘è¿‡ç¨‹1234567891011121314151617181920212223å…¨å±€å˜é‡1å…¨å±€å˜é‡2å…¨å±€å˜é‡3...def å‡½æ•°1(): passdef å‡½æ•°2(): passdef å‡½æ•°3(): passdef å‡½æ•°4(): passdef å‡½æ•°5(): passé¢å‘å¯¹è±¡1234567891011121314151617181920class ç±»(object): å±žæ€§1 å±žæ€§2 def æ–¹æ³•1(self): pass def æ–¹æ³•2(self): passclass ç±»2(object): å±žæ€§3 def æ–¹æ³•3(self): pass def æ–¹æ³•4(self): pass def æ–¹æ³•5(self): passä¸ºå•¥è¦ç»§æ‰¿è¯´æ˜Žèƒ½å¤Ÿæå‡ä»£ç çš„é‡ç”¨çŽ‡ï¼Œå³å¼€å‘ä¸€ä¸ªç±»ï¼Œå¯ä»¥åœ¨å¤šä¸ªå­åŠŸèƒ½ä¸­ç›´æŽ¥ä½¿ç”¨ç»§æ‰¿èƒ½å¤Ÿæœ‰æ•ˆçš„è¿›è¡Œä»£ç çš„ç®¡ç†ï¼Œå½“æŸä¸ªç±»æœ‰é—®é¢˜åªè¦ä¿®æ”¹è¿™ä¸ªç±»å°±è¡Œï¼Œè€Œå…¶ç»§æ‰¿è¿™ä¸ªç±»çš„å­ç±»å¾€å¾€ä¸éœ€è¦å°±ä¿®æ”¹æ€Žæ ·ç†è§£å¤šæ€12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152class MiniOS(object): """MiniOS æ“ä½œç³»ç»Ÿç±» """ def __init__(self, name): self.name = name self.apps = [] # å®‰è£…çš„åº”ç”¨ç¨‹åºåç§°åˆ—è¡¨ def __str__(self): return "%s å®‰è£…çš„è½¯ä»¶åˆ—è¡¨ä¸º %s" % (self.name, str(self.apps)) def install_app(self, app): # åˆ¤æ–­æ˜¯å¦å·²ç»å®‰è£…äº†è½¯ä»¶ if app.name in self.apps: print("å·²ç»å®‰è£…äº† %sï¼Œæ— éœ€å†æ¬¡å®‰è£…" % app.name) else: app.install() self.apps.append(app.name)class App(object): def __init__(self, name, version, desc): self.name = name self.version = version self.desc = desc def __str__(self): return "%s çš„å½“å‰ç‰ˆæœ¬æ˜¯ %s - %s" % (self.name, self.version, self.desc) def install(self): print("å°† %s [%s] çš„æ‰§è¡Œç¨‹åºå¤åˆ¶åˆ°ç¨‹åºç›®å½•..." % (self.name, self.version))class PyCharm(App): passclass Chrome(App): def install(self): print("æ­£åœ¨è§£åŽ‹ç¼©å®‰è£…ç¨‹åº...") super().install()linux = MiniOS("Linux")print(linux)pycharm = PyCharm("PyCharm", "1.0", "python å¼€å‘çš„ IDE çŽ¯å¢ƒ")chrome = Chrome("Chrome", "2.0", "è°·æ­Œæµè§ˆå™¨")linux.install_app(pycharm)linux.install_app(chrome)linux.install_app(chrome)print(linux)è¿è¡Œç»“æžœ123456Linux å®‰è£…çš„è½¯ä»¶åˆ—è¡¨ä¸º []å°† PyCharm [1.0] çš„æ‰§è¡Œç¨‹åºå¤åˆ¶åˆ°ç¨‹åºç›®å½•...æ­£åœ¨è§£åŽ‹ç¼©å®‰è£…ç¨‹åº...å°† Chrome [2.0] çš„æ‰§è¡Œç¨‹åºå¤åˆ¶åˆ°ç¨‹åºç›®å½•...å·²ç»å®‰è£…äº† Chromeï¼Œæ— éœ€å†æ¬¡å®‰è£…Linux å®‰è£…çš„è½¯ä»¶åˆ—è¡¨ä¸º [&apos;PyCharm&apos;, &apos;Chrome&apos;]å¤šç»§æ‰¿ä»¥åŠMROé¡ºåº1. å•ç‹¬è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•çˆ¶ç±»è¢«è°ƒç”¨å¤šæ¬¡123456789101112131415161718192021222324252627282930313233343536# coding=utf-8print("******å¤šç»§æ‰¿ä½¿ç”¨ç±»å.__init__ å‘ç”Ÿçš„çŠ¶æ€******")class Parent(object): def __init__(self, name): print('parentçš„initå¼€å§‹è¢«è°ƒç”¨') self.name = name print('parentçš„initç»“æŸè¢«è°ƒç”¨')class Son1(Parent): def __init__(self, name, age): print('Son1çš„initå¼€å§‹è¢«è°ƒç”¨') self.age = age Parent.__init__(self, name) print('Son1çš„initç»“æŸè¢«è°ƒç”¨')class Son2(Parent): def __init__(self, name, gender): print('Son2çš„initå¼€å§‹è¢«è°ƒç”¨') self.gender = gender Parent.__init__(self, name) print('Son2çš„initç»“æŸè¢«è°ƒç”¨')class Grandson(Son1, Son2): def __init__(self, name, age, gender): print('Grandsonçš„initå¼€å§‹è¢«è°ƒç”¨') Son1.__init__(self, name, age) # å•ç‹¬è°ƒç”¨çˆ¶ç±»çš„åˆå§‹åŒ–æ–¹æ³• Son2.__init__(self, name, gender) print('Grandsonçš„initç»“æŸè¢«è°ƒç”¨')gs = Grandson('grandson', 12, 'ç”·')print('å§“åï¼š', gs.name)print('å¹´é¾„ï¼š', gs.age)print('æ€§åˆ«ï¼š', gs.gender)print("******å¤šç»§æ‰¿ä½¿ç”¨ç±»å.__init__ å‘ç”Ÿçš„çŠ¶æ€******\n\n")è¿è¡Œç»“æžœ:123456789101112131415******å¤šç»§æ‰¿ä½¿ç”¨ç±»å.__init__ å‘ç”Ÿçš„çŠ¶æ€******Grandsonçš„initå¼€å§‹è¢«è°ƒç”¨Son1çš„initå¼€å§‹è¢«è°ƒç”¨parentçš„initå¼€å§‹è¢«è°ƒç”¨parentçš„initç»“æŸè¢«è°ƒç”¨Son1çš„initç»“æŸè¢«è°ƒç”¨Son2çš„initå¼€å§‹è¢«è°ƒç”¨parentçš„initå¼€å§‹è¢«è°ƒç”¨parentçš„initç»“æŸè¢«è°ƒç”¨Son2çš„initç»“æŸè¢«è°ƒç”¨Grandsonçš„initç»“æŸè¢«è°ƒç”¨å§“åï¼š grandsonå¹´é¾„ï¼š 12æ€§åˆ«ï¼š ç”·******å¤šç»§æ‰¿ä½¿ç”¨ç±»å.__init__ å‘ç”Ÿçš„çŠ¶æ€******2. å¤šç»§æ‰¿ä¸­superè°ƒç”¨æœ‰æ‰€çˆ¶ç±»çš„è¢«é‡å†™çš„æ–¹æ³•ä½¿ç”¨superæ–¹æ³•çˆ¶ç±»è¢«è°ƒç”¨ä¸€æ¬¡123456789101112131415161718192021222324252627282930313233343536373839404142434445print("******å¤šç»§æ‰¿ä½¿ç”¨super().__init__ å‘ç”Ÿçš„çŠ¶æ€******")class Parent(object): def __init__(self, name, *args, **kwargs): # ä¸ºé¿å…å¤šç»§æ‰¿æŠ¥é”™ï¼Œä½¿ç”¨ä¸å®šé•¿å‚æ•°ï¼ŒæŽ¥å—å‚æ•° print('parentçš„initå¼€å§‹è¢«è°ƒç”¨') self.name = name print('parentçš„initç»“æŸè¢«è°ƒç”¨')class Son1(Parent): def __init__(self, name, age, *args, **kwargs): # ä¸ºé¿å…å¤šç»§æ‰¿æŠ¥é”™ï¼Œä½¿ç”¨ä¸å®šé•¿å‚æ•°ï¼ŒæŽ¥å—å‚æ•° print('Son1çš„initå¼€å§‹è¢«è°ƒç”¨') self.age = age super().__init__(name, *args, **kwargs) # ä¸ºé¿å…å¤šç»§æ‰¿æŠ¥é”™ï¼Œä½¿ç”¨ä¸å®šé•¿å‚æ•°ï¼ŒæŽ¥å—å‚æ•° print('Son1çš„initç»“æŸè¢«è°ƒç”¨')class Son2(Parent): def __init__(self, name, gender, *args, **kwargs): # ä¸ºé¿å…å¤šç»§æ‰¿æŠ¥é”™ï¼Œä½¿ç”¨ä¸å®šé•¿å‚æ•°ï¼ŒæŽ¥å—å‚æ•° print('Son2çš„initå¼€å§‹è¢«è°ƒç”¨') self.gender = gender super().__init__(name, *args, **kwargs) # ä¸ºé¿å…å¤šç»§æ‰¿æŠ¥é”™ï¼Œä½¿ç”¨ä¸å®šé•¿å‚æ•°ï¼ŒæŽ¥å—å‚æ•° print('Son2çš„initç»“æŸè¢«è°ƒç”¨')class Grandson(Son1, Son2): def __init__(self, name, age, gender): print('Grandsonçš„initå¼€å§‹è¢«è°ƒç”¨') # å¤šç»§æ‰¿æ—¶ï¼Œç›¸å¯¹äºŽä½¿ç”¨ç±»å.__init__æ–¹æ³•ï¼Œè¦æŠŠæ¯ä¸ªçˆ¶ç±»å…¨éƒ¨å†™ä¸€é # è€Œsuperåªç”¨ä¸€å¥è¯ï¼Œæ‰§è¡Œäº†å…¨éƒ¨çˆ¶ç±»çš„æ–¹æ³•ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä½•å¤šç»§æ‰¿éœ€è¦å…¨éƒ¨ä¼ å‚çš„ä¸€ä¸ªåŽŸå›  # super(Grandson, self).__init__(name, age, gender) super().__init__(name, age, gender) print('Grandsonçš„initç»“æŸè¢«è°ƒç”¨')"""# ä»¥ä¸‹ä¸¤ç§å†™æ³•ç»“æžœæ˜¯ä¸€æ ·çš„super(Grandson, self).__init__(name, age, gender) # è°ƒç”¨æŒ‡å®šç±»çš„ä¸‹ä¸€ä¸ªç±»super().__init__(name, age, gender) # ä¸æŒ‡å®šç±»çš„è¯åˆ™é»˜è®¤æ˜¯å½“å‰ä½¿ç”¨çš„ç±»çš„ä¸‹ä¸€ä¸ªç±»# æŒ‡å®šç±»çš„è°ƒç”¨super(Son2, self).__init__(name, age, gender) # æŒ‡å®šSon1ç±»çš„ä¸‹ä¸€ä¸ªç±»è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯Son2ç±»""" print(Grandson.__mro__) # è¾“å‡ºä¸€ä¸ªå…ƒç»„ï¼Œçˆ¶ç±»è°ƒç”¨çš„é¡ºåº # pythonè§£é‡Šå™¨çš„C3ç®—æ³•è®¡ç®—å‡ºæ¥çš„ç»“æžœgs = Grandson('grandson', 12, 'ç”·')print('å§“åï¼š', gs.name)print('å¹´é¾„ï¼š', gs.age)print('æ€§åˆ«ï¼š', gs.gender)print("******å¤šç»§æ‰¿ä½¿ç”¨super().__init__ å‘ç”Ÿçš„çŠ¶æ€******\n\n")è¿è¡Œç»“æžœï¼š1234567891011121314******å¤šç»§æ‰¿ä½¿ç”¨super().__init__ å‘ç”Ÿçš„çŠ¶æ€******(&lt;class '__main__.Grandson'&gt;, &lt;class '__main__.Son1'&gt;, &lt;class '__main__.Son2'&gt;, &lt;class '__main__.Parent'&gt;, &lt;class 'object'&gt;)Grandsonçš„initå¼€å§‹è¢«è°ƒç”¨Son1çš„initå¼€å§‹è¢«è°ƒç”¨Son2çš„initå¼€å§‹è¢«è°ƒç”¨parentçš„initå¼€å§‹è¢«è°ƒç”¨parentçš„initç»“æŸè¢«è°ƒç”¨Son2çš„initç»“æŸè¢«è°ƒç”¨Son1çš„initç»“æŸè¢«è°ƒç”¨Grandsonçš„initç»“æŸè¢«è°ƒç”¨å§“åï¼š grandsonå¹´é¾„ï¼š 12æ€§åˆ«ï¼š ç”·******å¤šç»§æ‰¿ä½¿ç”¨super().__init__ å‘ç”Ÿçš„çŠ¶æ€******æ³¨æ„ï¼šä»¥ä¸Š2ä¸ªä»£ç æ‰§è¡Œçš„ç»“æžœä¸åŒå¦‚æžœ2ä¸ªå­ç±»ä¸­éƒ½ç»§æ‰¿äº†çˆ¶ç±»ï¼Œå½“åœ¨å­ç±»ä¸­é€šè¿‡çˆ¶ç±»åè°ƒç”¨æ—¶ï¼Œparentè¢«æ‰§è¡Œäº†2æ¬¡å¦‚æžœ2ä¸ªå­ç±»ä¸­éƒ½ç»§æ‰¿äº†çˆ¶ç±»ï¼Œå½“åœ¨å­ç±»ä¸­é€šè¿‡superè°ƒç”¨æ—¶ï¼Œparentè¢«æ‰§è¡Œäº†1æ¬¡3. å•ç»§æ‰¿ä¸­super123456789101112131415161718192021222324252627print("******å•ç»§æ‰¿ä½¿ç”¨super().__init__ å‘ç”Ÿçš„çŠ¶æ€******")class Parent(object): def __init__(self, name): print('parentçš„initå¼€å§‹è¢«è°ƒç”¨') self.name = name print('parentçš„initç»“æŸè¢«è°ƒç”¨')class Son1(Parent): def __init__(self, name, age): print('Son1çš„initå¼€å§‹è¢«è°ƒç”¨') self.age = age super().__init__(name) # å•ç»§æ‰¿ä¸èƒ½æä¾›å…¨éƒ¨å‚æ•° print('Son1çš„initç»“æŸè¢«è°ƒç”¨')class Grandson(Son1): def __init__(self, name, age, gender): print('Grandsonçš„initå¼€å§‹è¢«è°ƒç”¨') super().__init__(name, age) # å•ç»§æ‰¿ä¸èƒ½æä¾›å…¨éƒ¨å‚æ•° print('Grandsonçš„initç»“æŸè¢«è°ƒç”¨')print(Grandson.__mro__)gs = Grandson('grandson', 12, 'ç”·')print('å§“åï¼š', gs.name)print('å¹´é¾„ï¼š', gs.age)#print('æ€§åˆ«ï¼š', gs.gender)print("******å•ç»§æ‰¿ä½¿ç”¨super().__init__ å‘ç”Ÿçš„çŠ¶æ€******\n\n")è¿è¡Œç»“æžœï¼š1234567891011******å•ç»§æ‰¿ä½¿ç”¨super().__init__ å‘ç”Ÿçš„çŠ¶æ€******(&lt;class '__main__.Grandson'&gt;, &lt;class '__main__.Son1'&gt;, &lt;class '__main__.Parent'&gt;, &lt;class 'object'&gt;)Grandsonçš„initå¼€å§‹è¢«è°ƒç”¨Son1çš„initå¼€å§‹è¢«è°ƒç”¨parentçš„initå¼€å§‹è¢«è°ƒç”¨parentçš„initç»“æŸè¢«è°ƒç”¨Son1çš„initç»“æŸè¢«è°ƒç”¨Grandsonçš„initç»“æŸè¢«è°ƒç”¨å§“åï¼š grandsonå¹´é¾„ï¼š 12******å•ç»§æ‰¿ä½¿ç”¨super().__init__ å‘ç”Ÿçš„çŠ¶æ€******æ€»ç»“super().initç›¸å¯¹äºŽç±»å.initï¼Œåœ¨å•ç»§æ‰¿ä¸Šç”¨æ³•åŸºæœ¬æ— å·®ä½†åœ¨å¤šç»§æ‰¿ä¸Šæœ‰åŒºåˆ«ï¼Œsuperæ–¹æ³•èƒ½ä¿è¯æ¯ä¸ªçˆ¶ç±»çš„æ–¹æ³•åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œè€Œä½¿ç”¨ç±»åçš„æ–¹æ³•ä¼šå¯¼è‡´æ–¹æ³•è¢«æ‰§è¡Œå¤šæ¬¡ï¼Œå…·ä½“çœ‹å‰é¢çš„è¾“å‡ºç»“æžœå¤šç»§æ‰¿æ—¶ï¼Œä½¿ç”¨superæ–¹æ³•ï¼Œå¯¹çˆ¶ç±»çš„ä¼ å‚æ•°ï¼Œåº”è¯¥æ˜¯ç”±äºŽpythonä¸­superçš„ç®—æ³•å¯¼è‡´çš„åŽŸå› ï¼Œå¿…é¡»æŠŠå‚æ•°å…¨éƒ¨ä¼ é€’ï¼Œå¦åˆ™ä¼šæŠ¥é”™å•ç»§æ‰¿æ—¶ï¼Œä½¿ç”¨superæ–¹æ³•ï¼Œåˆ™ä¸èƒ½å…¨éƒ¨ä¼ é€’ï¼Œåªèƒ½ä¼ çˆ¶ç±»æ–¹æ³•æ‰€éœ€çš„å‚æ•°ï¼Œå¦åˆ™ä¼šæŠ¥é”™å¤šç»§æ‰¿æ—¶ï¼Œç›¸å¯¹äºŽä½¿ç”¨ç±»å.initæ–¹æ³•ï¼Œè¦æŠŠæ¯ä¸ªçˆ¶ç±»å…¨éƒ¨å†™ä¸€é, è€Œä½¿ç”¨superæ–¹æ³•ï¼Œåªéœ€å†™ä¸€å¥è¯ä¾¿æ‰§è¡Œäº†å…¨éƒ¨çˆ¶ç±»çš„æ–¹æ³•ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä½•å¤šç»§æ‰¿éœ€è¦å…¨éƒ¨ä¼ å‚çš„ä¸€ä¸ªåŽŸå› å°è¯•ç‰›åˆ€(ä»¥ä¸‹ä¸ºé¢è¯•é¢˜)ä»¥ä¸‹çš„ä»£ç çš„è¾“å‡ºå°†æ˜¯ä»€ä¹ˆ? è¯´å‡ºä½ çš„ç­”æ¡ˆå¹¶è§£é‡Šã€‚1234567891011121314class Parent(object): x = 1class Child1(Parent): passclass Child2(Parent): passprint(Parent.x, Child1.x, Child2.x)Child1.x = 2print(Parent.x, Child1.x, Child2.x)Parent.x = 3print(Parent.x, Child1.x, Child2.x)ç­”æ¡ˆ, ä»¥ä¸Šä»£ç çš„è¾“å‡ºæ˜¯ï¼š1231 1 11 2 13 2 3ä½¿ä½ å›°æƒ‘æˆ–æ˜¯æƒŠå¥‡çš„æ˜¯å…³äºŽæœ€åŽä¸€è¡Œçš„è¾“å‡ºæ˜¯ 3 2 3 è€Œä¸æ˜¯ 3 2 1ã€‚ä¸ºä»€ä¹ˆæ”¹å˜äº† Parent.x çš„å€¼è¿˜ä¼šæ”¹å˜ Child2.x çš„å€¼ï¼Œä½†æ˜¯åŒæ—¶ Child1.x å€¼å´æ²¡æœ‰æ”¹å˜ï¼Ÿè¿™ä¸ªç­”æ¡ˆçš„å…³é”®æ˜¯ï¼Œåœ¨ Python ä¸­ï¼Œç±»å˜é‡åœ¨å†…éƒ¨æ˜¯ä½œä¸ºå­—å…¸å¤„ç†çš„ã€‚å¦‚æžœä¸€ä¸ªå˜é‡çš„åå­—æ²¡æœ‰åœ¨å½“å‰ç±»çš„å­—å…¸ä¸­å‘çŽ°ï¼Œå°†æœç´¢ç¥–å…ˆç±»ï¼ˆæ¯”å¦‚çˆ¶ç±»ï¼‰ç›´åˆ°è¢«å¼•ç”¨çš„å˜é‡åè¢«æ‰¾åˆ°ï¼ˆå¦‚æžœè¿™ä¸ªè¢«å¼•ç”¨çš„å˜é‡åæ—¢æ²¡æœ‰åœ¨è‡ªå·±æ‰€åœ¨çš„ç±»åˆæ²¡æœ‰åœ¨ç¥–å…ˆç±»ä¸­æ‰¾åˆ°ï¼Œä¼šå¼•å‘ä¸€ä¸ª AttributeError å¼‚å¸¸ ï¼‰ã€‚å› æ­¤ï¼Œåœ¨çˆ¶ç±»ä¸­è®¾ç½® x = 1 ä¼šä½¿å¾—ç±»å˜é‡ x åœ¨å¼•ç”¨è¯¥ç±»å’Œå…¶ä»»ä½•å­ç±»ä¸­çš„å€¼ä¸º 1ã€‚è¿™å°±æ˜¯å› ä¸ºç¬¬ä¸€ä¸ª print è¯­å¥çš„è¾“å‡ºæ˜¯ 1 1 1ã€‚éšåŽï¼Œå¦‚æžœä»»ä½•å®ƒçš„å­ç±»é‡å†™äº†è¯¥å€¼ï¼ˆä¾‹å¦‚ï¼Œæˆ‘ä»¬æ‰§è¡Œè¯­å¥ Child1.x = 2ï¼‰ï¼Œç„¶åŽï¼Œè¯¥å€¼ä»…ä»…åœ¨å­ç±»ä¸­è¢«æ”¹å˜ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆç¬¬äºŒä¸ª print è¯­å¥çš„è¾“å‡ºæ˜¯ 1 2 1ã€‚æœ€åŽï¼Œå¦‚æžœè¯¥å€¼åœ¨çˆ¶ç±»ä¸­è¢«æ”¹å˜ï¼ˆä¾‹å¦‚ï¼Œæˆ‘ä»¬æ‰§è¡Œè¯­å¥ Parent.x = 3ï¼‰ï¼Œè¿™ä¸ªæ”¹å˜ä¼šå½±å“åˆ°ä»»ä½•æœªé‡å†™è¯¥å€¼çš„å­ç±»å½“ä¸­çš„å€¼ï¼ˆåœ¨è¿™ä¸ªç¤ºä¾‹ä¸­è¢«å½±å“çš„å­ç±»æ˜¯ Child2ï¼‰ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆç¬¬ä¸‰ä¸ª print è¾“å‡ºæ˜¯ 3 2 3ã€‚è‡ªå·±çš„æƒ³æ³•ï¼ŒæŒ‰é¡ºåºè§£æžprint(Parent.x, Child1.x, Child2.x)ï¼Œå…¶ä¸­Parent.xæ˜¯è°ƒç”¨Parentç±»ä¸­çš„xå±žæ€§ï¼Œè¾“å‡ºç»“æžœæ˜¯1ï¼›Child1.xæ˜¯è¾“å‡ºChild1ç±»ä¸­çš„xå±žæ€§ï¼Œæœ¬ç±»æ²¡æœ‰çš„è¯åˆ™åˆ°çˆ¶ç±»ä¸­æŸ¥æ‰¾ï¼Œçˆ¶ç±»Parentä¸­æœ‰ï¼Œåˆ™è¾“å‡ºç»“æžœæ˜¯1ï¼›Child2.xåŒç†ã€‚Child1.x = 2ç›¸å½“äºŽç»™Child1ç±»æ·»åŠ ä¸€ä¸ªç±»å±žæ€§ã€‚print(Parent.x, Child1.x, Child2.x)ï¼Œå…¶ä¸­Parent.xæ˜¯è°ƒç”¨Parentç±»ä¸­çš„xå±žæ€§ï¼Œè¾“å‡ºç»“æžœæ˜¯1ï¼›Child1.xæ˜¯è¾“å‡ºChild1ç±»ä¸­çš„xå±žæ€§ï¼Œæœ¬ç±»ä¸­æœ‰è¿™ä¸ªå±žæ€§åˆ™ç›´æŽ¥è¾“å‡ºï¼Œä¸ç”¨åˆ°çˆ¶ç±»ä¸­æŸ¥æ‰¾ï¼Œè¾“å‡ºçš„ç»“æžœæ˜¯2ï¼›Child2.xè¿˜æ˜¯ä»Žçˆ¶ç±»ä¸­æŸ¥æ‰¾ï¼Œè¾“å‡ºç»“æžœæ˜¯1ã€‚Parent.x = 3ç›¸å½“äºŽä¿®æ”¹çˆ¶ç±»Parentä¸­xç±»å±žæ€§çš„å€¼ã€‚print(Parent.x, Child1.x, Child2.x)ï¼Œå…¶ä¸­Parent.xæ˜¯è°ƒç”¨Parentç±»ä¸­çš„xå±žæ€§ï¼Œè¾“å‡ºç»“æžœæ˜¯3ï¼›Child1.xæ˜¯è¾“å‡ºChild1ç±»ä¸­çš„xå±žæ€§ï¼Œæœ¬ç±»ä¸­æœ‰è¿™ä¸ªå±žæ€§åˆ™ç›´æŽ¥è¾“å‡ºï¼Œä¸ç”¨åˆ°çˆ¶ç±»ä¸­æŸ¥æ‰¾ï¼Œè¾“å‡ºçš„ç»“æžœæ˜¯2ï¼›Child2.xè¿˜æ˜¯ä»Žçˆ¶ç±»ä¸­æŸ¥æ‰¾ï¼Œè¾“å‡ºç»“æžœæ˜¯3ã€‚å†è®ºé™æ€æ–¹æ³•å’Œç±»æ–¹æ³•1. ç±»å±žæ€§ã€å®žä¾‹å±žæ€§å®ƒä»¬åœ¨å®šä¹‰å’Œä½¿ç”¨ä¸­æœ‰æ‰€åŒºåˆ«ï¼Œè€Œæœ€æœ¬è´¨çš„åŒºåˆ«æ˜¯å†…å­˜ä¸­ä¿å­˜çš„ä½ç½®ä¸åŒï¼Œå®žä¾‹å±žæ€§å±žäºŽå¯¹è±¡ç±»å±žæ€§å±žäºŽç±»12345678910111213141516171819202122class Province(object): # ç±»å±žæ€§ country = 'ä¸­å›½' def __init__(self, name): # å®žä¾‹å±žæ€§ self.name = name# åˆ›å»ºä¸€ä¸ªå®žä¾‹å¯¹è±¡obj = Province('å±±ä¸œçœ')# ç›´æŽ¥è®¿é—®å®žä¾‹å±žæ€§print(obj.name)# ç›´æŽ¥è®¿é—®ç±»å±žæ€§Province.country# é€šè¿‡å®žä¾‹å¯¹è±¡è®¿é—®ç±»å±žæ€§ obj.__class__.country# Province('å±±ä¸œçœ')åšå¦‚ä¸‹ä¸¤ä»¶äº‹æƒ…ï¼š# 1. è°ƒç”¨__new__æ–¹æ³•ï¼Œåˆ›å»ºå¯¹è±¡ï¼Œé€šä¿—ç‚¹è¯´æ˜¯åˆ›å»ºä¸€ä¸ªå†…å­˜ç©ºé—´# 2. è°ƒç”¨__init__æ–¹æ³•ï¼Œå¯¹åˆšæ‰ç”³è¯·çš„ç©ºé—´è¿›è¡Œåˆå§‹åŒ–# __class__æŒ‡å‘ç±»å¯¹è±¡ç”±ä¸Šè¿°ä»£ç å¯ä»¥çœ‹å‡ºã€å®žä¾‹å±žæ€§éœ€è¦é€šè¿‡å¯¹è±¡æ¥è®¿é—®ã€‘ã€ç±»å±žæ€§é€šè¿‡ç±»è®¿é—®ã€‘ï¼Œåœ¨ä½¿ç”¨ä¸Šå¯ä»¥çœ‹å‡ºå®žä¾‹å±žæ€§å’Œç±»å±žæ€§çš„å½’å±žæ˜¯ä¸åŒçš„ã€‚å…¶åœ¨å†…å®¹çš„å­˜å‚¨æ–¹å¼ç±»ä¼¼å¦‚ä¸‹å›¾ï¼šç”±ä¸Šå›¾çœ‹å‡ºï¼šç±»å±žæ€§åœ¨å†…å­˜ä¸­åªä¿å­˜ä¸€ä»½å®žä¾‹å±žæ€§åœ¨æ¯ä¸ªå¯¹è±¡ä¸­éƒ½è¦ä¿å­˜ä¸€ä»½åº”ç”¨åœºæ™¯ï¼šé€šè¿‡ç±»åˆ›å»ºå®žä¾‹å¯¹è±¡æ—¶ï¼Œå¦‚æžœæ¯ä¸ªå¯¹è±¡éœ€è¦å…·æœ‰ç›¸åŒåå­—çš„å±žæ€§ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨ç±»å±žæ€§ï¼Œç”¨ä¸€ä»½å³å¯2. å®žä¾‹æ–¹æ³•ã€é™æ€æ–¹æ³•å’Œç±»æ–¹æ³•æ–¹æ³•åŒ…æ‹¬ï¼šå®žä¾‹æ–¹æ³•ã€é™æ€æ–¹æ³•å’Œç±»æ–¹æ³•ï¼Œä¸‰ç§æ–¹æ³•åœ¨å†…å­˜ä¸­éƒ½å½’å±žäºŽç±»ï¼ŒåŒºåˆ«åœ¨äºŽè°ƒç”¨æ–¹å¼ä¸åŒã€‚å®žä¾‹æ–¹æ³•ï¼šç”±å¯¹è±¡è°ƒç”¨ï¼›è‡³å°‘ä¸€ä¸ªselfå‚æ•°ï¼›æ‰§è¡Œå®žä¾‹æ–¹æ³•æ—¶ï¼Œè‡ªåŠ¨å°†è°ƒç”¨è¯¥æ–¹æ³•çš„å¯¹è±¡èµ‹å€¼ç»™selfï¼›ç±»æ–¹æ³•ï¼šç”±ç±»è°ƒç”¨ï¼› è‡³å°‘ä¸€ä¸ªclså‚æ•°ï¼›æ‰§è¡Œç±»æ–¹æ³•æ—¶ï¼Œè‡ªåŠ¨å°†è°ƒç”¨è¯¥æ–¹æ³•çš„ç±»èµ‹å€¼ç»™clsï¼›é™æ€æ–¹æ³•ï¼šç”±ç±»è°ƒç”¨ï¼›æ— é»˜è®¤å‚æ•°ï¼›12345678910111213141516171819202122232425262728293031323334353637383940class Foo(object): def __init__(self, name): self.name = name def ord_func(self): """ å®šä¹‰å®žä¾‹æ–¹æ³•ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªselfå‚æ•°ï¼Œä¼ é€’çš„æ˜¯å®žä¾‹å¯¹è±¡çš„å¼•ç”¨ """ # print(self.name) # å®žä¾‹æ–¹æ³•å¯ä»¥ä¿®æ”¹å®žä¾‹å¯¹è±¡çš„å±žæ€§ print('å®žä¾‹æ–¹æ³•') @classmethod def class_func(cls): """ å®šä¹‰ç±»æ–¹æ³•ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªclså‚æ•° ï¼Œä¼ é€’çš„æ˜¯ç±»å¯¹è±¡çš„å¼•ç”¨""" # ç±»æ–¹æ³•å¯ä»¥ä¿®æ”¹ç±»å¯¹è±¡çš„å±žæ€§ print('ç±»æ–¹æ³•') @staticmethod def static_func(): """ å®šä¹‰é™æ€æ–¹æ³• ï¼Œæ— é»˜è®¤å‚æ•°""" print('é™æ€æ–¹æ³•')f = Foo("ä¸­å›½")# è°ƒç”¨å®žä¾‹æ–¹æ³•f.ord_func()# è°ƒç”¨ç±»æ–¹æ³•Foo.class_func()# è°ƒç”¨é™æ€æ–¹æ³•Foo.static_func()# é€šè¿‡å®žä¾‹å¯¹è±¡è°ƒç”¨ç±»æ–¹æ³•f.__class__.class_func()# é€šè¿‡å®žä¾‹å¯¹è±¡è°ƒç”¨é™æ€æ–¹æ³•f.__class__.static_func()# æ€»ç»“# 1.å®žä¾‹å¯¹è±¡å¯ä»¥è°ƒç”¨ç±»æ–¹æ³•ï¼Œå®žä¾‹æ–¹æ³•å’Œé™æ€æ–¹æ³•# 2.ç±»å¯¹è±¡å¯ä»¥è°ƒç”¨ç±»æ–¹æ³•å’Œé™æ€æ–¹æ³•ï¼Œä¸èƒ½è°ƒç”¨å®žä¾‹æ–¹æ³•å¯¹æ¯”ç›¸åŒç‚¹ï¼šå¯¹äºŽæ‰€æœ‰çš„æ–¹æ³•è€Œè¨€ï¼Œå‡å±žäºŽç±»ï¼Œæ‰€ä»¥åœ¨å†…å­˜ä¸­ä¹Ÿåªä¿å­˜ä¸€ä»½ä¸åŒç‚¹ï¼šæ–¹æ³•è°ƒç”¨è€…ä¸åŒã€è°ƒç”¨æ–¹æ³•æ—¶è‡ªåŠ¨ä¼ å…¥çš„å‚æ•°ä¸åŒpropertyå±žæ€§1. ä»€ä¹ˆæ˜¯propertyå±žæ€§ä¸€ç§ç”¨èµ·æ¥åƒæ˜¯ä½¿ç”¨çš„å®žä¾‹å±žæ€§ä¸€æ ·çš„ç‰¹æ®Šå±žæ€§ï¼Œå¯ä»¥å¯¹åº”äºŽæŸä¸ªæ–¹æ³•123456789101112131415# ######## å®šä¹‰ ########class Foo: def func(self): pass # å®šä¹‰propertyå±žæ€§ï¼ŒæŠŠå®žä¾‹æ–¹æ³•è£…é¥°æˆä¸€ä¸ªå®žä¾‹å±žæ€§ @property def prop(self): """è¿”å›žä¸€ä¸ªå€¼""" pass# ######## è°ƒç”¨ ########foo_obj = Foo()foo_obj.func() # è°ƒç”¨å®žä¾‹æ–¹æ³•foo_obj.prop # è°ƒç”¨propertyå±žæ€§propertyå±žæ€§çš„å®šä¹‰å’Œè°ƒç”¨è¦æ³¨æ„ä¸€ä¸‹å‡ ç‚¹ï¼šå®šä¹‰æ—¶ï¼Œåœ¨å®žä¾‹æ–¹æ³•çš„åŸºç¡€ä¸Šæ·»åŠ  @property è£…é¥°å™¨ï¼›å¹¶ä¸”ä»…æœ‰ä¸€ä¸ªselfå‚æ•°è°ƒç”¨æ—¶ï¼Œæ— éœ€æ‹¬å·12æ–¹æ³•ï¼šfoo_obj.func()propertyå±žæ€§ï¼šfoo_obj.prop2. ç®€å•çš„å®žä¾‹å¯¹äºŽäº¬ä¸œå•†åŸŽä¸­æ˜¾ç¤ºç”µè„‘ä¸»æœºçš„åˆ—è¡¨é¡µé¢ï¼Œæ¯æ¬¡è¯·æ±‚ä¸å¯èƒ½æŠŠæ•°æ®åº“ä¸­çš„æ‰€æœ‰å†…å®¹éƒ½æ˜¾ç¤ºåˆ°é¡µé¢ä¸Šï¼Œè€Œæ˜¯é€šè¿‡åˆ†é¡µçš„åŠŸèƒ½å±€éƒ¨æ˜¾ç¤ºï¼Œæ‰€ä»¥åœ¨å‘æ•°æ®åº“ä¸­è¯·æ±‚æ•°æ®æ—¶å°±è¦æ˜¾ç¤ºçš„æŒ‡å®šèŽ·å–ä»Žç¬¬mæ¡åˆ°ç¬¬næ¡çš„æ‰€æœ‰æ•°æ® è¿™ä¸ªåˆ†é¡µçš„åŠŸèƒ½åŒ…æ‹¬ï¼šæ ¹æ®ç”¨æˆ·è¯·æ±‚çš„å½“å‰é¡µå’Œæ€»æ•°æ®æ¡æ•°è®¡ç®—å‡º m å’Œ næ ¹æ®m å’Œ n åŽ»æ•°æ®åº“ä¸­è¯·æ±‚æ•°æ®12345678910111213141516171819202122# ######## å®šä¹‰ ########class Pager: def __init__(self, current_page): # ç”¨æˆ·å½“å‰è¯·æ±‚çš„é¡µç ï¼ˆç¬¬ä¸€é¡µã€ç¬¬äºŒé¡µ...ï¼‰ self.current_page = current_page # æ¯é¡µé»˜è®¤æ˜¾ç¤º10æ¡æ•°æ® self.per_items = 10 @property def start(self): val = (self.current_page - 1) * self.per_items return val @property def end(self): val = self.current_page * self.per_items return val# ######## è°ƒç”¨ ########p = Pager(1)p.start # å°±æ˜¯èµ·å§‹å€¼ï¼Œå³ï¼šmp.end # å°±æ˜¯ç»“æŸå€¼ï¼Œå³ï¼šnä»Žä¸Šè¿°å¯è§Pythonçš„propertyå±žæ€§çš„åŠŸèƒ½æ˜¯ï¼špropertyå±žæ€§å†…éƒ¨è¿›è¡Œä¸€ç³»åˆ—çš„é€»è¾‘è®¡ç®—ï¼Œæœ€ç»ˆå°†è®¡ç®—ç»“æžœè¿”å›žã€‚3. propertyå±žæ€§çš„æœ‰ä¸¤ç§æ–¹å¼è£…é¥°å™¨ å³ï¼šåœ¨æ–¹æ³•ä¸Šåº”ç”¨è£…é¥°å™¨ç±»å±žæ€§ å³ï¼šåœ¨ç±»ä¸­å®šä¹‰å€¼ä¸ºpropertyå¯¹è±¡çš„ç±»å±žæ€§3.1 è£…é¥°å™¨æ–¹å¼åœ¨ç±»çš„å®žä¾‹æ–¹æ³•ä¸Šåº”ç”¨@propertyè£…é¥°å™¨Pythonä¸­çš„ç±»æœ‰ç»å…¸ç±»å’Œæ–°å¼ç±»ï¼Œæ–°å¼ç±»çš„å±žæ€§æ¯”ç»å…¸ç±»çš„å±žæ€§ä¸°å¯Œã€‚ï¼ˆ å¦‚æžœç±»ç»§objectï¼Œé‚£ä¹ˆè¯¥ç±»æ˜¯æ–°å¼ç±» ï¼‰3.1.1ç»å…¸ç±»ï¼Œå…·æœ‰ä¸€ç§@propertyè£…é¥°å™¨1234567891011########## å®šä¹‰ ######## class Goods: @property def price(self): return "laowang"########## è°ƒç”¨ ########obj = Goods()result = obj.price # è‡ªåŠ¨æ‰§è¡Œ @property ä¿®é¥°çš„ price æ–¹æ³•ï¼Œå¹¶èŽ·å–æ–¹æ³•çš„è¿”å›žå€¼print(result)3.1.2 æ–°å¼ç±»ï¼Œå…·æœ‰ä¸‰ç§@propertyè£…é¥°å™¨1234567891011121314151617181920212223#coding=utf-8# ######## å®šä¹‰ ########class Goods: """python3ä¸­é»˜è®¤ç»§æ‰¿objectç±» ä»¥python2ã€3æ‰§è¡Œæ­¤ç¨‹åºçš„ç»“æžœä¸åŒï¼Œå› ä¸ºåªæœ‰åœ¨python3ä¸­æ‰æœ‰@xxx.setter @xxx.deleter """ @property def price(self): print('@property') @price.setter def price(self, value): print('@price.setter') @price.deleter def price(self): print('@price.deleter')# ######## è°ƒç”¨ ########obj = Goods()obj.price # è‡ªåŠ¨æ‰§è¡Œ @property ä¿®é¥°çš„ price æ–¹æ³•ï¼Œå¹¶èŽ·å–æ–¹æ³•çš„è¿”å›žå€¼obj.price = 123 # è‡ªåŠ¨æ‰§è¡Œ @price.setter ä¿®é¥°çš„ price æ–¹æ³•ï¼Œå¹¶å°† 123 èµ‹å€¼ç»™æ–¹æ³•çš„å‚æ•°del obj.price # è‡ªåŠ¨æ‰§è¡Œ @price.deleter ä¿®é¥°çš„ price æ–¹æ³•æ³¨æ„ç»å…¸ç±»ä¸­çš„å±žæ€§åªæœ‰ä¸€ç§è®¿é—®æ–¹å¼ï¼Œå…¶å¯¹åº”è¢« @property ä¿®é¥°çš„æ–¹æ³•æ–°å¼ç±»ä¸­çš„å±žæ€§æœ‰ä¸‰ç§è®¿é—®æ–¹å¼ï¼Œå¹¶åˆ†åˆ«å¯¹åº”äº†ä¸‰ä¸ªè¢«@propertyã€@æ–¹æ³•å.setterã€@æ–¹æ³•å.deleterä¿®é¥°çš„æ–¹æ³•ç”±äºŽæ–°å¼ç±»ä¸­å…·æœ‰ä¸‰ç§è®¿é—®æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®å®ƒä»¬å‡ ä¸ªå±žæ€§çš„è®¿é—®ç‰¹ç‚¹ï¼Œåˆ†åˆ«å°†ä¸‰ä¸ªæ–¹æ³•å®šä¹‰ä¸ºå¯¹åŒä¸€ä¸ªå±žæ€§ï¼šèŽ·å–ã€ä¿®æ”¹ã€åˆ é™¤1234567891011121314151617181920212223242526class Goods(object): def __init__(self): # åŽŸä»· self.original_price = 100 # æŠ˜æ‰£ self.discount = 0.8 @property def price(self): # å®žé™…ä»·æ ¼ = åŽŸä»· * æŠ˜æ‰£ new_price = self.original_price * self.discount return new_price @price.setter def price(self, value): self.original_price = value @price.deleter def price(self): del self.original_priceobj = Goods()obj.price # èŽ·å–å•†å“ä»·æ ¼obj.price = 200 # ä¿®æ”¹å•†å“åŽŸä»·del obj.price # åˆ é™¤å•†å“åŽŸä»·3.2 ç±»å±žæ€§æ–¹å¼å½“ä½¿ç”¨ç±»å±žæ€§çš„æ–¹å¼åˆ›å»ºpropertyå±žæ€§æ—¶ï¼Œç»å…¸ç±»å’Œæ–°å¼ç±»æ— åŒºåˆ«123456789class Foo: def get_bar(self): return 'laowang' BAR = property(get_bar)obj = Foo()reuslt = obj.BAR # è‡ªåŠ¨è°ƒç”¨get_baræ–¹æ³•ï¼Œå¹¶èŽ·å–æ–¹æ³•çš„è¿”å›žå€¼print(reuslt)propertyæ–¹æ³•ä¸­æœ‰ä¸ªå››ä¸ªå‚æ•°ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ–¹æ³•åï¼Œè°ƒç”¨ å¯¹è±¡.å±žæ€§ æ—¶è‡ªåŠ¨è§¦å‘æ‰§è¡Œæ–¹æ³•ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ–¹æ³•åï¼Œè°ƒç”¨ å¯¹è±¡.å±žæ€§ ï¼ XXX æ—¶è‡ªåŠ¨è§¦å‘æ‰§è¡Œæ–¹æ³•ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æ–¹æ³•åï¼Œè°ƒç”¨ del å¯¹è±¡.å±žæ€§ æ—¶è‡ªåŠ¨è§¦å‘æ‰§è¡Œæ–¹æ³•ç¬¬å››ä¸ªå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œè°ƒç”¨ å¯¹è±¡.å±žæ€§.doc ï¼Œæ­¤å‚æ•°æ˜¯è¯¥å±žæ€§çš„æè¿°ä¿¡æ¯123456789101112131415161718192021222324#coding=utf-8class Foo(object): def get_bar(self): print("getter...") return 'laowang' def set_bar(self, value): """å¿…é¡»ä¸¤ä¸ªå‚æ•°""" print("setter...") return 'set value' + value def del_bar(self): print("deleter...") return 'laowang' BAR = property(get_bar, set_bar, del_bar, "description...")obj = Foo()obj.BAR # è‡ªåŠ¨è°ƒç”¨ç¬¬ä¸€ä¸ªå‚æ•°ä¸­å®šä¹‰çš„æ–¹æ³•ï¼šget_barobj.BAR = "alex" # è‡ªåŠ¨è°ƒç”¨ç¬¬äºŒä¸ªå‚æ•°ä¸­å®šä¹‰çš„æ–¹æ³•ï¼šset_baræ–¹æ³•ï¼Œå¹¶å°†â€œalexâ€å½“ä½œå‚æ•°ä¼ å…¥desc = Foo.BAR.__doc__ # è‡ªåŠ¨èŽ·å–ç¬¬å››ä¸ªå‚æ•°ä¸­è®¾ç½®çš„å€¼ï¼šdescription...print(desc)del obj.BAR # è‡ªåŠ¨è°ƒç”¨ç¬¬ä¸‰ä¸ªå‚æ•°ä¸­å®šä¹‰çš„æ–¹æ³•ï¼šdel_baræ–¹æ³•ç”±äºŽç±»å±žæ€§æ–¹å¼åˆ›å»ºpropertyå±žæ€§å…·æœ‰3ç§è®¿é—®æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®å®ƒä»¬å‡ ä¸ªå±žæ€§çš„è®¿é—®ç‰¹ç‚¹ï¼Œåˆ†åˆ«å°†ä¸‰ä¸ªæ–¹æ³•å®šä¹‰ä¸ºå¯¹åŒä¸€ä¸ªå±žæ€§ï¼šèŽ·å–ã€ä¿®æ”¹ã€åˆ é™¤12345678910111213141516171819202122232425class Goods(object): def __init__(self): # åŽŸä»· self.original_price = 100 # æŠ˜æ‰£ self.discount = 0.8 def get_price(self): # å®žé™…ä»·æ ¼ = åŽŸä»· * æŠ˜æ‰£ new_price = self.original_price * self.discount return new_price def set_price(self, value): self.original_price = value def del_price(self): del self.original_price PRICE = property(get_price, set_price, del_price, 'ä»·æ ¼å±žæ€§æè¿°...')obj = Goods()obj.PRICE # èŽ·å–å•†å“ä»·æ ¼obj.PRICE = 200 # ä¿®æ”¹å•†å“åŽŸä»·del obj.PRICE # åˆ é™¤å•†å“åŽŸä»·4. Djangoæ¡†æž¶ä¸­åº”ç”¨äº†propertyå±žæ€§ï¼ˆäº†è§£ï¼‰WEBæ¡†æž¶ Django çš„è§†å›¾ä¸­ request.POST å°±æ˜¯ä½¿ç”¨çš„ç±»å±žæ€§çš„æ–¹å¼åˆ›å»ºçš„å±žæ€§123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475class WSGIRequest(http.HttpRequest): def __init__(self, environ): script_name = get_script_name(environ) path_info = get_path_info(environ) if not path_info: # Sometimes PATH_INFO exists, but is empty (e.g. accessing # the SCRIPT_NAME URL without a trailing slash). We really need to # operate as if they'd requested '/'. Not amazingly nice to force # the path like this, but should be harmless. path_info = '/' self.environ = environ self.path_info = path_info self.path = '%s/%s' % (script_name.rstrip('/'), path_info.lstrip('/')) self.META = environ self.META['PATH_INFO'] = path_info self.META['SCRIPT_NAME'] = script_name self.method = environ['REQUEST_METHOD'].upper() _, content_params = cgi.parse_header(environ.get('CONTENT_TYPE', '')) if 'charset' in content_params: try: codecs.lookup(content_params['charset']) except LookupError: pass else: self.encoding = content_params['charset'] self._post_parse_error = False try: content_length = int(environ.get('CONTENT_LENGTH')) except (ValueError, TypeError): content_length = 0 self._stream = LimitedStream(self.environ['wsgi.input'], content_length) self._read_started = False self.resolver_match = None def _get_scheme(self): return self.environ.get('wsgi.url_scheme') def _get_request(self): warnings.warn('`request.REQUEST` is deprecated, use `request.GET` or ' '`request.POST` instead.', RemovedInDjango19Warning, 2) if not hasattr(self, '_request'): self._request = datastructures.MergeDict(self.POST, self.GET) return self._request @cached_property def GET(self): # The WSGI spec says 'QUERY_STRING' may be absent. raw_query_string = get_bytes_from_wsgi(self.environ, 'QUERY_STRING', '') return http.QueryDict(raw_query_string, encoding=self._encoding) # ######## çœ‹è¿™é‡Œçœ‹è¿™é‡Œ ######## def _get_post(self): if not hasattr(self, '_post'): self._load_post_and_files() return self._post # ######## çœ‹è¿™é‡Œçœ‹è¿™é‡Œ ######## def _set_post(self, post): self._post = post @cached_property def COOKIES(self): raw_cookie = get_str_from_wsgi(self.environ, 'HTTP_COOKIE', '') return http.parse_cookie(raw_cookie) def _get_files(self): if not hasattr(self, '_files'): self._load_post_and_files() return self._files # ######## çœ‹è¿™é‡Œçœ‹è¿™é‡Œ ######## POST = property(_get_post, _set_post) FILES = property(_get_files) REQUEST = property(_get_request)5. æ€»ç»“å®šä¹‰propertyå±žæ€§å…±æœ‰ä¸¤ç§æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯ã€è£…é¥°å™¨ã€‘å’Œã€ç±»å±žæ€§ã€‘ï¼Œè€Œã€è£…é¥°å™¨ã€‘æ–¹å¼é’ˆå¯¹ç»å…¸ç±»å’Œæ–°å¼ç±»åˆæœ‰æ‰€ä¸åŒã€‚é€šè¿‡ä½¿ç”¨propertyå±žæ€§ï¼Œèƒ½å¤Ÿç®€åŒ–è°ƒç”¨è€…åœ¨èŽ·å–æ•°æ®çš„æµç¨‹propertyå±žæ€§-åº”ç”¨1. ç§æœ‰å±žæ€§æ·»åŠ getterå’Œsetteræ–¹æ³•123456789101112class Money(object): def __init__(self): self.__money = 0 def getMoney(self): return self.__money def setMoney(self, value): if isinstance(value, int): self.__money = value else: print("error:ä¸æ˜¯æ•´åž‹æ•°å­—")2. ä½¿ç”¨propertyå‡çº§getterå’Œsetteræ–¹æ³•1234567891011121314151617181920class Money(object): def __init__(self): self.__money = 0 def getMoney(self): return self.__money def setMoney(self, value): if isinstance(value, int): self.__money = value else: print("error:ä¸æ˜¯æ•´åž‹æ•°å­—") # å®šä¹‰ä¸€ä¸ªå±žæ€§ï¼Œå½“å¯¹è¿™ä¸ªmoneyè®¾ç½®å€¼æ—¶è°ƒç”¨setMoney,å½“èŽ·å–å€¼æ—¶è°ƒç”¨getMoney money = property(getMoney, setMoney) a = Money()a.money = 100 # è°ƒç”¨setMoneyæ–¹æ³•print(a.money) # è°ƒç”¨getMoneyæ–¹æ³•#1003. ä½¿ç”¨propertyå–ä»£getterå’Œsetteræ–¹æ³•é‡æ–°å®žçŽ°ä¸€ä¸ªå±žæ€§çš„è®¾ç½®å’Œè¯»å–æ–¹æ³•,å¯åšè¾¹ç•Œåˆ¤å®š1234567891011121314151617181920class Money(object): def __init__(self): self.__money = 0 # ä½¿ç”¨è£…é¥°å™¨å¯¹moneyè¿›è¡Œè£…é¥°ï¼Œé‚£ä¹ˆä¼šè‡ªåŠ¨æ·»åŠ ä¸€ä¸ªå«moneyçš„å±žæ€§ï¼Œå½“è°ƒç”¨èŽ·å–moneyçš„å€¼æ—¶ï¼Œè°ƒç”¨è£…é¥°çš„æ–¹æ³• @property def money(self): return self.__money # ä½¿ç”¨è£…é¥°å™¨å¯¹moneyè¿›è¡Œè£…é¥°ï¼Œå½“å¯¹moneyè®¾ç½®å€¼æ—¶ï¼Œè°ƒç”¨è£…é¥°çš„æ–¹æ³• @money.setter def money(self, value): if isinstance(value, int): self.__money = value else: print("error:ä¸æ˜¯æ•´åž‹æ•°å­—")a = Money()a.money = 100print(a.money)é­”æ³•å±žæ€§æ— è®ºäººæˆ–äº‹ç‰©å¾€å¾€éƒ½æœ‰ä¸æŒ‰å¥—è·¯å‡ºç‰Œçš„æƒ…å†µï¼ŒPythonçš„ç±»å±žæ€§ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå­˜åœ¨ç€ä¸€äº›å…·æœ‰ç‰¹æ®Šå«ä¹‰çš„å±žæ€§ï¼Œè¯¦æƒ…å¦‚ä¸‹ï¼š1. __doc__è¡¨ç¤ºç±»çš„æè¿°ä¿¡æ¯1234567class Foo: """ æè¿°ç±»ä¿¡æ¯ï¼Œè¿™æ˜¯ç”¨äºŽçœ‹ç‰‡çš„ç¥žå¥‡ """ def func(self): passprint(Foo.__doc__)#è¾“å‡ºï¼šç±»çš„æè¿°ä¿¡æ¯2. __module__ å’Œ __class____module__ è¡¨ç¤ºå½“å‰æ“ä½œçš„å¯¹è±¡åœ¨é‚£ä¸ªæ¨¡å—__class__ è¡¨ç¤ºå½“å‰æ“ä½œçš„å¯¹è±¡çš„ç±»æ˜¯ä»€ä¹ˆ123456789101112test.py# -*- coding:utf-8 -*-class Person(object): def __init__(self): self.name = &apos;laowang&apos;main.pyfrom test import Personobj = Person()print(obj.__module__) # è¾“å‡º test å³ï¼šè¾“å‡ºæ¨¡å—print(obj.__class__) # è¾“å‡º test.Person å³ï¼šè¾“å‡ºç±»3. __init__åˆå§‹åŒ–æ–¹æ³•ï¼Œé€šè¿‡ç±»åˆ›å»ºå¯¹è±¡æ—¶ï¼Œè‡ªåŠ¨è§¦å‘æ‰§è¡Œ1234567class Person: def __init__(self, name): self.name = name self.age = 18obj = Person('laowang') # è‡ªåŠ¨æ‰§è¡Œç±»ä¸­çš„ __init__ æ–¹æ³•4. __del__å½“å¯¹è±¡åœ¨å†…å­˜ä¸­è¢«é‡Šæ”¾æ—¶ï¼Œè‡ªåŠ¨è§¦å‘æ‰§è¡Œã€‚æ³¨ï¼šæ­¤æ–¹æ³•ä¸€èˆ¬æ— é¡»å®šä¹‰ï¼Œå› ä¸ºPythonæ˜¯ä¸€é—¨é«˜çº§è¯­è¨€ï¼Œç¨‹åºå‘˜åœ¨ä½¿ç”¨æ—¶æ— éœ€å…³å¿ƒå†…å­˜çš„åˆ†é…å’Œé‡Šæ”¾ï¼Œå› ä¸ºæ­¤å·¥ä½œéƒ½æ˜¯äº¤ç»™Pythonè§£é‡Šå™¨æ¥æ‰§è¡Œï¼Œæ‰€ä»¥ï¼Œdelçš„è°ƒç”¨æ˜¯ç”±è§£é‡Šå™¨åœ¨è¿›è¡Œåžƒåœ¾å›žæ”¶æ—¶è‡ªåŠ¨è§¦å‘æ‰§è¡Œçš„ã€‚123class Foo: def __del__(self): pass5. __call__å¯¹è±¡åŽé¢åŠ æ‹¬å·ï¼Œè§¦å‘æ‰§è¡Œã€‚æ³¨ï¼š__init__æ–¹æ³•çš„æ‰§è¡Œæ˜¯ç”±åˆ›å»ºå¯¹è±¡è§¦å‘çš„ï¼Œå³ï¼šå¯¹è±¡ = ç±»å() ï¼›è€Œå¯¹äºŽ__call__æ–¹æ³•çš„æ‰§è¡Œæ˜¯ç”±å¯¹è±¡åŽåŠ æ‹¬å·è§¦å‘çš„ï¼Œå³ï¼šå¯¹è±¡() æˆ–è€… ç±»()()12345678910class Foo: def __init__(self): pass def __call__(self, *args, **kwargs): print('__call__')obj = Foo() # æ‰§è¡Œ __init__obj() # æ‰§è¡Œ __call__6. __dict__ç±»æˆ–å¯¹è±¡ä¸­çš„æ‰€æœ‰å±žæ€§ç±»çš„å®žä¾‹å±žæ€§å±žäºŽå¯¹è±¡ï¼›ç±»ä¸­çš„ç±»å±žæ€§å’Œæ–¹æ³•ç­‰å±žäºŽç±»ï¼Œå³ï¼š1234567891011121314151617181920212223class Province(object): country = 'China' def __init__(self, name, count): self.name = name self.count = count def func(self, *args, **kwargs): print('func')# èŽ·å–ç±»çš„å±žæ€§ï¼Œå³ï¼šç±»å±žæ€§ã€æ–¹æ³•ã€print(Province.__dict__)# è¾“å‡ºï¼š&#123;'__dict__': &lt;attribute '__dict__' of 'Province' objects&gt;, '__module__': '__main__', 'country': 'China', '__doc__': None, '__weakref__': &lt;attribute '__weakref__' of 'Province' objects&gt;, 'func': &lt;function Province.func at 0x101897950&gt;, '__init__': &lt;function Province.__init__ at 0x1018978c8&gt;&#125;obj1 = Province('å±±ä¸œ', 10000)print(obj1.__dict__)# èŽ·å– å¯¹è±¡obj1 çš„å±žæ€§# è¾“å‡ºï¼š&#123;'count': 10000, 'name': 'å±±ä¸œ'&#125;obj2 = Province('å±±è¥¿', 20000)print(obj2.__dict__)# èŽ·å– å¯¹è±¡obj1 çš„å±žæ€§# è¾“å‡ºï¼š&#123;'count': 20000, 'name': 'å±±è¥¿'&#125;7. __str__å¦‚æžœä¸€ä¸ªç±»ä¸­å®šä¹‰äº†__str__æ–¹æ³•ï¼Œé‚£ä¹ˆåœ¨æ‰“å° å¯¹è±¡ æ—¶ï¼Œé»˜è®¤è¾“å‡ºè¯¥æ–¹æ³•çš„è¿”å›žå€¼ã€‚12345678class Foo: def __str__(self): return 'laowang'obj = Foo()print(obj)# è¾“å‡ºï¼šlaowang8ã€__getitem__ã€__setitem__ã€__delitem__ç”¨äºŽç´¢å¼•æ“ä½œï¼Œå¦‚å­—å…¸ã€‚ä»¥ä¸Šåˆ†åˆ«è¡¨ç¤ºèŽ·å–ã€è®¾ç½®ã€åˆ é™¤æ•°æ®12345678910111213141516171819# -*- coding:utf-8 -*-class Foo(object): def __getitem__(self, key): print('__getitem__', key) def __setitem__(self, key, value): print('__setitem__', key, value) def __delitem__(self, key): print('__delitem__', key)obj = Foo()result = obj['k1'] # è‡ªåŠ¨è§¦å‘æ‰§è¡Œ __getitem__obj['k2'] = 'laowang' # è‡ªåŠ¨è§¦å‘æ‰§è¡Œ __setitem__del obj['k1'] # è‡ªåŠ¨è§¦å‘æ‰§è¡Œ __delitem__9ã€__getslice__ã€__setslice__ã€__delslice__è¯¥ä¸‰ä¸ªæ–¹æ³•ç”¨äºŽåˆ†ç‰‡æ“ä½œï¼Œå¦‚ï¼šåˆ—è¡¨123456789101112131415161718# -*- coding:utf-8 -*-class Foo(object): def __getslice__(self, i, j): print('__getslice__', i, j) def __setslice__(self, i, j, sequence): print('__setslice__', i, j) def __delslice__(self, i, j): print('__delslice__', i, j)obj = Foo()obj[-1:1] # è‡ªåŠ¨è§¦å‘æ‰§è¡Œ __getslice__obj[0:1] = [11,22,33,44] # è‡ªåŠ¨è§¦å‘æ‰§è¡Œ __setslice__del obj[0:2] # è‡ªåŠ¨è§¦å‘æ‰§è¡Œ __delslice__é¢å‘å¯¹è±¡è®¾è®¡ç»§æ‰¿ - æ˜¯åŸºäºŽPythonä¸­çš„å±žæ€§æŸ¥æ‰¾(å¦‚X.name)å¤šæ€ - åœ¨X.methodæ–¹æ³•ä¸­ï¼Œmethodçš„æ„ä¹‰å–å†³äºŽXçš„ç±»åž‹å°è£… - æ–¹æ³•å’Œè¿ç®—ç¬¦å®žçŽ°è¡Œä¸ºï¼Œæ•°æ®éšè—é»˜è®¤æ˜¯ä¸€ç§æƒ¯ä¾‹å‚è€ƒå®žä¾‹è…¾è®¯å³æ—¶é€šä¿¡æ¨¡å—,åˆçº§å°è£…123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312#! /usr/bin/env python# coding: utf-8import randomimport timeclass Message(object): def __init__(self, msgarr=[], toacc=''): self.msgbody = msgarr # æ­¤å¤„ä¸ºMsgDictå¯¹è±¡å®žä¾‹çš„åˆ—è¡¨æˆ–è€…ç©ºåˆ—è¡¨ self.toacc = toacc # toaccä¸ºå­—ç¬¦ä¸²(å•å‘)æˆ–è€…åˆ—è¡¨(æ‰¹é‡å‘) self.msgrandom = random.randint(1, 1000000000) self.msgrequest = &#123; 'To_Account': toacc, # æ¶ˆæ¯æŽ¥æ”¶æ–¹è´¦å· 'MsgRandom': self.msgrandom, # æ¶ˆæ¯éšæœºæ•°ï¼Œç”±éšæœºå‡½æ•°äº§ç”Ÿ 'MsgBody': [t.msg for t in msgarr] &#125; def del_option(self, option): if option in (set(self.msgrequest)-set(['To_Account', 'MsgRandom', 'MsgBody'])): self.__dict__.pop(option) self.msgrequest.pop(option) def append_msg(self, msg): self.msgbody.append(msg) self.msgrequest['MsgBody'].append(msg.msg) def insert_msg(self, index, msg): self.msgbody.insert(index, msg) self.msgrequest['MsgBody'].insert(msg.msg) def del_msg(self, index): if index in range(len(self.msgbody)): del self.msgbody[index] del sel.msgrequest['MsgBody'][index] def set_from(self, fromacc): # æŒ‡å®šæ¶ˆæ¯çš„å‘é€æ–¹ï¼Œé»˜è®¤ä¸ºæœåŠ¡å™¨å‘é€ self.fromacc = fromacc self.msgrequest['From_Account'] = fromacc def set_to(self, toacc): # æŒ‡å®šæ¶ˆæ¯çš„æŽ¥æ”¶æ–¹ï¼Œå¯ä»¥ä¸ºString(å•å‘),å¯ä»¥ä¸ºList(æ‰¹é‡å‘é€) self.toacc = toacc self.msgrequest['To_Account'] = toacc def refresh_random(self): self.msgrandom = random.randint(1, 1000000000) self.msgrequest['MsgRandom'] = self.msgrandom, # æ¶ˆæ¯éšæœºæ•°ï¼Œç”±éšæœºå‡½æ•°äº§ç”Ÿ def set_sync(self, sync): # åŒæ­¥é€‰é¡¹ï¼š1, æŠŠæ¶ˆæ¯åŒæ­¥åˆ°From_Accountåœ¨çº¿ç»ˆç«¯å’Œæ¼«æ¸¸ä¸Š # 2, æ¶ˆæ¯ä¸åŒæ­¥è‡³From_Account # è‹¥ä¸å¡«å†™ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šå°†æ¶ˆæ¯åŒæ­¥ # ä»…åœ¨å•å‘å•èŠæ¶ˆæ¯ä¸­å¯è°ƒç”¨ self.sync = sync self.msgrequest['SyncOtherMachine'] = sync def set_timestamp(self): # è®¾ç½®æ¶ˆæ¯æ—¶é—´æˆ³ï¼Œunixæ—¶é—´, ä»…åœ¨å•å‘å•èŠæ¶ˆæ¯ä¸­å¯ä»¥è°ƒç”¨ self.timestamp = int(time.time()) self.msgrequest['MsgTimeStamp'] = self.timestamp def set_offlinepush(self, pushflag=0, desc='', ext='', sound=''): # ä»…é€‚ç”¨äºŽAPNaæŽ¨é€ï¼Œä¸é€‚ç”¨äºŽå®‰å“åŽ‚å•†æŽ¨é€ self.msgrequest['OfflinePushInfo'] = &#123; 'PushFlag': pushflag, 'Desc': desc, 'Ext': ext, 'Sound': sound &#125;class MsgDict(object): def __init__(self, msgtype='', msgcontent=&#123;&#125;): self.msgtype = msgtype self.msgcontent = msgcontent @property def msg(self): return &#123; 'MsgType': self.msgtype, 'MsgContent': self.msgcontent &#125; def set_content(self, content): self.msgcontent = contentclass TextMsg(MsgDict): def __init__(self, text='', msgtype='TIMTextElem'): self.text = text content = &#123;'Text': text&#125; super(TextMsg, self).__init__(msgtype=msgtype, msgcontent=content) def set_text(self, text): self.text = text self.msgcontent['Text'] = textclass LocationMsg(MsgDict): def __init__(self, desc='', latitude=0, longitude=0, msgtype='TIMLocationElem'): self.desc = desc self.latitude = latitude self.longitude = longitude content = &#123; 'Desc': desc, # åœ°ç†ä½ç½®æè¿°ä¿¡æ¯, String 'Latitude': latitude, # çº¬åº¦, Number 'Longitude': longitude # ç»åº¦, Number &#125; super(LocationMsg, self).__init__(msgtype=msgtype, msgcontent=content) def set_desc(self, desc): self.desc = desc self.msgcontent['Desc'] = desc def set_location(self, latitude, longitude): self.latitude = latitude self.longitude = longitude self.msgcontent['Latitude'] = latitude self.msgcontent['Longitude'] = longitude def set_latitude(self, latitude): self.latitude = latitude self.msgcontent['Latitude'] = latitude def set_longitude(self, longitude): self.longitude = longitude self.msgcontent['Longitude'] = longitudeclass FaceMsg(MsgDict): def __init__(self, index=1, data='', msgtype='TIMFaceElem'): self.index = index self.data = data content = &#123; 'Index': index, # è¡¨æƒ…ç´¢å¼•ï¼Œç”¨æˆ·è‡ªå®šä¹‰, Number 'Data': data # é¢å¤–æ•°æ®, String &#125; super(TextMsg, self).__init__(msgtype=msgtype, msgcontent=content) def set_index(self, index): self.index = index self.msgcontent['Index'] = index def set_data(self, data): self.data = data self.msgcontent['Data'] = dataclass CustomMsg(MsgDict): def __init__(self, data='', desc='', ext='', sound='', msgtype='TIMCustomElem'): self.data = data self.desc = desc self.ext = ext self.sound = sound content = &#123; 'Data': data, # è‡ªå®šä¹‰æ¶ˆæ¯æ•°æ®ã€‚ä¸ä½œä¸ºAPNSçš„payloadä¸­å­—æ®µä¸‹å‘ï¼Œæ•…ä»Žpayloadä¸­æ— æ³•èŽ·å–Dataå­—æ®µ, String 'Desc': desc, # è‡ªå®šä¹‰æ¶ˆæ¯æè¿°ï¼Œå½“æŽ¥æ”¶æ–¹ä¸ºiphoneåŽå°åœ¨çº¿æ—¶ï¼Œåšiosç¦»çº¿Pushæ—¶æ–‡æœ¬å±•ç¤º 'Ext': ext, # æ‰©å±•å­—æ®µï¼Œå½“æŽ¥æ”¶æ–¹ä¸ºiosç³»ç»Ÿä¸”åº”ç”¨å¤„åœ¨åŽå°æ—¶ï¼Œæ­¤å­—æ®µä½œä¸ºAPNSè¯·æ±‚åŒ…Payloadsä¸­çš„exté”®å€¼ä¸‹å‘ï¼ŒExtçš„åè®®æ ¼å¼ç”±ä¸šåŠ¡æ–¹ç¡®å®šï¼ŒAPNSåªåšé€ä¼  'Sound': sound # è‡ªå®šä¹‰APNSæŽ¨é€é“ƒå£° &#125; super(CustomMsg, self).__init__(msgtype=msgtype, msgcontent=content) def set_data(self, data): self.data = data self.msgcontent['Data'] = data def set_desc(self, desc): self.desc = desc self.msgcontent['Desc'] = desc def set_ext(self, ext): self.ext = ext self.msgcontent['Ext'] = ext def set_sound(self, sound): self.sound = sound self.msgcontent['Sound'] = soundclass SoundMsg(MsgDict): def __init__(self, uuid='', size=0, second=0, msgtype='TIMSoundElem'): self.uuid = uuid self.size = size self.second = second content = &#123; 'UUID': uuid, # è¯­éŸ³åºåˆ—å·ï¼ŒåŽå°ç”¨äºŽç´¢å¼•è¯­éŸ³çš„é”®å€¼ï¼ŒString 'Size': size, # è¯­éŸ³æ•°æ®å¤§å°, Number 'Second': second # è¯­éŸ³æ—¶é•¿ï¼Œå•ä½ç§’ Number &#125; super(SoundMsg, self).__init__(msgtype=msgtype, msgcontent=content) def set_uuid(self, uuid): self.uuid = uuid self.msgcontent['UUID'] = uuid def set_size(self, size): self.size = size self.msgcontent['Size'] = size def set_second(self, second): self.second = second self.msgcontent['Second'] = secondclass ImageMsg(MsgDict): def __init__(self, uuid='', imgformat=0, imginfo=[], msgtype='TIMImageElem'): self.uuid = uuid self.imgformat = imgformat self.imginfo = imginfo content = &#123; 'UUID': uuid, # å›¾ç‰‡åºåˆ—å·ï¼ŒåŽå°ç”¨äºŽç´¢å¼•è¯­éŸ³çš„é”®å€¼ï¼ŒString 'ImageFormat': imgformat, # å›¾ç‰‡æ ¼å¼ï¼Œ BMP=1, JPG=2, GIF=3, å…¶ä»–=0, Number 'ImageInfoArray': [t.info for t in imginfo] # åŽŸå›¾ï¼Œç¼©ç•¥å›¾æˆ–è€…å¤§å›¾ä¸‹è½½ä¿¡æ¯, Array &#125; super(ImageMsg, self).__init__(msgtype=msgtype, msgcontent=content) def set_uuid(self, uuid): self.uuid = uuid self.msgcontent['UUID'] = uuid def set_format(self, imgformat): self.imgformat = imgformat self.msgcontent['ImageFormat'] = imgformat def append_info(self, info): # info ä¸ºImageInfoå¯¹è±¡å®žä¾‹ self.imginfo.append(info) self.msgcontnet['ImageInfoArray'].append(info.info) def insert_info(self, index, info): self.imginfo.insert(index, info) self.msgcontent['ImageInfoArray'].insert(index, info.info) def del_info(self, index): del self.imginfo[index] del self.msgcontent['ImageInfoArray'][index]class FileMsg(MsgDict): def __init__(self, uuid='', size=0, name='', msgtype='TIMFileElem'): self.uuid = uuid self.size = size self.name = name content = &#123; 'UUID': uuid, # æ–‡ä»¶åºåˆ—å·ï¼ŒåŽå°ç”¨äºŽç´¢å¼•è¯­éŸ³çš„é”®å€¼ï¼ŒString 'FileSize': size, # æ–‡ä»¶æ•°æ®å¤§å°, Number 'FileName': name # æ–‡ä»¶åç§°/è·¯å¾„ï¼Œ String &#125; super(FileMsg, self).__init__(msgtype=msgtype, msgcontent=content) def set_uuid(self, uuid): self.uuid = uuid self.msgcontent['UUID'] = UUID def set_size(self, size): self.size = size self.msgcontent['FileSize'] = size def set_name(self, name): self.name = name self.msgcontent['FileName'] = nameclass ImageInfo(object): def __init__(self, itype=1, size=0, width=0, height=0, url=''): #å›¾ç‰‡ç±»åž‹ï¼Œ 1-åŽŸå›¾ï¼Œ 2-å¤§å›¾ï¼Œ 3-ç¼©ç•¥å›¾, 0-å…¶ä»– self.itype = itype # å›¾ç‰‡æ•°æ®å¤§å°,Number self.size = size # å›¾ç‰‡å®½åº¦,Number self.width = width # å›¾ç‰‡é«˜åº¦, Number self.height = height # å›¾ç‰‡ä¸‹è½½åœ°å€,String self.url = url @property def info(self): return &#123; 'Type': self.itype, 'Size': self.size, 'Width': self.width, 'Height': self.height, 'URL': self.url &#125; def set_type(self, itype): self.itype = itype def set_size(self, size): self.size = size def set_width(self, width): self.width = width def set_height(self, height): self.height = height def set_url(self, url): self.url = urlå¾®ä¿¡å¼€å‘åŒ…ï¼Œpythonå®žçŽ°, wechat_sdkå¼€å‘1http://wechat-python-sdk.com/æˆªå–éƒ¨åˆ†ä»£ç ï¼Œå­¦ä¹ ç±»çš„è®¾è®¡123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293from __future__ import unicode_literalsimport timefrom wechat_sdk.lib.crypto import BasicCryptofrom wechat_sdk.lib.request import WechatRequestfrom wechat_sdk.exceptions import NeedParamErrorfrom wechat_sdk.utils import disable_urllib3_warningclass WechatConf(object): """ WechatConf é…ç½®ç±» è¯¥ç±»å°†ä¼šå­˜å‚¨æ‰€æœ‰å’Œå¾®ä¿¡å¼€å‘ç›¸å…³çš„é…ç½®ä¿¡æ¯, åŒæ—¶ä¹Ÿä¼šç»´æŠ¤é…ç½®ä¿¡æ¯çš„æœ‰æ•ˆæ€§. """ def __init__(self, **kwargs): """ :param kwargs: é…ç½®ä¿¡æ¯å­—å…¸, å¯ç”¨å­—å…¸ key å€¼åŠå¯¹åº”è§£é‡Šå¦‚ä¸‹: 'token': å¾®ä¿¡ Token 'appid': App ID 'appsecret': App Secret 'encrypt_mode': åŠ è§£å¯†æ¨¡å¼ ('normal': æ˜Žæ–‡æ¨¡å¼, 'compatible': å…¼å®¹æ¨¡å¼, 'safe': å®‰å…¨æ¨¡å¼(é»˜è®¤)) 'encoding_aes_key': EncodingAESKey å€¼ (ä¼ å…¥æ­¤å€¼å¿…é¡»ä¿è¯åŒæ—¶ä¼ å…¥ token, appid, å¦åˆ™æŠ›å‡ºå¼‚å¸¸) 'access_token_getfunc': access token èŽ·å–å‡½æ•° (ç”¨äºŽå•æœºåŠåˆ†å¸ƒå¼çŽ¯å¢ƒä¸‹, å…·ä½“æ ¼å¼å‚è§æ–‡æ¡£) 'access_token_setfunc': access token å†™å…¥å‡½æ•° (ç”¨äºŽå•æœºåŠåˆ†å¸ƒå¼çŽ¯å¢ƒä¸‹, å…·ä½“æ ¼å¼å‚è§æ–‡æ¡£) 'access_token_refreshfunc': access token åˆ·æ–°å‡½æ•° (ç”¨äºŽå•æœºåŠåˆ†å¸ƒå¼çŽ¯å¢ƒä¸‹, å…·ä½“æ ¼å¼å‚è§æ–‡æ¡£) 'access_token': ç›´æŽ¥å¯¼å…¥çš„ access token å€¼, è¯¥å€¼éœ€è¦åœ¨ä¸Šä¸€æ¬¡è¯¥ç±»å®žä¾‹åŒ–ä¹‹åŽæ‰‹åŠ¨è¿›è¡Œç¼“å­˜å¹¶åœ¨æ­¤å¤„ä¼ å…¥, å¦‚æžœä¸ ä¼ å…¥, å°†ä¼šåœ¨éœ€è¦æ—¶è‡ªåŠ¨é‡æ–°èŽ·å– (ä¼ å…¥ access_token_getfunc å’Œ access_token_setfunc å‡½æ•° åŽå°†ä¼šè‡ªåŠ¨å¿½ç•¥æ­¤å¤„çš„ä¼ å…¥å€¼) 'access_token_expires_at': ç›´æŽ¥å¯¼å…¥çš„ access token çš„è¿‡æœŸæ—¥æœŸ, è¯¥å€¼éœ€è¦åœ¨ä¸Šä¸€æ¬¡è¯¥ç±»å®žä¾‹åŒ–ä¹‹åŽæ‰‹åŠ¨è¿›è¡Œç¼“å­˜ å¹¶åœ¨æ­¤å¤„ä¼ å…¥, å¦‚æžœä¸ä¼ å…¥, å°†ä¼šåœ¨éœ€è¦æ—¶è‡ªåŠ¨é‡æ–°èŽ·å– (ä¼ å…¥ access_token_getfunc å’Œ access_token_setfunc å‡½æ•°åŽå°†ä¼šè‡ªåŠ¨å¿½ç•¥æ­¤å¤„çš„ä¼ å…¥å€¼) 'jsapi_ticket_getfunc': jsapi ticket èŽ·å–å‡½æ•° (ç”¨äºŽå•æœºåŠåˆ†å¸ƒå¼çŽ¯å¢ƒä¸‹, å…·ä½“æ ¼å¼å‚è§æ–‡æ¡£) 'jsapi_ticket_setfunc': jsapi ticket å†™å…¥å‡½æ•° (ç”¨äºŽå•æœºåŠåˆ†å¸ƒå¼çŽ¯å¢ƒä¸‹, å…·ä½“æ ¼å¼å‚è§æ–‡æ¡£) 'jsapi_ticket_refreshfunc': jsapi ticket åˆ·æ–°å‡½æ•° (ç”¨äºŽå•æœºåŠåˆ†å¸ƒå¼çŽ¯å¢ƒä¸‹, å…·ä½“æ ¼å¼å‚è§æ–‡æ¡£) 'jsapi_ticket': ç›´æŽ¥å¯¼å…¥çš„ jsapi ticket å€¼, è¯¥å€¼éœ€è¦åœ¨ä¸Šä¸€æ¬¡è¯¥ç±»å®žä¾‹åŒ–ä¹‹åŽæ‰‹åŠ¨è¿›è¡Œç¼“å­˜å¹¶åœ¨æ­¤å¤„ä¼ å…¥, å¦‚æžœä¸ ä¼ å…¥, å°†ä¼šåœ¨éœ€è¦æ—¶è‡ªåŠ¨é‡æ–°èŽ·å– (ä¼ å…¥ jsapi_ticket_getfunc å’Œ jsapi_ticket_setfunc å‡½æ•° åŽå°†ä¼šè‡ªåŠ¨å¿½ç•¥æ­¤å¤„çš„ä¼ å…¥å€¼) 'jsapi_ticket_expires_at': ç›´æŽ¥å¯¼å…¥çš„ jsapi ticket çš„è¿‡æœŸæ—¥æœŸ, è¯¥å€¼éœ€è¦åœ¨ä¸Šä¸€æ¬¡è¯¥ç±»å®žä¾‹åŒ–ä¹‹åŽæ‰‹åŠ¨è¿›è¡Œç¼“å­˜ å¹¶åœ¨æ­¤å¤„ä¼ å…¥, å¦‚æžœä¸ä¼ å…¥, å°†ä¼šåœ¨éœ€è¦æ—¶è‡ªåŠ¨é‡æ–°èŽ·å– (ä¼ å…¥ jsapi_ticket_getfunc å’Œ jsapi_ticket_setfunc å‡½æ•°åŽå°†ä¼šè‡ªåŠ¨å¿½ç•¥æ­¤å¤„çš„ä¼ å…¥å€¼) 'partnerid': è´¢ä»˜é€šå•†æˆ·èº«ä»½æ ‡è¯†, æ”¯ä»˜æƒé™ä¸“ç”¨ 'partnerkey': è´¢ä»˜é€šå•†æˆ·æƒé™å¯†é’¥ Key, æ”¯ä»˜æƒé™ä¸“ç”¨ 'paysignkey': å•†æˆ·ç­¾åå¯†é’¥ Key, æ”¯ä»˜æƒé™ä¸“ç”¨ 'checkssl': æ˜¯å¦æ£€æŸ¥ SSL, é»˜è®¤ä¸æ£€æŸ¥ (False), å¯é¿å… urllib3 çš„ InsecurePlatformWarning è­¦å‘Š :return: """ self.__request = WechatRequest() if kwargs.get('checkssl') is not True: disable_urllib3_warning() # å¯è§£å†³ InsecurePlatformWarning è­¦å‘Š self.__token = kwargs.get('token') self.__appid = kwargs.get('appid') self.__appsecret = kwargs.get('appsecret') self.__encrypt_mode = kwargs.get('encrypt_mode', 'safe') self.__encoding_aes_key = kwargs.get('encoding_aes_key') self.__crypto = None self._update_crypto() self.__access_token_getfunc = kwargs.get('access_token_getfunc') self.__access_token_setfunc = kwargs.get('access_token_setfunc') self.__access_token_refreshfunc = kwargs.get('access_token_refreshfunc') self.__access_token = kwargs.get('access_token') self.__access_token_expires_at = kwargs.get('access_token_expires_at') self.__jsapi_ticket_getfunc = kwargs.get('jsapi_ticket_getfunc') self.__jsapi_ticket_setfunc = kwargs.get('jsapi_ticket_setfunc') self.__jsapi_ticket_refreshfunc = kwargs.get('jsapi_ticket_refreshfunc') self.__jsapi_ticket = kwargs.get('jsapi_ticket') self.__jsapi_ticket_expires_at = kwargs.get('jsapi_ticket_expires_at') self.__partnerid = kwargs.get('partnerid') self.__partnerkey = kwargs.get('partnerkey') self.__paysignkey = kwargs.get('paysignkey') @property def token(self): """ èŽ·å–å½“å‰ Token """ self._check_token() return self.__token @token.setter def token(self, token): """ è®¾ç½®å½“å‰ Token """ self.__token = token self._update_crypto() # æ”¹åŠ¨ Token éœ€è¦é‡æ–°æ›´æ–° Crypto @property def appid(self): """ èŽ·å–å½“å‰ App ID """ return self.__appid @property def appsecret(self): """ èŽ·å–å½“å‰ App Secret """ return self.__appsecret def set_appid_appsecret(self, appid, appsecret): """ è®¾ç½®å½“å‰ App ID åŠ App Secret""" self.__appid = appid self.__appsecret = appsecret self._update_crypto() # æ”¹åŠ¨ App ID åŽéœ€è¦é‡æ–°æ›´æ–° Crypto @property def encoding_aes_key(self): """ èŽ·å–å½“å‰ EncodingAESKey """ return self.__encoding_aes_key @encoding_aes_key.setter def encoding_aes_key(self, encoding_aes_key): """ è®¾ç½®å½“å‰ EncodingAESKey """ self.__encoding_aes_key = encoding_aes_key self._update_crypto() # æ”¹åŠ¨ EncodingAESKey éœ€è¦é‡æ–°æ›´æ–° Crypto @property def encrypt_mode(self): return self.__encrypt_mode @encrypt_mode.setter def encrypt_mode(self, encrypt_mode): """ è®¾ç½®å½“å‰åŠ å¯†æ¨¡å¼ """ self.__encrypt_mode = encrypt_mode self._update_crypto() @property def crypto(self): """ èŽ·å–å½“å‰ Crypto å®žä¾‹ """ return self.__crypto @property def access_token(self): """ èŽ·å–å½“å‰ access token å€¼, æœ¬æ–¹æ³•ä¼šè‡ªè¡Œç»´æŠ¤ access token æœ‰æ•ˆæ€§ """ self._check_appid_appsecret() if callable(self.__access_token_getfunc): self.__access_token, self.__access_token_expires_at = self.__access_token_getfunc() if self.__access_token: now = time.time() if self.__access_token_expires_at - now &gt; 60: return self.__access_token self.grant_access_token() # ä»Žè…¾è®¯æœåŠ¡å™¨èŽ·å– access token å¹¶æ›´æ–° return self.__access_token @property def jsapi_ticket(self): """ èŽ·å–å½“å‰ jsapi ticket å€¼, æœ¬æ–¹æ³•ä¼šè‡ªè¡Œç»´æŠ¤ jsapi ticket æœ‰æ•ˆæ€§ """ self._check_appid_appsecret() if callable(self.__jsapi_ticket_getfunc): self.__jsapi_ticket, self.__jsapi_ticket_expires_at = self.__jsapi_ticket_getfunc() if self.__jsapi_ticket: now = time.time() if self.__jsapi_ticket_expires_at - now &gt; 60: return self.__jsapi_ticket self.grant_jsapi_ticket() # ä»Žè…¾è®¯æœåŠ¡å™¨èŽ·å– jsapi ticket å¹¶æ›´æ–° return self.__jsapi_ticket @property def partnerid(self): """ èŽ·å–å½“å‰è´¢ä»˜é€šå•†æˆ·èº«ä»½æ ‡è¯† """ return self.__partnerid @property def partnerkey(self): """ èŽ·å–å½“å‰è´¢ä»˜é€šå•†æˆ·æƒé™å¯†é’¥ Key """ return self.__partnerkey @property def paysignkey(self): """ èŽ·å–å•†æˆ·ç­¾åå¯†é’¥ Key """ return self.__paysignkey def grant_access_token(self): """ èŽ·å– access token å¹¶æ›´æ–°å½“å‰é…ç½® :return: è¿”å›žçš„ JSON æ•°æ®åŒ… (ä¼ å…¥ access_token_refreshfunc å‚æ•°åŽè¿”å›ž None) """ self._check_appid_appsecret() if callable(self.__access_token_refreshfunc): self.__access_token, self.__access_token_expires_at = self.__access_token_refreshfunc() return response_json = self.__request.get( url="https://api.weixin.qq.com/cgi-bin/token", params=&#123; "grant_type": "client_credential", "appid": self.__appid, "secret": self.__appsecret, &#125;, access_token=self.__access_token ) self.__access_token = response_json['access_token'] self.__access_token_expires_at = int(time.time()) + response_json['expires_in'] if callable(self.__access_token_setfunc): self.__access_token_setfunc(self.__access_token, self.__access_token_expires_at) return response_json def grant_jsapi_ticket(self): """ èŽ·å– jsapi ticket å¹¶æ›´æ–°å½“å‰é…ç½® :return: è¿”å›žçš„ JSON æ•°æ®åŒ… (ä¼ å…¥ jsapi_ticket_refreshfunc å‚æ•°åŽè¿”å›ž None) """ self._check_appid_appsecret() if callable(self.__jsapi_ticket_refreshfunc): self.__jsapi_ticket, self.__jsapi_ticket_expires_at = self.__jsapi_ticket_refreshfunc() return response_json = self.__request.get( url="https://api.weixin.qq.com/cgi-bin/ticket/getticket", params=&#123; "type": "jsapi", &#125;, access_token=self.access_token, ) self.__jsapi_ticket = response_json['ticket'] self.__jsapi_ticket_expires_at = int(time.time()) + response_json['expires_in'] if callable(self.__jsapi_ticket_setfunc): self.__jsapi_ticket_setfunc(self.__jsapi_ticket, self.__jsapi_ticket_expires_at) return response_json def get_access_token(self): """ èŽ·å– Access Token åŠ Access Token è¿‡æœŸæ—¥æœŸ, ä»…ä¾›ç¼“å­˜ä½¿ç”¨, å¦‚æžœå¸Œæœ›å¾—åˆ°åŽŸç”Ÿçš„ Access Token è¯·æ±‚æ•°æ®è¯·ä½¿ç”¨ :func:`grant_token` **ä»…ä¸ºå…¼å®¹ v0.6.0 ä»¥å‰ç‰ˆæœ¬ä½¿ç”¨, è‡ªè¡Œç»´æŠ¤ access_token è¯·ä½¿ç”¨ access_token_setfunc å’Œ access_token_getfunc è¿›è¡Œæ“ä½œ** :return: dict å¯¹è±¡, key åŒ…æ‹¬ `access_token` åŠ `access_token_expires_at` """ self._check_appid_appsecret() return &#123; 'access_token': self.access_token, 'access_token_expires_at': self.__access_token_expires_at, &#125; def get_jsapi_ticket(self): """ èŽ·å– Jsapi Ticket åŠ Jsapi Ticket è¿‡æœŸæ—¥æœŸ, ä»…ä¾›ç¼“å­˜ä½¿ç”¨, å¦‚æžœå¸Œæœ›å¾—åˆ°åŽŸç”Ÿçš„ Jsapi Ticket è¯·æ±‚æ•°æ®è¯·ä½¿ç”¨ :func:`grant_jsapi_ticket` **ä»…ä¸ºå…¼å®¹ v0.6.0 ä»¥å‰ç‰ˆæœ¬ä½¿ç”¨, è‡ªè¡Œç»´æŠ¤ jsapi_ticket è¯·ä½¿ç”¨ jsapi_ticket_setfunc å’Œ jsapi_ticket_getfunc è¿›è¡Œæ“ä½œ** :return: dict å¯¹è±¡, key åŒ…æ‹¬ `jsapi_ticket` åŠ `jsapi_ticket_expires_at` """ self._check_appid_appsecret() return &#123; 'jsapi_ticket': self.jsapi_ticket, 'jsapi_ticket_expires_at': self.__jsapi_ticket_expires_at, &#125; def _check_token(self): """ æ£€æŸ¥ Token æ˜¯å¦å­˜åœ¨ :raises NeedParamError: Token å‚æ•°æ²¡æœ‰åœ¨åˆå§‹åŒ–çš„æ—¶å€™æä¾› """ if not self.__token: raise NeedParamError('Please provide Token parameter in the construction of class.') def _check_appid_appsecret(self): """ æ£€æŸ¥ AppID å’Œ AppSecret æ˜¯å¦å­˜åœ¨ :raises NeedParamError: AppID æˆ– AppSecret å‚æ•°æ²¡æœ‰åœ¨åˆå§‹åŒ–çš„æ—¶å€™å®Œæ•´æä¾› """ if not self.__appid or not self.__appsecret: raise NeedParamError('Please provide app_id and app_secret parameters in the construction of class.') def _update_crypto(self): """ æ ¹æ®å½“å‰é…ç½®å†…å®¹æ›´æ–° Crypto ç±» """ if self.__encrypt_mode in ['compatible', 'safe'] and self.__encoding_aes_key is not None: if self.__token is None or self.__appid is None: raise NeedParamError('Please provide token and appid parameters in the construction of class.') self.__crypto = BasicCrypto(self.__token, self.__encoding_aes_key, self.__appid) else: self.__crypto = Noneæ€ç»´é”»ç‚¼è®¾è®¡è®²å¸ˆå’Œå­¦ç”Ÿç±»ï¼Œè®²å¸ˆæœ‰ä¸Šè¯¾ï¼Œå¤‡è¯¾ç­‰æ–¹æ³•ï¼Œå­¦ç”Ÿæœ‰å¬è¯¾ï¼Œåšç»ƒä¹ ç­‰æ–¹æ³•ï¼Œå‡æœ‰å§“åã€æ€§åˆ«ã€å¹´é¾„ç­‰åŸºæœ¬å±žæ€§è®¾è®¡èŠå¤©Messageç±»withä¸Žâ€œä¸Šä¸‹æ–‡ç®¡ç†å™¨â€å¦‚æžœä½ æœ‰é˜…è¯»æºç çš„ä¹ æƒ¯ï¼Œå¯èƒ½ä¼šçœ‹åˆ°ä¸€äº›ä¼˜ç§€çš„ä»£ç ç»å¸¸å‡ºçŽ°å¸¦æœ‰ â€œwithâ€ å…³é”®å­—çš„è¯­å¥ï¼Œå®ƒé€šå¸¸ç”¨åœ¨ä»€ä¹ˆåœºæ™¯å‘¢ï¼Ÿå¯¹äºŽç³»ç»Ÿèµ„æºå¦‚æ–‡ä»¶ã€æ•°æ®åº“è¿žæŽ¥ã€socket è€Œè¨€ï¼Œåº”ç”¨ç¨‹åºæ‰“å¼€è¿™äº›èµ„æºå¹¶æ‰§è¡Œå®Œä¸šåŠ¡é€»è¾‘ä¹‹åŽï¼Œå¿…é¡»åšçš„ä¸€ä»¶äº‹å°±æ˜¯è¦å…³é—­ï¼ˆæ–­å¼€ï¼‰è¯¥èµ„æºã€‚æ¯”å¦‚ Python ç¨‹åºæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œå¾€æ–‡ä»¶ä¸­å†™å†…å®¹ï¼Œå†™å®Œä¹‹åŽï¼Œå°±è¦å…³é—­è¯¥æ–‡ä»¶ï¼Œå¦åˆ™ä¼šå‡ºçŽ°ä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿæžç«¯æƒ…å†µä¸‹ä¼šå‡ºçŽ° â€œToo many open filesâ€ çš„é”™è¯¯ï¼Œå› ä¸ºç³»ç»Ÿå…è®¸ä½ æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æ•°é‡æ˜¯æœ‰é™çš„ã€‚åŒæ ·ï¼Œå¯¹äºŽæ•°æ®åº“ï¼Œå¦‚æžœè¿žæŽ¥æ•°è¿‡å¤šè€Œæ²¡æœ‰åŠæ—¶å…³é—­çš„è¯ï¼Œå°±å¯èƒ½ä¼šå‡ºçŽ° â€œCan not connect to MySQL server Too many connectionsâ€ï¼Œå› ä¸ºæ•°æ®åº“è¿žæŽ¥æ˜¯ä¸€ç§éžå¸¸æ˜‚è´µçš„èµ„æºï¼Œä¸å¯èƒ½æ— é™åˆ¶çš„è¢«åˆ›å»ºã€‚æ¥çœ‹çœ‹å¦‚ä½•æ­£ç¡®å…³é—­ä¸€ä¸ªæ–‡ä»¶ã€‚1. æ™®é€šç‰ˆ1234def m1(): f = open("output.txt", "w") f.write("pythonä¹‹ç¦…") f.close()è¿™æ ·å†™æœ‰ä¸€ä¸ªæ½œåœ¨çš„é—®é¢˜ï¼Œå¦‚æžœåœ¨è°ƒç”¨ write çš„è¿‡ç¨‹ä¸­ï¼Œå‡ºçŽ°äº†å¼‚å¸¸è¿›è€Œå¯¼è‡´åŽç»­ä»£ç æ— æ³•ç»§ç»­æ‰§è¡Œï¼Œclose æ–¹æ³•æ— æ³•è¢«æ­£å¸¸è°ƒç”¨ï¼Œå› æ­¤èµ„æºå°±ä¼šä¸€ç›´è¢«è¯¥ç¨‹åºå ç”¨è€…é‡Šæ”¾ã€‚é‚£ä¹ˆè¯¥å¦‚ä½•æ”¹è¿›ä»£ç å‘¢ï¼Ÿ2. è¿›é˜¶ç‰ˆ12345678def m2(): f = open("output.txt", "w") try: f.write("pythonä¹‹ç¦…") except IOError: print("oops error") finally: f.close()æ”¹è‰¯ç‰ˆæœ¬çš„ç¨‹åºæ˜¯å¯¹å¯èƒ½å‘ç”Ÿå¼‚å¸¸çš„ä»£ç å¤„è¿›è¡Œ try æ•èŽ·ï¼Œä½¿ç”¨ try/finally è¯­å¥ï¼Œè¯¥è¯­å¥è¡¨ç¤ºå¦‚æžœåœ¨ try ä»£ç å—ä¸­ç¨‹åºå‡ºçŽ°äº†å¼‚å¸¸ï¼ŒåŽç»­ä»£ç å°±ä¸å†æ‰§è¡Œï¼Œè€Œç›´æŽ¥è·³è½¬åˆ° except ä»£ç å—ã€‚è€Œæ— è®ºå¦‚ä½•ï¼Œfinally å—çš„ä»£ç æœ€ç»ˆéƒ½ä¼šè¢«æ‰§è¡Œã€‚å› æ­¤ï¼Œåªè¦æŠŠ close æ”¾åœ¨ finally ä»£ç ä¸­ï¼Œæ–‡ä»¶å°±ä¸€å®šä¼šå…³é—­ã€‚3. é«˜çº§ç‰ˆ123def m3(): with open("output.txt", "r") as f: f.write("Pythonä¹‹ç¦…")ä¸€ç§æ›´åŠ ç®€æ´ã€ä¼˜é›…çš„æ–¹å¼å°±æ˜¯ç”¨ with å…³é”®å­—ã€‚open æ–¹æ³•çš„è¿”å›žå€¼èµ‹å€¼ç»™å˜é‡ fï¼Œå½“ç¦»å¼€ with ä»£ç å—çš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è°ƒç”¨ f.close() æ–¹æ³•ï¼Œ with çš„ä½œç”¨å’Œä½¿ç”¨ try/finally è¯­å¥æ˜¯ä¸€æ ·çš„ã€‚é‚£ä¹ˆå®ƒçš„å®žçŽ°åŽŸç†æ˜¯ä»€ä¹ˆï¼Ÿåœ¨è®² with çš„åŽŸç†å‰è¦æ¶‰åŠåˆ°å¦å¤–ä¸€ä¸ªæ¦‚å¿µï¼Œå°±æ˜¯ä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼ˆContext Managerï¼‰ã€‚ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡(context)ä¸Šä¸‹æ–‡åœ¨ä¸åŒçš„åœ°æ–¹è¡¨ç¤ºä¸åŒçš„å«ä¹‰ï¼Œè¦æ„Ÿæ€§ç†è§£ã€‚contextå…¶å®žè¯´ç™½äº†ï¼Œå’Œæ–‡ç« çš„ä¸Šä¸‹æ–‡æ˜¯ä¸€ä¸ªæ„æ€ï¼Œåœ¨é€šä¿—ä¸€ç‚¹ï¼Œæˆ‘è§‰å¾—å«çŽ¯å¢ƒæ›´å¥½ã€‚â€¦.æž—å†²å¤§å«ä¸€å£°â€œå•Šä¹Ÿï¼â€â€¦.é—®:è¿™å¥è¯æž—å†²çš„â€œå•Šä¹Ÿâ€è¡¨è¾¾äº†æž—å†²æ€Žæ ·çš„å¿ƒé‡Œï¼Ÿç­”:å•Šä½ å¦ˆä¸ªå¤´å•Šï¼çœ‹ï¼Œä¸€ç¯‡æ–‡ç« ï¼Œç»™ä½ æ‘˜å½•ä¸€æ®µï¼Œæ²¡å‰æ²¡åŽï¼Œä½ è¯»ä¸æ‡‚ï¼Œå› ä¸ºæœ‰è¯­å¢ƒï¼Œå°±æ˜¯è¯­è¨€çŽ¯å¢ƒå­˜åœ¨ï¼Œä¸€æ®µè¯è¯´äº†ä»€ä¹ˆï¼Œè¦é€šè¿‡ä¸Šä¸‹æ–‡(æ–‡ç« çš„ä¸Šä¸‹æ–‡)æ¥æŽ¨æ–­ã€‚appç‚¹å‡»ä¸€ä¸ªæŒ‰é’®è¿›å…¥ä¸€ä¸ªæ–°çš„ç•Œé¢ï¼Œä¹Ÿè¦ä¿å­˜ä½ æ˜¯åœ¨å“ªä¸ªå±å¹•è·³è¿‡æ¥çš„ç­‰ç­‰ä¿¡æ¯ï¼Œä»¥ä¾¿ä½ ç‚¹å‡»è¿”å›žçš„æ—¶å€™èƒ½æ­£ç¡®è·³å›žï¼Œå¦‚æžœä¸å­˜è‚¯å®šå°±æ— æ³•æ­£ç¡®è·³å›žäº†ã€‚çœ‹è¿™äº›éƒ½æ˜¯ä¸Šä¸‹æ–‡çš„å…¸åž‹ä¾‹å­ï¼Œç†è§£æˆçŽ¯å¢ƒå°±å¯ä»¥ï¼Œ(è€Œä¸”ä¸Šä¸‹æ–‡è™½ç„¶å«ä¸Šä¸‹æ–‡ï¼Œä½†æ˜¯ç¨‹åºé‡Œé¢ä¸€èˆ¬éƒ½åªæœ‰ä¸Šæ–‡è€Œå·²ï¼Œåªæ˜¯å«çš„å¥½å¬å«ä¸Šä¸‹æ–‡ã€‚ã€‚è¿›ç¨‹ä¸­æ–­åœ¨æ“ä½œç³»ç»Ÿä¸­æ˜¯æœ‰ä¸Šæœ‰ä¸‹çš„ï¼Œä¸è¿‡ä¸è¿™ä¸ªé«˜æ·±çš„é—®é¢˜å°±ä¸è¦æ·±ç©¶äº†ã€‚ã€‚ã€‚)ä¸Šä¸‹æ–‡ç®¡ç†å™¨ä»»ä½•å®žçŽ°äº† __enter__() å’Œ __exit__() æ–¹æ³•çš„å¯¹è±¡éƒ½å¯ç§°ä¹‹ä¸ºä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼Œä¸Šä¸‹æ–‡ç®¡ç†å™¨å¯¹è±¡å¯ä»¥ä½¿ç”¨ with å…³é”®å­—ã€‚æ˜¾ç„¶ï¼Œæ–‡ä»¶ï¼ˆfileï¼‰å¯¹è±¡ä¹Ÿå®žçŽ°äº†ä¸Šä¸‹æ–‡ç®¡ç†å™¨ã€‚é‚£ä¹ˆæ–‡ä»¶å¯¹è±¡æ˜¯å¦‚ä½•å®žçŽ°è¿™ä¸¤ä¸ªæ–¹æ³•çš„å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥æ¨¡æ‹Ÿå®žçŽ°ä¸€ä¸ªè‡ªå·±çš„æ–‡ä»¶ç±»ï¼Œè®©è¯¥ç±»å®žçŽ° __enter__() å’Œ __exit__() æ–¹æ³•ã€‚1234567891011121314class File(): def __init__(self, filename, mode): self.filename = filename self.mode = mode def __enter__(self): print("entering") self.f = open(self.filename, self.mode) return self.f def __exit__(self, *args): print("will exit") self.f.close()__enter__() æ–¹æ³•è¿”å›žèµ„æºå¯¹è±¡ï¼Œè¿™é‡Œå°±æ˜¯ä½ å°†è¦æ‰“å¼€çš„é‚£ä¸ªæ–‡ä»¶å¯¹è±¡ï¼Œ__exit__() æ–¹æ³•å¤„ç†ä¸€äº›æ¸…é™¤å·¥ä½œã€‚å› ä¸º File ç±»å®žçŽ°äº†ä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼ŒçŽ°åœ¨å°±å¯ä»¥ä½¿ç”¨ with è¯­å¥äº†ã€‚123with File('out.txt', 'w') as f: print("writing") f.write('hello, python')è¿™æ ·ï¼Œä½ å°±æ— éœ€æ˜¾ç¤ºåœ°è°ƒç”¨ close æ–¹æ³•äº†ï¼Œç”±ç³»ç»Ÿè‡ªåŠ¨åŽ»è°ƒç”¨ï¼Œå“ªæ€•ä¸­é—´é‡åˆ°å¼‚å¸¸ close æ–¹æ³•ä¹Ÿä¼šè¢«è°ƒç”¨ã€‚å®žçŽ°ä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„å¦å¤–æ–¹å¼Python è¿˜æä¾›äº†ä¸€ä¸ª contextmanager çš„è£…é¥°å™¨ï¼Œæ›´è¿›ä¸€æ­¥ç®€åŒ–äº†ä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„å®žçŽ°æ–¹å¼ã€‚é€šè¿‡ yield å°†å‡½æ•°åˆ†å‰²æˆä¸¤éƒ¨åˆ†ï¼Œyield ä¹‹å‰çš„è¯­å¥åœ¨ enter æ–¹æ³•ä¸­æ‰§è¡Œï¼Œyield ä¹‹åŽçš„è¯­å¥åœ¨ exit æ–¹æ³•ä¸­æ‰§è¡Œã€‚ç´§è·Ÿåœ¨ yield åŽé¢çš„å€¼æ˜¯å‡½æ•°çš„è¿”å›žå€¼ã€‚1234567from contextlib import contextmanager@contextmanagerdef my_open(path, mode): f = open(path, mode) yield f f.close()è°ƒç”¨12with my_open('out.txt', 'w') as f: f.write("hello , the simplest context manager")æ€»ç»“Python æä¾›äº† with è¯­æ³•ç”¨äºŽç®€åŒ–èµ„æºæ“ä½œçš„åŽç»­æ¸…é™¤æ“ä½œï¼Œæ˜¯ try/finally çš„æ›¿ä»£æ–¹æ³•ï¼Œå®žçŽ°åŽŸç†å»ºç«‹åœ¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨ä¹‹ä¸Šã€‚æ­¤å¤–ï¼ŒPython è¿˜æä¾›äº†ä¸€ä¸ª contextmanager è£…é¥°å™¨ï¼Œæ›´è¿›ä¸€æ­¥ç®€åŒ–ä¸Šä¸‹ç®¡ç†å™¨çš„å®žçŽ°æ–¹å¼ã€‚â€»argsã€â€»â€»kwargsçš„å¦å¤–ç”¨å¤„æ‹†åŒ…1234567891011121314def test1(a,b,*args,**kwargs): print(a) print(b) print(args) # ä»¥å…ƒç»„å½¢å¼è¾“å‡ºç»“æžœ print(kwargs) # ä»¥å­—å…¸å½¢å¼è¾“å‡ºç»“æžœtest1(11,22,33,44,55,name='haha',age=34)'''è¾“å‡ºç»“æžœ1122(33, 44, 55)&#123;'name': 'haha', 'age': 34&#125;'''123456789101112131415161718192021222324252627def test2(a,b,*args,**kwargs): print(a) print(b) print(args) # ä»¥å…ƒç»„å½¢å¼è¾“å‡ºç»“æžœ print(kwargs) # ä»¥å­—å…¸å½¢å¼è¾“å‡ºç»“æžœdef test1(a,b,*args,**kwargs): print(a) print(b) print(args) # ä»¥å…ƒç»„å½¢å¼è¾“å‡ºç»“æžœ print(kwargs) # ä»¥å­—å…¸å½¢å¼è¾“å‡ºç»“æžœ print('---' * 10) test2(a,b)test1(11,22,33,44,55,name='haha',age=34)'''1122(33, 44, 55)&#123;'name': 'haha', 'age': 34&#125;`------------------------------`1122()&#123;&#125;'''123456789101112131415161718192021222324252627282930def test2(a,b,*args,**kwargs): print(a) print(b) print(args) # ä»¥å…ƒç»„å½¢å¼è¾“å‡ºç»“æžœ print(kwargs) # ä»¥å­—å…¸å½¢å¼è¾“å‡ºç»“æžœdef test1(a,b,*args,**kwargs): print(a) print(b) print(args) # ä»¥å…ƒç»„å½¢å¼è¾“å‡ºç»“æžœ print(kwargs) # ä»¥å­—å…¸å½¢å¼è¾“å‡ºç»“æžœ print('---' * 10) test2(a,b,args,kwargs) # ç›¸å½“äºŽtest2(11,22,(33, 44, 55),&#123;'name': 'haha', 'age': 34&#125;) # æ³¨æ„è¿™æ ·å†™çš„ç»“æžœå¦‚ä¸‹ï¼š((33, 44, 55), &#123;'name': 'haha', 'age': 34&#125;) # ä¸ºä»€ä¹ˆä¼šæ˜¯è¿™æ ·çš„ä¸€ä¸ªç»“æžœå‘¢ï¼Ÿ # æ˜¯å› ä¸ºåœ¨å‡½æ•°test1ä¸­ï¼Œargså’Œkwargså·²ç»æ˜¯ä¸€ä¸ªå˜é‡å€¼äº†ï¼Œç„¶åŽä¼ é€’ç»™test2å‡½æ•°ï¼Œè¢«*argsæŽ¥æ”¶è¿‡åŽ»ã€‚test1(11,22,33,44,55,name='haha',age=34)'''1122(33, 44, 55)&#123;'name': 'haha', 'age': 34&#125;`------------------------------`1122((33, 44, 55), &#123;'name': 'haha', 'age': 34&#125;)&#123;&#125;'''1234567891011121314151617181920212223242526272829303132def test2(a,b,*args,**kwargs): print(a) print(b) print(args) # ä»¥å…ƒç»„å½¢å¼è¾“å‡ºç»“æžœ print(kwargs) # ä»¥å­—å…¸å½¢å¼è¾“å‡ºç»“æžœdef test1(a,b,*args,**kwargs): print(a) print(b) print(args) # ä»¥å…ƒç»„å½¢å¼è¾“å‡ºç»“æžœ print(kwargs) # ä»¥å­—å…¸å½¢å¼è¾“å‡ºç»“æžœ print('---' * 10) # test2(a,b,args,kwargs) # ç›¸å½“äºŽtest2(11,22,(33, 44, 55),&#123;'name': 'haha', 'age': 34&#125;) # test2(a,b,*args,kwargs) # ç›¸å½“äºŽtest2(11,22,33,44,55,&#123;'name': 'haha', 'age': 34&#125;) test2(a,b,*args,**kwargs) # æ³¨æ„è¿™æ ·çš„å†™æ³•ï¼Œç›¸å½“äºŽtest2(11,22,33,44,55,name='haha',age=34) # ç»“æžœæ˜¯ï¼š # (33, 44, 55) # &#123;'name': 'haha', 'age': 34&#125;test1(11,22,33,44,55,name='haha',age=34)'''1122(33, 44, 55)&#123;'name': 'haha', 'age': 34&#125;`------------------------------`1122(33, 44, 55)&#123;'name': 'haha', 'age': 34&#125;''']]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python_å¼‚å¸¸]]></title>
    <url>%2F2019%2F12%2F31%2Fpython_%E5%BC%82%E5%B8%B8%2F</url>
    <content type="text"><![CDATA[å¼‚å¸¸01. å¼‚å¸¸çš„æ¦‚å¿µç¨‹åºåœ¨è¿è¡Œæ—¶ï¼Œå¦‚æžœ Python è§£é‡Šå™¨ é‡åˆ° åˆ°ä¸€ä¸ªé”™è¯¯ï¼Œä¼šåœæ­¢ç¨‹åºçš„æ‰§è¡Œï¼Œå¹¶ä¸”æç¤ºä¸€äº›é”™è¯¯ä¿¡æ¯ï¼Œè¿™å°±æ˜¯ å¼‚å¸¸ç¨‹åºåœæ­¢æ‰§è¡Œå¹¶ä¸”æç¤ºé”™è¯¯ä¿¡æ¯ è¿™ä¸ªåŠ¨ä½œï¼Œæˆ‘ä»¬é€šå¸¸ç§°ä¹‹ä¸ºï¼šæŠ›å‡º(raise)å¼‚å¸¸ç¨‹åºå¼€å‘æ—¶ï¼Œå¾ˆéš¾å°† æ‰€æœ‰çš„ç‰¹æ®Šæƒ…å†µ éƒ½å¤„ç†çš„é¢é¢ä¿±åˆ°ï¼Œé€šè¿‡ å¼‚å¸¸æ•èŽ· å¯ä»¥é’ˆå¯¹çªå‘äº‹ä»¶åšé›†ä¸­çš„å¤„ç†ï¼Œä»Žè€Œä¿è¯ç¨‹åºçš„ ç¨³å®šæ€§å’Œå¥å£®æ€§02. æ•èŽ·å¼‚å¸¸2.1 ç®€å•çš„æ•èŽ·å¼‚å¸¸è¯­æ³•åœ¨ç¨‹åºå¼€å‘ä¸­ï¼Œå¦‚æžœ å¯¹æŸäº›ä»£ç çš„æ‰§è¡Œä¸èƒ½ç¡®å®šæ˜¯å¦æ­£ç¡®ï¼Œå¯ä»¥å¢žåŠ  try(å°è¯•) æ¥ æ•èŽ·å¼‚å¸¸æ•èŽ·å¼‚å¸¸æœ€ç®€å•çš„è¯­æ³•æ ¼å¼ï¼š1234try: å°è¯•æ‰§è¡Œçš„ä»£ç except: å‡ºçŽ°é”™è¯¯çš„å¤„ç†try å°è¯•ï¼Œä¸‹æ–¹ç¼–å†™è¦å°è¯•ä»£ç ï¼Œä¸ç¡®å®šæ˜¯å¦èƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œçš„ä»£ç except å¦‚æžœä¸æ˜¯ï¼Œä¸‹æ–¹ç¼–å†™å°è¯•å¤±è´¥çš„ä»£ç ç®€å•å¼‚å¸¸æ•èŽ·æ¼”ç»ƒ â€”â€” è¦æ±‚ç”¨æˆ·è¾“å…¥æ•´æ•°12345try: # æç¤ºç”¨æˆ·è¾“å…¥ä¸€ä¸ªæ•°å­— num = int(input("è¯·è¾“å…¥æ•°å­—ï¼š"))except: print("è¯·è¾“å…¥æ­£ç¡®çš„æ•°å­—")2.2 é”™è¯¯ç±»åž‹æ•èŽ·åœ¨ç¨‹åºæ‰§è¡Œæ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ° ä¸åŒç±»åž‹çš„å¼‚å¸¸ï¼Œå¹¶ä¸”éœ€è¦ é’ˆå¯¹ä¸åŒç±»åž‹çš„å¼‚å¸¸ï¼Œåšå‡ºä¸åŒçš„å“åº”ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå°±éœ€è¦æ•èŽ·é”™è¯¯ç±»åž‹äº†è¯­æ³•å¦‚ä¸‹:1234567891011try: # å°è¯•æ‰§è¡Œçš„ä»£ç  passexcept é”™è¯¯ç±»åž‹1: # é’ˆå¯¹é”™è¯¯ç±»åž‹1ï¼Œå¯¹åº”çš„ä»£ç å¤„ç† passexcept (é”™è¯¯ç±»åž‹2, é”™è¯¯ç±»åž‹3): # é’ˆå¯¹é”™è¯¯ç±»åž‹2 å’Œ 3ï¼Œå¯¹åº”çš„ä»£ç å¤„ç† passexcept Exception as result: print("æœªçŸ¥é”™è¯¯ %s" % result)å½“ Python è§£é‡Šå™¨ æŠ›å‡ºå¼‚å¸¸ æ—¶ï¼Œæœ€åŽä¸€è¡Œé”™è¯¯ä¿¡æ¯çš„ç¬¬ä¸€ä¸ªå•è¯ï¼Œå°±æ˜¯é”™è¯¯ç±»åž‹å¼‚å¸¸ç±»åž‹æ•èŽ·æ¼”ç»ƒ â€”â€” è¦æ±‚ç”¨æˆ·è¾“å…¥æ•´æ•°éœ€æ±‚æç¤ºç”¨æˆ·è¾“å…¥ä¸€ä¸ªæ•´æ•°ä½¿ç”¨ 8 é™¤ä»¥ç”¨æˆ·è¾“å…¥çš„æ•´æ•°å¹¶ä¸”è¾“å‡º12345678try: num = int(input("è¯·è¾“å…¥æ•´æ•°ï¼š")) result = 8 / num print(result)except ValueError: print("è¯·è¾“å…¥æ­£ç¡®çš„æ•´æ•°")except ZeroDivisionError: print("é™¤ 0 é”™è¯¯")æ•èŽ·æœªçŸ¥é”™è¯¯åœ¨å¼€å‘æ—¶ï¼Œè¦é¢„åˆ¤åˆ°æ‰€æœ‰å¯èƒ½å‡ºçŽ°çš„é”™è¯¯ï¼Œè¿˜æ˜¯æœ‰ä¸€å®šéš¾åº¦çš„å¦‚æžœå¸Œæœ›ç¨‹åº æ— è®ºå‡ºçŽ°ä»»ä½•é”™è¯¯ï¼Œéƒ½ä¸ä¼šå› ä¸º Python è§£é‡Šå™¨ æŠ›å‡ºå¼‚å¸¸è€Œè¢«ç»ˆæ­¢ï¼Œå¯ä»¥å†å¢žåŠ ä¸€ä¸ª exceptè¯­æ³•å¦‚ä¸‹:12except Exception as result: print("æœªçŸ¥é”™è¯¯ %s" % result)2.3 å¼‚å¸¸æ•èŽ·å®Œæ•´è¯­æ³•åœ¨å®žé™…å¼€å‘ä¸­ï¼Œä¸ºäº†èƒ½å¤Ÿå¤„ç†å¤æ‚çš„å¼‚å¸¸æƒ…å†µï¼Œå®Œæ•´çš„å¼‚å¸¸è¯­æ³•å¦‚ä¸‹ï¼š123456789101112131415161718192021try: # å°è¯•æ‰§è¡Œçš„ä»£ç  passexcept é”™è¯¯ç±»åž‹1: # é’ˆå¯¹é”™è¯¯ç±»åž‹1ï¼Œå¯¹åº”çš„ä»£ç å¤„ç† passexcept é”™è¯¯ç±»åž‹2: # é’ˆå¯¹é”™è¯¯ç±»åž‹2ï¼Œå¯¹åº”çš„ä»£ç å¤„ç† passexcept (é”™è¯¯ç±»åž‹3, é”™è¯¯ç±»åž‹4): # é’ˆå¯¹é”™è¯¯ç±»åž‹3 å’Œ 4ï¼Œå¯¹åº”çš„ä»£ç å¤„ç† passexcept Exception as result: # æ‰“å°é”™è¯¯ä¿¡æ¯ print(result)else: # æ²¡æœ‰å¼‚å¸¸æ‰ä¼šæ‰§è¡Œçš„ä»£ç  passfinally: # æ— è®ºæ˜¯å¦æœ‰å¼‚å¸¸ï¼Œéƒ½ä¼šæ‰§è¡Œçš„ä»£ç  print("æ— è®ºæ˜¯å¦æœ‰å¼‚å¸¸ï¼Œéƒ½ä¼šæ‰§è¡Œçš„ä»£ç ")else åªæœ‰åœ¨æ²¡æœ‰å¼‚å¸¸æ—¶æ‰ä¼šæ‰§è¡Œçš„ä»£ç finally æ— è®ºæ˜¯å¦æœ‰å¼‚å¸¸ï¼Œéƒ½ä¼šæ‰§è¡Œçš„ä»£ç 1234567891011121314try: num = int(input("è¯·è¾“å…¥æ•´æ•°ï¼š")) result = 8 / num print(result)except ValueError: print("è¯·è¾“å…¥æ­£ç¡®çš„æ•´æ•°")except ZeroDivisionError: print("é™¤ 0 é”™è¯¯")except Exception as result: print("æœªçŸ¥é”™è¯¯ %s" % result)else: print("æ­£å¸¸æ‰§è¡Œ")finally: print("æ‰§è¡Œå®Œæˆï¼Œä½†æ˜¯ä¸ä¿è¯æ­£ç¡®")03. å¼‚å¸¸çš„ä¼ é€’å¼‚å¸¸çš„ä¼ é€’ â€”â€” å½“ å‡½æ•°/æ–¹æ³• æ‰§è¡Œ å‡ºçŽ°å¼‚å¸¸ï¼Œä¼š å°†å¼‚å¸¸ä¼ é€’ ç»™ å‡½æ•°/æ–¹æ³• çš„ è°ƒç”¨ä¸€æ–¹å¦‚æžœ ä¼ é€’åˆ°ä¸»ç¨‹åºï¼Œä»ç„¶ æ²¡æœ‰å¼‚å¸¸å¤„ç†ï¼Œç¨‹åºæ‰ä¼šè¢«ç»ˆæ­¢æç¤ºåœ¨å¼€å‘ä¸­ï¼Œå¯ä»¥åœ¨ä¸»å‡½æ•°ä¸­å¢žåŠ  å¼‚å¸¸æ•èŽ·è€Œåœ¨ä¸»å‡½æ•°ä¸­è°ƒç”¨çš„å…¶ä»–å‡½æ•°ï¼Œåªè¦å‡ºçŽ°å¼‚å¸¸ï¼Œéƒ½ä¼šä¼ é€’åˆ°ä¸»å‡½æ•°çš„ å¼‚å¸¸æ•èŽ· ä¸­è¿™æ ·å°±ä¸éœ€è¦åœ¨ä»£ç ä¸­ï¼Œå¢žåŠ å¤§é‡çš„ å¼‚å¸¸æ•èŽ·ï¼Œèƒ½å¤Ÿä¿è¯ä»£ç çš„æ•´æ´éœ€æ±‚å®šä¹‰å‡½æ•° demo1() æç¤ºç”¨æˆ·è¾“å…¥ä¸€ä¸ªæ•´æ•°å¹¶ä¸”è¿”å›žå®šä¹‰å‡½æ•° demo2() è°ƒç”¨ demo1()åœ¨ä¸»ç¨‹åºä¸­è°ƒç”¨ demo2()12345678910111213def demo1(): return int(input("è¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼š"))def demo2(): return demo1()try: print(demo2())except ValueError: print("è¯·è¾“å…¥æ­£ç¡®çš„æ•´æ•°")except Exception as result: print("æœªçŸ¥é”™è¯¯ %s" % result)04. æŠ›å‡º raise å¼‚å¸¸4.1 åº”ç”¨åœºæ™¯åœ¨å¼€å‘ä¸­ï¼Œé™¤äº† ä»£ç æ‰§è¡Œå‡ºé”™ Python è§£é‡Šå™¨ä¼š æŠ›å‡º å¼‚å¸¸ä¹‹å¤–è¿˜å¯ä»¥æ ¹æ® åº”ç”¨ç¨‹åº ç‰¹æœ‰çš„ä¸šåŠ¡éœ€æ±‚ ä¸»åŠ¨æŠ›å‡ºå¼‚å¸¸ç¤ºä¾‹æç¤ºç”¨æˆ· è¾“å…¥å¯†ç ï¼Œå¦‚æžœ é•¿åº¦å°‘äºŽ 8ï¼ŒæŠ›å‡º å¼‚å¸¸4.2 æŠ›å‡ºå¼‚å¸¸Python ä¸­æä¾›äº†ä¸€ä¸ª Exception å¼‚å¸¸ç±»åœ¨å¼€å‘æ—¶ï¼Œå¦‚æžœæ»¡è¶³ ç‰¹å®šä¸šåŠ¡éœ€æ±‚æ—¶ï¼Œå¸Œæœ› æŠ›å‡ºå¼‚å¸¸ï¼Œå¯ä»¥ï¼šåˆ›å»º ä¸€ä¸ª Exception çš„ å¯¹è±¡ä½¿ç”¨ raise å…³é”®å­— æŠ›å‡º å¼‚å¸¸å¯¹è±¡éœ€æ±‚å®šä¹‰ input_password å‡½æ•°ï¼Œæç¤ºç”¨æˆ·è¾“å…¥å¯†ç ç”¨æˆ·è¾“å…¥é•¿åº¦ &lt; 8ï¼ŒæŠ›å‡ºå¼‚å¸¸ç”¨æˆ·è¾“å…¥é•¿åº¦ &gt;=8ï¼Œè¿”å›žè¾“å…¥çš„å¯†ç 12345678910111213141516171819202122def input_password(): # 1. æç¤ºç”¨æˆ·è¾“å…¥å¯†ç  pwd = input("è¯·è¾“å…¥å¯†ç ï¼š") # 2. åˆ¤æ–­å¯†ç é•¿åº¦ï¼Œå¦‚æžœé•¿åº¦ &gt;= 8ï¼Œè¿”å›žç”¨æˆ·è¾“å…¥çš„å¯†ç  if len(pwd) &gt;= 8: return pwd # 3. å¯†ç é•¿åº¦ä¸å¤Ÿï¼Œéœ€è¦æŠ›å‡ºå¼‚å¸¸ # 1&gt; åˆ›å»ºå¼‚å¸¸å¯¹è±¡ - ä½¿ç”¨å¼‚å¸¸çš„é”™è¯¯ä¿¡æ¯å­—ç¬¦ä¸²ä½œä¸ºå‚æ•° ex = Exception("å¯†ç é•¿åº¦ä¸å¤Ÿ") # 2&gt; æŠ›å‡ºå¼‚å¸¸å¯¹è±¡ raise extry: user_pwd = input_password() print(user_pwd)except Exception as result: print("å‘çŽ°é”™è¯¯ï¼š%s" % result)]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SecureFXè¿žæŽ¥LinuxåŽæ–‡ä»¶å¤¹ä¸­æ–‡ä¹±ç é—®é¢˜è§£å†³]]></title>
    <url>%2F2019%2F12%2F31%2FSecureFX%E8%BF%9E%E6%8E%A5Linux%E5%90%8E%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%2F</url>
    <content type="text"><![CDATA[åœ¨é€‰é¡¹ä¸­è®¾ç½®å­—ç¬¦ç¼–ç ä¸ºUTF-8åœ¨å…¨å±€é€‰é¡¹ä¸­æ‰¾åˆ°Securefxçš„é…ç½®æ–‡ä»¶è¿›å…¥åˆ°è¯¥ç›®å½•ä¸­ï¼Œé€‰æ‹©â€œSessionsâ€åœ¨â€œSessionsâ€ä¸­æ‰¾åˆ°å½“å‰è¿žæŽ¥linuxæœåŠ¡å™¨åœ°å€çš„iniæ–‡ä»¶ï¼Œå¹¶ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ã€‚ åœ¨æ‰“å¼€çš„iniæ–‡ä»¶ä¸­ï¼ŒæŸ¥æ‰¾ï¼šFilenames Always Use UTF8ï¼›Filenames Always Use UTF8åŽé¢çš„å€¼ä¿®æ”¹ä¸ºï¼š00000001ï¼Œä¿å­˜é€€å‡ºï¼› å†æ¬¡æ‰“å¼€SecureFXï¼Œè¿›å…¥åˆ°å«æœ‰ä¸­æ–‡åç§°çš„æ–‡ä»¶ç›®å½•ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å«æœ‰ä¸­æ–‡åç§°çš„æ–‡ä»¶å·²ç»èƒ½å¤Ÿæ­£å¸¸æ˜¾ç¤ºäº†ã€‚]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>SecureFX</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Redis]]></title>
    <url>%2F2019%2F12%2F31%2FRedis%2F</url>
    <content type="text"><![CDATA[1. ç®€ä»‹1.1 nosqlä»‹ç»NoSQLï¼šä¸€ç±»æ–°å‡ºçŽ°çš„æ•°æ®åº“(not only sql)ï¼Œç‰¹ç‚¹å¦‚ä¸‹ï¼šä¸æ”¯æŒSQLè¯­æ³•å­˜å‚¨ç»“æž„è·Ÿä¼ ç»Ÿå…³ç³»åž‹æ•°æ®åº“ä¸­çš„é‚£ç§å…³ç³»è¡¨å®Œå…¨ä¸åŒï¼Œnosqlä¸­å­˜å‚¨çš„æ•°æ®éƒ½æ˜¯KVå½¢å¼NoSQLçš„ä¸–ç•Œä¸­æ²¡æœ‰ä¸€ç§é€šç”¨çš„è¯­è¨€ï¼Œæ¯ç§nosqlæ•°æ®åº“éƒ½æœ‰è‡ªå·±çš„apiå’Œè¯­æ³•ï¼Œä»¥åŠæ“…é•¿çš„ä¸šåŠ¡åœºæ™¯NoSQLä¸­çš„äº§å“ç§ç±»ç›¸å½“å¤šï¼šMongodbRedisHbase hadoopCassandra hadoop1.2 NoSQLå’ŒSQLæ•°æ®åº“çš„æ¯”è¾ƒé€‚ç”¨åœºæ™¯ä¸åŒï¼šsqlæ•°æ®åº“é€‚åˆç”¨äºŽå…³ç³»ç‰¹åˆ«å¤æ‚çš„æ•°æ®æŸ¥è¯¢åœºæ™¯ï¼Œnosqlåä¹‹â€œäº‹åŠ¡â€ç‰¹æ€§çš„æ”¯æŒï¼šsqlå¯¹äº‹åŠ¡çš„æ”¯æŒéžå¸¸å®Œå–„ï¼Œè€ŒnosqlåŸºæœ¬ä¸æ”¯æŒäº‹åŠ¡ä¸¤è€…åœ¨ä¸æ–­åœ°å–é•¿è¡¥çŸ­ï¼Œå‘ˆçŽ°èžåˆè¶‹åŠ¿1.3 Redisç®€ä»‹Redisæ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨ANSI Cè¯­è¨€ç¼–å†™ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºŽå†…å­˜äº¦å¯æŒä¹…åŒ–çš„æ—¥å¿—åž‹ã€Key-Valueæ•°æ®åº“ï¼Œå¹¶æä¾›å¤šç§è¯­è¨€çš„APIã€‚ä»Ž2010å¹´3æœˆ15æ—¥èµ·ï¼ŒRedisçš„å¼€å‘å·¥ä½œç”±VMwareä¸»æŒã€‚ä»Ž2013å¹´5æœˆå¼€å§‹ï¼ŒRedisçš„å¼€å‘ç”±PivotalèµžåŠ©ã€‚Redisæ˜¯ NoSQLæŠ€æœ¯é˜µè¥ä¸­çš„ä¸€å‘˜ï¼Œå®ƒé€šè¿‡å¤šç§é”®å€¼æ•°æ®ç±»åž‹æ¥é€‚åº”ä¸åŒåœºæ™¯ä¸‹çš„å­˜å‚¨éœ€æ±‚ï¼Œå€ŸåŠ©ä¸€äº›é«˜å±‚çº§çš„æŽ¥å£ä½¿ç”¨å…¶å¯ä»¥èƒœä»»ï¼Œå¦‚ç¼“å­˜ã€é˜Ÿåˆ—ç³»ç»Ÿçš„ä¸åŒè§’è‰²1.4 Redisç‰¹æ€§Redis ä¸Žå…¶ä»– key - value ç¼“å­˜äº§å“æœ‰ä»¥ä¸‹ä¸‰ä¸ªç‰¹ç‚¹ï¼šRedisæ”¯æŒæ•°æ®çš„æŒä¹…åŒ–ï¼Œå¯ä»¥å°†å†…å­˜ä¸­çš„æ•°æ®ä¿å­˜åœ¨ç£ç›˜ä¸­ï¼Œé‡å¯çš„æ—¶å€™å¯ä»¥å†æ¬¡åŠ è½½è¿›è¡Œä½¿ç”¨ã€‚Redisä¸ä»…ä»…æ”¯æŒç®€å•çš„key-valueç±»åž‹çš„æ•°æ®ï¼ŒåŒæ—¶è¿˜æä¾›listï¼Œsetï¼Œzsetï¼Œhashç­‰æ•°æ®ç»“æž„çš„å­˜å‚¨ã€‚Redisæ”¯æŒæ•°æ®çš„å¤‡ä»½ï¼Œå³master-slaveæ¨¡å¼çš„æ•°æ®å¤‡ä»½ã€‚1.5 Redis ä¼˜åŠ¿æ€§èƒ½æžé«˜ â€“ Redisèƒ½è¯»çš„é€Ÿåº¦æ˜¯110000æ¬¡/s,å†™çš„é€Ÿåº¦æ˜¯81000æ¬¡/s ã€‚ä¸°å¯Œçš„æ•°æ®ç±»åž‹ â€“ Redisæ”¯æŒäºŒè¿›åˆ¶æ¡ˆä¾‹çš„ Strings, Lists, Hashes, Sets åŠ Ordered Sets æ•°æ®ç±»åž‹æ“ä½œã€‚åŽŸå­ â€“ Redisçš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯åŽŸå­æ€§çš„ï¼ŒåŒæ—¶Redisè¿˜æ”¯æŒå¯¹å‡ ä¸ªæ“ä½œå…¨å¹¶åŽçš„åŽŸå­æ€§æ‰§è¡Œã€‚ä¸°å¯Œçš„ç‰¹æ€§ â€“ Redisè¿˜æ”¯æŒ publish/subscribe, é€šçŸ¥, key è¿‡æœŸç­‰ç­‰ç‰¹æ€§ã€‚1.6 Redis åº”ç”¨åœºæ™¯ç”¨æ¥åšç¼“å­˜(ehcache/memcached)â€”â€”redisçš„æ‰€æœ‰æ•°æ®æ˜¯æ”¾åœ¨å†…å­˜ä¸­çš„ï¼ˆå†…å­˜æ•°æ®åº“ï¼‰å¯ä»¥åœ¨æŸäº›ç‰¹å®šåº”ç”¨åœºæ™¯ä¸‹æ›¿ä»£ä¼ ç»Ÿæ•°æ®åº“â€”â€”æ¯”å¦‚ç¤¾äº¤ç±»çš„åº”ç”¨åœ¨ä¸€äº›å¤§åž‹ç³»ç»Ÿä¸­ï¼Œå·§å¦™åœ°å®žçŽ°ä¸€äº›ç‰¹å®šçš„åŠŸèƒ½ï¼šsessionå…±äº«ã€è´­ç‰©è½¦åªè¦ä½ æœ‰ä¸°å¯Œçš„æƒ³è±¡åŠ›ï¼Œrediså¯ä»¥ç”¨åœ¨å¯ä»¥ç»™ä½ æ— é™çš„æƒŠå–œâ€¦â€¦.1.7 æŽ¨èé˜…è¯»[rediså®˜æ–¹ç½‘ç«™] https://redis.io/[redisä¸­æ–‡å®˜ç½‘] http://redis.cn/2. å®‰è£…2.1 ä¸‹è½½Redis ç‰ˆæœ¬å·é‡‡ç”¨æ ‡å‡†æƒ¯ä¾‹ï¼šä¸»ç‰ˆæœ¬å·.å‰¯ç‰ˆæœ¬å·.è¡¥ä¸çº§åˆ«,ä¸€ä¸ªå‰¯ç‰ˆæœ¬å·å°±æ ‡è®°ä¸ºä¸€ä¸ªæ ‡å‡†å‘è¡Œç‰ˆæœ¬ï¼Œä¾‹å¦‚ 1.2ï¼Œ2.0ï¼Œ2.2ï¼Œ2.4ï¼Œ2.6ï¼Œ2.8ï¼Œå¥‡æ•°çš„å‰¯ç‰ˆæœ¬å·ç”¨æ¥è¡¨ç¤ºéžæ ‡å‡†ç‰ˆæœ¬,ä¾‹å¦‚2.9.xï¼Œå‘è¡Œç‰ˆæœ¬æ˜¯Redis 3.0ã€‚æœ€æ–°ç¨³å®šç‰ˆæœ¬æ˜¯5.0.4ï¼Œä¸‹è½½é“¾æŽ¥ï¼šhttp://download.redis.io/releases/redis-5.0.4.tar.gzsetp1ï¼šä¸‹è½½ï¼šwget http://download.redis.io/releases/redis-5.0.4.tar.gzsetp2ï¼šè§£åŽ‹ï¼štar -zxvf redis-5.0.4.tar.gzsetp3ï¼šè¿›å…¥åˆ°Redisç›®å½•ï¼š redis-5.0.4/step4ï¼šç”Ÿæˆï¼šmakesetp5ï¼šæµ‹è¯•,è¿™æ®µè¿è¡Œæ—¶é—´ä¼šæ¯”è¾ƒé•¿ï¼šmake teststep6ï¼šå®‰è£…ï¼šmake installsetp7ï¼šè¿›å…¥åˆ°é»˜è®¤å®‰è£…ç›®å½•ä¸‹æŸ¥çœ‹ï¼šcd /usr/local/bin &amp;&amp; ls -alredis-server redisæœåŠ¡å™¨redis-cli rediså‘½ä»¤è¡Œå®¢æˆ·ç«¯redis-benchmark redisæ€§èƒ½æµ‹è¯•å·¥å…·redis-check-aof AOFæ–‡ä»¶ä¿®å¤å·¥å…·redis-check-rdb RDBæ–‡ä»¶æ£€ç´¢å·¥å…·setp8ï¼šé…ç½®æ–‡ä»¶ï¼Œç§»åŠ¨åˆ°/etc/ç›®å½•ä¸‹ï¼šcp redis-5.0.4/redis.conf /etc/redis/rediså…¶ä»–å®‰è£…æ–¹å¼ï¼šä½¿ç”¨yumæ–¹å¼å®‰è£…ï¼šyum -y install epel-release &amp;&amp; yum -y install redis (3.0.6ç‰ˆæœ¬)ä½¿ç”¨yumå®‰è£…æœ€æ–°ç‰ˆæœ¬ï¼Œå¦‚ä¸‹å‘½ä»¤å®‰è£…çš„æ˜¯æœ€æ–°5.0.4ç‰ˆæœ¬12yum install -y http://rpms.famillecollet.com/enterprise/remi-release-7.rpmyum --enablerepo=remi install redisyumå®‰è£…çš„é…ç½®æ–‡ä»¶è·¯å¾„ï¼š/etc/redis.confå®‰è£…è·¯å¾„ï¼šll /usr/bin/ | grep redis3. é…ç½®yumå®‰è£…çš„é…ç½®æ–‡ä»¶è·¯å¾„ï¼š/etc/redis.confæ ¸å¿ƒé…ç½®é€‰é¡¹ç»‘å®šipï¼šå¦‚æžœéœ€è¦è¿œç¨‹è®¿é—®ï¼Œå¯å°†æ­¤è¡Œæ³¨é‡Šï¼Œæˆ–ç»‘å®šä¸€ä¸ªçœŸå®žipï¼Œé»˜è®¤æ˜¯æœ¬æœº127.0.0.1bind 127.0.0.1ç«¯å£ï¼šé»˜è®¤ä¸º6379port 6379æ˜¯å¦ä»¥å®ˆæŠ¤è¿›ç¨‹è¿è¡Œå¦‚æžœä»¥å®ˆæŠ¤è¿›ç¨‹è¿è¡Œï¼Œåˆ™ä¸ä¼šåœ¨å‘½ä»¤è¡Œé˜»å¡žï¼Œç±»ä¼¼äºŽæœåŠ¡å¦‚æžœä»¥éžå®ˆæŠ¤è¿›ç¨‹è¿è¡Œï¼Œåˆ™å½“å‰ç»ˆç«¯è¢«é˜»å¡žè®¾ç½®ä¸ºyesè¡¨ç¤ºå®ˆæŠ¤è¿›ç¨‹ï¼Œè®¾ç½®ä¸ºnoè¡¨ç¤ºéžå®ˆæŠ¤è¿›ç¨‹æŽ¨èè®¾ç½®ä¸ºyesdaemonize yesæ•°æ®æ–‡ä»¶dbfilename dump.rdbæ•°æ®æ–‡ä»¶å­˜å‚¨è·¯å¾„dir /var/lib/redisæ—¥å¿—æ–‡ä»¶logfile /var/log/redis/redis-server.logæ•°æ®åº“ï¼Œé»˜è®¤æœ‰16ä¸ªdatabase 16ä¸»ä»Žå¤åˆ¶ï¼Œç±»ä¼¼äºŽåŒæœºå¤‡ä»½ã€‚slaveof4. æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯4.1 æœåŠ¡å™¨ç«¯æœåŠ¡å™¨ç«¯çš„å‘½ä»¤ä¸ºredis-serverå¯ä»¥ä½¿ç”¨helpæŸ¥çœ‹å¸®åŠ©æ–‡æ¡£redis-server â€“helpæŽ¨èä½¿ç”¨æœåŠ¡çš„æ–¹å¼ç®¡ç†redisæœåŠ¡systemctl start|stop|restart|status redis.serviceå¯åŠ¨service redis startåœæ­¢service redis stopé‡å¯service redis restartä¸ªäººä¹ æƒ¯ps -ef | grep redis æŸ¥çœ‹redisæœåŠ¡å™¨è¿›ç¨‹kill -9 pid æ€æ­»redisæœåŠ¡å™¨redis-server /etc/redis/redis.conf æŒ‡å®šåŠ è½½çš„é…ç½®æ–‡ä»¶4.2 å®¢æˆ·ç«¯å®¢æˆ·ç«¯çš„å‘½ä»¤ä¸ºredis-cliå¯ä»¥ä½¿ç”¨helpæŸ¥çœ‹å¸®åŠ©æ–‡æ¡£redis-server â€“helpè¿žæŽ¥redisredis-cliæµ‹è¯•123[root@localhost ~]# redis-cli 127.0.0.1:6379&gt; ping 123"123"åˆ‡æ¢æ•°æ®åº“æ•°æ®åº“æ²¡æœ‰åç§°ï¼Œé»˜è®¤æœ‰16ä¸ªï¼Œé€šè¿‡0-15æ¥æ ‡è¯†ï¼Œè¿žæŽ¥redisé»˜è®¤é€‰æ‹©ç¬¬ä¸€ä¸ªæ•°æ®åº“select nselect n5. æ•°æ®æ“ä½œ5.1 æ•°æ®ç»“æž„redisæ˜¯key-valueçš„æ•°æ®ç»“æž„ï¼Œæ¯æ¡æ•°æ®éƒ½æ˜¯ä¸€ä¸ªé”®å€¼å¯¹é”®çš„ç±»åž‹æ˜¯å­—ç¬¦ä¸²ï¼Œä¸”ä¸èƒ½é‡å¤å€¼çš„ç±»åž‹åˆ†ä¸ºäº”ç§ï¼šå­—ç¬¦ä¸²stringå“ˆå¸Œhashåˆ—è¡¨listé›†åˆsetæœ‰åºé›†åˆzset5.2 æ•°æ®æ“ä½œè¡Œä¸ºä¿å­˜ä¿®æ”¹èŽ·å–åˆ é™¤[ä¸­æ–‡å®˜ç½‘å‘½ä»¤æ–‡æ¡£]ï¼šhttp://redis.cn/commands.html5.3 Stringç±»åž‹å­—ç¬¦ä¸²ç±»åž‹æ˜¯Redisä¸­æœ€ä¸ºåŸºç¡€çš„æ•°æ®å­˜å‚¨ç±»åž‹ï¼Œå®ƒåœ¨Redisä¸­æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ï¼Œè¿™ä¾¿æ„å‘³ç€è¯¥ç±»åž‹å¯ä»¥æŽ¥å—ä»»ä½•æ ¼å¼çš„æ•°æ®ï¼Œå¦‚JPEGå›¾åƒæ•°æ®æˆ–Jsonå¯¹è±¡æè¿°ä¿¡æ¯ç­‰ã€‚åœ¨Redisä¸­å­—ç¬¦ä¸²ç±»åž‹çš„Valueæœ€å¤šå¯ä»¥å®¹çº³çš„æ•°æ®é•¿åº¦æ˜¯512Mã€‚ä¿å­˜å¦‚æžœè®¾ç½®çš„é”®ä¸å­˜åœ¨åˆ™ä¸ºæ·»åŠ ï¼Œå¦‚æžœè®¾ç½®çš„é”®å·²ç»å­˜åœ¨åˆ™ä¿®æ”¹è®¾ç½®é”®å€¼ï¼šset key valueè®¾ç½®é”®å€¼åŠè¿‡æœŸæ—¶é—´ï¼Œä»¥ç§’ä¸ºå•ä½ï¼šsetex key seconds valueè®¾ç½®å¤šä¸ªé”®å€¼ï¼šmset key1 value1 key2 value2 â€¦è¿½åŠ å€¼ï¼šappend key valueèŽ·å–èŽ·å–ï¼šæ ¹æ®é”®èŽ·å–å€¼ï¼Œå¦‚æžœä¸å­˜åœ¨æ­¤é”®åˆ™è¿”å›žnilï¼šget keyæ ¹æ®å¤šä¸ªé”®èŽ·å–å¤šä¸ªå€¼ ï¼šmget key1 key2â€¦å…¶ä»–å¸¸ç”¨å‘½ä»¤æŸ¥æ‰¾é”®ï¼Œå‚æ•°æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ï¼škeys patternä¾‹å¦‚ï¼šæŸ¥çœ‹æ‰€æœ‰é”®ï¼škeys *æŸ¥çœ‹åç§°ä¸­å«æœ‰açš„é”®ï¼škeys &#39;a*&#39;åˆ¤æ–­é”®æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨è¿”å›ž1ï¼Œä¸å­˜åœ¨è¿”å›ž0ï¼šexists keyæŸ¥çœ‹é”®å¯¹åº”çš„valueçš„ç±»åž‹ï¼štype keyåˆ é™¤é”®åŠå…¶å¯¹åº”çš„å€¼ï¼šdel key1 key2â€¦â€¦.è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä»¥ç§’ä¸ºå•ä½ï¼Œå¦‚æžœæ²¡æœ‰æŒ‡å®šè¿‡æœŸæ—¶é—´åˆ™ä¸€ç›´å­˜åœ¨ï¼Œç›´åˆ°ä½¿ç”¨DELç§»é™¤ï¼šexpire key secondsæŸ¥çœ‹æœ‰æ•ˆæ—¶é—´ï¼Œä»¥ç§’ä¸ºå•ä½ï¼šttl key5.4 hashç±»åž‹hashç”¨äºŽå­˜å‚¨å¯¹è±¡ï¼Œå¯¹è±¡çš„ç»“æž„ä¸ºå±žæ€§ã€å€¼å€¼çš„ç±»åž‹ä¸ºstringå¢žåŠ ã€åˆ é™¤è®¾ç½®å•ä¸ªå±žæ€§ï¼šhset key filed valueä¾‹å¦‚ï¼šè®¾ç½®é”® userçš„å±žæ€§nameä¸ºitheimaï¼šhset user name hahahé”™è¯¯ä¿¡æ¯ï¼šMISCONF Redis is configured to save RDB snapshots, but is currently not able to persist on disk. Commands that may modify the data set are disabled. Please check Redis logs for details about the error.Redisè¢«é…ç½®ä¸ºä¿å­˜æ•°æ®åº“å¿«ç…§ï¼Œä½†å®ƒç›®å‰ä¸èƒ½æŒä¹…åŒ–åˆ°ç¡¬ç›˜ã€‚ç”¨æ¥ä¿®æ”¹é›†åˆæ•°æ®çš„å‘½ä»¤ä¸èƒ½ç”¨åŽŸå› ï¼šå¼ºåˆ¶å…³é—­Rediså¿«ç…§å¯¼è‡´ä¸èƒ½æŒä¹…åŒ–ã€‚è§£å†³æ–¹æ¡ˆï¼šè¿è¡Œconfig set stop-writes-on-bgsave-error noå‘½ä»¤åŽï¼Œå…³é—­é…ç½®é¡¹stop-writes-on-bgsave-errorè§£å†³è¯¥é—®é¢˜è®¾ç½®å¤šä¸ªå±žæ€§ï¼šhmset key field1 value1 field2 value2 â€¦ä¾‹å¦‚ï¼š è®¾ç½®é”®u2çš„å±žæ€§nameä¸ºhahaã€å±žæ€§ageä¸º22ï¼šhset user name hahah age 22èŽ·å–èŽ·å–æŒ‡å®šé”®æ‰€æœ‰çš„å±žæ€§ï¼šhkeys keyèŽ·å–ä¸€ä¸ªå±žæ€§çš„å€¼ï¼šhget key fieldèŽ·å–å¤šä¸ªå±žæ€§çš„å€¼ï¼šhmget key field1 field2 â€¦èŽ·å–æ‰€æœ‰å±žæ€§çš„å€¼ï¼šhvals keyåˆ é™¤åˆ é™¤æ•´ä¸ªhashé”®åŠå€¼ï¼Œä½¿ç”¨delå‘½ä»¤åˆ é™¤å±žæ€§ï¼Œå±žæ€§å¯¹åº”çš„å€¼ä¼šè¢«ä¸€èµ·åˆ é™¤ï¼šhdel key field1 field2 â€¦5.5 listç±»åž‹åˆ—è¡¨çš„å…ƒç´ ç±»åž‹ä¸ºstringæŒ‰ç…§æ’å…¥é¡ºåºæŽ’åºå¢žåŠ åœ¨å·¦ä¾§æ’å…¥æ•°æ®ï¼šlpush key value1 value2 â€¦åœ¨å³ä¾§æ’å…¥æ•°æ®ï¼šrpush key value1 value2 â€¦åœ¨æŒ‡å®šå…ƒç´ çš„å‰æˆ–åŽæ’å…¥æ–°å…ƒç´ ï¼šlinsert key beforeæˆ–after çŽ°æœ‰å…ƒç´  æ–°å…ƒç´ èŽ·å–è¿”å›žåˆ—è¡¨é‡ŒæŒ‡å®šèŒƒå›´å†…çš„å…ƒç´ ï¼šlrange key start stopstartã€stopä¸ºå…ƒç´ çš„ä¸‹æ ‡ç´¢å¼•,å¼•ä»Žå·¦ä¾§å¼€å§‹ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ä¸º0ï¼Œç´¢å¼•å¯ä»¥æ˜¯è´Ÿæ•°ï¼Œè¡¨ç¤ºä»Žå°¾éƒ¨å¼€å§‹è®¡æ•°ï¼Œå¦‚-1è¡¨ç¤ºæœ€åŽâ¼€ä¸ªå…ƒç´ è®¾ç½®æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ å€¼ï¼šlset key index valueç´¢å¼•ä»Žå·¦ä¾§å¼€å§‹ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ä¸º0ï¼Œç´¢å¼•å¯ä»¥æ˜¯è´Ÿæ•°ï¼Œè¡¨ç¤ºå°¾éƒ¨å¼€å§‹è®¡æ•°ï¼Œå¦‚-1è¡¨ç¤ºæœ€åŽä¸€ä¸ªå…ƒç´ åˆ é™¤åˆ é™¤æŒ‡å®šå…ƒç´ ï¼šlrem key count valueå°†åˆ—è¡¨ä¸­å‰countæ¬¡å‡ºçŽ°çš„å€¼ä¸ºvalueçš„å…ƒç´ ç§»é™¤ï¼Œcount &gt; 0: ä»Žå¤´å¾€å°¾ç§»é™¤ï¼Œcount &lt; 0: ä»Žå°¾å¾€å¤´ç§»é™¤ï¼Œcount = 0: ç§»é™¤æ‰€æœ‰5.6 setç±»åž‹æ— åºé›†åˆå…ƒç´ ä¸ºstringç±»åž‹å…ƒç´ å…·æœ‰å”¯ä¸€æ€§ï¼Œä¸é‡å¤å¯¹äºŽé›†åˆæ²¡æœ‰ä¿®æ”¹æ“ä½œå¢žåŠ æ·»åŠ å…ƒç´ ï¼šsadd key member1 member2 â€¦èŽ·å–è¿”å›žæ‰€æœ‰çš„å…ƒç´ ï¼šsmembers keyåˆ é™¤åˆ é™¤æŒ‡å®šå…ƒç´ ï¼šsrem keyåˆ é™¤æŒ‡å®šå…ƒç´ ä¸­çš„æŸä¸€ä¸ªå€¼ï¼šsrem key member15.7 zsetç±»åž‹sorted setï¼Œæœ‰åºé›†åˆå…ƒç´ ä¸ºstringç±»åž‹å…ƒç´ å…·æœ‰å”¯ä¸€æ€§ï¼Œä¸é‡å¤æ¯ä¸ªå…ƒç´ éƒ½ä¼šå…³è”ä¸€ä¸ªdoubleç±»åž‹çš„scoreï¼Œè¡¨ç¤ºæƒé‡ï¼Œé€šè¿‡æƒé‡å°†å…ƒç´ ä»Žå°åˆ°å¤§æŽ’åºæ²¡æœ‰ä¿®æ”¹æ“ä½œå¢žåŠ æ·»åŠ ï¼šzadd key score1 member1 score2 member2 â€¦ä¾‹å¦‚ï¼š å‘é”®â€™a4â€™çš„é›†åˆä¸­æ·»åŠ å…ƒç´ â€™lisiâ€™ã€â€™wangwuâ€™ã€â€™zhaoliuâ€™ã€â€™zhangsanâ€™ï¼Œæƒé‡åˆ†åˆ«ä¸º4ã€5ã€6ã€3zadd a4 4 lisi 5 wangwu 6 zhaoliu 3 zhangsanèŽ·å–è¿”å›žæŒ‡å®šèŒƒå›´å†…çš„å…ƒç´ ï¼šzrange key start stopstartã€stopä¸ºå…ƒç´ çš„ä¸‹æ ‡ç´¢å¼•ï¼Œ ç´¢å¼•ä»Žå·¦ä¾§å¼€å§‹ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ä¸º0ï¼Œç´¢å¼•å¯ä»¥æ˜¯è´Ÿæ•°ï¼Œè¡¨ç¤ºä»Žå°¾éƒ¨å¼€å§‹è®¡æ•°ï¼Œå¦‚-1è¡¨ç¤ºæœ€åŽä¸€ä¸ªå…ƒç´ è¿”å›žscoreå€¼åœ¨minå’Œmaxä¹‹é—´çš„æˆå‘˜ï¼šzrangebyscore key min maxè¿”å›žæˆå‘˜memberçš„scoreå€¼ï¼šzscore key memberåˆ é™¤åˆ é™¤æŒ‡å®šå…ƒç´ ï¼šzrem key member1 member2 â€¦åˆ é™¤æƒé‡åœ¨æŒ‡å®šèŒƒå›´çš„å…ƒç´ ï¼šzremrangebyscore key min max6. ä¸ŽPythonäº¤äº’pythonçŽ¯å¢ƒä¸­å®‰è£…redisæ¨¡å—ï¼špip install redisè°ƒç”¨æ¨¡å—ï¼šfrom redis import *è¿™ä¸ªæ¨¡å—ä¸­æä¾›äº†StrictRediså¯¹è±¡(Strictä¸¥æ ¼)ï¼Œç”¨äºŽè¿žæŽ¥redisæœåŠ¡å™¨ï¼Œå¹¶æŒ‰ç…§ä¸åŒç±»åž‹æä¾› äº†ä¸åŒæ”¾æ³•ï¼Œè¿›è¡Œäº¤äº’æ“ä½œ6.1 StrictRediså¯¹è±¡æ–¹æ³•é€šè¿‡initåˆ›å»ºå¯¹è±¡ï¼ŒæŒ‡å®šå‚æ•°hostã€portä¸ŽæŒ‡å®šçš„æœåŠ¡å™¨å’Œç«¯â¼è¿žæŽ¥ï¼Œhosté»˜è®¤ä¸ºlocalhostï¼Œporté»˜è®¤ä¸º6379ï¼Œdbé»˜è®¤ä¸º0sr = StrictRedis(host=&#39;localhost&#39;, port=6379, db=0)ç®€å†™ï¼šsr=StrictRedis()æ ¹æ®ä¸åŒçš„ç±»åž‹ï¼Œæ‹¥æœ‰ä¸åŒçš„å®žä¾‹æ–¹æ³•å¯ä»¥è°ƒç”¨ï¼Œä¸Žå‰é¢å­¦çš„rediså‘½ä»¤å¯¹åº”ï¼Œæ–¹æ³•éœ€è¦çš„å‚æ•°ä¸Žå‘½ä»¤çš„å‚æ•°ä¸€è‡´ã€‚6.1.2 stringsetsetexmsetappendgetmgetkey6.1.3 keysexiststypedeleteexpiregetrangettl6.1.4 hashhsethmsethkeyshgethmgethvalshdel6.1.5 listlpushrpushlinsertlrangelsetlrem6.1.6 setsaddsmemberssrem6.1.7 zsetzaddzrangezrangebyscorezscorezremzremrangebyscore6.2 StrictRediså¯¹è±¡æ“ä½œstringç±»åž‹6.2.1 å‡†å¤‡123456789import redisif __name__ == "__main__": try: # åˆ›å»ºStrictRediså¯¹è±¡ï¼Œä¸ŽredisæœåŠ¡å™¨å»ºâ½´è¿žæŽ¥ sr = redis.StrictRedis(host='192.168.0.138', port=6379, db=0, password=None) print('success') except Exception as e: print(e)6.2.2 string-å¢žåŠ æ–¹æ³•setï¼Œæ·»åŠ é”®ã€å€¼ï¼Œå¦‚æžœæ·»åŠ æˆåŠŸåˆ™è¿”å›žTrueï¼Œå¦‚æžœæ·»åŠ å¤±è´¥åˆ™è¿”å›žFalse12345678910111213import redisif __name__ == "__main__": try: # åˆ›å»ºStrictRediså¯¹è±¡ï¼Œä¸ŽredisæœåŠ¡å™¨å»ºâ½´è¿žæŽ¥ sr = redis.StrictRedis(host='127.0.0.1', port=6379, db=0, password='foobar2000') print('success') # æ·»åŠ é”®nameï¼Œå€¼ä¸ºhaha result = sr.set('name','haha1111') # è¾“å‡ºå“åº”ç»“æžœï¼Œå¦‚æžœæ·»åŠ æˆåŠŸåˆ™è¿”å›žTrueï¼Œå¦åˆ™è¿”å›žFalse print(result) except Exception as e: print(e)6.2.3 string-èŽ·å–æ–¹æ³•getï¼Œæ·»åŠ é”®å¯¹åº”çš„å€¼ï¼Œå¦‚æžœé”®å­˜åœ¨åˆ™è¿”å›žå¯¹åº”çš„å€¼ï¼Œå¦‚æžœé”®ä¸å­˜åœ¨åˆ™è¿”å›žNone12345678910111213import redisif __name__ == "__main__": try: # åˆ›å»ºStrictRediså¯¹è±¡ï¼Œä¸ŽredisæœåŠ¡å™¨å»ºâ½´è¿žæŽ¥ sr = redis.StrictRedis(host='127.0.0.1', port=6379, db=0, password='foobar2000') print('success') #èŽ·å–é”®nameçš„å€¼ result = sr.get('name') #è¾“å‡ºé”®çš„å€¼ï¼Œå¦‚æžœé”®ä¸å­˜åœ¨åˆ™è¿”å›žNone print(result) # b'haha1111'ï¼Œç±»åž‹æ˜¯&lt;class 'bytes'&gt; except Exception as e: print(e)6.2.4 string-ä¿®æ”¹æ–¹æ³•setï¼Œå¦‚æžœé”®å·²ç»å­˜åœ¨åˆ™è¿›è¡Œä¿®æ”¹ï¼Œå¦‚æžœé”®ä¸å­˜åœ¨åˆ™è¿›è¡Œæ·»åŠ 12345678910111213import redisif __name__ == "__main__": try: # åˆ›å»ºStrictRediså¯¹è±¡ï¼Œä¸ŽredisæœåŠ¡å™¨å»ºâ½´è¿žæŽ¥ sr = redis.StrictRedis(host='127.0.0.1', port=6379, db=0, password='foobar2000') print('success') #èŽ·å–é”®nameçš„å€¼ result = sr.set('name','hahahahhhahahh') #è¾“å‡ºå“åº”ç»“æžœï¼Œå¦‚æžœæ“ä½œæˆåŠŸåˆ™è¿”å›žTrueï¼Œå¦åˆ™è¿”å›žFalse print(result) except Exception as e: print(e)6.2.5 string-åˆ é™¤æ–¹æ³•deleteï¼Œåˆ é™¤é”®åŠå¯¹åº”çš„å€¼ï¼Œå¦‚æžœåˆ é™¤æˆåŠŸåˆ™è¿”å›žå—å½±å“çš„é”®æ•°ï¼Œå¦åˆ™åˆ™è¿” å›ž012345678910111213import redisif __name__ == "__main__": try: # åˆ›å»ºStrictRediså¯¹è±¡ï¼Œä¸ŽredisæœåŠ¡å™¨å»ºâ½´è¿žæŽ¥ sr = redis.StrictRedis(host='127.0.0.1', port=6379, db=0, password='foobar2000') print('success') #èŽ·å–é”®nameçš„å€¼ result = sr.delete('name') #è¾“å‡ºå“åº”ç»“æžœï¼Œå¦‚æžœåˆ é™¤æˆåŠŸåˆ™è¿”å›žå—å½±å“çš„é”®æ•°ï¼Œå¦åˆ™åˆ™è¿”å›ž0 print(result) except Exception as e: print(e)6.2.6 èŽ·å–é”®æ–¹æ³•keysï¼Œæ ¹æ®æ­£åˆ™è¡¨è¾¾å¼èŽ·å–é”®12345678910111213import redisif __name__ == "__main__": try: # åˆ›å»ºStrictRediså¯¹è±¡ï¼Œä¸ŽredisæœåŠ¡å™¨å»ºâ½´è¿žæŽ¥ sr = redis.StrictRedis(host='127.0.0.1', port=6379, db=0, password='foobar2000') print('success') #èŽ·å–é”®nameçš„å€¼ result = sr.keys() #è¾“å‡ºå“åº”ç»“æžœï¼Œæ‰€æœ‰çš„é”®æž„æˆâ¼€ä¸ªåˆ—è¡¨ï¼Œå¦‚æžœæ²¡æœ‰é”®åˆ™è¿”å›žç©ºåˆ—è¡¨ print(result) except Exception as e: print(e)7. ä¸»ä»Žé…ç½®(è¯»å†™åˆ†ç¦»)ä¸€ä¸ªmasterå¯ä»¥æ‹¥æœ‰å¤šä¸ªslaveï¼Œä¸€ä¸ªslaveä¸Šå¯ä»¥æ‹¥æœ‰å¤šä¸ªslaveï¼Œå¦‚æ­¤ä¸‹åŽ»ï¼Œå½¢æˆäº†å¼ºå¤§çš„å¤šçº§æœåŠ¡å™¨é›†ç¾¤æž¶æž„masterç”¨æ¥å†™æ•°æ®ï¼Œslaveç”¨æ¥è¯»æ•°æ®ï¼Œç»ç»Ÿè®¡ï¼šç½‘ç«™çš„è¯»å†™æ¯”çŽ‡æ˜¯10:1é€šè¿‡ä¸»ä»Žé…ç½®å¯ä»¥å®žçŽ°è¯»å†™åˆ†ç¦»masterå’Œslaveéƒ½æ˜¯ä¸€ä¸ªrediså®žä¾‹(redisæœåŠ¡)è¯´æ˜Žï¼šå¦‚ä¸‹çš„å®žä¾‹æ˜¯ä¸»ä»Žåœ¨ä¸€å°æœåŠ¡å™¨ä¸Šï¼Œé€šè¿‡ç«¯å£å·è¿›è¡ŒåŒºåˆ†7.1 ä¸»ä»Žé…ç½®7.1.1 é…ç½®ä¸»æŸ¥çœ‹å½“å‰ä¸»æœºçš„ipåœ°å€ï¼šifconfigä¿®æ”¹/etc/redis.confæ–‡ä»¶bind 192.168.26.128 # ç»‘å®šä¸»æœåŠ¡å™¨IPé‡å¯redisæœåŠ¡ï¼šservice redis stop &amp;&amp; redis-server redis.conf7.1.2 é…ç½®ä»Žè®¾ç½®slave.confæ–‡ä»¶ï¼šcp redis.conf slave.confä¿®æ”¹slave.confæ–‡ä»¶bind 192.168.26.128 # ä»ŽæœåŠ¡å™¨IPï¼Œå› ä½¿ç”¨ä¸€å°ä¸»æœºï¼Œæ‰€ä»¥IPåŒä¸»æœåŠ¡å™¨IPç›¸åŒport 6378 # ä»ŽæœåŠ¡å™¨ç«¯å£slaveof 192.168.26.128 6379 # å…³è”åˆ°ä¸»ä¿¡æ¯å¯åŠ¨redisæœåŠ¡ï¼šredis-server slave.confæŸ¥çœ‹ä¸»ä»Žå…³ç³»ï¼šredis-cli -h 192.168.26.128 info Replication7.1.2 æ•°æ®æ“ä½œåœ¨masterå’Œslaveåˆ†åˆ«æ‰§è¡Œinfoå‘½ä»¤ï¼ŒæŸ¥çœ‹è¾“å‡ºä¿¡æ¯ è¿›å…¥ä¸»å®¢æˆ·ç«¯redis-cli -h 192.168.26.128 -p 6379 # è¿›å…¥ä¸»å®¢æˆ·ç«¯redis-cli -h 192.168.26.128 -p 6378 # è¿›å…¥ä»Žå®¢æˆ·ç«¯åœ¨masterä¸Šå†™æ•°æ®ï¼šset aa aaåœ¨slaveä¸Šè¯»æ•°æ®ï¼šget aa8. å“¨å…µ(ä¸»ä»Žåˆ‡æ¢)å¾…å®Œå–„â€¦â€¦9. æ­å»ºé›†ç¾¤9.1 ä¸ºä»€ä¹ˆè¦æœ‰é›†ç¾¤ä¸€ä¸»å¯ä»¥å¤šä»Žï¼Œå¦‚æžœåŒæ—¶çš„è®¿é—®é‡è¿‡å¤§(1000w),ä¸»æœåŠ¡è‚¯å®šå°±ä¼šæŒ‚æŽ‰ï¼Œæ•°æ®æœåŠ¡å°±æŒ‚æŽ‰äº†æˆ–è€…å‘ç”Ÿè‡ªç„¶ç¾éš¾å¤§å…¬å¸éƒ½ä¼šæœ‰å¾ˆå¤šçš„æœåŠ¡å™¨(åŽä¸œåœ°åŒºã€åŽå—åœ°åŒºã€åŽä¸­åœ°åŒºã€åŽåŒ—åœ°åŒºã€è¥¿åŒ—åœ°åŒºã€è¥¿å—åœ°åŒºã€ä¸œåŒ—åœ°åŒºã€å°æ¸¯æ¾³åœ°åŒºæœºæˆ¿)9.2 é›†ç¾¤çš„æ¦‚å¿µé›†ç¾¤æ˜¯ä¸€ç»„ç›¸äº’ç‹¬ç«‹çš„ã€é€šè¿‡é«˜é€Ÿç½‘ç»œäº’è”çš„è®¡ç®—æœºï¼Œå®ƒä»¬æž„æˆäº†ä¸€ä¸ªç»„ï¼Œå¹¶ä»¥å•ä¸€ç³»ç»Ÿçš„æ¨¡å¼åŠ ä»¥ç®¡ç†ã€‚ä¸€ä¸ªå®¢æˆ·ä¸Žé›†ç¾¤ç›¸äº’ä½œç”¨æ—¶ï¼Œé›†ç¾¤åƒæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æœåŠ¡å™¨ã€‚é›†ç¾¤é…ç½®æ˜¯ç”¨äºŽæé«˜å¯ç”¨æ€§å’Œå¯ç¼©æ”¾æ€§ã€‚å½“è¯·æ±‚åˆ°æ¥é¦–å…ˆç”±è´Ÿè½½å‡è¡¡æœåŠ¡å™¨å¤„ç†ï¼ŒæŠŠè¯·æ±‚è½¬å‘åˆ°å¦å¤–çš„ä¸€å°æœåŠ¡å™¨ä¸Šã€‚9.3 redisé›†ç¾¤åˆ†ç±»è½¯ä»¶å±‚é¢ï¼šåªæœ‰ä¸€å°ç”µè„‘ï¼Œåœ¨è¿™ä¸€å°ç”µè„‘ä¸Šå¯åŠ¨äº†å¤šä¸ªredisæœåŠ¡ç¡¬ä»¶å±‚é¢ï¼šå­˜åœ¨å¤šå°å®žä½“çš„ç”µè„‘ï¼Œæ¯å°ç”µè„‘ä¸Šéƒ½å¯åŠ¨äº†ä¸€ä¸ªredisæˆ–è€…å¤šä¸ªredisæœåŠ¡9.4 æ­å»ºé›†ç¾¤å½“å‰æ‹¥æœ‰ä¸¤å°ä¸»æœº172.16.179.130ã€172.16.179.131ï¼Œè¿™é‡Œçš„IPåœ¨ä½¿ç”¨æ—¶è¦æ”¹ä¸ºå®žé™…å€¼9.4.1 é…ç½®æœºå™¨1åœ¨æ¼”ç¤ºä¸­ï¼Œ172.16.179.130ä¸ºå½“å‰ubuntuæœºå™¨çš„ipåœ¨172.16.179.130ä¸Šè¿›å…¥Desktopç›®å½•ï¼Œåˆ›å»ºconfç›®å½•åœ¨confç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶7000.confï¼Œç¼–è¾‘å†…å®¹å¦‚ä¸‹12345678port 7000bind 172.16.179.130daemonize yespidfile 7000.pidcluster-enabled yescluster-config-file 7000_node.confcluster-node-timeout 15000appendonly yesåœ¨confç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶7001.confï¼Œç¼–è¾‘å†…å®¹å¦‚ä¸‹12345678port 7001bind 172.16.179.130daemonize yespidfile 7001.pidcluster-enabled yescluster-config-file 7001_node.confcluster-node-timeout 15000appendonly yesåœ¨confç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶7001.confï¼Œç¼–è¾‘å†…å®¹å¦‚ä¸‹12345678port 7001bind 172.16.179.130daemonize yespidfile 7001.pidcluster-enabled yescluster-config-file 7001_node.confcluster-node-timeout 15000appendonly yesåœ¨confç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶7002.confï¼Œç¼–è¾‘å†…å®¹å¦‚ä¸‹12345678port 7002bind 172.16.179.130daemonize yespidfile 7002.pidcluster-enabled yescluster-config-file 7002_node.confcluster-node-timeout 15000appendonly yesæ€»ç»“ï¼šä¸‰ä¸ªæ–‡ä»¶çš„é…ç½®åŒºåˆ«åœ¨portã€pidfileã€cluster-config-fileä¸‰é¡¹ä½¿ç”¨é…ç½®æ–‡ä»¶å¯åŠ¨redisæœåŠ¡123redis-server 7000.confredis-server 7001.confredis-server 7002.conf9.4.2 é…ç½®æœºå™¨2åœ¨æ¼”ç¤ºä¸­ï¼Œ172.16.179.131ä¸ºå½“å‰ubuntuæœºå™¨çš„ipåœ¨172.16.179.131ä¸Šè¿›å…¥Desktopç›®å½•ï¼Œåˆ›å»ºconfç›®å½•åœ¨confç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶7003.confï¼Œç¼–è¾‘å†…å®¹å¦‚ä¸‹12345678port 7003bind 172.16.179.131daemonize yespidfile 7003.pidcluster-enabled yescluster-config-file 7003_node.confcluster-node-timeout 15000appendonly yesåœ¨confç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶7004.confï¼Œç¼–è¾‘å†…å®¹å¦‚ä¸‹12345678port 7004bind 172.16.179.131daemonize yespidfile 7004.pidcluster-enabled yescluster-config-file 7004_node.confcluster-node-timeout 15000appendonly yesåœ¨confç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶7005.confï¼Œç¼–è¾‘å†…å®¹å¦‚ä¸‹12345678port 7005bind 172.16.179.131daemonize yespidfile 7005.pidcluster-enabled yescluster-config-file 7005_node.confcluster-node-timeout 15000appendonly yesæ€»ç»“ï¼šä¸‰ä¸ªæ–‡ä»¶çš„é…ç½®åŒºåˆ«åœ¨portã€pidfileã€cluster-config-fileä¸‰é¡¹ä½¿ç”¨é…ç½®æ–‡ä»¶å¯åŠ¨redisæœåŠ¡123redis-server 7003.confredis-server 7004.confredis-server 7005.conf9.4.3 åˆ›å»ºé›†ç¾¤redisçš„å®‰è£…åŒ…ä¸­åŒ…å«äº†redis-trib.rbï¼Œç”¨äºŽåˆ›å»ºé›†ç¾¤ï¼ŒæŽ¥ä¸‹æ¥çš„æ“ä½œåœ¨172.16.179.130æœºå™¨ä¸Šè¿›è¡Œå°†å‘½ä»¤å¤åˆ¶ï¼Œè¿™æ ·å¯ä»¥åœ¨ä»»ä½•ç›®å½•ä¸‹è°ƒç”¨æ­¤å‘½ä»¤cp /usr/share/doc/redis-tools/examples/redis-trib.rb /usr/local/bin/å®‰è£…rubyçŽ¯å¢ƒï¼Œå› ä¸ºredis-trib.rbæ˜¯ç”¨rubyå¼€å‘çš„ï¼šapt-get install rubyè¿è¡Œå¦‚ä¸‹å‘½ä»¤åˆ›å»ºé›†ç¾¤ï¼šredis-trib.rb create --replicas 1 172.16.179.130:7000 172.16.179.130:7001 172.16.179.130:7002 172.16.179.131:7003 172.16.179.131:7004 172.16.179.131:7005æ‰§è¡Œä¸Šé¢è¿™ä¸ªæŒ‡ä»¤åœ¨æŸäº›æœºå™¨ä¸Šå¯èƒ½ä¼šæŠ¥é”™,ä¸»è¦åŽŸå› æ˜¯ç”±äºŽå®‰è£…çš„ ruby ä¸æ˜¯æœ€ æ–°ç‰ˆæœ¬å¤©æœçš„é˜²ç«å¢™å¯¼è‡´æ— æ³•ä¸‹è½½æœ€æ–°ç‰ˆæœ¬,æ‰€ä»¥éœ€è¦è®¾ç½® gem çš„æºè§£å†³åŠžæ³•å¦‚ä¸‹ï¼šâ€“ å…ˆæŸ¥çœ‹è‡ªå·±çš„ gem æºæ˜¯ä»€ä¹ˆåœ°å€ï¼šgem source -l â€“ å¦‚æžœæ˜¯https://rubygems.org/ å°±éœ€è¦æ›´æ¢â€“ æ›´æ¢æŒ‡ä»¤ä¸ºï¼šgem sources â€“add https://gems.ruby-china.org/ â€“remove https://rubygems.org/â€“ é€šè¿‡ gem å®‰è£… redis çš„ç›¸å…³ä¾èµ–ï¼šsudo gem install redisâ€“ ç„¶åŽé‡æ–°æ‰§è¡ŒæŒ‡ä»¤9.4.4 æ•°æ®éªŒè¯å½“å‰æ­å»ºçš„ä¸»æœåŠ¡å™¨ä¸º7000ã€7001ã€7003ï¼Œå¯¹åº”çš„ä»ŽæœåŠ¡å™¨æ˜¯7004ã€7005ã€7002ï¼Œåœ¨172.16.179.131æœºå™¨ä¸Šè¿žæŽ¥7002ï¼ŒåŠ å‚æ•°-cè¡¨ç¤ºè¿žæŽ¥åˆ°é›†ç¾¤redis-cli -h 172.16.179.131 -c -p 7002å†™å…¥æ•°æ®ï¼š set name hahaè‡ªåŠ¨è·³åˆ°äº†7003æœåŠ¡å™¨ï¼Œå¹¶å†™å…¥æ•°æ®æˆåŠŸåœ¨7003å¯ä»¥èŽ·å–æ•°æ®ï¼Œå¦‚æžœå†™å…¥æ•°æ®åˆé‡å®šå‘åˆ°7000(è´Ÿè½½å‡è¡¡)9.4.5 åœ¨å“ªä¸ªæœåŠ¡å™¨ä¸Šå†™æ•°æ®ï¼šCRC16redis clusteråœ¨è®¾è®¡çš„æ—¶å€™ï¼Œå°±è€ƒè™‘åˆ°äº†åŽ»ä¸­é—´åŒ–ï¼ŒåŽ»ä¸­é—´ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé›†ç¾¤ä¸­ çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯å¹³ç­‰çš„å…³ç³»ï¼Œéƒ½æ˜¯å¯¹ç­‰çš„ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½ä¿å­˜å„è‡ªçš„æ•°æ®å’Œæ•´ä¸ªé›†ç¾¤çš„çŠ¶æ€ã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½å’Œå…¶ä»–æ‰€æœ‰èŠ‚ç‚¹è¿žæŽ¥ï¼Œå¹¶ä¸”è¿™äº›è¿žæŽ¥ä¿æŒæ´»è·ƒï¼Œè¿™æ ·å°±ä¿è¯äº†æˆ‘ä»¬åªéœ€è¦è¿žæŽ¥é›†ç¾¤ä¸­çš„ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°±å¯ä»¥èŽ·å–åˆ°å…¶ä»–èŠ‚ç‚¹çš„æ•°æ®Redisé›†ç¾¤æ²¡æœ‰å¹¶ä½¿ç”¨ä¼ ç»Ÿçš„ä¸€è‡´æ€§å“ˆå¸Œæ¥åˆ†é…æ•°æ®ï¼Œè€Œæ˜¯é‡‡ç”¨å¦å¤–ä¸€ç§å«åšå“ˆå¸Œæ§½ (hash slot)çš„æ–¹å¼æ¥åˆ†é…çš„ã€‚redis cluster é»˜è®¤åˆ†é…äº† 16384 ä¸ªslotï¼Œå½“æˆ‘ä»¬ setä¸€ä¸ªkey æ—¶ï¼Œä¼šç”¨CRC16ç®—æ³•æ¥å–æ¨¡å¾—åˆ°æ‰€å±žçš„slotï¼Œç„¶åŽå°†è¿™ä¸ªkey åˆ†åˆ°å“ˆå¸Œæ§½åŒºé—´çš„èŠ‚ç‚¹ä¸Šï¼Œå…·ä½“ç®—æ³•å°±æ˜¯ï¼šCRC16(key) % 16384ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨æµ‹è¯•çš„ æ—¶å€™çœ‹åˆ°set å’Œ get çš„æ—¶å€™ï¼Œç›´æŽ¥è·³è½¬åˆ°äº†7000ç«¯å£çš„èŠ‚ç‚¹Redis é›†ç¾¤ä¼šæŠŠæ•°æ®å­˜åœ¨ä¸€ä¸ª master èŠ‚ç‚¹ï¼Œç„¶åŽåœ¨è¿™ä¸ª master å’Œå…¶å¯¹åº”çš„salve ä¹‹é—´è¿›è¡Œæ•°æ®åŒæ­¥ã€‚å½“è¯»å–æ•°æ®æ—¶ï¼Œä¹Ÿæ ¹æ®ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•åˆ°å¯¹åº”çš„ master èŠ‚ ç‚¹èŽ·å–æ•°æ®ã€‚åªæœ‰å½“ä¸€ä¸ªmaster æŒ‚æŽ‰ä¹‹åŽï¼Œæ‰ä¼šå¯åŠ¨ä¸€ä¸ªå¯¹åº”çš„ salve èŠ‚ç‚¹ï¼Œå……å½“ masteréœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¿…é¡»è¦3ä¸ªæˆ–ä»¥ä¸Šçš„ä¸»èŠ‚ç‚¹ï¼Œå¦åˆ™åœ¨åˆ›å»ºé›†ç¾¤æ—¶ä¼šå¤±è´¥ï¼Œå¹¶ä¸”å½“å­˜ æ´»çš„ä¸»èŠ‚ç‚¹æ•°å°äºŽæ€»èŠ‚ç‚¹æ•°çš„ä¸€åŠæ—¶ï¼Œæ•´ä¸ªé›†ç¾¤å°±æ— æ³•æä¾›æœåŠ¡äº†9.5 Pythonäº¤äº’å®‰è£…åŒ…ï¼špip install redis-py-clusterredis-py-clusteræºç åœ°å€https://github.com/Grokzen/redis-py-clusteråˆ›å»ºæ–‡ä»¶redis_cluster.pyï¼Œç¤ºä¾‹ç å¦‚ä¸‹1234567891011121314151617181920from rediscluster import *if __name__ == '__main__': try: # æž„å»ºæ‰€æœ‰çš„èŠ‚ç‚¹ï¼ŒRedisä¼šä½¿â½¤CRC16ç®—æ³•ï¼Œå°†é”®å’Œå€¼å†™åˆ°æŸä¸ªèŠ‚ç‚¹ä¸Š startup_nodes = [ &#123;'host': '192.168.26.128', 'port': '7000'&#125;, &#123;'host': '192.168.26.130', 'port': '7003'&#125;, &#123;'host': '192.168.26.128', 'port': '7001'&#125;, ] # æž„å»ºStrictRedisClusterå¯¹è±¡ src=StrictRedisCluster(startup_nodes=startup_nodes,decode_responses=True) # è®¾ç½®é”®ä¸ºnameã€å€¼ä¸ºitheimaçš„æ•°æ® result=src.set('name','itheima') print(result) # èŽ·å–é”®ä¸ºname name = src.get('name') print(name) except Exception as e: print(e)]]></content>
      <categories>
        <category>Redis</category>
      </categories>
      <tags>
        <tag>Redis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Pythonå°çŸ¥è¯†]]></title>
    <url>%2F2019%2F12%2F31%2FPython%E5%B0%8F%E7%9F%A5%E8%AF%86%2F</url>
    <content type="text"><![CDATA[æŸ¥çœ‹ Python ä¸­çš„å…³é”®å­—12import keywordprint(keyword.kwlist)é©¼å³°å‘½åæ³•å°é©¼å³°å¼å‘½åæ³•ç¬¬ä¸€ä¸ªå•è¯ä»¥å°å†™å­—æ¯å¼€å§‹ï¼ŒåŽç»­å•è¯çš„é¦–å­—æ¯å¤§å†™å¤§é©¼å³°å¼å‘½åæ³•æ¯ä¸€ä¸ªå•è¯çš„é¦–å­—æ¯éƒ½é‡‡ç”¨å¤§å†™å­—æ¯break å’Œ continuebreak å’Œ continue æ˜¯ä¸“é—¨åœ¨å¾ªçŽ¯ä¸­ä½¿ç”¨çš„å…³é”®å­—,åªé’ˆå¯¹å½“å‰æ‰€åœ¨å¾ªçŽ¯æœ‰æ•ˆbreak æŸä¸€æ¡ä»¶æ»¡è¶³æ—¶ï¼Œé€€å‡ºå¾ªçŽ¯ï¼Œä¸å†æ‰§è¡ŒåŽç»­é‡å¤çš„ä»£ç continue æŸä¸€æ¡ä»¶æ»¡è¶³æ—¶ï¼Œä¸æ‰§è¡ŒåŽç»­é‡å¤çš„ä»£ç breakåœ¨å¾ªçŽ¯è¿‡ç¨‹ä¸­ï¼Œå¦‚æžœæŸä¸€ä¸ªæ¡ä»¶æ»¡è¶³åŽï¼Œä¸å†å¸Œæœ›å¾ªçŽ¯ç»§ç»­æ‰§è¡Œï¼Œå¯ä»¥ä½¿ç”¨ break é€€å‡ºå¾ªçŽ¯12345678910111213#!/usr/bin/env python# -*- coding: utf-8 -*-i = 0while i &lt; 10: # break æŸä¸€æ¡ä»¶æ»¡è¶³æ—¶ï¼Œé€€å‡ºå¾ªçŽ¯ï¼Œä¸å†æ‰§è¡ŒåŽç»­é‡å¤çš„ä»£ç  if i == 3: break print(i) i += 1print("over")å¦‚æžœæŸä¸€ä¸ªæ¡ä»¶æ»¡è¶³åŽï¼Œä¸å¸Œæœ›æ‰§è¡Œå¾ªçŽ¯ä»£ç ï¼Œä½†æ˜¯åˆä¸å¸Œæœ›é€€å‡ºå¾ªçŽ¯ï¼Œå¯ä»¥ä½¿ç”¨ continue12345678910111213141516#!/usr/bin/env python# -*- coding: utf-8 -*-i = 0while i &lt; 10: # å½“ i == 7 æ—¶ï¼Œä¸å¸Œæœ›æ‰§è¡Œéœ€è¦é‡å¤æ‰§è¡Œçš„ä»£ç  if i == 7: i += 1 continue # é‡å¤æ‰§è¡Œçš„ä»£ç  print(i) i += 1print("over")ä½¿ç”¨ continue æ—¶ï¼Œæ¡ä»¶å¤„ç†éƒ¨åˆ†çš„ä»£ç ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„ï¼Œä¸å°å¿ƒä¼šå‡ºçŽ° æ­»å¾ªçŽ¯printå‡½æ•°åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œ print å‡½æ•°è¾“å‡ºå†…å®¹ä¹‹åŽï¼Œä¼šè‡ªåŠ¨åœ¨å†…å®¹æœ«å°¾å¢žåŠ æ¢è¡Œå¦‚æžœä¸å¸Œæœ›æœ«å°¾å¢žåŠ æ¢è¡Œï¼Œå¯ä»¥åœ¨ print å‡½æ•°è¾“å‡ºå†…å®¹çš„åŽé¢å¢žåŠ  , end=â€â€å…¶ä¸­ â€œâ€ ä¸­é—´å¯ä»¥æŒ‡å®š print å‡½æ•°è¾“å‡ºå†…å®¹ä¹‹åŽï¼Œç»§ç»­å¸Œæœ›æ˜¾ç¤ºçš„å†…å®¹12345678#!/usr/bin/env python# -*- coding: utf-8 -*-# å‘æŽ§åˆ¶å°è¾“å‡ºå†…å®¹ç»“æŸä¹‹åŽï¼Œä¸ä¼šæ¢è¡Œprint("*", end="")# å•çº¯çš„æ¢è¡Œprint("")end=â€â€ è¡¨ç¤ºå‘æŽ§åˆ¶å°è¾“å‡ºå†…å®¹ç»“æŸä¹‹åŽï¼Œä¸ä¼šæ¢è¡Œä¹ä¹ä¹˜æ³•è¡¨123456789101112131415161718192021#!/usr/bin/env python# -*- coding: utf-8 -*-# å®šä¹‰èµ·å§‹è¡Œrow = 1# æœ€å¤§æ‰“å° 9 è¡Œwhile row &lt;= 9: # å®šä¹‰èµ·å§‹åˆ— col = 1 # æœ€å¤§æ‰“å° row åˆ— while col &lt;= row: # end = ""ï¼Œè¡¨ç¤ºè¾“å‡ºç»“æŸåŽï¼Œä¸æ¢è¡Œ # "\t" å¯ä»¥åœ¨æŽ§åˆ¶å°è¾“å‡ºä¸€ä¸ªåˆ¶è¡¨ç¬¦ï¼ŒååŠ©åœ¨è¾“å‡ºæ–‡æœ¬æ—¶å¯¹é½ print("%d * %d = %d" % (col,row,col*row),end='\t') # åˆ—æ•° + 1 col += 1 # ä¸€è¡Œæ‰“å°å®Œæˆçš„æ¢è¡Œ print('') # è¡Œæ•° + 1 row += 1\t åœ¨æŽ§åˆ¶å°è¾“å‡ºä¸€ä¸ª åˆ¶è¡¨ç¬¦ï¼ŒååŠ©åœ¨è¾“å‡ºæ–‡æœ¬æ—¶ åž‚ç›´æ–¹å‘ ä¿æŒå¯¹é½\n åœ¨æŽ§åˆ¶å°è¾“å‡ºä¸€ä¸ª æ¢è¡Œç¬¦åˆ¶è¡¨ç¬¦ çš„åŠŸèƒ½æ˜¯åœ¨ä¸ä½¿ç”¨è¡¨æ ¼çš„æƒ…å†µä¸‹åœ¨ åž‚ç›´æ–¹å‘ æŒ‰åˆ—å¯¹é½æ–‡æœ¬PyCharm çš„è°ƒè¯•å·¥å…·F8 Step Over å¯ä»¥å•æ­¥æ‰§è¡Œä»£ç ï¼Œä¼šæŠŠå‡½æ•°è°ƒç”¨çœ‹ä½œæ˜¯ä¸€è¡Œä»£ç ç›´æŽ¥æ‰§è¡ŒF7 Step Into å¯ä»¥å•æ­¥æ‰§è¡Œä»£ç ï¼Œå¦‚æžœæ˜¯å‡½æ•°ï¼Œä¼šè¿›å…¥å‡½æ•°å†…éƒ¨å…ˆåœ¨è¯¥è¡Œæ‰“æ–­ç‚¹ï¼Œä¹Ÿå°±æ˜¯åœ¨è¯¥è¡Œè¡Œå·åŽé¢ç‚¹å‡»ä¸€ä¸‹ç„¶åŽä½¿ç”¨debugæ¨¡å¼è¿è¡Œä»£ç ï¼Œå¿«æ·é”®æ˜¯Shift+F9æœ€ä¸‹æ–¹æŽ§åˆ¶å°å‡ºçŽ°Debugçª—å£ï¼Œåˆ‡æ¢åˆ°Consoleæœ€åŽæ ¹æ®æƒ…å†µä½¿ç”¨F7æˆ–F8pycå­—èŠ‚ç æ–‡ä»¶c æ˜¯ compiled ç¼–è¯‘è¿‡ çš„æ„æ€æ“ä½œæ­¥éª¤æµè§ˆç¨‹åºç›®å½•ä¼šå‘çŽ°ä¸€ä¸ª __pycache__ çš„ç›®å½•è¯¥ç›®å½•ä¸‹ä¼šæœ‰å¥½å¤š.pycæ–‡ä»¶ï¼Œæ¯”å¦‚ï¼šajax_demo.cpython-36.pycã€‚cpython-36è¡¨ç¤º Python è§£é‡Šå™¨çš„ç‰ˆæœ¬è¿™ä¸ª pyc æ–‡ä»¶æ˜¯ç”± Python è§£é‡Šå™¨å°† æ¨¡å—çš„æºç  è½¬æ¢ä¸º å­—èŠ‚ç Python è¿™æ ·ä¿å­˜ å­—èŠ‚ç  æ˜¯ä½œä¸ºä¸€ç§å¯åŠ¨ é€Ÿåº¦çš„ä¼˜åŒ–å­—èŠ‚ç Python åœ¨è§£é‡Šæºç¨‹åºæ—¶æ˜¯åˆ†æˆä¸¤ä¸ªæ­¥éª¤çš„é¦–å…ˆå¤„ç†æºä»£ç ï¼Œç¼–è¯‘ ç”Ÿæˆä¸€ä¸ªäºŒè¿›åˆ¶ å­—èŠ‚ç å†å¯¹ å­—èŠ‚ç  è¿›è¡Œå¤„ç†ï¼Œæ‰ä¼šç”Ÿæˆ CPU èƒ½å¤Ÿè¯†åˆ«çš„ æœºå™¨ç æœ‰äº†æ¨¡å—çš„å­—èŠ‚ç æ–‡ä»¶ä¹‹åŽï¼Œä¸‹ä¸€æ¬¡è¿è¡Œç¨‹åºæ—¶ï¼Œå¦‚æžœåœ¨ ä¸Šæ¬¡ä¿å­˜å­—èŠ‚ç ä¹‹åŽ æ²¡æœ‰ä¿®æ”¹è¿‡æºä»£ç ï¼ŒPython å°†ä¼šåŠ è½½ .pyc æ–‡ä»¶å¹¶è·³è¿‡ç¼–è¯‘è¿™ä¸ªæ­¥éª¤å½“ Python é‡ç¼–è¯‘æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨æ£€æŸ¥æºæ–‡ä»¶å’Œå­—èŠ‚ç æ–‡ä»¶çš„æ—¶é—´æˆ³å¦‚æžœä½ åˆä¿®æ”¹äº†æºä»£ç ï¼Œä¸‹æ¬¡ç¨‹åºè¿è¡Œæ—¶ï¼Œå­—èŠ‚ç å°†è‡ªåŠ¨é‡æ–°åˆ›å»ºå…ƒç¥–å…ƒç»„ä¸­ åªåŒ…å«ä¸€ä¸ªå…ƒç´  æ—¶ï¼Œéœ€è¦ åœ¨å…ƒç´ åŽé¢æ·»åŠ é€—å·]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxç³»ç»Ÿscreenå‘½ä»¤ç®€è¿°ä½¿ç”¨]]></title>
    <url>%2F2019%2F12%2F31%2FLinux%E7%B3%BB%E7%BB%9Fscreen%E5%91%BD%E4%BB%A4%E7%AE%80%E8%BF%B0%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[èƒŒæ™¯ç³»ç»Ÿç®¡ç†å‘˜ç»å¸¸éœ€è¦SSH æˆ–è€…telent è¿œç¨‹ç™»å½•åˆ°Linux æœåŠ¡å™¨ï¼Œç»å¸¸è¿è¡Œä¸€äº›éœ€è¦å¾ˆé•¿æ—¶é—´æ‰èƒ½å®Œæˆçš„ä»»åŠ¡ï¼Œæ¯”å¦‚ç³»ç»Ÿå¤‡ä»½ã€ftp ä¼ è¾“ç­‰ç­‰ã€‚ é€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬éƒ½æ˜¯ä¸ºæ¯ä¸€ä¸ªè¿™æ ·çš„ä»»åŠ¡å¼€ä¸€ä¸ªè¿œç¨‹ç»ˆç«¯çª—å£ï¼Œå› ä¸ºå®ƒä»¬æ‰§è¡Œçš„æ—¶é—´å¤ªé•¿äº†ã€‚ å¿…é¡»ç­‰å¾…å®ƒä»¬æ‰§è¡Œå®Œæ¯•ï¼Œåœ¨æ­¤æœŸé—´ä¸èƒ½å…³æŽ‰çª—å£æˆ–è€…æ–­å¼€è¿žæŽ¥ï¼Œå¦åˆ™è¿™ä¸ªä»»åŠ¡å°±ä¼šè¢«æ€æŽ‰ï¼Œä¸€åˆ‡åŠé€”è€ŒåºŸäº†ã€‚ ç®€ä»‹GNU Screenæ˜¯ä¸€æ¬¾ç”±GNUè®¡åˆ’å¼€å‘çš„ç”¨äºŽå‘½ä»¤è¡Œç»ˆç«¯åˆ‡æ¢çš„è‡ªç”±è½¯ä»¶ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡è¯¥è½¯ä»¶åŒæ—¶è¿žæŽ¥å¤šä¸ªæœ¬åœ°æˆ–è¿œç¨‹çš„å‘½ä»¤è¡Œä¼šè¯ï¼Œå¹¶åœ¨å…¶é—´è‡ªç”±åˆ‡æ¢ã€‚ GNU Screenå¯ä»¥çœ‹ä½œæ˜¯çª—å£ç®¡ç†å™¨çš„å‘½ä»¤è¡Œç•Œé¢ç‰ˆæœ¬ã€‚å®ƒæä¾›äº†ç»Ÿä¸€çš„ç®¡ç†å¤šä¸ªä¼šè¯çš„ç•Œé¢å’Œç›¸åº”çš„åŠŸèƒ½ã€‚ ä¼šè¯æ¢å¤åªè¦Screenæœ¬èº«æ²¡æœ‰ç»ˆæ­¢ï¼Œåœ¨å…¶å†…éƒ¨è¿è¡Œçš„ä¼šè¯éƒ½å¯ä»¥æ¢å¤ã€‚è¿™ä¸€ç‚¹å¯¹äºŽè¿œç¨‹ç™»å½•çš„ç”¨æˆ·ç‰¹åˆ«æœ‰ç”¨â€”â€”å³ä½¿ç½‘ç»œè¿žæŽ¥ä¸­æ–­ï¼Œç”¨æˆ·ä¹Ÿä¸ä¼šå¤±åŽ»å¯¹å·²ç»æ‰“å¼€çš„å‘½ä»¤è¡Œä¼šè¯çš„æŽ§åˆ¶ã€‚ åªè¦å†æ¬¡ç™»å½•åˆ°ä¸»æœºä¸Šæ‰§è¡Œscreen -rå°±å¯ä»¥æ¢å¤ä¼šè¯çš„è¿è¡Œã€‚åŒæ ·åœ¨æš‚æ—¶ç¦»å¼€çš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œåˆ†ç¦»å‘½ä»¤detachï¼Œåœ¨ä¿è¯é‡Œé¢çš„ç¨‹åºæ­£å¸¸è¿è¡Œçš„æƒ…å†µä¸‹è®©ScreenæŒ‚èµ·ï¼ˆåˆ‡æ¢åˆ°åŽå°ï¼‰ã€‚ è¿™ä¸€ç‚¹å’Œå›¾å½¢ç•Œé¢ä¸‹çš„VNCå¾ˆç›¸ä¼¼ã€‚ å¤šçª—å£åœ¨ScreençŽ¯å¢ƒä¸‹ï¼Œæ‰€æœ‰çš„ä¼šè¯éƒ½ç‹¬ç«‹çš„è¿è¡Œï¼Œå¹¶æ‹¥æœ‰å„è‡ªçš„ç¼–å·ã€è¾“å…¥ã€è¾“å‡ºå’Œçª—å£ç¼“å­˜ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡å¿«æ·é”®åœ¨ä¸åŒçš„çª—å£ä¸‹åˆ‡æ¢ï¼Œå¹¶å¯ä»¥è‡ªç”±çš„é‡å®šå‘å„ä¸ªçª—å£çš„è¾“å…¥å’Œè¾“å‡ºã€‚ Screenå®žçŽ°äº†åŸºæœ¬çš„æ–‡æœ¬æ“ä½œï¼Œå¦‚å¤åˆ¶ç²˜è´´ç­‰ï¼›è¿˜æä¾›äº†ç±»ä¼¼æ»šåŠ¨æ¡çš„åŠŸèƒ½ï¼Œå¯ä»¥æŸ¥çœ‹çª—å£çŠ¶å†µçš„åŽ†å²è®°å½•ã€‚çª—å£è¿˜å¯ä»¥è¢«åˆ†åŒºå’Œå‘½åï¼Œè¿˜å¯ä»¥ç›‘è§†åŽå°çª—å£çš„æ´»åŠ¨ã€‚ ä¼šè¯å…±äº«Screenå¯ä»¥è®©ä¸€ä¸ªæˆ–å¤šä¸ªç”¨æˆ·ä»Žä¸åŒç»ˆç«¯å¤šæ¬¡ç™»å½•ä¸€ä¸ªä¼šè¯ï¼Œå¹¶å…±äº«ä¼šè¯çš„æ‰€æœ‰ç‰¹æ€§ï¼ˆæ¯”å¦‚å¯ä»¥çœ‹åˆ°å®Œå…¨ç›¸åŒçš„è¾“å‡ºï¼‰ã€‚å®ƒåŒæ—¶æä¾›äº†çª—å£è®¿é—®æƒé™çš„æœºåˆ¶ï¼Œå¯ä»¥å¯¹çª—å£è¿›è¡Œå¯†ç ä¿æŠ¤ã€‚ å®˜æ–¹ç«™ç‚¹GNU&apos;s Screen å®˜æ–¹ç«™ç‚¹ï¼šhttp://www.gnu.org/software/screen/ è¯­æ³•# screen [-AmRvx -ls -wipe][-d &lt;ä½œä¸šåç§°&gt;][-h &lt;è¡Œæ•°&gt;][-r &lt;ä½œä¸šåç§°&gt;][-s ][-S &lt;ä½œä¸šåç§°&gt;] å‚æ•°è¯´æ˜Ž -A å°†æ‰€æœ‰çš„è§†çª—éƒ½è°ƒæ•´ä¸ºç›®å‰ç»ˆç«¯æœºçš„å¤§å°ã€‚ -d &lt;ä½œä¸šåç§°&gt; å°†æŒ‡å®šçš„screenä½œä¸šç¦»çº¿ã€‚ -h &lt;è¡Œæ•°&gt; æŒ‡å®šè§†çª—çš„ç¼“å†²åŒºè¡Œæ•°ã€‚ -m å³ä½¿ç›®å‰å·²åœ¨ä½œä¸šä¸­çš„screenä½œä¸šï¼Œä»å¼ºåˆ¶å»ºç«‹æ–°çš„screenä½œä¸šã€‚ -r &lt;ä½œä¸šåç§°&gt; æ¢å¤ç¦»çº¿çš„screenä½œä¸šã€‚ -R å…ˆè¯•å›¾æ¢å¤ç¦»çº¿çš„ä½œä¸šã€‚è‹¥æ‰¾ä¸åˆ°ç¦»çº¿çš„ä½œä¸šï¼Œå³å»ºç«‹æ–°çš„screenä½œä¸šã€‚ -s æŒ‡å®šå»ºç«‹æ–°è§†çª—æ—¶ï¼Œæ‰€è¦æ‰§è¡Œçš„shellã€‚ -S &lt;ä½œä¸šåç§°&gt; æŒ‡å®šscreenä½œä¸šçš„åç§°ã€‚ -v æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ã€‚ -x æ¢å¤ä¹‹å‰ç¦»çº¿çš„screenä½œä¸šã€‚ -lsæˆ–--list æ˜¾ç¤ºç›®å‰æ‰€æœ‰çš„screenä½œä¸šã€‚ -wipe æ£€æŸ¥ç›®å‰æ‰€æœ‰çš„screenä½œä¸šï¼Œå¹¶åˆ é™¤å·²ç»æ— æ³•ä½¿ç”¨çš„screenä½œä¸šã€‚ å¸¸ç”¨screenå‚æ•°screen -S yourname -&gt; æ–°å»ºä¸€ä¸ªå«yournameçš„session screen -ls -&gt; åˆ—å‡ºå½“å‰æ‰€æœ‰çš„session screen -r yourname -&gt; å›žåˆ°yournameè¿™ä¸ªsession screen -d yourname -&gt; è¿œç¨‹detachæŸä¸ªsession screen -d -r yourname -&gt; ç»“æŸå½“å‰sessionå¹¶å›žåˆ°yournameè¿™ä¸ªsession åœ¨æ¯ä¸ªscreen session ä¸‹ï¼Œæ‰€æœ‰å‘½ä»¤éƒ½ä»¥ ctrl+a(C-a) å¼€å§‹ã€‚ C-a ? -&gt; æ˜¾ç¤ºæ‰€æœ‰é”®ç»‘å®šä¿¡æ¯ C-a c -&gt; åˆ›å»ºä¸€ä¸ªæ–°çš„è¿è¡Œshellçš„çª—å£å¹¶åˆ‡æ¢åˆ°è¯¥çª—å£ C-a n -&gt; Nextï¼Œåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ª window C-a p -&gt; Previousï¼Œåˆ‡æ¢åˆ°å‰ä¸€ä¸ª window C-a 0..9 -&gt; åˆ‡æ¢åˆ°ç¬¬ 0..9 ä¸ª window Ctrl+a [Space] -&gt; ç”±è§†çª—0å¾ªåºåˆ‡æ¢åˆ°è§†çª—9 C-a C-a -&gt; åœ¨ä¸¤ä¸ªæœ€è¿‘ä½¿ç”¨çš„ window é—´åˆ‡æ¢ C-a x -&gt; é”ä½å½“å‰çš„ windowï¼Œéœ€ç”¨ç”¨æˆ·å¯†ç è§£é” C-a d -&gt; detachï¼Œæš‚æ—¶ç¦»å¼€å½“å‰sessionï¼Œå°†ç›®å‰çš„ screen session (å¯èƒ½å«æœ‰å¤šä¸ª windows) ä¸¢åˆ°åŽå°æ‰§è¡Œï¼Œå¹¶ä¼šå›žåˆ°è¿˜æ²¡è¿› screen æ—¶çš„çŠ¶æ€ï¼Œæ­¤æ—¶åœ¨ screen session é‡Œï¼Œæ¯ä¸ª window å†…è¿è¡Œçš„ process (æ— è®ºæ˜¯å‰å°/åŽå°)éƒ½åœ¨ç»§ç»­æ‰§è¡Œï¼Œå³ä½¿ logout ä¹Ÿä¸å½±å“ã€‚ C-a z -&gt; æŠŠå½“å‰sessionæ”¾åˆ°åŽå°æ‰§è¡Œï¼Œç”¨ shell çš„ fg å‘½ä»¤åˆ™å¯å›žåŽ»ã€‚ C-a w -&gt; æ˜¾ç¤ºæ‰€æœ‰çª—å£åˆ—è¡¨ C-a t -&gt; Timeï¼Œæ˜¾ç¤ºå½“å‰æ—¶é—´ï¼Œå’Œç³»ç»Ÿçš„ load C-a k -&gt; kill windowï¼Œå¼ºè¡Œå…³é—­å½“å‰çš„ window C-a [ -&gt; è¿›å…¥ copy modeï¼Œåœ¨ copy mode ä¸‹å¯ä»¥å›žæ»šã€æœç´¢ã€å¤åˆ¶å°±åƒç”¨ä½¿ç”¨ vi ä¸€æ · C-b Backwardï¼ŒPageUp C-f Forwardï¼ŒPageDown H(å¤§å†™) Highï¼Œå°†å…‰æ ‡ç§»è‡³å·¦ä¸Šè§’ L Lowï¼Œå°†å…‰æ ‡ç§»è‡³å·¦ä¸‹è§’ 0 ç§»åˆ°è¡Œé¦– $ è¡Œæœ« w forward one wordï¼Œä»¥å­—ä¸ºå•ä½å¾€å‰ç§» b backward one wordï¼Œä»¥å­—ä¸ºå•ä½å¾€åŽç§» Space ç¬¬ä¸€æ¬¡æŒ‰ä¸ºæ ‡è®°åŒºèµ·ç‚¹ï¼Œç¬¬äºŒæ¬¡æŒ‰ä¸ºç»ˆç‚¹ Esc ç»“æŸ copy mode C-a ] -&gt; Pasteï¼ŒæŠŠåˆšåˆšåœ¨ copy mode é€‰å®šçš„å†…å®¹è´´ä¸Š ä½¿ç”¨ screenå®‰è£…screenæµè¡Œçš„Linuxå‘è¡Œç‰ˆï¼ˆä¾‹å¦‚Red Hat Enterprise Linuxï¼‰é€šå¸¸ä¼šè‡ªå¸¦screenå®žç”¨ç¨‹åºï¼Œå¦‚æžœæ²¡æœ‰çš„è¯ï¼Œå¯ä»¥ä»ŽGNU screençš„å®˜æ–¹ç½‘ç«™ä¸‹è½½ã€‚ # yum install screen # rpm -qa|grep screen åˆ›å»ºä¸€ä¸ªæ–°çš„çª—å£å®‰è£…å®ŒæˆåŽï¼Œç›´æŽ¥æ•²å‘½ä»¤screenå°±å¯ä»¥å¯åŠ¨å®ƒã€‚ä½†æ˜¯è¿™æ ·å¯åŠ¨çš„screenä¼šè¯æ²¡æœ‰åå­—ï¼Œå®žè·µä¸ŠæŽ¨èä¸ºæ¯ä¸ªscreenä¼šè¯å–ä¸€ä¸ªåå­—ï¼Œæ–¹ä¾¿åˆ†è¾¨ï¼š # screen -S meitulu screenå¯åŠ¨åŽï¼Œä¼šåˆ›å»ºç¬¬ä¸€ä¸ªçª—å£ï¼Œä¹Ÿå°±æ˜¯çª—å£No. 0ï¼Œå¹¶åœ¨å…¶ä¸­æ‰“å¼€ä¸€ä¸ªç³»ç»Ÿé»˜è®¤çš„shellï¼Œä¸€èˆ¬éƒ½ä¼šæ˜¯bashã€‚æ‰€ä»¥ä½ æ•²å…¥å‘½ä»¤screenä¹‹åŽï¼Œä¼šç«‹åˆ»åˆè¿”å›žåˆ°å‘½ä»¤æç¤ºç¬¦ï¼Œä»¿ä½›ä»€ä¹ˆä¹Ÿæ²¡æœ‰å‘ç”Ÿä¼¼çš„ï¼Œå…¶å®žä½ å·²ç»è¿›å…¥Screençš„ä¸–ç•Œäº†ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥åœ¨screenå‘½ä»¤ä¹‹åŽåŠ å…¥ä½ å–œæ¬¢çš„å‚æ•°ï¼Œä½¿ä¹‹ç›´æŽ¥æ‰“å¼€ä½ æŒ‡å®šçš„ç¨‹åºï¼Œä¾‹å¦‚ï¼š # screen vi 1.txt screenåˆ›å»ºä¸€ä¸ªæ‰§è¡Œvi 1.txtçš„å•çª—å£ä¼šè¯ï¼Œé€€å‡ºvi å°†é€€å‡ºè¯¥çª—å£/ä¼šè¯ã€‚ æŸ¥çœ‹çª—å£å’Œçª—å£åç§°æ‰“å¼€å¤šä¸ªçª—å£åŽï¼Œå¯ä»¥ä½¿ç”¨å¿«æ·é”®C-a wåˆ—å‡ºå½“å‰æ‰€æœ‰çª—å£ã€‚å¦‚æžœä½¿ç”¨æ–‡æœ¬ç»ˆç«¯ï¼Œè¿™ä¸ªåˆ—è¡¨ä¼šåˆ—åœ¨å±å¹•å·¦ä¸‹è§’ï¼Œå¦‚æžœä½¿ç”¨XçŽ¯å¢ƒä¸‹çš„ç»ˆç«¯æ¨¡æ‹Ÿå™¨ï¼Œè¿™ä¸ªåˆ—è¡¨ä¼šåˆ—åœ¨æ ‡é¢˜æ é‡Œã€‚çª—å£åˆ—è¡¨çš„æ ·å­ä¸€èˆ¬æ˜¯è¿™æ ·ï¼š 0$ bash 1-$ bash 2*$ bash è¿™ä¸ªä¾‹å­ä¸­æˆ‘å¼€å¯äº†ä¸‰ä¸ªçª—å£ï¼Œå…¶ä¸­*å·è¡¨ç¤ºå½“å‰ä½äºŽçª—å£2ï¼Œ-å·è¡¨ç¤ºä¸Šä¸€æ¬¡åˆ‡æ¢çª—å£æ—¶ä½äºŽçª—å£1ã€‚ Screené»˜è®¤ä¼šä¸ºçª—å£å‘½åä¸ºç¼–å·å’Œçª—å£ä¸­è¿è¡Œç¨‹åºåçš„ç»„åˆï¼Œä¸Šé¢çš„ä¾‹å­ä¸­çª—å£éƒ½æ˜¯é»˜è®¤åå­—ã€‚ ç»ƒä¹ äº†ä¸Šé¢æŸ¥çœ‹çª—å£çš„æ–¹æ³•ï¼Œä½ å¯èƒ½å°±å¸Œæœ›å„ä¸ªçª—å£å¯ä»¥æœ‰ä¸åŒçš„åå­—ä»¥æ–¹ä¾¿åŒºåˆ†äº†ã€‚ å¯ä»¥ä½¿ç”¨å¿«æ·é”®C-a Aæ¥ä¸ºå½“å‰çª—å£é‡å‘½åï¼ŒæŒ‰ä¸‹å¿«æ·é”®åŽï¼ŒScreenä¼šå…è®¸ä½ ä¸ºå½“å‰çª—å£è¾“å…¥æ–°çš„åå­—ï¼Œå›žè½¦ç¡®è®¤ã€‚ ä¼šè¯åˆ†ç¦»ä¸Žæ¢å¤å¯ä»¥ä¸ä¸­æ–­screençª—å£ä¸­ç¨‹åºçš„è¿è¡Œè€Œæš‚æ—¶æ–­å¼€ï¼ˆdetachï¼‰screenä¼šè¯ï¼Œå¹¶åœ¨éšåŽæ—¶é—´é‡æ–°è¿žæŽ¥ï¼ˆattachï¼‰è¯¥ä¼šè¯ï¼Œé‡æ–°æŽ§åˆ¶å„çª—å£ä¸­è¿è¡Œçš„ç¨‹åºã€‚ ä¾‹å¦‚ï¼Œæˆ‘ä»¬æ‰“å¼€ä¸€ä¸ªscreençª—å£ç¼–è¾‘/tmp/david.txtæ–‡ä»¶ï¼š # screen vi /tmp/1.txt ä¹‹åŽæˆ‘ä»¬æƒ³æš‚æ—¶é€€å‡ºåšç‚¹åˆ«çš„äº‹æƒ…ï¼Œæ¯”å¦‚å‡ºåŽ»æ•£æ•£æ­¥ï¼Œé‚£ä¹ˆåœ¨screençª—å£é”®å…¥C-a dï¼ŒScreenä¼šç»™å‡ºdetachedæç¤ºã€‚ ç­‰æˆ‘ä»¬å¿™å®Œå…¶ä»–äº‹æƒ…å›žæ¥åŽï¼Œæ‰¾åˆ°è¯¥screenä¼šè¯ï¼š # screen -ls é‡æ–°è¿žæŽ¥ä¼šè¯ï¼š# screen -r xxxxx å¦‚æžœä½ åœ¨å¦ä¸€å°æœºå™¨ä¸Šæ²¡æœ‰åˆ†ç¦»ä¸€ä¸ªScreenä¼šè¯ï¼Œå°±æ— ä»Žæ¢å¤ä¼šè¯äº†ã€‚ è¿™æ—¶å¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤å¼ºåˆ¶å°†è¿™ä¸ªä¼šè¯ä»Žå®ƒæ‰€åœ¨çš„ç»ˆç«¯åˆ†ç¦»ï¼Œè½¬ç§»åˆ°æ–°çš„ç»ˆç«¯ä¸Šæ¥ æ¸…é™¤dead ä¼šè¯å¦‚æžœç”±äºŽæŸç§åŽŸå› å…¶ä¸­ä¸€ä¸ªä¼šè¯æ­»æŽ‰äº†ï¼ˆä¾‹å¦‚äººä¸ºæ€æŽ‰è¯¥ä¼šè¯ï¼‰ï¼Œè¿™æ—¶screen -listä¼šæ˜¾ç¤ºè¯¥ä¼šè¯ä¸ºdeadçŠ¶æ€ï¼Œä½¿ç”¨screen -wipeå‘½ä»¤æ¸…é™¤è¯¥ä¼šè¯ã€‚ screen é«˜çº§åº”ç”¨ä¼šè¯å…±äº«è¿˜æœ‰ä¸€ç§æ¯”è¾ƒå¥½çŽ©çš„ä¼šè¯æ¢å¤ï¼Œå¯ä»¥å®žçŽ°ä¼šè¯å…±äº«ã€‚å‡è®¾ä½ åœ¨å’Œæœ‹å‹åœ¨ä¸åŒåœ°ç‚¹ä»¥ç›¸åŒç”¨æˆ·ç™»å½•ä¸€å°æœºå™¨ï¼Œç„¶åŽä½ åˆ›å»ºä¸€ä¸ªscreenä¼šè¯ï¼Œä½ æœ‹å‹å¯ä»¥åœ¨ä»–çš„ç»ˆç«¯ä¸Šå‘½ä»¤ï¼š # screen -x è¿™ä¸ªå‘½ä»¤ä¼šå°†ä½ æœ‹å‹çš„ç»ˆç«¯Attachåˆ°ä½ çš„Screenä¼šè¯ä¸Šï¼Œå¹¶ä¸”ä½ çš„ç»ˆç«¯ä¸ä¼šè¢«Detachã€‚ è¿™æ ·ä½ å°±å¯ä»¥å’Œæœ‹å‹å…±äº«åŒä¸€ä¸ªä¼šè¯äº†ï¼Œå¦‚æžœä½ ä»¬å½“å‰åˆå¤„äºŽåŒä¸€ä¸ªçª—å£ï¼Œé‚£å°±ç›¸å½“äºŽååœ¨åŒä¸€ä¸ªæ˜¾ç¤ºå™¨å‰é¢ï¼Œä½ çš„æ“ä½œä¼šåŒæ­¥æ¼”ç¤ºç»™ä½ æœ‹å‹ï¼Œä½ æœ‹å‹çš„æ“ä½œä¹Ÿä¼šåŒæ­¥æ¼”ç¤ºç»™ä½ ã€‚ å½“ç„¶ï¼Œå¦‚æžœä½ ä»¬åˆ‡æ¢åˆ°è¿™ä¸ªä¼šè¯çš„ä¸åŒçª—å£ä¸­åŽ»ï¼Œé‚£è¿˜æ˜¯å¯ä»¥åˆ†åˆ«è¿›è¡Œä¸åŒçš„æ“ä½œçš„ã€‚ ä¼šè¯é”å®šä¸Žè§£é”Screenå…è®¸ä½¿ç”¨å¿«æ·é”®C-a sé”å®šä¼šè¯ã€‚é”å®šä»¥åŽï¼Œå†è¿›è¡Œä»»ä½•è¾“å…¥å±å¹•éƒ½ä¸ä¼šå†æœ‰ååº”äº†ã€‚ä½†æ˜¯è¦æ³¨æ„è™½ç„¶å±å¹•ä¸Šçœ‹ä¸åˆ°ååº”ï¼Œä½†ä½ çš„è¾“å…¥éƒ½ä¼šè¢«Screenä¸­çš„è¿›ç¨‹æŽ¥æ”¶åˆ°ã€‚ å¿«æ·é”®C-a qå¯ä»¥è§£é”ä¸€ä¸ªä¼šè¯ã€‚ ä¹Ÿå¯ä»¥ä½¿ç”¨C-a xé”å®šä¼šè¯ï¼Œä¸åŒçš„æ˜¯è¿™æ ·é”å®šä¹‹åŽï¼Œä¼šè¯ä¼šè¢«Screenæ‰€å±žç”¨æˆ·çš„å¯†ç ä¿æŠ¤ï¼Œéœ€è¦è¾“å…¥å¯†ç æ‰èƒ½ç»§ç»­è®¿é—®è¿™ä¸ªä¼šè¯ã€‚ å‘é€å‘½ä»¤åˆ°screenä¼šè¯åœ¨Screenä¼šè¯ä¹‹å¤–ï¼Œå¯ä»¥é€šè¿‡screenå‘½ä»¤æ“ä½œä¸€ä¸ªScreenä¼šè¯ï¼Œè¿™ä¹Ÿä¸ºä½¿ç”¨Screenä½œä¸ºè„šæœ¬ç¨‹åºå¢žåŠ äº†ä¾¿åˆ©ã€‚ å…³äºŽScreenåœ¨è„šæœ¬ä¸­çš„åº”ç”¨è¶…å‡ºäº†å…¥é—¨çš„èŒƒå›´ï¼Œè¿™é‡Œåªçœ‹ä¸€ä¸ªä¾‹å­ï¼Œä½“ä¼šä¸€ä¸‹åœ¨ä¼šè¯ä¹‹å¤–å¯¹Screençš„æ“ä½œï¼š # screen -S aaa -X screen ping www.baidu.com è¿™ä¸ªå‘½ä»¤åœ¨ä¸€ä¸ªå«åšaaaçš„screenä¼šè¯ä¸­åˆ›å»ºä¸€ä¸ªæ–°çª—å£ï¼Œå¹¶åœ¨å…¶ä¸­è¿è¡Œpingå‘½ä»¤ã€‚ å±å¹•åˆ†å‰²çŽ°åœ¨æ˜¾ç¤ºå™¨é‚£ä¹ˆå¤§ï¼Œå°†ä¸€ä¸ªå±å¹•åˆ†å‰²æˆä¸åŒåŒºåŸŸæ˜¾ç¤ºä¸åŒçš„Screençª—å£æ˜¾ç„¶æ˜¯ä¸ªå¾ˆé…·çš„äº‹æƒ…ã€‚ å¯ä»¥ä½¿ç”¨å¿«æ·é”®C-a Så°†æ˜¾ç¤ºå™¨æ°´å¹³åˆ†å‰²ï¼ŒScreen 4.00.03ç‰ˆæœ¬ä»¥åŽï¼Œä¹Ÿæ”¯æŒåž‚ç›´åˆ†å±ï¼Œå¿«æ·é”®æ˜¯C-a |ã€‚ åˆ†å±ä»¥åŽï¼Œå¯ä»¥ä½¿ç”¨C-a &lt;tab&gt;åœ¨å„ä¸ªåŒºå—é—´åˆ‡æ¢ï¼Œæ¯ä¸€åŒºå—ä¸Šéƒ½å¯ä»¥åˆ›å»ºçª—å£å¹¶åœ¨å…¶ä¸­è¿è¡Œè¿›ç¨‹ã€‚ å¯ä»¥ç”¨C-a Xå¿«æ·é”®å…³é—­å½“å‰ç„¦ç‚¹æ‰€åœ¨çš„å±å¹•åŒºå—ï¼Œä¹Ÿå¯ä»¥ç”¨C-a Qå…³é—­é™¤å½“å‰åŒºå—ä¹‹å¤–å…¶ä»–çš„æ‰€æœ‰åŒºå—ã€‚ å…³é—­çš„åŒºå—ä¸­çš„çª—å£å¹¶ä¸ä¼šå…³é—­ï¼Œè¿˜å¯ä»¥é€šè¿‡çª—å£åˆ‡æ¢æ‰¾åˆ°å®ƒã€‚ C/Pæ¨¡å¼å’Œæ“ä½œscreençš„å¦ä¸€ä¸ªå¾ˆå¼ºå¤§çš„åŠŸèƒ½å°±æ˜¯å¯ä»¥åœ¨ä¸åŒçª—å£ä¹‹é—´è¿›è¡Œå¤åˆ¶ç²˜è´´äº†ã€‚ ä½¿ç”¨å¿«æ·é”®C-a &lt;Esc&gt;æˆ–è€…C-a [å¯ä»¥è¿›å…¥copy/pasteæ¨¡å¼ï¼Œè¿™ä¸ªæ¨¡å¼ä¸‹å¯ä»¥åƒåœ¨viä¸­ä¸€æ ·ç§»åŠ¨å…‰æ ‡ï¼Œå¹¶å¯ä»¥ä½¿ç”¨ç©ºæ ¼é”®è®¾ç½®æ ‡è®°ã€‚ å…¶å®žåœ¨è¿™ä¸ªæ¨¡å¼ä¸‹æœ‰å¾ˆå¤šç±»ä¼¼viçš„æ“ä½œï¼Œè­¬å¦‚ä½¿ç”¨/è¿›è¡Œæœç´¢ï¼Œä½¿ç”¨yå¿«é€Ÿæ ‡è®°ä¸€è¡Œï¼Œä½¿ç”¨wå¿«é€Ÿæ ‡è®°ä¸€ä¸ªå•è¯ç­‰ã€‚å…³äºŽC/Pæ¨¡å¼ä¸‹çš„é«˜çº§æ“ä½œï¼Œå…¶æ–‡æ¡£çš„è¿™ä¸€éƒ¨åˆ†æœ‰æ¯”è¾ƒè¯¦ç»†çš„è¯´æ˜Žã€‚ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¯ä»¥ç§»åŠ¨å…‰æ ‡åˆ°æŒ‡å®šä½ç½®ï¼ŒæŒ‰ä¸‹ç©ºæ ¼è®¾ç½®ä¸€ä¸ªå¼€å¤´æ ‡è®°ï¼Œç„¶åŽç§»åŠ¨å…‰æ ‡åˆ°ç»“å°¾ä½ç½®ï¼ŒæŒ‰ä¸‹ç©ºæ ¼è®¾ç½®ç¬¬äºŒä¸ªæ ‡è®°ï¼ŒåŒæ—¶ä¼šå°†ä¸¤ä¸ªæ ‡è®°ä¹‹é—´çš„éƒ¨åˆ†å‚¨å­˜åœ¨copy/paste bufferä¸­ï¼Œå¹¶é€€å‡ºcopy/pasteæ¨¡å¼ã€‚åœ¨æ­£å¸¸æ¨¡å¼ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨å¿«æ·é”®C-a ]å°†å‚¨å­˜åœ¨bufferä¸­çš„å†…å®¹ç²˜è´´åˆ°å½“å‰çª—å£ã€‚ æ›´å¤šscreenåŠŸèƒ½åŒå¤§å¤šæ•°UNIXç¨‹åºä¸€æ ·ï¼ŒGNU Screenæä¾›äº†ä¸°å¯Œå¼ºå¤§çš„å®šåˆ¶åŠŸèƒ½ã€‚ ä½ å¯ä»¥åœ¨Screençš„é»˜è®¤ä¸¤çº§é…ç½®æ–‡ä»¶/etc/screenrcå’Œ$HOME/.screenrcä¸­æŒ‡å®šæ›´å¤šï¼Œä¾‹å¦‚è®¾å®šscreené€‰é¡¹ï¼Œå®šåˆ¶ç»‘å®šé”®ï¼Œè®¾å®šscreenä¼šè¯è‡ªå¯åŠ¨çª—å£ï¼Œå¯ç”¨å¤šç”¨æˆ·æ¨¡å¼ï¼Œå®šåˆ¶ç”¨æˆ·è®¿é—®æƒé™æŽ§åˆ¶ç­‰ç­‰ã€‚å¦‚æžœä½ æ„¿æ„çš„è¯ï¼Œä¹Ÿå¯ä»¥è‡ªå·±æŒ‡å®šscreené…ç½®æ–‡ä»¶ã€‚ ä»¥å¤šç”¨æˆ·åŠŸèƒ½ä¸ºä¾‹ï¼Œscreené»˜è®¤æ˜¯ä»¥å•ç”¨æˆ·æ¨¡å¼è¿è¡Œçš„ï¼Œä½ éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šmultiuser on æ¥æ‰“å¼€å¤šç”¨æˆ·æ¨¡å¼ï¼Œé€šè¿‡acl*ï¼ˆacladd,acldel,aclchg...ï¼‰å‘½ä»¤ï¼Œä½ å¯ä»¥çµæ´»é…ç½®å…¶ä»–ç”¨æˆ·è®¿é—®ä½ çš„screenä¼šè¯ã€‚æ›´å¤šé…ç½®æ–‡ä»¶å†…å®¹è¯·å‚è€ƒscreençš„mané¡µã€‚ å¸¸ç”¨åŠŸèƒ½1. åœ¨å‘½ä»¤è¡Œç»ˆç«¯è¾“å…¥ï¼šscreenï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„çª—å£ 2. åœ¨è¿™ä¸ªæ–°çª—å£ä¸­è¾“å…¥è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæ¯”å¦‚ï¼špython 1.py ï¼Œå°±ç®—æœ‰æ‰“å°è¾“å‡ºä¹Ÿä¸ç¢äº‹ï¼Œå…³é—­è¿™ä¸ªç»ˆç«¯ 3. æ–°å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œè¾“å…¥ï¼šscreen -lsï¼ŒæŸ¥çœ‹æ‰€æœ‰æ‰“å¼€çš„screençª—å£ã€‚ 4. ä½¿ç”¨å‘½ä»¤ï¼šscreen -r xxxx,å†æ¬¡è¿›å…¥ä¸Šä¸€æ­¥çš„çª—å£ï¼ŒæŸ¥çœ‹å‘½ä»¤çš„æ‰§è¡Œæƒ…å†µç­‰ã€‚ å¸¸è§é—®é¢˜1. è§£å†³screençŠ¶æ€ä¸ºAttachedè¿žä¸Šä¸çš„é—®é¢˜ é—®é¢˜æè¿°ï¼š ç”¨ screen -ls, æ˜¾å¼å½“å‰çŠ¶æ€ä¸ºAttachedï¼Œ ä½†å½“å‰æ²¡æœ‰ç”¨æˆ·ç™»é™†äº›ä¼šè¯ã€‚ screenæ­¤æ—¶æ­£å¸¸çŠ¶æ€åº”è¯¥ä¸º(Detached) ï¼Œæ­¤æ—¶ç”¨screen -r &lt;session-id&gt;ï¼Œæ€Žä¹ˆä¹Ÿç™»ä¸ä¸Š è§£å†³æ–¹æ³•ï¼š screen -D -r ï¼œsession-id&gt; -D -r å…ˆè¸¢æŽ‰å‰ä¸€ç”¨æˆ·ï¼Œå†ç™»é™†]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hexoæ­å»ºæ•™ç¨‹(4)]]></title>
    <url>%2F2019%2F12%2F31%2FHexo%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B-4%2F</url>
    <content type="text"><![CDATA[ç¬¬ä¸‰éƒ¨åˆ†æˆ‘è¿™ä¸ªåšå®¢é‡‡ç”¨çš„æ˜¯nextä¸»é¢˜ï¼ŒæŽ¥ä¸‹æ¥æŠŠæˆ‘åšå®¢å…³äºŽä¸»é¢˜çš„é…ç½®æ±‡æ€»ä¸€ä¸‹ï¼Œç»™ä½¿ç”¨è¯¥ä¸»é¢˜çš„å…¶ä»–ç”¨æˆ·åšä¸ªå‚è€ƒã€‚ å®‰è£…ä¸»é¢˜å¯ç”¨ä¸»é¢˜é€‰æ‹©Schemeè®¾ç½®è¯­è¨€è®¾ç½®èœå•åˆ†ç±»/æ ‡ç­¾æ·»åŠ fork me on githubåŠ¨æ€èƒŒæ™¯æ·»åŠ ç‚¹å‡»çˆ±å¿ƒæ•ˆæžœè®¾ç½®RSSä¿®æ”¹æ–‡ç« åº•éƒ¨çš„é‚£ä¸ªå¸¦#å·çš„æ ‡ç­¾åœ¨æ¯ç¯‡æ–‡ç« æœ«å°¾ç»Ÿä¸€æ·»åŠ â€œæœ¬æ–‡ç»“æŸâ€æ ‡è®°ä¾§è¾¹æ ç¤¾äº¤å°å›¾æ ‡è®¾ç½®ä¸»é¡µæ–‡ç« åŠ é˜´å½±è®¾ç½®ç½‘ç«™å›¾æ ‡è®¾ç½®æ—‹è½¬å¤´åƒå¼€å¯æ‰“èµåŠŸèƒ½è®¾ç½®é¦–é¡µä¸æ˜¾ç¤ºå…¨æ–‡(åªæ˜¾ç¤ºé¢„è§ˆ)æ–‡ç« å­—æ•°ç»Ÿè®¡å’Œé˜…è¯»æ—¶é•¿æ–‡ç« åº•éƒ¨å¢žåŠ ç‰ˆæƒä¿¡æ¯ç½‘ç«™åº•éƒ¨å­—æ•°ç»Ÿè®¡éšè—ç½‘é¡µåº•éƒ¨ ç”±Hexoå¼ºåŠ›é©±åŠ¨ä¿®æ”¹ç½‘é¡µåº•éƒ¨çš„æ¡ƒå¿ƒä¿®æ”¹æ–‡ç« å†…é“¾æŽ¥æ–‡æœ¬æ ·å¼æ·»åŠ é¡¶éƒ¨åŠ è½½æ¡ä¿®æ”¹å­—ä½“å¤§å°æ–‡ç« åŠ å¯†è®¿é—®æ·»åŠ jiathisåˆ†äº«åšæ–‡ç½®é¡¶è‡ªå®šä¹‰é¼ æ ‡æ ·å¼ä¸ºåšå®¢åŠ ä¸ŠèŒèŒçš„å® ç‰©æœç´¢åŠŸèƒ½åŒå‡»é¼ æ ‡æ˜¾ç¤ºçˆ†ç‚¸æ•ˆæžœè‡ªå®šä¹‰æ–‡ç« çš„é»˜è®¤å¤´éƒ¨ä¿¡æ¯æ–‡ç« æ ‡ç­¾æ˜¾ç¤ºè®¾ç½®åœ¨åº•éƒ¨å¢žåŠ è¿è¡Œæ—¶é—´åˆ©ç”¨ Gulp æ¥åŽ‹ç¼©ä½ çš„ Hexo åšå®¢çš„é™æ€æ–‡ä»¶æ·»åŠ ç½‘ç«™å’Œæ–‡ç« åˆ†äº«æŒ‰é’®åŽ‹ç¼©é¡µé¢é™æ€èµ„æºåˆ é™¤åšæ–‡ç›®å½•è‡ªåŠ¨ç”Ÿæˆçš„åºæ•°ä¸è’œå­ç»Ÿè®¡æ·»åŠ å‹æƒ…é“¾æŽ¥è…¾è®¯å…¬ç›Š404é¡µé¢è®¾ç½®åŠ¨ç”»æ•ˆæžœæ·»åŠ è¿‘æœŸæ–‡ç« ç‰ˆå—æ·»åŠ ç½‘æ˜“äº‘éŸ³ä¹å¤–é“¾å®‰è£…ä¸»é¢˜åœ¨åšå®¢æ ¹ç›®å½•ä¸‹æ‰“å¼€å‘½ä»¤è¡Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š git clone https://github.com/theme-next/hexo-theme-next themes/next å°±ä¼šå°†å°†nextä¸»é¢˜ä¸‹è½½åˆ°å½“å‰ç›®å½•ä¸‹çš„themesé‡Œé¢çš„nextæ–‡ä»¶å¤¹ä¸­ å¯ç”¨ä¸»é¢˜åœ¨åšå®¢æ ¹ç›®å½•ä¸‹ä¿®æ”¹ç«™ç‚¹é…ç½®æ–‡ä»¶_config.yml # Extensions ## Plugins: https://hexo.io/plugins/ ## Themes: https://hexo.io/themes/ theme: next æ³¨æ„å†’å·åŽé¢æœ‰ä¸ªç©ºæ ¼ é€‰æ‹© SchemeSchemeæ˜¯NexTæä¾›çš„ä¸€ç§ç‰¹æ€§ï¼Œå€ŸåŠ©äºŽSchemeï¼ŒNexTä¸ºä½ æä¾›å¤šç§ä¸åŒçš„å¤–è§‚ã€‚ åŒæ—¶ï¼Œå‡ ä¹Žæ‰€æœ‰çš„é…ç½®éƒ½å¯ä»¥åœ¨Schemeä¹‹é—´å…±ç”¨ã€‚ç›®å‰ NexT æ”¯æŒå››ç§ Schemeï¼Œä»–ä»¬æ˜¯ï¼š Muse - é»˜è®¤ Schemeï¼Œè¿™æ˜¯ NexT æœ€åˆçš„ç‰ˆæœ¬ï¼Œé»‘ç™½ä¸»è°ƒï¼Œå¤§é‡ç•™ç™½ Mist - Muse çš„ç´§å‡‘ç‰ˆæœ¬ï¼Œæ•´æ´æœ‰åºçš„å•æ å¤–è§‚ Pisces - åŒæ  Schemeï¼Œå°å®¶ç¢§çŽ‰ä¼¼çš„æ¸…æ–° Gemini - å·¦ä¾§ç½‘ç«™ä¿¡æ¯åŠç›®å½•ï¼Œå—+ç‰‡æ®µç»“æž„å¸ƒå±€ scheme çš„åˆ‡æ¢é€šè¿‡æ›´æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶ï¼Œæœç´¢Schemeså…³é”®å­—ã€‚æˆ‘é€‰æ‹©çš„æ˜¯scheme: Gemini ä½ ä¼šçœ‹åˆ°æœ‰å››è¡Œschemeçš„é…ç½®ï¼Œå°†ä½ éœ€ç”¨å¯ç”¨çš„schemeå‰é¢æ³¨é‡Š # åŽ»é™¤å³å¯ã€‚ ç„¶åŽä½¿ç”¨å‘½ä»¤ï¼šhexo s --debugï¼Œæ‰“å¼€æµè§ˆå™¨è¾“å…¥åœ°å€ï¼š127.0.0.1:4000å³å¯æŸ¥çœ‹æ•ˆæžœ è®¾ç½®è¯­è¨€ç¼–è¾‘ç«™ç‚¹é…ç½®æ–‡ä»¶ï¼Œå°†languageè®¾ç½®æˆä½ æ‰€éœ€è¦çš„è¯­è¨€ï¼Œå»ºè®®æ˜Žç¡®è®¾ç½®ä½ æ‰€éœ€è¦çš„è¯­è¨€ï¼Œä¾‹å¦‚é€‰ç”¨ç®€ä½“ä¸­æ–‡ã€‚ é…ç½®å¦‚ä¸‹ï¼šlanguage: zh-Hansã€‚æ³¨æ„è¿™ä¸ªè¦çœ‹ä¸»é¢˜æ–‡ä»¶å¤¹ä¸­çš„è¯­è¨€åŒ…ä¸­æ–‡è¯­è¨€åŒ…çš„åç§°ï¼Œæˆ‘è®¾ç½®çš„æ˜¯language: zh-Hans æ³¨æ„ï¼šä½¿ç”¨hexo sé¢„è§ˆçš„æ—¶å€™ï¼Œä¼šå‘çŽ°æ˜¯è®¾ç½®äº†è¯­è¨€ä¹‹åŽç•Œé¢è¿˜æ˜¯è‹±æ–‡ï¼Œæ­¤æ—¶ä½¿ç”¨hexo cleanæ¸…ç†ä¸‹databaseæ–‡ä»¶å¤¹ä»¥åŠpublicæ–‡ä»¶å¤¹å°±è¡Œäº†ï¼Œç„¶åŽå†ä½¿ç”¨hexo s é¢„è§ˆã€‚ è®¾ç½®èœå•èœå•é…ç½®åŒ…æ‹¬ä¸‰ä¸ªéƒ¨åˆ†ï¼Œç¬¬ä¸€æ˜¯èœå•é¡¹ï¼ˆåç§°å’Œé“¾æŽ¥ï¼‰ï¼Œç¬¬äºŒæ˜¯èœå•é¡¹çš„æ˜¾ç¤ºæ–‡æœ¬ï¼Œç¬¬ä¸‰æ˜¯èœå•é¡¹å¯¹åº”çš„å›¾æ ‡ã€‚ NexTä½¿ç”¨çš„æ˜¯Font Awesomeæä¾›çš„å›¾æ ‡ï¼Œ Font Awesomeæä¾›äº†600+çš„å›¾æ ‡ï¼Œå¯ä»¥æ»¡è¶³ç»å¤§çš„å¤šæ•°çš„åœºæ™¯ï¼ŒåŒæ—¶æ— é¡»æ‹…å¿ƒåœ¨Retinaå±å¹•ä¸‹å›¾æ ‡æ¨¡ç³Šçš„é—®é¢˜ã€‚ ç¼–è¾‘ä¸»é¢˜é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹ä»¥ä¸‹å†…å®¹ï¼š è®¾å®šèœå•å†…å®¹ï¼Œå¯¹åº”çš„å­—æ®µæ˜¯ menuã€‚ èœå•å†…å®¹çš„è®¾ç½®æ ¼å¼æ˜¯ï¼šitem name: link || å›¾æ ‡ã€‚å…¶ä¸­ item name æ˜¯ä¸€ä¸ªåç§°ï¼Œè¿™ä¸ªåç§°å¹¶ä¸ç›´æŽ¥æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œå®ƒå°†ç”¨äºŽåŒ¹é…å›¾æ ‡ä»¥åŠç¿»è¯‘ã€‚ æˆ‘çš„è®¾ç½®å¦‚ä¸‹ï¼š menu: home: / || home tags: /tags/ || tags categories: /categories/ || th archives: /archives/ || archive about: /about/ || user æ˜¾ç¤ºæ•ˆæžœå¦‚ä¸‹ï¼š å…³äºŽè®¾ç½®çš„æ˜¯è‹±è¯­ï¼Œç½‘ç«™æ˜¾ç¤ºçš„æ˜¯ä¸­æ–‡ï¼Œè¿™ä¸ªè¦å¦‚ä½•ç†è§£ï¼Ÿ 1. ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­èœå•è®¾ç½®çš„æ˜¯è‹±æ–‡ï¼Œä½†æ˜¯ç«™ç‚¹é…ç½®æ–‡ä»¶é…ç½®çš„ç½‘ç«™è¯­è¨€æ˜¯zh-Hansï¼Œä¹Ÿå°±æ˜¯ç®€ä½“ä¸­æ–‡ã€‚ 2. æ­¤æ—¶ï¼Œè®¿é—®ç½‘ç«™çš„è¯èœå•ä¼šä»Žä¸»é¢˜æ–‡ä»¶çš„è¯­è¨€åŒ…ä¸­æ‰¾åˆ°zh-Hans.ymlè¿™ä¸ªä¸­æ–‡è¯­è¨€åŒ…ï¼ŒæŸ¥æ‰¾å…¶ä¸­æ˜¯å¦æœ‰å…³äºŽmenuçš„ç¿»è¯‘ï¼Œè‹¥æœ‰ï¼Œåˆ™ç½‘ç«™ä¸Šæ˜¾ç¤ºå‡ºæ¥ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š åˆ†ç±»/æ ‡ç­¾æ¯”å¦‚è®¾ç½®çš„æœ‰åˆ†ç±»ï¼Œä½†æ˜¯ç‚¹å‡»è¿›åŽ»å´æŠ¥é”™ï¼šCannot GET /tags/ï¼Œä¸èƒ½èŽ·å–tagsï¼Œé»˜è®¤è¿™äº›éœ€è¦æˆ‘ä»¬è‡ªå·±åˆ›å»ºã€‚ ä»‹ç»ä¸€ä¸‹åˆ›å»ºpageçš„è¯­æ³•ï¼šhexo new page &apos;name&apos; åœ¨æŽ§åˆ¶å°è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š hexo new page &apos;tags&apos; #åˆ›å»ºtagså­ç›®å½• hexo new page &apos;categories&apos; #åˆ›å»ºcategorieså­ç›®å½• hexo new page &apos;about&apos; #åˆ›å»ºaboutå­ç›®å½• åœ¨ä½ çš„ç½‘ç«™æ ¹ç›®å½•ä¸‹é¢çš„sourceæ–‡ä»¶å¤¹ä¼šåˆ†åˆ«ç”Ÿæˆtagsã€categoriesä»¥åŠaboutæ–‡ä»¶å¤¹ã€‚ ä¿®æ”¹tagsæ–‡ä»¶å¤¹ä¸­çš„index.mdæ–‡ä»¶ï¼Œæ–°å¢žtypeå±žæ€§ï¼Œå¦‚ä¸‹ï¼š --- title: tags date: 2018-01-04 11:45:41 type: &quot;tags&quot; --- å…¶ä»–çš„ä¿®æ”¹ç±»ä¼¼ã€‚è¿™æ ·ä¸€æ¥å½“ä½ æ–°å»ºä¸€ç¯‡åšæ–‡çš„æ—¶å€™ï¼Œå¢žåŠ ä¸Štagså’Œcategorieså±žæ€§å€¼ï¼Œå°±èƒ½åœ¨tagså’Œcategoriesç•Œé¢æ£€ç´¢åˆ°ä½ çš„æ–‡ç« äº†ã€‚ æ±‡æ€»ä¸€ä¸‹æ­¥éª¤ï¼š tags:æ·»åŠ ã€Œæ ‡ç­¾ã€é¡µé¢ æ–°å»ºã€Œæ ‡ç­¾ã€é¡µé¢ï¼Œå¹¶åœ¨èœå•ä¸­æ˜¾ç¤ºã€Œæ ‡ç­¾ã€é“¾æŽ¥ã€‚ã€Œæ ‡ç­¾ã€é¡µé¢å°†å±•ç¤ºç«™ç‚¹çš„æ‰€æœ‰æ ‡ç­¾ï¼Œè‹¥ä½ çš„æ‰€æœ‰æ–‡ç« éƒ½æœªåŒ…å«æ ‡ç­¾ï¼Œæ­¤é¡µé¢å°†æ˜¯ç©ºçš„ã€‚ åº•ä¸‹ä»£ç æ˜¯ä¸€ç¯‡åŒ…å«æ ‡ç­¾çš„æ–‡ç« çš„ä¾‹å­ï¼š --- title: æ ‡ç­¾æµ‹è¯•æ–‡ç«  tags: - Testing - Another Tag --- æˆ–è€…ä½¿ç”¨è¿™ç§æ–¹å¼ï¼štags: [Testing, Another Tag],ä¸­é—´æ˜¯å…ˆé€—å·ï¼ŒåŽç©ºæ ¼ 1. ä¿®æ”¹èœå• åœ¨èœå•ä¸­æ·»åŠ é“¾æŽ¥ã€‚ç¼–è¾‘ ä¸»é¢˜é…ç½®æ–‡ä»¶ ï¼Œ æ·»åŠ  tags åˆ° menu ä¸­ï¼Œå¦‚ä¸‹: menu: home: / || home archives: /archives || archives tags: /tags || tags 2. æ–°å»ºé¡µé¢ åœ¨ç»ˆç«¯çª—å£ä¸‹ï¼Œå®šä½åˆ° Hexo ç«™ç‚¹ç›®å½•ä¸‹ã€‚ä½¿ç”¨ hexo new page æ–°å»ºä¸€ä¸ªé¡µé¢ï¼Œå‘½åä¸º tags ï¼š $ cd your-hexo-site $ hexo new page tags 3. è®¾ç½®é¡µé¢ç±»åž‹ ç¼–è¾‘åˆšæ–°å»ºçš„é¡µé¢ï¼Œå°†é¡µé¢çš„ç±»åž‹è®¾ç½®ä¸º tags ï¼Œä¸»é¢˜å°†è‡ªåŠ¨ä¸ºè¿™ä¸ªé¡µé¢æ˜¾ç¤ºæ ‡ç­¾äº‘ã€‚é¡µé¢å†…å®¹å¦‚ä¸‹ï¼š --- title: tags date: 2014-12-22 12:39:04 type: &quot;tags&quot; --- æ³¨æ„ï¼šå¦‚æžœæœ‰é›†æˆè¯„è®ºæœåŠ¡ï¼Œé¡µé¢ä¹Ÿä¼šå¸¦æœ‰è¯„è®ºã€‚ è‹¥éœ€è¦å…³é—­çš„è¯ï¼Œè¯·æ·»åŠ å­—æ®µ comments å¹¶å°†å€¼è®¾ç½®ä¸º falseï¼Œå¦‚ï¼š --- title: tags date: 2014-12-22 12:39:04 type: &quot;tags&quot; comments: false --- categories:æ·»åŠ ã€Œåˆ†ç±»ã€é¡µé¢ æ–°å»ºã€Œåˆ†ç±»ã€é¡µé¢ï¼Œå¹¶åœ¨èœå•ä¸­æ˜¾ç¤ºã€Œåˆ†ç±»ã€é“¾æŽ¥ã€‚ã€Œåˆ†ç±»ã€é¡µé¢å°†å±•ç¤ºç«™ç‚¹çš„æ‰€æœ‰åˆ†ç±»ï¼Œè‹¥ä½ çš„æ‰€æœ‰æ–‡ç« éƒ½æœªåŒ…å«åˆ†ç±»ï¼Œæ­¤é¡µé¢å°†æ˜¯ç©ºçš„ã€‚ åº•ä¸‹ä»£ç æ˜¯ä¸€ç¯‡åŒ…å«åˆ†ç±»çš„æ–‡ç« çš„ä¾‹å­ï¼š --- title: åˆ†ç±»æµ‹è¯•æ–‡ç«  categories: - Testing --- 1. ä¿®æ”¹èœå• åœ¨èœå•ä¸­æ·»åŠ é“¾æŽ¥ã€‚ç¼–è¾‘ ä¸»é¢˜é…ç½®æ–‡ä»¶ ï¼Œ æ·»åŠ  categories åˆ° menu ä¸­ï¼Œå¦‚ä¸‹: menu: home: / || home archives: /archives || archives categories: /categories || categories 2. æ–°å»ºé¡µé¢ åœ¨ç»ˆç«¯çª—å£ä¸‹ï¼Œå®šä½åˆ° Hexo ç«™ç‚¹ç›®å½•ä¸‹ã€‚ä½¿ç”¨ hexo new page æ–°å»ºä¸€ä¸ªé¡µé¢ï¼Œå‘½åä¸º categories ï¼š $ cd your-hexo-site $ hexo new page categories 3. è®¾ç½®é¡µé¢ç±»åž‹ ç¼–è¾‘åˆšæ–°å»ºçš„é¡µé¢ï¼Œå°†é¡µé¢çš„ type è®¾ç½®ä¸º categories ï¼Œä¸»é¢˜å°†è‡ªåŠ¨ä¸ºè¿™ä¸ªé¡µé¢æ˜¾ç¤ºåˆ†ç±»ã€‚é¡µé¢å†…å®¹å¦‚ä¸‹ï¼š --- title: categories date: 2014-12-22 12:39:04 type: &quot;categories&quot; --- æ³¨æ„ï¼šå¦‚æžœæœ‰é›†æˆè¯„è®ºæœåŠ¡ï¼Œé¡µé¢ä¹Ÿä¼šå¸¦æœ‰è¯„è®ºã€‚ è‹¥éœ€è¦å…³é—­çš„è¯ï¼Œè¯·æ·»åŠ å­—æ®µ comments å¹¶å°†å€¼è®¾ç½®ä¸º falseï¼Œå¦‚ï¼š --- title: categories date: 2014-12-22 12:39:04 type: &quot;categories&quot; comments: false --- åˆ†ç±»å’Œæ ‡ç­¾çš„å·®åˆ«ï¼š åœ¨ Hexo ä¸­ï¼šåˆ†ç±»å…·æœ‰é¡ºåºæ€§å’Œå±‚æ¬¡æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ Foo, Bar ä¸ç­‰äºŽ Bar, Fooï¼›è€Œæ ‡ç­¾æ²¡æœ‰é¡ºåºå’Œå±‚æ¬¡ã€‚ æ·»åŠ fork me on githubåœ¨http://tholman.com/github-corners/æˆ–è€…https://github.com/blog/273-github-ribbons é€‰æ‹©åˆé€‚çš„æ ·å¼å¤åˆ¶ä»£ç åˆ°themes/next/layout/_layout.swigï¼Œåœ¨&lt;div class=&quot;headband&quot;&gt;&lt;/div&gt;ä¸‹é¢ï¼š æˆ‘é€‰ç”¨çš„æ•ˆæžœï¼š åŠ¨æ€èƒŒæ™¯ç›®å‰NexTä¸»é¢˜æœ‰4ç§åŠ¨æ€èƒŒæ™¯ï¼Œè®¾ç½®æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œç›´æŽ¥è®¾ç½®é‡Œéœ€è¦çš„åŠ¨æ€èƒŒæ™¯ä¸ºtrueï¼š - Canvas-nest - three_waves - canvas_lines - canvas_sphere æˆ‘è®¾ç½®çš„æ˜¯ï¼šcanvas_nest: true æ·»åŠ ç‚¹å‡»çˆ±å¿ƒæ•ˆæžœåœ¨/themes/next/source/js/srcä¸‹æ–°å»ºæ–‡ä»¶love.jsï¼ŒæŽ¥ç€æŠŠè¯¥ä»£ç æ‹·è´ç²˜è´´åˆ°love.jsæ–‡ä»¶ä¸­ã€‚ ä»£ç å¦‚ä¸‹ï¼š ! function(e, t, a) { function n() { c(&quot;.heart{width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: &apos;&apos;;width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;}.heart:after{top: -5px;}.heart:before{left: -5px;}&quot;), o(), r() } function r() { for (var e = 0; e &lt; d.length; e++) d[e].alpha &lt;= 0 ? (t.body.removeChild(d[e].el), d.splice(e, 1)) : (d[e].y--, d[e].scale += .004, d[e].alpha -= .013, d[e].el.style.cssText = &quot;left:&quot; + d[e].x + &quot;px;top:&quot; + d[e].y + &quot;px;opacity:&quot; + d[e].alpha + &quot;;transform:scale(&quot; + d[e].scale + &quot;,&quot; + d[e].scale + &quot;) rotate(45deg);background:&quot; + d[e].color + &quot;;z-index:99999&quot;); requestAnimationFrame(r) } function o() { var t = &quot;function&quot; == typeof e.onclick &amp;&amp; e.onclick; e.onclick = function(e) { t &amp;&amp; t(), i(e) } } function i(e) { var a = t.createElement(&quot;div&quot;); a.className = &quot;heart&quot;, d.push({ el: a, x: e.clientX - 5, y: e.clientY - 5, scale: 1, alpha: 1, color: s() }), t.body.appendChild(a) } function c(e) { var a = t.createElement(&quot;style&quot;); a.type = &quot;text/css&quot;; try { a.appendChild(t.createTextNode(e)) } catch(t) { a.styleSheet.cssText = e } t.getElementsByTagName(&quot;head&quot;)[0].appendChild(a) } function s() { return &quot;rgb(&quot; + ~~ (255 * Math.random()) + &quot;,&quot; + ~~ (255 * Math.random()) + &quot;,&quot; + ~~ (255 * Math.random()) + &quot;)&quot; } var d = []; e.requestAnimationFrame = function() { return e.requestAnimationFrame || e.webkitRequestAnimationFrame || e.mozRequestAnimationFrame || e.oRequestAnimationFrame || e.msRequestAnimationFrame || function(e) { setTimeout(e, 1e3 / 60) } } (), n() } (window, document); ç„¶åŽä¿®æ”¹_layout.swigï¼Œåœ¨\themes\next\layout\_layout.swigæ–‡ä»¶æœ«å°¾æ·»åŠ ï¼š &lt;!-- é¡µé¢ç‚¹å‡»å°çº¢å¿ƒ --&gt; &lt;script type=&quot;text/javascript&quot; src=&quot;/js/src/love.js&quot;&gt;&lt;/script&gt; æ•ˆæžœå¦‚ä¸‹ï¼š è®¾ç½®RSSåœ¨åšå®¢ä¸ªç›®å½•ä¸‹è¿è¡Œå‘½ä»¤è¡Œï¼Œå®‰è£…æ’ä»¶ï¼šnpm install --save hexo-generator-feedï¼Œ ç„¶åŽæ‰“å¼€ç«™ç‚¹é…ç½®æ–‡ä»¶ï¼Œåœ¨æœ«å°¾æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š (è¯·æ³¨æ„åœ¨å†’å·åŽé¢è¦åŠ ä¸€ä¸ªç©ºæ ¼ï¼Œä¸ç„¶ä¼šå‘ç”Ÿé”™è¯¯ï¼) # Extensions ## Plugins: https://hexo.io/plugins/ #RSSè®¢é˜… plugin: - hexo-generator-feed æœ€åŽåœ¨nextä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­æ‰¾åˆ°rss,è®¾ç½®æˆï¼šrss: /atom.xmlã€‚ é…ç½®å®Œä¹‹åŽè¿è¡Œï¼šhexo g,é‡æ–°ç”Ÿæˆä¸€æ¬¡ï¼Œä½ ä¼šåœ¨./public æ–‡ä»¶å¤¹ä¸­çœ‹åˆ° atom.xml æ–‡ä»¶ã€‚ æ•ˆæžœå±•ç¤ºï¼š ä¿®æ”¹æ–‡ç« åº•éƒ¨çš„é‚£ä¸ªå¸¦#å·çš„æ ‡ç­¾é»˜è®¤æ–‡ç« åº•éƒ¨ä¼šå‡ºçŽ°# testçš„æ ‡ç­¾ï¼ŒçŽ°åœ¨ä¿®æ”¹è¯¥æ ‡ç­¾æ˜¾ç¤ºï¼ŒæŠŠ#æ¢æˆå…¶ä»–æ ·å¼ï¼š ä¿®æ”¹æ¨¡æ¿/themes/next/layout/_macro/post.swigï¼Œæœç´¢ rel=&quot;tag&quot;&gt;#ï¼Œå°†#æ¢æˆ&lt;i class=&quot;fa fa-tag&quot;&gt;&lt;/i&gt; åœ¨æ¯ç¯‡æ–‡ç« æœ«å°¾ç»Ÿä¸€æ·»åŠ â€œæœ¬æ–‡ç»“æŸâ€æ ‡è®°åœ¨è·¯å¾„ \themes\next\layout\_macro ä¸­æ–°å»º passage-end-tag.swig æ–‡ä»¶,å¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š &lt;div&gt; {% if not is_index %} -------------æœ¬æ–‡ç»“æŸ æ„Ÿè°¢æ‚¨çš„é˜…è¯»------------- {% endif %} &lt;/div&gt; æŽ¥ç€æ‰“å¼€\themes\next\layout\_macro\post.swigæ–‡ä»¶ï¼Œåœ¨post-body ä¹‹åŽï¼Œ æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š &lt;div&gt; {% if not is_index %} {% include 'passage-end-tag.swig' %} {% endif %} &lt;/div&gt; æ·»åŠ ä½ç½®å¦‚å›¾ï¼š ç„¶åŽæ‰“å¼€ä¸»é¢˜é…ç½®æ–‡ä»¶ï¼ˆ_config.yml),åœ¨æœ«å°¾æ·»åŠ ï¼š # æ–‡ç« æœ«å°¾æ·»åŠ â€œæœ¬æ–‡ç»“æŸâ€æ ‡è®° passage_end_tag: enabled: true å®Œæˆä»¥ä¸Šè®¾ç½®ä¹‹åŽï¼Œåœ¨æ¯ç¯‡æ–‡ç« ä¹‹åŽéƒ½ä¼šæ˜¾ç¤ºå¦‚ä¸‹å›¾çš„æ•ˆæžœã€‚ ä¾§è¾¹æ ç¤¾äº¤å°å›¾æ ‡è®¾ç½®æ‰“å¼€ä¸»é¢˜é…ç½®æ–‡ä»¶_config.ymlï¼Œæœç´¢social:, ||ä¹‹åŽæ˜¯åœ¨å›¾æ ‡åº“ä¸­å¯¹åº”çš„å›¾æ ‡ã€‚æ³¨æ„ç©ºæ ¼å°±è¡Œã€‚ å›¾æ ‡åº“é“¾æŽ¥ï¼šhttp://fontawesome.io/icons/ æˆ‘çš„é…ç½®å¦‚ä¸‹å›¾ï¼š social_icons: enable: true icons_only: false transition: true æ•ˆæžœå¦‚ä¸‹å›¾ï¼š ä¸»é¡µæ–‡ç« åŠ é˜´å½±æ‰“å¼€\themes\next\source\css\_custom\custom.styl,å‘é‡Œé¢åŠ å…¥ï¼š // ä¸»é¡µæ–‡ç« æ·»åŠ é˜´å½±æ•ˆæžœ .post { margin-top: 60px; margin-bottom: 60px; padding: 25px; -webkit-box-shadow: 0 0 5px rgba(202, 203, 203, .5); -moz-box-shadow: 0 0 5px rgba(202, 203, 204, .5); } è®¾ç½®ç½‘ç«™å›¾æ ‡é»˜è®¤çš„ç½‘ç«™å›¾æ ‡æ˜¯ä¸€ä¸ªNï¼Œå½“ç„¶æ˜¯éœ€è¦åˆ¶å®šä¸€ä¸ªå›¾äº†ï¼Œåœ¨ç½‘ä¸Šæ‰¾åˆ°å›¾åŽï¼Œå°†å…¶æ”¾åœ¨/themes/next/source/imgé‡Œé¢ï¼Œç„¶åŽåœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ä¸‹å›¾æ‰€ç¤ºå›¾ç‰‡ä½ç½®ï¼š è®¾ç½®æ—‹è½¬å¤´åƒHexo Nextä¸»é¢˜å°†å¤´åƒæ˜¾ç¤ºæˆåœ†å½¢ï¼Œé¼ æ ‡æ”¾ä¸ŠåŽ»æœ‰æ—‹è½¬æ•ˆæžœã€‚ å…ˆè®¾ç½®å¤´åƒï¼Œåœ¨ç½‘ä¸Šæ‰¾åˆ°å›¾åŽï¼Œå°†å…¶æ”¾åœ¨/themes/next/source/imgé‡Œé¢ï¼Œç„¶åŽåœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ä¸‹å›¾æ‰€ç¤ºå›¾ç‰‡ä½ç½®ï¼š ç„¶åŽæ‰¾åˆ°/themes/next/source/css/_common/components/sidebar/sidebar-author.stylï¼ŒæŠŠé‡Œé¢çš„å†…å®¹æ›¿æ¢å¦‚ä¸‹ï¼š .site-author-image { display: block; margin: 0 auto; padding: $site-author-image-padding; max-width: $site-author-image-width; height: $site-author-image-height; border: $site-author-image-border-width solid $site-author-image-border-color; } .site-author-name { margin: $site-author-name-margin; text-align: $site-author-name-align; color: $site-author-name-color; font-weight: $site-author-name-weight; } .site-description { margin-top: $site-description-margin-top; text-align: $site-description-align; font-size: $site-description-font-size; color: $site-description-color; } .site-author-image { display: block; margin: 0 auto; padding: $site-author-image-padding; max-width: $site-author-image-width; height: $site-author-image-height; border: $site-author-image-border-width solid $site-author-image-border-color; /* å¤´åƒåœ†å½¢*/ border-radius: 80px; -webkit-border-radius: 80px; -moz-border-radius: 80px; box-shadow: inset 0 -1px 0 #333sf; /* è®¾ç½®å¾ªçŽ¯åŠ¨ç”» [animation: (play)åŠ¨ç”»åç§° (2s)åŠ¨ç”»æ’­æ”¾æ—¶é•¿å•ä½ç§’æˆ–å¾®ç§’ (ase-out)åŠ¨ç”»æ’­æ”¾çš„é€Ÿåº¦æ›²çº¿ä¸ºä»¥ä½Žé€Ÿç»“æŸ (1s)ç­‰å¾…1ç§’ç„¶åŽå¼€å§‹åŠ¨ç”» (1)åŠ¨ç”»æ’­æ”¾æ¬¡æ•°(infiniteä¸ºå¾ªçŽ¯æ’­æ”¾) ]*/ /* é¼ æ ‡ç»è¿‡å¤´åƒæ—‹è½¬360åº¦*/ -webkit-transition: -webkit-transform 1.0s ease-out; -moz-transition: -moz-transform 1.0s ease-out; transition: transform 1.0s ease-out; } img:hover { /* é¼ æ ‡ç»è¿‡åœæ­¢å¤´åƒæ—‹è½¬ -webkit-animation-play-state:paused; animation-play-state:paused;*/ /* é¼ æ ‡ç»è¿‡å¤´åƒæ—‹è½¬360åº¦*/ -webkit-transform: rotateZ(360deg); -moz-transform: rotateZ(360deg); transform: rotateZ(360deg); } /* Z è½´æ—‹è½¬åŠ¨ç”»*/ @-webkit-keyframes play { 0% { -webkit-transform: rotateZ(0deg); } 100% { -webkit-transform: rotateZ(-360deg); } } @-moz-keyframes play { 0% { -moz-transform: rotateZ(0deg); } 100% { -moz-transform: rotateZ(-360deg); } } @keyframes play { 0% { transform: rotateZ(0deg); } 100% { transform: rotateZ(-360deg); } } å¼€å¯æ‰“èµåŠŸèƒ½ä¸»é¢˜é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹ä¿¡æ¯å¦‚ä¸‹ï¼ŒåŒæ—¶æŠŠå¾®ä¿¡å’Œæ”¯ä»˜å®æ”¶æ¬¾ç ä¿å­˜åˆ°æŒ‡å®šè·¯å¾„ï¼š æ‰“èµåŠŸèƒ½æ–‡ä»¶è·¯å¾„ï¼š\themes\next\layout\_macro\reward.swig è®¾ç½®é¦–é¡µä¸æ˜¾ç¤ºå…¨æ–‡(åªæ˜¾ç¤ºé¢„è§ˆ)æ‰“å¼€ä¸»é¢˜é…ç½®æ–‡ä»¶_config.ymlï¼Œctrl + Fæœç´¢æ‰¾åˆ°&quot;auto_excerpt&quot;ï¼Œå¯ä»¥çœ‹è§ # Automatically Excerpt. Not recommand. # Please use &lt;!-- more --&gt; in the post to control excerpt accurately. auto_excerpt: enable: false length: 150 lengthå°±æ˜¯é¢„è§ˆæ˜¾ç¤ºçš„æ–‡å­—é•¿åº¦ ç¬¬ä¸€ç§æ–¹æ³•ï¼šä¿®æ”¹å¦‚ä¸Šçš„é…ç½®ï¼ŒæŠŠenableå¯¹åº”çš„falseæ”¹ä¸ºtrueï¼Œç„¶åŽhexo d -gå³å¯ ç¬¬äºŒç§æ–¹æ³•ï¼šåœ¨_postç›®å½•ä¸‹çš„æ–‡ç« ä¸­é€‚å½“ä½ç½®æ·»åŠ ä¸Šï¼Œé¡¶è¡Œå†™ï¼Œå³å¯ã€‚ è‹¥ä¸¤ç§æ–¹æ³•åŒæ—¶å­˜åœ¨ï¼Œåˆ™ä¼˜å…ˆä½¿ç”¨ç¬¬äºŒç§ æ–‡ç« å­—æ•°ç»Ÿè®¡å’Œé˜…è¯»æ—¶é•¿NexTä¸»é¢˜é»˜è®¤å·²ç»é›†æˆäº†æ–‡ç« ã€å­—æ•°ç»Ÿè®¡ã€‘ã€ã€é˜…è¯»æ—¶é•¿ã€‘ç»Ÿè®¡åŠŸèƒ½ã€‚ å¦‚æžœæˆ‘ä»¬éœ€è¦ä½¿ç”¨ï¼Œåªéœ€è¦åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶(\themes\next\_config.yml)ä¸­æ‰“å¼€wordcount ç»Ÿè®¡åŠŸèƒ½å³å¯ã€‚ post_wordcount: item_text: true wordcount: true min2read: true totalcount: true separated_meta: false æœ€åŽä¸€ä¸ªseparated_metaæ˜¯æ¢è¡Œæ˜¾ç¤ºçš„ï¼Œä¸ç”¨å¼€å¯ ä»…ä»…åªæ˜¯æ‰“å¼€å¼€å…³ï¼Œéƒ¨ç½²ä¹‹åŽä¼šå‘çŽ°æ–‡ç« çš„ã€å­—æ•°ç»Ÿè®¡ã€‘å’Œã€é˜…è¯»æ—¶é•¿ã€‘åŽé¢æ²¡æœ‰å¯¹åº”çš„xxxå­—ï¼Œxxåˆ†é’Ÿç­‰å­—æ ·ï¼Œåªæœ‰å…‰ç§ƒç§ƒçš„æ•°å­—åœ¨é‚£é‡Œã€‚ æ‰¾åˆ°themes\next\layout\_macro\post.swig æ–‡ä»¶ - å­—æ•°ç»Ÿè®¡ æ·»åŠ  â€œå­—â€åˆ°{{ wordcount(post.content) }} åŽé¢ï¼Œä¿®æ”¹åŽä¸ºï¼š &lt;span title=&quot;{{ __('post.wordcount') }}&quot;&gt; {{ wordcount(post.content) }} å­— &lt;/span&gt; - é˜…è¯»æ—¶é•¿ æ·»åŠ  â€œåˆ†é’Ÿâ€åˆ°{{ min2read(post.content) }} åŽé¢ï¼Œä¿®æ”¹åŽä¸ºï¼š &lt;span title=&quot;{{ __('post.min2read') }}&quot;&gt; {{ min2read(post.content) }} åˆ†é’Ÿ &lt;/span&gt; å†æ¬¡è¿è¡Œï¼Œå°±èƒ½å¾—åˆ°æ­£å¸¸çš„å¦‚â€œå­—æ•°ç»Ÿè®¡ 1888å­—â€â€œé˜…è¯»æ—¶é•¿ 6åˆ†é’Ÿâ€è¿™æ ·çš„æ ·å¼äº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æ–‡ç« åº•éƒ¨å¢žåŠ ç‰ˆæƒä¿¡æ¯åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­æ‰¾åˆ°post_copyrightï¼ŒæŠŠenableçš„å€¼ä¿®æ”¹æˆtrue,ç„¶åŽæ‰¾åˆ°themes\next\layout\_macro\post-copyright.swigæ–‡ä»¶ä¿®æ”¹å¦‚ä¸‹ï¼š &lt;div class=&quot;post-copyright&quot;&gt; &lt;li class=&quot;post-copyright-title&quot;&gt; &lt;strong&gt;{{ __('æœ¬æ–‡æ ‡é¢˜') + __('symbol.colon') }}&lt;/strong&gt; {{ page.title }} &lt;/li&gt; &lt;li class=&quot;post-copyright-author&quot;&gt; &lt;strong&gt;{{ __('æ–‡ç« ä½œè€…') + __('symbol.colon') }}&lt;/strong&gt; {{ post.author | default(config.author) }} &lt;/li&gt; &lt;li class=&quot;post-copyright-author&quot;&gt; &lt;strong&gt;{{ __('å‘å¸ƒæ—¶é—´') + __('symbol.colon') }}&lt;/strong&gt; {{ page.date.format("YYYYå¹´MMæœˆDDæ—¥ - HH:MM:SS") }} &lt;/li&gt; &lt;li class=&quot;post-copyright-author&quot;&gt; &lt;strong&gt;{{ __('æ›´æ–°æ—¶é—´') + __('symbol.colon') }}&lt;/strong&gt; {{ page.updated.format("YYYYå¹´MMæœˆDDæ—¥ - HH:MM:SS") }} &lt;/li&gt; &lt;li class=&quot;post-copyright-link&quot;&gt; &lt;strong&gt;{{ __('æœ¬æ–‡é“¾æŽ¥') + __('symbol.colon') }}&lt;/strong&gt; &lt;a href=&quot;{{ url_for(page.path) }}&quot; title=&quot;{{ page.title }}&quot;&gt;{{ page.permalink }}&lt;/a&gt; &lt;span class=&quot;copy-path&quot; title=&quot;ç‚¹å‡»å¤åˆ¶æ–‡ç« é“¾æŽ¥&quot;&gt;&lt;i class=&quot;fa fa-clipboard&quot; data-clipboard-text=&quot;{{ page.permalink }}&quot; aria-label=&quot;å¤åˆ¶æˆåŠŸï¼&quot;&gt;&lt;/i&gt;&lt;/span&gt; &lt;/li&gt; &lt;li class=&quot;post-copyright-license&quot;&gt; &lt;strong&gt;{{ __('post.copyright.license_title') + __('symbol.colon') }} &lt;/strong&gt; &lt;i class=&quot;fa fa-creative-commons&quot;&gt;&lt;/i&gt; &lt;a rel=&quot;license&quot; href=&quot;https://creativecommons.org/licenses/by-nc-nd/4.0/&quot; target=&quot;_blank&quot; title=&quot;Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)&quot;&gt;ç½²å-éžå•†ä¸šæ€§ä½¿ç”¨-ç¦æ­¢æ¼”ç»Ž 4.0 å›½é™…&lt;/a&gt; è½¬è½½è¯·ä¿ç•™åŽŸæ–‡é“¾æŽ¥åŠä½œè€…ã€‚ &lt;/li&gt; &lt;/div&gt; &lt;script&gt; var clipboard = new Clipboard(&apos;.fa-clipboard&apos;); $(&quot;.fa-clipboard&quot;).click(function(){ clipboard.on(&apos;success&apos;, function(){ swal({ title: &quot;&quot;, text: &apos;å¤åˆ¶æˆåŠŸ&apos;, icon: &quot;success&quot;, showConfirmButton: true }); }); }); &lt;/script&gt; å®žçŽ°æ•ˆæžœï¼š ç½‘ç«™åº•éƒ¨å­—æ•°ç»Ÿè®¡å®‰è£…æ’ä»¶ï¼šnpm install hexo-wordcount --save å› ä¸ºåœ¨[æ–‡ç« å­—æ•°ç»Ÿè®¡å’Œé˜…è¯»æ—¶é•¿]ä¸­æœ‰ä¸€ä¸ªtotalcount: trueï¼Œé»˜è®¤å·²ç»å¼€å¯è¯¥åŠŸèƒ½äº†ï¼Œæ‰¾åˆ°å¦‚ä¸‹æ–‡ä»¶ï¼šthemes\next\layout\_partials\footer.swigï¼Œä¿®æ”¹å¦‚ä¸‹ï¼Œæ˜¾ç¤ºâ€˜å­—â€™ï¼š æ•ˆæžœå¦‚ä¸‹ï¼š éšè—ç½‘é¡µåº•éƒ¨ ç”±Hexoå¼ºåŠ›é©±åŠ¨åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­æ‰¾åˆ°poweredï¼Œè®¾ç½®æˆfalseå³å¯ã€‚ ä¿®æ”¹ç½‘é¡µåº•éƒ¨çš„æ¡ƒå¿ƒæ‰“å¼€themes/next/layout/_partials/footer.swigï¼Œæ‰¾åˆ°ï¼š ç„¶åŽè¿˜æ˜¯åœ¨[å›¾æ ‡åº“](http://fontawesome.io/icons/ &quot;å›¾æ ‡åº“&quot;)ä¸­æ‰¾åˆ°ä½ è‡ªå·±å–œæ¬¢çš„å›¾æ ‡ï¼Œç„¶åŽä¿®æ”¹ç”»çº¢çº¿çš„éƒ¨åˆ†å°±å¯ä»¥äº†ã€‚ ä¿®æ”¹æ–‡ç« å†…é“¾æŽ¥æ–‡æœ¬æ ·å¼ä¿®æ”¹æ–‡ä»¶ themes\next\source\css\_common\components\post\post.styl ï¼Œåœ¨æœ«å°¾æ·»åŠ å¦‚ä¸‹cssæ ·å¼ï¼š // æ–‡ç« å†…é“¾æŽ¥æ–‡æœ¬æ ·å¼ .post-body p a{ color: #0593d3; border-bottom: none; border-bottom: 1px solid #0593d3; &amp;:hover { color: #fc6423; border-bottom: none; border-bottom: 1px solid #fc6423; } } å…¶ä¸­é€‰æ‹© .post-body æ˜¯ä¸ºäº†ä¸å½±å“æ ‡é¢˜ï¼Œé€‰æ‹© p æ˜¯ä¸ºäº†ä¸å½±å“é¦–é¡µâ€œé˜…è¯»å…¨æ–‡â€çš„æ˜¾ç¤ºæ ·å¼,é¢œè‰²å¯ä»¥è‡ªå·±å®šä¹‰ã€‚ æ·»åŠ é¡¶éƒ¨åŠ è½½æ¡è¿›å…¥åšå®¢æ–‡ä»¶å¤¹çš„/themes/nextæ–‡ä»¶å¤¹ä¸‹, ä¸‹è½½å®‰è£…Progress module:git clone https://github.com/theme-next/theme-next-pace source/lib/pace ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶(_config.yml),ä¿®æ”¹å¦‚ä¸‹ï¼š # Progress bar in the top during page loading. # Dependencies: https://github.com/theme-next/theme-next-pace pace: true #æ˜¯å¦å¼€å¯è¿›åº¦æ¡ # Themes list: # pace-theme-big-counter | pace-theme-bounce | pace-theme-barber-shop | pace-theme-center-atom # pace-theme-center-circle | pace-theme-center-radar | pace-theme-center-simple | pace-theme-corner-indicator # pace-theme-fill-left | pace-theme-flash | pace-theme-loading-bar | pace-theme-mac-osx | pace-theme-minimal # For example pace_theme: pace-theme-center-atom #é€‰æ‹©è¿›åº¦æ¡æ ·å¼ ä¿®æ”¹å­—ä½“å¤§å°åœ¨ä¸»é¢˜ç›®å½•é…ç½®æ–‡ä»¶ä¸‹ï¼ŒæŸ¥æ‰¾fontï¼š font: enable: true # Uri of fonts host. E.g. //fonts.googleapis.com (Default). host: # bodyå…ƒç´ çš„å­—ä½“è®¾ç½® global: external: true family: Lato size: 18 # æ ‡é¢˜çš„åŸºç¡€å­—ä½“è®¾ç½® headings: external: true family: size: 30 # æ–‡ç« å­—ä½“è®¾ç½® posts: external: true family: 18 # logoå­—ä½“è®¾ç½® logo: external: true family: size: 30 # ä»£ç å—å­—ä½“è®¾ç½® codes: external: true family: size: 13 æŠŠfalseæ”¹ä¸ºtrueï¼Œå¹¶ä¿®æ”¹äº†sizeçš„æ•°å€¼ï¼Œå•ä½æ˜¯åƒç´ ã€‚å¦‚æœ‰éœ€è¦å¯è‡ªè¡Œæ”¹å˜å­—ä½“ã€‚ å¦å¤–æä¾›ä¸€ç§æ–¹æ³•ï¼Œä¾›ä¼šå‰ç«¯çš„å°ä¼™ä¼´å‚è€ƒï¼šNextä¸»é¢˜æŽ§åˆ¶å­—ä½“å¤§å°çš„æ–‡ä»¶æ˜¯åœ¨ä¸»é¢˜æ–‡ä»¶å¤¹ä¸­çš„ source\css_variables ç›®å½•ä¸‹çš„ base.styl æ–‡ä»¶ï¼Œ æ‰¾åˆ°è¯¥æ–‡ä»¶ï¼šthemes\next\source\css_variables\base.styl æ–‡ä»¶. // Font size $font-size-base = 16px //ä¿®æ”¹ä»¥å‰æ˜¯14ï¼Œæˆ‘æ”¹æˆäº†16 $font-size-small = $font-size-base - 2px $font-size-smaller = $font-size-base - 4px $font-size-large = $font-size-base + 2px $font-size-larger = $font-size-base + 4px // Headings font size $font-size-headings-step = 2px $font-size-headings-base = 24px //è¿™ä¸ªæ˜¯æ ‡é¢˜å¤§å°ï¼Œå¦‚æžœä½ è§‰å¾—ä¸æ»¡æ„ï¼Œå¯ä»¥æ”¹çš„æ›´å¤§ä¸€ç‚¹ ä¿®æ”¹å®Œä¹‹åŽï¼Œä¿å­˜æ–‡ä»¶ã€‚é‡æ–°éƒ¨ç½² hexo ï¼Œå°±å¯ä»¥çœ‹åˆ°åšå®¢å­—ä½“å·²ç»å˜æˆä½ æƒ³è¦çš„å¤§å°äº†ã€‚ æ–‡ç« åŠ å¯†è®¿é—®å…ˆå®‰è£…æ’ä»¶ï¼šnpm install hexo-blog-encrypt --save åœ¨æ ¹ç›®å½•ä¸­package.jsonä¸­æ·»åŠ ä¾èµ–ï¼š&quot;hexo-blog-encrypt&quot;: &quot;2.0.*&quot; åœ¨ç«™ç‚¹é…ç½®æ–‡ä»¶ä¸­å¼€å¯ï¼Œæ²¡æœ‰åˆ™æ·»åŠ ï¼š # Security encrypt: enable: true æ‰“å¼€ä¸»é¢˜ç›®å½•ä¸‹layout/_partials/head.swigæ–‡ä»¶,åœ¨metaæ ‡ç­¾åŽé¢æ’å…¥è¿™æ ·ä¸€æ®µä»£ç ï¼š &lt;script&gt; (function(){ if(&apos;{{ page.password }}&apos;){ if (prompt(&apos;è¯·è¾“å…¥æ–‡ç« å¯†ç &apos;) !== &apos;{{ page.password }}&apos;){ alert(&apos;å¯†ç é”™è¯¯ï¼&apos;); history.back(); } } })(); &lt;/script&gt; ç„¶åŽæ–‡ç« å¤´éƒ¨ä¿¡æ¯ä¸­æ·»åŠ passwordï¼š password: ä½ è®¾ç½®çš„å¯†ç  å¦‚æžœpasswordåŽé¢ä¸ºç©ºï¼Œåˆ™è¡¨ç¤ºä¸ç”¨å¯†ç ã€‚ æ·»åŠ jiathisåˆ†äº«ä¸»é¢˜é…ç½®æ–‡ä»¶ï¼Œè®¾ç½®å¦‚ä¸‹ï¼š # JiaThis åˆ†äº«æœåŠ¡ jiathis: true åšæ–‡ç½®é¡¶ä¿®æ”¹ hero-generator-index æ’ä»¶ï¼ŒæŠŠæ–‡ä»¶ï¼šnode_modules/hexo-generator-index/lib/generator.js å†…çš„ä»£ç æ›¿æ¢ä¸ºï¼š &apos;use strict&apos;; var pagination = require(&apos;hexo-pagination&apos;); module.exports = function(locals){ var config = this.config; var posts = locals.posts; posts.data = posts.data.sort(function(a, b) { if(a.top &amp;&amp; b.top) { // ä¸¤ç¯‡æ–‡ç« topéƒ½æœ‰å®šä¹‰ if(a.top == b.top) return b.date - a.date; // è‹¥topå€¼ä¸€æ ·åˆ™æŒ‰ç…§æ–‡ç« æ—¥æœŸé™åºæŽ’ else return b.top - a.top; // å¦åˆ™æŒ‰ç…§topå€¼é™åºæŽ’ } else if(a.top &amp;&amp; !b.top) { // ä»¥ä¸‹æ˜¯åªæœ‰ä¸€ç¯‡æ–‡ç« topæœ‰å®šä¹‰ï¼Œé‚£ä¹ˆå°†æœ‰topçš„æŽ’åœ¨å‰é¢ï¼ˆè¿™é‡Œç”¨å¼‚æˆ–æ“ä½œå±…ç„¶ä¸è¡Œ233ï¼‰ return -1; } else if(!a.top &amp;&amp; b.top) { return 1; } else return b.date - a.date; // éƒ½æ²¡å®šä¹‰æŒ‰ç…§æ–‡ç« æ—¥æœŸé™åºæŽ’ }); var paginationDir = config.pagination_dir || &apos;page&apos;; return pagination(&apos;&apos;, posts, { perPage: config.index_generator.per_page, layout: [&apos;index&apos;, &apos;archive&apos;], format: paginationDir + &apos;/%d/&apos;, data: { __index: true } }); }; åœ¨æ–‡ç« ä¸­æ·»åŠ  top å€¼ï¼Œæ•°å€¼è¶Šå¤§æ–‡ç« è¶Šé å‰ï¼Œå¦‚ï¼š --- title: Hexoæ­å»ºæ•™ç¨‹(1) date: {{ date }} tags: - hexo categories: - hexo top: 100 --- https://www.easyicon.net/download/ico/1230452/96/æ·»åŠ ç½®é¡¶æ ‡å¿—ï¼šåˆ°next\layout_macroä¸‹çš„post.swigï¼Œæ‰¾åˆ°&lt;div class=&quot;post-meta&quot;&gt; ï¼Œåœ¨ä¸‹é¢æ·»åŠ å¯¹åº”ä»£ç  {% if post.top == 100 %} ç½®é¡¶ | {% endif %} è‡ªå®šä¹‰é¼ æ ‡æ ·å¼æ‰“å¼€themes/next/source/css/_custom/custom.styl,åœ¨é‡Œé¢å†™ä¸‹å¦‚ä¸‹ä»£ç ï¼š ä½¿ç”¨è¿™æ ·çš„æ–¹å¼èŽ·å¾—icoå›¾æ ‡é“¾æŽ¥åœ°å€// é¼ æ ‡æ ·å¼ * { cursor: url(&quot;http://blog.ejubei.net/img/mouse.ico&quot;),auto!important } :active { cursor: url(&quot;http://blog.ejubei.net/img/mouse.ico&quot;),auto!important } å…¶ä¸­ url é‡Œé¢å¿…é¡»æ˜¯ ico å›¾ç‰‡ï¼Œico å›¾ç‰‡å¯ä»¥ä¸Šä¼ åˆ°ç½‘ä¸Šï¼Œç„¶åŽèŽ·å–å¤–é“¾ï¼Œå¤åˆ¶åˆ° url é‡Œå°±è¡Œäº† ä¸ºåšå®¢åŠ ä¸ŠèŒèŒçš„å® ç‰©å®‰è£…æ’ä»¶ï¼šnpm install -save hexo-helper-live2d ç„¶åŽåœ¨åšå®¢ç«™ç‚¹çš„_config.yml æ–‡ä»¶æˆ–ä¸»é¢˜çš„ _config.yml æ–‡ä»¶ä¸­æ·»åŠ é…ç½®ï¼š live2d: enable: true scriptFrom: local pluginRootPath: live2dw/ pluginJsPath: lib/ pluginModelPath: assets/ tagMode: false debug: false model: use: live2d-widget-model-wanko display: position: right width: 150 height: 300 mobile: show: true ç„¶åŽhexo clean ï¼Œhexo g ï¼Œhexo d å°±å¯ä»¥çœ‹åˆ°äº†ã€‚ å¯ä»¥è‡ªå®šä¹‰ä½¿ç”¨çš„å® ç‰©æ¨¡åž‹ï¼Œåœ°å€ï¼šhttps://github.com/EYHN/hexo-helper-live2d/blob/master/README.zh-CN.md æœç´¢åŠŸèƒ½å®‰è£…æ’ä»¶ï¼šnpm install hexo-generator-search --save åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸‹ï¼ŒæŸ¥æ‰¾local_search: local_search: enable: false trigger: auto top_n_per_article: 1 enableçš„å€¼ä¿®æ”¹ä¸ºtrue åœ¨æ ¹ç›®å½•é…ç½®æ–‡ä»¶ä¸­ï¼Œæ·»åŠ ä»¥ä¸‹ä»£ç ï¼š # æœ¬åœ°æœç´¢åŠŸèƒ½ search: path: search.xml field: post format: html limit: 10000 ç‚¹å‡»çˆ†ç‚¸æ•ˆæžœé¦–å…ˆåœ¨themes/next/source/js/srcé‡Œé¢å»ºä¸€ä¸ªå«fireworks.jsçš„æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š &quot;use strict&quot;; function updateCoords(e) { pointerX = (e.clientX || e.touches[0].clientX) - canvasEl.getBoundingClientRect().left, pointerY = e.clientY || e.touches[0].clientY - canvasEl.getBoundingClientRect().top } function setParticuleDirection(e) { var t = anime.random(0, 360) * Math.PI / 180, a = anime.random(50, 180), n = [ - 1, 1][anime.random(0, 1)] * a; return { x: e.x + n * Math.cos(t), y: e.y + n * Math.sin(t) } } function createParticule(e, t) { var a = {}; return a.x = e, a.y = t, a.color = colors[anime.random(0, colors.length - 1)], a.radius = anime.random(16, 32), a.endPos = setParticuleDirection(a), a.draw = function() { ctx.beginPath(), ctx.arc(a.x, a.y, a.radius, 0, 2 * Math.PI, !0), ctx.fillStyle = a.color, ctx.fill() }, a } function createCircle(e, t) { var a = {}; return a.x = e, a.y = t, a.color = &quot;#F00&quot;, a.radius = 0.1, a.alpha = 0.5, a.lineWidth = 6, a.draw = function() { ctx.globalAlpha = a.alpha, ctx.beginPath(), ctx.arc(a.x, a.y, a.radius, 0, 2 * Math.PI, !0), ctx.lineWidth = a.lineWidth, ctx.strokeStyle = a.color, ctx.stroke(), ctx.globalAlpha = 1 }, a } function renderParticule(e) { for (var t = 0; t &lt; e.animatables.length; t++) { e.animatables[t].target.draw() } } function animateParticules(e, t) { for (var a = createCircle(e, t), n = [], i = 0; i &lt; numberOfParticules; i++) { n.push(createParticule(e, t)) } anime.timeline().add({ targets: n, x: function(e) { return e.endPos.x }, y: function(e) { return e.endPos.y }, radius: 0.1, duration: anime.random(1200, 1800), easing: &quot;easeOutExpo&quot;, update: renderParticule }).add({ targets: a, radius: anime.random(80, 160), lineWidth: 0, alpha: { value: 0, easing: &quot;linear&quot;, duration: anime.random(600, 800) }, duration: anime.random(1200, 1800), easing: &quot;easeOutExpo&quot;, update: renderParticule, offset: 0 }) } function debounce(e, t) { var a; return function() { var n = this, i = arguments; clearTimeout(a), a = setTimeout(function() { e.apply(n, i) }, t) } } var canvasEl = document.querySelector(&quot;.fireworks&quot;); if (canvasEl) { var ctx = canvasEl.getContext(&quot;2d&quot;), numberOfParticules = 30, pointerX = 0, pointerY = 0, tap = &quot;mousedown&quot;, colors = [&quot;#FF1461&quot;, &quot;#18FF92&quot;, &quot;#5A87FF&quot;, &quot;#FBF38C&quot;], setCanvasSize = debounce(function() { canvasEl.width = 2 * window.innerWidth, canvasEl.height = 2 * window.innerHeight, canvasEl.style.width = window.innerWidth + &quot;px&quot;, canvasEl.style.height = window.innerHeight + &quot;px&quot;, canvasEl.getContext(&quot;2d&quot;).scale(2, 2) }, 500), render = anime({ duration: 1 / 0, update: function() { ctx.clearRect(0, 0, canvasEl.width, canvasEl.height) } }); document.addEventListener(tap, function(e) { &quot;sidebar&quot; !== e.target.id &amp;&amp; &quot;toggle-sidebar&quot; !== e.target.id &amp;&amp; &quot;A&quot; !== e.target.nodeName &amp;&amp; &quot;IMG&quot; !== e.target.nodeName &amp;&amp; (render.play(), updateCoords(e), animateParticules(pointerX, pointerY)) }, !1), setCanvasSize(), window.addEventListener(&quot;resize&quot;, setCanvasSize, !1) } &quot;use strict&quot;; function updateCoords(e) { pointerX = (e.clientX || e.touches[0].clientX) - canvasEl.getBoundingClientRect().left, pointerY = e.clientY || e.touches[0].clientY - canvasEl.getBoundingClientRect().top } function setParticuleDirection(e) { var t = anime.random(0, 360) * Math.PI / 180, a = anime.random(50, 180), n = [ - 1, 1][anime.random(0, 1)] * a; return { x: e.x + n * Math.cos(t), y: e.y + n * Math.sin(t) } } function createParticule(e, t) { var a = {}; return a.x = e, a.y = t, a.color = colors[anime.random(0, colors.length - 1)], a.radius = anime.random(16, 32), a.endPos = setParticuleDirection(a), a.draw = function() { ctx.beginPath(), ctx.arc(a.x, a.y, a.radius, 0, 2 * Math.PI, !0), ctx.fillStyle = a.color, ctx.fill() }, a } function createCircle(e, t) { var a = {}; return a.x = e, a.y = t, a.color = &quot;#F00&quot;, a.radius = 0.1, a.alpha = 0.5, a.lineWidth = 6, a.draw = function() { ctx.globalAlpha = a.alpha, ctx.beginPath(), ctx.arc(a.x, a.y, a.radius, 0, 2 * Math.PI, !0), ctx.lineWidth = a.lineWidth, ctx.strokeStyle = a.color, ctx.stroke(), ctx.globalAlpha = 1 }, a } function renderParticule(e) { for (var t = 0; t &lt; e.animatables.length; t++) { e.animatables[t].target.draw() } } function animateParticules(e, t) { for (var a = createCircle(e, t), n = [], i = 0; i &lt; numberOfParticules; i++) { n.push(createParticule(e, t)) } anime.timeline().add({ targets: n, x: function(e) { return e.endPos.x }, y: function(e) { return e.endPos.y }, radius: 0.1, duration: anime.random(1200, 1800), easing: &quot;easeOutExpo&quot;, update: renderParticule }).add({ targets: a, radius: anime.random(80, 160), lineWidth: 0, alpha: { value: 0, easing: &quot;linear&quot;, duration: anime.random(600, 800) }, duration: anime.random(1200, 1800), easing: &quot;easeOutExpo&quot;, update: renderParticule, offset: 0 }) } function debounce(e, t) { var a; return function() { var n = this, i = arguments; clearTimeout(a), a = setTimeout(function() { e.apply(n, i) }, t) } } var canvasEl = document.querySelector(&quot;.fireworks&quot;); if (canvasEl) { var ctx = canvasEl.getContext(&quot;2d&quot;), numberOfParticules = 30, pointerX = 0, pointerY = 0, tap = &quot;mousedown&quot;, colors = [&quot;#FF1461&quot;, &quot;#18FF92&quot;, &quot;#5A87FF&quot;, &quot;#FBF38C&quot;], setCanvasSize = debounce(function() { canvasEl.width = 2 * window.innerWidth, canvasEl.height = 2 * window.innerHeight, canvasEl.style.width = window.innerWidth + &quot;px&quot;, canvasEl.style.height = window.innerHeight + &quot;px&quot;, canvasEl.getContext(&quot;2d&quot;).scale(2, 2) }, 500), render = anime({ duration: 1 / 0, update: function() { ctx.clearRect(0, 0, canvasEl.width, canvasEl.height) } }); document.addEventListener(tap, function(e) { &quot;sidebar&quot; !== e.target.id &amp;&amp; &quot;toggle-sidebar&quot; !== e.target.id &amp;&amp; &quot;A&quot; !== e.target.nodeName &amp;&amp; &quot;IMG&quot; !== e.target.nodeName &amp;&amp; (render.play(), updateCoords(e), animateParticules(pointerX, pointerY)) }, !1), setCanvasSize(), window.addEventListener(&quot;resize&quot;, setCanvasSize, !1) }; æ‰“å¼€themes/next/layout/_layout.swig,åœ¨&lt;/body&gt;ä¸Šé¢å†™ä¸‹å¦‚ä¸‹ä»£ç ï¼š &lt;!-- çˆ†ç‚¸æ•ˆæžœ --&gt; {% if theme.fireworks %} {% endif %} æ‰“å¼€ä¸»é¢˜é…ç½®æ–‡ä»¶ï¼Œåœ¨é‡Œé¢æœ€åŽå†™ä¸‹ï¼š # Fireworks fireworks: true è‡ªå®šä¹‰æ–‡ç« çš„é»˜è®¤å¤´éƒ¨ä¿¡æ¯åœ¨æ ¹ç›®å½•çš„/scaffolds/post.mdæ–‡ä»¶ä¸­æ·»åŠ ï¼š --- title: {{ title }} date: {{ date }} tags: #æ ‡ç­¾ categories: #åˆ†ç±» copyright: true #ç‰ˆæƒå£°æ˜Ž permalink: 01 #æ–‡ç« é“¾æŽ¥ï¼Œæœ‰é»˜è®¤å€¼ top: 0 #ç½®é¡¶ä¼˜å…ˆçº§ password: #å¯†ç ä¿æŠ¤ --- æ–‡ç« æ ‡ç­¾æ˜¾ç¤ºè®¾ç½®åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­ï¼ŒæŸ¥æ‰¾post_metaï¼š # æ–‡ç« æ ‡ç­¾æ˜¾ç¤ºè®¾ç½® post_meta: item_text: true created_at: true # å‘è¡¨æ—¶é—´ updated_at: false # æ›´æ–°æ—¶é—´ categories: true # åˆ†ç±» # æ–‡ç« å­—æ•°æ˜¾ç¤ºè®¾ç½®ï¼ˆéœ€è¦wordcountï¼Œå‰é¢å·²ç»ä¸‹è½½ï¼‰ post_wordcount: item_text: true wordcount: true # æ˜¾ç¤ºå­—æ•° min2read: false # æ‰€éœ€æ—¶é—´ totalcount: false # æ€»å­—æ•° separated_meta: true # åˆ†å‰²ç¬¦ åœ¨åº•éƒ¨å¢žåŠ è¿è¡Œæ—¶é—´æ‰“å¼€æ–‡ä»¶ï¼š\themes\next\layout\_partials\footer.swigï¼Œåœ¨æœ€åŽæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š &lt;!-- åœ¨ç½‘é¡µåº•éƒ¨æ·»åŠ ç½‘ç«™è¿è¡Œæ—¶é—´ --&gt; &lt;span id=&quot;timeDate&quot;&gt;è½½å…¥å¤©æ•°...&lt;/span&gt;&lt;span id=&quot;times&quot;&gt;è½½å…¥æ—¶åˆ†ç§’...&lt;/span&gt; &lt;script&gt; var now = new Date(); function createtime() { var grt= new Date(&quot;03/01/2019 00:00:00&quot;);//æ­¤å¤„ä¿®æ”¹ä½ çš„å»ºç«™æ—¶é—´æˆ–è€…ç½‘ç«™ä¸Šçº¿æ—¶é—´,2019-03-01 now.setTime(now.getTime()+250); days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); if(String(hnum).length ==1 ){hnum = &quot;0&quot; + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = &quot;0&quot; + mnum;} seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); snum = Math.round(seconds); if(String(snum).length ==1 ){snum = &quot;0&quot; + snum;} document.getElementById(&quot;timeDate&quot;).innerHTML = &quot;åšå®¢å·²è¿è¡Œ&quot;+dnum+&quot; å¤© &quot;; document.getElementById(&quot;times&quot;).innerHTML = hnum + &quot; å°æ—¶ &quot; + mnum + &quot; åˆ†é’Ÿ &quot; + snum + &quot; ç§’&quot;; } setInterval(&quot;createtime()&quot;,250); &lt;/script&gt; åˆ©ç”¨ Gulp æ¥åŽ‹ç¼©ä½ çš„ Hexo åšå®¢çš„é™æ€æ–‡ä»¶é¦–å…ˆå®‰è£…gulpï¼šnpm install gulp ç»§ç»­å®‰è£…ä¾èµ–åŒ…ï¼š npm install --save-dev babel-cli npm install --save-dev babel-preset-es2015 npm install gulp-minify-css gulp-babel gulp-uglify gulp-htmlmin gulp-htmlclean --save-dev åœ¨åšå®¢çš„æ ¹ç›®å½•åˆ›å»ºæ–‡ä»¶ gulpfile.jsï¼Œä»£ç å¦‚ä¸‹ï¼š var gulp = require(&apos;gulp&apos;); var minifycss = require(&apos;gulp-minify-css&apos;); var babel = require(&apos;gulp-babel&apos;); var uglify = require(&apos;gulp-uglify&apos;); var htmlmin = require(&apos;gulp-htmlmin&apos;); var htmlclean = require(&apos;gulp-htmlclean&apos;); gulp.task(&apos;minify-css&apos;, function() { return gulp.src(&apos;./public/**/*.css&apos;).pipe(minifycss()).pipe(gulp.dest(&apos;./public&apos;)); }); gulp.task(&apos;minify-html&apos;, function() { return gulp.src(&apos;./public/**/*.html&apos;).pipe(htmlclean()).pipe(htmlmin({ removeComments: true, minifyJS: true, minifyCSS: true, minifyURLs: true, })).pipe(gulp.dest(&apos;./public&apos;)) }); gulp.task(&apos;minify-js&apos;, function() { return gulp.src([&apos;./public/**/*.js&apos;, &apos;!./public/**/*.min.js&apos;]).pipe(babel({ presets: [&apos;es2015&apos;] })).pipe(uglify()).pipe(gulp.dest(&apos;./public&apos;)); }); gulp.task(&apos;default&apos;, [&apos;minify-html&apos;, &apos;minify-css&apos;, &apos;minify-js&apos;]); åŽ‹ç¼©æ–¹æ³•ï¼šæ‰§è¡Œå®Œhexo g äº§ç”Ÿç¼–è¯‘æ–‡ä»¶åŽï¼Œæ‰§è¡Œgulpï¼Œçœ‹åˆ°ä»¥ä¸‹ä¿¡æ¯ä»£è¡¨åŽ‹ç¼©æˆåŠŸï¼ŒæŽ¥ä¸‹æ¥ä½¿ç”¨hexo d å‘å¸ƒåˆ°æœåŠ¡å™¨å³å¯ï¼Œå¯å‘çŽ°è®¿é—®é€Ÿåº¦æœ‰äº†æ”¹å–„ã€‚ æ‰§è¡Œgulpæ—¶æŠ¥é”™ï¼š $ gulp internal/modules/cjs/loader.js:583 throw err; ^ Error: Cannot find module &apos;@babel/core&apos; at Function.Module._resolveFilename (internal/modules/cjs/loader.js:581:15) at Function.Module._load (internal/modules/cjs/loader.js:507:25) at Module.require (internal/modules/cjs/loader.js:637:17) at require (internal/modules/cjs/helpers.js:22:18) at Object.&lt;anonymous&gt; (D:\yongnights.github.io\node_modules\gulp-babel\index.js:7:15) at Module._compile (internal/modules/cjs/loader.js:689:30) at Object.Module._extensions..js (internal/modules/cjs/loader.js:700:10) at Module.load (internal/modules/cjs/loader.js:599:32) at tryModuleLoad (internal/modules/cjs/loader.js:538:12) at Function.Module._load (internal/modules/cjs/loader.js:530:3) è¯¥é”™è¯¯æš‚æ— æ³•è§£å†³ï¼Œæ•…è¯¥æ–¹æ³•å…ˆä¸æ‰§è¡Œã€‚ æ·»åŠ ç½‘ç«™å’Œæ–‡ç« åˆ†äº«æŒ‰é’®å®‰è£…æ’ä»¶ï¼šgit clone https://github.com/theme-next/theme-next-needmoreshare2 themes/next/source/lib/needsharebutton themes/next/_config.ymlï¼Œæœç´¢needmoreshare2ï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š needmoreshare2: enable: true postbottom: enable: true #æ˜¯å¦å¼€å¯åšå®¢åˆ†äº«æŒ‰é’® options: iconStyle: box boxForm: horizontal position: bottomCenter networks: Weibo,Wechat,Douban,QQZone float: enable: true #ç½‘ç«™åˆ†äº«æŒ‰é’® options: iconStyle: box boxForm: horizontal position: middleRight networks: Weibo,Wechat,Douban,QQZone åŽ‹ç¼©é¡µé¢é™æ€èµ„æºå®‰è£…æ’ä»¶ï¼šnpm install hexo-neat --save æ‰“å¼€åšå®¢ç«™ç‚¹é…ç½®æ–‡ä»¶ï¼Œåœ¨æœ€åŽæ·»åŠ å¦‚ä¸‹ä¿¡æ¯ï¼š # hexo-neat # åšæ–‡åŽ‹ç¼© neat_enable: true # åŽ‹ç¼©html neat_html: enable: true exclude: # åŽ‹ç¼©css neat_css: enable: true exclude: - &apos;**/*.min.css&apos; # åŽ‹ç¼©js neat_js: enable: true mangle: true output: compress: exclude: - &apos;**/*.min.js&apos; - &apos;**/jquery.fancybox.pack.js&apos; - &apos;**/index.js&apos; - &apos;**/clicklove.js&apos; - &apos;**/fireworks.js&apos; åˆ é™¤åšæ–‡ç›®å½•è‡ªåŠ¨ç”Ÿæˆçš„åºæ•°themes/next/_config.ymlï¼Œæœç´¢tocï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š toc: enable: true # Automatically add list number to toc. number: false # If true, all words will placed on next lines if header width longer then sidebar width. wrap: false ä¸è’œå­ç»Ÿè®¡å…¨å±€é…ç½®ï¼š ç¼–è¾‘ ä¸»é¢˜é…ç½®æ–‡ä»¶ ä¸­çš„busuanzi_countçš„é…ç½®é¡¹ã€‚å½“enable: trueæ—¶ï¼Œä»£è¡¨å¼€å¯å…¨å±€å¼€å…³ã€‚è‹¥site_uvã€site_pvã€page_pvçš„å€¼å‡ä¸ºfalseæ—¶ï¼Œä¸è’œå­ä»…ä½œè®°å½•è€Œä¸ä¼šåœ¨é¡µé¢ä¸Šæ˜¾ç¤ºã€‚ ç«™ç‚¹UVé…ç½®ï¼š å½“site_uv: trueæ—¶ï¼Œä»£è¡¨åœ¨é¡µé¢åº•éƒ¨æ˜¾ç¤ºç«™ç‚¹çš„UVå€¼ã€‚ site_uv_headerå’Œsite_uv_footerä¸ºè‡ªå®šä¹‰æ ·å¼é…ç½®ï¼Œç›¸å…³çš„å€¼ç•™ç©ºæ—¶å°†ä¸æ˜¾ç¤ºï¼Œå¯ä»¥ä½¿ç”¨ï¼ˆå¸¦ç‰¹æ•ˆçš„ï¼‰font-awesomeã€‚æ˜¾ç¤ºæ•ˆæžœä¸º[site_uv_header]UVå€¼[site_uv_footer]ã€‚ # æ•ˆæžœï¼šæœ¬ç«™è®¿å®¢æ•°12345äººæ¬¡ site_uv: true site_uv_header: æœ¬ç«™è®¿å®¢æ•° site_uv_footer: äººæ¬¡ ç«™ç‚¹PVé…ç½®ï¼š å½“site_pv: trueæ—¶ï¼Œä»£è¡¨åœ¨é¡µé¢åº•éƒ¨æ˜¾ç¤ºç«™ç‚¹çš„PVå€¼ã€‚ site_pv_headerå’Œsite_pv_footerä¸ºè‡ªå®šä¹‰æ ·å¼é…ç½®ï¼Œç›¸å…³çš„å€¼ç•™ç©ºæ—¶å°†ä¸æ˜¾ç¤ºï¼Œå¯ä»¥ä½¿ç”¨ï¼ˆå¸¦ç‰¹æ•ˆçš„ï¼‰font-awesomeã€‚æ˜¾ç¤ºæ•ˆæžœä¸º[site_pv_header]PVå€¼[site_pv_footer]ã€‚ # æ•ˆæžœï¼šæœ¬ç«™æ€»è®¿é—®é‡12345æ¬¡ site_pv: true site_pv_header: æœ¬ç«™æ€»è®¿é—®é‡ site_pv_footer: æ¬¡ å•é¡µé¢PVé…ç½®ï¼š å½“page_pv: trueæ—¶ï¼Œä»£è¡¨åœ¨æ–‡ç« é¡µé¢çš„æ ‡é¢˜ä¸‹æ˜¾ç¤ºè¯¥é¡µé¢çš„PVå€¼ï¼ˆé˜…è¯»æ•°ï¼‰ã€‚ page_pv_headerå’Œpage_pv_footerä¸ºè‡ªå®šä¹‰æ ·å¼é…ç½®ï¼Œç›¸å…³çš„å€¼ç•™ç©ºæ—¶å°†ä¸æ˜¾ç¤ºï¼Œå¯ä»¥ä½¿ç”¨ï¼ˆå¸¦ç‰¹æ•ˆçš„ï¼‰font-awesomeã€‚æ˜¾ç¤ºæ•ˆæžœä¸º[page_pv_header]PVå€¼[page_pv_footer]ã€‚ # æ•ˆæžœï¼šæœ¬æ–‡æ€»é˜…è¯»é‡12345æ¬¡ page_pv: true page_pv_header: æœ¬æ–‡æ€»é˜…è¯»é‡ page_pv_footer: æ¬¡ æ·»åŠ å‹æƒ…é“¾æŽ¥ç¼–è¾‘ ä¸»é¢˜é…ç½®æ–‡ä»¶ æ·»åŠ ï¼š # Blog rolls links_icon: link links_title: å‹æƒ…é“¾æŽ¥ # links_layout: block links_layout: inline links: åšå®¢å›­: http://www.cnblogs.com/sanduzxcvbnm/ ç™¾åº¦: https://www.baidu.com/ è…¾è®¯å…¬ç›Š404é¡µé¢æ–°å»º 404.html é¡µé¢ï¼Œæ”¾åˆ°ä¸»é¢˜çš„ source ç›®å½•ä¸‹ï¼Œå†…å®¹å¦‚ä¸‹ï¼š &lt;!DOCTYPE HTML&gt; &lt;html&gt; &lt;head&gt; &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8;&quot;/&gt; &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge,chrome=1&quot; /&gt; &lt;meta name=&quot;robots&quot; content=&quot;all&quot; /&gt; &lt;meta name=&quot;robots&quot; content=&quot;index,follow&quot;/&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://qzone.qq.com/gy/404/style/404style.css&quot;&gt; &lt;/head&gt; &lt;body&gt; &lt;script type=&quot;text/plain&quot; src=&quot;http://www.qq.com/404/search_children.js&quot; charset=&quot;utf-8&quot; homePageUrl=&quot;/&quot; homePageName=&quot;å›žåˆ°æˆ‘çš„ä¸»é¡µ&quot;&gt; &lt;/script&gt; &lt;script src=&quot;https://qzone.qq.com/gy/404/data.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt; &lt;script src=&quot;https://qzone.qq.com/gy/404/page.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt; &lt;/body&gt; &lt;/html&gt; è®¾ç½®åŠ¨ç”»æ•ˆæžœNexT é»˜è®¤å¼€å¯åŠ¨ç”»æ•ˆæžœï¼Œæ•ˆæžœä½¿ç”¨ JavaScript ç¼–å†™ï¼Œå› æ­¤éœ€è¦ç­‰å¾… JavaScript è„šæœ¬å®Œå…¨åŠ è½½å®Œæ¯•åŽæ‰ä¼šæ˜¾ç¤ºå†…å®¹ã€‚ å¦‚æžœæ‚¨æ¯”è¾ƒåœ¨ä¹Žé€Ÿåº¦ï¼Œå¯ä»¥å°†è®¾ç½®æ­¤å­—æ®µçš„å€¼ä¸º false æ¥å…³é—­åŠ¨ç”»ã€‚ ç¼–è¾‘ ä¸»é¢˜é…ç½®æ–‡ä»¶ï¼Œ æœç´¢ use_motionï¼Œæ ¹æ®æ‚¨çš„éœ€æ±‚è®¾ç½®å€¼ä¸º true æˆ–è€… false å³å¯ï¼š use_motion: true # å¼€å¯åŠ¨ç”»æ•ˆæžœ use_motion: false # å…³é—­åŠ¨ç”»æ•ˆæžœ æ·»åŠ è¿‘æœŸæ–‡ç« ç‰ˆå—åœ¨next/layout/_macro/sidebar.swigä¸­çš„if theme.linkså¯¹åº”çš„endifåŽé¢æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š åœ¨ä¸»é¢˜çš„_config.ymlä¸­æ·»åŠ äº†å‡ ä¸ªå˜é‡ï¼Œå¦‚ä¸‹ï¼šrecent_posts_title: è¿‘æœŸæ–‡ç« recent_posts_layout: blockrecent_posts: trueæ·»åŠ ç½‘æ˜“äº‘éŸ³ä¹å¤–é“¾ä¿®æ”¹ themes/next/layout/_macro/sidebar.swig æ–‡ä»¶ï¼Œåœ¨è”ç³»æ–¹å¼ä¸‹æ·»åŠ ç½‘æ˜“äº‘éŸ³ä¹å¤–é“¾ï¼š &lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=330 height=86 src=&quot;//music.163.com/outchain/player?type=2&amp;id=1333220817&amp;auto=1&amp;height=66&quot;&gt;&lt;/iframe&gt; ç„¶åŽhexo g/hexo då³å¯ã€‚ èŽ·å–ç½‘æ˜“äº‘å¤–é“¾çš„æ–¹å¼ï¼šæ‰“å¼€ç½‘æ˜“äº‘éŸ³ä¹ç½‘ç«™ï¼Œæœç´¢æ­Œæ›²ï¼Œè¿›å…¥åˆ°æ­Œæ›²è¯¦æƒ…é¡µé¢ï¼Œå·¦ä¾§æœ‰ç”Ÿæˆå¤–é“¾çš„æŒ‰é’®ï¼Œå¯ä»¥é€‰æ‹©æ˜¯å¦è‡ªåŠ¨æ’­æ”¾ç­‰ï¼Œä½†æ˜¯å—ç‰ˆæƒä¿æŠ¤çš„éŸ³ä¹æ— æ³•ç”Ÿæˆå¤–é“¾ã€‚ â€‹]]></content>
      <categories>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hexoæ­å»ºæ•™ç¨‹(2)]]></title>
    <url>%2F2019%2F12%2F31%2FHexo%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B-2%2F</url>
    <content type="text"><![CDATA[ç¬¬ä¸€éƒ¨åˆ†hexoæ­å»ºæ­¥éª¤å®‰è£…Gitå®‰è£…Node.jså®‰è£…HexoGitHubåˆ›å»ºä¸ªäººä»“åº“ç”ŸæˆSSHæ·»åŠ åˆ°GitHubå°†hexoéƒ¨ç½²åˆ°GitHubè®¾ç½®ä¸ªäººåŸŸåå‘å¸ƒæ–‡ç« å®‰è£…GitGitæ˜¯ç›®å‰ä¸–ç•Œä¸Šæœ€å…ˆè¿›çš„åˆ†å¸ƒå¼ç‰ˆæœ¬æŽ§åˆ¶ç³»ç»Ÿï¼Œå¯ä»¥æœ‰æ•ˆã€é«˜é€Ÿçš„å¤„ç†ä»Žå¾ˆå°åˆ°éžå¸¸å¤§çš„é¡¹ç›®ç‰ˆæœ¬ç®¡ç†ã€‚ ä¹Ÿæ˜¯ç”¨æ¥ç®¡ç†ä½ çš„hexoåšå®¢æ–‡ç« ï¼Œä¸Šä¼ åˆ°GitHubçš„å·¥å…·ã€‚ windowsï¼šåˆ°gitå®˜ç½‘ä¸Šä¸‹è½½,ä¸‹è½½å®‰è£…åŽä¼šæœ‰ä¸€ä¸ªGit Bashçš„å‘½ä»¤è¡Œå·¥å…·ï¼Œä»¥åŽå°±ç”¨è¿™ä¸ªå·¥å…·æ¥ä½¿ç”¨gitã€‚ linuxï¼šå› ä¸ºæœ€æ—©çš„gitå°±æ˜¯åœ¨linuxä¸Šç¼–å†™çš„ï¼Œåªéœ€è¦ä¸€è¡Œä»£ç ï¼šyum install git (apt-get install git) å®‰è£…å¥½åŽï¼Œç”¨git --version æ¥æŸ¥çœ‹ä¸€ä¸‹ç‰ˆæœ¬ æ³¨æ„:ä¸€å®šè¦å®‰è£…æœ€æ–°çš„ç‰ˆæœ¬ï¼Œè‹¥ç‰ˆæœ¬å¤ªä½ŽåŽé¢ä½¿ç”¨gitæ—¶ä¼šæœ‰å¦‚ä¸‹é”™è¯¯æƒ…å†µï¼š é”™è¯¯æç¤ºï¼š fatal: unable to access &apos;https://github.com/iissnan/hexo-theme-next.git&apos;: error :1407742E:SSL routines:SSL23_GET_SERVER_HELLO:tlsv1 alert protocol version é”™è¯¯åˆ†æžï¼šgithub 2æœˆ1æ—¥å‘äº†ä¸ªå…¬å‘ŠWeak cryptographic standards removal noticeï¼Œç®€è€Œè¨€ä¹‹å°±æ˜¯ä¸æ”¯æŒTLSv1/TLSv1.1 è§£å†³åŠžæ³•ï¼š ç¬¬ä¸€ç§ï¼šæ›´æ–°gitå’Œtortoisegitè‡³æœ€æ–°ç‰ˆ ç¬¬äºŒç§ï¼šæ£€æŸ¥TLSç‰ˆæœ¬ï¼šgit config http.sslVersion å¦‚æžœæ˜¯tlsv1.0ï¼Œåˆ™ç”¨ä¸‹é¢ä¸€å¥å‘½ä»¤è¡Œæ›´æ–°è‡³tlsv1.2 git config --global http.sslVersion tlsv1.2 å®‰è£…nodejsHexoæ˜¯åŸºäºŽnodejsç¼–å†™çš„ï¼Œéœ€è¦å®‰è£…ä¸€ä¸‹nodejså’Œé‡Œé¢çš„npmå·¥å…·ã€‚ windowsï¼šnodejsé€‰æ‹©LTSç‰ˆæœ¬ï¼Œä¸‹è½½ï¼Œå®‰è£…ã€‚ linuxï¼šyum install nodejs &amp;&amp; yum install npm æˆ–è€…ï¼šsudo apt-get install nodejs sudo apt-get install npm å®‰è£…å®ŒåŽï¼Œæ‰“å¼€å‘½ä»¤è¡Œï¼Œæ£€æŸ¥ä¸€ä¸‹æœ‰æ²¡æœ‰å®‰è£…æˆåŠŸ node -v npm -v å®‰è£…hexoå‰é¢gitå’Œnodejså®‰è£…å¥½åŽï¼Œå°±å¯ä»¥å®‰è£…hexoäº†ã€‚å…ˆåˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹my-blogï¼Œç„¶åŽcdåˆ°è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼ˆæˆ–è€…åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹ç›´æŽ¥å³é”®git bashæ‰“å¼€ï¼‰ã€‚ å®‰è£…Hexoè„šæ‰‹æž¶å·¥å…·ï¼Œè¾“å…¥å‘½ä»¤ï¼šnpm install -g hexo-cli ç”¨hexo -væŸ¥çœ‹ä¸€ä¸‹ç‰ˆæœ¬ è‡³æ­¤æ‰€éœ€è¦çš„è½¯ä»¶å°±å…¨éƒ¨å®‰è£…å®Œäº†ã€‚ æŽ¥ä¸‹æ¥åˆå§‹åŒ–ä¸€ä¸‹hexoï¼š $ hexo init my-blog # åˆ›å»ºå¹¶åˆå§‹åŒ–åšå®¢ç›®å½• $ cd my-blog # è¿›å…¥è¯¥åšå®¢ç›®å½• $ npm install # åˆ›å»ºé»˜è®¤åšå®¢æ–‡ä»¶ æ–°å»ºå®ŒæˆåŽï¼ŒæŒ‡å®šæ–‡ä»¶å¤¹ç›®å½•ä¸‹æœ‰ï¼š myblog â”œâ”€â”€ node_modules #ä¾èµ–åŒ… â”œâ”€â”€ public #å­˜æ”¾ç”Ÿæˆçš„é¡µé¢ â”œâ”€â”€ scaffolds #ç”Ÿæˆæ–‡ç« çš„ä¸€äº›æ¨¡æ¿ â”œâ”€â”€ source #ç”¨æ¥å­˜æ”¾ä½ çš„æ–‡ç«  | â”œâ”€â”€ _drafts #è‰ç¨¿ç›®å½• | â””â”€â”€ _posts #å‘å¸ƒçš„æ–‡ç« ç›®å½• â””â”€â”€ themes #ä¸»é¢˜ â”œâ”€â”€ _config.yml #åšå®¢é…ç½®æ–‡ä»¶ â”œâ”€â”€ package.json #æ¨¡å—å’Œä¾èµ–é¡¹ _config.ymlåšå®¢é…ç½®æ–‡ä»¶è¯´æ˜Žï¼š ç½‘ç«™ä¸»é¢˜çš„çš„é…ç½®æ–‡ä»¶ï¼Œå’Œgithub pageå…³è”å’Œåˆ‡æ¢ä¸»é¢˜æ—¶ï¼Œéœ€è¦ä½¿ç”¨åˆ° # Hexo Configuration ## Docs: https://hexo.io/docs/configuration.html ## Source: https://github.com/hexojs/hexo/ # Site title: ç½‘ç«™æ ‡é¢˜å¦‚ï¼šMinstorm-blog subtitle: ç½‘ç«™å‰¯æ ‡é¢˜ï¼šMinstorm description: ç½‘ç«™æè¿°ï¼šMinstorm:a blog for tech author: ç½‘ç«™ä½œè€…ï¼šDe scherpe language: ç½‘ç«™çš„è¯­è¨€ï¼Œè·Ÿå½“å‰ä½¿ç”¨çš„ä¸»é¢˜ä¸‹çš„è¯­è¨€æ–‡ä»¶æœ‰å…³ timezone: ç½‘ç«™çš„æ—¶åŒºï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯ç”µè„‘çš„æ—¶åŒº # URL ## If your site is put in a subdirectory, set url as &apos;http://yoursite.com/child&apos; and root as &apos;/child/&apos; url: ç½‘ç«™åœ°å€ï¼Œä¹Ÿå°±æ˜¯https://xxx.github.io/ åœ°å€ root: ç½‘ç«™æ ¹ç›®å½•,å»ºè®®æ˜¯ç”¨&apos;/&apos; permalink: æ–‡ç« çš„æ°¸ä¹…é“¾æŽ¥æ ¼å¼ï¼Œé»˜è®¤å°±å¥½ :year/:month/:day/:title/ permalink_defaults: æ°¸ä¹…é“¾æŽ¥ä¸­å„éƒ¨åˆ†çš„é»˜è®¤å€¼ï¼Œä¸ç”¨å¡« # Directory source_dir:èµ„æºæ–‡ä»¶å¤¹ï¼Œå­˜æ”¾æ–‡ç« ç”¨çš„ï¼šsource public_dir: å…¬å…±æ–‡ä»¶å¤¹ï¼Œç”¨æ¥å­˜æ”¾ç¼–è¯‘ä¹‹åŽçš„æ–‡ä»¶ï¼špublic tag_dir: æ ‡ç­¾æ–‡ä»¶å¤¹ï¼štags archive_dir: å½’æ¡£æ–‡ä»¶å¤¹ï¼Œä¹Ÿå°±æ˜¯ä½ çš„å…¨éƒ¨æ–‡ç« ç”Ÿæˆçš„ç›®å½•ï¼šarchives category_dir: åˆ†ç±»æ–‡ä»¶å¤¹ï¼šcategories code_dir: Include codeæ–‡ä»¶å¤¹ï¼šdownloads/code i18n_dir: å›½é™…åŒ–ï¼ˆi18nï¼‰æ–‡ä»¶å¤¹:lang skip_render: éœ€è¦è·³è¿‡æ¸²æŸ“çš„æ–‡ä»¶å­˜æ”¾çš„æ–‡ä»¶å¤¹ # Writing new_post_name: :title.md # File name of new posts default_layout: é»˜è®¤æ–‡ç« æ ·å¼ï¼špost titlecase: false # Transform title into titlecase external_link: true # Open external links in new tab filename_case: 0 render_drafts: false post_asset_folder: false relative_link: false future: true highlight: enable: true line_number: true auto_detect: false tab_replace: # Home page setting # path: Root path for your blogs index page. (default = &apos;&apos;) # per_page: Posts displayed per page. (0 = disable pagination) # order_by: Posts order. (Order by date descending by default) index_generator: path: &apos;&apos; per_page: æ¯ä¸€é¡µæ˜¾ç¤ºçš„æ–‡ç« ï¼š10 order_by: -date # Category &amp; Tag default_category: uncategorized category_map: tag_map: # Date / Time format ## Hexo uses Moment.js to parse and display date ## You can customize the date format as defined in ## http://momentjs.com/docs/#/displaying/format/ date_format: YYYY-MM-DD time_format: HH:mm:ss # Pagination ## Set per_page to 0 to disable pagination per_page: 10 pagination_dir: page # Extensions ## Plugins: https://hexo.io/plugins/ ## Themes: https://hexo.io/themes/ theme: ä¸»é¢˜ï¼šnext # Deployment ## Docs: https://hexo.io/docs/deployment.html deploy: # åŒæ­¥ä½¿ç”¨ type: æŽ¥ä¸‹æ¥å¼€å¯æœåŠ¡ ç¼–è¯‘ç”Ÿæˆé™æ€ç½‘é¡µæ–‡ä»¶ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š $ hexo generate å¯ä»¥ç®€å†™ä¸º$ hexo g æ³¨æ„ï¼Œå¦‚ä¸‹å›¾æ‰æ˜¯å‘½ä»¤æ­£ç¡®æ‰§è¡Œï¼Œå¦åˆ™æŒ‰ç…§æç¤ºè§£å†³é”™è¯¯ æœ¬åœ°é¢„è§ˆæ–‡ç« ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š $ hexo server å¯ä»¥ç®€å†™ä¸º$ hexo s å¦‚æžœéœ€è¦é¢„è§ˆdraftæ–‡ä»¶å¤¹ä¸‹é¢çš„æ–‡ä»¶ï¼Œéœ€è¦åœ¨åŽé¢åŠ ä¸Š--draftå‚æ•° $ hexo s --draft åœ¨æ‰§è¡Œhexo så‘½ä»¤åŽï¼Œä¼šå‡ºçŽ°ä¸€ä¸ªç½‘å€http://localhost:4000/ï¼Œå°†å…¶å¤åˆ¶(éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨cmdä¸­ä¸å¯ç”¨ctrl + c æ¥å¤åˆ¶ï¼ŒCtrl + Cä¸ºåœæ­¢å‘½ä»¤ï¼‰ã€‚ æ‰“å¼€è¯¥ç½‘å€åŽï¼Œå¯ä»¥çœ‹åˆ°ç½‘ç«™çš„é›å½¢ï¼Œä½¿ç”¨ctrl+cå¯ä»¥æŠŠæœåŠ¡å…³æŽ‰ã€‚ æ³¨ï¼šä»¥ä¸Šçš„æ“ä½œå®žçŽ°çš„æ•ˆæžœå¦‚ä¸‹: - è¿è¡ŒæœåŠ¡åŽï¼Œå¯ä»¥åœ¨æœ¬åœ°é¢„è§ˆåšå®¢ã€‚ - æŽ¥ä¸‹æ¥çš„æ“ä½œæ˜¯æŠŠåšå®¢æ–‡ä»¶ç»™æŽ¨é€åˆ°GitHubä¸Šï¼Œä½¿ç”¨GitHubæä¾›çš„åŸŸåè®¿é—®åšå®¢ GitHubåˆ›å»ºä¸ªäººä»“åº“é¦–å…ˆæ³¨å†Œä¸€ä¸ªGitHubè´¦æˆ·(æ³¨æ„ï¼šç”¨æˆ·åè·Ÿä½ çš„åšå®¢åŸŸåæœ‰å…³ï¼Œè¯·æ…Žé‡å–å) æ³¨å†Œå®Œç™»å½•åŽï¼Œåœ¨GitHub.comä¸­çœ‹åˆ°ä¸€ä¸ªNew repositoryï¼Œæ–°å»ºä»“åº“ã€‚ éœ€è¦åˆ›å»ºä¸€ä¸ªå’Œä½ ç”¨æˆ·åç›¸åŒçš„ä»“åº“ï¼ŒåŽé¢åŠ .github.ioï¼Œ åªæœ‰è¿™æ ·ï¼Œå°†æ¥è¦éƒ¨ç½²åˆ°GitHub pageçš„æ—¶å€™ï¼Œæ‰ä¼šè¢«è¯†åˆ«ï¼Œä¹Ÿå°±æ˜¯xxx.github.ioï¼Œ å…¶ä¸­xxxå°±æ˜¯ä½ æ³¨å†ŒGitHubçš„ç”¨æˆ·åã€‚ ç”ŸæˆSSHæ·»åŠ åˆ°GitHubå›žåˆ°ä½ çš„git bashä¸­ï¼Œè¾“å…¥å¦‚ä¸‹ä¸¤æ¡å‘½ä»¤ï¼š git config --global user.name &quot;yourname&quot; git config --global user.email &quot;youremail&quot; è¿™é‡Œçš„yournameè¾“å…¥ä½ çš„GitHubç”¨æˆ·åï¼Œyouremailè¾“å…¥ä½ GitHubçš„é‚®ç®±ã€‚è¿™æ ·GitHubæ‰èƒ½çŸ¥é“ä½ æ˜¯ä¸æ˜¯å¯¹åº”å®ƒçš„è´¦æˆ·ã€‚ å¯ä»¥ç”¨ä»¥ä¸‹ä¸¤æ¡ï¼Œæ£€æŸ¥ä¸€ä¸‹ä½ æœ‰æ²¡æœ‰è¾“å¯¹ï¼š git config user.name git config user.email ç„¶åŽåˆ›å»ºSSH,ä¸€è·¯å›žè½¦ ssh-keygen -t rsa -C &quot;youremail&quot; youremailæ˜¯ä½ æ³¨å†ŒGitHubçš„é‚®ç®± è¿™ä¸ªæ—¶å€™å®ƒä¼šå‘Šè¯‰ä½ å·²ç»ç”Ÿæˆäº†.sshçš„æ–‡ä»¶å¤¹ã€‚åœ¨ä½ çš„ç”µè„‘ä¸­æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹ã€‚ ç®€å•æ¥è®²ï¼Œå°±æ˜¯ä¸€ä¸ªç§˜é’¥ï¼Œå…¶ä¸­ï¼Œid_rsaæ˜¯ä½ è¿™å°ç”µè„‘çš„ç§äººç§˜é’¥ï¼Œä¸èƒ½ç»™åˆ«äººçœ‹çš„ï¼Œid_rsa.pubæ˜¯å…¬å…±ç§˜é’¥ï¼Œå¯ä»¥éšä¾¿ç»™åˆ«äººçœ‹ã€‚ æŠŠè¿™ä¸ªå…¬é’¥æ”¾åœ¨GitHubä¸Šï¼Œè¿™æ ·å½“ä½ é“¾æŽ¥GitHubè‡ªå·±çš„è´¦æˆ·æ—¶ï¼Œå®ƒå°±ä¼šæ ¹æ®å…¬é’¥åŒ¹é…ä½ çš„ç§é’¥ï¼Œå½“èƒ½å¤Ÿç›¸äº’åŒ¹é…æ—¶ï¼Œæ‰èƒ½å¤Ÿé¡ºåˆ©çš„é€šè¿‡gitä¸Šä¼ ä½ çš„æ–‡ä»¶åˆ°GitHubä¸Šã€‚ è€ŒåŽåœ¨GitHubçš„settingä¸­ï¼Œæ‰¾åˆ°SSH keysçš„è®¾ç½®é€‰é¡¹ï¼Œç‚¹å‡»New SSH keyï¼ŒæŠŠä½ çš„id_rsa.pubé‡Œé¢çš„ä¿¡æ¯å¤åˆ¶è¿›åŽ»ã€‚ åœ¨gitbashä¸­ï¼ŒæŸ¥çœ‹æ˜¯å¦æˆåŠŸ ssh -T git@github.com å°†hexoéƒ¨ç½²åˆ°GitHubè¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†hexoå’ŒGitHubå…³è”èµ·æ¥ï¼Œä¹Ÿå°±æ˜¯å°†hexoç”Ÿæˆçš„æ–‡ç« éƒ¨ç½²åˆ°GitHubä¸Šã€‚ éœ€è¦ç”¨åˆ°hexoçš„GitHubæ’ä»¶hexo-deployer-gitï¼Œé¦–å…ˆç”¨npmä¸‹è½½è¿™ä¸ªæ’ä»¶ $ npm install hexo-deployer-git --save ç„¶åŽæ‰“å¼€ç«™ç‚¹é…ç½®æ–‡ä»¶_config.ymlï¼Œç¿»åˆ°æœ€åŽï¼Œä¿®æ”¹ä¸ºYourgithubNameå°±æ˜¯ä½ çš„GitHubè´¦æˆ· deploy: type: git repo: git@github.com:ç”¨æˆ·å/ç”¨æˆ·å.github.io.git branch: master é…ç½®å¥½äº†deployä¹‹åŽï¼Œå°±å¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ä¸Šä¼ é¡¹ç›®äº† hexo clean hexo generate hexo deploy å…¶ä¸­ hexo cleanæ¸…é™¤äº†ä½ ä¹‹å‰ç”Ÿæˆçš„ä¸œè¥¿ï¼Œä¹Ÿå¯ä»¥ä¸åŠ ã€‚ hexo generate é¡¾åæ€ä¹‰ï¼Œç”Ÿæˆé™æ€æ–‡ç« ï¼Œå¯ä»¥ç”¨ hexo gç¼©å†™ hexo deploy éƒ¨ç½²æ–‡ç« ï¼Œå¯ä»¥ç”¨hexo dç¼©å†™ æ³¨æ„deployæ—¶å¯èƒ½è¦ä½ è¾“å…¥usernameå’Œpasswordã€‚ å¾—åˆ°ä¸‹å›¾å°±è¯´æ˜Žéƒ¨ç½²æˆåŠŸäº†ï¼Œè¿‡ä¸€ä¼šå„¿å°±å¯ä»¥åœ¨https://yourname.github.io è¿™ä¸ªç½‘ç«™çœ‹åˆ°ä½ çš„åšå®¢äº†ï¼ è®¾ç½®ä¸ªäººåŸŸåçŽ°åœ¨ä½ çš„ä¸ªäººç½‘ç«™çš„åœ°å€æ˜¯ yourname.github.ioï¼Œå¦‚æžœè§‰å¾—è¿™ä¸ªç½‘å€é€¼æ ¼ä¸å¤ªå¤Ÿï¼Œè¿™å°±éœ€è¦ä½ è®¾ç½®ä¸ªäººåŸŸåäº†ã€‚ä½†æ˜¯éœ€è¦èŠ±é’±ã€‚ æ³¨å†Œä¸€ä¸ªé˜¿é‡Œäº‘è´¦æˆ·,åœ¨é˜¿é‡Œäº‘ä¸Šä¹°ä¸€ä¸ªåŸŸåï¼Œå…ˆåŽ»è¿›è¡Œå®žåè®¤è¯,ç„¶åŽåœ¨åŸŸåæŽ§åˆ¶å°ä¸­ï¼Œçœ‹åˆ°ä½ è´­ä¹°çš„åŸŸåã€‚ ç‚¹è§£æžè¿›åŽ»ï¼Œæ·»åŠ è§£æž è®°å½•ç±»åž‹é€‰Aæˆ–CNAMEï¼ŒAè®°å½•çš„è®°å½•å€¼å°±æ˜¯ipåœ°å€ï¼Œgithub(å®˜æ–¹æ–‡æ¡£)æä¾›äº†ä¸¤ä¸ªIPåœ°å€ï¼Œ192.30.252.153å’Œ192.30.252.154ï¼Œ è¿™ä¸¤ä¸ªIPåœ°å€ä¸ºgithubçš„æœåŠ¡å™¨åœ°å€ï¼Œä¸¤ä¸ªéƒ½è¦å¡«ä¸Šï¼Œè§£æžè®°å½•è®¾ç½®ä¸¤ä¸ª@ï¼Œçº¿è·¯å°±é»˜è®¤å°±è¡Œäº†ï¼ŒCNAMEè®°å½•å€¼å¡«ä½ çš„githubåšå®¢ç½‘å€ã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æ³¨æ„ï¼Œè§£æžçº¿è·¯é€‰æ‹©é»˜è®¤ï¼Œ(è§£æžçº¿è·¯:å¢ƒå¤–æ˜¯åŽé¢æ¥åšå›½å†…å¤–åˆ†æµç”¨çš„,åœ¨åŽé¢ä¼šè®²åˆ°)ã€‚è®°å¾—çŽ°åœ¨é€‰æ‹©é»˜è®¤ï¼ ç™»å½•GitHubï¼Œè¿›å…¥ä¹‹å‰åˆ›å»ºçš„ä»“åº“ï¼Œç‚¹å‡»settingsï¼Œè®¾ç½®Custom domainï¼Œè¾“å…¥ä½ çš„ç½‘ç«™åœ°å€ é¡ºä¾¿å†å‹¾é€‰ä¸Šå¼ºåˆ¶ä½¿ç”¨httpsï¼Œ&quot;Enforce HTTPS&quot; ç„¶åŽåœ¨ä½ çš„åšå®¢æ–‡ä»¶æ ¹ç›®å½•çš„sourceä¸­åˆ›å»ºä¸€ä¸ªåä¸ºCNAMEæ–‡ä»¶ï¼Œä¸è¦åŽç¼€ã€‚å†™ä¸Šä½ çš„ç½‘ç«™åœ°å€ã€‚ æœ€åŽï¼Œåœ¨gitbashä¸­ï¼Œè¾“å…¥ hexo clean hexo g hexo d ç¨ç­‰ä¸€ä¼šå„¿ï¼Œå†æ‰“å¼€ä½ çš„æµè§ˆå™¨ï¼Œè¾“å…¥ä½ è‡ªå·±çš„ç½‘ç«™åœ°å€(ä½¿ç”¨httpsçš„æ–¹å¼)ï¼Œå°±å¯ä»¥çœ‹åˆ°æ­å»ºçš„ç½‘ç«™å•¦ï¼ æ€»ç»“ï¼ŒGitHubä¸Šé¢çš„é…ç½®å’ŒCNAMEé‡Œé¢çš„è®¾ç½®äº’ç›¸ç»“åˆï¼Œæœ‰å¦‚ä¸‹å‡ ç§æ–¹å¼ï¼š æŽ¥ä¸‹æ¥ä½ å°±å¯ä»¥æ­£å¼å¼€å§‹å†™æ–‡ç« äº†ã€‚ ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·åˆ›å»ºä¸€ç¯‡æ–‡ç«  $ hexo new [layout] &lt;title&gt; layoutæ˜¯æ–‡ç« çš„å¸ƒå±€ï¼Œé»˜è®¤æ˜¯postå¸ƒå±€ &lt;title&gt; æ˜¯æ–‡ç« åç§° ä¾‹å¦‚ï¼šhexo new post &apos;æˆ‘çš„ç¬¬ä¸€ç¯‡æ–‡ç« &apos; hexoè¿˜æœ‰ä¸€ä¸ªæ–‡ä»¶å¤¹æ˜¯è‰ç¨¿æ–‡ä»¶å¤¹_draftï¼Œå¯ä»¥ç”¨ç†è§£æˆç§å¯†æ–‡ç« çš„åŠŸèƒ½ï¼Œ åªè¦æœ‰ä¸æƒ³æ˜¾ç¤ºçš„æ–‡ç« ä½†æ˜¯åˆä¸æƒ³åˆ é™¤ï¼Œå°±å¯ä»¥æŠŠæ–‡ç« æ‹–è¿›åŽ»_draftæ–‡ä»¶å¤¹å°±å¯ä»¥å®žçŽ°éšè—çš„åŠŸèƒ½äº†ï¼Œä¹Ÿå¯ä»¥ç”¨hexoçš„å‘½ä»¤å°†æ–‡ç« æ”¾åˆ°è‰ç¨¿æ–‡ä»¶å¤¹ $ hexo publish &lt;layout&gt; &lt;filename&gt; ç„¶åŽåœ¨source/_postä¸­æ‰“å¼€markdownæ–‡ä»¶ï¼Œå°±å¯ä»¥å¼€å§‹ç¼–è¾‘äº†ã€‚å½“ä½ å†™å®Œçš„æ—¶å€™ï¼Œå† hexo clean hexo g hexo d å°±å¯ä»¥çœ‹åˆ°æ›´æ–°äº†ã€‚]]></content>
      <categories>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hexoæ­å»ºæ•™ç¨‹(3)]]></title>
    <url>%2F2019%2F12%2F31%2FHexo%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B-3%2F</url>
    <content type="text"><![CDATA[ç¬¬äºŒéƒ¨åˆ†hexoåŸºæœ¬é…ç½®åœ¨æ–‡ä»¶æ ¹ç›®å½•ä¸‹çš„_config.ymlï¼Œå°±æ˜¯æ•´ä¸ªhexoæ¡†æž¶çš„é…ç½®æ–‡ä»¶äº†ã€‚å¯ä»¥åœ¨é‡Œé¢ä¿®æ”¹å¤§éƒ¨åˆ†çš„é…ç½®ã€‚è¯¦ç»†å¯å‚è€ƒå®˜æ–¹çš„é…ç½®æè¿°ã€‚ ç½‘ç«™descriptionä¸»è¦ç”¨äºŽSEOï¼Œå‘Šè¯‰æœç´¢å¼•æ“Žä¸€ä¸ªå…³äºŽæ‚¨ç«™ç‚¹çš„ç®€å•æè¿°ï¼Œé€šå¸¸å»ºè®®åœ¨å…¶ä¸­åŒ…å«æ‚¨ç½‘ç«™çš„å…³é”®è¯ã€‚ authorå‚æ•°ç”¨äºŽä¸»é¢˜æ˜¾ç¤ºæ–‡ç« çš„ä½œè€…ã€‚ languageå¯ä»¥ç”¨æ¥è§£å†³èœå•ä¸­æ–‡ä¹±ç ï¼Œè®¾ç½®languageå­—æ®µå¦‚ä¸‹: language: zh-Hans æˆ–è€… anguage: zh-CN å–å†³äºŽä½ çš„ä¸»é¢˜themeç›®å½•ä¸‹çš„languageç›®å½•ä¸‹æœ‰zh-Hans.ymlè¿˜æ˜¯zh-CN.yml timezoneï¼Œä¸œå…«åŒºè®¾ç½®æ˜¯ Asia/Shanghai ç½‘å€åœ¨è¿™é‡Œéœ€è¦æŠŠurlæ”¹æˆä½ çš„ç½‘ç«™åŸŸåï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€æ­¥ä»“åº“åœ°å€çš„é‚£ä¸ªï¼Œhttps://xxx.github.io/ permalinkï¼Œä¹Ÿå°±æ˜¯ä½ ç”ŸæˆæŸä¸ªæ–‡ç« æ—¶çš„é‚£ä¸ªé“¾æŽ¥æ ¼å¼ã€‚ æ¯”å¦‚æˆ‘æ–°å»ºä¸€ä¸ªæ–‡ç« å«temp.mdï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ä»–è‡ªåŠ¨ç”Ÿæˆçš„åœ°å€å°±æ˜¯https://xxx.github.io/å¹´/æœˆ/æ—¥/tempã€‚ ä»¥ä¸‹æ˜¯å®˜æ–¹ç»™å‡ºçš„ç¤ºä¾‹ï¼Œå…³äºŽé“¾æŽ¥çš„å˜é‡è¿˜æœ‰å¾ˆå¤šï¼Œéœ€è¦çš„å¯ä»¥åŽ»å®˜ç½‘ä¸ŠæŸ¥æ‰¾ æ°¸ä¹…é“¾æŽ¥ ã€‚ ç½‘ç«™å­˜æ”¾åœ¨å­ç›®å½• å¦‚æžœæ‚¨çš„ç½‘ç«™å­˜æ”¾åœ¨å­ç›®å½•ä¸­ï¼Œä¾‹å¦‚ https://xxx.github.io/blogï¼Œåˆ™è¯·å°†æ‚¨çš„ url è®¾ä¸º https://xxx.github.io/blog å¹¶æŠŠ root è®¾ä¸º /blog/ã€‚ å†å¾€ä¸‹ç¿»ï¼Œä¸­é—´è¿™äº›éƒ½é»˜è®¤å°±å¥½äº†ã€‚ theme: landscape themeå°±æ˜¯é€‰æ‹©ä»€ä¹ˆä¸»é¢˜ï¼Œä¹Ÿå°±æ˜¯åœ¨themeè¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼Œåœ¨å®˜ç½‘ä¸Šæœ‰å¾ˆå¤šä¸ªä¸»é¢˜ï¼Œé»˜è®¤ç»™ä½ å®‰è£…çš„æ˜¯lanscapeè¿™ä¸ªä¸»é¢˜ã€‚ å½“ä½ éœ€è¦æ›´æ¢ä¸»é¢˜æ—¶ï¼Œåœ¨å®˜ç½‘ä¸Šä¸‹è½½ï¼ŒæŠŠä¸»é¢˜çš„æ–‡ä»¶æ”¾åœ¨themeæ–‡ä»¶å¤¹ä¸‹ï¼Œå†ä¿®æ”¹è¿™ä¸ªå‚æ•°å°±å¯ä»¥äº†ã€‚ åŒæ­¥åˆ°Git # Deployment ## Docs: https://hexo.io/docs/deployment.html deploy: type: git repo: &lt;repository url&gt; branch: [branch] deployå°±æ˜¯ç½‘ç«™çš„éƒ¨ç½²çš„ï¼Œrepoå°±æ˜¯ä»“åº“(Repository)çš„ç®€å†™ã€‚branché€‰æ‹©ä»“åº“çš„å“ªä¸ªåˆ†æ”¯ã€‚è€Œè¿™ä¸ªåœ¨åŽé¢è¿›è¡ŒåŒå¹³å°éƒ¨ç½²çš„æ—¶å€™ä¼šå†æ¬¡ç”¨åˆ°ã€‚ Front-matterFront-matter æ˜¯æ–‡ä»¶æœ€ä¸Šæ–¹ä»¥ --- åˆ†éš”çš„åŒºåŸŸï¼Œç”¨äºŽæŒ‡å®šä¸ªåˆ«æ–‡ä»¶çš„å˜é‡ï¼Œä¸¾ä¾‹æ¥è¯´ï¼š title: Hello World date: 2013/7/13 20:46:25 --- ä¸‹é¢è¿™äº›æ˜¯é¢„å…ˆå®šä¹‰çš„å‚æ•°ï¼Œæ‚¨å¯åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨è¿™äº›å‚æ•°å€¼å¹¶åŠ ä»¥åˆ©ç”¨ã€‚ å…¶ä¸­ï¼Œåˆ†ç±»å’Œæ ‡ç­¾éœ€è¦åŒºåˆ«ä¸€ä¸‹ï¼Œåˆ†ç±»å…·æœ‰é¡ºåºæ€§å’Œå±‚æ¬¡æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ Foo, Bar ä¸ç­‰äºŽ Bar, Fooï¼›è€Œæ ‡ç­¾æ²¡æœ‰é¡ºåºå’Œå±‚æ¬¡ã€‚ layout(å¸ƒå±€)å½“ä½ æ¯ä¸€æ¬¡ä½¿ç”¨ä»£ç :hexo new paper,å®ƒå…¶å®žé»˜è®¤ä½¿ç”¨çš„æ˜¯postè¿™ä¸ªå¸ƒå±€ï¼Œä¹Ÿå°±æ˜¯åœ¨sourceæ–‡ä»¶å¤¹ä¸‹çš„_posté‡Œé¢ã€‚ Hexo æœ‰ä¸‰ç§é»˜è®¤å¸ƒå±€ï¼špostã€page å’Œ draftï¼Œå®ƒä»¬åˆ†åˆ«å¯¹åº”ä¸åŒçš„è·¯å¾„ï¼Œè€Œæ‚¨è‡ªå®šä¹‰çš„å…¶ä»–å¸ƒå±€å’Œ post ç›¸åŒï¼Œéƒ½å°†å‚¨å­˜åˆ° source/_posts æ–‡ä»¶å¤¹ã€‚ è€Œnewè¿™ä¸ªå‘½ä»¤å…¶å®žæ˜¯ï¼šhexo new [layout] &lt;title&gt;,åªä¸è¿‡è¿™ä¸ªlayouté»˜è®¤æ˜¯postç½¢äº†ã€‚ pageå¦‚æžœä½ æƒ³å¦èµ·ä¸€é¡µï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨:hexo new page board ç³»ç»Ÿä¼šè‡ªåŠ¨ç»™ä½ åœ¨sourceæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªboardæ–‡ä»¶å¤¹ï¼Œä»¥åŠboardæ–‡ä»¶å¤¹ä¸­çš„index.mdï¼Œè¿™æ ·ä½ è®¿é—®çš„boardå¯¹åº”çš„é“¾æŽ¥å°±æ˜¯https://xxx.github.io/board draftdraftæ˜¯è‰ç¨¿çš„æ„æ€ï¼Œä¹Ÿå°±æ˜¯ä½ å¦‚æžœæƒ³å†™æ–‡ç« ï¼Œåˆä¸å¸Œæœ›è¢«çœ‹åˆ°ï¼Œé‚£ä¹ˆå¯ä»¥:hexo new draft newpage è¿™æ ·ä¼šåœ¨source/_draftä¸­æ–°å»ºä¸€ä¸ªnewpage.mdæ–‡ä»¶ï¼Œå¦‚æžœä½ çš„è‰ç¨¿æ–‡ä»¶å†™çš„è¿‡ç¨‹ä¸­ï¼Œæƒ³è¦é¢„è§ˆä¸€ä¸‹ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨:hexo server --draft,åœ¨æœ¬åœ°ç«¯å£ä¸­å¼€å¯æœåŠ¡é¢„è§ˆã€‚ å¦‚æžœä½ çš„è‰ç¨¿æ–‡ä»¶å†™å®Œäº†ï¼Œæƒ³è¦å‘è¡¨åˆ°postä¸­ï¼Œhexo publish draft newpage,å°±ä¼šè‡ªåŠ¨æŠŠnewpage.mdå‘é€åˆ°postä¸­ã€‚ ä¸»é¢˜æ›´æ¢ä¸»é¢˜å¦‚æžœè§‰å¾—é»˜è®¤çš„landscapeä¸»é¢˜ä¸å¥½çœ‹ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨å®˜ç½‘çš„ä¸»é¢˜ä¸­ï¼Œé€‰æ‹©ä½ å–œæ¬¢çš„ä¸€ä¸ªä¸»é¢˜ä¸‹è½½ï¼Œç„¶åŽè¿›è¡Œä¿®æ”¹å°±å¯ä»¥äº†ã€‚ è¿›å…¥åˆ°åšå®¢ç›®å½•æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå«ä¹‰æ˜¯å…‹éš†è¯¥ä¸»é¢˜å¹¶å­˜å…¥åˆ°åšå®¢æ–‡ä»¶å¤¹ä¸‹çš„themsæ–‡ä»¶ä¸‹é‡Œ git clone https://github.com/iissnan/hexo-theme-next.git themes/next æ‰§è¡ŒåŽå°±ä¼šåœ¨åšå®¢ç›®å½•æ–‡ä»¶å¤¹çš„themesä¸­å¯ä»¥æ‰¾åˆ°æœ‰nextçš„æ–‡ä»¶ã€‚ æ‰¾åˆ°åšå®¢æ ¹ç›®å½•ä¸‹çš„_config.ymlæ–‡ä»¶ï¼Œä¿®æ”¹é‡Œé¢çš„é…ç½® å°†theme ä¿®æ”¹ä¸ºtheme: nextï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å†’å·åŽæœ‰ç©ºæ ¼ è¿›å…¥nextè¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œå¯ä»¥çœ‹åˆ°é‡Œé¢ä¹Ÿæœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶_config.ymlï¼Œè¿™ä¸ªé…ç½®æ–‡ä»¶æ˜¯æ•´ä¸ªä¸»é¢˜çš„é…ç½®æ–‡ä»¶ã€‚ ä»¥ä¸‹å…³äºŽä¸»é¢˜çš„é…ç½®å‡æ˜¯æŒ‰ç…§nextä¸»é¢˜è®¾ç½®çš„ã€‚ menu(èœå•æ )ä¹Ÿå³æ˜¯å¦‚ä¸‹å›¾æ‰€ç¤ºçš„è¿™äº›ä¸œè¥¿ï¼š å…¶ä¸­ï¼ŒAboutè¿™ä¸ªä½ æ˜¯æ‰¾ä¸åˆ°ç½‘é¡µçš„ï¼Œå› ä¸ºä½ çš„æ–‡ç« ä¸­æ²¡æœ‰aboutè¿™ä¸ªä¸œè¥¿ã€‚ å¦‚æžœä½ æƒ³è¦çš„è¯ï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼šhexo new page about å®ƒå°±ä¼šåœ¨æ ¹ç›®å½•ä¸‹sourceæ–‡ä»¶å¤¹ä¸­æ–°å»ºäº†ä¸€ä¸ªaboutæ–‡ä»¶å¤¹ï¼Œä»¥åŠindex.mdï¼Œåœ¨index.mdä¸­å†™ä¸Šä½ æƒ³è¦å†™çš„ä¸œè¥¿ï¼Œå°±å¯ä»¥åœ¨ç½‘ç«™ä¸Šå±•ç¤ºå‡ºæ¥äº†ã€‚ å¦‚æžœä½ æƒ³è¦è‡ªå·±å†è‡ªå®šä¹‰ä¸€ä¸ªèœå•æ çš„é€‰é¡¹ï¼Œé‚£ä¹ˆå°±ï¼šhexo new page yourdiy ç„¶åŽåœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶çš„menuèœå•æ æ·»åŠ ä¸€ä¸ª Yourdiy : /yourdiyï¼Œæ³¨æ„å†’å·åŽé¢è¦æœ‰ç©ºæ ¼ï¼Œä»¥åŠå‰é¢çš„ç©ºæ ¼è¦å’Œmenuä¸­é»˜è®¤çš„ä¿æŒæ•´é½ã€‚ ç„¶åŽåœ¨languagesæ–‡ä»¶å¤¹ä¸­ï¼Œæ‰¾åˆ°zh-CN.ymlï¼Œåœ¨indexä¸­æ·»åŠ yourdiy: &apos;ä¸­æ–‡æ„æ€&apos;å°±å¯ä»¥æ˜¾ç¤ºä¸­æ–‡äº†ã€‚ æ„æ€æ˜¯è¯´åœ¨menuä¸­å†™å…¥çš„æ˜¯è‹±æ–‡ï¼Œä½†æ˜¯ç½‘ç«™ä½¿ç”¨çš„è¯ä¼šæ ¹æ®ç½‘ç«™ä½¿ç”¨çš„è¯­è¨€åˆ°ç›¸åº”çš„è¯­è¨€åŒ…ä¸­æŸ¥æ‰¾åˆ°è¯¥è‹±è¯­çš„é‡Šä¹‰ï¼Œç„¶åŽå†ç½‘ç«™ä¸Šæ˜¾ç¤ºå‡ºæ¥ã€‚ æ¯”å¦‚menuèœå•æˆ‘å†™çš„æ˜¯homeï¼Œä½†æ˜¯ç½‘ç«™è¯­è¨€é…ç½®ä½¿ç”¨çš„æ˜¯zh-Hansï¼Œæ­¤æ—¶å°±ä¼šåˆ°å½“å‰ä½¿ç”¨ä¸»é¢˜çš„è¯­è¨€åŒ…ä¸‹æ‰¾zh-Hans.ymlæ–‡ä»¶ï¼Œåœ¨è¯¥æ–‡ä»¶ä¸­ï¼Œæœ‰ä¸€æ¡æ•°æ® home:ä¸»é¡µï¼Œåˆ™è®¿é—®è¯¥ç½‘ç«™æ—¶åŽŸå…ˆå†™çš„æ˜¯homeçš„åœ°æ–¹åˆ™ä¼šæ˜¾ç¤ºå‡ºâ€œä¸»é¡µâ€å­—æ ·ã€‚ customize(å®šåˆ¶)å¯ä»¥ä¿®æ”¹ä½ çš„ä¸ªäººlogoï¼Œåœ¨å½“å‰ä½¿ç”¨çš„ä¸»é¢˜æ–‡ä»¶å¤¹ä¸‹çš„source/css/imagesæ–‡ä»¶å¤¹ä¸­æ”¾å…¥è‡ªå·±è¦çš„logoï¼Œå†æ”¹ä¸€ä¸‹urlçš„é“¾æŽ¥åå­—å°±å¯ä»¥äº†ã€‚ faviconæ˜¯ç½‘ç«™ä¸­å‡ºçŽ°çš„é‚£ä¸ªå°å›¾æ ‡çš„iconï¼Œæ‰¾ä¸€å¼ ä½ å–œæ¬¢çš„logoï¼Œç„¶åŽè½¬æ¢æˆicoæ ¼å¼ï¼Œæ”¾åœ¨imagesæ–‡ä»¶å¤¹ä¸‹ï¼Œé…ç½®ä¸€ä¸‹è·¯å¾„å°±è¡Œã€‚ social_links ï¼Œå¯ä»¥æ˜¾ç¤ºä½ çš„ç¤¾äº¤é“¾æŽ¥ï¼Œè€Œä¸”æ˜¯æœ‰logoçš„ã€‚ æ·»åŠ RSS1. å…ˆå®‰è£…RSSæ’ä»¶: npm i hexo-generator-feed 2. è€ŒåŽåœ¨ä½ æ•´ä¸ªé¡¹ç›®çš„_config.ymlä¸­æ‰¾åˆ°Extensionsï¼Œæ·»åŠ ï¼š # Extensions ## Plugins: https://hexo.io/plugins/ #RSSè®¢é˜… plugin: - hexo-generator-feed #Feed Atom feed: type: atom path: atom.xml limit: 20 è¿™ä¸ªæ—¶å€™ä½ çš„RSSé“¾æŽ¥å°±æ˜¯ åŸŸå/atom.xmläº† 3.åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­è®¾ç½®ï¼šrss: ï¼Œå¼€å¯RSSçš„é¡µé¢åŠŸèƒ½ï¼Œè¿™æ ·ä½ ç½‘ç«™ä¸Šå°±æœ‰é‚£ä¸ªåƒwifiä¸€æ ·ç¬¦å·çš„RSS logoäº†ï¼Œæ³¨æ„ç©ºæ ¼ã€‚ widgets(ä¾§è¾¹æ )ä¾§è¾¹æ çš„å°æ ‡ç­¾ï¼Œå¦‚æžœä½ æƒ³è‡ªå·±å¢žåŠ ä¸€ä¸ªï¼Œæ¯”å¦‚æˆ‘å¢žåŠ äº†ä¸€ä¸ªè”ç³»æ–¹å¼ï¼Œé‚£ä¹ˆæˆ‘æŠŠcommunicationå†™åœ¨ä¸Šé¢ï¼Œåœ¨zh-CN.ymlä¸­çš„sidebarï¼Œæ·»åŠ communication: &apos;ä¸­æ–‡&apos;ã€‚ ç„¶åŽåœ¨hueman/layout/widgetä¸­æ·»åŠ ä¸€ä¸ªcommunicaiton.ejsï¼Œå¡«å…¥æ¨¡æ¿ï¼š search(æœç´¢æ¡†)é»˜è®¤æœç´¢æ¡†æ˜¯ä¸èƒ½å¤Ÿç”¨çš„ï¼Œéœ€è¦å®‰è£…æ’ä»¶ï¼šhexo-generator-json-content comment(è¯„è®ºç³»ç»Ÿ)valineå¥½åƒä¸é”™ï¼Œè¿˜èƒ½ç»Ÿè®¡æ–‡ç« é˜…è¯»é‡ï¼Œå¯ä»¥è‡ªå·±è¯•ä¸€è¯• è®¾ç½®å¤´åƒå’Œfaviconå¤´åƒ/å›¾æ ‡å›¾ç‰‡çš„å­˜æ”¾ä½ç½®æ˜¯/themes/yilia(ä¸»é¢˜)/source/ä¸‹ä»»æ„ä½ç½®ï¼Œå¯ä»¥è‡ªå·±æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å­˜æ”¾ï¼Œæ¯”å¦‚imgæ–‡ä»¶å¤¹ä¸‹ã€‚ æ‰“å¼€ä¸»é¢˜ç›¸åº”çš„é…ç½®æ–‡ä»¶ï¼š/themes/yilia/_config.ymlã€‚ è®¾ç½®å¤´åƒä¸ºé…ç½®æ–‡ä»¶ä¸­avatarä¸€é¡¹ï¼Œè®¾ç½®å›¾æ ‡ä¸ºé…ç½®æ–‡ä»¶ä¸­faviconä¸€é¡¹ã€‚ è®¾ç½®è·¯å¾„çš„æ ¹ç›®å½•ä¸º/themes/yilia/source/ã€‚ä¾‹å¦‚ï¼Œæˆ‘çš„å¤´åƒå­˜æ”¾çš„åœ°å€æ˜¯/themes/yilia/source/img/me.pngï¼Œè®¾ç½®åˆ™ä¸ºavatar: /img/me.pngã€‚ï¼ˆå›¾æ ‡åŒç†ï¼‰ æ‰“èµåŠŸèƒ½æ‰“å¼€ä¸»é¢˜ç›¸åº”çš„é…ç½®æ–‡ä»¶ï¼š/themes/yilia/_config.ymlã€‚ # æ‰“èµ # æ‰“èµtypeè®¾å®šï¼š0-å…³é—­æ‰“èµï¼› 1-æ–‡ç« å¯¹åº”çš„mdæ–‡ä»¶é‡Œæœ‰reward:trueå±žæ€§ï¼Œæ‰æœ‰æ‰“èµï¼› 2-æ‰€æœ‰æ–‡ç« å‡æœ‰æ‰“èµ reward_type: 2 # æ‰“èµwording reward_wording: &apos;æ‚¨çš„é¼“åŠ±æ˜¯æˆ‘ç»§ç»­å‰è¿›çš„åŠ¨åŠ›~~~&apos; # æ”¯ä»˜å®äºŒç»´ç å›¾ç‰‡åœ°å€ï¼Œè·Ÿä½ è®¾ç½®å¤´åƒçš„æ–¹å¼ä¸€æ ·ã€‚æ¯”å¦‚ï¼š/assets/img/alipay.jpg alipay: /img/alipay.jpg # å¾®ä¿¡äºŒç»´ç å›¾ç‰‡åœ°å€ weixin: /img/wechat.jpg gitåˆ†æ”¯è¿›è¡Œå¤šç»ˆç«¯å·¥ä½œåˆ©ç”¨gitçš„åˆ†æ”¯ç³»ç»Ÿè¿›è¡Œå¤šç»ˆç«¯å·¥ä½œäº†ï¼Œè¿™æ ·æ¯æ¬¡æ‰“å¼€ä¸ä¸€æ ·çš„ç”µè„‘ï¼Œåªéœ€è¦è¿›è¡Œç®€å•çš„é…ç½®å’Œåœ¨githubä¸ŠæŠŠæ–‡ä»¶åŒæ­¥ä¸‹æ¥ï¼Œå°±å¯ä»¥æ— ç¼æ“ä½œäº†ã€‚ æœºåˆ¶ç”±äºŽhexo dä¸Šä¼ éƒ¨ç½²åˆ°githubçš„å…¶å®žæ˜¯hexoç¼–è¯‘åŽçš„æ–‡ä»¶ï¼Œæ˜¯ç”¨æ¥ç”Ÿæˆç½‘é¡µçš„ï¼Œä¸åŒ…å«æºæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¼ çš„æ˜¯åœ¨æœ¬åœ°ç›®å½•é‡Œè‡ªåŠ¨ç”Ÿæˆçš„.deploy_gité‡Œé¢ã€‚å…¶ä»–æ–‡ä»¶ ï¼ŒåŒ…æ‹¬æˆ‘ä»¬å†™åœ¨source é‡Œé¢çš„ï¼Œå’Œé…ç½®æ–‡ä»¶ï¼Œä¸»é¢˜æ–‡ä»¶ï¼Œéƒ½æ²¡æœ‰ä¸Šä¼ åˆ°githubã€‚æ‰€ä»¥å¯ä»¥åˆ©ç”¨gitçš„åˆ†æ”¯ç®¡ç†ï¼Œå°†æºæ–‡ä»¶ä¸Šä¼ åˆ°githubçš„å¦ä¸€ä¸ªåˆ†æ”¯å³å¯ã€‚ åˆ›å»ºåˆ†æ”¯æ‰¾åˆ°ä¹‹å‰å»ºç«‹çš„ä»“åº“ï¼Œåœ¨å…¶ä¸Šæ–°å»ºä¸€ä¸ªhexoåˆ†æ”¯ï¼Œå¦‚å›¾ï¼š ç„¶åŽåœ¨è¿™ä¸ªä»“åº“çš„settingsä¸­ï¼Œé€‰æ‹©é»˜è®¤åˆ†æ”¯ä¸ºhexoåˆ†æ”¯ï¼ˆè¿™æ ·æ¯æ¬¡åŒæ­¥çš„æ—¶å€™å°±ä¸ç”¨æŒ‡å®šåˆ†æ”¯ï¼Œæ¯”è¾ƒæ–¹ä¾¿ï¼‰ã€‚ ç„¶åŽåœ¨æœ¬åœ°çš„ä»»æ„ç›®å½•ä¸‹ï¼Œæ‰“å¼€git bashï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼šgit clone git@github.com:xxx/xxx.github.io.git,xxxä¸ºç”¨æˆ·åï¼Œä¹Ÿå°±æ˜¯è¯¥ä»“åº“çš„gitåœ°å€ã€‚ å°†å…¶å…‹éš†åˆ°æœ¬åœ°ï¼Œå› ä¸ºé»˜è®¤åˆ†æ”¯å·²ç»è®¾æˆäº†hexoï¼Œæ‰€ä»¥cloneæ—¶åªcloneäº†hexoã€‚ æŽ¥ä¸‹æ¥åœ¨å…‹éš†åˆ°æœ¬åœ°çš„xxx.github.ioä¸­ï¼ŒæŠŠé™¤äº†.git æ–‡ä»¶å¤¹å¤–çš„æ‰€æœ‰æ–‡ä»¶éƒ½åˆ æŽ‰ã€‚æŠŠä¹‹å‰æˆ‘ä»¬å†™çš„åšå®¢æºæ–‡ä»¶å…¨éƒ¨å¤åˆ¶è¿‡æ¥ï¼Œé™¤äº†.deploy_gitã€‚ è¿™é‡Œåº”è¯¥è¯´ä¸€å¥ï¼Œå¤åˆ¶è¿‡æ¥çš„æºæ–‡ä»¶åº”è¯¥æœ‰ä¸€ä¸ª.gitignoreï¼Œç”¨æ¥å¿½ç•¥ä¸€äº›ä¸éœ€è¦çš„æ–‡ä»¶ï¼Œå¦‚æžœæ²¡æœ‰çš„è¯ï¼Œè‡ªå·±æ–°å»ºä¸€ä¸ªï¼Œåœ¨é‡Œé¢å†™ä¸Šå¦‚ä¸‹ï¼Œè¡¨ç¤ºè¿™äº›ç±»åž‹æ–‡ä»¶ä¸éœ€è¦gitï¼š Thumbs.db db.json *.log node_modules/ public/ .deploy*/ æ³¨æ„ï¼Œå¦‚æžœä½ ä¹‹å‰å…‹éš†è¿‡themeä¸­çš„ä¸»é¢˜æ–‡ä»¶ï¼Œé‚£ä¹ˆåº”è¯¥æŠŠä¸»é¢˜æ–‡ä»¶ä¸­çš„.gitæ–‡ä»¶å¤¹åˆ æŽ‰ï¼Œå› ä¸ºgitä¸èƒ½åµŒå¥—ä¸Šä¼ ï¼Œæœ€å¥½æ˜¯æ˜¾ç¤ºéšè—æ–‡ä»¶ï¼Œæ£€æŸ¥ä¸€ä¸‹æœ‰æ²¡æœ‰ï¼Œæœ‰çš„è¯å°±åˆ é™¤ã€‚ è‹¥æ²¡æœ‰.gitignoreæ–‡ä»¶è¦å¦‚ä½•åˆ›å»º? åœ¨å½“å‰xxx.github.ioæ–‡ä»¶å¤¹é‡Œï¼Œé¼ æ ‡å³é”®é€‰æ‹©â€œGit Bash Hereâ€ï¼Œæ‰“å¼€ã€git bashã€‘çš„ç•Œé¢ï¼Œåœ¨å‘½ä»¤ä¸‹è¾“å…¥ã€touch .gitignoreã€‘å³å¯åˆ›å»º.gitignoreæ–‡ä»¶ è€ŒåŽæ·»åŠ æ–‡ä»¶åˆ°æš‚å­˜åŒºï¼ŒæŠŠæš‚å­˜åŒºæ–‡ä»¶æäº¤åˆ°ä»“åº“ï¼ŒåŒæ­¥ï¼š git add . git commit â€“m &quot;add branch&quot; git push è¿™æ ·å°±ä¸Šä¼ å®Œäº†ï¼Œå¯ä»¥åŽ»ä½ çš„githubä¸Šçœ‹ä¸€çœ‹hexoåˆ†æ”¯æœ‰æ²¡æœ‰ä¸Šä¼ ä¸ŠåŽ»ï¼Œå…¶ä¸­node_modulesã€publicã€db.jsonå·²ç»è¢«å¿½ç•¥æŽ‰äº†ï¼Œæ²¡æœ‰å…³ç³»ï¼Œä¸éœ€è¦ä¸Šä¼ çš„ï¼Œå› ä¸ºåœ¨åˆ«çš„ç”µè„‘ä¸Šéœ€è¦é‡æ–°è¾“å…¥å‘½ä»¤å®‰è£… ã€‚ æœ€ç»ˆæ•ˆæžœæ˜¯ï¼Œä¸€ä¸ªä»“åº“é‡Œï¼Œä¸»åˆ†æ”¯æ˜¯åšå®¢é™æ€æ–‡ä»¶ï¼Œhexoåˆ†æ”¯æ˜¯åšå®¢æºç æ–‡ä»¶ æ›´æ¢ç”µè„‘æ“ä½œ- å®‰è£…Git - è®¾ç½®gitå…¨å±€é‚®ç®±å’Œç”¨æˆ·å git config --global user.name &quot;yourgithubname&quot; git config --global user.email &quot;yourgithubemail&quot; - è®¾ç½®ssh key ssh-keygen -t rsa -C &quot;youremail&quot; #ç”ŸæˆåŽå¡«åˆ°githubå’Œcodingä¸Šï¼ˆæœ‰codingå¹³å°çš„è¯ï¼‰ #éªŒè¯æ˜¯å¦æˆåŠŸ ssh -T git@github.com - å®‰è£…nodejs yum install nodejs &amp;&amp; yum install npm - å®‰è£…hexo npm install hexo-cli -g ä½†æ˜¯å·²ç»ä¸éœ€è¦åˆå§‹åŒ–äº†,ç›´æŽ¥åœ¨ä»»æ„æ–‡ä»¶å¤¹ä¸‹æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼šgit clone git@github.com:xxx/xxx.github.io.gitï¼Œ ç„¶åŽè¿›å…¥å…‹éš†åˆ°çš„æ–‡ä»¶å¤¹ï¼š cd xxx.github.io npm install npm install hexo-deployer-git --save ç”Ÿæˆï¼Œéƒ¨ç½²ï¼š hexo g hexo d ç„¶åŽå°±å¯ä»¥å¼€å§‹å†™ä½ çš„æ–°åšå®¢äº†ï¼šhexo new newpage æ¯æ¬¡å†™å®Œæœ€å¥½éƒ½æŠŠæºæ–‡ä»¶ä¸Šä¼ ä¸€ä¸‹ï¼š git add . git commit â€“m &quot;xxxx&quot; git push å¦‚æžœæ˜¯åœ¨å·²ç»ç¼–è¾‘è¿‡çš„ç”µè„‘ä¸Šï¼Œå·²ç»æœ‰cloneæ–‡ä»¶å¤¹äº†ï¼Œé‚£ä¹ˆï¼Œæ¯æ¬¡åªè¦å’Œè¿œç«¯åŒæ­¥ä¸€ä¸‹å°±è¡Œäº†ï¼šgit pull coding pageä¸Šéƒ¨ç½²å®žçŽ°å›½å†…å¤–åˆ†æµä¹‹å‰æˆ‘ä»¬å·²ç»æŠŠhexoæ‰˜ç®¡åœ¨githubäº†ï¼Œä½†æ˜¯githubæ˜¯å›½å¤–çš„ï¼Œè€Œä¸”ç™¾åº¦çš„çˆ¬è™«æ˜¯ä¸èƒ½å¤Ÿçˆ¬å–githubçš„ï¼Œæ‰€ä»¥å¦‚æžœä½ å¸Œæœ›ä½ åšçš„åšå®¢èƒ½å¤Ÿåœ¨ç™¾åº¦å¼•æ“Žä¸Šè¢«æ”¶å½•ï¼Œè€Œä¸”æƒ³è¦æ›´å¿«çš„è®¿é—®ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨å›½å†…çš„coding pageåšä¸€ä¸ªæ‰˜ç®¡ï¼Œè¿™æ ·åœ¨å›½å†…è®¿é—®å°±æ˜¯coding pageï¼Œå›½å¤–å°±èµ°github pageã€‚ ç”³è¯·codingè´¦æˆ·ï¼Œæ–°å»ºé¡¹ç›®å…ˆç”³è¯·ä¸€ä¸ªè´¦æˆ·ï¼Œç„¶åŽåˆ›å»ºæ–°çš„é¡¹ç›®ï¼Œè¿™ä¸€æ­¥é¡¹ç›®åç§°åº”è¯¥æ˜¯éšæ„çš„ã€‚ æ·»åŠ ssh keyè¿™ä¸€æ­¥è·Ÿgithubä¸€æ ·ã€‚æ·»åŠ åŽï¼Œæ£€æŸ¥ä¸€ä¸‹æ˜¯ä¸æ˜¯æ·»åŠ æˆåŠŸ ssh -T git@git.coding.net ä¿®æ”¹_config.ymlhexoå®˜æ–¹æ–‡æ¡£æ˜¯è¿™æ ·çš„ï¼š deploy: type: git message: [message] repo: github: &lt;repository url&gt;,[branch] coding: &lt;repository url&gt;,[branch] é‚£ä¹ˆï¼Œæˆ‘ä»¬åªéœ€è¦ï¼š deploy: type: git repo: coding: git@git.coding.net:ZJUFangzh/ZJUFangzh.git,master github: git@github.com:ZJUFangzh/ZJUFangzh.github.io.git,master éƒ¨ç½²ä¿å­˜ä¸€ä¸‹ï¼Œç›´æŽ¥ hexo g hexo d è¿™æ ·å°±å¯ä»¥åœ¨codingçš„é¡¹ç›®ä¸Šçœ‹åˆ°ä½ éƒ¨ç½²çš„æ–‡ä»¶äº†ã€‚ å¼€å¯coding pagesæœåŠ¡ï¼Œç»‘å®šåŸŸåé˜¿é‡Œäº‘æ·»åŠ è§£æžè¿™ä¸ªæ—¶å€™å°±å¯ä»¥æŠŠä¹‹å‰githubçš„è§£æžæ”¹æˆå¢ƒå¤–ï¼ŒæŠŠcodingçš„è§£æžè®¾ä¸ºé»˜è®¤äº†ã€‚ åŽ»é™¤coding pageçš„è·³è½¬å¹¿å‘Šcoding pageçš„ä¸€ä¸ªæ¯”è¾ƒæ¶å¿ƒäººçš„åœ°æ–¹å°±æ˜¯ï¼Œä½ åªæ˜¯é“¶ç‰Œä¼šå‘˜çš„è¯ï¼Œè®¿é—®ä¼šå…ˆè·³è½¬åˆ°ä¸€ä¸ªå¹¿å‘Šï¼Œå†åˆ°ä½ è‡ªå·±çš„åŸŸåã€‚é‚£ä¹ˆå®ƒä¹Ÿç»™å‡ºäº†æ¶ˆé™¤çš„åŠžæ³•ã€‚å³ä¸Šè§’åˆ‡æ¢åˆ°codingçš„æ—§ç‰ˆç•Œé¢ï¼Œé»˜è®¤æ–°ç‰ˆæ˜¯ä¸è¡Œçš„ã€‚ç„¶åŽå†æ¥åˆ°pagesæœåŠ¡è¿™é‡Œã€‚ åªè¦ä½ åœ¨é¡µé¢ä¸Šæ·»åŠ ä¸€è¡Œæ–‡å­—ï¼Œå†™Hosted by Coding Pagesï¼Œç„¶åŽç‚¹ä¸‹é¢çš„å°å‹¾å‹¾ï¼Œä¸¤ä¸ªå·¥ä½œæ—¥å†…å®ƒå°±ä¼šå®¡æ ¸é€šè¿‡äº†ã€‚ &lt;p&gt;Hosted by &lt;a href=&quot;https://pages.coding.me&quot; style=&quot;font-weight: bold&quot;&gt;Coding Pages&lt;/a&gt;&lt;/p&gt; å¯ä»¥æŠŠè¿™ä¸€è¡Œä»£ç æ”¾åœ¨ä¸»é¢˜æ–‡ä»¶å¤¹/layout/common/footer.ejsé‡Œé¢ï¼Œä¹Ÿå°±æ˜¯æœ¬æ¥åœ¨é¡µé¢ä¸­çœ‹åˆ°çš„é¡µè„šéƒ¨åˆ†ã€‚å½“ç„¶ï¼Œä¸ºäº†ç»Ÿä¸€ï¼Œåˆåœ¨åŽé¢åŠ ä¸Šäº†and Githubã€‚ æœ€ç»ˆåŠ ä¸ŠåŽ»çš„ä»£ç ï¼š &lt;p&gt;&lt;span&gt;Hosted by &lt;a href=&quot;https://pages.coding.me&quot; style=&quot;font-weight: bold&quot;&gt;Coding Pages&lt;/a&gt;&lt;/span&gt; and &lt;span&gt;&lt;a href=&quot;https://github.com&quot; style=&quot;font-weight: bold&quot;&gt;Github&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;]]></content>
      <categories>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hexoæ­å»ºæ•™ç¨‹(1)]]></title>
    <url>%2F2019%2F12%2F31%2FHexo%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B-1%2F</url>
    <content type="text"><![CDATA[ç®€è¦è¯´æ˜ŽçŽ°åœ¨å¸‚é¢ä¸Šçš„åšå®¢å¾ˆå¤šï¼Œå¦‚CSDNï¼Œåšå®¢å›­ï¼Œç®€ä¹¦ç­‰å¹³å°ï¼Œå¯ä»¥ç›´æŽ¥åœ¨ä¸Šé¢å‘è¡¨ï¼Œç”¨æˆ·äº¤äº’åšçš„å¥½ï¼Œå†™çš„æ–‡ç« ç™¾åº¦ä¹Ÿèƒ½æœç´¢çš„åˆ°ã€‚ç¼ºç‚¹æ˜¯æ¯”è¾ƒä¸è‡ªç”±ï¼Œä¼šå—åˆ°å¹³å°çš„å„ç§é™åˆ¶å’Œæ¶å¿ƒçš„å¹¿å‘Šã€‚è‡ªå·±è´­ä¹°åŸŸåå’ŒæœåŠ¡å™¨ï¼Œæ­å»ºåšå®¢çš„æˆæœ¬å®žåœ¨æ˜¯å¤ªé«˜äº†ï¼Œä¸å…‰æ˜¯è¯´è¿™äº›è´­ä¹°æˆæœ¬ï¼Œå•å•æ˜¯èŠ±åŠ›æ°”åŽ»è‡ªå·±æ­è¿™ä¹ˆä¸€ä¸ªç½‘ç«™ï¼Œè¿˜è¦å®šæœŸçš„ç»´æŠ¤å®ƒï¼Œå¯¹äºŽæˆ‘ä»¬å¤§å¤šæ•°äººæ¥è¯´ï¼Œå®žåœ¨æ˜¯æ²¡æœ‰è¿™æ ·çš„ç²¾åŠ›å’Œæ—¶é—´ã€‚é‚£ä¹ˆå°±æœ‰ç¬¬ä¸‰ç§é€‰æ‹©ï¼Œç›´æŽ¥åœ¨github pageå¹³å°ä¸Šæ‰˜ç®¡æˆ‘ä»¬çš„åšå®¢ã€‚è¿™æ ·å°±å¯ä»¥å®‰å¿ƒçš„æ¥å†™ä½œï¼Œåˆä¸éœ€è¦å®šæœŸç»´æŠ¤ï¼Œè€Œä¸”hexoä½œä¸ºä¸€ä¸ªå¿«é€Ÿç®€æ´çš„åšå®¢æ¡†æž¶ï¼Œç”¨å®ƒæ¥æ­å»ºåšå®¢çœŸçš„éžå¸¸å®¹æ˜“ã€‚Hexoæ˜¯ä¸€æ¬¾åŸºäºŽNode.jsçš„é™æ€åšå®¢æ¡†æž¶ï¼Œä¾èµ–å°‘æ˜“äºŽå®‰è£…ä½¿ç”¨ï¼Œå¯ä»¥æ–¹ä¾¿çš„ç”Ÿæˆé™æ€ç½‘é¡µæ‰˜ç®¡åœ¨GitHubå’ŒCodingä¸Šï¼Œæ˜¯æ­å»ºåšå®¢çš„é¦–é€‰æ¡†æž¶ã€‚Hexo ä½¿ç”¨ Markdownï¼ˆæˆ–å…¶ä»–æ¸²æŸ“å¼•æ“Žï¼‰è§£æžæ–‡ç« ï¼Œå¹¶ä¸”ä½¿ç”¨jsonæ¥è¿›è¡Œæ•°æ®å‚¨å­˜ï¼Œå®Œå…¨ä¸éœ€è¦æ•°æ®åº“æ¥å‚¨å­˜æ•°æ®ï¼Œåœ¨å‡ ç§’å†…ï¼Œå³å¯åˆ©ç”¨é“ä¸½çš„ä¸»é¢˜ç”Ÿæˆé™æ€ç½‘é¡µã€‚å› ä¸ºHexoçš„åˆ›å»ºè€…æ˜¯å°æ¹¾äººï¼Œå¯¹ä¸­æ–‡çš„æ”¯æŒå¾ˆå‹å¥½ï¼Œå¯ä»¥é€‰æ‹©ä¸­æ–‡è¿›è¡ŒæŸ¥çœ‹ã€‚æ•™ç¨‹åˆ†ä¸‰ä¸ªéƒ¨åˆ†ç¬¬ä¸€éƒ¨åˆ†ï¼šhexoçš„åˆçº§æ­å»º,éƒ¨ç½²åˆ°github pageä¸Šï¼Œä»¥åŠä¸ªäººåŸŸåçš„ç»‘å®šã€‚ç¬¬äºŒéƒ¨åˆ†ï¼šhexoçš„åŸºæœ¬é…ç½®ï¼Œæ›´æ¢ä¸»é¢˜ï¼Œå®žçŽ°å¤šç»ˆç«¯å·¥ä½œï¼Œä»¥åŠåœ¨coding pageéƒ¨ç½²å®žçŽ°å›½å†…å¤–åˆ†æµç¬¬ä¸‰éƒ¨åˆ†ï¼šhexoæ·»åŠ å„ç§åŠŸèƒ½æ•™ç¨‹æ±‡æ€»GitHubç¯‡ç™¾åº¦æœç´¢github,è¿›å…¥å®˜ç½‘æ³¨å†Œã€‚ï¼ˆæ³¨æ„ï¼šç”¨æˆ·åè·Ÿä½ çš„åšå®¢åŸŸåæœ‰å…³ï¼Œè¯·æ…Žé‡å–åï¼‰ é€‰æ‹©freeï¼Œç‚¹å‡»startï¼ŒéªŒè¯é‚®ç®±ï¼Œè¿›å…¥æ³¨å†Œçš„é‚®ç®±ï¼Œæ‰“å¼€githubç»™æˆ‘ä»¬å‘é€çš„é‚®ä»¶ï¼Œç‚¹å‡»éªŒè¯é“¾æŽ¥ï¼Œ éªŒè¯å®ŒæˆåŽç‚¹å‡»startï¼Œåˆ›å»ºä»“åº“ã€‚ä»“åº“åå¿…é¡»ä¸ºâ€™ç”¨æˆ·å.github.ioâ€™ åˆ›å»ºå¥½åŽæˆ‘ä»¬æ¥æ–°å»ºä¸ªæ–‡ä»¶ï¼Œç‚¹å‡»Create new file æ–‡ä»¶ä¸ºindex.htmlï¼Œå†…å®¹ä¸º&lt;h1&gt;Hello Github Pages&lt;/h1&gt; å¤åˆ¶ä½ çš„ä»“åº“åâ€”â€”â€”â€”ç”¨æˆ·å.github.io åœ¨æµè§ˆå™¨ä¸­ç²˜è´´,è®¿é—®,å°±èƒ½çœ‹åˆ°æˆ‘ä»¬åˆšåˆšè¾“å…¥çš„å†…å®¹ Gitç¯‡ç™¾åº¦æœç´¢git for windowsï¼Œç‚¹å‡»è¿›å…¥å®˜ç½‘ç‚¹å‡»ä¸‹è½½ï¼Œä¸‹è½½å¥½åŽç¡®è®¤å®‰è£…ï¼Œé€‰æ‹©Use Windowsçš„è¿™ä¸ªé€‰é¡¹ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨cmdçª—å£ä¸­ä½¿ç”¨gitå‘½ä»¤ github SSH Key é…ç½® æ¥åˆ°æˆ‘ä»¬git for winçš„å®‰è£…ç›®å½•ä¸‹ï¼Œæ‰“å¼€git-bashï¼Œè¾“å…¥ssh-keygen -t rsa -C â€œgithubçš„æ³¨å†Œé‚®ç®±åœ°å€â€ï¼Œä¸€è·¯å›žè½¦ç”Ÿæˆå¯†é’¥ï¼Œé»˜è®¤ç”Ÿæˆåœ¨C:\Users\ç”¨æˆ·å.sshç›®å½•ä¸‹é¢ã€‚ æŽ¥ä¸‹æ¥æ¥åˆ°githubå®˜ç½‘ï¼Œç‚¹å‡»å¤´åƒé€‰æ‹©setting å†ç‚¹å‡»SSH and GPG keysï¼Œé€‰æ‹©å³è¾¹çš„New SSH key æ ‡é¢˜å¯ä»¥è‡ªå®šä¹‰ï¼Œæ‰¾åˆ°æˆ‘ä»¬ç”Ÿæˆçš„å¯†é’¥(id_rsa.pub)ï¼Œé»˜è®¤ç”Ÿæˆåœ¨C:\Users\ç”¨æˆ·å.sshç›®å½•ä¸‹é¢ï¼Œæ‹·è´åˆ°Keyä¸‹ï¼Œç„¶åŽä¿å­˜ã€‚ Hexoç¯‡å…ˆåœ¨æœ¬åœ°æ–°å»ºä¸ªblogæ–‡ä»¶å¤¹(éšæ„)ï¼Œåœ¨cmdå‘½ä»¤è¡Œè¿›å…¥åˆ°blogæ–‡ä»¶å¤¹ä¸‹ã€‚ï¼ˆwin+Ræ‰“å¼€è¿è¡Œå¯¹è¯æ¡†ï¼Œè¾“å…¥cmdæ‰“å¼€å‘½ä»¤è¡Œç¨‹åºï¼‰, åœ¨æ‰“å¼€çš„å‘½ä»¤è¡Œä¸­è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼šnpm install hexo-cli -gï¼Œå›žè½¦ç¡®è®¤å‘½ä»¤ï¼Œå®‰è£…ã€‚ å®‰è£…æˆåŠŸåŽï¼ŒjæŽ¥ç€åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥å¹¶è¿è¡Œåˆå§‹åŒ–å‘½ä»¤ï¼šhexo init blog åˆå§‹åŒ–å¥½åŽï¼Œè¿›å…¥æ–‡ä»¶å¤¹ï¼Œè¾“å…¥å‘½ä»¤å®‰è£…ä¾ï¼š npm install è‹¥ç½‘ç»œè¾ƒå·®ï¼Œå¯ä»¥ä½¿ç”¨æ·˜å®é•œåƒï¼š å‘½ä»¤:npm install -g cnpm â€“registry=https://registry.npm.taobao.org ä½¿ç”¨å°±æ˜¯æŠŠnpmæ”¹æˆcnpmå³å¯ã€‚ å®‰è£…å®ŒæˆåŽï¼Œè¾“å…¥hexo s -p 5555(åœ¨æŒ‡å®šç«¯å£5555å¯åŠ¨æœåŠ¡) åœ¨ç½‘é¡µä¸Šè¾“å…¥localhost:5555é¢„è§ˆä¸€ä¸‹ï¼ˆlocalhostè¡¨ç¤ºæœ¬åœ°è®¿é—®ï¼‰ æ‰“å¼€_config.ymlæ–‡ä»¶ï¼Œéœ€è¦ä¿®æ”¹çš„åœ°æ–¹æœ‰ï¼štitle(ç½‘ç«™å)ï¼Œauthor(ä½œè€…)ï¼Œdescription(ä»‹ç»)ï¼Œurl(å³æ˜¯â€œhttps://ç”¨æˆ·å.github.io)ã€‚ ä½¿ç”¨Ctrl+Sä¿å­˜æ–‡ä»¶. çŽ°åœ¨æˆ‘ä»¬æ‰“å¼€githubèŽ·å–ä»“åº“åœ°å€,ç‚¹å‡»å¤´åƒ-&gt;Your profile,ç‚¹å‡»å¯¹åº”çš„ä»“åº“,ç‚¹å‡»Clone or downloadï¼Œ å¤åˆ¶ä»“åº“åœ°å€,åœ¨_config.ymlçš„æœ€åŽæ‰¾åˆ°deployï¼Œè¾“å…¥å¦‚ä¸‹å†…å®¹ï¼ˆæ³¨æ„è¦æœ‰ç©ºæ ¼å’Œç¼©è¿›ï¼Œä¸ç„¶ä¼šæŠ¥é”™ï¼‰ deploy: type:git repository: git@github.com:ç”¨æˆ·å/ç”¨æˆ·å.github.io.git branch: master æŽ¥ä¸‹æ¥è¿˜éœ€è¦å®‰è£…gitæ’ä»¶ï¼Œå‘½ä»¤: npm install hexo-deployer-git â€“save å®‰è£…å¥½åŽè¾“å…¥hexo gï¼Œç”Ÿæˆé™æ€æ–‡ä»¶å‘½ä»¤ å†è¾“å…¥å‘½ä»¤:hexo d,éƒ¨ç½²åˆ°github ç¬¬ä¸€æäº¤ä¼šæç¤ºæ‚¨é…ç½®githubçš„é‚®ç®±å’Œç”¨æˆ·å,åœ¨å¼¹å‡ºçš„è¾“å…¥æ¡†ä¸­è¾“å…¥ç”¨æˆ·åï¼Œå¯†ç ç™»å½•. æ˜¾ç¤ºå‡ºINFO Deploy done: gitè¡¨ç¤ºæˆåŠŸå‘å¸ƒåˆ°githubä¸Š åœ¨æµè§ˆå™¨ä¸Šè¾“å…¥ â€œç”¨æˆ·å.github.ioâ€ å³å¯è®¿é—®è‡ªå·±çš„åšå®¢ ä¸»é¢˜ç¯‡åœ¨hexoå®˜ç½‘çš„Themesä¸‹ï¼Œæœç´¢nextï¼Œæœç´¢ç»“æžœç‚¹å‡»è·³è½¬åˆ°githubä»“åº“ï¼Œç‚¹å‡»CNæŸ¥çœ‹ä¸­æ–‡ä»‹ç»ï¼Œç‚¹å‡»è¯¦ç»†å®‰è£…æ­¥éª¤ï¼Œä¸‹è½½ç¨³å®šç‰ˆæœ¬(git clone),æ‹·è´åˆ°åšå®¢ç›®å½•çš„themesä¸‹. git clone https://github.com/iissnan/hexo-theme-next.git themes/next æˆ–è€…ä¸‹è½½ä¸‹æ¥ä¸»é¢˜åŽ‹ç¼©åŒ…æ–‡ä»¶ï¼Œè§£åŽ‹åŽä¿®æ”¹æ–‡ä»¶åç§°æ”¾åˆ°themesæ–‡ä»¶å¤¹ä¸‹ æ‰“å¼€_config.ymlï¼Œä¿®æ”¹ theme: nextã€‚ æ³¨æ„æ˜¯åšå®¢ç›®å½•ä¸‹çš„_config.ymlï¼Œä¸æ˜¯ä¸»é¢˜ç›®å½•ä¸‹çš„ hexo g é‡æ–°ç”Ÿæˆä¸€ä¸‹ hexo s -p 5555æœ¬åœ°ç«¯å£éƒ¨ç½² æ‰“å¼€æµè§ˆå™¨è¾“å…¥ï¼šlocalhost:5555ï¼Œé¢„è§ˆä¸€ä¸‹ä¸»é¢˜æ•ˆæžœ â€‹]]></content>
      <categories>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Flask-RESTPluså®˜æ–¹æ–‡æ¡£ç¿»è¯‘]]></title>
    <url>%2F2019%2F12%2F31%2FFlask-RESTPlus%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%E7%BF%BB%E8%AF%91%2F</url>
    <content type="text"><![CDATA[æ¬¢è¿Žæ–‡æ¡£Flask-RESTPlus æ˜¯å¯¹ Flask çš„æ‰©å±•ï¼Œå®ƒå¢žåŠ äº†å¯¹å¿«é€Ÿå¼€å‘ REST API çš„æ”¯æŒã€‚Flask-RESTPlus é¼“åŠ±ä»¥æœ€å°çš„è®¾ç½®æ¥å®žçŽ°åŠŸèƒ½çš„å¼€å‘ã€‚å¦‚æžœä½ ç†Ÿæ‚‰ Flaskï¼Œé‚£ä¹ˆä¼šå¾ˆå®¹æ˜“å°±èƒ½ä¸Šæ‰‹ Flask-RESTPlusã€‚Flask-RESTPlus ä¸­æä¾›äº†å¤§é‡çš„è£…é¥°å™¨å’Œå·¥å…·æ¥æè¿°ä½ çš„ APIï¼Œå¹¶ä»¥æ–‡æ¡£åŒ–çš„å½¢å¼å°†è¿™äº›æŽ¥å£å±•çŽ°å‡ºæ¥(é€šè¿‡Swaggeræ¥å®žçŽ°)ã€‚1. ç‰ˆæœ¬å…¼å®¹æ€§æ”¯æŒ 2.7+ä»¥ä¸Šç‰ˆæœ¬çš„python2. å®‰è£…1. ä½¿ç”¨pipæ–¹å¼è¿›è¡Œå®‰è£…1$ pip install flask-restplus2. ä½¿ç”¨easy_installæ–¹å¼è¿›è¡Œå®‰è£…1$ easy_install flask-restplus3. æ•™ç¨‹æ–‡æ¡£3.1 å®‰è£…ä½¿ç”¨pipæ–¹å¼è¿›è¡Œå®‰è£…1pip install flask-restpluså¼€å‘ç‰ˆæœ¬å¯ä»¥é€šè¿‡GitHubçš„æ–¹å¼è¿›è¡Œä¸‹è½½å®‰è£…123git clone https://github.com/noirbizarre/flask-restplus.gitcd flask-restpluspip install -e .[dev,test]Flask-RESTPlusæ”¯æŒPythonç‰ˆæœ¬æ˜¯2.7ï¼Œ3.3ï¼Œ3.4ï¼Œ3.5.åŒæ ·ä¹Ÿæ”¯æŒ PyPy and PyPy3.3.2 å¿«é€Ÿå¼€å§‹å‰ææ¡ä»¶:äº†è§£Flaskï¼Œå·²ç»å®‰è£…å¥½Flaskå’ŒFlask-RESTPlusã€‚3.2.1 åˆå§‹åŒ–12345from flask import Flaskfrom flask_restplus import Apiapp = Flask(__name__)api = Api(app)æˆ–è€…ä½¿ç”¨å·¥åŽ‚æ¨¡å¼è¿›è¡Œåˆå§‹åŒ–ï¼š123456from flask import Flaskfrom flask_restplus import Apiapi = Api()app = Flask(__name__)api.init_app(app)3.2.2 æœ€ç®€å•çš„API12345678910111213from flask import Flaskfrom flask_restplus import Resource, Apiapp = Flask(__name__)api = Api(app)@api.route('/hello')class HelloWorld(Resource): def get(self): return &#123;'hello': 'world'&#125;if __name__ == '__main__': app.run(debug=True)ä¿å­˜è¯¥æ–‡ä»¶ä¸ºapi.py.ä½¿ç”¨pythonè§£é‡Šå™¨è¿è¡Œè¯¥æ–‡ä»¶ï¼Œå¹¶ä¸”å¼€å¯debugæ¨¡å¼æ–¹ä¾¿è°ƒè¯•ã€‚123$ python api.py* Running on http://127.0.0.1:5000/* Restarting with reloaderè­¦å‘Š:ä¸è¦åœ¨ç”Ÿäº§çŽ¯å¢ƒå¼€å¯debugæ¨¡å¼ä½¿ç”¨curlå‘½ä»¤è®¿é—®è¯¥æŽ¥å£:12$ curl http://127.0.0.1:5000/hello&#123;"hello": "world"&#125;æˆ–è€…ä½¿ç”¨æµè§ˆå™¨,è¾“å…¥åœ°å€:http://127.0.0.1:5000/helloè¿›è¡Œè®¿é—®3.2.3 èµ„æºè·¯ç”±12345678910111213141516171819from flask import Flask, requestfrom flask_restplus import Resource, Apiapp = Flask(__name__)api = Api(app)todos = &#123;&#125;@api.route('/&lt;string:todo_id&gt;')class TodoSimple(Resource): def get(self, todo_id): return &#123;todo_id: todos[todo_id]&#125; def put(self, todo_id): todos[todo_id] = request.form['data'] return &#123;todo_id: todos[todo_id]&#125;if __name__ == '__main__': app.run(debug=True)ä½¿ç”¨curlå‘½ä»¤è®¿é—®:12345678$ curl http://localhost:5000/todo1 -d "data=Remember the milk" -X PUT&#123;"todo1": "Remember the milk"&#125;$ curl http://localhost:5000/todo1&#123;"todo1": "Remember the milk"&#125;$ curl http://localhost:5000/todo2 -d "data=Change my brakepads" -X PUT&#123;"todo2": "Change my brakepads"&#125;$ curl http://localhost:5000/todo2&#123;"todo2": "Change my brakepads"&#125;æˆ–è€…ä½¿ç”¨pythonçš„Requestsæ¨¡å—è¿›è¡Œè®¿é—®123456789&gt;&gt;&gt; from requests import put, get&gt;&gt;&gt; put('http://localhost:5000/todo1', data=&#123;'data': 'Remember the milk'&#125;).json()&#123;u'todo1': u'Remember the milk'&#125;&gt;&gt;&gt; get('http://localhost:5000/todo1').json()&#123;u'todo1': u'Remember the milk'&#125;&gt;&gt;&gt; put('http://localhost:5000/todo2', data=&#123;'data': 'Change my brakepads'&#125;).json()&#123;u'todo2': u'Change my brakepads'&#125;&gt;&gt;&gt; get('http://localhost:5000/todo2').json()&#123;u'todo2': u'Change my brakepads'&#125;Flask-RESTPlusè¿”å›žä»»ä½•å¯è¿­ä»£çš„ç±»åž‹ï¼Œå®ƒä¼šå°†è¯¥è¿”å›žå€¼è½¬æ¢æˆå“åº”å¯¹è±¡ï¼ˆresponseï¼‰ï¼ŒåŒ…æ‹¬åŽŸå§‹çš„ Flask å“åº”å¯¹è±¡ã€‚Flask-RESTPlus è¿˜æä¾›äº†è®¾ç½®å“åº”ç å’Œå“åº”å¤´çš„åŠŸèƒ½.1234567891011121314class Todo1(Resource): def get(self): # Default to 200 OK return &#123;'task': 'Hello world'&#125;class Todo2(Resource): def get(self): # Set the response code to 201 return &#123;'task': 'Hello world'&#125;, 201class Todo3(Resource): def get(self): # Set the response code to 201 and return custom headers return &#123;'task': 'Hello world'&#125;, 201, &#123;'Etag': 'some-opaque-string'&#125;3.2.4 ç«¯ç‚¹å¯ä»¥å‘ Api å¯¹è±¡çš„add_resource()æ–¹æ³•æˆ– route()è£…é¥°å™¨ä¸­ä¼ å…¥å¤šä¸ª URLï¼Œè¿™æ ·æ¯ä¸ª URL éƒ½å°†ä¼šè·¯ç”±åˆ°è¯¥èµ„æºä¸Šï¼š12345api.add_resource(HelloWorld, '/hello', '/world') # HelloWorldä¸ºä¸‹æ–¹çš„classç±»å# æˆ–è€…ä¸‹é¢è£…é¥°å™¨æ–¹å¼ï¼ŒäºŒè€…ç­‰ä»·@api.route('/hello', '/world')class HelloWorld(Resource): passä¹Ÿå¯ä»¥å°† URL ä¸­çš„éƒ¨åˆ†å†…å®¹è®¾ç½®æˆå˜é‡ï¼Œä»¥æ­¤æ¥åŒ¹é…èµ„æºæ–¹æ³•12345api.add_resource(HelloWorld, '/todo/&lt;int:todo_id&gt;', endpoint='todo_ep')# æˆ–è€…ä¸‹é¢è£…é¥°å™¨æ–¹å¼ï¼ŒäºŒè€…ç­‰ä»·@api.route('/todo/&lt;int:todo_id&gt;', endpoint='todo_ep')class HelloWorld(Resource): passæ³¨æ„:å¦‚æžœä¸€ä¸ªè¯·æ±‚ï¼ˆrequestï¼‰ä¸Žåº”ç”¨çš„ä»»ä½•ç«¯ç‚¹éƒ½ä¸åŒ¹é…ï¼Œé‚£ä¹ˆ Flask-RESTPlus å°†ä¼šè¿”å›žä¸€ä¸ª 404 é”™è¯¯ä¿¡æ¯ï¼Œå¹¶ç»™å‡ºå…¶ä»–ä¸Žæ‰€è¯·æ±‚ç«¯ç‚¹æœ€åŒ¹é…çš„å»ºè®®ä¿¡æ¯ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ç¨‹åºé…ç½®ä¸­è®¾ç½® ERROR_404_HELP ä¸º False æ¥å…³é—­è¯¥åŠŸèƒ½ã€‚1app.config['ERROR_404_HELP'] = False3.2.5 å‚æ•°è§£æžFlask-RESTPlus å†…ç½®æ”¯æŒå¯¹è¯·æ±‚æ•°æ®çš„éªŒè¯ï¼Œè¿™ä¸€åŠŸèƒ½æ˜¯é€šè¿‡ä½¿ç”¨ä¸€ä¸ªç±»ä¼¼äºŽ argparse çš„åº“æ¥å®žçŽ°çš„123456from flask_restplus import reqparseparser = reqparse.RequestParser()parser.add_argument('rate', type=int, help='Rate to charge for this resource')args = parser.parse_args() # æ”¾åˆ°éœ€è¦éªŒè¯ç”¨æˆ·æäº¤çš„æ•°æ®çš„å‡½æ•°æ–¹æ³•ä¸­æ³¨æ„ï¼šparse_args()è¿”å›žçš„æ˜¯ä¸€ä¸ª Python å­—å…¸ï¼Œè€Œä¸æ˜¯è‡ªå®šä¹‰æ•°æ®ç»“æž„ã€‚ä½¿ç”¨ RequestParser ç±»è¿˜èƒ½èŽ·å–å®Œæ•´çš„é”™è¯¯ä¿¡æ¯ã€‚å¦‚æžœä¸€ä¸ªå‚æ•°æœªéªŒè¯é€šè¿‡ï¼ŒFlask-RESTPlus å°†å“åº”ä¸€ä¸ª 400 é”™è¯¯è¯·æ±‚ï¼Œä»¥åŠä¸€ä¸ªé«˜äº®é”™è¯¯ä¿¡æ¯çš„å“åº”ã€‚ç¤ºä¾‹ç¨‹åºå¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031#!/usr/bin/env python# -*- coding: utf-8 -*-from flask import Flask, requestfrom flask_restplus import Api, Resource, reqparse, fieldsapp = Flask(__name__)# app.config['ERROR_404_HELP'] = Falseapi = Api(app)parser = reqparse.RequestParser()parser.add_argument('rate', type=int, required=True,help='Rate to charge for this resource')# parser.add_argument('data', required=True,help='data to charge for this resource')todos = &#123; '1':'eat', '2':'sleep'&#125;@api.route('/&lt;string:todo_id&gt;')class TodoSimple(Resource): def get(self, todo_id): return &#123;todo_id: todos[todo_id]&#125; def put(self, todo_id): args = parser.parse_args() # print(args) todos[todo_id] = request.form['data'] return &#123;todo_id: todos[todo_id]&#125; # return argså…¶ä¸­ï¼Œparser.add_argument(â€˜rateâ€™, type=int,required=True,help=â€™Rate to charge for this resourceâ€™)è¡¨ç¤ºï¼Œå‚æ•°åä¸º rateï¼Œæ•°æ®ç±»åž‹ä¸º intï¼Œè¯·æ±‚æ—¶å¿…é¡»å‘é€æ­¤å‚æ•°ï¼Œå¦‚æžœéªŒè¯ä¸é€šè¿‡æ—¶å°†ä¼šè¿”å›ž help æŒ‡å®šçš„ä¿¡æ¯ã€‚è¿è¡Œç¨‹åºå¹¶ä½¿ç”¨ curl è¿›è¡Œè®¿é—®ï¼Œå‡ ç§æƒ…å†µçš„éªŒè¯ç»“æžœå¦‚ä¸‹ï¼šï‚· æä¾› rate å€¼ï¼Œä½†ä¸æ˜¯ int åž‹ï¼ˆéªŒè¯ä¸é€šè¿‡ï¼‰ï‚· æä¾› rate å€¼ï¼Œä¸”æ˜¯ int åž‹ï¼ˆéªŒè¯é€šè¿‡ï¼‰ï‚· ä¸æä¾› rate å€¼ï¼ˆéªŒè¯ä¸é€šè¿‡ï¼‰æ³¨:ä½¿ç”¨curlè®¿é—®çš„æ—¶å€™,é™¤äº†éœ€è¦ä¼ é€’dataå‚æ•°å€¼å¤–,è¿˜éœ€è¦ä¼ é€’rateå‚æ•°å€¼æ‰è¡Œ.å½“ç„¶dataå‚æ•°å€¼ä¹Ÿå¯ä»¥è¿›è¡ŒéªŒè¯.å‚æ•° strict=True çš„å«ä¹‰:è‹¥ä¼ é€’äº†æœªå®šä¹‰çš„å‚æ•°åˆ™æŠ¥é”™.1args = parser.parse_args(strict=True)3.2.6 æ•°æ®æ ¼å¼åŒ–é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨è¿”å›žçš„å¯è¿­ä»£å¯¹è±¡ä¸­çš„æ‰€æœ‰å­—æ®µéƒ½ä¼šåŽŸæ ·è¿”å›ž,ä½†æ˜¯å½“æ¶‰åŠåˆ°å¯¹è±¡æ—¶å°†ä¼šå˜å¾—éžå¸¸æ£˜æ‰‹.Flask-RESTPlus æä¾›äº† fields æ¨¡å—å’Œmarshal_with()è£…é¥°å™¨æ¥è§£å†³è¿”å›žçš„æ˜¯å¯¹è±¡çš„é—®é¢˜.123456789101112131415161718192021222324252627from collections import OrderedDictfrom flask import Flaskfrom flask_restplus import fields, Api, Resourceapp = Flask(__name__)api = Api(app)# æ ¼å¼åŒ–è¿”å›žçš„æ˜¯å¯¹è±¡çš„å€¼.ä¹Ÿå°±æ˜¯è¯´è¿”å›žçš„æ˜¯å¯¹è±¡ä¸­çš„å¦‚ä¸‹æ ¼å¼åŒ–çš„å€¼model = api.model('Model', &#123; 'task': fields.String, 'uri': fields.Url('todo_ep',absolute=True) # absoluteè¡¨ç¤ºè¿”å›žç»å¯¹è·¯å¾„&#125;)class TodoDao(object): def __init__(self, todo_id, task): self.todo_id = todo_id self.task = task # This field will not be sent in the response self.status = 'active'@api.route('/todo',endpoint='todo_ep') # ä¸æŒ‡å®šç«¯ç‚¹é»˜è®¤æ˜¯è§†å›¾å‡½æ•°åclass Todo(Resource): @api.marshal_with(model) # è¿”å›žå¯¹è±¡æ ¼å¼åŒ–å¼•ç”¨çš„è£…é¥°å™¨ def get(self, **kwargs): return TodoDao(todo_id='my_todo', task='Remember the milk') # è¿”å›žçš„æ˜¯ä¸€ä¸ªå¯¹è±¡æ­¤åŠŸèƒ½çš„ä½œç”¨å¦‚ä¸‹:è‹¥è¿”å›žçš„æ˜¯ä¸€ä¸ªå¯¹è±¡,å¯ä»¥é€šè¯è¯¥è£…é¥°å™¨,æ ¼å¼åŒ–è¯¥å¯¹è±¡è¦è¿”å›žçš„æ•°æ®,æ•°æ®è¡¨æŸ¥è¯¢æ¯”è¾ƒå¸¸ç”¨é¡ºåºä¿ç•™é»˜è®¤æƒ…å†µä¸‹ï¼Œå­—æ®µé¡ºåºå¹¶æœªå¾—åˆ°ä¿ç•™ï¼Œå› ä¸ºå®ƒä¼šæŸè€—æ€§èƒ½ã€‚ä¸è¿‡ï¼Œå¦‚æžœä½ ç¡®å®žéœ€è¦ä¿ç•™å­—æ®µé¡ºåºï¼Œé‚£ä¹ˆå¯ä»¥å‘ç±»æˆ–å‡½æ•°ä¼ å…¥ä¸€ä¸ª ordered=True çš„å‚æ•°é¡¹ï¼Œä»¥æ­¤å¼ºåˆ¶è¿›è¡Œé¡ºåºä¿ç•™ï¼šï‚· Api å…¨å±€ä¿ç•™ï¼šapi = Api(ordered = True)ï‚· Namespace å…¨å±€ä¿ç•™ï¼šns = Namespace(ordered=True)ï‚· marshal()å±€éƒ¨ä¿ç•™ï¼šreturn marshal(data, fields, ordered=True)marshal()å±€éƒ¨ä¿ç•™çš„ä¾‹å­å¦‚ä¸‹:12345678910111213141516171819202122232425262728from collections import OrderedDictfrom flask import Flaskfrom flask_restplus import fields, Api, Resourceapp = Flask(__name__)api = Api(app)# æ ¼å¼åŒ–è¿”å›žçš„æ˜¯å¯¹è±¡çš„å€¼.ä¹Ÿå°±æ˜¯è¯´è¿”å›žçš„æ˜¯å¯¹è±¡ä¸­çš„å¦‚ä¸‹æ ¼å¼åŒ–çš„å€¼model = api.model('Model', &#123; 'task': fields.String, 'uri': fields.Url('todo_ep',absolute=True) # absoluteè¡¨ç¤ºè¿”å›žç»å¯¹è·¯å¾„&#125;)class TodoDao(object): def __init__(self, todo_id, task): self.todo_id = todo_id self.task = task # This field will not be sent in the response self.status = 'active'@api.route('/todo',endpoint='todo_ep') # ä¸æŒ‡å®šç«¯ç‚¹é»˜è®¤æ˜¯è§†å›¾å‡½æ•°åclass Todo(Resource): @api.marshal_with(model) # è¿”å›žå¯¹è±¡æ ¼å¼åŒ–å¼•ç”¨çš„è£…é¥°å™¨ def get(self, **kwargs): # return TodoDao(todo_id='my_todo', task='Remember the milk') # è¿”å›žçš„æ˜¯ä¸€ä¸ªå¯¹è±¡ return api.marshal(TodoDao(todo_id='my_todo', task='Remember the milk'), model, ordered=True)3.2.7 å®Œæ•´ä¾‹å­123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100#!/usr/bin/env python# -*- coding: utf-8 -*-from flask import Flaskfrom flask_restplus import Api, Resource, fieldsfrom werkzeug.contrib.fixers import ProxyFixapp = Flask(__name__)app.wsgi_app = ProxyFix(app.wsgi_app)api = Api(app, version='1.0', title='TodoMVC API', description='A simple TodoMVC API', )ns = api.namespace('todos', description='TODO operations')todo = api.model('Todo', &#123; 'id': fields.Integer(readOnly=True, description='The task unique identifier'), 'task': fields.String(required=True, description='The task details')&#125;)class TodoDAO(object): def __init__(self): self.counter = 0 self.todos = [] def get(self, id): for todo in self.todos: if todo['id'] == id: return todo api.abort(404, "Todo &#123;&#125; doesn't exist".format(id)) def create(self, data): todo = data todo['id'] = self.counter = self.counter + 1 self.todos.append(todo) return todo def update(self, id, data): todo = self.get(id) todo.update(data) return todo def delete(self, id): todo = self.get(id) self.todos.remove(todo)DAO = TodoDAO()DAO.create(&#123;'task': 'Build an API'&#125;)DAO.create(&#123;'task': '?????'&#125;)DAO.create(&#123;'task': 'profit!'&#125;)@ns.route('/')class TodoList(Resource): '''Shows a list of all todos, and lets you POST to add new tasks''' @ns.doc('list_todos') @ns.marshal_list_with(todo) def get(self): '''List all tasks''' return DAO.todos @ns.doc('create_todo') @ns.expect(todo) @ns.marshal_with(todo, code=201) def post(self): '''Create a new task''' return DAO.create(api.payload), 201@ns.route('/&lt;int:id&gt;')@ns.response(404, 'Todo not found')@ns.param('id', 'The task identifier')class Todo(Resource): '''Show a single todo item and lets you delete them''' @ns.doc('get_todo') @ns.marshal_with(todo) def get(self, id): '''Fetch a given resource''' return DAO.get(id) @ns.doc('delete_todo') @ns.response(204, 'Todo deleted') def delete(self, id): '''Delete a task given its identifier''' DAO.delete(id) return '', 204 @ns.expect(todo) @ns.marshal_with(todo) def put(self, id): '''Update a task given its identifier''' return DAO.update(id, api.payload)if __name__ == '__main__': app.run(port=8000,debug=True)4.å“åº”ç¼–ç»„4.1 åŸºæœ¬ä½¿ç”¨12345678910111213from flask_restplus import Resource, fieldsmodel = api.model('Model', &#123; 'name': fields.String, 'address': fields.String, 'date_updated': fields.DateTime(dt_format='rfc822'), # å¯¹è¿”å›žå“åº”çš„æ•°æ®åšè¿›ä¸€æ­¥çš„å¤„ç†&#125;)@api.route('/todo')class Todo(Resource): @api.marshal_with(model, envelope='resource') # envelopeçš„ä½œç”¨æ˜¯åšè¿”å›žå€¼å­—å…¸çš„é”® def get(self, **kwargs): return db_get_todo() # Some function that queries the dbä¸‹æ–¹ç»“æžœå¯¹ä¸Šè¿°ä»£ç ç¨ä½œä¿®æ”¹,ä¸»è¦æ˜¯ä¸ºäº†ä½“çŽ°@api.marshal_with(model, envelope=â€™resourceâ€™)ä¸­envelopeçš„ä½œç”¨12345678C:\Users\Administrator&gt;curl http://127.0.0.1:5000/todo&#123; "resource": &#123; "name": "sandu", "priority": "Normal", "status": "Read" &#125;&#125;æ³¨:@api.marshal_with()è£…é¥°å™¨çš„ä½œç”¨ç­‰ä»·äºŽå¦‚ä¸‹:1returtn api.marshal(è¢«è£…é¥°å¯¹è±¡,model,envelope='resource'),2004.2 é‡å‘½åå±žæ€§è¯¥åŠŸèƒ½ä¸»è¦ä½œç”¨æ˜¯åŒä¸€ä¸ªå˜é‡,åœ¨ä»£ç å†…éƒ¨ä½¿ç”¨ä¸€ä¸ªåŒä¸€ä¸ªå˜é‡å,æä¾›ç»™ç”¨æˆ·æ—¶æ˜¾ç¤ºçš„æ˜¯å¦ä¸€ä¸ªå˜é‡å1234model = &#123; 'name': fields.String(attribute='private_name'), 'address': fields.String,&#125;å®Œæ•´ç¤ºä¾‹å¦‚ä¸‹:1234567891011121314151617181920212223242526272829303132333435363738394041424344from flask import Flask, requestfrom flask_restplus import Api, Resource, reqparse, fieldsapp = Flask(__name__)# app.config['ERROR_404_HELP'] = Falseapi = Api(app)class TodoDao(object): def __init__(self, private_name, address,flags): self.private_name = private_name self.address = address self.flags = flags # This field will not be sent in the response self.priority = None self.status = Noneclass UrgentItem(fields.Raw): def format(self, value): return "Urgent" if value == 1 else "Normal"class UnreadItem(fields.Raw): def format(self, value): return "Unread" if value ==2 else "Read"model = &#123; 'name': fields.String(attribute='private_name'), 'priority': UrgentItem(attribute='flags'), 'status': UnreadItem(attribute='flags'), 'age':fields.Integer(default=20)&#125;@api.route('/todo')class Todo(Resource): # @api.marshal_with(model, envelope='resource') def get(self, **kwargs): return api.marshal(TodoDao(private_name='sandu', address='beijing',flags=1), model, envelope='resource') # Some function that queries the dbif __name__ == '__main__': app.run(debug=True)æ³¨æ„çœ‹ä¸Šè¿°ä»£ç çš„ç¤ºä¾‹:ä»£ç ä¸­ä½¿ç”¨çš„å˜é‡åæ˜¯private_name,è¿”å›žç»™ç”¨æˆ·çš„ç»“æžœä¸­æ˜¾ç¤ºçš„å˜é‡åæ˜¯name,å…·ä½“å¦‚ä¸‹:123456789C:\Users\Administrator&gt;curl http://127.0.0.1:5000/todo&#123; "resource": &#123; "name": "sandu", "priority": "Urgent", "status": "Read", "age": 20 &#125;&#125;ä¹Ÿå¯ä»¥æŒ‡å®šä¸º lambda è¡¨è¾¾å¼æˆ–è€…å…¶ä»–å¯è°ƒç”¨çš„è¯­å¥1234model = &#123; 'name': fields.String(attribute=lambda x: x._private_name), 'address': fields.String,&#125;è¿˜å¯ä»¥åˆ©ç”¨ attribute æ¥è®¿é—®åµŒå¥—çš„å±žæ€§1234model = &#123; 'name': fields.String(attribute='people_list.0.person_dictionary.name'), 'address': fields.String,&#125;4.3 é»˜è®¤å€¼ä¸ºå¯¹è±¡ä¸­ä¸å­˜åœ¨ä½†æ˜¯è¿”å›žå€¼å­˜åœ¨çš„æŒ‡å®šé»˜è®¤å€¼,é‡å‘½åä¾‹å­ä¸­çš„ageå°±æ˜¯,å¦‚ä¸‹æ‰€ç¤º:123456model = &#123; 'name': fields.String(attribute='private_name'), 'priority': UrgentItem(attribute='flags'), 'status': UnreadItem(attribute='flags'), 'age':fields.Integer(default=20)&#125;4.4 è‡ªå®šä¹‰å­—æ®µåŠå¤šå€¼æƒ…å†µè¯¥åŠŸèƒ½é€šä¿—ç‚¹æ¥è¯´æ˜¯æ ¹æ®å€¼å¾—ä¸åŒè¿”å›žå¯¹åº”çš„ä¸åŒçš„ç»“æžœå¦‚ä¸Šè¿°çš„éƒ¨åˆ†ä»£ç :1234567891011121314151617181920212223class UrgentItem(fields.Raw): def format(self, value): return "Urgent" if value == 1 else "Normal"class UnreadItem(fields.Raw): def format(self, value): return "Unread" if value ==2 else "Read"model = &#123; 'name': fields.String(attribute='private_name'), 'priority': UrgentItem(attribute='flags'), 'status': UnreadItem(attribute='flags'), 'age':fields.Integer(default=20)&#125;@api.route('/todo')class Todo(Resource): # @api.marshal_with(model, envelope='resource') def get(self, **kwargs): return api.marshal(TodoDao(private_name='sandu', address='beijing',flags=1), model, envelope='resource') # Some function that queries the dbå½“è¿”å›žçš„TodoDaoå¯¹è±¡ä¸­,flagsçš„å€¼ä¸åŒ,è¿”å›žçš„å‚æ•°priorityå’Œstatuså€¼ä¹Ÿä¼šæ ¹æ®ä¸Šè¿°ä¸¤ä¸ªclassçš„è¿”å›žç»“æžœè€Œä¸åŒ.å½“flags=1æ—¶,è¿”å›žçš„ç»“æžœæ˜¯:123456789C:\Users\Administrator&gt;curl http://127.0.0.1:5000/todo&#123; "resource": &#123; "name": "sandu", "priority": "Urgent", "status": "Read", "age": 20 &#125;&#125;å½“flags=2æ—¶,è¿”å›žçš„ç»“æžœæ˜¯:123456789C:\Users\Administrator&gt;curl http://127.0.0.1:5000/todo&#123; "resource": &#123; "name": "sandu", "priority": "Normal", "status": "Unread", "age": 20 &#125;&#125;4.5 URLå’Œå…¶ä»–å­—æ®µè¯¥è¿”å›žå¯¹è±¡å€¼å¢žåŠ é¢å¤–çš„å­—æ®µ123456789101112class RandomNumber(fields.Raw): def output(self,key,obj,ordered=None): return random.random()model = &#123; 'name': fields.String(attribute='private_name'), 'priority': UrgentItem(attribute='flags'), 'status': UnreadItem(attribute='flags'), 'age': fields.Integer(default=20), 'random': RandomNumber(),&#125;æ³¨æ„:ä»¥ä¸Šä»£ç ç»è¿‡ä¿®æ”¹,è·Ÿå®˜ç½‘æ–‡æ¡£ä¸ä¸€æ ·,ä¸»è¦æ˜¯output()ä¸­å¤šäº†ä¸€ä¸ªordered=None,ä¸ç„¶ä¸åŠ è¿™ä¸ªä¼šæŠ¥é”™:TypeError: output() got an unexpected keyword argument â€˜orderedâ€™å¯ä»¥æŠŠdef output(self,key,obj,ordered=None)çœ‹æˆæ˜¯ä¸€ä¸ªå›ºå®šå†™æ³•,åªä¿®æ”¹å…¶è¿”å›žå€¼å³å¯.è¿”å›žç»“æžœæ˜¯:12345678910C:\Users\Administrator&gt;curl http://127.0.0.1:5000/todo&#123; "resource": &#123; "name": "sandu", "priority": "Normal", "status": "Unread", "age": 20, "random": 0.12434240543068387 &#125;&#125;é»˜è®¤æƒ…å†µä¸‹ï¼Œfields.Url è¿”å›žçš„æ˜¯ä¸€ä¸ªç›¸å¯¹äºŽæ ¹è·¯å¾„çš„ç›¸å¯¹ URI,ä¸è¿‡ä¹Ÿå¯ä»¥è¿”å›žç»å¯¹è·¯å¾„,ä»¥åŠåœ°å€çš„schema(åè®®)ç­‰.1234model = &#123; 'uri': fields.Url('todo_resource', absolute=True) 'https_uri': fields.Url('todo_resource', absolute=True, scheme='https')&#125;4.6 å¤æ‚ç»“æž„æä¾›ä¸€ä¸ªæ‰å¹³çš„ç»“æž„ï¼Œè€Œ marshal()åˆ™ä¼šæŒ‰ç…§å®šä¹‰çš„è§„åˆ™å°†å…¶è½¬æ¢æˆä¸€ä¸ªåµŒå¥—ç»“æž„12345678910111213&gt;&gt;&gt; from flask_restplus import fields, marshal&gt;&gt;&gt; import json&gt;&gt;&gt;&gt;&gt;&gt; resource_fields = &#123;'name': fields.String&#125;&gt;&gt;&gt; resource_fields['address'] = &#123;&#125;&gt;&gt;&gt; resource_fields['address']['line 1'] = fields.String(attribute='addr1')&gt;&gt;&gt; resource_fields['address']['line 2'] = fields.String(attribute='addr2')&gt;&gt;&gt; resource_fields['address']['city'] = fields.String&gt;&gt;&gt; resource_fields['address']['state'] = fields.String&gt;&gt;&gt; resource_fields['address']['zip'] = fields.String&gt;&gt;&gt; data = &#123;'name': 'bob', 'addr1': '123 fake street', 'addr2': '', 'city': 'New York', 'state': 'NY', 'zip': '10468'&#125;&gt;&gt;&gt; json.dumps(marshal(data, resource_fields))'&#123;"name": "bob", "address": &#123;"line 1": "123 fake street", "line 2": "", "state": "NY", "zip": "10468", "city": "New York"&#125;&#125;'æ³¨æ„ï¼šä¸Šè¿°ç¤ºä¾‹ä¸­çš„ address å­—æ®µå…¶å®žå¹¶ä¸å­˜åœ¨äºŽæ•°æ®å¯¹è±¡ä¸­ï¼Œä½†æ˜¯ä»»ä½•å­å­—æ®µéƒ½èƒ½å¤Ÿç›´æŽ¥ä»Žå¯¹è±¡ä¸­è®¿é—®è¯¥å±žæ€§ï¼Œå°±åƒå®ƒä»¬å¹¶ä¸æ˜¯åµŒå¥—å…³ç³»ä¸€æ ·ã€‚4.7 åˆ—è¡¨å­—æ®µå°†å­—æ®µè§£ç»„æˆåˆ—è¡¨1234567&gt;&gt;&gt; from flask_restplus import fields, marshal&gt;&gt;&gt; import json&gt;&gt;&gt;&gt;&gt;&gt; resource_fields = &#123;'name': fields.String, 'first_names': fields.List(fields.String)&#125;&gt;&gt;&gt; data = &#123;'name': 'Bougnazal', 'first_names' : ['Emile', 'Raoul']&#125;&gt;&gt;&gt; json.dumps(marshal(data, resource_fields))&gt;&gt;&gt; '&#123;"first_names": ["Emile", "Raoul"], "name": "Bougnazal"&#125;'4.8 åµŒå¥—å­—æ®µä½¿ç”¨ Nested æ¥å°†åµŒå¥—çš„æ•°æ®ç»“æž„è§£ç»„ï¼Œå¹¶å¯¹å…¶è¿›è¡Œé€‚å½“çš„æ¸²æŸ“1234567891011121314151617181920&gt;&gt;&gt; from flask_restplus import fields, marshal&gt;&gt;&gt; import json&gt;&gt;&gt;&gt;&gt;&gt; address_fields = &#123;&#125;&gt;&gt;&gt; address_fields['line 1'] = fields.String(attribute='addr1')&gt;&gt;&gt; address_fields['line 2'] = fields.String(attribute='addr2')&gt;&gt;&gt; address_fields['city'] = fields.String(attribute='city')&gt;&gt;&gt; address_fields['state'] = fields.String(attribute='state')&gt;&gt;&gt; address_fields['zip'] = fields.String(attribute='zip')&gt;&gt;&gt;&gt;&gt;&gt; resource_fields = &#123;&#125;&gt;&gt;&gt; resource_fields['name'] = fields.String&gt;&gt;&gt; resource_fields['billing_address'] = fields.Nested(address_fields)&gt;&gt;&gt; resource_fields['shipping_address'] = fields.Nested(address_fields)&gt;&gt;&gt; address1 = &#123;'addr1': '123 fake street', 'city': 'New York', 'state': 'NY', 'zip': '10468'&#125;&gt;&gt;&gt; address2 = &#123;'addr1': '555 nowhere', 'city': 'New York', 'state': 'NY', 'zip': '10468'&#125;&gt;&gt;&gt; data = &#123;'name': 'bob', 'billing_address': address1, 'shipping_address': address2&#125;&gt;&gt;&gt;&gt;&gt;&gt; json.dumps(marshal(data, resource_fields))'&#123;"billing_address": &#123;"line 1": "123 fake street", "line 2": null, "state": "NY", "zip": "10468", "city": "New York"&#125;, "name": "bob", "shipping_address": &#123;"line 1": "555 nowhere", "line 2": null, "state": "NY", "zip": "10468", "city": "New York"&#125;&#125;'è¯¥ç¤ºä¾‹ä½¿ç”¨ä¸¤ä¸ª Nested å­—æ®µã€‚Nested æž„é€ å‡½æ•°æŽ¥å—ä¸€ä¸ªå­—æ®µç»„æˆçš„å­—å…¸ï¼Œç„¶åŽå°†å…¶æ¸²æŸ“æˆä¸€ä¸ªå­ fields.input å¯¹è±¡ã€‚Nested æž„é€ å‡½æ•°å’ŒåµŒå¥—å­—å…¸ï¼ˆä¸Šä¸ªä¾‹å­ï¼‰ä¹‹é—´çš„é‡è¦ä¸åŒç‚¹æ˜¯ï¼šå±žæ€§çš„ä¸Šä¸‹æ–‡çŽ¯å¢ƒã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œbilling_addressæ˜¯ä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ï¼Œå®ƒæ‹¥æœ‰è‡ªå·±çš„å­—æ®µï¼Œè€Œä¼ å…¥åˆ°åµŒå¥—å­—æ®µä¸­çš„ä¸Šä¸‹æ–‡çŽ¯å¢ƒæ˜¯å­å¯¹è±¡ï¼Œè€Œä¸æ˜¯åŽŸå§‹çš„ data å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼šdata.billing_address.addr1å¤„äºŽè¯¥èŒƒå›´ï¼Œè€Œåœ¨å‰ä¸€ç¤ºä¾‹ä¸­ï¼Œdata.addr1 åˆ™æ˜¯ä½ç½®å±žæ€§ã€‚è®°ä½ï¼šNested å’ŒList å¯¹è±¡ä¸ºå±žæ€§åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ä½œç”¨èŒƒå›´ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“å­å¯¹è±¡ä¸º None æ—¶ï¼Œå°†ä¼šä¸ºåµŒå¥—å­—æ®µç”Ÿæˆä¸€ä¸ªåŒ…å«é»˜è®¤å€¼çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯ null å€¼ã€‚å¯ä»¥é€šè¿‡ä¼ å…¥ allow_null å‚æ•°æ¥ä¿®æ”¹è¿™ä¸€ç‚¹ä½¿ç”¨ Nested å’Œ List æ¥ç¼–ç»„æ›´å¤æ‚å¯¹è±¡çš„åˆ—è¡¨12345678user_fields = api.model('User', &#123; 'id': fields.Integer, 'name': fields.String,&#125;)user_list_fields = api.model('UserList', &#123; 'users': fields.List(fields.Nested(user_fields)),&#125;)4.9 api.model()å·¥åŽ‚model()å·¥åŽ‚å…è®¸æˆ‘ä»¬å®žä¾‹åŒ–å¹¶æ³¨å†Œæ¨¡åž‹åˆ°æˆ‘ä»¬çš„ API å’Œå‘½åç©ºé—´ï¼ˆNamespaceï¼‰ä¸­12345678910111213my_fields = api.model('MyModel', &#123; 'name': fields.String, 'age': fields.Integer(min=0)&#125;)# Equivalent tofrom flask_restplus import Modelmy_fields = Model('MyModel', &#123; 'name': fields.String, 'age': fields.Integer(min=0)&#125;)api.models[my_fields.name] = my_fields4.9.1 cloneå®žçŽ°å¤åˆ¶Model.clone()æ–¹æ³•ä½¿å¾—æˆ‘ä»¬å¯ä»¥å®žä¾‹åŒ–ä¸€ä¸ªå¢žå¼ºæ¨¡åž‹ï¼Œå®ƒèƒ½å¤ŸçœåŽ»æˆ‘ä»¬å¤åˆ¶æ‰€æœ‰å­—æ®µçš„éº»çƒ¦è·Ÿpythonçš„ç±»ç»§æ‰¿æœ‰ç‚¹ç±»ä¼¼ï¼Œæ³¨æ„ä»¥ä¸‹ä¸¤ç§ä¸åŒæ–¹å¼çš„å†™æ³•ã€‚å¦‚ä¸‹é¢çš„ä¾‹å­,childé™¤äº†æœ‰å…¶è‡ªèº«çš„ageä¹‹å¤–,è¿˜æœ‰å…‹éš†parentè¿‡æ¥çš„name1234567parent = Model('Parent', &#123; 'name': fields.String&#125;)child = parent.clone('Child', &#123; 'age': fields.Integer&#125;)ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132333435#!/usr/bin/env python# -*- coding: utf-8 -*-from flask import Flaskfrom flask_restplus import Resource, Api, fields,Modelapp = Flask(__name__)api = Api(app)parent = Model('Parent', &#123; 'name': fields.String&#125;)child = parent.clone('Child', &#123; 'age': fields.Integer&#125;)api.models[parent.name] = parentapi.models[child.name] = childclass Todo(object): def __init__(self, name, age): self.name = name self.age = age@api.route('/hello')class HelloWorld(Resource): @api.marshal_with(child) def get(self): # return Model(Todo('haha', 24),child) return Todo('haha', 24)if __name__ == '__main__': app.run(debug=True)ç»“æžœå¦‚ä¸‹ï¼š12345C:\Users\sandu&gt;curl http://127.0.0.1:5000/hello&#123; "name": "haha", "age": 24&#125;Api/Namespace.clone ä¹Ÿä¼šå°†å…¶æ³¨å†Œåˆ° API1234567parent = api.model('Parent', &#123; 'name': fields.String&#125;)child = api.clone('Child', parent, &#123; 'age': fields.Integer&#125;)ç¤ºä¾‹ä»£ç ï¼š1234567891011121314151617181920212223242526272829#!/usr/bin/env python# -*- coding: utf-8 -*-from flask import Flaskfrom flask_restplus import Resource, Api, fields,Modelapp = Flask(__name__)api = Api(app)parent = api.model('Parent', &#123; 'name': fields.String&#125;)child = api.clone('Child', parent,&#123; 'age': fields.Integer&#125;)class Todo(object): def __init__(self, name, age): self.name = name self.age = age@api.route('/hello')class HelloWorld(Resource): @api.marshal_with(child) def get(self): # return Model(Todo('haha', 24),child) return Todo('haha', 24)ç»“æžœå¦‚ä¸‹ï¼š12345C:\Users\sandu&gt;curl http://127.0.0.1:5000/hello&#123; "name": "haha", "age": 24&#125;4.9.2 api.inherit å®žçŽ°å¤šæ€Model.inherit()æ–¹æ³•å…è®¸æˆ‘ä»¬ä»¥â€œSwaggerâ€æ–¹å¼æ‰©å±•æ¨¡åž‹ï¼Œå¹¶å¼€å§‹è§£å†³å¤šæ€é—®é¢˜12345678parent = api.model('Parent', &#123; 'name': fields.String, 'class': fields.String(discriminator=True)&#125;)child = api.inherit('Child', parent, &#123; 'extra': fields.String&#125;)ç¤ºä¾‹ä»£ç ï¼š123456789101112131415161718192021222324252627282930from flask import Flaskfrom flask_restplus import Resource, Api, fields,Modelapp = Flask(__name__)api = Api(app)parent = api.model('Parent', &#123; 'name': fields.String, 'class': fields.String(discriminator=True) # æ ¹æ®è¿è¡Œç»“æžœè¯†åˆ«å…¶ä½œç”¨&#125;)child = api.inherit('Child', parent,&#123; 'extra': fields.String&#125;)class Todo(object): def __init__(self, name, age): self.name = name self.age = age@api.route('/hello')class HelloWorld(Resource): @api.marshal_with(child) def get(self): # return Model(Todo('haha', 24),child) return Todo('haha', 24)if __name__ == '__main__': app.run(debug=True)è¿è¡Œç»“æžœï¼š123456C:\Users\sandu&gt;curl http://127.0.0.1:5000/hello&#123; "extra": null, "name": "haha", "class": "Child"&#125;ä½¿ç”¨æµè§ˆå™¨è®¿é—®(http://127.0.0.1:5000/)çš„è¯ä¼šçœ‹åˆ°Modelsä¸­æœ‰ä¸¤ä¸ªApi/Namespace.clone ä¼šå°† parent å’Œ child éƒ½æ³¨å†Œåˆ° Swagger æ¨¡åž‹å®šä¹‰ä¸­12345678parent = Model('Parent', &#123; 'name': fields.String, 'class': fields.String(discriminator=True)&#125;)child = parent.inherit('Child', &#123; 'extra': fields.String&#125;)ç¤ºä¾‹ä»£ç ï¼š123456789101112131415161718192021222324252627282930313233from flask import Flaskfrom flask_restplus import Resource, Api, fields,Modelapp = Flask(__name__)api = Api(app)parent = Model('Parent', &#123; 'name': fields.String, 'class': fields.String() # æ­¤æ—¶æ²¡æœ‰discriminator=Trueï¼Œæ³¨æ„è¿è¡Œç»“æžœ&#125;)child = parent.inherit('Child', &#123; 'extra': fields.String&#125;)api.models[parent.name] = parentapi.models[child.name] = childclass Todo(object): def __init__(self, name, age): self.name = name self.age = age@api.route('/hello')class HelloWorld(Resource): @api.marshal_with(child) def get(self): # return Model(Todo('haha', 24),child) return Todo('haha', 24)if __name__ == '__main__': app.run(debug=True)è¿è¡Œç»“æžœï¼š123456C:\Users\sandu&gt;curl http://127.0.0.1:5000/hello&#123; "extra": null, "name": "haha", "class": null&#125;æœ¬ä¾‹ä¸­çš„classå­—æ®µåªæœ‰åœ¨å…¶ä¸å­˜åœ¨äºŽåºåˆ—åŒ–å¯¹è±¡ä¸­æ—¶ï¼Œæ‰ä¼šä»¥åºåˆ—åŒ–çš„æ¨¡åž‹åç§°è¿›è¡Œå¡«å……ã€‚Polymorphå­—æ®µå…è®¸ä½ æŒ‡å®šPythonç±»å’Œå­—æ®µè§„èŒƒçš„æ˜ å°„å…³ç³»ï¼š12345678mapping = &#123; Child1: child1_fields, Child2: child2_fields,&#125;fields = api.model('Thing', &#123; owner: fields.Polymorph(mapping)&#125;)æ³¨ï¼šè¿™æ®µè¿˜æœªçœ‹æ˜Žç™½å•¥æ„æ€ï¼Œå…·ä½“å’‹æ“ä½œçš„ï¼Œç»“æžœå¦‚ä½•ï¼Œç•™å¾…ä»¥åŽç ”ç©¶ã€‚4.10 è‡ªå®šä¹‰å­—æ®µè‡ªå®šä¹‰è¾“å‡ºå­—æ®µä½¿å¾—æˆ‘ä»¬å¯ä»¥åœ¨æ— éœ€ç›´æŽ¥ä¿®æ”¹å†…éƒ¨å¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œè¿›è¡Œè‡ªå®šä¹‰çš„è¾“å‡ºç»“æžœæ ¼å¼åŒ–æ“ä½œã€‚æˆ‘ä»¬åªéœ€è®©ç±»ç»§æ‰¿Rawï¼Œå¹¶å®žçŽ°format()æ–¹æ³•ï¼š123456789class AllCapsString(fields.Raw): def format(self, value): return value.upper()# example usagefields = &#123; 'name': fields.String, 'all_caps_name': AllCapsString(attribute='name'),&#125;ç¤ºä¾‹ä»£ç ï¼š123456789101112131415161718192021222324252627282930from flask import Flaskfrom flask_restplus import Resource, Api, fields,Modelapp = Flask(__name__)api = Api(app)class AllCapsString(fields.Raw): def format(self, value): return value.upper()fields = &#123; 'name': fields.String, 'all_caps_name': AllCapsString(attribute='age'), # å…¶å€¼æ˜¯æ ¹æ®attributeæŒ‡å®šçš„è€Œå®šï¼Œä¸å¦‚attribute='age'ï¼Œåˆ™è¾“å‡ºçš„ç»“æžœæ˜¯â€˜24â€™ï¼Œè‹¥æ˜¯attribute='name'ï¼Œåˆ™è¾“å‡ºç»“æžœæ˜¯â€œHAHAâ€,å…·ä½“è¯¦çœ‹ä¸‹æ–¹çš„è¿è¡Œç»“æžœ&#125;class Todo(object): def __init__(self, name, age): self.name = name self.age = age@api.route('/hello')class HelloWorld(Resource): @api.marshal_with(fields) def get(self): # return Model(Todo('haha', 24),child) return Todo('haha', '24')if __name__ == '__main__': app.run(debug=True)è¿è¡Œç»“æžœå¦‚ä¸‹:1234567891011C:\Users\sandu&gt;curl http://127.0.0.1:5000/hello&#123; "name": "haha", "all_caps_name": "24"&#125;C:\Users\sandu&gt;curl http://127.0.0.1:5000/hello&#123; "name": "haha", "all_caps_name": "HAHA"&#125;ä¹Ÿå¯ä»¥ä½¿ç”¨schema_formatã€schema_typeå’Œschema_exampleæ¥æŒ‡å®šç”Ÿæˆçš„ç±»åž‹å’Œä¾‹å­ï¼š123456789class MyIntField(fields.Integer): __schema_format__ = 'int64'class MySpecialField(fields.Raw): __schema_type__ = 'some-type' __schema_format__ = 'some-format'class MyVerySpecialField(fields.Raw): __schema_example__ = 'hello, world'å®žé™…ä»£ç ï¼š12345678910111213141516171819202122232425262728293031323334353637383940from flask import Flaskfrom flask_restplus import Resource, Api, fields,Modelapp = Flask(__name__)api = Api(app)class AllCapsString(fields.Raw): def format(self, value): return value.upper()class MyIntField(fields.Integer): __schema_format__ = 'int64'class MySpecialField(fields.Raw): # å…·ä½“ä½œç”¨è¿˜æœ‰å¾…ç ”ç©¶ __schema_type__ = 'string' __schema_format__ = 'string' __schema_example__ = 'hello, world'fields = &#123; 'name': fields.String, 'all_caps_name': AllCapsString(attribute='name'), 'age':MyIntField(), # æœ‰è½¬æ¢æ•°æ®ç±»åž‹çš„åŠŸèƒ½ï¼Œè¾“å…¥çš„æ˜¯å­—ç¬¦ä¸²'22',è¿è¡Œç»“æžœæ˜¾ç¤ºçš„æ˜¯æ•°å­—22 'class':MySpecialField(attribute='banji')&#125;class Todo(object): def __init__(self, name, age, banji): self.name = name self.age = age self.banji = banji@api.route('/hello')class HelloWorld(Resource): @api.marshal_with(fields) def get(self): # return Model(Todo('haha', 24),child) return Todo('haha','22','erjini')if __name__ == '__main__': app.run(debug=True)4.11 è·³è¿‡å€¼ä¸ºNoneçš„å­—æ®µå°†å¯é€‰å‚æ•°skip_noneè®¾ç½®ä¸ºTrue12345678910111213&gt;&gt;&gt; from flask_restplus import Model, fields, marshal_with&gt;&gt;&gt; import json&gt;&gt;&gt; model = Model('Model', &#123;... 'name': fields.String,... 'address_1': fields.String,... 'address_2': fields.String... &#125;)&gt;&gt;&gt; @marshal_with(model, skip_none=True)... def get():... return &#123;'name': 'John', 'address_1': None&#125;...&gt;&gt;&gt; get()OrderedDict([('name', 'John')])å¯ä»¥çœ‹åˆ°ï¼Œaddress_1å’Œaddress_2è¢«marshal_with()è·³è¿‡äº†ã€‚address_1è¢«è·³è¿‡æ˜¯å› ä¸ºå®ƒçš„å€¼ä¸ºNoneï¼Œè€Œaddress_2è¢«è·³è¿‡æ˜¯å› ä¸ºget()è¿”å›žçš„å­—å…¸ä¸­å¹¶ä¸åŒ…å«address_2è¿™ä¸ªkeyã€‚4.12è·³è¿‡åµŒå¥—å­—æ®µä¸­çš„Noneå­—æ®µ123456&gt;&gt;&gt; from flask_restplus import Model, fields, marshal_with&gt;&gt;&gt; import json&gt;&gt;&gt; model = Model('Model', &#123;... 'name': fields.String,... 'location': fields.Nested(location_model, skip_none=True)... &#125;)4.13 ä½¿ç”¨JSON Schemaå®šä¹‰æ¨¡åž‹æ³¨ï¼šè¿™ä¸ªè¿˜ä¸çŸ¥é“å…·ä½“å’‹ä½¿ç”¨çš„12345678910111213141516171819202122232425262728address = api.schema_model('Address', &#123; 'properties': &#123; 'road': &#123; 'type': 'string' &#125;, &#125;, 'type': 'object'&#125;)person = address = api.schema_model('Person', &#123; 'required': ['address'], 'properties': &#123; 'name': &#123; 'type': 'string' &#125;, 'age': &#123; 'type': 'integer' &#125;, 'birthdate': &#123; 'type': 'string', 'format': 'date-time' &#125;, 'address': &#123; '$ref': '#/definitions/Address', &#125; &#125;, 'type': 'object'&#125;)5.è¯·æ±‚è§£æžFlask-RESTPlusçš„è¯·æ±‚è§£æžæŽ¥å£reqparseæ˜¯æ¨¡ä»¿argparseæŽ¥å£å®žçŽ°çš„ã€‚å®ƒçš„è®¾è®¡ç›®çš„æ˜¯å¯¹Flaskä¸­flask.requestå¯¹è±¡ä¸Šçš„ä»»ä½•å˜é‡æä¾›ç®€å•å’Œç»Ÿä¸€çš„è®¿é—®æ–¹å¼ã€‚5.1 åŸºæœ¬å‚æ•°å¦‚ä¸‹æ˜¯ä¸€ä¸ªç®€å•ç¤ºä¾‹ï¼Œåœ¨flask.Request.valueså­—å…¸ä¸­æŸ¥æ‰¾ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªæ•´æ•°å’Œä¸€ä¸ªå­—ç¬¦ä¸²ï¼š1234567from flask_restplus import reqparseparser = reqparse.RequestParser()parser.add_argument('rate', type=int, help='Rate cannot be converted')parser.add_argument('name')args = parser.parse_args()é»˜è®¤å‚æ•°ç±»åž‹æ˜¯unicodeå­—ç¬¦ä¸²ã€‚åœ¨Python3ä¸­ä¸ºstrç±»åž‹ï¼Œè€Œåœ¨Python2ä¸­ä¸ºunicodeã€‚å¦‚æžœæŒ‡å®šäº†helpå˜é‡çš„å€¼ï¼Œé‚£ä¹ˆåœ¨è§£æžè¯·æ±‚æ—¶ï¼Œå¦‚æžœå‡ºçŽ°äº†ç±»åž‹é”™è¯¯ï¼Œé‚£ä¹ˆä¼šå°†å®ƒæ¸²æŸ“ä¸ºé”™è¯¯ä¿¡æ¯ã€‚å¦‚æžœæœªæŒ‡å®šhelpä¿¡æ¯ï¼Œé‚£ä¹ˆé»˜è®¤çš„è¡Œä¸ºæ˜¯è¿”å›žç±»åž‹é”™è¯¯ä¿¡æ¯æœ¬èº«ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå‚æ•°ä¸æ˜¯å¿…éœ€çš„ã€‚å¹¶ä¸”ï¼Œå¦‚æžœè¯·æ±‚ä¸­æä¾›çš„æŸäº›å‚æ•°ä¸æ˜¯RequestParserçš„éƒ¨åˆ†å†…å®¹ï¼Œé‚£ä¹ˆè¿™äº›å‚æ•°å°†ä¼šè¢«å¿½ç•¥ã€‚è¯·æ±‚è§£æžå™¨ä¸­å£°æ˜Žçš„å‚æ•°ï¼Œå¦‚æžœåœ¨è¯·æ±‚ä¸­å¹¶æœªè®¾ç½®è¿™äº›å‚æ•°å€¼ï¼Œé‚£ä¹ˆå®ƒä»¬å°†ä¼šé»˜è®¤è®¾ç½®ä¸ºNoneã€‚5.2 å¿…é¡»å‚æ•°å¦‚æžœéœ€è¦ç¡®ä¿æŸä¸ªå‚æ•°å¿…é¡»æä¾›ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨è°ƒç”¨add_argument()æ—¶ä¼ å…¥required=Trueçš„å‚æ•°é¡¹ï¼š1parser.add_argument('name', required=True, help="Name cannot be blank!")å¦‚æžœè¯·æ±‚ä¸­æœªæä¾›è¯¥å‚æ•°ï¼Œé‚£ä¹ˆå°†ä¼šè¿”å›žé”™è¯¯ä¿¡æ¯5.3 å¤šå€¼å’Œåˆ—è¡¨ä¸ºæŸä¸ªkeyæŽ¥å—å¤šä¸ªå€¼ä»¥æž„æˆåˆ—è¡¨ï¼Œé‚£ä¹ˆå¯ä»¥ä¼ å…¥action=â€™appendâ€™ï¼š1parser.add_argument('name', action='append')æ­¤æ—¶çš„æŸ¥è¯¢æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š1curl http://api.example.com -d "name=bob" -d "name=sue" -d "name=joe"è€Œç¨‹åºä¸­èŽ·å–åˆ°çš„å‚æ•°å¦‚ä¸‹æ‰€ç¤ºï¼š12args = parser.parse_args()args['name'] # ['bob', 'sue', 'joe']å¦‚æžœæœŸæœ›ä¸€ä¸ªé€—å·åˆ†éš”çš„åˆ—è¡¨ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨action=â€™splitâ€™ï¼š1parser.add_argument('fruits', action='split')æ­¤æ—¶çš„æŸ¥è¯¢æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š1curl http://api.example.com -d "fruits=apple,lemon,cherry"è€Œç¨‹åºä¸­èŽ·å–åˆ°çš„å‚æ•°å¦‚ä¸‹æ‰€ç¤ºï¼š12args = parser.parse_args()args['fruits'] # ['apple', 'lemon', 'cherry']5.4 å…¶ä»–ç›®æ ‡å¦‚æžœæœŸæœ›å‚æ•°ä¸€æ—¦è¢«è§£æžï¼Œå°±å°†å…¶å­˜å‚¨ä¸ºå…¶ä»–åå­—ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨destå‚æ•°ï¼š1234parser.add_argument('name', dest='public_name')args = parser.parse_args()args['public_name']5.5 å‚æ•°ä½ç½®é»˜è®¤æƒ…å†µä¸‹ï¼ŒRequestParserå°è¯•ä»Žflask.Request.valueså’Œflask.Request.jsonä¸­è§£æžå€¼ã€‚åœ¨add_argument()ä¸­ä½¿ç”¨locationå‚æ•°æ¥æŒ‡å®šèŽ·å–å€¼çš„å…¶ä»–ä½ç½®ã€‚å¯ä»¥ä½¿ç”¨flask.Requestä¸Šçš„ä»»ä½•å˜é‡ï¼Œä¾‹å¦‚ï¼š1234567891011121314# ä»…ä»…åœ¨POST bodyä¸­æŸ¥æ‰¾parser.add_argument('name', type=int, location='form')# ä»…ä»…åœ¨querystringä¸­æŸ¥æ‰¾parser.add_argument('PageSize', type=int, location='args')# ä»Žè¯·æ±‚å¤´ä¸­æŸ¥æ‰¾parser.add_argument('User-Agent', location='headers')# ä»Žhttp cookiesä¸­æŸ¥æ‰¾parser.add_argument('session_id', location='cookies')# ä»Žä¸Šä¼ æ–‡ä»¶ä¸­æŸ¥æ‰¾parser.add_argument('picture', type=werkzeug.datastructures.FileStorage, location='files')å½“location=â€™jsonâ€™æ—¶åªèƒ½ä½¿ç”¨type=listä½¿ç”¨location=â€™formâ€™æ—¢èƒ½éªŒè¯è¡¨å•æ•°æ®ï¼Œåˆèƒ½ä¸ºè¡¨å•å­—æ®µæ–‡æ¡£åŒ–5.6 å‚æ•°å¤šä½ç½®ä¸ºlocationå‚æ•°èµ‹ä¸€ä¸ªåˆ—è¡¨å°±èƒ½ä¸ºå‚æ•°æŒ‡å®šå¤šä¸ªä½ç½®ï¼š1parser.add_argument('text', location=['headers', 'values'])å½“æŒ‡å®šå¤šä¸ªå‚æ•°ä½ç½®æ—¶ï¼Œé‚£ä¹ˆæ‰€æœ‰æŒ‡å®šä½ç½®çš„å‚æ•°å°†ä¼šç»„æˆä¸€ä¸ªMultiDictã€‚å…¶ä¸­ï¼Œåˆ—è¡¨ä¸­æœ€åŽä½ç½®å¤„çš„å‚æ•°å°†ä¼šä¼˜å…ˆå­˜å‚¨åœ¨ç»“æžœé›†ä¸­ã€‚å¦‚æžœå‚æ•°ä½ç½®åˆ—è¡¨ä¸­åŒ…å«headersä½ç½®ï¼Œé‚£ä¹ˆå‚æ•°åå°†å˜æˆå¯¹å¤§å°å†™æ•æ„Ÿï¼Œå¹¶ä¸”å¿…é¡»åŒ¹é…å®ƒä»¬çš„æ ‡é¢˜å¤§å°å†™åç§°ï¼ˆè§str.title()ï¼‰ã€‚æŒ‡å®šlocation=â€™headersâ€™ï¼ˆè€Œä¸æ˜¯ä½œä¸ºåˆ—è¡¨çš„æŸä¸ªå…ƒç´ ï¼‰å°†ä¿ç•™å¤§å°å†™ä¸æ•æ„Ÿçš„ç‰¹æ€§ã€‚5.7 é«˜çº§ç±»åž‹å¤„ç†inputsæ¨¡å—ä¸­æä¾›äº†ä¸€äº›å¸¸ç”¨çš„ç±»åž‹å¤„ç†æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š- boolean()ç”¨äºŽå¹¿æ³›çš„å¸ƒå°”å€¼å¤„ç† - ipv4()å’Œipv6()ç”¨äºŽIPåœ°å€ - date_from_iso8601()å’Œdatetime_from_iso8601()ç”¨äºŽISO8601 dateå’Œdatetimeå¤„ç† åªéœ€è¦ä½¿ç”¨å®ƒä»¬ä½œä¸ºtypeå‚æ•°çš„å€¼å³å¯ï¼š1parser.add_argument('flag', type=inputs.boolean)æˆ‘ä»¬ä¹Ÿå¯ä»¥ç¼–å†™è‡ªå·±çš„è¾“å…¥ç±»åž‹ï¼š12345678def my_type(value): '''Parse my type''' if not condition: raise ValueError('This is not my type') return parse(value)# Swagger documntationmy_type.__schema__ = &#123;'type': 'string', 'format': 'my-custom-format'&#125;5.8 è§£æžå™¨ç»§æ‰¿å¯ä»¥ç¼–å†™ä¸€ä¸ªçˆ¶è§£æžå™¨ï¼Œçˆ¶è§£æžå™¨ä¸­åŒ…å«æ‰€æœ‰å…±åŒçš„å‚æ•°ï¼Œç„¶åŽåˆ©ç”¨copy()æ–¹æ³•æ¥æ‰©å±•è§£æžå™¨ã€‚å¦å¤–ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨replace_argument()æ¥è¦†å†™çˆ¶è§£æžå™¨ä¸­çš„ä»»ä½•å‚æ•°ï¼Œæˆ–è€…åˆ©ç”¨remove_argument()å®Œå…¨ç§»é™¤çˆ¶è§£æžå™¨ä¸­çš„æŸä¸ªå‚æ•°ã€‚ä¾‹å¦‚ï¼š12345678910111213141516from flask_restplus import reqparseparser = reqparse.RequestParser()parser.add_argument('foo', type=int)parser_copy = parser.copy()parser_copy.add_argument('bar', type=int)# parser_copy has both 'foo' and 'bar'parser_copy.replace_argument('foo', required=True, location='json')# 'foo' is now a required str located in json, not an int as defined# by original parserparser_copy.remove_argument('foo')# parser_copy no longer has 'foo' argument5.9 æ–‡ä»¶ä¸Šä¼ ä¸ºäº†åˆ©ç”¨RequestParserå¤„ç†æ–‡ä»¶ä¸Šä¼ é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å°†locationå˜é‡å€¼è®¾ç½®ä¸ºfilesï¼Œå¹¶è®¾ç½®typeå€¼ä¸ºFileStorageã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š123456789101112131415161718from werkzeug.datastructures import FileStorageimport tempfileupload_parser = api.parser()upload_parser.add_argument('file', location='files', type=FileStorage, required=True)@api.route('/upload/')@api.expect(upload_parser)class Upload(Resource): def post(self): args = upload_parser.parse_args() file_ = args['file'] file_descriptor, filename = tempfile.mkstemp(suffix='.xlsx') file_.save(filename) # ä¿å­˜æ–‡ä»¶ # print(filename) # èŽ·å–æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ return 'success'5.10 é”™è¯¯å¤„ç†RequestParserå¤„ç†é”™è¯¯çš„é»˜è®¤æ–¹å¼æ˜¯åœ¨ç¬¬ä¸€ä¸ªé”™è¯¯äº§ç”Ÿæ—¶ä¸­æ–­ã€‚å½“æˆ‘ä»¬æ‹¥æœ‰éœ€è¦èŠ±è´¹ä¸€å®šæ—¶é—´æ¥å¤„ç†çš„å‚æ•°æ—¶ï¼Œè¿™ç§æ–¹å¼æ˜¯æœ‰å¥½å¤„çš„ã€‚ç„¶è€Œï¼Œé€šå¸¸æ¥è¯´ï¼Œå°†æ‰€æœ‰äº§ç”Ÿçš„é”™è¯¯éƒ½ç»‘å®šåœ¨ä¸€èµ·ï¼Œç„¶åŽåŒæ—¶ä¸€æ¬¡æ€§è¿”å›žç»™å®¢æˆ·ç«¯ï¼Œè¿™ç§æ–¹å¼åˆ™æ›´åŠ å‹å¥½ã€‚è¿™ç§æ–¹å¼æ—¢å¯ä»¥åœ¨Flaskåº”ç”¨çº§åˆ«æŒ‡å®šï¼Œä¹Ÿå¯ä»¥åœ¨ç‰¹å®šçš„RequestParserå®žä¾‹çº§åˆ«æŒ‡å®šã€‚ä¸ºäº†è°ƒç”¨ä¸€ä¸ªåŒ…å«é”™è¯¯ç»‘å®šé€‰é¡¹çš„RequestParserï¼Œéœ€è¦ä¼ å…¥å‚æ•°bundle_errorsã€‚ä¾‹å¦‚ï¼š123456789101112131415161718192021222324from flask_restplus import reqparseparser = reqparse.RequestParser(bundle_errors=True)parser.add_argument('foo', type=int, required=True)parser.add_argument('bar', type=int, required=True)# # å¦‚æžœæŸä¸ªè¯·æ±‚ä¸­åŒæ—¶ä¸åŒ…å«'foo'å’Œ'bar'ï¼Œé‚£ä¹ˆè¿”å›žçš„é”™è¯¯å°†çœ‹èµ·æ¥å¦‚ä¸‹æ‰€ç¤ºï¼š&#123; "message": &#123; "foo": "foo error message", "bar": "bar error message" &#125;&#125;# é»˜è®¤æ“ä½œå°†ä»…ä»…è¿”å›žç¬¬ä¸€ä¸ªé”™è¯¯parser = RequestParser()parser.add_argument('foo', type=int, required=True)parser.add_argument('bar', type=int, required=True)&#123; "message": &#123; "foo": "foo error message" &#125;&#125;ç¤ºä¾‹ä»£ç ï¼š12345678910111213141516171819202122from flask import Flaskfrom flask_restplus import Resource, Api, reqparseapp = Flask(__name__)api = Api(app)parser = reqparse.RequestParser(bundle_errors=True)parser.add_argument('foo', type=int, required=True)parser.add_argument('bar', type=int, required=True)@api.route('/hello')class HelloWorld(Resource): def get(self): return '111' def put(self): args = parser.parse_args() print(args) return '222'if __name__ == '__main__': app.run(debug=True)123456789101112131415161718192021# è®¾ç½®bundle_errors=Trueçš„æƒ…å†µC:\Users\sandu&gt;curl http://127.0.0.1:5000/hello -X PUT&#123; "errors": &#123; "foo": "Missing required parameter in the JSON body or the post body orthe query string", "bar": "Missing required parameter in the JSON body or the post body orthe query string" &#125;, "message": "Input payload validation failed"&#125;# æœªè®¾ç½®bundle_errors=Trueçš„æƒ…å†µC:\Users\sandu&gt;curl http://127.0.0.1:5000/hello -X PUT&#123; "errors": &#123; "foo": "Missing required parameter in the JSON body or the post body orthe query string" &#125;, "message": "Input payload validation failed"&#125;åº”ç”¨çº§åˆ«çš„é…ç½®keyä¸ºâ€œBUNDLE_ERRORSâ€ã€‚ä¾‹å¦‚ï¼š1234from flask import Flaskapp = Flask(__name__)app.config['BUNDLE_ERRORS'] = TrueBUNDLE_ERRORSæ˜¯ä¸€ä¸ªå…¨å±€è®¾ç½®ï¼Œå®ƒå°†è¦†ç›–æ¯ä¸ªRequestParserå®žä¾‹ä¸­çš„bundle_errorsé€‰é¡¹å€¼4.11 é”™è¯¯æ¶ˆæ¯æ¯ä¸ªå­—æ®µçš„é”™è¯¯æ¶ˆæ¯éƒ½å¯ä»¥é€šè¿‡åœ¨Argumentï¼ˆä¹ŸåŒ…æ‹¬RequestParser.add_argumentï¼‰ä¸­ä½¿ç”¨helpå‚æ•°æ¥è‡ªå®šä¹‰ã€‚å¦‚æžœæ²¡æœ‰æä¾›helpå‚æ•°ï¼Œé‚£ä¹ˆè¯¥å­—æ®µçš„é”™è¯¯æ¶ˆæ¯å°†ä¼šæ˜¯ç±»åž‹é”™è¯¯æœ¬èº«çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚å¦‚æžœæä¾›äº†helpå‚æ•°ï¼Œé‚£ä¹ˆé”™è¯¯æ¶ˆæ¯å°†ä¼šæ˜¯helpå‚æ•°çš„å€¼ã€‚helpå¯èƒ½åŒ…å«ä¸€ä¸ªæ’å…¥çš„ç¬¦å·{error_msg}ï¼Œå®ƒå°†ä¼šæ›¿æ¢æˆç±»åž‹é”™è¯¯çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚è¿™ç§æ–¹å¼èƒ½å¤Ÿå®žçŽ°è‡ªå®šä¹‰é”™è¯¯æ¶ˆæ¯ï¼ŒåŒæ—¶ä¿ç•™åŽŸå§‹çš„é”™è¯¯æ¶ˆæ¯ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š123456789101112131415from flask_restplus import reqparseparser = reqparse.RequestParser()parser.add_argument( 'foo', choices=('one', 'two'), help='Bad choice: &#123;error_msg&#125;')# å¦‚æžœè¯·æ±‚ä¸­çš„'foo'å‚æ•°å€¼ä¸º'three'ï¼Œé‚£ä¹ˆé”™è¯¯ä¿¡æ¯å°†ä¼šå¦‚ä¸‹æ‰€ç¤ºï¼š&#123; "message": &#123; "foo": "Bad choice: three is not a valid choice", &#125;&#125;å®žé™…ä»£ç ï¼š12345678910111213141516171819202122from flask import Flaskfrom flask_restplus import Resource, Api, reqparseapp = Flask(__name__)api = Api(app)# choiceså‚æ•°è¡¨ç¤ºå˜é‡çš„å€¼æ˜¯ä»Žè¿™ä¸­é—´çš„å€¼parser = reqparse.RequestParser()parser.add_argument('foo', choices=('one', 'two'), help='Bad choice: &#123;error_msg&#125;',required=True)@api.route('/hello')class HelloWorld(Resource): def get(self): return '111' def put(self): args = parser.parse_args() print(args) return '222'if __name__ == '__main__': app.run(debug=True)123456789# ç”Ÿæˆçš„é”™è¯¯ä¿¡æ¯è·Ÿå®˜æ–¹æä¾›çš„æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œå…·ä½“å¦‚ä¸‹ï¼šC:\Users\sandu&gt;curl http://127.0.0.1:5000/hello -d "foo=three" -X PUT&#123; "errors": &#123; "foo": "Bad choice: &#123;error_msg&#125; The value 'three' is not a valid choicefor 'foo'." &#125;, "message": "Input payload validation failed"&#125;6.é”™è¯¯å¤„ç†6.1 httpå¼‚å¸¸å¤„ç†Werkzeug httpExceptionå°†è‡ªåŠ¨æ­£ç¡®åºåˆ—åŒ–ï¼Œå¹¶é‡ç”¨descriptionå±žæ€§ã€‚12from werkzeug.exceptions import BadRequestraise BadRequest()è¿”å›žå¦‚ä¸‹çš„400é”™è¯¯ä»£ç å’Œä¿¡æ¯ï¼š123&#123; "message": "The browser (or proxy) sent a request that this server could not understand."&#125;è‹¥æ˜¯è®¾ç½®çš„æœ‰è‡ªå®šä¹‰çš„é”™è¯¯ä¿¡æ¯ï¼Œæ¯”å¦‚è¿™æ ·çš„ï¼š12from werkzeug.exceptions import BadRequestraise BadRequest('My custom message')é”™è¯¯æ˜¾ç¤ºä¿¡æ¯å°†ä¼šæ˜¯è¿™æ ·çš„ï¼š123&#123; "message": "My custom message"&#125;è¿˜å¯ä»¥ é€šè¿‡å‘å¼‚å¸¸æä¾›æ•°æ®å±žæ€§ï¼Œå¯ä»¥å°†é™„åŠ å±žæ€§é™„åŠ åˆ°è¾“å‡ºã€‚1234from werkzeug.exceptions import BadRequeste = BadRequest('My custom message')e.data = &#123;'custom': 'value'&#125;raise eé”™è¯¯æ˜¾ç¤ºä¿¡æ¯å°†ä¼šæ˜¯è¿™æ ·çš„ï¼š1234&#123; "message": "My custom message", "custom": "value"&#125;6.2 Flaské”™è¯¯åŠ©æ‰‹abortå¸®åŠ©ç¨‹åºå°†é”™è¯¯æ­£ç¡®åŒ…è£…åˆ°httpexceptionä¸­ï¼Œä»¥ä¾¿å…·æœ‰ç›¸åŒçš„è¡Œä¸ºã€‚12from flask import abortabort(400)è¿”å›žå¦‚ä¸‹çš„400é”™è¯¯ä»£ç å’Œä¿¡æ¯ï¼š123&#123; "message": "The browser (or proxy) sent a request that this server could not understand."&#125;å¦‚æžœåœ¨abortä¸­æŒ‡å®šé”™è¯¯ä»£ç å’Œé”™è¯¯ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼š12from flask import abortabort(400, 'My custom message')é”™è¯¯æ˜¾ç¤ºä¿¡æ¯å°†ä¼šæ˜¯è¿™æ ·çš„ï¼š123&#123; "message": "My custom message"&#125;6.3 Flask-RESTPlusé”™è¯¯åŠ©æ‰‹errors.abort()å’Œnamespace.abort()çš„å·¥ä½œæ–¹å¼ä¸ŽåŽŸå§‹flask.abort()ç±»ä¼¼ï¼Œä½†å®ƒè¿˜å°†å‘å“åº”æ·»åŠ å…³é”®å­—å‚æ•°ã€‚12from flask_restplus import abortabort(400, custom='value')è¿”å›žå¦‚ä¸‹çš„400é”™è¯¯ä»£ç å’Œä¿¡æ¯ï¼š1234&#123; "message": "The browser (or proxy) sent a request that this server could not understand.", "custom": "value"&#125;å¦‚æžœåœ¨abortä¸­æŒ‡å®šé”™è¯¯ä»£ç å’Œé”™è¯¯ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼š12from flask import abortabort(400, 'My custom message', custom='value')é”™è¯¯æ˜¾ç¤ºä¿¡æ¯å°†ä¼šæ˜¯è¿™æ ·çš„ï¼š1234&#123; "message": "My custom message", "custom": "value"&#125;6.4 @api.errorhandlerè£…é¥°å™¨@api.errorhandler è£…é¥°å™¨å…è®¸æ‚¨ä»¥ä¸Žflask/blueprint@errorhandler decoratorç›¸åŒçš„æ–¹å¼ä¸ºç»™å®šçš„å¼‚å¸¸ï¼ˆæˆ–ä»Žä¸­ç»§æ‰¿çš„ä»»ä½•å¼‚å¸¸ï¼‰æ³¨å†Œç‰¹å®šçš„å¤„ç†ç¨‹åºã€‚12345678910111213141516171819202122232425262728@api.errorhandler(RootException)def handle_root_exception(error): '''Return a custom message and 400 status code''' return &#123;'message': 'What you want'&#125;, 400@api.errorhandler(CustomException)def handle_custom_exception(error): '''Return a custom message and 400 status code''' return &#123;'message': 'What you want'&#125;, 400@api.errorhandler(AnotherException)def handle_another_exception(error): '''Return a custom message and 500 status code''' return &#123;'message': error.specific&#125;@api.errorhandler(FakeException)def handle_fake_exception_with_header(error): '''Return a custom message and 400 status code''' return &#123;'message': error.message&#125;, 400, &#123;'My-Header': 'Value'&#125;@api.errorhandler(NoResultFound)def handle_no_result_exception(error): '''Return a custom not found error message and 404 status code''' return &#123;'message': error.specific&#125;, 404OpenAPI 2.0è§„èŒƒè¦æ±‚â€œnoresultfoundâ€é”™è¯¯ï¼ˆå¸¦è¯´æ˜Žï¼‰ã€‚é”™è¯¯å¥æŸ„å‡½æ•°ä¸­çš„docstringå°†ä½œä¸ºè¯´æ˜Žè¾“å‡ºåˆ°swagger.jsonä¸­ã€‚æˆ–è€…ä½¿ç”¨å¦‚ä¸‹çš„è¿™ç§æ–¹å¼ï¼š1234567891011121314151617@api.errorhandler(FakeException)@api.marshal_with(error_fields, code=400)@api.header('My-Header', 'Some description')def handle_fake_exception_with_header(error): '''This is a custom error''' return &#123;'message': error.message&#125;, 400, &#123;'My-Header': 'Value'&#125;@api.route('/test/')class TestResource(Resource): def get(self): ''' Do something :raises CustomException: In case of something ''' passåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå‡½æ•°æ–‡æ¡£ä¸­çš„:raise:çš„ä¿¡æ¯å°†ä¼šè‡ªåŠ¨æå–å‡ºæ¥ï¼Œå¹¶ä¸”å“åº”400å°†æ­£ç¡®è®°å½•å®ƒè¿˜å…è®¸åœ¨ä¸ä½¿ç”¨å‚æ•°çš„æƒ…å†µä¸‹é‡å†™é»˜è®¤é”™è¯¯å¤„ç†ç¨‹åº1234@api.errorhandlerdef default_error_handler(error): '''Default error handler''' return &#123;'message': str(error)&#125;, getattr(error, 'code', 500)é»˜è®¤æƒ…å†µä¸‹ï¼Œflask restpluså°†åœ¨é”™è¯¯å“åº”ä¸­è¿”å›žä¸€æ¡æ¶ˆæ¯ã€‚å¦‚æžœéœ€è¦è‡ªå®šä¹‰å“åº”ä½œä¸ºé”™è¯¯ï¼Œè€Œä¸éœ€è¦æ¶ˆæ¯å­—æ®µï¼Œåˆ™å¯ä»¥é€šè¿‡åœ¨åº”ç”¨ç¨‹åºé…ç½®ä¸­å°†error_include_messageè®¾ç½®ä¸ºfalseæ¥ç¦ç”¨è¯¥å“åº”ã€‚ä¹Ÿå¯ä»¥åœ¨å‘½åç©ºé—´ä¸Šæ³¨å†Œé”™è¯¯å¤„ç†ç¨‹åºã€‚åœ¨å‘½åç©ºé—´ä¸Šæ³¨å†Œçš„é”™è¯¯å¤„ç†ç¨‹åºå°†é‡å†™åœ¨APIä¸Šæ³¨å†Œçš„é”™è¯¯å¤„ç†ç¨‹åºã€‚123456ns = Namespace('cats', description='Cats related operations')@ns.errorhandlerdef specific_namespace_error_handler(error): '''Namespace error handler''' return &#123;'message': str(error)&#125;, getattr(error, 'code', 500)7.å­—æ®µæŽ©ç flask restplusæ”¯æŒéƒ¨åˆ†å¯¹è±¡èŽ·å–ï¼ˆaka.å­—æ®µå±è”½ï¼‰é€šè¿‡åœ¨è¯·æ±‚ä¸­æä¾›è‡ªå®šä¹‰å¤´ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¯·æ±‚å¤´æ˜¯X-Fieldså­—æ®µï¼Œä½†å¯ä»¥ä½¿ç”¨restplus_mask_headerå‚æ•°è¿›è¡Œæ›´æ”¹ã€‚7.1 è¯­æ³•åªéœ€æä¾›ä¸€ä¸ªç”±é€—å·åˆ†éš”çš„å­—æ®µååˆ—è¡¨ï¼Œå¯ä»¥é€‰æ‹©ç”¨æ‹¬å·æ‹¬èµ·æ¥ã€‚12345678# ä»¥ä¸‹ä¸¤ç§å†™æ³•ä½œç”¨ç›¸ç­‰mask = '&#123;name,age&#125;'# æˆ–è€…mask = 'name,age'data = requests.get('/some/url/', headers=&#123;'X-Fields': mask&#125;)assert len(data) == 2assert 'name' in dataassert 'age' in dataè¦æŒ‡å®šåµŒå¥—å­—æ®µæŽ©ç ï¼Œåªéœ€åœ¨å­—æ®µååŽé¢çš„æ‹¬å·ä¸­æä¾›å®ƒï¼š1mask = '&#123;name, age, pet&#123;name&#125;&#125;'åµŒå¥—è§„èŒƒé€‚ç”¨äºŽåµŒå¥—å¯¹è±¡æˆ–å¯¹è±¡åˆ—è¡¨ï¼š12# Will apply the mask &#123;name&#125; to each pet in the pets list.mask = '&#123;name, age, pets&#123;name&#125;&#125;'æœ‰ä¸€ä¸ªç‰¹æ®Šçš„æ˜Ÿå½¢æ ‡è®°ï¼Œæ„æ€æ˜¯â€œæ‰€æœ‰å‰©ä½™å­—æ®µâ€ã€‚å®ƒåªå…è®¸æŒ‡å®šåµŒå¥—ç­›é€‰ï¼š12345# Will apply the mask &#123;name&#125; to each pet in the pets list and take all other root fields without filtering.mask = '&#123;pets&#123;name&#125;,*&#125;'# Will not filter anythingmask = '*'7.2 ç”¨æ³•é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯æ¬¡ä½¿ç”¨api.marshalæˆ–@api.marshal_withæ—¶ï¼Œå¦‚æžœå­˜åœ¨å¤´ï¼Œåˆ™ä¼šè‡ªåŠ¨åº”ç”¨æŽ©ç ã€‚æ¯æ¬¡å°†@api.marshal_ä¸Ždecoratorä¸€èµ·ä½¿ç”¨æ—¶ï¼Œå¤´éƒ½å°†ä½œä¸ºä¸€ä¸ªswagerå‚æ•°å…¬å¼€ã€‚å› ä¸ºä¸€æ—¦å…¨å±€å¤´å¯ä»¥ä½¿æ‚¨çš„Swaggerè§„èŒƒæ›´åŠ å†—é•¿ï¼Œå®ƒå°±ä¸å…è®¸å…¬å¼€å®ƒã€‚æ‚¨å¯ä»¥é€šè¿‡å°†restplus_mask_swaggerè®¾ç½®ä¸ºfalseæ¥ç¦ç”¨æ­¤è¡Œä¸ºã€‚è¿˜å¯ä»¥æŒ‡å®šä¸€ä¸ªé»˜è®¤æŽ©ç ï¼Œå¦‚æžœæ‰¾ä¸åˆ°å¤´æŽ©ç ï¼Œåˆ™å°†åº”ç”¨è¯¥é»˜è®¤æŽ©ç ã€‚1234class MyResource(Resource): @api.marshal_with(my_model, mask='name,age') def get(self): passé»˜è®¤æŽ©ç ä¹Ÿå¯ä»¥åœ¨æ¨¡åž‹çº§åˆ«å¤„ç†ï¼š12345model = api.model('Person', &#123; 'name': fields.String, 'age': fields.Integer, 'boolean': fields.Boolean,&#125;, mask='&#123;name,age&#125;')è¦è¦†ç›–é»˜è®¤æŽ©ç ï¼Œæ‚¨éœ€è¦æä¾›å¦ä¸€ä¸ªæŽ©ç æˆ–å°†*ä½œä¸ºæŽ©ç ä¼ é€’ã€‚8. Swaggeræ–‡æ¡£Swagger APIæ–‡æ¡£æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œå¯ä»¥ä»ŽAPIçš„æ ¹URLèŽ·å¾—ã€‚æ‚¨å¯ä»¥ä½¿ç”¨@api.doc()è£…é¥°å™¨é…ç½®æ–‡æ¡£ã€‚8.1 @api.doc()è£…é¥°å™¨æ–‡æ¡£@api.doc()è£…é¥°å™¨å…è®¸æ‚¨åœ¨æ–‡æ¡£ä¸­åŒ…å«å…¶ä»–ä¿¡æ¯ã€‚å¯ä»¥åœ¨classç±»ä¸­æˆ–è€…methodä¸­123456789@api.route('/my-resource/&lt;id&gt;', endpoint='my-resource')@api.doc(params=&#123;'id': 'An ID'&#125;)class MyResource(Resource): def get(self, id): return &#123;&#125; @api.doc(responses=&#123;403: 'Not Authorized'&#125;) def post(self, id): api.abort(403)8.2 è‡ªåŠ¨æ–‡ä»¶æ¨¡åž‹ä½¿ç”¨modelï¼ˆï¼‰ã€cloneï¼ˆï¼‰å’Œinheritï¼ˆï¼‰å®žä¾‹åŒ–çš„æ‰€æœ‰æ¨¡åž‹éƒ½å°†è‡ªåŠ¨è®°å½•åœ¨æ‚¨çš„swagerè§„èŒƒä¸­ã€‚inherit()æ–¹æ³•å°†åœ¨swageræ¨¡åž‹å®šä¹‰ä¸­åŒæ—¶æ³¨å†Œçˆ¶çº§å’Œå­çº§ï¼š12345678parent = api.model('Parent', &#123; 'name': fields.String, 'class': fields.String(discriminator=True)&#125;)child = api.inherit('Child', parent, &#123; 'extra': fields.String&#125;)ä¸Šè¿°é…ç½®å°†äº§ç”Ÿä»¥ä¸‹Swagger å®šä¹‰ï¼š123456789101112131415161718"Parent": &#123; "properties": &#123; "name": &#123;"type": "string"&#125;, "class": &#123;"type": "string"&#125; &#125;, "discriminator": "class", "required": ["class"]&#125;,"Child": &#123; "allOf": [&#123; "$ref": "#/definitions/Parent" &#125;, &#123; "properties": &#123; "extra": &#123;"type": "string"&#125; &#125; &#125; ]&#125;8.3@api.marshal_with()è£…é¥°å™¨æ­¤è£…é¥°å™¨çš„å·¥ä½œæ–¹å¼ä¸ŽåŽŸå§‹marshal_withï¼ˆï¼‰è£…é¥°å™¨ç±»ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºŽå®ƒè®°å½•äº†è¿™äº›æ–¹æ³•ã€‚å¯é€‰å‚æ•°ä»£ç å…è®¸æ‚¨æŒ‡å®šé¢„æœŸçš„HTTPçŠ¶æ€ä»£ç ï¼ˆé»˜è®¤ä¸º200ï¼‰ã€‚å¯é€‰å‚æ•°as_listå…è®¸æ‚¨æŒ‡å®šå¯¹è±¡æ˜¯å¦ä½œä¸ºåˆ—è¡¨è¿”å›žã€‚12345678910111213resource_fields = api.model('Resource', &#123; 'name': fields.String,&#125;)@api.route('/my-resource/&lt;id&gt;', endpoint='my-resource')class MyResource(Resource): @api.marshal_with(resource_fields, as_list=True) def get(self): return get_objects() @api.marshal_with(resource_fields, code=201) def post(self): return create_object(), 201Api.marshal_list_with()è£…é¥°å™¨ä¸¥æ ¼ç›¸ç­‰äºŽApi.marshal_with(fields, as_list=True)()ã€‚12345678910111213resource_fields = api.model('Resource', &#123; 'name': fields.String,&#125;)@api.route('/my-resource/&lt;id&gt;', endpoint='my-resource')class MyResource(Resource): @api.marshal_list_with(resource_fields) def get(self): return get_objects() @api.marshal_with(resource_fields) def post(self): return create_object()8.4 @api.expect()è£…é¥°å™¨@api.expectï¼ˆï¼‰è£…é¥°å™¨å…è®¸æ‚¨æŒ‡å®šé¢„æœŸçš„è¾“å…¥å­—æ®µã€‚å®ƒæŽ¥å—ä¸€ä¸ªå¯é€‰çš„å¸ƒå°”å‚æ•°validateï¼ŒæŒ‡ç¤ºæ˜¯å¦åº”éªŒè¯æœ‰æ•ˆè´Ÿè½½ã€‚é€šè¿‡å°†restplus_validateé…ç½®è®¾ç½®ä¸ºtrueæˆ–å°†validate=trueä¼ é€’ç»™APIæž„é€ å‡½æ•°ï¼Œå¯ä»¥å…¨å±€è‡ªå®šä¹‰éªŒè¯è¡Œä¸ºã€‚å¦‚ä¸‹ä¸¤ä¸ªä¾‹å­çš„ä½œç”¨æ˜¯ç›¸ç­‰çš„ï¼šä½¿ç”¨@api.expect()è£…é¥°å™¨123456789resource_fields = api.model('Resource', &#123; 'name': fields.String,&#125;)@api.route('/my-resource/&lt;id&gt;')class MyResource(Resource): @api.expect(resource_fields) def get(self): passä½¿ç”¨api.doc()è£…é¥°å™¨123456789resource_fields = api.model('Resource', &#123; 'name': fields.String,&#125;)@api.route('/my-resource/&lt;id&gt;')class MyResource(Resource): @api.doc(body=resource_fields) def get(self): passå¯ä»¥å°†åˆ—è¡¨æŒ‡å®šä¸ºé¢„æœŸè¾“å…¥ï¼š123456789resource_fields = api.model('Resource', &#123; 'name': fields.String,&#125;)@api.route('/my-resource/&lt;id&gt;')class MyResource(Resource): @api.expect([resource_fields]) def get(self): passå¯ä»¥ä½¿ç”¨RequestParserå®šä¹‰é¢„æœŸçš„è¾“å…¥ï¼š123456789parser = api.parser()parser.add_argument('param', type=int, help='Some param', location='form')parser.add_argument('in_files', type=FileStorage, location='files')@api.route('/with-parser/', endpoint='with-parser')class WithParserResource(restplus.Resource): @api.expect(parser) def get(self): return &#123;&#125;å¯ä»¥åœ¨ç‰¹å®šç»ˆç»“ç‚¹ä¸Šå¯ç”¨æˆ–ç¦ç”¨éªŒè¯ï¼š123456789101112131415resource_fields = api.model('Resource', &#123; 'name': fields.String,&#125;)@api.route('/my-resource/&lt;id&gt;')class MyResource(Resource): # Payload validation disabled @api.expect(resource_fields) def post(self): pass # Payload validation enabled @api.expect(resource_fields, validate=True) def post(self): passé€šè¿‡é…ç½®è¿›è¡Œçš„åº”ç”¨ç¨‹åºèŒƒå›´éªŒè¯ç¤ºä¾‹ï¼š12345678910111213141516171819app.config['RESTPLUS_VALIDATE'] = Trueapi = Api(app)resource_fields = api.model('Resource', &#123; 'name': fields.String,&#125;)@api.route('/my-resource/&lt;id&gt;')class MyResource(Resource): # Payload validation enabled @api.expect(resource_fields) def post(self): pass # Payload validation disabled @api.expect(resource_fields, validate=False) def post(self): passæž„é€ å‡½æ•°åœ¨åº”ç”¨ç¨‹åºèŒƒå›´å†…éªŒè¯çš„ç¤ºä¾‹ï¼š1234567891011121314151617api = Api(app, validate=True)resource_fields = api.model('Resource', &#123; 'name': fields.String,&#125;)@api.route('/my-resource/&lt;id&gt;')class MyResource(Resource): # Payload validation enabled @api.expect(resource_fields) def post(self): pass # Payload validation disabled @api.expect(resource_fields, validate=False) def post(self): pass8.5 @api.response()è£…é¥°å™¨æ–‡æ¡£@api.response()è£…é¥°å™¨å…è®¸æ‚¨è®°å½•å·²çŸ¥çš„å“åº”ï¼Œå®ƒæ˜¯@api.doc(responses=â€™â€™çš„å¿«æ·æ–¹å¼)å¦‚ä¸‹ä¸¤ä¸ªç¤ºä¾‹æ˜¯ç›¸ç­‰çš„ï¼š12345678910111213141516@api.route('/my-resource/')class MyResource(Resource): @api.response(200, 'Success') @api.response(400, 'Validation Error') def get(self): pass@api.route('/my-resource/')class MyResource(Resource): @api.doc(responses=&#123; 200: 'Success', 400: 'Validation Error' &#125;) def get(self): passæ‚¨å¯ä»¥é€‰æ‹©æŒ‡å®šå“åº”æ¨¡åž‹ä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ï¼š123456789model = api.model('Model', &#123; 'name': fields.String,&#125;)@api.route('/my-resource/')class MyResource(Resource): @api.response(200, 'Success', model) def get(self): pass@api.marshal_with()è£…é¥°å™¨è‡ªåŠ¨è®°å½•å“åº”ï¼š12345678910model = api.model('Model', &#123; 'name': fields.String,&#125;)@api.route('/my-resource/')class MyResource(Resource): @api.response(400, 'Validation error') @api.marshal_with(model, code=201, description='Object created') def post(self): passæ‚¨å¯ä»¥æŒ‡å®šåœ¨ä¸çŸ¥é“å“åº”ä»£ç çš„æƒ…å†µä¸‹å‘é€çš„é»˜è®¤å“åº”ï¼š12345@api.route('/my-resource/')class MyResource(Resource): @api.response('default', 'Error') def get(self): pass8.6 @api.route()è£…é¥°å™¨æ‚¨å¯ä»¥ä½¿ç”¨api.route()çš„docå‚æ•°æä¾›ç±»èŒƒå›´çš„æ–‡æ¡£ã€‚æ­¤å‚æ•°æŽ¥å—ä¸Žapi.doc()è£…é¥°å™¨ç›¸åŒçš„å€¼ã€‚ä»¥ä¸‹ä¸¤ç§è£…é¥°å™¨ä¾‹å­ä½œç”¨ç›¸åŒï¼šä½¿ç”¨@api.doc()12345@api.route('/my-resource/&lt;id&gt;', endpoint='my-resource')@api.doc(params=&#123;'id': 'An ID'&#125;)class MyResource(Resource): def get(self, id): return &#123;&#125;ä½¿ç”¨@api.route()1234@api.route('/my-resource/&lt;id&gt;', endpoint='my-resource', doc=&#123;'params':&#123;'id': 'An ID'&#125;&#125;)class MyResource(Resource): def get(self, id): return &#123;&#125;8.7 fieldså‚æ•°â€¦â€¦æœªå®Œå¾…ç»­â€¦â€¦]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Flask</tag>
        <tag>Flask-RESTPlus</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CentOS 7.2å®‰è£…redis]]></title>
    <url>%2F2019%2F12%2F31%2FCentOS%207.2%E5%AE%89%E8%A3%85redis%2F</url>
    <content type="text"><![CDATA[å®‰è£…# yum -y install redis å¸¸ç”¨å‘½ä»¤(1)æŸ¥çœ‹å®‰è£…ç‰ˆæœ¬:ä½¿ç”¨æœåŠ¡ç«¯å‘½ä»¤ï¼šredis-server --version å’Œ redis-server -v ä½¿ç”¨å®¢æˆ·ç«¯å‘½ä»¤ï¼šredis-cli --version å’Œ redis-cli -v å› ä¸ºredis çš„server ä¸Ž cli åŒæ—¶å®‰è£…ï¼Œæ‰€ä»¥äºŒè€…æŸ¥å‡ºçš„ç»“æžœåŸºæœ¬ä¸€è‡´ (2)å¯åŠ¨ï¼Œåœæ­¢ï¼Œé‡å¯service redis start|stop|restart (3)å¼€å¯è¿œç¨‹è¿žæŽ¥ä¿®æ”¹redis.confé…ç½®æ–‡ä»¶ï¼ŒæŠŠbind=127.0.0.1æ³¨é‡ŠæŽ‰(å¦‚æžœæƒ³è®¾ç½®å¯†ç åœ¨redis.confä¸­åŠ ä¸Šrequirepass:å¯†ç å³å¯) å®‰å…¨å»ºè®®1ã€Redisæœ¬èº«é˜²æŠ¤(1)ä¿®æ”¹Redisé»˜è®¤ç«¯å£ï¼Œå°†é»˜è®¤çš„6379ç«¯å£ä¿®æ”¹ä¸ºå…¶ä»–ç«¯å£ï¼› (2)å¢žåŠ Redisç”¨æˆ·åå’Œå¯†ç ï¼ŒRedisä½¿ç”¨æ™®é€šç”¨æˆ·æƒé™ï¼Œç¦æ­¢ä½¿ç”¨ root æƒé™å¯åŠ¨Redis æœåŠ¡ï¼Œè¿™æ ·å¯ä»¥ä¿è¯åœ¨å­˜åœ¨æ¼æ´žçš„æƒ…å†µä¸‹æ”»å‡»è€…ä¹Ÿåªèƒ½èŽ·å–åˆ°æ™®é€šç”¨æˆ·æƒé™ï¼Œæ— æ³•èŽ·å–rootæƒé™ï¼›è®¾ç½®å¯†ç è®¿é—®è®¤è¯ï¼Œå¯é€šè¿‡ä¿®æ”¹redis.confé…ç½®æ–‡ä»¶ä¸­çš„&quot;requirepass&quot; è®¾ç½®å¤æ‚å¯†ç  ï¼ˆéœ€è¦é‡å¯RedisæœåŠ¡æ‰èƒ½ç”Ÿæ•ˆï¼‰ï¼› (3)åœ¨Redisç»‘å®šæŒ‡å®šIPè®¿é—®(ä½ç½®é…ç½®æ–‡ä»¶[redis.config]ä¸­çš„bindèŠ‚ç‚¹) (4)ç¦ç”¨configæŒ‡ä»¤é¿å…æ¶æ„æ“ä½œï¼Œåœ¨Redisé…ç½®æ–‡ä»¶redis.confä¸­é…ç½®rename-commandé¡¹&quot;RENAME_CONFIG&quot;ï¼Œè¿™æ ·å³ä½¿å­˜åœ¨æœªæŽˆæƒè®¿é—®ï¼Œä¹Ÿèƒ½å¤Ÿç»™æ”»å‡»è€…ä½¿ç”¨config æŒ‡ä»¤åŠ å¤§éš¾åº¦ï¼› 2ã€LinuxæœåŠ¡å™¨(1)RedisæœåŠ¡å™¨ä¸è¦æš´éœ²åœ¨å¤–ç½‘ï¼Œç¦æ­¢RedisæœåŠ¡å¯¹å…¬ç½‘å¼€æ”¾ï¼Œå¯é€šè¿‡ä¿®æ”¹redis.confé…ç½®æ–‡ä»¶ä¸­çš„&quot;#bind 127.0.0.1&quot; ï¼ŒåŽ»æŽ‰å‰é¢çš„&quot;#&quot;å³å¯ï¼ˆRedisæœ¬æ¥å°±æ˜¯ä½œä¸ºå†…å­˜æ•°æ®åº“ï¼Œåªè¦ç›‘å¬åœ¨æœ¬æœºå³å¯ï¼‰ï¼› (2)å¼€å¯é˜²ç«å¢™ï¼Œé™åˆ¶IPå¯ä»¥è®¿é—®(iptableså‘½ä»¤)ï¼Œå¯¹è®¿é—®æºIPè¿›è¡Œè®¿é—®æŽ§åˆ¶ï¼Œå¯åœ¨é˜²ç«å¢™é™å®šæŒ‡å®šæºipæ‰å¯ä»¥è¿žæŽ¥RedisæœåŠ¡å™¨ï¼› (3)ç”¨å®¹å™¨ï¼ˆå¦‚Dockerç­‰ï¼‰ç®¡ç†èµ·æœåŠ¡å™¨ï¼Œè¿™æ ·ä¸­ç—…æ¯’åŽæŽ’æŸ¥ä¸å‡ºåŽŸå› éœ€è¦é‡æ–°è£…çŽ¯å¢ƒçš„æ—¶å€™å½±å“å°å¹¶ä¸”å¯ä»¥å¿«é€Ÿæ¢å¤ã€‚ rediså®¢æˆ·ç«¯Redisæ¡Œé¢ç®¡ç†å·¥å…·ï¼šRedis Desktop Managerï¼Œä¸‹è½½åœ°å€ï¼šhttp://down-www.newasp.net/pcdown/soft/dys/redis.desktop.manager.exe]]></content>
      <categories>
        <category>CentOS</category>
      </categories>
      <tags>
        <tag>CentOS</tag>
        <tag>Redis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CentOS 7.2å®‰è£…Python3.7]]></title>
    <url>%2F2019%2F12%2F31%2FCentOS%207.2%E5%AE%89%E8%A3%85Python3.7%2F</url>
    <content type="text"><![CDATA[ç³»ç»ŸçŽ¯å¢ƒâ€¢ CentOS 7.3 x86_64 æ“ä½œæ­¥éª¤å®‰è£…ä¾èµ–åŒ…# yum install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gcc make libffi-devel ä¸‹è½½ Python 3.7.1æºç åŒ…# wget https://www.python.org/ftp/python/3.7.1/Python-3.7.1.tar.xz è§£åŽ‹åˆ°æŒ‡å®šç›®å½•# tar xf Python-3.7.1.tar.xz -C /usr/local/src/ (yum -y install xz #è‹¥å¤±è´¥,é‡å»ºyumç¼“å­˜.yum clean all ,yum makecache) å¼€å§‹å®‰è£…# cd /usr/local/src/Python-3.7.1 # ./configure --prefix=/usr/local/python3 # make &amp;&amp; make install è¯´æ˜Žï¼šä»Ž Python 3.4 å¼€å§‹å°±å·²ç»è‡ªå¸¦äº† pip å’Œ easy_installï¼ˆsetuptools åŒ…å¸¦çš„å‘½ä»¤ï¼‰ åŒ…ç®¡ç†å‘½ä»¤ï¼Œå¯ä»¥åœ¨ /usr/local/python3/bin/ ç›®å½•ä¸‹çœ‹åˆ°ï¼ŒæŸ¥çœ‹ä¸€ä¸‹å·²ç»å®‰è£…çš„æ‰©å±•åŒ…ï¼š #/usr/local/python3/bin/pip3 list pip (8.1.1) setuptools (20.10.1) You are using pip version 8.1.1, however version 8.1.2 is available. You should consider upgrading via the &apos;pip install --upgrade pip&apos; command. æ›´æ–°pip #/usr/local/python3/bin/pip3 install --upgrade pip æ·»åŠ è½¯è¿žæŽ¥# ln -s /usr/local/python3/bin/python3 /usr/bin/python3 # ln -s /usr/local/python3/bin/pip3 /usr/bin/pip3 éªŒè¯# python3 -V # pip3 list]]></content>
      <categories>
        <category>CentOS</category>
      </categories>
      <tags>
        <tag>CentOS</tag>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Macç‰ˆ Navicat Premium]]></title>
    <url>%2F2019%2F07%2F22%2FMac%E7%89%88%20Navicat%20Premium%2F</url>
    <content type="text"><![CDATA[Macç‰ˆ Navicat Premium ä¸‹è½½åœ°å€(è¯·ä½¿ç”¨åˆ†äº«é“¾æŽ¥ä¸‹è½½)ï¼šè‹±æ–‡ç‰ˆåœ¨çº¿ç”Ÿæˆéžå¯¹ç§°åŠ å¯†å…¬é’¥ç§é’¥å¯¹ â€“ å¯†é’¥æ˜¯2048ä½çš„ï¼ŒPKCS#8æ ¼å¼1.ä¸‹è½½è½¯ä»¶Macç‰ˆ Navicat Premium ä¸‹è½½åœ°å€(è¯·ä½¿ç”¨åˆ†äº«é“¾æŽ¥ä¸‹è½½ï¼Œå…¶ä»–æ–¹å¼ä¸‹è½½çš„è½¯ä»¶ä¸çŸ¥é“èƒ½ä¸èƒ½ç”¨)ï¼šè‹±æ–‡ç‰ˆ2.ç”Ÿæˆå¯†é’¥æ‰“å¼€å¦‚ä¸‹é“¾æŽ¥çš„ç½‘ç«™ï¼Œåœ¨çº¿ç”Ÿæˆéžå¯¹ç§°åŠ å¯†å…¬é’¥ç§é’¥å¯¹ç”Ÿæˆå¯†é’¥ä½æ•°ï¼š2048ä½çš„ï¼Œå¯†é’¥æ ¼å¼ï¼šPKCS#8ï¼Œè¯ä¹¦å¯†ç ä¸ºç©ºï¼Œç„¶åŽç‚¹å‡»ç”Ÿæˆå¯†é’¥å¯¹ã€‚æŠŠç”Ÿæˆçš„éžå¯¹ç§°åŠ å¯†å…¬é’¥å’Œéžå¯¹ç§°åŠ å¯†ç§é’¥ä¿å­˜èµ·æ¥ã€‚3.å®‰è£…è½¯ä»¶ï¼Œä¿®æ”¹å…¬é’¥æ–‡ä»¶å†…å®¹å®‰è£…è½¯ä»¶ï¼Œç„¶åŽåœ¨finderä¸­æ‰¾åˆ°åº”ç”¨ç¨‹åºï¼Œå³é”®Navicat Premium.app ,æ‰“å¼€ç›®å½• /Contents/Resourcesï¼Œå…ˆå¤åˆ¶ä¿å­˜ä¸€ä»½ï¼Œç„¶åŽå†ç¼–è¾‘rpkæ–‡ä»¶ï¼Œç”¨è‡ªå·±ç”Ÿæˆçš„æˆ–è€…æœ¬äººæä¾›çš„å…¬é’¥æ›¿æ¢å¹¶ä¿å­˜(é‡ç‚¹)ã€‚4.æ¿€æ´»ï¼Œç”Ÿæˆæ¿€æ´»ç æŽ¥ä¸‹æ¥æ–­ç½‘ï¼Œç„¶åŽæ‰“å¼€navicat, æ ¹æ®navicatè¾“å…¥ä»¥ä¸‹åºåˆ—å·ï¼šè‹±æ–‡ç‰ˆ64ä½å¯†é’¥åºåˆ—å·ï¼š NAVG-UJ8Z-EVAP-JAUWå¦‚æžœå³è¾¹å‡ºçŽ° âœ”ï¸ï¼Œç»§ç»­ã€‚å¦‚æžœå³è¾¹æ˜¯é»‘è‰²çš„âŒ,é‡æ¥ã€‚ç”±äºŽæ–­äº†ç½‘ï¼Œåˆ™ä¼šå‡ºçŽ°æ‰‹åŠ¨æ¿€æ´»çš„æŒ‰é’®ï¼ˆå·¦è¾¹ç¬¬ä¸€ä¸ªï¼‰ï¼Œç‚¹å‡»æ‰‹åŠ¨æ¿€æ´»ä¼šå‡ºçŽ°è¯·æ±‚ç ã€‚ç™»å½•åœ¨çº¿ç”Ÿæˆéžå¯¹ç§°åŠ å¯†å…¬é’¥ç§é’¥å¯¹ï¼Œ å¡«å……æ–¹å¼ä¸ºPKCS1_PADDINGï¼Œç§é’¥å¯†ç ä¸ºç©ºï¼Œå­—ç¬¦é›†ä¸ºgb2312ç¼–ç ã€‚åœ¨ç¬¬ä¸€ä¸ªè¾“å…¥æ¡† è¾“å…¥åŠ å¯†ç§é’¥ï¼ˆä»¥â€œâ€”â€“BEGIN PRIVATE KEYâ€”â€“â€å¼€å¤´ â€œâ€”â€“END PRIVATE KEYâ€”â€“â€ ç»“å°¾ï¼‰ä¸­ å¡«ä¸Šç¬¬ä¸€æ­¥ç”Ÿæˆçš„éžå¯¹ç§°åŠ å¯†ç§é’¥åœ¨ç¬¬ä¸‰ä¸ªè¾“å…¥æ¡† RSAç§é’¥åŠ å¯†ã€è§£å¯†è½¬æ¢ç»“æžœ(base64äº†) å¡«ä¸Šè¯·æ±‚ç ï¼ˆnavicatä¸­å‡ºçŽ°çš„ï¼‰ç‚¹å‡»RSAç§é’¥è§£å¯†æ­¤æ—¶ä¼šåœ¨ç¬¬äºŒä¸ªè¾“å…¥æ¡†å¾…åŠ å¯†ã€è§£å¯†çš„æ–‡æœ¬ä¼šç”Ÿæˆè¯·æ±‚ç æ˜Žæ–‡ã€‚å¤§è‡´æ˜¯å¦‚ä¸‹æ ¼å¼ï¼š12345&#123; &quot;K&quot; : &quot;NAVGUJ8ZEVAPJAUW&quot;, &quot;P&quot; : &quot;Mac 10.14&quot;, &quot;DI&quot; : &quot;NDljYjY4ZWMzZTQ4MjRm&quot;&#125;æŽ¥ä¸‹æ¥éœ€è¦ç»™è¿™ä¸ªè¯·æ±‚ç æ˜Žæ–‡å¢žåŠ å†…å®¹ï¼šèŽ·å–å½“å‰æ—¶é—´æˆ³ æ—¶é—´æˆ³è½¬æ¢ï¼Œç”¨Tè¡¨ç¤ºè¾“å…¥æ‰€åœ¨å…¬å¸å’Œç»„ç»‡ï¼Œç”¨Nå’ŒOè¡¨ç¤ºæœ€ç»ˆæ ·å¼å¦‚ä¸‹ï¼š12345678&#123; &quot;K&quot; : &quot;NAVGUJ8ZEVAPJAUW&quot;, &quot;P&quot; : &quot;Mac 10.14&quot;, &quot;DI&quot; : &quot;NDljYjY4ZWMzZTQ4MjRm&quot;, &quot;N&quot;:&quot;52pojie&quot;, &quot;O&quot;:&quot;52pojie.cn&quot;, &quot;T&quot;:1563413356&#125;ç„¶åŽåœ¨ç¬¬äºŒä¸ªè¾“å…¥æ¡†å¾…åŠ å¯†ã€è§£å¯†çš„æ–‡æœ¬ä¸­è¾“å…¥è¯¥è¯·æ±‚ç æ˜Žæ–‡ï¼Œç‚¹å‡»RSAç§é’¥åŠ å¯†ï¼Œæœ€åŽä¼šåœ¨ç¬¬ä¸‰ä¸ªè¾“å…¥æ¡† RSAç§é’¥åŠ å¯†ã€è§£å¯†è½¬æ¢ç»“æžœ(base64äº†) ä¸Šæ˜¾ç¤ºå‡ºæ¿€æ´»ç ï¼Œå¤åˆ¶è¯¥æ¿€æ´»ç ï¼Œç²˜è´´åˆ°navicatä¸­ï¼Œæ¿€æ´»å³å¯ã€‚]]></content>
      <categories>
        <category>Mac</category>
        <category>Navicat Premium</category>
      </categories>
      <tags>
        <tag>Mac</tag>
        <tag>Navicat Premium</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SQLAlchemyçŸ¥è¯†è¡¥å……]]></title>
    <url>%2F2019%2F07%2F22%2FSQLAlchemy%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85-md%2F</url>
    <content type="text"><![CDATA[SQLiteçš„æ•°æ®åº“URIåœ¨Linuxæˆ–macOSç³»ç»Ÿä¸‹çš„æ–œçº¿æ•°é‡æ˜¯4ä¸ªï¼›åœ¨Windowsç³»ç»Ÿä¸‹çš„URIä¸­çš„æ–œçº¿æ•°é‡ä¸º3ä¸ªã€‚å†…å­˜åž‹æ•°æ®åº“çš„æ–œçº¿å›ºå®šä¸º3ä¸ªã€‚å¸¸ç”¨çš„SQLAlchemyå­—æ®µå‚æ•°ä¸­ï¼Œindexå¦‚æžœè®¾ç½®ä¸ºTrueï¼Œåˆ™è¡¨ç¤ºä¸ºè¯¥å­—æ®µåˆ›å»ºç´¢å¼•é€šè¿‡ORMæ¨¡åž‹æŸ¥çœ‹å¯¹åº”çš„SQLå»ºè¡¨è¯­å¥123456789101112131415161718192021222324252627282930#!/usr/bin/env python# -*- coding: utf-8 -*-# app.pyfrom flask import Flaskfrom flask_sqlalchemy import SQLAlchemyimport osapp = Flask(__name__)app.config['SQLALCHEMY_DATABASE_URI'] = os.getenv('DATABASE_URL', 'sqlite:///' + os.path.join(app.root_path, 'data.db'))app.config['SQLALCHEMY_TRACK_MODIFICATIONS'] = Falsedb = SQLAlchemy(app)class Note(db.Model): __tablename__ = 'note' id = db.Column(db.Integer, primary_key=True, autoincrement=True) body = db.Column(db.Text)@app.route('/')def index(): return '1'if __name__ == '__main__': app.run(debug=True)123456789&gt;&gt;&gt; from app import db,Note&gt;&gt;&gt; from sqlalchemy.schema import CreateTable&gt;&gt;&gt; print(CreateTable(Note.__table__))CREATE TABLE note ( id INTEGER NOT NULL, body TEXT, PRIMARY KEY (id))filterä¸Žfilter_byæŸ¥è¯¢æ–¹æ³•çš„åŒºåˆ«1234# filterNote.query.filter(Note.body=='SHAVE').first()## filter_byNote.query.filter_by(body='SHAVE').first()ç¼–è¾‘æ“ä½œå½“æˆ‘ä»¬æ¸²æŸ“è¡¨å•å­—æ®µæ—¶ï¼Œå¦‚æžœè¡¨å•å­—æ®µçš„dataå±žæ€§ä¸ä¸ºç©ºï¼ŒWTFormsä¼šè‡ªåŠ¨æŠŠdataå±žæ€§çš„å€¼æ·»åŠ åˆ°è¡¨å•å­—æ®µçš„valueå±žæ€§ä¸­ï¼Œä½œä¸ºè¡¨å•çš„å€¼å¡«å……è¿›åŽ»ï¼Œæˆ‘ä»¬ä¸ç”¨æ‰‹åŠ¨ä¸ºvalueå±žæ€§èµ‹å€¼ã€‚å› æ­¤ï¼Œå°†å­˜å‚¨ç¬”è®°åŽŸæœ‰å†…å®¹çš„note.bodyå±žæ€§èµ‹å€¼ç»™è¡¨å•bodyå­—æ®µçš„dataå±žæ€§å³å¯åœ¨é¡µé¢ä¸Šçš„è¡¨å•ä¸­å¡«å…¥åŽŸæœ‰çš„å†…å®¹ã€‚12345678910# index.html&lt;a class="btn" href="&#123;&#123; url_for('edit_note', note_id=note.id) &#125;&#125;"&gt;Edit&lt;/a&gt;#edit_note.html&lt;h2&gt;Edit Note&lt;/h2&gt;&lt;form method="post"&gt; &#123;&#123; form.csrf_token &#125;&#125; &#123;&#123; form_field(form.body, rows=5, cols=50) &#125;&#125; &#123;&#123; form.submit &#125;&#125;&lt;/form&gt;12345678910111213141516class EditNoteForm(FlaskForm): body = TextAreaField('Body', validators=[DataRequired()]) submit = SubmitField('Update') @app.route('/edit/&lt;int:note_id&gt;', methods=['GET', 'POST'])def edit_note(note_id): form = EditNoteForm() note = Note.query.get(note_id) if form.validate_on_submit(): note.body = form.body.data db.session.commit() flash('Your note is updated.') return redirect(url_for('index')) form.body.data = note.body return render_template('edit_note.html', form=form)æ­£å¸¸ä¸”å®‰å…¨çš„åˆ é™¤æ“ä½œï¼šå¤§å¤šæ•°äººé€šå¸¸ä¼šè€ƒè™‘åœ¨ç¬”è®°å†…å®¹ä¸‹æ·»åŠ ä¸€ä¸ªåˆ é™¤é“¾æŽ¥ï¼šhref12345678910id) &#125;&#125;&quot;&gt;Delete&lt;/a&gt;```ï¼Œè¿™ä¸ªé“¾æŽ¥æŒ‡å‘ç”¨æ¥åˆ é™¤ç¬”è®°çš„delete_noteè§†å›¾ï¼š```python@app.route(&apos;/delete/&lt;int:note_id&gt;&apos;)def delete_note(note_id): note = Note.query.get(note_id) db.session.delete(note) db.session.commit() flash(&apos;Your note is deleted.&apos;) return redirect(url_for(&apos;index&apos;))ä½†è¿™ç§å¤„ç†æ–¹å¼å®žé™…ä¸Šä¼šä½¿ç¨‹åºå¤„äºŽCSRFæ”»å‡»çš„é£Žé™©ä¹‹ä¸­ã€‚é˜²èŒƒCSRFæ”»å‡»çš„åŸºæœ¬åŽŸåˆ™å°±æ˜¯æ­£ç¡®ä½¿ç”¨GETå’ŒPOSTæ–¹æ³•ã€‚åƒåˆ é™¤è¿™ç±»ä¿®æ”¹æ•°æ®çš„æ“ä½œç»å¯¹ä¸èƒ½é€šè¿‡GETè¯·æ±‚å®žçŽ°ï¼Œæ­£ç¡®çš„åšæ³•æ˜¯ä¸ºåˆ é™¤æ“ä½œåˆ›å»ºä¸€ä¸ªè¡¨å•ï¼š12class DeleteNoteForm(FlaskForm): submit = SubmitField('Delete')è¿™ä¸ªè¡¨å•ç±»åªæœ‰ä¸€ä¸ªæäº¤å­—æ®µï¼Œåªéœ€è¦åœ¨é¡µé¢ä¸Šæ˜¾ç¤ºä¸€ä¸ªåˆ é™¤æŒ‰é’®æ¥æäº¤è¡¨å•ã€‚åˆ é™¤è¡¨å•çš„æäº¤è¯·æ±‚ç”±delete_noteè§†å›¾å¤„ç†:1234567891011@app.route('/delete/&lt;int:note_id&gt;', methods=['POST'])def delete_note(note_id): form = DeleteNoteForm() if form.validate_on_submit(): note = Note.query.get(note_id) # èŽ·å–å¯¹åº”è®°å½• db.session.delete(note) # åˆ é™¤è®°å½• db.session.commit() # æäº¤ä¿®æ”¹ flash('Your note is deleted.') else: abort(400) return redirect(url_for('index'))htmlé¡µé¢å¦‚ä¸‹ï¼š1234&lt;form method="post" action="&#123;&#123; url_for('delete_note', note_id=note.id) &#125;&#125;"&gt; &#123;&#123; form.csrf_token &#125;&#125; &#123;&#123; form.submit(class='btn') &#125;&#125;&lt;/form&gt;è¡¨å•çš„actionå±žæ€§è®¾ç½®ä¸ºåˆ é™¤å½“å‰ç¬”è®°çš„URLã€‚æž„å»ºURLæ—¶ï¼ŒURLå˜é‡note_idçš„å€¼é€šè¿‡note.idå±žæ€§èŽ·å–ï¼Œå½“å•å‡»æäº¤æŒ‰é’®æ—¶ï¼Œä¼šå°†è¯·æ±‚å‘é€åˆ°actionå±žæ€§ä¸­çš„URLã€‚æ·»åŠ åˆ é™¤è¡¨å•çš„ä¸»è¦ç›®çš„å°±æ˜¯é˜²æ­¢CSRFæ”»å‡»ï¼Œæ‰€ä»¥ä¸è¦å¿˜è®°æ¸²æŸ“CSRFä»¤ç‰Œå­—æ®µform.csrf_tokenã€‚ä¸€å¯¹å¤šå…³ç³»Authorç±»ç”¨æ¥è¡¨ç¤ºä½œè€…ï¼ŒArticleç±»ç”¨æ¥è¡¨ç¤ºæ–‡ç« ï¼Œä¸€ä¸ªä½œè€…å¯ä»¥æœ‰å¤šç¯‡æ–‡ç« 123456789101112131415class Author(db.Model): __tablename__ = 'author' id = db.Column(db.Integer, primary_key=True, autoincrement=True) name = db.Column(db.String(70), unique=True) phone = db.Column(db.String(20)) articles = db.relationship('Article')class Article(db.Model): __tablename__ = 'article' id = db.Column(db.Integer, primary_key=True, autoincrement=True) title = db.Column(db.String(50), index=True) body = db.Column(db.Text) author_id = db.Column(db.Integer, db.ForeignKey('author.id'))(1) å®šä¹‰å¤–é”®å¤–é”®åªèƒ½å­˜å‚¨å•ä¸€æ•°æ®ï¼ˆæ ‡é‡ï¼‰ï¼Œæ‰€ä»¥å¤–é”®æ€»æ˜¯åœ¨â€œå¤šâ€è¿™ä¸€ä¾§å®šä¹‰ã€‚å®šä¹‰ä¸€ä¸ªauthor_idå­—æ®µä½œä¸ºå¤–é”®ï¼Œä½¿ç”¨db.ForeignKeyç±»å®šä¹‰ä¸ºå¤–é”®ï¼Œä¼ å…¥å…³ç³»å¦ä¸€ä¾§çš„è¡¨åå’Œä¸»é”®å­—æ®µåï¼Œå³author.idã€‚å®žé™…çš„æ•ˆæžœæ˜¯å°†articleè¡¨çš„author_idçš„å€¼é™åˆ¶ä¸ºauthorè¡¨çš„idåˆ—çš„å€¼ã€‚å¤–é”®å­—æ®µçš„å‘½åæ²¡æœ‰é™åˆ¶ã€‚(2) å®šä¹‰å…³ç³»å±žæ€§å…³ç³»å±žæ€§åœ¨å…³ç³»çš„å‡ºå‘ä¾§å®šä¹‰ï¼Œå³ä¸€å¯¹å¤šå…³ç³»çš„â€œä¸€â€è¿™ä¸€ä¾§ã€‚å®šä¹‰äº†ä¸€ä¸ªarticleså±žæ€§æ¥è¡¨ç¤ºå¯¹åº”çš„å¤šç¯‡æ–‡ç« ã€‚å…³ç³»å±žæ€§çš„åç§°æ²¡æœ‰é™åˆ¶ï¼Œå¯ä»¥è‡ªç”±ä¿®æ”¹ã€‚å®ƒç›¸å½“äºŽä¸€ä¸ªå¿«æ·æŸ¥è¯¢ï¼Œä¸ä¼šä½œä¸ºå­—æ®µå†™å…¥æ•°æ®åº“ä¸­ã€‚è¿™ä¸ªå±žæ€§å¹¶æ²¡æœ‰ä½¿ç”¨Columnç±»å£°æ˜Žä¸ºåˆ—ï¼Œè€Œæ˜¯ä½¿ç”¨äº†db.relationshipï¼ˆï¼‰å…³ç³»å‡½æ•°å®šä¹‰ä¸ºå…³ç³»å±žæ€§ï¼Œå› ä¸ºè¿™ä¸ªå…³ç³»å±žæ€§è¿”å›žå¤šä¸ªè®°å½•ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºé›†åˆå…³ç³»å±žæ€§ã€‚relationshipï¼ˆï¼‰å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå…³ç³»å¦ä¸€ä¾§çš„æ¨¡åž‹åç§°ï¼Œå®ƒä¼šå‘Šè¯‰SQLAlchemyå°†Authorç±»ä¸ŽArticleç±»å»ºç«‹å…³ç³»ã€‚å½“è¿™ä¸ªå…³ç³»å±žæ€§è¢«è°ƒç”¨æ—¶ï¼ŒSQLAlchemyä¼šæ‰¾åˆ°å…³ç³»å¦ä¸€ä¾§ï¼ˆå³articleè¡¨ï¼‰çš„å¤–é”®å­—æ®µï¼ˆå³author_idï¼‰ï¼Œç„¶åŽåå‘æŸ¥è¯¢articleè¡¨ä¸­æ‰€æœ‰author_idå€¼ä¸ºå½“å‰è¡¨ä¸»é”®å€¼ï¼ˆå³author.idï¼‰çš„è®°å½•ï¼Œè¿”å›žåŒ…å«è¿™äº›è®°å½•çš„åˆ—è¡¨ï¼Œä¹Ÿå°±æ˜¯è¿”å›žæŸä¸ªä½œè€…å¯¹åº”çš„å¤šç¯‡æ–‡ç« è®°å½•ã€‚( 3 ) ç¤ºä¾‹1234567891011# æ·»åŠ æ•°æ®&gt;&gt;&gt; foo = Author(name='Foo')&gt;&gt;&gt; spam = Article(title='Spam')&gt;&gt;&gt; ham = Article(title='Ham')&gt;&gt;&gt; db.session.add(foo)&gt;&gt;&gt; db.session.add(spam)&gt;&gt;&gt; db.session.add(ham)&gt;&gt;&gt; foo.articles.append(spam)&gt;&gt;&gt; foo.articles.append(ham)&gt;&gt;&gt; db.session.commit()å¯¹å…³ç³»å±žæ€§è°ƒç”¨removeï¼ˆï¼‰æ–¹æ³•å¯ä»¥ä¸Žå¯¹åº”çš„Aritcleå¯¹è±¡è§£é™¤å…³ç³»ï¼š12&gt;&gt;&gt; foo.articles.remove(ham)&gt;&gt;&gt; db.session.commit()ï¼ˆ4ï¼‰å»ºç«‹åŒå‘å…³ç³»åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¹Ÿè®¸å¸Œæœ›èƒ½åœ¨Articleç±»ä¸­å®šä¹‰ä¸€ä¸ªç±»ä¼¼çš„authorå…³ç³»å±žæ€§ï¼Œå½“è¢«è°ƒç”¨æ—¶è¿”å›žå¯¹åº”çš„ä½œè€…è®°å½•ï¼Œè¿™ç±»è¿”å›žå•ä¸ªå€¼çš„å…³ç³»å±žæ€§è¢«ç§°ä¸ºæ ‡é‡å…³ç³»å±žæ€§ã€‚è€Œè¿™ç§ä¸¤ä¾§éƒ½æ·»åŠ å…³ç³»å±žæ€§èŽ·å–å¯¹æ–¹è®°å½•çš„å…³ç³»æˆ‘ä»¬ç§°ä¹‹ä¸ºåŒå‘å…³ç³»ã€‚é€šè¿‡åœ¨å…³ç³»çš„å¦ä¸€ä¾§ä¹Ÿåˆ›å»ºä¸€ä¸ªrelationshipï¼ˆï¼‰å‡½æ•°ï¼Œå°±å¯ä»¥åœ¨ä¸¤ä¸ªè¡¨ä¹‹é—´å»ºç«‹åŒå‘å…³ç³»ã€‚12345678910111213class Writer(db.Model): id = db.Column(db.Integer, primary_key=True) name = db.Column(db.String(70), unique=True) books = db.relationship('Book', back_populates='writer') class Book(db.Model): id = db.Column(db.Integer, primary_key=True) title = db.Column(db.String(50), index=True) writer_id = db.Column(db.Integer, db.ForeignKey('writer.id')) writer = db.relationship('Writer', back_populates='books')å¤šå¯¹ä¸€å…³ç³»Ctizenç±»è¡¨ç¤ºå±…æ°‘ï¼ŒCityç±»è¡¨ç¤ºåŸŽå¸‚ã€‚åœ¨å¤šå¯¹ä¸€å…³ç³»ä¸­å¤–é”®å’Œå…³ç³»å±žæ€§éƒ½å®šä¹‰åœ¨â€œå¤šâ€è¿™ä¸€ä¾§ï¼Œå³Cityç±»ä¸­ã€‚12345678910class Citizen(db.Model): id = db.Column(db.Integer, primary_key=True) name = db.Column(db.String(70), unique=True) city_id = db.Column(db.Integer, db.ForeignKey('city.id')) city = db.relationship('City') class City(db.Model): id = db.Column(db.Integer, primary_key=True) name = db.Column(db.String(30), unique=True)ä¸€å¯¹ä¸€å…³ç³»Cuntryç±»è¡¨ç¤ºå›½å®¶ï¼ŒCapitalç±»è¡¨ç¤ºé¦–éƒ½ã€‚ä¸€å¯¹ä¸€å…³ç³»å®žé™…ä¸Šæ˜¯é€šè¿‡å»ºç«‹åŒå‘å…³ç³»çš„ä¸€å¯¹å¤šå…³ç³»çš„åŸºç¡€ä¸Šè½¬åŒ–è€Œæ¥ã€‚åœ¨å®šä¹‰é›†åˆå±žæ€§çš„å…³ç³»å‡½æ•°ä¸­å°†uselistå‚æ•°è®¾ä¸ºFalseï¼Œè¿™æ—¶ä¸€å¯¹å¤šå…³ç³»å°†è¢«è½¬æ¢ä¸ºä¸€å¯¹ä¸€å…³ç³»ã€‚â€œå¤šâ€è¿™ä¸€ä¾§æœ¬èº«å°±æ˜¯æ ‡é‡å…³ç³»å±žæ€§ï¼Œä¸ç”¨åšä»»ä½•æ”¹åŠ¨ã€‚è€Œâ€œä¸€â€è¿™ä¸€ä¾§çš„é›†åˆå…³ç³»å±žæ€§ï¼Œé€šè¿‡å°†uselistè®¾ä¸ºFalseåŽï¼Œå°†ä»…è¿”å›žå¯¹åº”çš„å•ä¸ªè®°å½•ï¼Œè€Œä¸”æ— æ³•å†ä½¿ç”¨åˆ—è¡¨è¯­ä¹‰æ“ä½œ.123456789101112class Country(db.Model): id = db.Column(db.Integer, primary_key=True) name = db.Column(db.String(30), unique=True) capital = db.relationship('Capital', uselist=False) class Capital(db.Model): id = db.Column(db.Integer, primary_key=True) name = db.Column(db.String(30), unique=True) country_id = db.Column(db.Integer, db.ForeignKey('country.id')) country = db.relationship('Country')å¤šå¯¹å¤šå…³ç³»Sudentç±»è¡¨ç¤ºå­¦ç”Ÿï¼ŒTeacherç±»è¡¨ç¤ºè€å¸ˆã€‚åœ¨å¤šå¯¹å¤šå…³ç³»ä¸­ï¼Œæ¯ä¸€ä¸ªè®°å½•éƒ½å¯ä»¥ä¸Žå…³ç³»å¦ä¸€ä¾§çš„å¤šä¸ªè®°å½•å»ºç«‹å…³ç³»ï¼Œå…³ç³»ä¸¤ä¾§çš„æ¨¡åž‹éƒ½éœ€è¦å­˜å‚¨ä¸€ç»„å¤–é”®ã€‚é™¤äº†å…³ç³»ä¸¤ä¾§çš„æ¨¡åž‹å¤–ï¼Œè¿˜éœ€è¦åˆ›å»ºä¸€ä¸ªå…³è”è¡¨ã€‚å…³è”è¡¨ä¸å­˜å‚¨æ•°æ®ï¼Œåªç”¨æ¥å­˜å‚¨å…³ç³»ä¸¤ä¾§æ¨¡åž‹çš„å¤–é”®å¯¹åº”å…³ç³»ã€‚å…³è”è¡¨ä½¿ç”¨db.Tableç±»å®šä¹‰ï¼Œä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å…³è”è¡¨çš„åç§°ã€‚å…³è”è¡¨ä¸­å®šä¹‰äº†ä¸¤ä¸ªå¤–é”®å­—æ®µï¼šteacher_idå­—æ®µå­˜å‚¨Teacherç±»çš„ä¸»é”®ï¼Œstudent_idå­˜å‚¨Studentç±»çš„ä¸»é”®ã€‚å€ŸåŠ©å…³è”è¡¨è¿™ä¸ªä¸­é—´äººå­˜å‚¨çš„å¤–é”®å¯¹ï¼Œå¯ä»¥æŠŠå¤šå¯¹å¤šå…³ç³»åˆ†åŒ–æˆä¸¤ä¸ªä¸€å¯¹å¤šå…³ç³».å¯¹å…³ç³»å±žæ€§ä½¿ç”¨appendï¼ˆï¼‰æ–¹æ³•å³å¯ã€‚å¦‚æžœä½ æƒ³è¦è§£é™¤å…³ç³»ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨removeï¼ˆï¼‰æ–¹æ³•ã€‚å…³è”è¡¨ç”±SQLAlchemyæŽ¥ç®¡ï¼Œå®ƒä¼šå¸®æˆ‘ä»¬ç®¡ç†è¿™ä¸ªè¡¨ï¼šæˆ‘ä»¬åªéœ€è¦åƒå¾€å¸¸ä¸€æ ·é€šè¿‡æ“ä½œå…³ç³»å±žæ€§æ¥å»ºç«‹æˆ–è§£é™¤å…³ç³»ï¼ŒSQLAlchemyä¼šè‡ªåŠ¨åœ¨å…³è”è¡¨ä¸­åˆ›å»ºæˆ–åˆ é™¤å¯¹åº”çš„å…³è”è¡¨è®°å½•ï¼Œè€Œä¸ç”¨æ‰‹åŠ¨æ“ä½œå…³è”è¡¨ã€‚12345678910111213141516association_table = db.Table('association', db.Column('student_id', db.Integer, db.ForeignKey('student.id')), db.Column('teacher_id', db.Integer, db.ForeignKey('teacher.id')))class Student(db.Model): id = db.Column(db.Integer, primary_key=True) name = db.Column(db.String(70), unique=True) grade = db.Column(db.String(20)) teachers = db.relationship('Teacher',secondary=association_table,back_populates='students') class Teacher(db.Model): id = db.Column(db.Integer, primary_key=True) name = db.Column(db.String(70), unique=True) office = db.Column(db.String(20))å¸¸ç”¨çš„SQLAlchemyå…³ç³»å‡½æ•°å‚æ•°å¸¸ç”¨çš„SQLAlchemyå…³ç³»è®°å½•åŠ è½½æ–¹å¼ï¼ˆlazyå‚æ•°å¯é€‰å€¼ï¼‰dynamicé€‰é¡¹ä»…ç”¨äºŽé›†åˆå…³ç³»å±žæ€§ï¼Œä¸å¯ç”¨äºŽå¤šå¯¹ä¸€ã€ä¸€å¯¹ä¸€æˆ–æ˜¯åœ¨å…³ç³»å‡½æ•°ä¸­å°†uselistå‚æ•°è®¾ä¸ºFalseçš„æƒ…å†µã€‚çº§è”æ“ä½œCascadeæ„ä¸ºâ€œçº§è”æ“ä½œâ€ï¼Œå°±æ˜¯åœ¨æ“ä½œä¸€ä¸ªå¯¹è±¡çš„åŒæ—¶ï¼Œå¯¹ç›¸å…³çš„å¯¹è±¡ä¹Ÿæ‰§è¡ŒæŸäº›æ“ä½œã€‚é€šè¿‡ä¸€ä¸ªPostæ¨¡åž‹å’ŒCommentæ¨¡åž‹æ¥æ¼”ç¤ºçº§è”æ“ä½œï¼Œåˆ†åˆ«è¡¨ç¤ºæ–‡ç« ï¼ˆå¸–å­ï¼‰å’Œè¯„è®ºï¼Œä¸¤è€…ä¸ºä¸€å¯¹å¤šå…³ç³»ï¼š12345678910111213class Post(db.Model): id = db.Column(db.Integer, primary_key=True) title = db.Column(db.String(50), unique=True) body = db.Column(db.Text) comments = db.relationship('Comment', back_populates='post',cascade='save-update, merge, delete') class Comment(db.Model): id = db.Column(db.Integer, primary_key=True) body = db.Column(db.Text) post_id = db.Column(db.Integer, db.ForeignKey('post.id')) post = db.relationship('Post', back_populates='comments')çº§è”è¡Œä¸ºé€šè¿‡å…³ç³»å‡½æ•°relationshipï¼ˆï¼‰çš„cascadeå‚æ•°è®¾ç½®ã€‚è®¾ç½®äº†cascadeå‚æ•°çš„ä¸€ä¾§å°†è¢«è§†ä¸ºçˆ¶å¯¹è±¡ï¼Œç›¸å…³çš„å¯¹è±¡åˆ™è¢«è§†ä¸ºå­å¯¹è±¡ã€‚cascadeé€šå¸¸ä½¿ç”¨å¤šä¸ªç»„åˆå€¼ï¼Œçº§è”å€¼ä¹‹é—´ä½¿ç”¨é€—å·åˆ†éš”ï¼Œ123class Post(db.Model): ... comments = db.relationship('Comment', back_populates='post',cascade='save-update, merge, delete')å¸¸ç”¨çš„é…ç½®ç»„åˆå¦‚ä¸‹æ‰€ç¤ºï¼šsave-updateã€mergeï¼ˆé»˜è®¤å€¼ï¼‰save-updateã€mergeã€deleteallallã€delete-orphanå½“æ²¡æœ‰è®¾ç½®cascadeå‚æ•°æ—¶ï¼Œä¼šä½¿ç”¨é»˜è®¤å€¼save-updateã€mergeã€‚allç­‰åŒäºŽé™¤äº†delete-orphanä»¥å¤–æ‰€æœ‰å¯ç”¨å€¼çš„ç»„åˆï¼Œå³save-updateã€mergeã€refresh-expireã€expungeã€deleteã€‚(1) save-updatesave-updateæ˜¯é»˜è®¤çš„çº§è”è¡Œä¸ºï¼Œå½“cascadeå‚æ•°è®¾ä¸ºsave-updateæ—¶ï¼Œå¦‚æžœä½¿ç”¨db.session.addï¼ˆï¼‰æ–¹æ³•å°†Postå¯¹è±¡æ·»åŠ åˆ°æ•°æ®åº“ä¼šè¯æ—¶ï¼Œé‚£ä¹ˆä¸ŽPostç›¸å…³è”çš„Commentå¯¹è±¡ä¹Ÿå°†è¢«æ·»åŠ åˆ°æ•°æ®åº“ä¼šè¯ã€‚(2) deleteå¦‚æžœæŸä¸ªPostå¯¹è±¡è¢«åˆ é™¤ï¼Œé‚£ä¹ˆæŒ‰ç…§é»˜è®¤çš„è¡Œä¸ºï¼Œè¯¥Postå¯¹è±¡ç›¸å…³è”çš„æ‰€æœ‰Commentå¯¹è±¡éƒ½å°†ä¸Žè¿™ä¸ªPostå¯¹è±¡å–æ¶ˆå…³è”ï¼Œå¤–é”®å­—æ®µçš„å€¼ä¼šè¢«æ¸…ç©ºã€‚å¦‚æžœPostç±»çš„å…³ç³»å‡½æ•°ä¸­cascadeå‚æ•°è®¾ä¸ºdeleteæ—¶ï¼Œè¿™äº›ç›¸å…³çš„Commentä¼šåœ¨å…³è”çš„Postå¯¹è±¡åˆ é™¤æ—¶è¢«ä¸€å¹¶åˆ é™¤ã€‚å½“éœ€è¦è®¾ç½®deleteçº§è”æ—¶ï¼Œæˆ‘ä»¬ä¼šå°†çº§è”å€¼è®¾ä¸ºallæˆ–save-updateã€mergeã€deleteã€‚123class Post(db.Model): ... comments = db.relationship('Comment', back_populates='post',cascade='all')(3) delete-orphandelete-orphanåŸºäºŽdeleteçº§è”çš„ï¼Œå¿…é¡»å’Œdeleteçº§è”ä¸€èµ·ä½¿ç”¨ï¼Œé€šå¸¸ä¼šè®¾ä¸ºallã€delete-orphanï¼Œå› ä¸ºallåŒ…å«deleteã€‚å› æ­¤å½“cascadeå‚æ•°è®¾ä¸ºdelete-orphanæ—¶ï¼Œå®ƒé¦–å…ˆåŒ…å«deleteçº§è”çš„è¡Œä¸ºï¼šå½“æŸä¸ªPostå¯¹è±¡è¢«åˆ é™¤æ—¶ï¼Œæ‰€æœ‰ç›¸å…³çš„Commentå¯¹è±¡éƒ½å°†è¢«åˆ é™¤ï¼ˆdeleteçº§è”ï¼‰ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå½“æŸä¸ªPostå¯¹è±¡ï¼ˆçˆ¶å¯¹è±¡ï¼‰ä¸ŽæŸä¸ªCommentå¯¹è±¡ï¼ˆå­å¯¹è±¡ï¼‰è§£é™¤å…³ç³»æ—¶ï¼Œä¹Ÿä¼šåˆ é™¤è¯¥Commentå¯¹è±¡ï¼Œè¿™ä¸ªè§£é™¤å…³ç³»çš„å¯¹è±¡è¢«ç§°ä¸ºå­¤ç«‹å¯¹è±¡ï¼ˆorphan objectï¼‰.123class Post(db.Model): ... comments = db.relationship('Comment', back_populates='post',cascade='all,delete-orphan')deleteå’Œdelete-orphané€šå¸¸ä¼šåœ¨ä¸€å¯¹å¤šå…³ç³»æ¨¡å¼ä¸­ï¼Œè€Œä¸”â€œå¤šâ€è¿™ä¸€ä¾§çš„å¯¹è±¡é™„å±žäºŽâ€œä¸€â€è¿™ä¸€ä¾§çš„å¯¹è±¡æ—¶ä½¿ç”¨ã€‚å°¤å…¶æ˜¯å¦‚æžœâ€œä¸€â€è¿™ä¸€ä¾§çš„â€œçˆ¶â€å¯¹è±¡ä¸å­˜åœ¨äº†ï¼Œé‚£ä¹ˆâ€œå¤šâ€è¿™ä¸€ä¾§çš„â€œå­â€å¯¹è±¡ä¸å†æœ‰æ„ä¹‰çš„æƒ…å†µã€‚äº‹ä»¶ç›‘å¬SQLAlchemyä¹Ÿæä¾›äº†ä¸€ä¸ªlisten_forï¼ˆï¼‰è£…é¥°å™¨ï¼Œå®ƒå¯ä»¥ç”¨æ¥æ³¨å†Œäº‹ä»¶å›žè°ƒå‡½æ•°ã€‚listen_forï¼ˆï¼‰è£…é¥°å™¨ä¸»è¦æŽ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œtargetè¡¨ç¤ºç›‘å¬çš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å¯ä»¥æ˜¯æ¨¡åž‹ç±»ã€ç±»å®žä¾‹æˆ–ç±»å±žæ€§ç­‰ã€‚identifierå‚æ•°è¡¨ç¤ºè¢«ç›‘å¬äº‹ä»¶çš„æ ‡è¯†ç¬¦ï¼Œæ¯”å¦‚ï¼Œç”¨äºŽç›‘å¬å±žæ€§çš„äº‹ä»¶æ ‡è¯†ç¬¦æœ‰setã€appendã€removeã€init_scalarã€init_collectionç­‰ã€‚123456789class Draft(db.Model): id = db.Column(db.Integer, primary_key=True) body = db.Column(db.Text) edit_time = db.Column(db.Integer, default=0) @db.event.listens_for(Draft.body, 'set')def increment_edit_time(target, value, oldvalue, initiator): if target.edit_time is not None: target.edit_time += 1listen_forï¼ˆï¼‰è£…é¥°å™¨ä¸­åˆ†åˆ«ä¼ å…¥Draft.bodyå’Œsetä½œä¸ºtargeå’Œidentifierå‚æ•°çš„å€¼ã€‚ç›‘å¬å‡½æ•°æŽ¥æ”¶æ‰€æœ‰setï¼ˆï¼‰äº‹ä»¶æ–¹æ³•æŽ¥æ”¶çš„å‚æ•°ï¼Œå…¶ä¸­çš„targetå‚æ•°è¡¨ç¤ºè§¦å‘äº‹ä»¶çš„æ¨¡åž‹ç±»å®žä¾‹ï¼Œä½¿ç”¨target.edit_timeå³å¯èŽ·å–æˆ‘ä»¬éœ€è¦å åŠ çš„å­—æ®µã€‚å…¶ä»–çš„å‚æ•°ä¹Ÿéœ€è¦ç…§å¸¸å†™å‡ºï¼Œè™½ç„¶è¿™é‡Œæ²¡æœ‰ç”¨åˆ°ã€‚valueè¡¨ç¤ºè¢«è®¾ç½®çš„å€¼ï¼Œoldvalueè¡¨ç¤ºè¢«å–ä»£çš„æ—§å€¼ã€‚å½“setäº‹ä»¶å‘ç”Ÿåœ¨ç›®æ ‡å¯¹è±¡Draft.bodyä¸Šæ—¶ï¼Œè¿™ä¸ªç›‘å¬å‡½æ•°å°±ä¼šè¢«æ‰§è¡Œï¼Œä»Žè€Œè‡ªåŠ¨å åŠ Draft.edit_timeåˆ—çš„å€¼123456789101112131415&gt;&gt;&gt; draft = Draft(body='init')&gt;&gt;&gt; db.session.add(draft)&gt;&gt;&gt; db.session.commit()&gt;&gt;&gt; draft.edit_time0&gt;&gt;&gt; draft.body = 'edited'&gt;&gt;&gt; draft.edit_time1&gt;&gt;&gt; draft.body = 'edited again'&gt;&gt;&gt; draft.edit_time2&gt;&gt;&gt; draft.body = 'edited again again'&gt;&gt;&gt; draft.edit_time3&gt;&gt;&gt; db.session.commit()è¿˜æœ‰ä¸€ç§æ›´ç®€å•çš„æ–¹æ³•ã€‚é€šè¿‡åœ¨listen_forï¼ˆï¼‰è£…é¥°å™¨ä¸­å°†å…³é”®å­—å‚æ•°nameè®¾ä¸ºTrueï¼Œå¯ä»¥åœ¨ç›‘å¬å‡½æ•°ä¸­æŽ¥æ”¶**kwargsä½œä¸ºå‚æ•°ï¼ˆå¯å˜é•¿å…³é”®å­—å‚æ•°ï¼‰ï¼Œå³â€œnamed argumentâ€ã€‚ç„¶åŽåœ¨å‡½æ•°ä¸­å¯ä»¥ä½¿ç”¨å‚æ•°åä½œä¸ºé”®æ¥ä»Ž**kwargså­—å…¸èŽ·å–å¯¹åº”çš„å‚æ•°å€¼ï¼š1234@db.event.listens_for(Draft.body, 'set', named=True)def increment_edit_time(**kwargs): if kwargs['target'].edit_time is not None: kwargs['target'].edit_time += 1]]></content>
      <categories>
        <category>SQLAlchemy</category>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>SQLAlchemy</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Dockeræ•™ç¨‹]]></title>
    <url>%2F2019%2F07%2F15%2FDocker%E6%95%99%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[Dockerç®€ä»‹åŸºäºŽèœé¸Ÿæ•™ç¨‹è‡ªå·±äº²è‡ªå®žè·µä¸€éï¼ŒæŠŠæ•™ç¨‹ä¸­æœ‰è¯¯çš„æ­¥éª¤æ”¹æ­£è¿‡æ¥ï¼Œæ–¹ä¾¿è‡ªå·±åŽæœŸæŸ¥çœ‹ä½¿ç”¨Docker ä»‹ç»Docker æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“Žï¼ŒåŸºäºŽ Go è¯­è¨€ å¹¶éµä»ŽApache2.0åè®®å¼€æºã€‚Docker å¯ä»¥è®©å¼€å‘è€…æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªè½»é‡çº§ã€å¯ç§»æ¤çš„å®¹å™¨ä¸­ï¼Œç„¶åŽå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„ Linux æœºå™¨ä¸Šï¼Œä¹Ÿå¯ä»¥å®žçŽ°è™šæ‹ŸåŒ–ã€‚å®¹å™¨æ˜¯å®Œå…¨ä½¿ç”¨æ²™ç®±æœºåˆ¶ï¼Œç›¸äº’ä¹‹é—´ä¸ä¼šæœ‰ä»»ä½•æŽ¥å£ï¼ˆç±»ä¼¼ iPhone çš„ appï¼‰,æ›´é‡è¦çš„æ˜¯å®¹å™¨æ€§èƒ½å¼€é”€æžä½Žã€‚Docker ä»Ž 17.03 ç‰ˆæœ¬ä¹‹åŽåˆ†ä¸º CEï¼ˆCommunity Edition: ç¤¾åŒºç‰ˆï¼‰ å’Œ EEï¼ˆEnterprise Edition: ä¼ä¸šç‰ˆï¼‰ï¼Œæˆ‘ä»¬ç”¨ç¤¾åŒºç‰ˆå°±å¯ä»¥äº†ã€‚Docker çš„åº”ç”¨åœºæ™¯Web åº”ç”¨çš„è‡ªåŠ¨åŒ–æ‰“åŒ…å’Œå‘å¸ƒã€‚è‡ªåŠ¨åŒ–æµ‹è¯•å’ŒæŒç»­é›†æˆã€å‘å¸ƒã€‚åœ¨æœåŠ¡åž‹çŽ¯å¢ƒä¸­éƒ¨ç½²å’Œè°ƒæ•´æ•°æ®åº“æˆ–å…¶ä»–çš„åŽå°åº”ç”¨ã€‚ä»Žå¤´ç¼–è¯‘æˆ–è€…æ‰©å±•çŽ°æœ‰çš„ OpenShift æˆ– Cloud Foundry å¹³å°æ¥æ­å»ºè‡ªå·±çš„ PaaS çŽ¯å¢ƒã€‚Docker çš„ä¼˜ç‚¹ç®€åŒ–ç¨‹åºDocker è®©å¼€å‘è€…å¯ä»¥æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªå¯ç§»æ¤çš„å®¹å™¨ä¸­ï¼Œç„¶åŽå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„ Linux æœºå™¨ä¸Šï¼Œä¾¿å¯ä»¥å®žçŽ°è™šæ‹ŸåŒ–ã€‚Dockeræ”¹å˜äº†è™šæ‹ŸåŒ–çš„æ–¹å¼ï¼Œä½¿å¼€å‘è€…å¯ä»¥ç›´æŽ¥å°†è‡ªå·±çš„æˆæžœæ”¾å…¥Dockerä¸­è¿›è¡Œç®¡ç†ã€‚æ–¹ä¾¿å¿«æ·å·²ç»æ˜¯ Dockerçš„æœ€å¤§ä¼˜åŠ¿ï¼Œè¿‡åŽ»éœ€è¦ç”¨æ•°å¤©ä¹ƒè‡³æ•°å‘¨çš„ ä»»åŠ¡ï¼Œåœ¨Dockerå®¹å™¨çš„å¤„ç†ä¸‹ï¼Œåªéœ€è¦æ•°ç§’å°±èƒ½å®Œæˆã€‚é¿å…é€‰æ‹©ææƒ§ç—‡å¦‚æžœä½ æœ‰é€‰æ‹©ææƒ§ç—‡ï¼Œè¿˜æ˜¯èµ„æ·±æ‚£è€…ã€‚é‚£ä¹ˆä½ å¯ä»¥ä½¿ç”¨ Docker æ‰“åŒ…ä½ çš„çº ç»“ï¼æ¯”å¦‚ Docker é•œåƒï¼›Docker é•œåƒä¸­åŒ…å«äº†è¿è¡ŒçŽ¯å¢ƒå’Œé…ç½®ï¼Œæ‰€ä»¥ Docker å¯ä»¥ç®€åŒ–éƒ¨ç½²å¤šç§åº”ç”¨å®žä¾‹å·¥ä½œã€‚æ¯”å¦‚ Web åº”ç”¨ã€åŽå°åº”ç”¨ã€æ•°æ®åº“åº”ç”¨ã€å¤§æ•°æ®åº”ç”¨æ¯”å¦‚ Hadoop é›†ç¾¤ã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰ç­‰éƒ½å¯ä»¥æ‰“åŒ…æˆä¸€ä¸ªé•œåƒéƒ¨ç½²ã€‚èŠ‚çœå¼€æ”¯ä¸€æ–¹é¢ï¼Œäº‘è®¡ç®—æ—¶ä»£åˆ°æ¥ï¼Œä½¿å¼€å‘è€…ä¸å¿…ä¸ºäº†è¿½æ±‚æ•ˆæžœè€Œé…ç½®é«˜é¢çš„ç¡¬ä»¶ï¼ŒDocker æ”¹å˜äº†é«˜æ€§èƒ½å¿…ç„¶é«˜ä»·æ ¼çš„æ€ç»´å®šåŠ¿ã€‚Docker ä¸Žäº‘çš„ç»“åˆï¼Œè®©äº‘ç©ºé—´å¾—åˆ°æ›´å……åˆ†çš„åˆ©ç”¨ã€‚ä¸ä»…è§£å†³äº†ç¡¬ä»¶ç®¡ç†çš„é—®é¢˜ï¼Œä¹Ÿæ”¹å˜äº†è™šæ‹ŸåŒ–çš„æ–¹å¼ã€‚Docker æž¶æž„Docker ä½¿ç”¨å®¢æˆ·ç«¯-æœåŠ¡å™¨ (C/S) æž¶æž„æ¨¡å¼ï¼Œä½¿ç”¨è¿œç¨‹APIæ¥ç®¡ç†å’Œåˆ›å»ºDockerå®¹å™¨ã€‚Docker å®¹å™¨é€šè¿‡ Docker é•œåƒæ¥åˆ›å»ºã€‚å®¹å™¨ä¸Žé•œåƒçš„å…³ç³»ç±»ä¼¼äºŽé¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„å¯¹è±¡ä¸Žç±»ã€‚Dockeré¢å‘å¯¹è±¡å®¹å™¨å¯¹è±¡é•œåƒç±»Docker é•œåƒ(Images)Docker é•œåƒæ˜¯ç”¨äºŽåˆ›å»º Docker å®¹å™¨çš„æ¨¡æ¿ã€‚Docker å®¹å™¨(Container)å®¹å™¨æ˜¯ç‹¬ç«‹è¿è¡Œçš„ä¸€ä¸ªæˆ–ä¸€ç»„åº”ç”¨ã€‚Docker å®¢æˆ·ç«¯(Client)Docker å®¢æˆ·ç«¯é€šè¿‡å‘½ä»¤è¡Œæˆ–è€…å…¶ä»–å·¥å…·ä½¿ç”¨ Docker API (https://docs.docker.com/reference/api/docker_remote_api) ä¸Ž Docker çš„å®ˆæŠ¤è¿›ç¨‹é€šä¿¡ã€‚Docker ä¸»æœº(Host)ä¸€ä¸ªç‰©ç†æˆ–è€…è™šæ‹Ÿçš„æœºå™¨ç”¨äºŽæ‰§è¡Œ Docker å®ˆæŠ¤è¿›ç¨‹å’Œå®¹å™¨ã€‚Docker ä»“åº“(Registry)Docker ä»“åº“ç”¨æ¥ä¿å­˜é•œåƒï¼Œå¯ä»¥ç†è§£ä¸ºä»£ç æŽ§åˆ¶ä¸­çš„ä»£ç ä»“åº“ã€‚ Docker Hub(https://hub.docker.com) æä¾›äº†åºžå¤§çš„é•œåƒé›†åˆä¾›ä½¿ç”¨ã€‚Docker MachineDocker Machineæ˜¯ä¸€ä¸ªç®€åŒ–Dockerå®‰è£…çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œé€šè¿‡ä¸€ä¸ªç®€å•çš„å‘½ä»¤è¡Œå³å¯åœ¨ç›¸åº”çš„å¹³å°ä¸Šå®‰è£…Dockerï¼Œæ¯”å¦‚VirtualBoxã€ Digital Oceanã€Microsoft Azureã€‚Docker å®‰è£…Ubuntu Docker å®‰è£…Docker æ”¯æŒä»¥ä¸‹çš„ Ubuntu ç‰ˆæœ¬ï¼šUbuntu Precise 12.04 (LTS)Ubuntu Trusty 14.04 (LTS)Ubuntu Wily 15.10Xenial 16.04 (LTS)å…¶ä»–æ›´æ–°çš„ç‰ˆæœ¬â€¦â€¦å¦‚æžœå®‰è£… Docker ce éœ€è¦ 16.04 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œå®‰è£…æ­¥éª¤å¯ä»¥æŸ¥çœ‹ç¬”è®°éƒ¨åˆ†ï¼šCosmic 18.10Bionic 18.04 (LTS)Xenial 16.04 (LTS)å‰ææ¡ä»¶Docker è¦æ±‚ Ubuntu ç³»ç»Ÿçš„å†…æ ¸ç‰ˆæœ¬é«˜äºŽ 3.10 ï¼ŒæŸ¥çœ‹æœ¬é¡µé¢çš„å‰ææ¡ä»¶æ¥éªŒè¯ä½ çš„ Ubuntu ç‰ˆæœ¬æ˜¯å¦æ”¯æŒ Dockerã€‚é€šè¿‡ uname -r å‘½ä»¤æŸ¥çœ‹ä½ å½“å‰çš„å†…æ ¸ç‰ˆæœ¬ï¼š1$ uname -rä½¿ç”¨è„šæœ¬å®‰è£… DockerèŽ·å–æœ€æ–°ç‰ˆæœ¬çš„ Docker å®‰è£…åŒ…1$ wget -qO- https://get.docker.com/ | shè¾“å…¥å½“å‰ç”¨æˆ·çš„å¯†ç åŽï¼Œå°±ä¼šä¸‹è½½è„šæœ¬å¹¶ä¸”å®‰è£…DockeråŠä¾èµ–åŒ…ã€‚å®‰è£…å®ŒæˆåŽæœ‰ä¸ªæç¤ºï¼š12345 If you would like to use Docker as a non-root user, you should now consider adding your user to the &quot;docker&quot; group with something like: sudo usermod -aG docker runoobRemember that you will have to log out and back in for this to take effect!å½“è¦ä»¥éžrootç”¨æˆ·å¯ä»¥ç›´æŽ¥è¿è¡Œdockeræ—¶ï¼Œéœ€è¦æ‰§è¡Œ sudo usermod -aG docker runoob å‘½ä»¤ï¼Œç„¶åŽé‡æ–°ç™»é™†ï¼Œå¦åˆ™ä¼šæœ‰å¦‚ä¸‹æŠ¥é”™ï¼šå¯åŠ¨docker åŽå°æœåŠ¡1$ sudo service docker startæµ‹è¯•è¿è¡Œhello-world1$ docker run hello-worldé•œåƒåŠ é€Ÿé‰´äºŽå›½å†…ç½‘ç»œé—®é¢˜ï¼ŒåŽç»­æ‹‰å– Docker é•œåƒååˆ†ç¼“æ…¢ï¼Œæˆ‘ä»¬å¯ä»¥éœ€è¦é…ç½®åŠ é€Ÿå™¨æ¥è§£å†³ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯ç½‘æ˜“çš„é•œåƒåœ°å€ï¼šhttp://hub-mirror.c.163.comã€‚æ–°ç‰ˆçš„ Docker ä½¿ç”¨ /etc/docker/daemon.jsonï¼ˆLinuxï¼‰ æˆ–è€… %programdata%\docker\config\daemon.jsonï¼ˆWindowsï¼‰ æ¥é…ç½® Daemonã€‚è¯·åœ¨è¯¥é…ç½®æ–‡ä»¶ä¸­åŠ å…¥ï¼ˆæ²¡æœ‰è¯¥æ–‡ä»¶çš„è¯ï¼Œè¯·å…ˆå»ºä¸€ä¸ªï¼‰ï¼š123&#123; "registry-mirrors": ["http://hub-mirror.c.163.com"]&#125;Ubuntu 16.04 å®‰è£… Docker1.é€‰æ‹©å›½å†…çš„äº‘æœåŠ¡å•†ï¼Œè¿™é‡Œé€‰æ‹©é˜¿é‡Œäº‘ä¸ºä¾‹1curl -sSL http://acs-public-mirror.oss-cn-hangzhou.aliyuncs.com/docker-engine/internet | sh -2.å®‰è£…æ‰€éœ€è¦çš„åŒ…1sudo apt-get install linux-image-extra-$(uname -r) linux-image-extra-virtual3.æ·»åŠ ä½¿ç”¨ HTTPS ä¼ è¾“çš„è½¯ä»¶åŒ…ä»¥åŠ CA è¯ä¹¦12sudo apt-get updatesudo apt-get install apt-transport-https ca-certificates4.æ·»åŠ GPGå¯†é’¥1sudo apt-key adv --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D5.æ·»åŠ è½¯ä»¶æº1echo "deb https://apt.dockerproject.org/repo ubuntu-xenial main" | sudo tee /etc/apt/sources.list.d/docker.list6.æ·»åŠ æˆåŠŸåŽæ›´æ–°è½¯ä»¶åŒ…ç¼“å­˜1sudo apt-get update7.å®‰è£…docker1sudo apt-get install docker-engine8.å¯åŠ¨ docker12sudo systemctl enable dockersudo systemctl start dockerUbuntu 18.04 å®‰è£… Docker-ce1.æ›´æ¢å›½å†…è½¯ä»¶æºï¼ŒæŽ¨èä¸­å›½ç§‘æŠ€å¤§å­¦çš„æºï¼Œç¨³å®šé€Ÿåº¦å¿«ï¼ˆå¯é€‰ï¼‰123sudo cp /etc/apt/sources.list /etc/apt/sources.list.baksudo sed -i 's/archive.ubuntu.com/mirrors.ustc.edu.cn/g' /etc/apt/sources.listsudo apt update2.å®‰è£…éœ€è¦çš„åŒ…1sudo apt install apt-transport-https ca-certificates software-properties-common curl3.æ·»åŠ  GPG å¯†é’¥ï¼Œå¹¶æ·»åŠ  Docker-ce è½¯ä»¶æºï¼Œè¿™é‡Œè¿˜æ˜¯ä»¥ä¸­å›½ç§‘æŠ€å¤§å­¦çš„ Docker-ce æºä¸ºä¾‹123curl -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/gpg | sudo apt-key add -sudo add-apt-repository "deb [arch=amd64] https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu \$(lsb_release -cs) stable"4.æ·»åŠ æˆåŠŸåŽæ›´æ–°è½¯ä»¶åŒ…ç¼“å­˜1sudo apt update5.å®‰è£… Docker-ce1sudo apt install docker-ce6.è®¾ç½®å¼€æœºè‡ªå¯åŠ¨å¹¶å¯åŠ¨ Docker-ceï¼ˆå®‰è£…æˆåŠŸåŽé»˜è®¤å·²è®¾ç½®å¹¶å¯åŠ¨ï¼Œå¯å¿½ç•¥ï¼‰12sudo systemctl enable dockersudo systemctl start docker7.æµ‹è¯•è¿è¡Œ1sudo docker run hello-world8.æ·»åŠ å½“å‰ç”¨æˆ·åˆ° docker ç”¨æˆ·ç»„ï¼Œå¯ä»¥ä¸ç”¨ sudo è¿è¡Œ dockerï¼ˆå¯é€‰ï¼‰12sudo groupadd dockersudo usermod -aG docker $USER9.æµ‹è¯•æ·»åŠ ç”¨æˆ·ç»„ï¼ˆå¯é€‰ï¼‰1docker run hello-worldCentOS Docker å®‰è£…Dockeræ”¯æŒä»¥ä¸‹çš„CentOSç‰ˆæœ¬ï¼šCentOS 7 (64-bit)CentOS 6.5 (64-bit) æˆ–æ›´é«˜çš„ç‰ˆæœ¬å‰ææ¡ä»¶ç›®å‰ï¼ŒCentOS ä»…å‘è¡Œç‰ˆæœ¬ä¸­çš„å†…æ ¸æ”¯æŒ Dockerã€‚Docker è¿è¡Œåœ¨ CentOS 7 ä¸Šï¼Œè¦æ±‚ç³»ç»Ÿä¸º64ä½ã€ç³»ç»Ÿå†…æ ¸ç‰ˆæœ¬ä¸º 3.10 ä»¥ä¸Šã€‚Docker è¿è¡Œåœ¨ CentOS6.5 æˆ–æ›´é«˜çš„ç‰ˆæœ¬çš„ CentOS ä¸Šï¼Œè¦æ±‚ç³»ç»Ÿä¸º64ä½ã€ç³»ç»Ÿå†…æ ¸ç‰ˆæœ¬ä¸º 2.6.32-431 æˆ–è€…æ›´é«˜ç‰ˆæœ¬ã€‚ä½¿ç”¨ yum å®‰è£…ï¼ˆCentOS 7ä¸‹ï¼‰Docker è¦æ±‚ CentOS ç³»ç»Ÿçš„å†…æ ¸ç‰ˆæœ¬é«˜äºŽ 3.10 ï¼ŒæŸ¥çœ‹æœ¬é¡µé¢çš„å‰ææ¡ä»¶æ¥éªŒè¯ä½ çš„CentOS ç‰ˆæœ¬æ˜¯å¦æ”¯æŒ Docker ã€‚é€šè¿‡ uname -r å‘½ä»¤æŸ¥çœ‹ä½ å½“å‰çš„å†…æ ¸ç‰ˆæœ¬1# uname -rä»Ž 2017 å¹´ 3 æœˆå¼€å§‹ docker åœ¨åŽŸæ¥çš„åŸºç¡€ä¸Šåˆ†ä¸ºä¸¤ä¸ªåˆ†æ”¯ç‰ˆæœ¬: Docker CE å’Œ Docker EEã€‚Docker CE å³ç¤¾åŒºå…è´¹ç‰ˆï¼ŒDocker EE å³ä¼ä¸šç‰ˆï¼Œå¼ºè°ƒå®‰å…¨ï¼Œä½†éœ€ä»˜è´¹ä½¿ç”¨ã€‚æœ¬æ–‡ä»‹ç» Docker CE çš„å®‰è£…ä½¿ç”¨ã€‚ç§»é™¤æ—§çš„ç‰ˆæœ¬ï¼š12345678910$ sudo yum remove docker \ docker-client \ docker-client-latest \ docker-common \ docker-latest \ docker-latest-logrotate \ docker-logrotate \ docker-selinux \ docker-engine-selinux \ docker-engineå®‰è£…ä¸€äº›å¿…è¦çš„ç³»ç»Ÿå·¥å…·ï¼š1sudo yum install -y yum-utils device-mapper-persistent-data lvm2æ·»åŠ è½¯ä»¶æºä¿¡æ¯ï¼š1sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repoDockeræ”¯æŒä»¥ä¸‹çš„CentOSç‰ˆæœ¬ï¼šCentOS 7 (64-bit) CentOS 6.5 (64-bit) æˆ–æ›´é«˜çš„ç‰ˆæœ¬ å‰ææ¡ä»¶ç›®å‰ï¼ŒCentOS ä»…å‘è¡Œç‰ˆæœ¬ä¸­çš„å†…æ ¸æ”¯æŒ Dockerã€‚Docker è¿è¡Œåœ¨ CentOS 7 ä¸Šï¼Œè¦æ±‚ç³»ç»Ÿä¸º64ä½ã€ç³»ç»Ÿå†…æ ¸ç‰ˆæœ¬ä¸º 3.10 ä»¥ä¸Šã€‚Docker è¿è¡Œåœ¨ CentOS-6.5 æˆ–æ›´é«˜çš„ç‰ˆæœ¬çš„ CentOS ä¸Šï¼Œè¦æ±‚ç³»ç»Ÿä¸º64ä½ã€ç³»ç»Ÿå†…æ ¸ç‰ˆæœ¬ä¸º 2.6.32-431 æˆ–è€…æ›´é«˜ç‰ˆæœ¬ã€‚ä½¿ç”¨ yum å®‰è£…ï¼ˆCentOS 7ä¸‹ï¼‰Docker è¦æ±‚ CentOS ç³»ç»Ÿçš„å†…æ ¸ç‰ˆæœ¬é«˜äºŽ 3.10 ï¼ŒæŸ¥çœ‹æœ¬é¡µé¢çš„å‰ææ¡ä»¶æ¥éªŒè¯ä½ çš„CentOS ç‰ˆæœ¬æ˜¯å¦æ”¯æŒ Docker ã€‚é€šè¿‡ uname -r å‘½ä»¤æŸ¥çœ‹ä½ å½“å‰çš„å†…æ ¸ç‰ˆæœ¬[root@runoob ~]# uname -rå®‰è£… Dockerä»Ž 2017 å¹´ 3 æœˆå¼€å§‹ docker åœ¨åŽŸæ¥çš„åŸºç¡€ä¸Šåˆ†ä¸ºä¸¤ä¸ªåˆ†æ”¯ç‰ˆæœ¬: Docker CE å’Œ Docker EEã€‚Docker CE å³ç¤¾åŒºå…è´¹ç‰ˆï¼ŒDocker EE å³ä¼ä¸šç‰ˆï¼Œå¼ºè°ƒå®‰å…¨ï¼Œä½†éœ€ä»˜è´¹ä½¿ç”¨ã€‚æœ¬æ–‡ä»‹ç» Docker CE çš„å®‰è£…ä½¿ç”¨ã€‚ç§»é™¤æ—§çš„ç‰ˆæœ¬ï¼š12345678910# yum remove docker \ docker-client \ docker-client-latest \ docker-common \ docker-latest \ docker-latest-logrotate \ docker-logrotate \ docker-selinux \ docker-engine-selinux \ docker-engineå®‰è£…ä¸€äº›å¿…è¦çš„ç³»ç»Ÿå·¥å…·ï¼š1# yum install -y yum-utils device-mapper-persistent-data lvm2æ·»åŠ è½¯ä»¶æºä¿¡æ¯ï¼š1# yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repoæ›´æ–° yum ç¼“å­˜ï¼š1# yum makecache fastå®‰è£… Docker-ceï¼š1# yum -y install docker-ceå¯åŠ¨ Docker åŽå°æœåŠ¡ï¼š1# systemctl start docker.serviceæµ‹è¯•è¿è¡Œ hello-world123456789101112131415161718192021222324252627# docker run hello-worldUnable to find image 'hello-world:latest' locallylatest: Pulling from library/hello-world1b930d010525: Pull complete Digest: sha256:6540fc08ee6e6b7b63468dc3317e3303aae178cb8a45ed3123180328bcc1d20fStatus: Downloaded newer image for hello-world:latestHello from Docker!This message shows that your installation appears to be working correctly.To generate this message, Docker took the following steps: 1. The Docker client contacted the Docker daemon. 2. The Docker daemon pulled the "hello-world" image from the Docker Hub. (amd64) 3. The Docker daemon created a new container from that image which runs the executable that produces the output you are currently reading. 4. The Docker daemon streamed that output to the Docker client, which sent it to your terminal.To try something more ambitious, you can run an Ubuntu container with: $ docker run -it ubuntu bashShare images, automate workflows, and more with a free Docker ID: https://hub.docker.com/For more examples and ideas, visit: https://docs.docker.com/get-started/ç”±äºŽæœ¬åœ°æ²¡æœ‰hello-worldè¿™ä¸ªé•œåƒï¼Œæ‰€ä»¥ä¼šä¸‹è½½ä¸€ä¸ªhello-worldçš„é•œåƒï¼Œå¹¶åœ¨å®¹å™¨å†…è¿è¡Œã€‚ä½¿ç”¨è„šæœ¬å®‰è£… Dockerä½¿ç”¨ sudo æˆ– root æƒé™ç™»å½• Centosã€‚ç¡®ä¿ yum åŒ…æ›´æ–°åˆ°æœ€æ–°ã€‚1# yum updateæ‰§è¡Œ Docker å®‰è£…è„šæœ¬ã€‚12# curl -fsSL https://get.docker.com -o get-docker.sh# sh get-docker.shæ‰§è¡Œè¿™ä¸ªè„šæœ¬ä¼šæ·»åŠ  docker.repo æºå¹¶å®‰è£… Dockerã€‚å¯åŠ¨ Docker è¿›ç¨‹ã€‚1# systemctl start docker.serviceéªŒè¯ docker æ˜¯å¦å®‰è£…æˆåŠŸå¹¶åœ¨å®¹å™¨ä¸­æ‰§è¡Œä¸€ä¸ªæµ‹è¯•çš„é•œåƒã€‚12# docker run hello-world# docker psåˆ°æ­¤ï¼ŒDocker åœ¨ CentOS ç³»ç»Ÿçš„å®‰è£…å®Œæˆã€‚é•œåƒåŠ é€Ÿé‰´äºŽå›½å†…ç½‘ç»œé—®é¢˜ï¼ŒåŽç»­æ‹‰å– Docker é•œåƒååˆ†ç¼“æ…¢ï¼Œæˆ‘ä»¬å¯ä»¥éœ€è¦é…ç½®åŠ é€Ÿå™¨æ¥è§£å†³ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯ç½‘æ˜“çš„é•œåƒåœ°å€ï¼šhttp://hub-mirror.c.163.comã€‚æ–°ç‰ˆçš„ Docker ä½¿ç”¨ /etc/docker/daemon.jsonï¼ˆLinuxï¼‰ æˆ–è€… %programdata%\docker\config\daemon.jsonï¼ˆWindowsï¼‰ æ¥é…ç½® Daemonã€‚è¯·åœ¨è¯¥é…ç½®æ–‡ä»¶ä¸­åŠ å…¥ï¼ˆæ²¡æœ‰è¯¥æ–‡ä»¶çš„è¯ï¼Œè¯·å…ˆå»ºä¸€ä¸ªï¼‰ï¼š123&#123; &quot;registry-mirrors&quot;: [&quot;http://hub-mirror.c.163.com&quot;]&#125;åˆ é™¤ Docker CEæ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆ é™¤ Docker CEï¼š12# yum remove docker-ce# rm -rf /var/lib/dockerWindows Docker å®‰è£…win7ã€win8 ç³»ç»Ÿwin7ã€win8 ç­‰éœ€è¦åˆ©ç”¨ docker toolbox æ¥å®‰è£…ï¼Œå›½å†…å¯ä»¥ä½¿ç”¨é˜¿é‡Œäº‘çš„é•œåƒæ¥ä¸‹è½½ï¼Œä¸‹è½½åœ°å€ï¼šhttp://mirrors.aliyun.com/docker-toolbox/windows/docker-toolbox/docker toolbox æ˜¯ä¸€ä¸ªå·¥å…·é›†ï¼Œå®ƒä¸»è¦åŒ…å«ä»¥ä¸‹ä¸€äº›å†…å®¹ï¼šDocker CLI å®¢æˆ·ç«¯ï¼Œç”¨æ¥è¿è¡Œdockerå¼•æ“Žåˆ›å»ºé•œåƒå’Œå®¹å™¨Docker Machine. å¯ä»¥è®©ä½ åœ¨windowsçš„å‘½ä»¤è¡Œä¸­è¿è¡Œdockerå¼•æ“Žå‘½ä»¤Docker Compose. ç”¨æ¥è¿è¡Œdocker-composeå‘½ä»¤Kitematic. è¿™æ˜¯Dockerçš„GUIç‰ˆæœ¬Docker QuickStart shell. è¿™æ˜¯ä¸€ä¸ªå·²ç»é…ç½®å¥½Dockerçš„å‘½ä»¤è¡ŒçŽ¯å¢ƒOracle VM Virtualbox. è™šæ‹Ÿæœºä¸‹è½½å®Œæˆä¹‹åŽç›´æŽ¥ç‚¹å‡»å®‰è£…ï¼Œå®‰è£…æˆåŠŸåŽï¼Œæ¡Œè¾¹ä¼šå‡ºçŽ°ä¸‰ä¸ªå›¾æ ‡ï¼Œå…¥ä¸‹å›¾æ‰€ç¤ºï¼šå¦‚æžœç³»ç»Ÿæ˜¾ç¤º User Account Control çª—å£æ¥è¿è¡Œ VirtualBox ä¿®æ”¹ä½ çš„ç”µè„‘ï¼Œé€‰æ‹© Yesã€‚$ ç¬¦å·é‚£ä½ å¯ä»¥è¾“å…¥ä»¥ä¸‹å‘½ä»¤æ¥æ‰§è¡Œ1234567891011121314151617181920212223$ docker run hello-world Unable to find image 'hello-world:latest' locally Pulling repository hello-world 91c95931e552: Download complete a8219747be10: Download complete Status: Downloaded newer image for hello-world:latest Hello from Docker. This message shows that your installation appears to be working correctly. To generate this message, Docker took the following steps: 1. The Docker Engine CLI client contacted the Docker Engine daemon. 2. The Docker Engine daemon pulled the "hello-world" image from the Docker Hub. (Assuming it was not already locally available.) 3. The Docker Engine daemon created a new container from that image which runs the executable that produces the output you are currently reading. 4. The Docker Engine daemon streamed that output to the Docker Engine CLI client, which sent it to your terminal. To try something more ambitious, you can run an Ubuntu container with: $ docker run -it ubuntu bash For more examples and ideas, visit: https://docs.docker.com/userguide/Win10 ç³»ç»ŸçŽ°åœ¨ Docker æœ‰ä¸“é—¨çš„ Win10 ä¸“ä¸šç‰ˆç³»ç»Ÿçš„å®‰è£…åŒ…ï¼Œéœ€è¦å¼€å¯Hyper-Vã€‚åº”ç”¨å’ŒåŠŸèƒ½ -&gt; ç¨‹åºå’ŒåŠŸèƒ½ -&gt; å¯ç”¨æˆ–å…³é—­WindowsåŠŸèƒ½ -&gt; é€‰ä¸­Hyper-Vå®‰è£… Toolboxæœ€æ–°ç‰ˆ Toolbox ä¸‹è½½åœ°å€ï¼š https://www.docker.com/get-dockerç‚¹å‡» Download Desktop and Take a Tutorialï¼Œå¹¶ä¸‹è½½ Windows çš„ç‰ˆæœ¬ï¼Œå¦‚æžœä½ è¿˜æ²¡æœ‰ç™»å½•ï¼Œä¼šè¦æ±‚æ³¨å†Œç™»å½•ï¼šè¿è¡Œå®‰è£…æ–‡ä»¶åŒå‡»ä¸‹è½½çš„ Docker for Windows Installer å®‰è£…æ–‡ä»¶ï¼Œä¸€è·¯ Nextï¼Œç‚¹å‡» Finish å®Œæˆå®‰è£…ã€‚å®‰è£…å®ŒæˆåŽï¼ŒDocker ä¼šè‡ªåŠ¨å¯åŠ¨ã€‚é€šçŸ¥æ ä¸Šä¼šå‡ºçŽ°ä¸ªå°é²¸é±¼çš„å›¾æ ‡ï¼Œè¿™è¡¨ç¤º Docker æ­£åœ¨è¿è¡Œã€‚æ¡Œè¾¹ä¹Ÿä¼šå‡ºçŽ°ä¸‰ä¸ªå›¾æ ‡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å‘½ä»¤è¡Œæ‰§è¡Œ docker version æ¥æŸ¥çœ‹ç‰ˆæœ¬å·ï¼Œdocker run hello-world æ¥è½½å…¥æµ‹è¯•é•œåƒæµ‹è¯•ã€‚å¦‚æžœæ²¡å¯åŠ¨ï¼Œä½ å¯ä»¥åœ¨ Windows æœç´¢ Docker æ¥å¯åŠ¨ï¼Œå¯åŠ¨åŽï¼Œä¹Ÿå¯ä»¥åœ¨é€šçŸ¥æ ä¸Šçœ‹åˆ°å°é²¸é±¼å›¾æ ‡é•œåƒåŠ é€Ÿé‰´äºŽå›½å†…ç½‘ç»œé—®é¢˜ï¼ŒåŽç»­æ‹‰å– Docker é•œåƒååˆ†ç¼“æ…¢ï¼Œæˆ‘ä»¬å¯ä»¥éœ€è¦é…ç½®åŠ é€Ÿå™¨æ¥è§£å†³ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯ç½‘æ˜“çš„é•œåƒåœ°å€ï¼šhttp://hub-mirror.c.163.comã€‚æ–°ç‰ˆçš„ Docker ä½¿ç”¨ /etc/docker/daemon.jsonï¼ˆLinuxï¼‰ æˆ–è€… %programdata%\docker\config\daemon.jsonï¼ˆWindowsï¼‰ æ¥é…ç½® Daemonã€‚è¯·åœ¨è¯¥é…ç½®æ–‡ä»¶ä¸­åŠ å…¥ï¼ˆæ²¡æœ‰è¯¥æ–‡ä»¶çš„è¯ï¼Œè¯·å…ˆå»ºä¸€ä¸ªï¼‰ï¼š123&#123; &quot;registry-mirrors&quot;: [&quot;http://hub-mirror.c.163.com&quot;]&#125;MacOS Docker å®‰è£…ä½¿ç”¨ Homebrew å®‰è£…macOS æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Homebrew æ¥å®‰è£… Dockerã€‚Homebrew çš„ Cask å·²ç»æ”¯æŒ Docker for Macï¼Œå› æ­¤å¯ä»¥å¾ˆæ–¹ä¾¿çš„ä½¿ç”¨ Homebrew Cask æ¥è¿›è¡Œå®‰è£…ï¼š123456789101112$ brew cask install docker==&gt; Creating Caskroom at /usr/local/Caskroom==&gt; We'll set permissions properly so we won't need sudo in the futurePassword: # è¾“å…¥ macOS å¯†ç ==&gt; Satisfying dependencies==&gt; Downloading https://download.docker.com/mac/stable/21090/Docker.dmg######################################################################## 100.0%==&gt; Verifying checksum for Cask docker==&gt; Installing Cask docker==&gt; Moving App 'Docker.app' to '/Applications/Docker.app'.&amp;#x1f37a; docker was successfully installed!åœ¨è½½å…¥ Docker app åŽï¼Œç‚¹å‡» Nextï¼Œå¯èƒ½ä¼šè¯¢é—®ä½ çš„ macOS ç™»é™†å¯†ç ï¼Œä½ è¾“å…¥å³å¯ã€‚ä¹‹åŽä¼šå¼¹å‡ºä¸€ä¸ª Docker è¿è¡Œçš„æç¤ºçª—å£ï¼ŒçŠ¶æ€æ ä¸Šä¹Ÿæœ‰æœ‰ä¸ªå°é²¸é±¼çš„å›¾æ ‡ã€‚æ‰‹åŠ¨ä¸‹è½½å®‰è£…å¦‚æžœéœ€è¦æ‰‹åŠ¨ä¸‹è½½ï¼Œè¯·ç‚¹å‡»ä»¥ä¸‹é“¾æŽ¥ä¸‹è½½ Stable æˆ– Edge ç‰ˆæœ¬çš„ Docker for Macã€‚å¦‚åŒ macOS å…¶å®ƒè½¯ä»¶ä¸€æ ·ï¼Œå®‰è£…ä¹Ÿéžå¸¸ç®€å•ï¼ŒåŒå‡»ä¸‹è½½çš„ .dmg æ–‡ä»¶ï¼Œç„¶åŽå°†é²¸é±¼å›¾æ ‡æ‹–æ‹½åˆ° Application æ–‡ä»¶å¤¹å³å¯ã€‚ä»Žåº”ç”¨ä¸­æ‰¾åˆ° Docker å›¾æ ‡å¹¶ç‚¹å‡»è¿è¡Œã€‚å¯èƒ½ä¼šè¯¢é—® macOS çš„ç™»é™†å¯†ç ï¼Œè¾“å…¥å³å¯ã€‚ç‚¹å‡»é¡¶éƒ¨çŠ¶æ€æ ä¸­çš„é²¸é±¼å›¾æ ‡ä¼šå¼¹å‡ºæ“ä½œèœå•ã€‚ç¬¬ä¸€æ¬¡ç‚¹å‡»å›¾æ ‡ï¼Œå¯èƒ½ä¼šçœ‹åˆ°è¿™ä¸ªå®‰è£…æˆåŠŸçš„ç•Œé¢ï¼Œç‚¹å‡» â€œGot it!â€ å¯ä»¥å…³é—­è¿™ä¸ªçª—å£ã€‚å¯åŠ¨ç»ˆç«¯åŽï¼Œé€šè¿‡å‘½ä»¤å¯ä»¥æ£€æŸ¥å®‰è£…åŽçš„ Docker ç‰ˆæœ¬ã€‚12$ docker --versionDocker version 17.09.1-ce, build 19e2cf6é•œåƒåŠ é€Ÿé‰´äºŽå›½å†…ç½‘ç»œé—®é¢˜ï¼ŒåŽç»­æ‹‰å– Docker é•œåƒååˆ†ç¼“æ…¢ï¼Œæˆ‘ä»¬å¯ä»¥éœ€è¦é…ç½®åŠ é€Ÿå™¨æ¥è§£å†³ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯ç½‘æ˜“çš„é•œåƒåœ°å€ï¼šhttp://hub-mirror.c.163.comã€‚åœ¨ä»»åŠ¡æ ç‚¹å‡» Docker for mac åº”ç”¨å›¾æ ‡ -&gt; Perferencesâ€¦ -&gt; Daemon -&gt; Registry mirrorsã€‚åœ¨åˆ—è¡¨ä¸­å¡«å†™åŠ é€Ÿå™¨åœ°å€å³å¯ã€‚ä¿®æ”¹å®Œæˆä¹‹åŽï¼Œç‚¹å‡» Apply &amp; Restart æŒ‰é’®ï¼ŒDocker å°±ä¼šé‡å¯å¹¶åº”ç”¨é…ç½®çš„é•œåƒåœ°å€äº†ã€‚ä¹‹åŽæˆ‘ä»¬å¯ä»¥é€šè¿‡ docker info æ¥æŸ¥çœ‹æ˜¯å¦é…ç½®æˆåŠŸã€‚12345$ docker info...Registry Mirrors: http://hub-mirror.c.163.comLive Restore Enabled: falseDocker ä½¿ç”¨Docker Hello WorldDocker å…è®¸ä½ åœ¨å®¹å™¨å†…è¿è¡Œåº”ç”¨ç¨‹åºï¼Œ ä½¿ç”¨ docker run å‘½ä»¤æ¥åœ¨å®¹å™¨å†…è¿è¡Œä¸€ä¸ªåº”ç”¨ç¨‹åºã€‚è¾“å‡ºHello world1234567# docker run centos /bin/echo "Hello world"Unable to find image 'centos:latest' locallylatest: Pulling from library/centos8ba884070f61: Pull complete Digest: sha256:a799dd8a2ded4a83484bbae769d97655392b3f86533ceb7dd96bbac929809f3cStatus: Downloaded newer image for centos:latestHello worldå„ä¸ªå‚æ•°è§£æžï¼šdocker: Docker çš„äºŒè¿›åˆ¶æ‰§è¡Œæ–‡ä»¶ã€‚run: ä¸Žå‰é¢çš„ docker ç»„åˆæ¥è¿è¡Œä¸€ä¸ªå®¹å™¨ã€‚ceentos æŒ‡å®šè¦è¿è¡Œçš„é•œåƒï¼ŒDockeré¦–å…ˆä»Žæœ¬åœ°ä¸»æœºä¸ŠæŸ¥æ‰¾é•œåƒæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æžœä¸å­˜åœ¨ï¼ŒDocker å°±ä¼šä»Žé•œåƒä»“åº“ Docker Hub ä¸‹è½½å…¬å…±é•œåƒã€‚/bin/echo â€œHello worldâ€: åœ¨å¯åŠ¨çš„å®¹å™¨é‡Œæ‰§è¡Œçš„å‘½ä»¤ä»¥ä¸Šå‘½ä»¤å®Œæ•´çš„æ„æ€å¯ä»¥è§£é‡Šä¸ºï¼šDocker ä»¥ centos é•œåƒåˆ›å»ºä¸€ä¸ªæ–°å®¹å™¨ï¼Œç„¶åŽåœ¨å®¹å™¨é‡Œæ‰§è¡Œ bin/echo â€œHello worldâ€ï¼Œç„¶åŽè¾“å‡ºç»“æžœã€‚æœç´¢docker hubä¸­çš„é•œåƒ1# docker search centosè¿è¡Œäº¤äº’å¼çš„å®¹å™¨æˆ‘ä»¬é€šè¿‡dockerçš„ä¸¤ä¸ªå‚æ•° -i -tï¼Œè®©dockerè¿è¡Œçš„å®¹å™¨å®žçŽ°â€å¯¹è¯â€çš„èƒ½åŠ›12[root@localhost ~]# docker run -i -t centos /bin/bash[root@f566b922be2f /]#å„ä¸ªå‚æ•°è§£æžï¼š-tï¼šåœ¨æ–°å®¹å™¨å†…æŒ‡å®šä¸€ä¸ªä¼ªç»ˆç«¯æˆ–ç»ˆç«¯ã€‚-iï¼šå…è®¸ä½ å¯¹å®¹å™¨å†…çš„æ ‡å‡†è¾“å…¥ (STDIN) è¿›è¡Œäº¤äº’ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿è¡Œexitå‘½ä»¤æˆ–è€…ä½¿ç”¨CTRL+Dæ¥é€€å‡ºå®¹å™¨ã€‚å¯åŠ¨å®¹å™¨ (åŽå°æ¨¡å¼)ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»ºä¸€ä¸ªä»¥è¿›ç¨‹æ–¹å¼è¿è¡Œçš„å®¹å™¨ï¼š12[root@localhost ~]# docker run -d centos /bin/sh -c "while true; do echo hello world; sleep 1; done"7e436b86913579f28f56b9b038e4782570b5beeb150e2e0ecd440201124814dcåœ¨è¾“å‡ºä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰çœ‹åˆ°æœŸæœ›çš„â€hello worldâ€ï¼Œè€Œæ˜¯ä¸€ä¸²é•¿å­—ç¬¦ï¼Œè¿™ä¸ªé•¿å­—ç¬¦ä¸²å«åšå®¹å™¨IDï¼Œå¯¹æ¯ä¸ªå®¹å™¨æ¥è¯´éƒ½æ˜¯å”¯ä¸€çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®¹å™¨IDæ¥æŸ¥çœ‹å¯¹åº”çš„å®¹å™¨å‘ç”Ÿäº†ä»€ä¹ˆã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç¡®è®¤å®¹å™¨æœ‰åœ¨è¿è¡Œï¼Œå¯ä»¥é€šè¿‡ docker ps æ¥æŸ¥çœ‹123[root@localhost ~]# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES7e436b869135 centos "/bin/sh -c 'while tâ€¦" 43 seconds ago Up 42 seconds competent_merkleCONTAINER IDï¼šå®¹å™¨IDNAMESï¼šè‡ªåŠ¨åˆ†é…çš„å®¹å™¨åç§°åœ¨å®¹å™¨å†…ä½¿ç”¨docker logså‘½ä»¤ï¼ŒæŸ¥çœ‹å®¹å™¨å†…çš„æ ‡å‡†è¾“å‡ºï¼š123// å¦‚ä¸‹ä¸¤ä¸ªå‘½ä»¤çš„è¾“å‡ºç»“æžœä¸€è‡´ï¼Œéƒ½æ˜¯å¥½å¤šä¸ªhello world# docker logs 7e436b869135# docker logs competent_merkleåœæ­¢å®¹å™¨æˆ‘ä»¬ä½¿ç”¨ docker stop å‘½ä»¤æ¥åœæ­¢å®¹å™¨:1# docker stop 7e436b869135é€šè¿‡docker psæŸ¥çœ‹ï¼Œå®¹å™¨å·²ç»åœæ­¢å·¥ä½œï¼š1# docker psä¹Ÿå¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥åœæ­¢ï¼š1# docker stop competent_merkleDocker å®¹å™¨ä½¿ç”¨Docker å®¢æˆ·ç«¯ç›´æŽ¥è¾“å…¥ docker å‘½ä»¤æ¥æŸ¥çœ‹åˆ° Docker å®¢æˆ·ç«¯çš„æ‰€æœ‰å‘½ä»¤é€‰é¡¹ã€‚å¯ä»¥é€šè¿‡å‘½ä»¤ docker command â€“help æ›´æ·±å…¥çš„äº†è§£æŒ‡å®šçš„ Docker å‘½ä»¤ä½¿ç”¨æ–¹æ³•ã€‚ä¾‹å¦‚æˆ‘ä»¬è¦æŸ¥çœ‹ docker stats æŒ‡ä»¤çš„å…·ä½“ä½¿ç”¨æ–¹æ³•ï¼š1234567891011[root@localhost ~]# docker stats --helpUsage: docker stats [OPTIONS] [CONTAINER...]Display a live stream of container(s) resource usage statisticsOptions: -a, --all Show all containers (default shows just running) --format string Pretty-print images using a Go template --no-stream Disable streaming stats and only pull the first result --no-trunc Do not truncate outputè¿è¡Œä¸€ä¸ªwebåº”ç”¨åœ¨dockerå®¹å™¨ä¸­è¿è¡Œä¸€ä¸ª Python Flask åº”ç”¨æ¥è¿è¡Œä¸€ä¸ªwebåº”ç”¨ã€‚1234567891011121314151617181920212223242526[root@localhost ~]# docker pull training/webapp # è½½å…¥é•œåƒUsing default tag: latestlatest: Pulling from training/webappe190868d63f8: Pulling fs layer 909cd34c6fd7: Pulling fs layer 0b9bfabab7c1: Downloading a3ed95caeb02: Waiting 10bbbc0fc0ff: Waiting fca59b508e9f: Waiting e7ae2541b15b: Waiting 9dd97ef58ce9: Waiting a4c1b0cb7af7: Waiting latest: Pulling from training/webappe190868d63f8: Pull complete 909cd34c6fd7: Pull complete 0b9bfabab7c1: Pull complete a3ed95caeb02: Pull complete 10bbbc0fc0ff: Pull complete fca59b508e9f: Pull complete e7ae2541b15b: Pull complete 9dd97ef58ce9: Pull complete a4c1b0cb7af7: Pull complete Digest: sha256:06e9c1983bd6d5db5fba376ccd63bfa529e8d02f23d5079b8f74a616308fb11dStatus: Downloaded newer image for training/webapp:latest[root@localhost ~]# docker run -d -P training/webapp python app.pyab3dc2ea803335fee98c58b9bd55a9ef01d58a4602d75ec95a8fa3a97e403f5eå‚æ•°è¯´æ˜Ž:-dï¼šè®©å®¹å™¨åœ¨åŽå°è¿è¡Œã€‚-Pï¼šå°†å®¹å™¨å†…éƒ¨ä½¿ç”¨çš„ç½‘ç»œç«¯å£æ˜ å°„åˆ°æˆ‘ä»¬ä½¿ç”¨çš„ä¸»æœºä¸Šã€‚æŸ¥çœ‹ WEB åº”ç”¨å®¹å™¨ä½¿ç”¨ docker ps æ¥æŸ¥çœ‹æˆ‘ä»¬æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼š123[root@localhost ~]# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESab3dc2ea8033 training/webapp "python app.py" About a minute ago Up About a minute 0.0.0.0:32768-&gt;5000/tcp loving_turingè¿™é‡Œå¤šäº†ç«¯å£ä¿¡æ¯ã€‚12PORTS0.0.0.0:32768-&gt;5000/tcpDocker å¼€æ”¾äº† 5000 ç«¯å£ï¼ˆé»˜è®¤ Python Flask ç«¯å£ï¼‰æ˜ å°„åˆ°ä¸»æœºç«¯å£ 32768 ä¸Šã€‚è¿™æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡æµè§ˆå™¨è®¿é—®WEBåº”ç”¨ï¼šhttp://192.168.0.130:32768ä¹Ÿå¯ä»¥é€šè¿‡ -p å‚æ•°æ¥è®¾ç½®ä¸ä¸€æ ·çš„ç«¯å£ï¼š1[root@localhost ~]# docker run -d -p 5000:5000 training/webapp python app.pydocker psæŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨1234[root@localhost ~]# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESe18b3ff3ed87 training/webapp "python app.py" 3 seconds ago Up 2 seconds 0.0.0.0:5000-&gt;5000/tcp nervous_chandrasekharab3dc2ea8033 training/webapp "python app.py" 4 minutes ago Up 4 minutes 0.0.0.0:32768-&gt;5000/tcp loving_turingå®¹å™¨å†…éƒ¨çš„ 5000 ç«¯å£æ˜ å°„åˆ°æˆ‘ä»¬æœ¬åœ°ä¸»æœºçš„ 5000 ç«¯å£ä¸Šã€‚ç½‘ç»œç«¯å£çš„å¿«æ·æ–¹å¼é€šè¿‡ docker ps å‘½ä»¤å¯ä»¥æŸ¥çœ‹åˆ°å®¹å™¨çš„ç«¯å£æ˜ å°„ï¼Œdocker è¿˜æä¾›äº†å¦ä¸€ä¸ªå¿«æ·æ–¹å¼ docker portï¼Œä½¿ç”¨ docker port å¯ä»¥æŸ¥çœ‹æŒ‡å®š ï¼ˆID æˆ–è€…åå­—ï¼‰å®¹å™¨çš„æŸä¸ªç¡®å®šç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„ç«¯å£å·ã€‚ä¸Šé¢æˆ‘ä»¬åˆ›å»ºçš„ web åº”ç”¨å®¹å™¨ ID ä¸º e18b3ff3ed87 åå­—ä¸º nervous_chandrasekharã€‚æˆ‘å¯ä»¥ä½¿ç”¨ docker port e18b3ff3ed87 æˆ– docker port nervous_chandrasekhar æ¥æŸ¥çœ‹å®¹å™¨ç«¯å£çš„æ˜ å°„æƒ…å†µã€‚1234[root@localhost ~]# docker port e18b3ff3ed875000/tcp -&gt; 0.0.0.0:5000[root@localhost ~]# docker port nervous_chandrasekhar5000/tcp -&gt; 0.0.0.0:5000æŸ¥çœ‹ WEB åº”ç”¨ç¨‹åºæ—¥å¿—docker logs [IDæˆ–è€…åå­—] å¯ä»¥æŸ¥çœ‹å®¹å™¨å†…éƒ¨çš„æ ‡å‡†è¾“å‡ºã€‚12[root@localhost ~]# docker logs -f e18b3ff3ed87 * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)-fï¼šè®© docker logs åƒä½¿ç”¨ tail -f ä¸€æ ·æ¥è¾“å‡ºå®¹å™¨å†…éƒ¨çš„æ ‡å‡†è¾“å‡ºã€‚ä»Žä¸Šé¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åº”ç”¨ç¨‹åºä½¿ç”¨çš„æ˜¯ 5000 ç«¯å£å¹¶ä¸”èƒ½å¤ŸæŸ¥çœ‹åˆ°åº”ç”¨ç¨‹åºçš„è®¿é—®æ—¥å¿—ã€‚æŸ¥çœ‹WEBåº”ç”¨ç¨‹åºå®¹å™¨çš„è¿›ç¨‹è¿˜å¯ä»¥ä½¿ç”¨ docker top æ¥æŸ¥çœ‹å®¹å™¨å†…éƒ¨è¿è¡Œçš„è¿›ç¨‹123[root@localhost ~]# docker top e18b3ff3ed87UID PID PPID C STIME TTY TIME CMDroot 21092 21074 0 04:45 ? 00:00:00 python app.pyæ£€æŸ¥ WEB åº”ç”¨ç¨‹åºä½¿ç”¨ docker inspect æ¥æŸ¥çœ‹ Docker çš„åº•å±‚ä¿¡æ¯ã€‚å®ƒä¼šè¿”å›žä¸€ä¸ª JSON æ–‡ä»¶è®°å½•ç€ Docker å®¹å™¨çš„é…ç½®å’ŒçŠ¶æ€ä¿¡æ¯ã€‚1234567891011121314151617181920212223[root@localhost ~]# docker inspect e18b3ff3ed87[ &#123; "Id": "e18b3ff3ed87fd4a5bbcb4d7d49506c8b08fea2354b3e9a735370da143a132a4", "Created": "2019-07-12T08:45:39.489607684Z", "Path": "python", "Args": [ "app.py" ], "State": &#123; "Status": "running", "Running": true, "Paused": false, "Restarting": false, "OOMKilled": false, "Dead": false, "Pid": 21092, "ExitCode": 0, "Error": "", "StartedAt": "2019-07-12T08:45:39.948487352Z", "FinishedAt": "0001-01-01T00:00:00Z" &#125;,......åœæ­¢ WEB åº”ç”¨å®¹å™¨12[root@localhost ~]# docker stop e18b3ff3ed87 e18b3ff3ed87é‡å¯WEBåº”ç”¨å®¹å™¨12[root@localhost ~]# docker start e18b3ff3ed87 e18b3ff3ed87docker ps -l æŸ¥è¯¢æœ€åŽä¸€æ¬¡åˆ›å»ºçš„å®¹å™¨ï¼š123[root@localhost ~]# docker ps -lCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESe18b3ff3ed87 training/webapp "python app.py" 8 minutes ago Up 27 seconds 0.0.0.0:5000-&gt;5000/tcp nervous_chandrasekharæ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ docker restart å‘½ä»¤æ¥é‡å¯ç§»é™¤WEBåº”ç”¨å®¹å™¨ä½¿ç”¨ docker rm å‘½ä»¤æ¥åˆ é™¤ä¸éœ€è¦çš„å®¹å™¨ï¼š12[root@localhost ~]# docker rm e18b3ff3ed87e18b3ff3ed87åˆ é™¤å®¹å™¨æ—¶ï¼Œå®¹å™¨å¿…é¡»æ˜¯åœæ­¢çŠ¶æ€ï¼Œå¦åˆ™ä¼šæŠ¥å¦‚ä¸‹é”™è¯¯ï¼š12[root@localhost ~]# docker rm ab3dc2ea8033Error response from daemon: You cannot remove a running container ab3dc2ea803335fee98c58b9bd55a9ef01d58a4602d75ec95a8fa3a97e403f5e. Stop the container before attempting removal or force removeæ‰¹é‡åˆ é™¤æ‰€æœ‰å®¹å™¨1[root@localhost ~]# docker rm `docker ps -a -q`Docker é•œåƒä½¿ç”¨å½“è¿è¡Œå®¹å™¨æ—¶ï¼Œä½¿ç”¨çš„é•œåƒå¦‚æžœåœ¨æœ¬åœ°ä¸­ä¸å­˜åœ¨ï¼Œdocker å°±ä¼šè‡ªåŠ¨ä»Ž docker é•œåƒä»“åº“ä¸­ä¸‹è½½ï¼Œé»˜è®¤æ˜¯ä»Ž Docker Hub å…¬å…±é•œåƒæºä¸‹è½½ã€‚ä¸‹é¢æˆ‘ä»¬æ¥å­¦ä¹ ï¼šç®¡ç†å’Œä½¿ç”¨æœ¬åœ° Docker ä¸»æœºé•œåƒåˆ›å»ºé•œåƒåˆ—å‡ºé•œåƒåˆ—è¡¨å¯ä»¥ä½¿ç”¨ docker images æ¥åˆ—å‡ºæœ¬åœ°ä¸»æœºä¸Šçš„é•œåƒã€‚123456[root@localhost ~]# docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEcentos latest 9f38484d220f 3 months ago 202MBhello-world latest fce289e99eb9 6 months ago 1.84kBubuntu 15.10 9b9cb95443b5 2 years ago 137MBtraining/webapp latest 6fae60ef3446 4 years ago 349MBå„ä¸ªé€‰é¡¹è¯´æ˜Ž:REPOSITORYï¼šè¡¨ç¤ºé•œåƒçš„ä»“åº“æºTAGï¼šé•œåƒçš„æ ‡ç­¾IMAGE IDï¼šé•œåƒIDCREATEDï¼šé•œåƒåˆ›å»ºæ—¶é—´SIZEï¼šé•œåƒå¤§å°åŒä¸€ä»“åº“æºå¯ä»¥æœ‰å¤šä¸ª TAGï¼Œä»£è¡¨è¿™ä¸ªä»“åº“æºçš„ä¸åŒç‰ˆæœ¬ï¼Œå¦‚ubuntuä»“åº“æºé‡Œï¼Œæœ‰15.10ã€14.04ç­‰å¤šä¸ªä¸åŒçš„ç‰ˆæœ¬ï¼Œæˆ‘ä»¬ä½¿ç”¨ REPOSITORY:TAG æ¥å®šä¹‰ä¸åŒçš„é•œåƒã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¦‚æžœè¦ä½¿ç”¨ç‰ˆæœ¬ä¸º15.10çš„ubuntuç³»ç»Ÿé•œåƒæ¥è¿è¡Œå®¹å™¨æ—¶ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š12[root@localhost ~]# docker run -t -i ubuntu:15.10 /bin/bashroot@0c8e4aa0064f:/#å¦‚æžœè¦ä½¿ç”¨ç‰ˆæœ¬ä¸º14.04çš„ubuntuç³»ç»Ÿé•œåƒæ¥è¿è¡Œå®¹å™¨æ—¶ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š12[root@localhost ~]# docker run -t -i ubuntu:14.04 /bin/bashroot@0c8e4aa0064f:/#å¦‚æžœä½ ä¸æŒ‡å®šä¸€ä¸ªé•œåƒçš„ç‰ˆæœ¬æ ‡ç­¾ï¼Œä¾‹å¦‚ä½ åªä½¿ç”¨ ubuntuï¼Œdocker å°†é»˜è®¤ä½¿ç”¨ ubuntu:latest é•œåƒã€‚èŽ·å–ä¸€ä¸ªæ–°çš„é•œåƒå½“æˆ‘ä»¬åœ¨æœ¬åœ°ä¸»æœºä¸Šä½¿ç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„é•œåƒæ—¶ Docker å°±ä¼šè‡ªåŠ¨ä¸‹è½½è¿™ä¸ªé•œåƒã€‚å¦‚æžœæˆ‘ä»¬æƒ³é¢„å…ˆä¸‹è½½è¿™ä¸ªé•œåƒï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ docker pull å‘½ä»¤æ¥ä¸‹è½½å®ƒã€‚12345678[root@localhost ~]# docker pull ubuntu:14.0414.04: Pulling from library/ubuntua7344f52cb74: Pull complete 515c9bb51536: Pull complete e1eabe0537eb: Pull complete 4701f1215c13: Pull complete Digest: sha256:2f7c79927b346e436cc14c92bd4e5bd778c3bd7037f35bc639ac1589a7acfa90Status: Downloaded newer image for ubuntu:14.04ä¸‹è½½å®ŒæˆåŽï¼Œæˆ‘ä»¬å¯ä»¥ç›´æŽ¥ä½¿ç”¨è¿™ä¸ªé•œåƒæ¥è¿è¡Œå®¹å™¨ã€‚æŸ¥æ‰¾é•œåƒå¯ä»¥ä»Ž Docker Hub ç½‘ç«™æ¥æœç´¢é•œåƒï¼ŒDocker Hub ç½‘å€ä¸ºï¼š https://hub.docker.com/ä¹Ÿå¯ä»¥ä½¿ç”¨ docker search å‘½ä»¤æ¥æœç´¢é•œåƒã€‚æ¯”å¦‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªnginxçš„é•œåƒæ¥ä½œä¸ºæˆ‘ä»¬çš„webæœåŠ¡ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ docker search å‘½ä»¤æœç´¢ nginx æ¥å¯»æ‰¾é€‚åˆæˆ‘ä»¬çš„é•œåƒã€‚123456789101112131415161718192021222324252627[root@localhost ~]# docker search nginxNAME DESCRIPTION STARS OFFICIAL AUTOMATEDnginx Official build of Nginx. 11671 [OK] jwilder/nginx-proxy Automated Nginx reverse proxy for docker conâ€¦ 1627 [OK]richarvey/nginx-php-fpm Container running Nginx + PHP-FPM capable ofâ€¦ 726 [OK]bitnami/nginx Bitnami nginx Docker Image 69 [OK]linuxserver/nginx An Nginx container, brought to you by LinuxSâ€¦ 66 tiangolo/nginx-rtmp Docker image with Nginx using the nginx-rtmpâ€¦ 48 [OK]nginx/nginx-ingress NGINX Ingress Controller for Kubernetes 20 nginxdemos/hello NGINX webserver that serves a simple page coâ€¦ 18 [OK]schmunk42/nginx-redirect A very simple container to redirect HTTP traâ€¦ 17 [OK]jlesage/nginx-proxy-manager Docker container for Nginx Proxy Manager 17 [OK]crunchgeek/nginx-pagespeed Nginx with PageSpeed + GEO IP + VTS + more_sâ€¦ 13 blacklabelops/nginx Dockerized Nginx Reverse Proxy Server. 12 [OK]centos/nginx-18-centos7 Platform for running nginx 1.8 or building nâ€¦ 11 centos/nginx-112-centos7 Platform for running nginx 1.12 or building â€¦ 9 webdevops/nginx Nginx container 8 [OK]nginxinc/nginx-unprivileged Unprivileged NGINX Dockerfiles 8 sophos/nginx-vts-exporter Simple server that scrapes Nginx vts stats aâ€¦ 5 [OK]nginx/nginx-prometheus-exporter NGINX Prometheus Exporter 4 1science/nginx Nginx Docker images that include Consul Tempâ€¦ 4 [OK]mailu/nginx Mailu nginx frontend 3 [OK]travix/nginx NGinx reverse proxy 2 [OK]pebbletech/nginx-proxy nginx-proxy sets up a container running nginâ€¦ 2 [OK]centos/nginx-110-centos7 Platform for running nginx 1.10 or building â€¦ 0 wodby/nginx Generic nginx 0 [OK]ansibleplaybookbundle/nginx-apb An APB to deploy NGINX 0 [OK]NAMEï¼šé•œåƒä»“åº“æºçš„åç§°DESCRIPTIONï¼šé•œåƒçš„æè¿°OFFICIALï¼šæ˜¯å¦dockerå®˜æ–¹å‘å¸ƒæ‹–å–é•œåƒä½¿ç”¨ä¸Šå›¾ä¸­çš„nginxå®˜æ–¹ç‰ˆæœ¬çš„é•œåƒï¼Œä½¿ç”¨å‘½ä»¤ docker pull æ¥ä¸‹è½½é•œåƒã€‚12345678[root@localhost ~]# docker pull nginx Using default tag: latestlatest: Pulling from library/nginxfc7181108d40: Pull complete d2e987ca2267: Pull complete 0b760b431b11: Pull complete Digest: sha256:48cbeee0cb0a3b5e885e36222f969e0a2f41819a68e07aeb6631ca7cb356fed1Status: Downloaded newer image for nginx:latestä¸‹è½½å®ŒæˆåŽï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªé•œåƒäº†ã€‚1[root@localhost ~]# docker run nginxåˆ›å»ºé•œåƒå½“ä»Ždockeré•œåƒä»“åº“ä¸­ä¸‹è½½çš„é•œåƒä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼å¯¹é•œåƒè¿›è¡Œæ›´æ”¹ã€‚ä»Žå·²ç»åˆ›å»ºçš„å®¹å™¨ä¸­æ›´æ–°é•œåƒï¼Œå¹¶ä¸”æäº¤è¿™ä¸ªé•œåƒä½¿ç”¨ Dockerfile æŒ‡ä»¤æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„é•œåƒæ›´æ–°é•œåƒæ›´æ–°é•œåƒä¹‹å‰ï¼Œéœ€è¦ä½¿ç”¨é•œåƒæ¥åˆ›å»ºä¸€ä¸ªå®¹å™¨ã€‚12[root@localhost ~]# docker run -t -i ubuntu:15.10 /bin/bashroot@387f1a8b1d86:/# apt-get updateåœ¨è¿è¡Œçš„å®¹å™¨å†…ä½¿ç”¨ apt-get update å‘½ä»¤è¿›è¡Œæ›´æ–°ã€‚åœ¨å®Œæˆæ“ä½œä¹‹åŽï¼Œè¾“å…¥ exitå‘½ä»¤æ¥é€€å‡ºè¿™ä¸ªå®¹å™¨ã€‚æ­¤æ—¶IDä¸º387f1a8b1d86çš„å®¹å™¨ï¼Œæ˜¯æŒ‰æˆ‘ä»¬çš„éœ€æ±‚æ›´æ”¹çš„å®¹å™¨ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å‘½ä»¤ docker commitæ¥æäº¤å®¹å™¨å‰¯æœ¬ã€‚12[root@localhost ~]# docker commit -m="update" -a="sandu" 387f1a8b1d86 sandu/ubuntu:v2sha256:02c1ed8e875ca80c6089694e486e3e0b39833b55c8252bc62bf019eb9c8b4bdeå„ä¸ªå‚æ•°è¯´æ˜Žï¼š-m:æäº¤çš„æè¿°ä¿¡æ¯-a:æŒ‡å®šé•œåƒä½œè€…387f1a8b1d86ï¼šå®¹å™¨IDsandu/ubuntu:v2:æŒ‡å®šè¦åˆ›å»ºçš„ç›®æ ‡é•œåƒåv2ï¼šè¡¨ç¤ºçš„æ˜¯TAGç„¶åŽå¯ä»¥ä½¿ç”¨ docker images å‘½ä»¤æ¥æŸ¥çœ‹æˆ‘ä»¬çš„æ–°é•œåƒ sandu/ubuntu:v2ï¼š123456789[root@localhost ~]# docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEsandu/ubuntu v2 02c1ed8e875c About a minute ago 137MBnginx latest f68d6e55e065 10 days ago 109MBubuntu 14.04 2c5e00d77a67 8 weeks ago 188MBcentos latest 9f38484d220f 3 months ago 202MBhello-world latest fce289e99eb9 6 months ago 1.84kBubuntu 15.10 9b9cb95443b5 2 years ago 137MBtraining/webapp latest 6fae60ef3446 4 years ago 349MBä½¿ç”¨æˆ‘ä»¬çš„æ–°é•œåƒ sandu/ubuntuæ¥å¯åŠ¨ä¸€ä¸ªå®¹å™¨12[root@localhost ~]# docker run -t -i sandu/ubuntu:v2 /bin/bashroot@f396a8f61f80:/#æž„å»ºé•œåƒä½¿ç”¨å‘½ä»¤ docker build ï¼Œ ä»Žé›¶å¼€å§‹æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„é•œåƒã€‚é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ª Dockerfile æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ä¸€ç»„æŒ‡ä»¤æ¥å‘Šè¯‰ Docker å¦‚ä½•æž„å»ºæˆ‘ä»¬çš„é•œåƒã€‚æ³¨æ„ï¼šè¿™é‡Œä½¿ç”¨ä¸€ä¸ªä½¿ç”¨flaskæ¡†æž¶çš„åŽå°æ¨¡æ¿ï¼ŒGitHubåœ°å€12345678910111213[root@localhost ~]# cat DockerfileFROM python:3.6ENV FLASK_APP gentelella.pyCOPY gentelella.py gunicorn.py requirements.txt config.py .env ./COPY app appCOPY migrations migrationsRUN pip install -r requirements.txtEXPOSE 5000CMD ["gunicorn", "--config", "gunicorn.py", "gentelella:app"]æ¯ä¸€ä¸ªæŒ‡ä»¤éƒ½ä¼šåœ¨é•œåƒä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„å±‚ï¼Œæ¯ä¸€ä¸ªæŒ‡ä»¤çš„å‰ç¼€éƒ½å¿…é¡»æ˜¯å¤§å†™çš„ã€‚ç¬¬ä¸€æ¡FROMï¼ŒæŒ‡å®šä½¿ç”¨å“ªä¸ªé•œåƒæºRUN æŒ‡ä»¤å‘Šè¯‰docker åœ¨é•œåƒå†…æ‰§è¡Œå‘½ä»¤ï¼Œå®‰è£…äº†ä»€ä¹ˆç„¶åŽä½¿ç”¨ Dockerfile æ–‡ä»¶ï¼Œé€šè¿‡ docker build å‘½ä»¤æ¥æž„å»ºä¸€ä¸ªé•œåƒã€‚1[root@localhost flask-gentelella-master]# docker build -t sandu/python:3.6 .å‚æ•°è¯´æ˜Žï¼š-t ï¼šæŒ‡å®šè¦åˆ›å»ºçš„ç›®æ ‡é•œåƒå. ï¼šDockerfile æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼Œå¯ä»¥æŒ‡å®šDockerfile çš„ç»å¯¹è·¯å¾„ä½¿ç”¨docker images æŸ¥çœ‹åˆ›å»ºçš„é•œåƒå·²ç»åœ¨åˆ—è¡¨ä¸­å­˜åœ¨,é•œåƒIDä¸º3fc000939e8e1234567891011[root@localhost ~]# docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEsandu/python 3.6 3fc000939e8e 7 minutes ago 1.05GBsandu/ubuntu v2 02c1ed8e875c About an hour ago 137MBpython 3.6 f93001dcf9ed 9 hours ago 924MBnginx latest f68d6e55e065 10 days ago 109MBubuntu 14.04 2c5e00d77a67 8 weeks ago 188MBcentos latest 9f38484d220f 3 months ago 202MBhello-world latest fce289e99eb9 6 months ago 1.84kBubuntu 15.10 9b9cb95443b5 2 years ago 137MBtraining/webapp latest 6fae60ef3446 4 years ago 349MBå¯ä»¥ä½¿ç”¨æ–°çš„é•œåƒæ¥åˆ›å»ºå®¹å™¨12345[root@localhost ~]# docker run -d -p 5000:5000 --name gentelella --restart always sandu/python:3.6de249d54cf992151db57c27d99b7f127bb6017b5233e2c7f97e36ebc97cae342[root@localhost ~]# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESde249d54cf99 sandu/python:3.6 "gunicorn --config gâ€¦" 5 seconds ago Up 3 seconds 0.0.0.0:5000-&gt;5000/tcp gentelellaè®¾ç½®é•œåƒæ ‡ç­¾å¯ä»¥ä½¿ç”¨ docker tag å‘½ä»¤ï¼Œä¸ºé•œåƒæ·»åŠ ä¸€ä¸ªæ–°çš„æ ‡ç­¾ã€‚docker tag é•œåƒIDï¼Œè¿™é‡Œæ˜¯ 3fc000939e8e ,ç”¨æˆ·åç§°ã€é•œåƒæºå(repository name)å’Œæ–°çš„æ ‡ç­¾å(tag)ã€‚ä½¿ç”¨ docker images å‘½ä»¤å¯ä»¥çœ‹åˆ°ï¼ŒIDä¸º3fc000939e8eçš„é•œåƒå¤šä¸€ä¸ªproæ ‡ç­¾ã€‚123456789101112131415161718192021222324[root@localhost ~]# docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEsandu/python 3.6 3fc000939e8e 16 minutes ago 1.05GBsandu/ubuntu v2 02c1ed8e875c About an hour ago 137MBpython 3.6 f93001dcf9ed 9 hours ago 924MBnginx latest f68d6e55e065 10 days ago 109MBubuntu 14.04 2c5e00d77a67 8 weeks ago 188MBcentos latest 9f38484d220f 3 months ago 202MBhello-world latest fce289e99eb9 6 months ago 1.84kBubuntu 15.10 9b9cb95443b5 2 years ago 137MBtraining/webapp latest 6fae60ef3446 4 years ago 349MB[root@localhost ~]# docker tag 3fc000939e8e sandu/python:pro[root@localhost ~]# docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEsandu/python 3.6 3fc000939e8e 17 minutes ago 1.05GBsandu/python pro 3fc000939e8e 17 minutes ago 1.05GBsandu/ubuntu v2 02c1ed8e875c About an hour ago 137MBpython 3.6 f93001dcf9ed 9 hours ago 924MBnginx latest f68d6e55e065 10 days ago 109MBubuntu 14.04 2c5e00d77a67 8 weeks ago 188MBcentos latest 9f38484d220f 3 months ago 202MBhello-world latest fce289e99eb9 6 months ago 1.84kBubuntu 15.10 9b9cb95443b5 2 years ago 137MBtraining/webapp latest 6fae60ef3446 4 years ago 349MBåˆ é™¤é•œåƒæŸ¥çœ‹æœ¬åœ°dockeré•œåƒ123456789101112[root@localhost ~]# docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEsandu/python 3.6 3fc000939e8e 2 hours ago 1.05GBsandu/python pro 3fc000939e8e 2 hours ago 1.05GBsandu/ubuntu v2 02c1ed8e875c 3 hours ago 137MBpython 3.6 f93001dcf9ed 11 hours ago 924MBnginx latest f68d6e55e065 10 days ago 109MBubuntu 14.04 2c5e00d77a67 8 weeks ago 188MBcentos latest 9f38484d220f 3 months ago 202MBhello-world latest fce289e99eb9 6 months ago 1.84kBubuntu 15.10 9b9cb95443b5 2 years ago 137MBtraining/webapp latest 6fae60ef3446 4 years ago 349MBå°è¯•åˆ é™¤æœ¬åœ°é•œåƒï¼Œå‘çŽ°æ— æ³•ç›´æŽ¥åˆ é™¤é•œåƒ12[root@localhost ~]# docker rmi training/webappError response from daemon: conflict: unable to remove repository reference "training/webapp" (must force) - container ab3dc2ea8033 is using its referenced image 6fae60ef3446åŽŸå› åˆ†æž: æœ‰å…³è”dockerå®¹å™¨ï¼Œæ— æ³•åˆ é™¤12# æŸ¥çœ‹é•œåƒå’Œå®¹å™¨çš„å…³è”ä¿¡æ¯[root@localhost ~]# docker ps -aåˆ é™¤dockerå®¹å™¨1234# å…ˆåœæ­¢å®¹å™¨ï¼Œç„¶åŽå†åˆ é™¤[root@localhost ~]# docker stop ab3dc2ea8033[root@localhost ~]# docker rm ab3dc2ea8033ab3dc2ea8033åˆ é™¤dockeré•œåƒ1234567891011121314151617[root@localhost ~]# docker rmi training/webappUntagged: training/webapp:latestUntagged: training/webapp@sha256:06e9c1983bd6d5db5fba376ccd63bfa529e8d02f23d5079b8f74a616308fb11dDeleted: sha256:6fae60ef344644649a39240b94d73b8ba9c67f898ede85cf8e947a887b3e6557Deleted: sha256:875bde2b9e2d99e7c1362993645a474fe621475c6fc1b1623c9ed5312b7bdeaeDeleted: sha256:bbdb5ee3757ef8f2633694016df5840fc3410422b37c22f98c0300e295ce75ccDeleted: sha256:d718446240e3f48a904ad4bbf2a1f61737c5d70df35b8210d674a9517cdc9803Deleted: sha256:a890440f4933412f9aafb056eb2f07f2276ed756631a81e960d4a8a6de5857a3Deleted: sha256:68a74799a9e67953725058ef21a530f100025088943446aa60c73fba7beebd47Deleted: sha256:b23e4b6b440d0e9ab4ffd7852fbf81edd6d5eb606e24d4950d83502e14af2856Deleted: sha256:f115b0453c71fb4d21fdb6f579201984bd5033ae28ed5908978576a19282418bDeleted: sha256:b0da82df3229cd06a2992449f2310caaa42f09fdfb088f4a98c5ea587ea85c7eDeleted: sha256:f6f162dad6e64715d3d07e21d4574733860a557f2f89228d07909c1f6f04e882Deleted: sha256:088f9eb16f16713e449903f7edb4016084de8234d73a45b1882cf29b1f753a5aDeleted: sha256:799115b9fdd1511e8af8a8a3c8b450d81aa842bbf3c9f88e9126d264b232c598Deleted: sha256:3549adbf614379d5c33ef0c5c6486a0d3f577ba3341f573be91b4ba1d8c60ce4Deleted: sha256:1154ba695078d29ea6c4e1adb55c463959cd77509adf09710e2315827d66271aåˆ é™¤æˆåŠŸ1234567891011[root@localhost ~]# docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEsandu/python 3.6 3fc000939e8e 2 hours ago 1.05GBsandu/python pro 3fc000939e8e 2 hours ago 1.05GBsandu/ubuntu v2 02c1ed8e875c 3 hours ago 137MBpython 3.6 f93001dcf9ed 11 hours ago 924MBnginx latest f68d6e55e065 10 days ago 109MBubuntu 14.04 2c5e00d77a67 8 weeks ago 188MBcentos latest 9f38484d220f 3 months ago 202MBhello-world latest fce289e99eb9 6 months ago 1.84kBubuntu 15.10 9b9cb95443b5 2 years ago 137MBæ‰¹é‡åˆ é™¤æ‰€æœ‰é•œåƒ1[root@localhost ~]# docker rmi `docker images -q`Docker å®¹å™¨è¿žæŽ¥ç½‘ç»œç«¯å£æ˜ å°„ä½¿ç”¨ -P å‚æ•°åˆ›å»ºä¸€ä¸ªå®¹å™¨ï¼Œä½¿ç”¨ docker ps å¯ä»¥çœ‹åˆ°å®¹å™¨ç«¯å£ 5000 ç»‘å®šä¸»æœºç«¯å£ 32770ã€‚12345[root@localhost ~]# docker run -d -P --name gentelella --restart always sandu/python:3.6f386d3fcef079f51668f583cf88e6b20b5961a62502d2a1c09c6ed17ae526617[root@localhost ~]# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESf386d3fcef07 sandu/python:3.6 "gunicorn --config gâ€¦" 5 seconds ago Up 4 seconds 0.0.0.0:32770-&gt;5000/tcp gentelellaä¹Ÿå¯ä»¥ä½¿ç”¨ -p æ ‡è¯†æ¥æŒ‡å®šå®¹å™¨ç«¯å£ç»‘å®šåˆ°ä¸»æœºç«¯å£ã€‚12345[root@localhost ~]# docker run -d -p 32768:5000 --name gentelella --restart always sandu/python:3.6 90680982825f131b6f950e3ad8543ddd51a76b07b75345376a852fe886c28754[root@localhost ~]# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES90680982825f sandu/python:3.6 "gunicorn --config gâ€¦" 4 seconds ago Up 3 seconds 0.0.0.0:32768-&gt;5000/tcp gentelellaä¸¤ç§æ–¹å¼çš„åŒºåˆ«æ˜¯:-P :æ˜¯å®¹å™¨å†…éƒ¨ç«¯å£éšæœºæ˜ å°„åˆ°ä¸»æœºçš„é«˜ç«¯å£ã€‚-p : æ˜¯å®¹å™¨å†…éƒ¨ç«¯å£ç»‘å®šåˆ°æŒ‡å®šçš„ä¸»æœºç«¯å£ã€‚(ä¸»æœºç«¯å£ï¼šå®¹å™¨å†…éƒ¨ç«¯å£)å¯ä»¥æŒ‡å®šå®¹å™¨ç»‘å®šçš„ç½‘ç»œåœ°å€ï¼Œæ¯”å¦‚ç»‘å®š 127.0.0.1ã€‚12345[root@localhost ~]# docker run -d -p 127.0.0.1:32768:5000 --name gentelella --restart always sandu/python:3.6f4ff4bc6239e944b0683dd9c81f8af78793e69f02ace5ef3a251ee88cd296d93[root@localhost ~]# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESf4ff4bc6239e sandu/python:3.6 "gunicorn --config gâ€¦" 4 seconds ago Up 3 seconds 127.0.0.1:32768-&gt;5000/tcp gentelellaè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è®¿é—® 127.0.0.1:32768 æ¥è®¿é—®å®¹å™¨çš„ 5000 ç«¯å£ã€‚12345# åœæ­¢å¹¶åˆ é™¤å®¹å™¨[root@localhost ~]# docker stop gentelellagentelella[root@localhost ~]# docker rm gentelellagentelellaé»˜è®¤éƒ½æ˜¯ç»‘å®š tcp ç«¯å£ï¼Œå¦‚æžœè¦ç»‘å®š UDP ç«¯å£ï¼Œå¯ä»¥åœ¨ç«¯å£åŽé¢åŠ ä¸Š /udpã€‚12345[root@localhost ~]# docker run -d -p 127.0.0.1:32768:5000/udp --name gentelella --restart always sandu/python:3.617683315e22f1c9c611fea955bd2824a6d324ee2d5f8647a9f5811f73339b1b1[root@localhost ~]# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES17683315e22f sandu/python:3.6 "gunicorn --config gâ€¦" 4 seconds ago Up 3 seconds 5000/tcp, 127.0.0.1:32768-&gt;5000/udp gentelelladocker port å‘½ä»¤å¯ä»¥è®©æˆ‘ä»¬å¿«æ·åœ°æŸ¥çœ‹ç«¯å£çš„ç»‘å®šæƒ…å†µã€‚12345# é»˜è®¤æ˜¯tcpç«¯å£ï¼ŒæŸ¥çœ‹udpç«¯å£çš„è¯éœ€è¦åœ¨æœ€åŽåŠ ä¸Š/udp[root@localhost ~]# docker port gentelella 5000Error: No public port '5000/tcp' published for gentelella[root@localhost ~]# docker port gentelella 5000/udp127.0.0.1:32768Dockerå®¹å™¨è¿žæŽ¥ç«¯å£æ˜ å°„å¹¶ä¸æ˜¯å”¯ä¸€æŠŠ docker è¿žæŽ¥åˆ°å¦ä¸€ä¸ªå®¹å™¨çš„æ–¹æ³•ã€‚docker æœ‰ä¸€ä¸ªè¿žæŽ¥ç³»ç»Ÿå…è®¸å°†å¤šä¸ªå®¹å™¨è¿žæŽ¥åœ¨ä¸€èµ·ï¼Œå…±äº«è¿žæŽ¥ä¿¡æ¯ã€‚docker è¿žæŽ¥ä¼šåˆ›å»ºä¸€ä¸ªçˆ¶å­å…³ç³»ï¼Œå…¶ä¸­çˆ¶å®¹å™¨å¯ä»¥çœ‹åˆ°å­å®¹å™¨çš„ä¿¡æ¯ã€‚å®¹å™¨å‘½åå½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå®¹å™¨çš„æ—¶å€™ï¼Œdocker ä¼šè‡ªåŠ¨å¯¹å®ƒè¿›è¡Œå‘½åã€‚å¦å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ â€“name æ ‡è¯†æ¥å‘½åå®¹å™¨ï¼Œä¾‹å¦‚ï¼š12[root@localhost ~]# docker run -d -p 127.0.0.1:32768:5000 --name gentelella --restart always sandu/python:3.6f4ff4bc6239e944b0683dd9c81f8af78793e69f02ace5ef3a251ee88cd296d93å¯ä»¥ä½¿ç”¨ docker ps å‘½ä»¤æ¥æŸ¥çœ‹å®¹å™¨åç§°ã€‚123[root@localhost ~]# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESf4ff4bc6239e sandu/python:3.6 "gunicorn --config gâ€¦" 4 seconds ago Up 3 seconds 127.0.0.1:32768-&gt;5000/tcp gentelellaDockerå®žä¾‹Docker å®‰è£… Nginxdocker pull nginx å‘½ä»¤å®‰è£…æŸ¥æ‰¾ Docker Hub ä¸Šçš„ nginx é•œåƒ1234567[root@localhost ~]# docker search nginxNAME DESCRIPTION STARS OFFICIAL AUTOMATEDnginx Official build of Nginx. 11676 [OK] jwilder/nginx-proxy Automated Nginx reverse proxy for docker conâ€¦ 1627 [OK]richarvey/nginx-php-fpm Container running Nginx + PHP-FPM capable ofâ€¦ 726 [OK]bitnami/nginx Bitnami nginx Docker Image 69 [OK]......æ‹‰å–å®˜æ–¹çš„é•œåƒ12345[root@localhost ~]# docker pull nginxUsing default tag: latestlatest: Pulling from library/nginxDigest: sha256:48cbeee0cb0a3b5e885e36222f969e0a2f41819a68e07aeb6631ca7cb356fed1Status: Image is up to date for nginx:latestç­‰å¾…ä¸‹è½½å®ŒæˆåŽï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æœ¬åœ°é•œåƒåˆ—è¡¨é‡ŒæŸ¥åˆ° REPOSITORY ä¸º nginx çš„é•œåƒã€‚123[root@localhost ~]# docker images nginxREPOSITORY TAG IMAGE ID CREATED SIZEnginx latest f68d6e55e065 10 days ago 109MBä»¥ä¸‹å‘½ä»¤ä½¿ç”¨ NGINX é»˜è®¤çš„é…ç½®æ¥å¯åŠ¨ä¸€ä¸ª Nginx å®¹å™¨å®žä¾‹ï¼š12[root@localhost ~]# docker run --name test_docker_nginx -p 8081:80 -d nginxc30cd0d51b31eaf3999ceee9724c269858e80417e8f0f03049127886f9b38134å‚æ•°è§£æžï¼štest_docker_nginxï¼šå®¹å™¨åç§°-dï¼šè®¾ç½®å®¹å™¨åœ¨åŽå°ä¸€ç›´è¿è¡Œ-pï¼šç«¯å£è¿›è¡Œæ˜ å°„ï¼Œå°†æœ¬åœ°çš„8081ç«¯å£æ˜ å°„åˆ°å®¹å™¨å†…éƒ¨çš„80ç«¯å£æ‰§è¡Œä»¥ä¸Šå‘½ä»¤ä¼šç”Ÿæˆä¸€ä¸²å­—ç¬¦ä¸²ï¼Œç±»ä¼¼c30cd0d51b31eaf3999ceee9724c269858e80417e8f0f03049127886f9b38134**ï¼Œè¿™ä¸ªè¡¨ç¤ºå®¹å™¨çš„ IDï¼Œä¸€èˆ¬å¯ä½œä¸ºæ—¥å¿—çš„æ–‡ä»¶åã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ docker ps å‘½ä»¤æŸ¥çœ‹å®¹å™¨æ˜¯å¦æœ‰åœ¨è¿è¡Œï¼š123[root@localhost ~]# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESc30cd0d51b31 nginx "nginx -g 'daemon ofâ€¦" 4 seconds ago Up 3 seconds 0.0.0.0:8081-&gt;80/tcp test_docker_nginxPORTS éƒ¨åˆ†è¡¨ç¤ºç«¯å£æ˜ å°„ï¼Œæœ¬åœ°çš„ 8081 ç«¯å£æ˜ å°„åˆ°å®¹å™¨å†…éƒ¨çš„ 80 ç«¯å£ã€‚åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ http://127.0.0.1:8081/ , æ•ˆæžœå¦‚ä¸‹ï¼šnginx éƒ¨ç½²é¦–å…ˆï¼Œåˆ›å»ºç›®å½• nginx, ç”¨äºŽå­˜æ”¾åŽé¢çš„ç›¸å…³ä¸œè¥¿ã€‚123456[root@localhost ~]# mkdir -p /home/nginx/www /home/nginx/logs /home/nginx/conf[root@localhost ~]# cd /home/[root@localhost home]# lltotal 4drwxr-xr-x. 6 root root 4096 Jul 12 05:55 flask-gentelella-masterdrwxr-xr-x. 5 root root 41 Jul 12 07:47 nginxæ‹·è´å®¹å™¨å†… Nginx é»˜è®¤é…ç½®æ–‡ä»¶åˆ°æœ¬åœ°å½“å‰ç›®å½•ä¸‹çš„ conf ç›®å½•ï¼Œå®¹å™¨ ID å¯ä»¥æŸ¥çœ‹ docker ps å‘½ä»¤è¾“å…¥ä¸­çš„ç¬¬ä¸€åˆ—ï¼š1234[root@localhost ~]# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESc30cd0d51b31 nginx "nginx -g 'daemon ofâ€¦" 4 seconds ago Up 3 seconds 0.0.0.0:8081-&gt;80/tcp test_docker_nginx[root@localhost home]# docker cp c30cd0d51b31:/etc/nginx/nginx.conf /home/nginx/conf/éƒ¨ç½²å‘½ä»¤12345[root@localhost home]# docker run -d -p 8081:80 --name test_docker_nginx_web -v /home/nginx/www:/usr/share/nginx/html -v /home/nginx/conf/nginx.conf:/etc/nginx/nginx.conf -v /home/nginx/logs:/var/log/nginx nginx9c2fdc3888538ada9d904c0832c39487269185fea3bc9e0179326ccb7753bb98[root@localhost home]# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES9c2fdc388853 nginx "nginx -g 'daemon ofâ€¦" 3 seconds ago Up 2 seconds 0.0.0.0:8081-&gt;80/tcp test_docker_nginx_webå‘½ä»¤è¯´æ˜Žï¼š-p 8081:80ï¼š å°†å®¹å™¨çš„ 80 ç«¯å£æ˜ å°„åˆ°ä¸»æœºçš„ 8081 ç«¯å£ã€‚â€“name test_docker_nginx_webï¼šå°†å®¹å™¨å‘½åä¸ºtest_docker_nginx_webã€‚-v /home/nginx/www:/usr/share/nginx/htmlï¼šå°†æˆ‘ä»¬è‡ªå·±åˆ›å»ºçš„ www ç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„ /usr/share/nginx/htmlã€‚-v /home/nginx/conf/nginx.conf:/etc/nginx/nginx.confï¼šå°†æˆ‘ä»¬è‡ªå·±åˆ›å»ºçš„ nginx.conf æŒ‚è½½åˆ°å®¹å™¨çš„ /etc/nginx/nginx.confã€‚-v /home/nginx/logs:/var/log/nginxï¼šå°†æˆ‘ä»¬è‡ªå·±åˆ›å»ºçš„ logs æŒ‚è½½åˆ°å®¹å™¨çš„ /var/log/nginxã€‚å¯åŠ¨ä»¥ä¸Šå‘½ä»¤åŽè¿›å…¥ /home/nginx/www ç›®å½•ï¼Œåˆ›å»º index.html æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š1234567891011&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;meta charset="utf-8"&gt;&lt;title&gt;Dockeræ•™ç¨‹&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;h1&gt;æˆ‘çš„ç¬¬ä¸€ä¸ªæ ‡é¢˜&lt;/h1&gt; &lt;p&gt;æˆ‘çš„ç¬¬ä¸€ä¸ªæ®µè½ã€‚&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;ä½¿ç”¨æµè§ˆå™¨è®¿é—®ï¼Œè¾“å‡ºç»“æžœå¦‚ä¸‹ï¼šç›¸å…³å‘½ä»¤é‡æ–°è½½å…¥ NGINX å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å‘é€ HUP ä¿¡å·åˆ°å®¹å™¨ï¼š123# docker kill -s HUP container-name[root@localhost www]# docker kill -s HUP test_docker_nginx_webtest_docker_nginx_webé‡å¯ NGINX å®¹å™¨å‘½ä»¤ï¼š123# docker restart container-name[root@localhost www]# docker restart test_docker_nginx_webtest_docker_nginx_webDocker å®‰è£… PHPå®‰è£… PHP é•œåƒæ–¹æ³•ä¸€ã€docker pull phpæŸ¥æ‰¾Docker Hubä¸Šçš„phpé•œåƒ1234567[root@localhost www]# docker search phpNAME DESCRIPTION STARS OFFICIAL AUTOMATEDphp While designed for web development, the PHP â€¦ 4607 [OK] phpmyadmin/phpmyadmin A web interface for MySQL and MariaDB. 816 [OK]php-zendserver Zend Server - the integrated PHP applicationâ€¦ 168 [OK] webdevops/php-nginx Nginx with PHP-FPM 132 [OK]webdevops/php-apache-dev PHP with Apache for Development (eg. with xdâ€¦ 105 [OK]æ‹‰å–å®˜æ–¹çš„é•œåƒ,æ ‡ç­¾ä¸º5.6-fpm1234567891011121314[root@localhost ~]# docker pull php:5.6-fpm5.6-fpm: Pulling from library/php5e6ec7f28fb7: Pull complete cf165947b5b7: Pull complete 7bd37682846d: Pull complete 99daf8e838e1: Pull complete f8628c9f032f: Pull complete 50ff925cdfa2: Pull complete 6ab76f312877: Pull complete 28ea94b4dd82: Pull complete a6dbb35d45d2: Pull complete 98b901ec9e8d: Pull complete Digest: sha256:4f070f1b7b93cc5ab364839b79a5b26f38d5f89461f7bc0cd4bab4a3ad7d67d7Status: Downloaded newer image for php:5.6-fpmç­‰å¾…ä¸‹è½½å®ŒæˆåŽï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æœ¬åœ°é•œåƒåˆ—è¡¨é‡ŒæŸ¥åˆ°REPOSITORYä¸ºphp,æ ‡ç­¾ä¸º5.6-fpmçš„é•œåƒã€‚123456789101112[root@localhost ~]# docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEsandu/python 3.6 3fc000939e8e 2 hours ago 1.05GBsandu/python pro 3fc000939e8e 2 hours ago 1.05GBsandu/ubuntu v2 02c1ed8e875c 3 hours ago 137MBpython 3.6 f93001dcf9ed 11 hours ago 924MBnginx latest f68d6e55e065 10 days ago 109MBubuntu 14.04 2c5e00d77a67 8 weeks ago 188MBcentos latest 9f38484d220f 3 months ago 202MBphp 5.6-fpm 3458979c7744 5 months ago 344MBhello-world latest fce289e99eb9 6 months ago 1.84kBubuntu 15.10 9b9cb95443b5 2 years ago 137MBNginx + PHP éƒ¨ç½²å¯åŠ¨ PHPï¼š12[root@localhost ~]# docker run --name test_docker_php -v /home/nginx/www/:/www:ro -d php:5.6-fpmdea92165f3271ed8a0651fdd6ef1738f321b462a2cba0cd2eee9e3885a315325å‘½ä»¤è¯´æ˜Žï¼šâ€“name test_docker_php : å°†å®¹å™¨å‘½åä¸ºtest_docker_phpã€‚-v /home/nginx/www:/www : å°†ä¸»æœºä¸­é¡¹ç›®çš„ç›®å½• www æŒ‚è½½åˆ°å®¹å™¨çš„ /wwwï¼Œro è¡¨ç¤ºåªè¯»åˆ›å»º /home/nginx/conf/conf.d ç›®å½•ï¼š[root@localhost ~]# mkdir -p /home/nginx/conf/conf.dåœ¨è¯¥ç›®å½•ä¸‹æ·»åŠ  /home/nginx/conf/conf.d/test_docker_php.conf æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š123456789101112131415161718192021server &#123; listen 80; server_name localhost; location / &#123; root /usr/share/nginx/html; index index.html index.htm index.php; &#125; error_page 500 502 503 504 /50x.html; location = /50x.html &#123; root /usr/share/nginx/html; &#125; location ~ \.php$ &#123; fastcgi_pass php:9000; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME /www/$fastcgi_script_name; include fastcgi_params; &#125;&#125;é…ç½®æ–‡ä»¶è¯´æ˜Žï¼šphp:9000: è¡¨ç¤º php-fpm æœåŠ¡çš„ URLã€‚/www/: æ˜¯ test_docker_phpä¸­ php æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„ï¼Œæ˜ å°„åˆ°æœ¬åœ°çš„ /home/nginx/www ç›®å½•ã€‚å¯åŠ¨ Nginx ï¼š12[root@localhost conf.d]# docker run -d -p 8081:80 --name test_docker_nginx_web -v /home/nginx/www:/usr/share/nginx/html:ro -v /home/nginx/conf/nginx.conf:/etc/nginx/nginx.conf:ro -v /home/nginx/conf/conf.d:/etc/nginx/conf.d:ro -v /home/nginx/logs:/var/log/nginx --link test_docker_php:php nginx4737055f929d939b1201b1c215b011f2673e65e6bc2e769190cfee95ffb1458cå‘½ä»¤è¯´æ˜Žï¼š-p 8081:80: ç«¯å£æ˜ å°„ï¼ŒæŠŠ nginx ä¸­çš„ 80 æ˜ å°„åˆ°æœ¬åœ°çš„ 8083 ç«¯å£ã€‚/home/nginx/www: æ˜¯æœ¬åœ° html æ–‡ä»¶çš„å­˜å‚¨ç›®å½•ï¼Œ/usr/share/nginx/html æ˜¯å®¹å™¨å†… html æ–‡ä»¶çš„å­˜å‚¨ç›®å½•ã€‚/home/nginx/conf/conf.d: æ˜¯æœ¬åœ° nginx é…ç½®æ–‡ä»¶çš„å­˜å‚¨ç›®å½•ï¼Œ/etc/nginx/conf.d æ˜¯å®¹å™¨å†… nginx é…ç½®æ–‡ä»¶çš„å­˜å‚¨ç›®å½•ã€‚â€“link test_docker_php:php: æŠŠ test_docker_php çš„ç½‘ç»œå¹¶å…¥ nginxï¼Œå¹¶é€šè¿‡ä¿®æ”¹ nginx çš„ /etc/hostsï¼ŒæŠŠåŸŸå php æ˜ å°„æˆ 127.0.0.1ï¼Œè®© nginx é€šè¿‡ php:9000 è®¿é—® php-fpmã€‚æŽ¥ä¸‹æ¥æˆ‘ä»¬åœ¨ /home/nginx/www ç›®å½•ä¸‹åˆ›å»º index.phpï¼Œä»£ç å¦‚ä¸‹ï¼š123&lt;?php echo phpinfo();?&gt;æµè§ˆå™¨æ‰“å¼€ http://ip:8081/index.php ï¼Œæ˜¾ç¤ºå¦‚ä¸‹ï¼šè¦ç‚¹æ€»ç»“phpå®¹å™¨è·¯å¾„æ˜¯/wwwï¼Œå¯¹åº”æœ¬æœºçš„webç›®å½•/home/nginx/www/nginxå®¹å™¨webè·¯å¾„æ˜¯/usr/share/nginx/htmlï¼Œå¯¹åº”æœ¬æœºwebç›®å½•/home/nginx/www/nginxå®¹å™¨é…ç½®æ–‡ä»¶/etc/nginx/nginx.confï¼Œå¯¹åº”æœ¬æœº/home/nginx/conf/nginx.confnginxå®¹å™¨é…ç½®æ–‡ä»¶/etc/nginx/conf.dè·¯å¾„ï¼Œå¯¹åº”æœ¬æœº/home/nginx/conf/conf.dè·¯å¾„è¿è¡Œphpå®¹å™¨æ—¶éœ€è¦æŠŠphpå®¹å™¨è·¯å¾„è·Ÿæœ¬æœºwebè·¯å¾„åšæ˜ å°„è¿è¡Œnginxå®¹å™¨æ—¶éœ€è¦æŠŠnginxå®¹å™¨ç›¸å…³çš„è·¯å¾„è·Ÿæœ¬æœºè·¯å¾„åšæ˜ å°„nginxå®¹å™¨å…³è”æœ‰phpå®¹æ˜“ï¼Œæ‰€ä»¥å…ˆå¯åŠ¨phpå®¹å™¨ï¼Œç„¶åŽå†å¯åŠ¨nginxå®¹å™¨ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼š12345678910111213# å…ˆå¯åŠ¨phpå®¹å™¨ï¼Œç„¶åŽå†å¯åŠ¨nginxå®¹å™¨[root@localhost ~]# docker ps -aCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESff21bd0345f4 mysql:5.6 "docker-entrypoint.sâ€¦" 2 days ago Exited (255) 30 seconds ago 0.0.0.0:3306-&gt;3306/tcp test_docker_mysql4737055f929d nginx "nginx -g 'daemon ofâ€¦" 2 days ago Exited (255) 30 seconds ago 0.0.0.0:8081-&gt;80/tcp test_docker_nginx_webb4901afbf62e php:5.6-fpm "docker-php-entrypoiâ€¦" 2 days ago Exited (255) 30 seconds ago 9000/tcp test_docker_php[root@localhost ~]# docker start 4737055f929dError response from daemon: Cannot link to a non running container: /test_docker_php AS /test_docker_nginx_web/phpError: failed to start containers: 4737055f929d[root@localhost ~]# docker start b4901afbf62eb4901afbf62e[root@localhost ~]# docker start 4737055f929d4737055f929dç›¸äº’å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šDocker å®‰è£… MySQLå®‰è£…æ–¹æ³•æ–¹æ³•ä¸€ã€docker pull mysqlæŸ¥æ‰¾Docker Hubä¸Šçš„mysqlé•œåƒ1234567[root@localhost ~]# docker search mysqlNAME DESCRIPTION STARS OFFICIAL AUTOMATEDmysql MySQL is a widely used, open-source relationâ€¦ 8385 [OK] mariadb MariaDB is a community-developed fork of MySâ€¦ 2882 [OK] mysql/mysql-server Optimized MySQL Server Docker images. Createâ€¦ 624 [OK]percona Percona Server is a fork of the MySQL relatiâ€¦ 438 [OK] centurylink/mysql Image containing mysql. Optimized to be linkâ€¦ 60 [OK]æ‹‰å–å®˜æ–¹çš„é•œåƒ,æ ‡ç­¾ä¸º5.61[root@localhost ~]# docker pull mysql:5.6ç­‰å¾…ä¸‹è½½å®ŒæˆåŽï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æœ¬åœ°é•œåƒåˆ—è¡¨é‡ŒæŸ¥åˆ°REPOSITORYä¸ºmysql,æ ‡ç­¾ä¸º5.6çš„é•œåƒã€‚12[root@localhost ~]# docker images | grep mysqlmysql 5.6 3ed1080b793f 4 weeks ago 256MBæ–¹æ³•äºŒã€é€šè¿‡ Dockerfileæž„å»ºé¦–å…ˆï¼Œåˆ›å»ºç›®å½•mysql,ç”¨äºŽå­˜æ”¾åŽé¢çš„ç›¸å…³ä¸œè¥¿ã€‚1[root@localhost ~]# mkdir -p ~/mysql/data ~/mysql/logs ~/mysql/confå‘½ä»¤è¯´æ˜Žï¼šdataç›®å½•å°†æ˜ å°„ä¸ºmysqlå®¹å™¨é…ç½®çš„æ•°æ®æ–‡ä»¶å­˜æ”¾è·¯å¾„logsç›®å½•å°†æ˜ å°„ä¸ºmysqlå®¹å™¨çš„æ—¥å¿—ç›®å½•confç›®å½•é‡Œçš„é…ç½®æ–‡ä»¶å°†æ˜ å°„ä¸ºmysqlå®¹å™¨çš„é…ç½®æ–‡ä»¶è¿›å…¥åˆ›å»ºçš„mysqlç›®å½•ï¼Œåˆ›å»ºDockerfileï¼Œè¿™ä¸ªæ˜¯ä»¥Ubuntuç³»ç»Ÿä¸ºå‚è€ƒï¼ŒCentOSç³»ç»Ÿä½¿ç”¨çš„è¯éœ€è¦ä¿®æ”¹12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364FROM debian:jessie# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get addedRUN groupadd -r mysql &amp;&amp; useradd -r -g mysql mysql# add gosu for easy step-down from rootENV GOSU_VERSION 1.7RUN set -x \ &amp;&amp; apt-get update &amp;&amp; apt-get install -y --no-install-recommends ca-certificates wget &amp;&amp; rm -rf /var/lib/apt/lists/* \ &amp;&amp; wget -O /usr/local/bin/gosu "https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$(dpkg --print-architecture)" \ &amp;&amp; wget -O /usr/local/bin/gosu.asc "https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$(dpkg --print-architecture).asc" \ &amp;&amp; export GNUPGHOME="$(mktemp -d)" \ &amp;&amp; gpg --keyserver ha.pool.sks-keyservers.net --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4 \ &amp;&amp; gpg --batch --verify /usr/local/bin/gosu.asc /usr/local/bin/gosu \ &amp;&amp; rm -r "$GNUPGHOME" /usr/local/bin/gosu.asc \ &amp;&amp; chmod +x /usr/local/bin/gosu \ &amp;&amp; gosu nobody true \ &amp;&amp; apt-get purge -y --auto-remove ca-certificates wgetRUN mkdir /docker-entrypoint-initdb.d# FATAL ERROR: please install the following Perl modules before executing /usr/local/mysql/scripts/mysql_install_db:# File::Basename# File::Copy# Sys::Hostname# Data::DumperRUN apt-get update &amp;&amp; apt-get install -y perl pwgen --no-install-recommends &amp;&amp; rm -rf /var/lib/apt/lists/*# gpg: key 5072E1F5: public key "MySQL Release Engineering &lt;mysql-build@oss.oracle.com&gt;" importedRUN apt-key adv --keyserver ha.pool.sks-keyservers.net --recv-keys A4A9406876FCBD3C456770C88C718D3B5072E1F5ENV MYSQL_MAJOR 5.6ENV MYSQL_VERSION 5.6.31-1debian8RUN echo "deb http://repo.mysql.com/apt/debian/ jessie mysql-$&#123;MYSQL_MAJOR&#125;" &gt; /etc/apt/sources.list.d/mysql.list# the "/var/lib/mysql" stuff here is because the mysql-server postinst doesn't have an explicit way to disable the mysql_install_db codepath besides having a database already "configured" (ie, stuff in /var/lib/mysql/mysql)# also, we set debconf keys to make APT a little quieterRUN &#123; \ echo mysql-community-server mysql-community-server/data-dir select ''; \ echo mysql-community-server mysql-community-server/root-pass password ''; \ echo mysql-community-server mysql-community-server/re-root-pass password ''; \ echo mysql-community-server mysql-community-server/remove-test-db select false; \ &#125; | debconf-set-selections \ &amp;&amp; apt-get update &amp;&amp; apt-get install -y mysql-server="$&#123;MYSQL_VERSION&#125;" &amp;&amp; rm -rf /var/lib/apt/lists/* \ &amp;&amp; rm -rf /var/lib/mysql &amp;&amp; mkdir -p /var/lib/mysql /var/run/mysqld \ &amp;&amp; chown -R mysql:mysql /var/lib/mysql /var/run/mysqld \# ensure that /var/run/mysqld (used for socket and lock files) is writable regardless of the UID our mysqld instance ends up having at runtime &amp;&amp; chmod 777 /var/run/mysqld# comment out a few problematic configuration values# don't reverse lookup hostnames, they are usually another containerRUN sed -Ei 's/^(bind-address|log)/#&amp;/' /etc/mysql/my.cnf \ &amp;&amp; echo 'skip-host-cache\nskip-name-resolve' | awk '&#123; print &#125; $1 == "[mysqld]" &amp;&amp; c == 0 &#123; c = 1; system("cat") &#125;' /etc/mysql/my.cnf &gt; /tmp/my.cnf \ &amp;&amp; mv /tmp/my.cnf /etc/mysql/my.cnfVOLUME /var/lib/mysqlCOPY docker-entrypoint.sh /usr/local/bin/RUN ln -s usr/local/bin/docker-entrypoint.sh /entrypoint.sh # backwards compatENTRYPOINT ["docker-entrypoint.sh"]EXPOSE 3306CMD ["mysqld"]é€šè¿‡Dockerfileåˆ›å»ºä¸€ä¸ªé•œåƒï¼Œæ›¿æ¢æˆä½ è‡ªå·±çš„åå­—1[root@localhost ~]# docker build -t mysql .åˆ›å»ºå®ŒæˆåŽï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœ¬åœ°çš„é•œåƒåˆ—è¡¨é‡ŒæŸ¥æ‰¾åˆ°åˆšåˆšåˆ›å»ºçš„é•œåƒ12[root@localhost ~]# docker images |grep mysqlmysql 5.6 2c0964ec182a 3 minutes ago 329 MBä½¿ç”¨mysqlé•œåƒè¿è¡Œå®¹å™¨12345# å¦‚ä¸‹è¿™ä¸ªå‘½ä»¤æ˜¯ä½¿ç”¨æœ¬åœ°ç›®å½•è·ŸMySQLé•œåƒç›®å½•æƒ³åŒ¹é…çš„ï¼Œä½¿ç”¨å®˜æ–¹MySQLé•œåƒå¯ä»¥ç›´æŽ¥ä½¿ç”¨ï¼Œè‹¥æ˜¯ä½¿ç”¨ä¸Šè¿°è‡ªå®šçš„çš„dockfileåˆ›å»ºçˆ±ä½ çš„MySQLé•œåƒï¼Œéœ€è¦æŠŠè·¯å¾„æ¢æˆå®žé™…åˆ›å»ºæ—¶ä½¿ç”¨çš„è·¯å¾„[root@localhost home]# mkdir mysql[root@localhost home]# cd mysql[root@localhost mysql]# docker run -p 3306:3306 --name test_docker_mysql -v $PWD/conf:/etc/mysql/conf.d -v $PWD/logs:/logs -v $PWD/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.6ff21bd0345f43b46e148f40ecbcc129683bccfd7fbd5fe9778332e12ffc49ed6å‘½ä»¤è¯´æ˜Žï¼š-p 3306:3306ï¼šå°†å®¹å™¨çš„ 3306 ç«¯å£æ˜ å°„åˆ°ä¸»æœºçš„ 3306 ç«¯å£ã€‚-v -v $PWD/conf:/etc/mysql/conf.dï¼šå°†ä¸»æœºå½“å‰ç›®å½•ä¸‹çš„ conf/my.cnf æŒ‚è½½åˆ°å®¹å™¨çš„ /etc/mysql/my.cnfã€‚-v $PWD/logs:/logsï¼šå°†ä¸»æœºå½“å‰ç›®å½•ä¸‹çš„ logs ç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„ /logsã€‚-v $PWD/data:/var/lib/mysql ï¼šå°†ä¸»æœºå½“å‰ç›®å½•ä¸‹çš„dataç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„ /var/lib/mysql ã€‚-e MYSQL_ROOT_PASSWORD=123456ï¼šåˆå§‹åŒ– root ç”¨æˆ·çš„å¯†ç ã€‚æŸ¥çœ‹å®¹å™¨å¯åŠ¨æƒ…å†µ123456789101112131415161718192021222324# æŸ¥çœ‹å½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼Œå‘çŽ°æ²¡æœ‰MySQLå®¹å™¨[root@localhost mysql]# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES4737055f929d nginx "nginx -g 'daemon ofâ€¦" 37 minutes ago Up 37 minutes 0.0.0.0:8081-&gt;80/tcp test_docker_nginx_webb4901afbf62e php:5.6-fpm "docker-php-entrypoiâ€¦" About an hour ago Up About an hour 9000/tcp test_docker_php# å†æ¬¡è¿è¡ŒMySQLå®¹å™¨ï¼ŒæŠ¥é”™ï¼Œè¯´æ˜¯å®¹å™¨åå·²ç»å­˜åœ¨[root@localhost mysql]# docker run -p 3306:3306 --name test_docker_mysql -v $PWD/conf:/etc/mysql/conf.d -v $PWD/logs:/logs -v $PWD/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.6docker: Error response from daemon: Conflict. The container name "/test_docker_mysql" is already in use by container "ff21bd0345f43b46e148f40ecbcc129683bccfd7fbd5fe9778332e12ffc49ed6". You have to remove (or rename) that container to be able to reuse that name.See 'docker run --help'.# æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼Œå‘çŽ°æœ‰MySQLå®¹å™¨ï¼ŒçŠ¶æ€æ˜¯Exited[root@localhost mysql]# docker ps -aCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESff21bd0345f4 mysql:5.6 "docker-entrypoint.sâ€¦" 2 minutes ago Exited (1) About a minute ago test_docker_mysql4737055f929d nginx "nginx -g 'daemon ofâ€¦" 38 minutes ago Up 38 minutes 0.0.0.0:8081-&gt;80/tcp test_docker_nginx_webb4901afbf62e php:5.6-fpm "docker-php-entrypoiâ€¦" About an hour ago Up About an hour 9000/tcp test_docker_php# å¯åŠ¨MySQLå®¹å™¨[root@localhost mysql]# docker start ff21bd0345f4ff21bd0345f4# æŸ¥çœ‹å½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼Œçœ‹åˆ°MySQLå®¹å™¨å·²ç»è¿è¡Œ[root@localhost mysql]# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESff21bd0345f4 mysql:5.6 "docker-entrypoint.sâ€¦" 3 minutes ago Up 21 seconds 0.0.0.0:3306-&gt;3306/tcp test_docker_mysql4737055f929d nginx "nginx -g 'daemon ofâ€¦" 38 minutes ago Up 38 minutes 0.0.0.0:8081-&gt;80/tcp test_docker_nginx_webb4901afbf62e php:5.6-fpm "docker-php-entrypoiâ€¦" About an hour ago Up About an hour 9000/tcp test_docker_phpçŸ¥è¯†ç‚¹æœ€æ–°å®˜æ–¹MySQL(5.7.19)çš„dockeré•œåƒåœ¨åˆ›å»ºæ—¶æ˜ å°„çš„é…ç½®æ–‡ä»¶ç›®å½•æœ‰æ‰€ä¸åŒMySQL(5.7.19)çš„é»˜è®¤é…ç½®æ–‡ä»¶æ˜¯ /etc/mysql/my.cnf æ–‡ä»¶ã€‚å¦‚æžœæƒ³è¦è‡ªå®šä¹‰é…ç½®ï¼Œå»ºè®®å‘ /etc/mysql/conf.d ç›®å½•ä¸­åˆ›å»º .cnf æ–‡ä»¶ã€‚æ–°å»ºçš„æ–‡ä»¶å¯ä»¥ä»»æ„èµ·åï¼Œåªè¦ä¿è¯åŽç¼€åæ˜¯ cnf å³å¯ã€‚æ–°å»ºçš„æ–‡ä»¶ä¸­çš„é…ç½®é¡¹å¯ä»¥è¦†ç›– /etc/mysql/my.cnf ä¸­çš„é…ç½®é¡¹ã€‚é¦–å…ˆéœ€è¦åˆ›å»ºå°†è¦æ˜ å°„åˆ°å®¹å™¨ä¸­çš„ç›®å½•ä»¥åŠ.cnfæ–‡ä»¶ï¼Œç„¶åŽå†åˆ›å»ºå®¹å™¨1234567# pwd/opt# mkdir -p docker_v/mysql/conf# cd docker_v/mysql/conf# touch my.cnf# docker run -p 3306:3306 --name mysql -v /opt/docker_v/mysql/conf:/etc/mysql/conf.d -e MYSQL_ROOT_PASSWORD=123456 -d imageID4ec4f56455ea2d6d7251a05b7f308e314051fdad2c26bf3d0f27a9b0c0a71414å‘½ä»¤è¯´æ˜Žï¼š-p 3306:3306ï¼šå°†å®¹å™¨çš„3306ç«¯å£æ˜ å°„åˆ°ä¸»æœºçš„3306ç«¯å£-v /opt/docker_v/mysql/conf:/etc/mysql/conf.dï¼šå°†ä¸»æœº/opt/docker_v/mysql/confç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„/etc/mysql/conf.d-e MYSQL_ROOT_PASSWORD=123456ï¼šåˆå§‹åŒ–rootç”¨æˆ·çš„å¯†ç -d: åŽå°è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿”å›žå®¹å™¨IDimageID: mysqlé•œåƒIDdocker å®‰è£… mysql 8 ç‰ˆæœ¬12345678910111213141516# docker ä¸­ä¸‹è½½ mysqldocker pull mysql#å¯åŠ¨docker run --name mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD=Lzslov123! -d mysql#è¿›å…¥å®¹å™¨docker exec -it mysql bash#ç™»å½•mysqlmysql -u root -pALTER USER 'root'@'localhost' IDENTIFIED BY 'Lzslov123!';#æ·»åŠ è¿œç¨‹ç™»å½•ç”¨æˆ·CREATE USER 'liaozesong'@'%' IDENTIFIED WITH mysql_native_password BY 'Lzslov123!';GRANT ALL PRIVILEGES ON *.* TO 'liaozesong'@'%';ç™»å½•dockeré‡Œçš„MySQLé•œåƒå’Œè¿œç¨‹ç™»å½•é¦–æ¬¡ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯åŠ¨dockeré‡Œçš„MySQLé•œåƒæ—¶ï¼š1234567891011121314151617181920212223242526272829303132333435363738[root@localhost ~]# cd /home/[root@localhost home]# docker run -p 3306:3306 --name test_docker_mysql -v $PWD/conf:/etc/mysql/conf.d -v $PWD/logs:/logs -v $PWD/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.69d51b883e254d1a946af01c2edc0ed4c5a2155bf5118a5a3fcc8ff6c9053cfc7[root@localhost home]# docker ps -aCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES9d51b883e254 mysql:5.6 "docker-entrypoint.sâ€¦" 6 seconds ago Up 5 seconds 0.0.0.0:3306-&gt;3306/tcp test_docker_mysql4737055f929d nginx "nginx -g 'daemon ofâ€¦" 2 days ago Up 42 minutes 0.0.0.0:8081-&gt;80/tcp test_docker_nginx_webb4901afbf62e php:5.6-fpm "docker-php-entrypoiâ€¦" 2 days ago Up 42 minutes 9000/tcp test_docker_php[root@localhost home]# docker exec -it 9d51b883e254 bashroot@9d51b883e254:/# mysql -uroot -pEnter password: # éœ€è¦è¾“å…¥åˆå§‹å¯†ç 123456Welcome to the MySQL monitor. Commands end with ; or \g.Your MySQL connection id is 1Server version: 5.6.44 MySQL Community Server (GPL)Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.Oracle is a registered trademark of Oracle Corporation and/or itsaffiliates. Other names may be trademarks of their respectiveowners.Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.mysql&gt; show databases;+--------------------+| Database |+--------------------+| information_schema || mysql || performance_schema |+--------------------+3 rows in set (0.01 sec)mysql&gt; exit;Byeroot@9d51b883e254:/# exitexit[root@localhost home]#é‡åˆ°è¿‡ä¸€ä¸ªç‰¹æ®Šæƒ…å†µï¼Œå°±æ˜¯å…³æœºåŽå†å¼€æœºï¼ŒdockeræœåŠ¡é»˜è®¤æ²¡æœ‰å¼€æœºå¯åŠ¨ï¼Œå¯åŠ¨dockeræœåŠ¡åŽï¼Œä½¿ç”¨å‘½ä»¤ï¼šdocker ps -aå‘½ä»¤æŸ¥çœ‹æœ‰ä¹‹å‰å¯åŠ¨è¿‡çš„MySQLé•œåƒï¼Œç„¶åŽå¯åŠ¨åŽä½¿ç”¨å‘½ä»¤ï¼šdocker exec -it å®¹å™¨id bashè¿›åŽ»çŽ¯å¢ƒï¼Œä½¿ç”¨å‘½ä»¤ï¼šmysql -uroot -pï¼Œè¾“å…¥å¯†ç ï¼Œæ€»æ˜¯æç¤ºé”™è¯¯ï¼šERROR 1045 (28000): Access denied for user â€˜rootâ€˜@â€™localhostâ€™ (using password: YES)ã€‚åŽæ¥çš„è§£å†³åŠžæ³•æ˜¯åœ¨éœ€è¦è¾“å…¥å¯†ç çš„æ—¶å€™æ²¡æœ‰è¾“å…¥å¯†ç ï¼Œç›´æŽ¥æŒ‰å›žè½¦é”®å°±ç™»å½•åˆ°MySQLé‡Œé¢æ¥äº†ã€‚åŽæ¥è‡ªå·±æ²¡æœ‰å…³æœºé‡å¯ï¼Œåªæ˜¯æŠŠMySQLé•œåƒæœåŠ¡åœäº†ï¼ŒdockeræœåŠ¡åœäº†å†æŒ‰ä¸Šè¿°æ­¥éª¤æ“ä½œï¼Œä¸è¾“å…¥å¯†ç å°±ç™»é™†ä¸è¿›åŽ»ï¼Œè¾“å…¥å¯†ç æ‰èƒ½ç™»å½•è¿›åŽ»ã€‚è®°å½•ä¸€ä¸‹å’Œè¿™ä¸ªå¥‡è‘©çš„æƒ…å†µã€‚è¿œç¨‹ç™»å½•dockeré‡Œçš„MySQLé•œåƒï¼Œä½¿ç”¨Navicat Premiumè½¯ä»¶ï¼Œä¸»æœºåæˆ–IPåœ°å€ä¸€æ å¡«å†™dockeræ‰€åœ¨æœåŠ¡å™¨çš„åœ°å€ï¼Œè´¦å·å¯†ç ç«¯å£ç­‰å¡«å†™MySQLé•œåƒä½¿ç”¨çš„ï¼Œå°±èƒ½ç›´æŽ¥è¿œç¨‹ç™»å½•è¿›æ¥äº†ï¼Œä¸ç”¨å†åšå…¶ä»–é…ç½®Docker å®‰è£… Tomcatå®‰è£…æ­¥éª¤æ–¹æ³•ä¸€ã€docker pull tomcatæŸ¥æ‰¾Docker Hubä¸Šçš„tomcaté•œåƒ123456789[root@localhost ~]# docker search tomcatNAME DESCRIPTION STARS OFFICIAL AUTOMATEDtomcat Apache Tomcat is an open source implementatiâ€¦ 2455 [OK] tomee Apache TomEE is an all-Apache Java EE certifâ€¦ 66 [OK] dordoka/tomcat Ubuntu 14.04, Oracle JDK 8 and Tomcat 8 baseâ€¦ 53 [OK]bitnami/tomcat Bitnami Tomcat Docker Image 29 [OK]kubeguide/tomcat-app Tomcat image for Chapter 1 26 consol/tomcat-7.0 Tomcat 7.0.57, 8080, "admin/admin" 16 [OK]cloudesire/tomcat Tomcat server, 6/7/8 15 [OK]è¿™é‡Œæˆ‘ä»¬æ‹‰å–å®˜æ–¹çš„é•œåƒ1[root@localhost ~]# docker pull tomcatç­‰å¾…ä¸‹è½½å®ŒæˆåŽï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æœ¬åœ°é•œåƒåˆ—è¡¨é‡ŒæŸ¥åˆ°REPOSITORYä¸ºtomcatçš„é•œåƒã€‚12[root@localhost ~]# docker images | grep tomcattomcat latest 89481b5d9082 2 days ago 506MBæ–¹æ³•äºŒã€é€šè¿‡ Dockerfile æž„å»ºé¦–å…ˆï¼Œåˆ›å»ºç›®å½•tomcat,ç”¨äºŽå­˜æ”¾åŽé¢çš„ç›¸å…³ä¸œè¥¿ã€‚1[root@localhost ~]# mkdir -p ~/tomcat/webapps ~/tomcat/logs ~/tomcat/confå‘½ä»¤è¯´æ˜Žï¼šwebappsç›®å½•å°†æ˜ å°„ä¸ºtomcatå®¹å™¨é…ç½®çš„åº”ç”¨ç¨‹åºç›®å½•logsç›®å½•å°†æ˜ å°„ä¸ºtomcatå®¹å™¨çš„æ—¥å¿—ç›®å½•confç›®å½•é‡Œçš„é…ç½®æ–‡ä»¶å°†æ˜ å°„ä¸ºtomcatå®¹å™¨çš„é…ç½®æ–‡ä»¶è¿›å…¥åˆ›å»ºçš„tomcatç›®å½•ï¼Œåˆ›å»ºDockerfileï¼Œè¿™ä¸ªæ˜¯ä»¥Ubuntuç³»ç»Ÿä¸ºå‚è€ƒï¼ŒCentOSç³»ç»Ÿä½¿ç”¨çš„è¯éœ€è¦ä¿®æ”¹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161FROM openjdk:8-jreENV CATALINA_HOME /usr/local/tomcatENV PATH $CATALINA_HOME/bin:$PATHRUN mkdir -p &quot;$CATALINA_HOME&quot;WORKDIR $CATALINA_HOME# let &quot;Tomcat Native&quot; live somewhere isolatedENV TOMCAT_NATIVE_LIBDIR $CATALINA_HOME/native-jni-libENV LD_LIBRARY_PATH $&#123;LD_LIBRARY_PATH:+$LD_LIBRARY_PATH:&#125;$TOMCAT_NATIVE_LIBDIR# runtime dependencies for Tomcat Native Libraries# Tomcat Native 1.2+ requires a newer version of OpenSSL than debian:jessie has available# &gt; checking OpenSSL library version &gt;= 1.0.2...# &gt; configure: error: Your version of OpenSSL is not compatible with this version of tcnative# see http://tomcat.10.x6.nabble.com/VOTE-Release-Apache-Tomcat-8-0-32-tp5046007p5046024.html (and following discussion)# and https://github.com/docker-library/tomcat/pull/31ENV OPENSSL_VERSION 1.1.0f-3+deb9u2RUN set -ex; \ currentVersion=&quot;$(dpkg-query --show --showformat &apos;$&#123;Version&#125;\n&apos; openssl)&quot;; \ if dpkg --compare-versions &quot;$currentVersion&quot; &apos;&lt;&lt;&apos; &quot;$OPENSSL_VERSION&quot;; then \ if ! grep -q stretch /etc/apt/sources.list; then \# only add stretch if we&apos;re not already building from within stretch &#123; \ echo &apos;deb http://deb.debian.org/debian stretch main&apos;; \ echo &apos;deb http://security.debian.org stretch/updates main&apos;; \ echo &apos;deb http://deb.debian.org/debian stretch-updates main&apos;; \ &#125; &gt; /etc/apt/sources.list.d/stretch.list; \ &#123; \# add a negative &quot;Pin-Priority&quot; so that we never ever get packages from stretch unless we explicitly request them echo &apos;Package: *&apos;; \ echo &apos;Pin: release n=stretch*&apos;; \ echo &apos;Pin-Priority: -10&apos;; \ echo; \# ... except OpenSSL, which is the reason we&apos;re here echo &apos;Package: openssl libssl*&apos;; \ echo &quot;Pin: version $OPENSSL_VERSION&quot;; \ echo &apos;Pin-Priority: 990&apos;; \ &#125; &gt; /etc/apt/preferences.d/stretch-openssl; \ fi; \ apt-get update; \ apt-get install -y --no-install-recommends openssl=&quot;$OPENSSL_VERSION&quot;; \ rm -rf /var/lib/apt/lists/*; \ fiRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \ libapr1 \ &amp;&amp; rm -rf /var/lib/apt/lists/*# see https://www.apache.org/dist/tomcat/tomcat-$TOMCAT_MAJOR/KEYS# see also &quot;update.sh&quot; (https://github.com/docker-library/tomcat/blob/master/update.sh)ENV GPG_KEYS 05AB33110949707C93A279E3D3EFE6B686867BA6 07E48665A34DCAFAE522E5E6266191C37C037D42 47309207D818FFD8DCD3F83F1931D684307A10A5 541FBE7D8F78B25E055DDEE13C370389288584E7 61B832AC2F1C5A90F0F9B00A1C506407564C17A3 713DA88BE50911535FE716F5208B0AB1D63011C7 79F7026C690BAA50B92CD8B66A3AD3F4F22C4FED 9BA44C2621385CB966EBA586F72C284D731FABEE A27677289986DB50844682F8ACB77FC2E86E29AC A9C5DF4D22E99998D9875A5110C01C5A2F6059E7 DCFD35E0BF8CA7344752DE8B6FB21E8933C60243 F3A04C595DB5B6A5F1ECA43E3B7BBB100D811BBE F7DA48BB64BCB84ECBA7EE6935CD23C10D498E23ENV TOMCAT_MAJOR 8ENV TOMCAT_VERSION 8.5.32ENV TOMCAT_SHA512 fc010f4643cb9996cad3812594190564d0a30be717f659110211414faf8063c61fad1f18134154084ad3ddfbbbdb352fa6686a28fbb6402d3207d4e0a88fa9ceENV TOMCAT_TGZ_URLS \# https://issues.apache.org/jira/browse/INFRA-8753?focusedCommentId=14735394#comment-14735394 https://www.apache.org/dyn/closer.cgi?action=download&amp;filename=tomcat/tomcat-$TOMCAT_MAJOR/v$TOMCAT_VERSION/bin/apache-tomcat-$TOMCAT_VERSION.tar.gz \# if the version is outdated, we might have to pull from the dist/archive :/ https://www-us.apache.org/dist/tomcat/tomcat-$TOMCAT_MAJOR/v$TOMCAT_VERSION/bin/apache-tomcat-$TOMCAT_VERSION.tar.gz \ https://www.apache.org/dist/tomcat/tomcat-$TOMCAT_MAJOR/v$TOMCAT_VERSION/bin/apache-tomcat-$TOMCAT_VERSION.tar.gz \ https://archive.apache.org/dist/tomcat/tomcat-$TOMCAT_MAJOR/v$TOMCAT_VERSION/bin/apache-tomcat-$TOMCAT_VERSION.tar.gzENV TOMCAT_ASC_URLS \ https://www.apache.org/dyn/closer.cgi?action=download&amp;filename=tomcat/tomcat-$TOMCAT_MAJOR/v$TOMCAT_VERSION/bin/apache-tomcat-$TOMCAT_VERSION.tar.gz.asc \# not all the mirrors actually carry the .asc files :&apos;( https://www-us.apache.org/dist/tomcat/tomcat-$TOMCAT_MAJOR/v$TOMCAT_VERSION/bin/apache-tomcat-$TOMCAT_VERSION.tar.gz.asc \ https://www.apache.org/dist/tomcat/tomcat-$TOMCAT_MAJOR/v$TOMCAT_VERSION/bin/apache-tomcat-$TOMCAT_VERSION.tar.gz.asc \ https://archive.apache.org/dist/tomcat/tomcat-$TOMCAT_MAJOR/v$TOMCAT_VERSION/bin/apache-tomcat-$TOMCAT_VERSION.tar.gz.ascRUN set -eux; \ \ savedAptMark=&quot;$(apt-mark showmanual)&quot;; \ apt-get update; \ \ apt-get install -y --no-install-recommends gnupg dirmngr; \ \ export GNUPGHOME=&quot;$(mktemp -d)&quot;; \ for key in $GPG_KEYS; do \ gpg --keyserver ha.pool.sks-keyservers.net --recv-keys &quot;$key&quot;; \ done; \ \ apt-get install -y --no-install-recommends wget ca-certificates; \ \ success=; \ for url in $TOMCAT_TGZ_URLS; do \ if wget -O tomcat.tar.gz &quot;$url&quot;; then \ success=1; \ break; \ fi; \ done; \ [ -n &quot;$success&quot; ]; \ \ echo &quot;$TOMCAT_SHA512 *tomcat.tar.gz&quot; | sha512sum -c -; \ \ success=; \ for url in $TOMCAT_ASC_URLS; do \ if wget -O tomcat.tar.gz.asc &quot;$url&quot;; then \ success=1; \ break; \ fi; \ done; \ [ -n &quot;$success&quot; ]; \ \ gpg --batch --verify tomcat.tar.gz.asc tomcat.tar.gz; \ tar -xvf tomcat.tar.gz --strip-components=1; \ rm bin/*.bat; \ rm tomcat.tar.gz*; \ rm -rf &quot;$GNUPGHOME&quot;; \ \ nativeBuildDir=&quot;$(mktemp -d)&quot;; \ tar -xvf bin/tomcat-native.tar.gz -C &quot;$nativeBuildDir&quot; --strip-components=1; \ apt-get install -y --no-install-recommends \ dpkg-dev \ gcc \ libapr1-dev \ libssl-dev \ make \ &quot;openjdk-$&#123;JAVA_VERSION%%[.~bu-]*&#125;-jdk=$JAVA_DEBIAN_VERSION&quot; \ ; \ ( \ export CATALINA_HOME=&quot;$PWD&quot;; \ cd &quot;$nativeBuildDir/native&quot;; \ gnuArch=&quot;$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)&quot;; \ ./configure \ --build=&quot;$gnuArch&quot; \ --libdir=&quot;$TOMCAT_NATIVE_LIBDIR&quot; \ --prefix=&quot;$CATALINA_HOME&quot; \ --with-apr=&quot;$(which apr-1-config)&quot; \ --with-java-home=&quot;$(docker-java-home)&quot; \ --with-ssl=yes; \ make -j &quot;$(nproc)&quot;; \ make install; \ ); \ rm -rf &quot;$nativeBuildDir&quot;; \ rm bin/tomcat-native.tar.gz; \ \# reset apt-mark&apos;s &quot;manual&quot; list so that &quot;purge --auto-remove&quot; will remove all build dependencies apt-mark auto &apos;.*&apos; &gt; /dev/null; \ [ -z &quot;$savedAptMark&quot; ] || apt-mark manual $savedAptMark; \ apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false; \ rm -rf /var/lib/apt/lists/*; \ \# sh removes env vars it doesn&apos;t support (ones with periods)# https://github.com/docker-library/tomcat/issues/77 find ./bin/ -name &apos;*.sh&apos; -exec sed -ri &apos;s|^#!/bin/sh$|#!/usr/bin/env bash|&apos; &apos;&#123;&#125;&apos; +# verify Tomcat Native is working properlyRUN set -e \ &amp;&amp; nativeLines=&quot;$(catalina.sh configtest 2&gt;&amp;1)&quot; \ &amp;&amp; nativeLines=&quot;$(echo &quot;$nativeLines&quot; | grep &apos;Apache Tomcat Native&apos;)&quot; \ &amp;&amp; nativeLines=&quot;$(echo &quot;$nativeLines&quot; | sort -u)&quot; \ &amp;&amp; if ! echo &quot;$nativeLines&quot; | grep &apos;INFO: Loaded APR based Apache Tomcat Native library&apos; &gt;&amp;2; then \ echo &gt;&amp;2 &quot;$nativeLines&quot;; \ exit 1; \ fiEXPOSE 8080CMD [&quot;catalina.sh&quot;, &quot;run&quot;]é€šè¿‡Dockerfileåˆ›å»ºä¸€ä¸ªé•œåƒï¼Œæ›¿æ¢æˆä½ è‡ªå·±çš„åå­—1[root@localhost ~]# docker build -t tomcat .åˆ›å»ºå®ŒæˆåŽï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœ¬åœ°çš„é•œåƒåˆ—è¡¨é‡ŒæŸ¥æ‰¾åˆ°åˆšåˆšåˆ›å»ºçš„é•œåƒ12[root@localhost ~]# docker images|grep tomcattomcat latest 70f819d3d2d9 7 days ago 335.8 MBä½¿ç”¨tomcaté•œåƒè¿è¡Œå®¹å™¨12[root@localhost home]# docker run --name test_docker_tomcat -p 8080:8080 -v $PWD/test:/usr/local/tomcat/webapps/test -d tomcat3bdf4b155aaef20bac44511f84b402a2cb6d6957bc284c21a51e89fcbc2081a6å‘½ä»¤è¯´æ˜Žï¼š-p 8080:8080ï¼šå°†å®¹å™¨çš„8080ç«¯å£æ˜ å°„åˆ°ä¸»æœºçš„8080ç«¯å£-v $PWD/test:/usr/local/tomcat/webapps/testï¼šå°†ä¸»æœºä¸­å½“å‰ç›®å½•ä¸‹çš„testæŒ‚è½½åˆ°å®¹å™¨çš„/testæŸ¥çœ‹å®¹å™¨å¯åŠ¨æƒ…å†µ123[root@localhost home]# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES3bdf4b155aae tomcat "catalina.sh run" 21 seconds ago Up 20 seconds 0.0.0.0:8080-&gt;8080/tcp test_docker_tomcaté€šè¿‡æµè§ˆå™¨è®¿é—®æµè§ˆå™¨åœ°å€çœ‹è¾“å…¥ï¼šhttp://ip:8080Docker å®‰è£… Pythonå®‰è£…æ­¥éª¤æ–¹æ³•ä¸€ã€docker pull python:3.5æŸ¥æ‰¾Docker Hubä¸Šçš„pythoné•œåƒ123456[root@localhost ~]# docker search pythonNAME DESCRIPTION STARS OFFICIAL AUTOMATEDpython Python is an interpreted,... 982 [OK] kaggle/python Docker image for Python... 33 [OK]azukiapp/python Docker image to run Python ... 3 [OK]vimagick/python mini python 2 [OK]è¿™é‡Œæˆ‘ä»¬æ‹‰å–å®˜æ–¹çš„é•œåƒ,æ ‡ç­¾ä¸º3.51[root@localhost ~]# docker pull python:3.5ç­‰å¾…ä¸‹è½½å®ŒæˆåŽï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æœ¬åœ°é•œåƒåˆ—è¡¨é‡ŒæŸ¥åˆ°REPOSITORYä¸ºpython,æ ‡ç­¾ä¸º3.5çš„é•œåƒã€‚123[root@localhost ~]# docker images python:3.5 REPOSITORY TAG IMAGE ID CREATED SIZEpython 3.5 045767ddf24a 9 days ago 684.1 MBæ–¹æ³•äºŒã€é€šè¿‡ Dockerfile æž„å»ºé¦–å…ˆï¼Œåˆ›å»ºç›®å½•python,ç”¨äºŽå­˜æ”¾åŽé¢çš„ç›¸å…³ä¸œè¥¿ã€‚1[root@localhost ~]# mkdir -p ~/python ~/python/myappmyappç›®å½•å°†æ˜ å°„ä¸ºpythonå®¹å™¨é…ç½®çš„åº”ç”¨ç›®å½•è¿›å…¥åˆ›å»ºçš„pythonç›®å½•ï¼Œåˆ›å»ºDockerfileï¼Œè¿™ä¸ªæ˜¯ä»¥Ubuntuç³»ç»Ÿä¸ºå‚è€ƒï¼ŒCentOSç³»ç»Ÿä½¿ç”¨çš„è¯éœ€è¦ä¿®æ”¹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051FROM buildpack-deps:jessie# remove several traces of debian pythonRUN apt-get purge -y python.*# http://bugs.python.org/issue19846# &gt; At the moment, setting &quot;LANG=C&quot; on a Linux system *fundamentally breaks Python 3*, and that&apos;s not OK.ENV LANG C.UTF-8# gpg: key F73C700D: public key &quot;Larry Hastings &lt;larry@hastings.org&gt;&quot; importedENV GPG_KEY 97FC712E4C024BBEA48A61ED3A5CA953F73C700DENV PYTHON_VERSION 3.5.1# if this is called &quot;PIP_VERSION&quot;, pip explodes with &quot;ValueError: invalid truth value &apos;&lt;VERSION&gt;&apos;&quot;ENV PYTHON_PIP_VERSION 8.1.2RUN set -ex \ &amp;&amp; curl -fSL &quot;https://www.python.org/ftp/python/$&#123;PYTHON_VERSION%%[a-z]*&#125;/Python-$PYTHON_VERSION.tar.xz&quot; -o python.tar.xz \ &amp;&amp; curl -fSL &quot;https://www.python.org/ftp/python/$&#123;PYTHON_VERSION%%[a-z]*&#125;/Python-$PYTHON_VERSION.tar.xz.asc&quot; -o python.tar.xz.asc \ &amp;&amp; export GNUPGHOME=&quot;$(mktemp -d)&quot; \ &amp;&amp; gpg --keyserver ha.pool.sks-keyservers.net --recv-keys &quot;$GPG_KEY&quot; \ &amp;&amp; gpg --batch --verify python.tar.xz.asc python.tar.xz \ &amp;&amp; rm -r &quot;$GNUPGHOME&quot; python.tar.xz.asc \ &amp;&amp; mkdir -p /usr/src/python \ &amp;&amp; tar -xJC /usr/src/python --strip-components=1 -f python.tar.xz \ &amp;&amp; rm python.tar.xz \ \ &amp;&amp; cd /usr/src/python \ &amp;&amp; ./configure --enable-shared --enable-unicode=ucs4 \ &amp;&amp; make -j$(nproc) \ &amp;&amp; make install \ &amp;&amp; ldconfig \ &amp;&amp; pip3 install --no-cache-dir --upgrade --ignore-installed pip==$PYTHON_PIP_VERSION \ &amp;&amp; find /usr/local -depth \ \( \ \( -type d -a -name test -o -name tests \) \ -o \ \( -type f -a -name &apos;*.pyc&apos; -o -name &apos;*.pyo&apos; \) \ \) -exec rm -rf &apos;&#123;&#125;&apos; + \ &amp;&amp; rm -rf /usr/src/python ~/.cache# make some useful symlinks that are expected to existRUN cd /usr/local/bin \ &amp;&amp; ln -s easy_install-3.5 easy_install \ &amp;&amp; ln -s idle3 idle \ &amp;&amp; ln -s pydoc3 pydoc \ &amp;&amp; ln -s python3 python \ &amp;&amp; ln -s python3-config python-configCMD [&quot;python3&quot;]é€šè¿‡Dockerfileåˆ›å»ºä¸€ä¸ªé•œåƒï¼Œæ›¿æ¢æˆä½ è‡ªå·±çš„åå­—1[root@localhost ~]# docker build -t python:3.5 .åˆ›å»ºå®ŒæˆåŽï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœ¬åœ°çš„é•œåƒåˆ—è¡¨é‡ŒæŸ¥æ‰¾åˆ°åˆšåˆšåˆ›å»ºçš„é•œåƒ123[root@localhost ~]# docker images python:3.5 REPOSITORY TAG IMAGE ID CREATED SIZEpython 3.5 045767ddf24a 9 days ago 684.1 MBä½¿ç”¨pythoné•œåƒåœ¨/home/python/myappç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª helloworld.py æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š12#!/usr/bin/pythonprint("Hello, World!");è¿è¡Œå®¹å™¨1[root@localhost ~]# docker run -v /home/python/myapp:/usr/src/myapp -w /usr/src/myapp python:3.5 python helloworld.pyå‘½ä»¤è¯´æ˜Žï¼š-v /home/python/myapp:/usr/src/myapp :å°†ä¸»æœºæŒ‡å®šç›®å½•ä¸‹çš„myappæŒ‚è½½åˆ°å®¹å™¨çš„/usr/src/myapp-w /usr/src/myapp :æŒ‡å®šå®¹å™¨çš„/usr/src/myappç›®å½•ä¸ºå·¥ä½œç›®å½•python helloworld.py :ä½¿ç”¨å®¹å™¨çš„pythonå‘½ä»¤æ¥æ‰§è¡Œå·¥ä½œç›®å½•ä¸­çš„helloworld.pyæ–‡ä»¶è¾“å‡ºç»“æžœï¼š1Hello, World!Docker å®‰è£… Rediså®‰è£…æ­¥éª¤æ–¹æ³•ä¸€ã€docker pull redis:5.0æŸ¥æ‰¾Docker Hubä¸Šçš„redisé•œåƒ12345678[root@localhost ~]# docker search redisNAME DESCRIPTION STARS OFFICIAL AUTOMATEDredis Redis is an open source ... 2321 [OK] sameersbn/redis 32 [OK]torusware/speedus-redis Always updated official ... 29 [OK]bitnami/redis Bitnami Redis Docker Image 22 [OK]anapsix/redis 11MB Redis server image ... 6 [OK]...è¿™é‡Œæˆ‘ä»¬æ‹‰å–å®˜æ–¹çš„é•œåƒ,æ ‡ç­¾ä¸º5.01[root@localhost ~]# docker pull redis:5.0ç­‰å¾…ä¸‹è½½å®ŒæˆåŽï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æœ¬åœ°é•œåƒåˆ—è¡¨é‡ŒæŸ¥åˆ°REPOSITORYä¸ºredis,æ ‡ç­¾ä¸º5.0çš„é•œåƒã€‚123[root@localhost ~]# docker images redisREPOSITORY TAG IMAGE ID CREATED SIZEredis 5.0 598a6f110d01 3 days ago 118MBæ–¹æ³•äºŒã€é€šè¿‡ Dockerfile æž„å»ºé¦–å…ˆï¼Œåˆ›å»ºç›®å½•redis,ç”¨äºŽå­˜æ”¾åŽé¢çš„ç›¸å…³ä¸œè¥¿ã€‚1[root@localhost ~]# mkdir -p ~/redis ~/redis/datadataç›®å½•å°†æ˜ å°„ä¸ºrediså®¹å™¨é…ç½®çš„/dataç›®å½•,ä½œä¸ºredisæ•°æ®æŒä¹…åŒ–çš„å­˜å‚¨ç›®å½•è¿›å…¥åˆ›å»ºçš„redisç›®å½•ï¼Œåˆ›å»ºDockerfileï¼Œè¿™ä¸ªæ˜¯ä»¥Ubuntuç³»ç»Ÿä¸ºå‚è€ƒï¼ŒCentOSç³»ç»Ÿä½¿ç”¨çš„è¯éœ€è¦ä¿®æ”¹1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950FROM debian:jessie# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get addedRUN groupadd -r redis &amp;&amp; useradd -r -g redis redisRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \ ca-certificates \ wget \ &amp;&amp; rm -rf /var/lib/apt/lists/*# grab gosu for easy step-down from rootENV GOSU_VERSION 1.7RUN set -x \ &amp;&amp; wget -O /usr/local/bin/gosu &quot;https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$(dpkg --print-architecture)&quot; \ &amp;&amp; wget -O /usr/local/bin/gosu.asc &quot;https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$(dpkg --print-architecture).asc&quot; \ &amp;&amp; export GNUPGHOME=&quot;$(mktemp -d)&quot; \ &amp;&amp; gpg --keyserver ha.pool.sks-keyservers.net --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4 \ &amp;&amp; gpg --batch --verify /usr/local/bin/gosu.asc /usr/local/bin/gosu \ &amp;&amp; rm -r &quot;$GNUPGHOME&quot; /usr/local/bin/gosu.asc \ &amp;&amp; chmod +x /usr/local/bin/gosu \ &amp;&amp; gosu nobody trueENV REDIS_VERSION 5.0.0ENV REDIS_DOWNLOAD_URL http://download.redis.io/releases/redis-5.0.0.tar.gzENV REDIS_DOWNLOAD_SHA1 0c1820931094369c8cc19fc1be62f598bc5961ca# for redis-sentinel see: http://redis.io/topics/sentinelRUN buildDeps=&apos;gcc libc6-dev make&apos; \ &amp;&amp; set -x \ &amp;&amp; apt-get update &amp;&amp; apt-get install -y $buildDeps --no-install-recommends \ &amp;&amp; rm -rf /var/lib/apt/lists/* \ &amp;&amp; wget -O redis.tar.gz &quot;$REDIS_DOWNLOAD_URL&quot; \ &amp;&amp; echo &quot;$REDIS_DOWNLOAD_SHA1 *redis.tar.gz&quot; | sha1sum -c - \ &amp;&amp; mkdir -p /usr/src/redis \ &amp;&amp; tar -xzf redis.tar.gz -C /usr/src/redis --strip-components=1 \ &amp;&amp; rm redis.tar.gz \ &amp;&amp; make -C /usr/src/redis \ &amp;&amp; make -C /usr/src/redis install \ &amp;&amp; rm -r /usr/src/redis \ &amp;&amp; apt-get purge -y --auto-remove $buildDepsRUN mkdir /data &amp;&amp; chown redis:redis /dataVOLUME /dataWORKDIR /dataCOPY docker-entrypoint.sh /usr/local/bin/ENTRYPOINT [&quot;docker-entrypoint.sh&quot;]EXPOSE 6379CMD [ &quot;redis-server&quot; ]é€šè¿‡Dockerfileåˆ›å»ºä¸€ä¸ªé•œåƒï¼Œæ›¿æ¢æˆä½ è‡ªå·±çš„åå­—1[root@localhost ~]# docker build -t redis:5.0 .åˆ›å»ºå®ŒæˆåŽï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœ¬åœ°çš„é•œåƒåˆ—è¡¨é‡ŒæŸ¥æ‰¾åˆ°åˆšåˆšåˆ›å»ºçš„é•œåƒ123[root@localhost ~]# docker images redis REPOSITORY TAG IMAGE ID CREATED SIZEredis 5.0 43c923d57784 2 weeks ago 193.9 MBä½¿ç”¨redisé•œåƒè¿è¡Œå®¹å™¨12[root@localhost home]# docker run -p 6379:6379 -v $PWD/data:/data -d redis:5.0 redis-server --appendonly yes2c4e3bfd9691e9174cebba01ebc55f464321749156eb462fd099da3544a0c67bå‘½ä»¤è¯´æ˜Žï¼š-p 6379:6379 : å°†å®¹å™¨çš„6379ç«¯å£æ˜ å°„åˆ°ä¸»æœºçš„6379ç«¯å£-v $PWD/data:/data : å°†ä¸»æœºä¸­å½“å‰ç›®å½•ä¸‹çš„dataæŒ‚è½½åˆ°å®¹å™¨çš„/dataredis-server â€“appendonly yes : åœ¨å®¹å™¨æ‰§è¡Œredis-serverå¯åŠ¨å‘½ä»¤ï¼Œå¹¶æ‰“å¼€redisæŒä¹…åŒ–é…ç½®æŸ¥çœ‹å®¹å™¨å¯åŠ¨æƒ…å†µ123[root@localhost ~]# docker psCONTAINER ID IMAGE COMMAND ... PORTS NAMES43f7a65ec7f8 redis:3.2 "docker-entrypoint.sh" ... 0.0.0.0:6379-&gt;6379/tcp agitated_crayè¿žæŽ¥ã€æŸ¥çœ‹å®¹å™¨ä½¿ç”¨redisé•œåƒæ‰§è¡Œredis-cliå‘½ä»¤è¿žæŽ¥åˆ°åˆšå¯åŠ¨çš„å®¹å™¨,ä¸»æœºIPä¸º127.0.0.112345678910111213[root@localhost home]# docker exec -it 2c4e3bfd9691 redis-cli127.0.0.1:6379&gt; info# Serverredis_version:5.0.5redis_git_sha1:00000000redis_git_dirty:0redis_build_id:f5cc35eb8e511133redis_mode:standaloneos:Linux 3.10.0-862.el7.x86_64 x86_64arch_bits:64multiplexing_api:epoll...127.0.0.1:6379&gt; quitDocker å®‰è£… MongoDBå®‰è£…æ­¥éª¤æ–¹æ³•ä¸€ã€docker pull mongoæŸ¥æ‰¾Docker Hubä¸Šçš„mongoé•œåƒ1234567[root@localhost ~]# docker search mongoNAME DESCRIPTION STARS OFFICIAL AUTOMATEDmongo MongoDB document databases ... 1989 [OK] mongo-express Web-based MongoDB admin int... 22 [OK] mvertes/alpine-mongo light MongoDB container 19 [OK]mongooseim/mongooseim-docker MongooseIM server the lates... 9 [OK]......è¿™é‡Œæˆ‘ä»¬æ‹‰å–å®˜æ–¹çš„é•œåƒ,æ ‡ç­¾ä¸º4.11[root@localhost ~]# docker pull mongo:4.1ç­‰å¾…ä¸‹è½½å®ŒæˆåŽï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æœ¬åœ°é•œåƒåˆ—è¡¨é‡ŒæŸ¥åˆ°REPOSITORYä¸ºmongo,æ ‡ç­¾ä¸º4.1çš„é•œåƒã€‚123[root@localhost home]# docker images mongoREPOSITORY TAG IMAGE ID CREATED SIZEmongo 4.1 6e89620d0711 11 days ago 360MBæ–¹æ³•äºŒã€é€šè¿‡ Dockerfile æž„å»ºé¦–å…ˆï¼Œåˆ›å»ºç›®å½•mongo,ç”¨äºŽå­˜æ”¾åŽé¢çš„ç›¸å…³ä¸œè¥¿ã€‚1[root@localhost ~]# mkdir -p ~/mongo ~/mongo/dbdbç›®å½•å°†æ˜ å°„ä¸ºmongoå®¹å™¨é…ç½®çš„/data/dbç›®å½•,ä½œä¸ºmongoæ•°æ®çš„å­˜å‚¨ç›®å½•è¿›å…¥åˆ›å»ºçš„mongoç›®å½•ï¼Œåˆ›å»ºDockerfileï¼Œè¿™ä¸ªæ˜¯ä»¥Ubuntuç³»ç»Ÿä¸ºå‚è€ƒï¼ŒCentOSç³»ç»Ÿä½¿ç”¨çš„è¯éœ€è¦ä¿®æ”¹1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798FROM debian:jessie-slim# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get addedRUN groupadd -r mongodb &amp;&amp; useradd -r -g mongodb mongodbRUN apt-get update \ &amp;&amp; apt-get install -y --no-install-recommends \ ca-certificates \ jq \ numactl \ &amp;&amp; rm -rf /var/lib/apt/lists/*# grab gosu for easy step-down from root (https://github.com/tianon/gosu/releases)ENV GOSU_VERSION 1.10# grab "js-yaml" for parsing mongod's YAML config files (https://github.com/nodeca/js-yaml/releases)ENV JSYAML_VERSION 3.10.0RUN set -ex; \ \ apt-get update; \ apt-get install -y --no-install-recommends \ wget \ ; \ rm -rf /var/lib/apt/lists/*; \ \ dpkgArch="$(dpkg --print-architecture | awk -F- '&#123; print $NF &#125;')"; \ wget -O /usr/local/bin/gosu "https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch"; \ wget -O /usr/local/bin/gosu.asc "https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch.asc"; \ export GNUPGHOME="$(mktemp -d)"; \ gpg --keyserver ha.pool.sks-keyservers.net --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4; \ gpg --batch --verify /usr/local/bin/gosu.asc /usr/local/bin/gosu; \ command -v gpgconf &amp;&amp; gpgconf --kill all || :; \ rm -r "$GNUPGHOME" /usr/local/bin/gosu.asc; \ chmod +x /usr/local/bin/gosu; \ gosu nobody true; \ \ wget -O /js-yaml.js "https://github.com/nodeca/js-yaml/raw/$&#123;JSYAML_VERSION&#125;/dist/js-yaml.js"; \# TODO some sort of download verification here \ apt-get purge -y --auto-remove wgetRUN mkdir /docker-entrypoint-initdb.dENV GPG_KEYS \# pub 4096R/AAB2461C 2014-02-25 [expires: 2016-02-25]# Key fingerprint = DFFA 3DCF 326E 302C 4787 673A 01C4 E7FA AAB2 461C# uid MongoDB 2.6 Release Signing Key &lt;packaging@mongodb.com&gt; DFFA3DCF326E302C4787673A01C4E7FAAAB2461C \# pub 4096R/EA312927 2015-10-09 [expires: 2017-10-08]# Key fingerprint = 42F3 E95A 2C4F 0827 9C49 60AD D68F A50F EA31 2927# uid MongoDB 3.2 Release Signing Key &lt;packaging@mongodb.com&gt; 42F3E95A2C4F08279C4960ADD68FA50FEA312927# https://docs.mongodb.com/manual/tutorial/verify-mongodb-packages/#download-then-import-the-key-fileRUN set -ex; \ export GNUPGHOME="$(mktemp -d)"; \ for key in $GPG_KEYS; do \ gpg --keyserver ha.pool.sks-keyservers.net --recv-keys "$key"; \ done; \ gpg --export $GPG_KEYS &gt; /etc/apt/trusted.gpg.d/mongodb.gpg; \ command -v gpgconf &amp;&amp; gpgconf --kill all || :; \ rm -r "$GNUPGHOME"; \ apt-key list# Allow build-time overrides (eg. to build image with MongoDB Enterprise version)# Options for MONGO_PACKAGE: mongodb-org OR mongodb-enterprise# Options for MONGO_REPO: repo.mongodb.org OR repo.mongodb.com# Example: docker build --build-arg MONGO_PACKAGE=mongodb-enterprise --build-arg MONGO_REPO=repo.mongodb.com .ARG MONGO_PACKAGE=mongodb-orgARG MONGO_REPO=repo.mongodb.orgENV MONGO_PACKAGE=$&#123;MONGO_PACKAGE&#125; MONGO_REPO=$&#123;MONGO_REPO&#125;ENV MONGO_MAJOR 3.2ENV MONGO_VERSION 3.2.20RUN echo "deb http://$MONGO_REPO/apt/debian jessie/$&#123;MONGO_PACKAGE%-unstable&#125;/$MONGO_MAJOR main" | tee "/etc/apt/sources.list.d/$&#123;MONGO_PACKAGE%-unstable&#125;.list"RUN set -x \ &amp;&amp; apt-get update \ &amp;&amp; apt-get install -y \ $&#123;MONGO_PACKAGE&#125;=$MONGO_VERSION \ $&#123;MONGO_PACKAGE&#125;-server=$MONGO_VERSION \ $&#123;MONGO_PACKAGE&#125;-shell=$MONGO_VERSION \ $&#123;MONGO_PACKAGE&#125;-mongos=$MONGO_VERSION \ $&#123;MONGO_PACKAGE&#125;-tools=$MONGO_VERSION \ &amp;&amp; rm -rf /var/lib/apt/lists/* \ &amp;&amp; rm -rf /var/lib/mongodb \ &amp;&amp; mv /etc/mongod.conf /etc/mongod.conf.origRUN mkdir -p /data/db /data/configdb \ &amp;&amp; chown -R mongodb:mongodb /data/db /data/configdbVOLUME /data/db /data/configdbCOPY docker-entrypoint.sh /usr/local/bin/RUN ln -s usr/local/bin/docker-entrypoint.sh /entrypoint.sh # backwards compatENTRYPOINT ["docker-entrypoint.sh"]EXPOSE 27017CMD ["mongod"]é€šè¿‡Dockerfileåˆ›å»ºä¸€ä¸ªé•œåƒï¼Œæ›¿æ¢æˆä½ è‡ªå·±çš„åå­—1[root@localhost ~]# docker build -t mongo:3.2 .åˆ›å»ºå®ŒæˆåŽï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœ¬åœ°çš„é•œåƒåˆ—è¡¨é‡ŒæŸ¥æ‰¾åˆ°åˆšåˆšåˆ›å»ºçš„é•œåƒ123[root@localhost ~]# docker images mongo:3.2REPOSITORY TAG IMAGE ID CREATED SIZEmongo 3.2 282fd552add6 9 days ago 336.1 MBä½¿ç”¨mongoé•œåƒè¿è¡Œå®¹å™¨12[root@localhost home]# docker run --name test_docker_mongodb -p 27017:27017 -v $PWD/mongodb/configdb:/data/configdb/ -v $PWD/mongodb/db/:/data/db/ -d mongo:4.1 --auth4c13b2cef633d1b67b3fb30f2776064eaf110265a9e93a324b62b0780d14cae8å‘½ä»¤è¯´æ˜Žï¼š-p 27017:27017 : å°†å®¹å™¨çš„27017 ç«¯å£æ˜ å°„åˆ°ä¸»æœºçš„27017 ç«¯å£-v $PWD/mongodb/configdb:/data/configdb/ ä¸»æœºä¸­å½“å‰ç›®å½•ä¸‹çš„configdbæŒ‚è½½åˆ°å®¹å™¨çš„/data/configdbï¼Œä½œä¸ºmongoæ•°æ®é…ç½®ç›®å½•-v : $PWD/mongodb/db/:/data/db/ å°†ä¸»æœºä¸­å½“å‰ç›®å½•ä¸‹çš„dbæŒ‚è½½åˆ°å®¹å™¨çš„/data/dbï¼Œä½œä¸ºmongoæ•°æ®å­˜å‚¨ç›®å½•æŸ¥çœ‹å®¹å™¨å¯åŠ¨æƒ…å†µ123[root@localhost home]# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES4c13b2cef633 mongo:4.1 "docker-entrypoint.sâ€¦" 3 minutes ago Up 3 minutes 0.0.0.0:27017-&gt;27017/tcp test_docker_mongodbä½¿ç”¨mongoé•œåƒæ‰§è¡Œmongo å‘½ä»¤è¿žæŽ¥åˆ°åˆšå¯åŠ¨çš„MongoDBå®¹å™¨1234567891011121314151617181920212223242526272829303132333435363738394041# ä»¥ admin ç”¨æˆ·èº«ä»½è¿›å…¥mongo[root@localhost home]# docker exec -it 4c13b2cef633 mongo adminMongoDB shell version v4.1.13connecting to: mongodb://127.0.0.1:27017/admin?compressors=disabled&amp;gssapiServiceName=mongodbImplicit session: session &#123; "id" : UUID("0f3d246c-845e-47e3-b571-4f8c0f94028a") &#125;MongoDB server version: 4.1.13Welcome to the MongoDB shell.For interactive help, type "help".For more comprehensive documentation, see http://docs.mongodb.org/Questions? Try the support group http://groups.google.com/group/mongodb-user# åˆ›å»ºä¸€ä¸ª admin ç®¡ç†å‘˜è´¦å·&gt; db.createUser(&#123; user: 'admin', pwd: '123456', roles: [ &#123; role: "userAdminAnyDatabase", db: "admin" &#125; ] &#125;);Successfully added user: &#123; "user" : "admin", "roles" : [ &#123; "role" : "userAdminAnyDatabase", "db" : "admin" &#125; ]&#125;# é€€å‡º&gt; exit;[root@localhost home]# docker exec -it 4c13b2cef633 mongo adminMongoDB shell version v4.1.13connecting to: mongodb://127.0.0.1:27017/admin?compressors=disabled&amp;gssapiServiceName=mongodbImplicit session: session &#123; "id" : UUID("1c6c9ebd-458d-42d3-906d-51fb84b38bf1") &#125;MongoDB server version: 4.1.13# å†æ¬¡ç™»å½•éœ€è¦å¯¹ admin è¿›è¡Œèº«ä»½è®¤è¯&gt; db.auth("admin","123456"); 1# åˆ‡æ¢æ•°æ®åº“&gt; use app;switched to db app&gt;ä½¿ç”¨ mongo-express ç®¡ç†mongodbmongo-expressæ˜¯MongoDBçš„ä¸€ä¸ªå¯è§†åŒ–å›¾å½¢ç®¡ç†å·¥å…·ï¼Œé€šè¿‡dockeræ¥è¿è¡Œä¸€ä¸ªmongo-expressï¼Œæ¥ç®¡ç†ä¸Šé¢åˆ›å»ºçš„mongodbæœåŠ¡ã€‚12345# éœ€è¦è¿›è¡Œè´¦å·éªŒè¯æ‰èƒ½ä½¿ç”¨docker pull docker.io/mongo-expressdocker run -it --rm -p 8081:8081 --link &lt;mongoDBå®¹å™¨ID&gt;:mongo mongo-express# é€šè¿‡æµè§ˆå™¨è®¿é—®http://&lt;å®¿ä¸»æœºIPåœ°å€&gt;:8081ä½¿ç”¨ mongoclient ç®¡ç† mongodb12345# éœ€è¦è¿›è¡Œè´¦å·éªŒè¯æ‰èƒ½ä½¿ç”¨docker pull mongoclient/mongoclientdocker run --name mongoclient -d -p 3000:3000 -e MONGO_URL=mongodb://&lt;å®¿ä¸»æœºIPåœ°å€&gt;:27017/ mongoclient/mongoclient# é€šè¿‡æµè§ˆå™¨è®¿é—®http://&lt;å®¿ä¸»æœºIPåœ°å€&gt;:3000Docker å®‰è£… Apacheå®‰è£…æ­¥éª¤æ–¹æ³•ä¸€ã€docker pull httpdæŸ¥æ‰¾Docker Hubä¸Šçš„httpdé•œåƒ12345678[root@localhost ~]# # docker search httpdNAME DESCRIPTION STARS OFFICIAL AUTOMATEDhttpd The Apache HTTP Server .. 524 [OK] centos/httpd 7 [OK]rgielen/httpd-image-php5 Docker image for Apache... 1 [OK]microwebapps/httpd-frontend Httpd frontend allowing... 1 [OK]lolhens/httpd Apache httpd 2 Server 1 [OK]...è¿™é‡Œæˆ‘ä»¬æ‹‰å–å®˜æ–¹çš„é•œåƒ1[root@localhost ~]# docker pull httpdç­‰å¾…ä¸‹è½½å®ŒæˆåŽï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æœ¬åœ°é•œåƒåˆ—è¡¨é‡ŒæŸ¥åˆ°REPOSITORYä¸ºhttpdçš„é•œåƒã€‚123[root@localhost home]# docker images httpdREPOSITORY TAG IMAGE ID CREATED SIZEhttpd latest ee39f68eb241 2 days ago 154MBæ–¹æ³•äºŒã€é€šè¿‡ Dockerfileæž„å»ºé¦–å…ˆï¼Œåˆ›å»ºç›®å½•apacheï¼Œç”¨äºŽå­˜æ”¾åŽé¢çš„ç›¸å…³ä¸œè¥¿ã€‚1[root@localhost ~]# mkdir -p ~/apache/www ~/apache/logs ~/apache/confå‘½ä»¤è¯´æ˜Žï¼šwwwç›®å½•å°†æ˜ å°„ä¸ºapacheå®¹å™¨é…ç½®çš„åº”ç”¨ç¨‹åºç›®å½•logsç›®å½•å°†æ˜ å°„ä¸ºapacheå®¹å™¨çš„æ—¥å¿—ç›®å½•confç›®å½•é‡Œçš„é…ç½®æ–‡ä»¶å°†æ˜ å°„ä¸ºapacheå®¹å™¨çš„é…ç½®æ–‡ä»¶è¿›å…¥åˆ›å»ºçš„apacheç›®å½•ï¼Œåˆ›å»ºDockerfileï¼Œè¿™ä¸ªæ˜¯ä»¥Ubuntuç³»ç»Ÿä¸ºå‚è€ƒï¼ŒCentOSç³»ç»Ÿä½¿ç”¨çš„è¯éœ€è¦ä¿®æ”¹1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374FROM debian:jessie# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added#RUN groupadd -r www-data &amp;&amp; useradd -r --create-home -g www-data www-dataENV HTTPD_PREFIX /usr/local/apache2ENV PATH $PATH:$HTTPD_PREFIX/binRUN mkdir -p &quot;$HTTPD_PREFIX&quot; \ &amp;&amp; chown www-data:www-data &quot;$HTTPD_PREFIX&quot;WORKDIR $HTTPD_PREFIX# install httpd runtime dependencies# https://httpd.apache.org/docs/2.4/install.html#requirementsRUN apt-get update \ &amp;&amp; apt-get install -y --no-install-recommends \ libapr1 \ libaprutil1 \ libaprutil1-ldap \ libapr1-dev \ libaprutil1-dev \ libpcre++0 \ libssl1.0.0 \ &amp;&amp; rm -r /var/lib/apt/lists/*ENV HTTPD_VERSION 2.4.20ENV HTTPD_BZ2_URL https://www.apache.org/dist/httpd/httpd-$HTTPD_VERSION.tar.bz2RUN buildDeps=&apos; \ ca-certificates \ curl \ bzip2 \ gcc \ libpcre++-dev \ libssl-dev \ make \ &apos; \ set -x \ &amp;&amp; apt-get update \ &amp;&amp; apt-get install -y --no-install-recommends $buildDeps \ &amp;&amp; rm -r /var/lib/apt/lists/* \ \ &amp;&amp; curl -fSL &quot;$HTTPD_BZ2_URL&quot; -o httpd.tar.bz2 \ &amp;&amp; curl -fSL &quot;$HTTPD_BZ2_URL.asc&quot; -o httpd.tar.bz2.asc \# see https://httpd.apache.org/download.cgi#verify &amp;&amp; export GNUPGHOME=&quot;$(mktemp -d)&quot; \ &amp;&amp; gpg --keyserver ha.pool.sks-keyservers.net --recv-keys A93D62ECC3C8EA12DB220EC934EA76E6791485A8 \ &amp;&amp; gpg --batch --verify httpd.tar.bz2.asc httpd.tar.bz2 \ &amp;&amp; rm -r &quot;$GNUPGHOME&quot; httpd.tar.bz2.asc \ \ &amp;&amp; mkdir -p src \ &amp;&amp; tar -xvf httpd.tar.bz2 -C src --strip-components=1 \ &amp;&amp; rm httpd.tar.bz2 \ &amp;&amp; cd src \ \ &amp;&amp; ./configure \ --prefix=&quot;$HTTPD_PREFIX&quot; \ --enable-mods-shared=reallyall \ &amp;&amp; make -j&quot;$(nproc)&quot; \ &amp;&amp; make install \ \ &amp;&amp; cd .. \ &amp;&amp; rm -r src \ \ &amp;&amp; sed -ri \ -e &apos;s!^(\s*CustomLog)\s+\S+!\1 /proc/self/fd/1!g&apos; \ -e &apos;s!^(\s*ErrorLog)\s+\S+!\1 /proc/self/fd/2!g&apos; \ &quot;$HTTPD_PREFIX/conf/httpd.conf&quot; \ \ &amp;&amp; apt-get purge -y --auto-remove $buildDepsCOPY httpd-foreground /usr/local/bin/EXPOSE 80CMD [&quot;httpd-foreground&quot;]Dockerfileæ–‡ä»¶ä¸­ COPY httpd-foreground /usr/local/bin/ æ˜¯å°†å½“å‰ç›®å½•ä¸‹çš„httpd-foregroundæ‹·è´åˆ°é•œåƒé‡Œï¼Œä½œä¸ºhttpdæœåŠ¡çš„å¯åŠ¨è„šæœ¬ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªè„šæœ¬æ–‡ä»¶httpd-foreground1234567#!/bin/bashset -e# Apache gets grumpy about PID files pre-existingrm -f /usr/local/apache2/logs/httpd.pidexec httpd -DFOREGROUNDèµ‹äºˆhttpd-foregroundæ–‡ä»¶å¯æ‰§è¡Œæƒé™1[root@localhost ~]# chmod +x httpd-foregroundé€šè¿‡Dockerfileåˆ›å»ºä¸€ä¸ªé•œåƒï¼Œæ›¿æ¢æˆä½ è‡ªå·±çš„åå­—1[root@localhost ~]# docker build -t httpd .åˆ›å»ºå®ŒæˆåŽï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœ¬åœ°çš„é•œåƒåˆ—è¡¨é‡ŒæŸ¥æ‰¾åˆ°åˆšåˆšåˆ›å»ºçš„é•œåƒ123[root@localhost ~]# docker images httpdREPOSITORY TAG IMAGE ID CREATED SIZEhttpd latest da1536b4ef14 23 seconds ago 195.1 MBä½¿ç”¨apacheé•œåƒè¿è¡Œå®¹å™¨12345678# è¿è¡ŒåŽä½¿ç”¨docker psæŸ¥çœ‹ï¼Œå‘çŽ°æ²¡æœ‰å¯åŠ¨ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªå‘½ä»¤æœ‰é—®é¢˜[root@localhost ~]# docker run -p 80:80 -v $PWD/www/:/usr/local/apache2/htdocs/ -v $PWD/conf/httpd.conf:/usr/local/apache2/conf/httpd.conf -v $PWD/logs/:/usr/local/apache2/logs/ -d httpd## ä½¿ç”¨è¿™ä¸ªå‘½ä»¤å¯ä»¥å¯åŠ¨[root@localhost ~]# docker run -it -d -p 80:80 --name test_docker_httpd -v /home/apache/:/usr/local/apache2/htdocs/ httpd# åœ¨/home/apache/ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªindex.htmlæ–‡ä»¶ï¼Œä½¿ç”¨æµè§ˆå™¨è®¿é—®æµ‹è¯•å‘½ä»¤è¯´æ˜Žï¼š-p 80:80 :å°†å®¹å™¨çš„80ç«¯å£æ˜ å°„åˆ°ä¸»æœºçš„80ç«¯å£-v $PWD/www/:/usr/local/apache2/htdocs/ :å°†ä¸»æœºä¸­å½“å‰ç›®å½•ä¸‹çš„wwwç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„/usr/local/apache2/htdocs/-v $PWD/conf/httpd.conf:/usr/local/apache2/conf/httpd.conf :å°†ä¸»æœºä¸­å½“å‰ç›®å½•ä¸‹çš„conf/httpd.confæ–‡ä»¶æŒ‚è½½åˆ°å®¹å™¨çš„/usr/local/apache2/conf/httpd.conf-v $PWD/logs/:/usr/local/apache2/logs/ :å°†ä¸»æœºä¸­å½“å‰ç›®å½•ä¸‹çš„logsç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„/usr/local/apache2/logs/æŸ¥çœ‹å®¹å™¨å¯åŠ¨æƒ…å†µ123[root@localhost ~]# docker psCONTAINER ID IMAGE COMMAND ... PORTS NAMES79a97f2aac37 httpd "httpd-foreground" ... 0.0.0.0:80-&gt;80/tcp sharp_swansoné€šè¿‡æµè§ˆå™¨è®¿é—®ï¼Œå‡ºçŽ°çš„å†…å®¹æ˜¯index.htmlçš„å†…å®¹ä½†æ˜¯æœ‰ä¸ªé—®é¢˜ï¼Œé…ç½®æ–‡ä»¶è¿™ä¸ªè¦å¼„ï¼Œä¼°è®¡è¿˜å¾—ä»Žå¯åŠ¨httpdçš„å‘½ä»¤å¤„ç€æ‰‹ï¼Œå°±è·Ÿnginxå®¹å™¨å¯åŠ¨ç±»ä¼¼MacOSç³»ç»Ÿé…ç½®Nginx+php+mysqlçš„dockerä½¿ç”¨çŽ¯å¢ƒåˆ›å»ºç›®å½•1mkdir -p /Users/sui/docker/nginx/conf.d &amp;&amp; mkdir /Users/sui/www &amp;&amp; cd /Users/sui/docker/nginx/conf.d &amp;&amp; sudo touch default.confå¯åŠ¨php-fpm123docker run --name sui-php -d -v /Users/sui/www:/var/www/html:ro php:7.1-fpm# --name sui-php æ˜¯å®¹å™¨çš„åå­—# /Users/sui/www æ˜¯æœ¬åœ° php æ–‡ä»¶çš„å­˜å‚¨ç›®å½•ï¼Œ/var/www/html æ˜¯å®¹å™¨å†… php æ–‡ä»¶çš„å­˜å‚¨ç›®å½•ï¼Œro è¡¨ç¤ºåªè¯»ç¼–è¾‘ nginx é…ç½®æ–‡ä»¶é…ç½®æ–‡ä»¶ä½ç½®ï¼š/Users/sui/docker/nginx/conf.d/default.confã€‚1234567891011121314151617181920212223server &#123; listen 80; server_name localhost; location / &#123; root /usr/share/nginx/html; index index.html index.htm; &#125; error_page 500 502 503 504 /50x.html; location = /50x.html &#123; root /usr/share/nginx/html; &#125; location ~ \.php$ &#123; fastcgi_pass php:9000; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME /var/www/html/$fastcgi_script_name; include fastcgi_params; &#125;&#125;# php:9000 è¡¨ç¤º php-fpm æœåŠ¡çš„è®¿é—®è·¯å¾„# /var/www/html æ˜¯ sui-php ä¸­ php æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„ï¼Œç» docker æ˜ å°„ï¼Œå˜æˆæœ¬åœ°è·¯å¾„ /Users/sui/wwwå¯åŠ¨ nginx123456docker run --name sui-nginx -p 80:80 -d -v /Users/sui/www:/usr/share/nginx/html:ro \ -v /Users/sui/docker/nginx/conf.d:/etc/nginx/conf.d:ro --link sui-php:php nginx# -p 80:80 ç”¨äºŽæ·»åŠ ç«¯å£æ˜ å°„ï¼ŒæŠŠ sui-nginx ä¸­çš„ 80 ç«¯å£æš´éœ²å‡ºæ¥# /Users/sui/www æ˜¯æœ¬åœ°htmlæ–‡ä»¶çš„å­˜å‚¨ç›®å½•ï¼Œ/usr/share/nginx/htmlæ˜¯å®¹å™¨å†…htmlæ–‡ä»¶çš„å­˜å‚¨ç›®å½•# /Users/sui/docker/nginx/conf.d æ˜¯æœ¬åœ°nginxè™šæ‹Ÿä¸»æœºé…ç½®è·¯å¾„ï¼Œ/etc/nginx/conf.dæ˜¯nginxå®¹å™¨å†…è™šæ‹Ÿä¸»æœºé…ç½®è·¯å¾„(é‡è¦)# --link sui-php:php æŠŠsui-phpçš„ç½‘ç»œå¹¶å…¥sui-nginxï¼Œå¹¶é€šè¿‡ä¿®æ”¹ sui-nginx çš„ /etc/hostsï¼ŒæŠŠåŸŸå php æ˜ å°„æˆ 127.0.0.1ï¼Œè®© nginx é€šè¿‡ php:9000 è®¿é—® php-fpmï¼ˆè¿™ä¸€æ­¥è‡³å…³é‡è¦ï¼‰æµ‹è¯•ç»“æžœåœ¨ /Users/sui/www ä¸‹æ”¾ä¸¤ä¸ªæ–‡ä»¶ï¼šindex.html index.phpmysql æœåŠ¡å™¨1234mkdir -p /Users/sui/docker/mysql/data /Users/sui/docker/mysql/logs /Users/sui/docker/mysql/conf# data ç›®å½•å°†æ˜ å°„ä¸º mysql å®¹å™¨é…ç½®çš„æ•°æ®æ–‡ä»¶å­˜æ”¾è·¯å¾„# logs ç›®å½•å°†æ˜ å°„ä¸º mysql å®¹å™¨çš„æ—¥å¿—ç›®å½•# conf ç›®å½•é‡Œçš„é…ç½®æ–‡ä»¶å°†æ˜ å°„ä¸º mysql å®¹å™¨çš„é…ç½®æ–‡ä»¶12# å¯åŠ¨dockeré‡Œçš„MySQLé•œåƒdocker run -p 3306:3306 --name sui-mysql -v /Users/sui/docker/mysql/conf:/etc/mysql -v /Users/sui/docker/mysql/logs:/logs -v /Users/sui/docker/mysql/data:/mysql_data -e MYSQL_ROOT_PASSWORD=123456 -d --link sui-php mysqlè¿›å…¥mysqlå®¢æˆ·ç«¯1docker run -it --link sui-mysql:mysql --rm mysql sh -c 'exec mysql -h"$MYSQL_PORT_3306_TCP_ADDR" -P"$MYSQL_PORT_3306_TCP_PORT" -uroot -p"$MYSQL_ENV_MYSQL_ROOT_PASSWORD"'phpmyadmin1docker run --name sui-myadmin -d --link sui-mysql:db -p 8080:80 phpmyadmin/phpmyadminè¦ç‚¹è‹¥æŸä¸ªé•œåƒä¸­éœ€è¦ä½¿ç”¨åˆ°å¦ä¸€ä¸ªé•œåƒä¸­çš„èµ„æºï¼Œåˆ™éœ€è¦ä½¿ç”¨-â€“linkè¿›è¡Œå…³è”ï¼Œæ¯”å¦‚ï¼šnginxå…³è”phpï¼Œphpå…³è”mysqlç­‰ã€‚Docker å‘½ä»¤å¤§å…¨å®¹å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç†run1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465docker run ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨å¹¶è¿è¡Œä¸€ä¸ªå‘½ä»¤è¯­æ³•docker run [OPTIONS] IMAGE [COMMAND] [ARG...]OPTIONSè¯´æ˜Žï¼š -a stdin: æŒ‡å®šæ ‡å‡†è¾“å…¥è¾“å‡ºå†…å®¹ç±»åž‹ï¼Œå¯é€‰ STDIN/STDOUT/STDERR ä¸‰é¡¹ï¼› -d: åŽå°è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿”å›žå®¹å™¨IDï¼› -i: ä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸Ž -t åŒæ—¶ä½¿ç”¨ï¼› -P: éšæœºç«¯å£æ˜ å°„ï¼Œå®¹å™¨å†…éƒ¨ç«¯å£éšæœºæ˜ å°„åˆ°ä¸»æœºçš„é«˜ç«¯å£ -p: æŒ‡å®šç«¯å£æ˜ å°„ï¼Œæ ¼å¼ä¸ºï¼šä¸»æœº(å®¿ä¸»)ç«¯å£:å®¹å™¨ç«¯å£ -t: ä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œé€šå¸¸ä¸Ž -i åŒæ—¶ä½¿ç”¨ï¼› --name=&quot;nginx-lb&quot;: ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåç§°ï¼› --dns 8.8.8.8: æŒ‡å®šå®¹å™¨ä½¿ç”¨çš„DNSæœåŠ¡å™¨ï¼Œé»˜è®¤å’Œå®¿ä¸»ä¸€è‡´ï¼› --dns-search example.com: æŒ‡å®šå®¹å™¨DNSæœç´¢åŸŸåï¼Œé»˜è®¤å’Œå®¿ä¸»ä¸€è‡´ï¼› -h &quot;mars&quot;: æŒ‡å®šå®¹å™¨çš„hostnameï¼› -e username=&quot;ritchie&quot;: è®¾ç½®çŽ¯å¢ƒå˜é‡ï¼› --env-file=[]: ä»ŽæŒ‡å®šæ–‡ä»¶è¯»å…¥çŽ¯å¢ƒå˜é‡ï¼› --cpuset=&quot;0-2&quot; or --cpuset=&quot;0,1,2&quot;: ç»‘å®šå®¹å™¨åˆ°æŒ‡å®šCPUè¿è¡Œï¼› -m :è®¾ç½®å®¹å™¨ä½¿ç”¨å†…å­˜æœ€å¤§å€¼ï¼› --net=&quot;bridge&quot;: æŒ‡å®šå®¹å™¨çš„ç½‘ç»œè¿žæŽ¥ç±»åž‹ï¼Œæ”¯æŒ bridge/host/none/container: å››ç§ç±»åž‹ï¼› --link=[]: æ·»åŠ é“¾æŽ¥åˆ°å¦ä¸€ä¸ªå®¹å™¨ï¼› --expose=[]: å¼€æ”¾ä¸€ä¸ªç«¯å£æˆ–ä¸€ç»„ç«¯å£ï¼› --volume , -v: ç»‘å®šä¸€ä¸ªå·å®žä¾‹ä½¿ç”¨dockeré•œåƒnginx:latestä»¥åŽå°æ¨¡å¼å¯åŠ¨ä¸€ä¸ªå®¹å™¨,å¹¶å°†å®¹å™¨å‘½åä¸ºmynginxã€‚docker run --name mynginx -d nginx:latestä½¿ç”¨é•œåƒnginx:latestä»¥åŽå°æ¨¡å¼å¯åŠ¨ä¸€ä¸ªå®¹å™¨,å¹¶å°†å®¹å™¨çš„80ç«¯å£æ˜ å°„åˆ°ä¸»æœºéšæœºç«¯å£ã€‚docker run -P -d nginx:latestä½¿ç”¨é•œåƒ nginx:latestï¼Œä»¥åŽå°æ¨¡å¼å¯åŠ¨ä¸€ä¸ªå®¹å™¨,å°†å®¹å™¨çš„ 80 ç«¯å£æ˜ å°„åˆ°ä¸»æœºçš„ 80 ç«¯å£,ä¸»æœºçš„ç›®å½• /data æ˜ å°„åˆ°å®¹å™¨çš„ /dataã€‚docker run -p 80:80 -v /data:/data -d nginx:latestç»‘å®šå®¹å™¨çš„ 8080 ç«¯å£ï¼Œå¹¶å°†å…¶æ˜ å°„åˆ°æœ¬åœ°ä¸»æœº 127.0.0.1 çš„ 80 ç«¯å£ä¸Šã€‚$ docker run -p 127.0.0.1:80:8080/tcp ubuntu bashä½¿ç”¨é•œåƒnginx:latestä»¥äº¤äº’æ¨¡å¼å¯åŠ¨ä¸€ä¸ªå®¹å™¨,åœ¨å®¹å™¨å†…æ‰§è¡Œ/bin/bashå‘½ä»¤ã€‚runoob@runoob:~$ docker run -it nginx:latest /bin/bashroot@b8573233d675:/#start/stop/restart1234567891011121314151617181920212223242526docker start :å¯åŠ¨ä¸€ä¸ªæˆ–å¤šä¸ªå·²ç»è¢«åœæ­¢çš„å®¹å™¨docker stop :åœæ­¢ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨docker restart :é‡å¯å®¹å™¨è¯­æ³•docker start [OPTIONS] CONTAINER [CONTAINER...]docker stop [OPTIONS] CONTAINER [CONTAINER...]docker restart [OPTIONS] CONTAINER [CONTAINER...]å®žä¾‹å¯åŠ¨å·²è¢«åœæ­¢çš„å®¹å™¨myrunoobdocker start myrunoobåœæ­¢è¿è¡Œä¸­çš„å®¹å™¨myrunoobdocker stop myrunoobé‡å¯å®¹å™¨myrunoobdocker restart myrunoobkill123456789101112131415docker kill :æ€æŽ‰ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨ã€‚è¯­æ³•docker kill [OPTIONS] CONTAINER [CONTAINER...]OPTIONSè¯´æ˜Žï¼š -s :å‘å®¹å™¨å‘é€ä¸€ä¸ªä¿¡å·å®žä¾‹æ€æŽ‰è¿è¡Œä¸­çš„å®¹å™¨mynginxrunoob@runoob:~$ docker kill -s KILL mynginxmynginxrm1234567891011121314151617181920212223242526docker rm ï¼šåˆ é™¤ä¸€ä¸ªæˆ–å¤šå°‘å®¹å™¨è¯­æ³•docker rm [OPTIONS] CONTAINER [CONTAINER...]OPTIONSè¯´æ˜Žï¼š -f :é€šè¿‡SIGKILLä¿¡å·å¼ºåˆ¶åˆ é™¤ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨ -l :ç§»é™¤å®¹å™¨é—´çš„ç½‘ç»œè¿žæŽ¥ï¼Œè€Œéžå®¹å™¨æœ¬èº« -v :-v åˆ é™¤ä¸Žå®¹å™¨å…³è”çš„å·å®žä¾‹å¼ºåˆ¶åˆ é™¤å®¹å™¨db01ã€db02docker rm -f db01 db02ç§»é™¤å®¹å™¨nginx01å¯¹å®¹å™¨db01çš„è¿žæŽ¥ï¼Œè¿žæŽ¥ådbdocker rm -l db åˆ é™¤å®¹å™¨nginx01,å¹¶åˆ é™¤å®¹å™¨æŒ‚è½½çš„æ•°æ®å·docker rm -v nginx01pause/unpause123456789101112131415161718docker pause :æš‚åœå®¹å™¨ä¸­æ‰€æœ‰çš„è¿›ç¨‹ã€‚docker unpause :æ¢å¤å®¹å™¨ä¸­æ‰€æœ‰çš„è¿›ç¨‹ã€‚è¯­æ³•docker pause [OPTIONS] CONTAINER [CONTAINER...]docker unpause [OPTIONS] CONTAINER [CONTAINER...]å®žä¾‹æš‚åœæ•°æ®åº“å®¹å™¨db01æä¾›æœåŠ¡ã€‚docker pause db01æ¢å¤æ•°æ®åº“å®¹å™¨db01æä¾›æœåŠ¡ã€‚docker unpause db01create1234567891011121314docker create ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨ä½†ä¸å¯åŠ¨å®ƒç”¨æ³•åŒ docker runè¯­æ³•docker create [OPTIONS] IMAGE [COMMAND] [ARG...]è¯­æ³•åŒ docker runå®žä¾‹ä½¿ç”¨dockeré•œåƒnginx:lateståˆ›å»ºä¸€ä¸ªå®¹å™¨,å¹¶å°†å®¹å™¨å‘½åä¸ºmyrunoobrunoob@runoob:~$ docker create --name myrunoob nginx:latest 09b93464c2f75b7b69f83d56a9cfc23ceb50a48a9db7652ee4c27e3e2cb1961fexec123456789101112131415161718192021222324252627282930313233343536373839docker exec ï¼šåœ¨è¿è¡Œçš„å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤è¯­æ³•docker exec [OPTIONS] CONTAINER COMMAND [ARG...]OPTIONSè¯´æ˜Žï¼š -d :åˆ†ç¦»æ¨¡å¼: åœ¨åŽå°è¿è¡Œ -i :å³ä½¿æ²¡æœ‰é™„åŠ ä¹Ÿä¿æŒSTDIN æ‰“å¼€ -t :åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯å®žä¾‹åœ¨å®¹å™¨ mynginx ä¸­ä»¥äº¤äº’æ¨¡å¼æ‰§è¡Œå®¹å™¨å†… /root/runoob.sh è„šæœ¬:runoob@runoob:~$ docker exec -it mynginx /bin/sh /root/runoob.shhttp://www.runoob.com/åœ¨å®¹å™¨ mynginx ä¸­å¼€å¯ä¸€ä¸ªäº¤äº’æ¨¡å¼çš„ç»ˆç«¯:runoob@runoob:~$ docker exec -i -t mynginx /bin/bashroot@b1a0703e41e7:/#ä¹Ÿå¯ä»¥é€šè¿‡ docker ps -a å‘½ä»¤æŸ¥çœ‹å·²ç»åœ¨è¿è¡Œçš„å®¹å™¨ï¼Œç„¶åŽä½¿ç”¨å®¹å™¨ ID è¿›å…¥å®¹å™¨ã€‚æŸ¥çœ‹å·²ç»åœ¨è¿è¡Œçš„å®¹å™¨ IDï¼š# docker ps -a ...9df70f9a0714 openjdk &quot;/usercode/script.shâ€¦&quot; ...ç¬¬ä¸€åˆ—çš„ 9df70f9a0714 å°±æ˜¯å®¹å™¨ IDã€‚é€šè¿‡ exec å‘½ä»¤å¯¹æŒ‡å®šçš„å®¹å™¨æ‰§è¡Œ bash:# docker exec -it 9df70f9a0714 /bin/bashå®¹å™¨æ“ä½œps123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687docker ps : åˆ—å‡ºå®¹å™¨è¯­æ³•docker ps [OPTIONS]OPTIONSè¯´æ˜Žï¼š -a :æ˜¾ç¤ºæ‰€æœ‰çš„å®¹å™¨ï¼ŒåŒ…æ‹¬æœªè¿è¡Œçš„ã€‚ -f :æ ¹æ®æ¡ä»¶è¿‡æ»¤æ˜¾ç¤ºçš„å†…å®¹ã€‚ --format :æŒ‡å®šè¿”å›žå€¼çš„æ¨¡æ¿æ–‡ä»¶ã€‚ -l :æ˜¾ç¤ºæœ€è¿‘åˆ›å»ºçš„å®¹å™¨ã€‚ -n :åˆ—å‡ºæœ€è¿‘åˆ›å»ºçš„nä¸ªå®¹å™¨ã€‚ --no-trunc :ä¸æˆªæ–­è¾“å‡ºã€‚ -q :é™é»˜æ¨¡å¼ï¼Œåªæ˜¾ç¤ºå®¹å™¨ç¼–å·ã€‚ -s :æ˜¾ç¤ºæ€»çš„æ–‡ä»¶å¤§å°ã€‚å®žä¾‹åˆ—å‡ºæ‰€æœ‰åœ¨è¿è¡Œçš„å®¹å™¨ä¿¡æ¯ã€‚runoob@runoob:~$ docker psCONTAINER ID IMAGE COMMAND ... PORTS NAMES09b93464c2f7 nginx:latest &quot;nginx -g &apos;daemon off&quot; ... 80/tcp, 443/tcp myrunoob96f7f14e99ab mysql:5.6 &quot;docker-entrypoint.sh&quot; ... 0.0.0.0:3306-&gt;3306/tcp mymysqlåˆ—å‡ºæœ€è¿‘åˆ›å»ºçš„5ä¸ªå®¹å™¨ä¿¡æ¯ã€‚runoob@runoob:~$ docker ps -n 5CONTAINER ID IMAGE COMMAND CREATED 09b93464c2f7 nginx:latest &quot;nginx -g &apos;daemon off&quot; 2 days ago ... b8573233d675 nginx:latest &quot;/bin/bash&quot; 2 days ago ... b1a0703e41e7 nginx:latest &quot;nginx -g &apos;daemon off&quot; 2 days ago ... f46fb1dec520 5c6e1090e771 &quot;/bin/sh -c &apos;set -x \t&quot; 2 days ago ... a63b4a5597de 860c279d2fec &quot;bash&quot; 2 days ago ...åˆ—å‡ºæ‰€æœ‰åˆ›å»ºçš„å®¹å™¨IDã€‚runoob@runoob:~$ docker ps -a -q09b93464c2f7b8573233d675b1a0703e41e7f46fb1dec520a63b4a5597de6a4aa42e947bde7bb36e796843a432b73776664a8ab1a585ba52eb632bbd...æ ¹æ®æ¡ä»¶è¿‡æ»¤æ˜¾ç¤ºçš„å†…å®¹æ ¹æ®æ ‡ç­¾è¿‡æ»¤$ docker run -d --name=test-nginx --label color=blue nginx$ docker ps --filter &quot;label=color&quot;$ docker ps --filter &quot;label=color=blue&quot;æ ¹æ®åç§°è¿‡æ»¤$ docker ps --filter&quot;name=test-nginx&quot;æ ¹æ®çŠ¶æ€è¿‡æ»¤$ docker ps -a --filter &apos;exited=0&apos;$ docker ps --filter status=running$ docker ps --filter status=pausedæ ¹æ®é•œåƒè¿‡æ»¤#é•œåƒåç§°$ docker ps --filter ancestor=nginx#é•œåƒID$ docker ps --filter ancestor=d0e008c6cf02æ ¹æ®å¯åŠ¨é¡ºåºè¿‡æ»¤$ docker ps -f before=9c3527ed70ce$ docker ps -f since=6e63f6ff38b0inspect123456789101112131415161718192021222324252627282930313233343536373839404142434445docker inspect : èŽ·å–å®¹å™¨/é•œåƒçš„å…ƒæ•°æ®ã€‚è¯­æ³•docker inspect [OPTIONS] NAME|ID [NAME|ID...]OPTIONSè¯´æ˜Žï¼š -f :æŒ‡å®šè¿”å›žå€¼çš„æ¨¡æ¿æ–‡ä»¶ã€‚ -s :æ˜¾ç¤ºæ€»çš„æ–‡ä»¶å¤§å°ã€‚ --type :ä¸ºæŒ‡å®šç±»åž‹è¿”å›žJSONã€‚å®žä¾‹èŽ·å–é•œåƒmysql:5.6çš„å…ƒä¿¡æ¯ã€‚runoob@runoob:~$ docker inspect mysql:5.6[ &#123; &quot;Id&quot;: &quot;sha256:2c0964ec182ae9a045f866bbc2553087f6e42bfc16074a74fb820af235f070ec&quot;, &quot;RepoTags&quot;: [ &quot;mysql:5.6&quot; ], &quot;RepoDigests&quot;: [], &quot;Parent&quot;: &quot;&quot;, &quot;Comment&quot;: &quot;&quot;, &quot;Created&quot;: &quot;2016-05-24T04:01:41.168371815Z&quot;, &quot;Container&quot;: &quot;e0924bc460ff97787f34610115e9363e6363b30b8efa406e28eb495ab199ca54&quot;, &quot;ContainerConfig&quot;: &#123; &quot;Hostname&quot;: &quot;b0cf605c7757&quot;, &quot;Domainname&quot;: &quot;&quot;, &quot;User&quot;: &quot;&quot;, &quot;AttachStdin&quot;: false, &quot;AttachStdout&quot;: false, &quot;AttachStderr&quot;: false, &quot;ExposedPorts&quot;: &#123; &quot;3306/tcp&quot;: &#123;&#125; &#125;,...èŽ·å–æ­£åœ¨è¿è¡Œçš„å®¹å™¨mymysqlçš„ IPã€‚runoob@runoob:~$ docker inspect --format=&apos;&#123;&#123;range .NetworkSettings.Networks&#125;&#125;&#123;&#123;.IPAddress&#125;&#125;&#123;&#123;end&#125;&#125;&apos; mymysql172.17.0.3top1234567891011121314151617docker top :æŸ¥çœ‹å®¹å™¨ä¸­è¿è¡Œçš„è¿›ç¨‹ä¿¡æ¯ï¼Œæ”¯æŒ ps å‘½ä»¤å‚æ•°ã€‚è¯­æ³•docker top [OPTIONS] CONTAINER [ps OPTIONS]å®¹å™¨è¿è¡Œæ—¶ä¸ä¸€å®šæœ‰/bin/bashç»ˆç«¯æ¥äº¤äº’æ‰§è¡Œtopå‘½ä»¤ï¼Œè€Œä¸”å®¹å™¨è¿˜ä¸ä¸€å®šæœ‰topå‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨docker topæ¥å®žçŽ°æŸ¥çœ‹containerä¸­æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ã€‚å®žä¾‹æŸ¥çœ‹å®¹å™¨mymysqlçš„è¿›ç¨‹ä¿¡æ¯ã€‚runoob@runoob:~/mysql$ docker top mymysqlUID PID PPID C STIME TTY TIME CMD999 40347 40331 18 00:58 ? 00:00:02 mysqldæŸ¥çœ‹æ‰€æœ‰è¿è¡Œå®¹å™¨çš„è¿›ç¨‹ä¿¡æ¯ã€‚for i in `docker ps |grep Up|awk &apos;&#123;print $1&#125;&apos;`;do echo \ &amp;&amp;docker top $i; doneattach1234567891011121314docker attach :è¿žæŽ¥åˆ°æ­£åœ¨è¿è¡Œä¸­çš„å®¹å™¨ã€‚è¯­æ³•docker attach [OPTIONS] CONTAINERè¦attachä¸ŠåŽ»çš„å®¹å™¨å¿…é¡»æ­£åœ¨è¿è¡Œï¼Œå¯ä»¥åŒæ—¶è¿žæŽ¥ä¸ŠåŒä¸€ä¸ªcontaineræ¥å…±äº«å±å¹•ï¼ˆä¸Žscreenå‘½ä»¤çš„attachç±»ä¼¼ï¼‰ã€‚å®˜æ–¹æ–‡æ¡£ä¸­è¯´attachåŽå¯ä»¥é€šè¿‡CTRL-Cæ¥detachï¼Œä½†å®žé™…ä¸Šç»è¿‡æˆ‘çš„æµ‹è¯•ï¼Œå¦‚æžœcontainerå½“å‰åœ¨è¿è¡Œbashï¼ŒCTRL-Cè‡ªç„¶æ˜¯å½“å‰è¡Œçš„è¾“å…¥ï¼Œæ²¡æœ‰é€€å‡ºï¼›å¦‚æžœcontainerå½“å‰æ­£åœ¨å‰å°è¿è¡Œè¿›ç¨‹ï¼Œå¦‚è¾“å‡ºnginxçš„access.logæ—¥å¿—ï¼ŒCTRL-Cä¸ä»…ä¼šå¯¼è‡´é€€å‡ºå®¹å™¨ï¼Œè€Œä¸”è¿˜stopäº†ã€‚è¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œdetachçš„æ„æ€æŒ‰ç†åº”è¯¥æ˜¯è„±ç¦»å®¹å™¨ç»ˆç«¯ï¼Œä½†å®¹å™¨ä¾ç„¶è¿è¡Œã€‚å¥½åœ¨attachæ˜¯å¯ä»¥å¸¦ä¸Š--sig-proxy=falseæ¥ç¡®ä¿CTRL-Dæˆ–CTRL-Cä¸ä¼šå…³é—­å®¹å™¨ã€‚å®žä¾‹å®¹å™¨mynginxå°†è®¿é—®æ—¥å¿—æŒ‡åˆ°æ ‡å‡†è¾“å‡ºï¼Œè¿žæŽ¥åˆ°å®¹å™¨æŸ¥çœ‹è®¿é—®ä¿¡æ¯ã€‚runoob@runoob:~$ docker attach --sig-proxy=false mynginx192.168.239.1 - - [10/Jul/2016:16:54:26 +0000] &quot;GET / HTTP/1.1&quot; 304 0 &quot;-&quot; &quot;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.93 Safari/537.36&quot; &quot;-&quot;events123456789101112131415161718192021222324252627282930313233343536373839404142docker events : ä»ŽæœåŠ¡å™¨èŽ·å–å®žæ—¶äº‹ä»¶è¯­æ³•docker events [OPTIONS]OPTIONSè¯´æ˜Žï¼š -f ï¼šæ ¹æ®æ¡ä»¶è¿‡æ»¤äº‹ä»¶ï¼› --since ï¼šä»ŽæŒ‡å®šçš„æ—¶é—´æˆ³åŽæ˜¾ç¤ºæ‰€æœ‰äº‹ä»¶; --until ï¼šæµæ°´æ—¶é—´æ˜¾ç¤ºåˆ°æŒ‡å®šçš„æ—¶é—´ä¸ºæ­¢ï¼›å®žä¾‹æ˜¾ç¤ºdocker 2016å¹´7æœˆ1æ—¥åŽçš„æ‰€æœ‰äº‹ä»¶ã€‚runoob@runoob:~/mysql$ docker events --since=&quot;1467302400&quot;2016-07-08T19:44:54.501277677+08:00 network connect 66f958fd13dc4314ad20034e576d5c5eba72e0849dcc38ad9e8436314a4149d4 (container=b8573233d675705df8c89796a2c2687cd8e36e03646457a15fb51022db440e64, name=bridge, type=bridge)2016-07-08T19:44:54.723876221+08:00 container start b8573233d675705df8c89796a2c2687cd8e36e03646457a15fb51022db440e64 (image=nginx:latest, name=elegant_albattani)2016-07-08T19:44:54.726110498+08:00 container resize b8573233d675705df8c89796a2c2687cd8e36e03646457a15fb51022db440e64 (height=39, image=nginx:latest, name=elegant_albattani, width=167)2016-07-08T19:46:22.137250899+08:00 container die b8573233d675705df8c89796a2c2687cd8e36e03646457a15fb51022db440e64 (exitCode=0, image=nginx:latest, name=elegant_albattani)...æ˜¾ç¤ºdocker é•œåƒä¸ºmysql:5.6 2016å¹´7æœˆ1æ—¥åŽçš„ç›¸å…³äº‹ä»¶ã€‚runoob@runoob:~/mysql$ docker events -f &quot;image&quot;=&quot;mysql:5.6&quot; --since=&quot;1467302400&quot; 2016-07-11T00:38:53.975174837+08:00 container start 96f7f14e99ab9d2f60943a50be23035eda1623782cc5f930411bbea407a2bb10 (image=mysql:5.6, name=mymysql)2016-07-11T00:51:17.022572452+08:00 container kill 96f7f14e99ab9d2f60943a50be23035eda1623782cc5f930411bbea407a2bb10 (image=mysql:5.6, name=mymysql, signal=9)2016-07-11T00:51:17.132532080+08:00 container die 96f7f14e99ab9d2f60943a50be23035eda1623782cc5f930411bbea407a2bb10 (exitCode=137, image=mysql:5.6, name=mymysql)2016-07-11T00:51:17.514661357+08:00 container destroy 96f7f14e99ab9d2f60943a50be23035eda1623782cc5f930411bbea407a2bb10 (image=mysql:5.6, name=mymysql)2016-07-11T00:57:18.551984549+08:00 container create c8f0a32f12f5ec061d286af0b1285601a3e33a90a08ff1706de619ac823c345c (image=mysql:5.6, name=mymysql)2016-07-11T00:57:18.557405864+08:00 container attach c8f0a32f12f5ec061d286af0b1285601a3e33a90a08ff1706de619ac823c345c (image=mysql:5.6, name=mymysql)2016-07-11T00:57:18.844134112+08:00 container start c8f0a32f12f5ec061d286af0b1285601a3e33a90a08ff1706de619ac823c345c (image=mysql:5.6, name=mymysql)2016-07-11T00:57:19.140141428+08:00 container die c8f0a32f12f5ec061d286af0b1285601a3e33a90a08ff1706de619ac823c345c (exitCode=1, image=mysql:5.6, name=mymysql)2016-07-11T00:58:05.941019136+08:00 container destroy c8f0a32f12f5ec061d286af0b1285601a3e33a90a08ff1706de619ac823c345c (image=mysql:5.6, name=mymysql)2016-07-11T00:58:07.965128417+08:00 container create a404c6c174a21c52f199cfce476e041074ab020453c7df2a13a7869b48f2f37e (image=mysql:5.6, name=mymysql)2016-07-11T00:58:08.188734598+08:00 container start a404c6c174a21c52f199cfce476e041074ab020453c7df2a13a7869b48f2f37e (image=mysql:5.6, name=mymysql)2016-07-11T00:58:20.010876777+08:00 container top a404c6c174a21c52f199cfce476e041074ab020453c7df2a13a7869b48f2f37e (image=mysql:5.6, name=mymysql)2016-07-11T01:06:01.395365098+08:00 container top a404c6c174a21c52f199cfce476e041074ab020453c7df2a13a7869b48f2f37e (image=mysql:5.6, name=mymysql)å¦‚æžœæŒ‡å®šçš„æ—¶é—´æ˜¯åˆ°ç§’çº§çš„ï¼Œéœ€è¦å°†æ—¶é—´è½¬æˆæ—¶é—´æˆ³ã€‚å¦‚æžœæ—¶é—´ä¸ºæ—¥æœŸçš„è¯ï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨ï¼Œå¦‚--since=&quot;2016-07-01&quot;ã€‚logs1234567891011121314151617181920212223242526272829docker logs : èŽ·å–å®¹å™¨çš„æ—¥å¿—è¯­æ³•docker logs [OPTIONS] CONTAINEROPTIONSè¯´æ˜Žï¼š -f : è·Ÿè¸ªæ—¥å¿—è¾“å‡º --since :æ˜¾ç¤ºæŸä¸ªå¼€å§‹æ—¶é—´çš„æ‰€æœ‰æ—¥å¿— -t : æ˜¾ç¤ºæ—¶é—´æˆ³ --tail :ä»…åˆ—å‡ºæœ€æ–°Næ¡å®¹å™¨æ—¥å¿—å®žä¾‹è·Ÿè¸ªæŸ¥çœ‹å®¹å™¨mynginxçš„æ—¥å¿—è¾“å‡ºã€‚runoob@runoob:~$ docker logs -f mynginx192.168.239.1 - - [10/Jul/2016:16:53:33 +0000] &quot;GET / HTTP/1.1&quot; 200 612 &quot;-&quot; &quot;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.93 Safari/537.36&quot; &quot;-&quot;2016/07/10 16:53:33 [error] 5#5: *1 open() &quot;/usr/share/nginx/html/favicon.ico&quot; failed (2: No such file or directory), client: 192.168.239.1, server: localhost, request: &quot;GET /favicon.ico HTTP/1.1&quot;, host: &quot;192.168.239.130&quot;, referrer: &quot;http://192.168.239.130/&quot;192.168.239.1 - - [10/Jul/2016:16:53:33 +0000] &quot;GET /favicon.ico HTTP/1.1&quot; 404 571 &quot;http://192.168.239.130/&quot; &quot;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.93 Safari/537.36&quot; &quot;-&quot;192.168.239.1 - - [10/Jul/2016:16:53:59 +0000] &quot;GET / HTTP/1.1&quot; 304 0 &quot;-&quot; &quot;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.93 Safari/537.36&quot; &quot;-&quot;...æŸ¥çœ‹å®¹å™¨mynginxä»Ž2016å¹´7æœˆ1æ—¥åŽçš„æœ€æ–°10æ¡æ—¥å¿—ã€‚docker logs --since=&quot;2016-07-01&quot; --tail=10 mynginxwait12345678docker wait : é˜»å¡žè¿è¡Œç›´åˆ°å®¹å™¨åœæ­¢ï¼Œç„¶åŽæ‰“å°å‡ºå®ƒçš„é€€å‡ºä»£ç ã€‚è¯­æ³•docker wait [OPTIONS] CONTAINER [CONTAINER...]å®žä¾‹docker wait CONTAINERexport12345678910111213141516docker export :å°†æ–‡ä»¶ç³»ç»Ÿä½œä¸ºä¸€ä¸ªtarå½’æ¡£æ–‡ä»¶å¯¼å‡ºåˆ°STDOUTã€‚è¯­æ³•docker export [OPTIONS] CONTAINEROPTIONSè¯´æ˜Žï¼š -o :å°†è¾“å…¥å†…å®¹å†™åˆ°æ–‡ä»¶ã€‚å®žä¾‹å°†idä¸ºa404c6c174a2çš„å®¹å™¨æŒ‰æ—¥æœŸä¿å­˜ä¸ºtaræ–‡ä»¶ã€‚runoob@runoob:~$ docker export -o mysql-`date +%Y%m%d`.tar a404c6c174a2runoob@runoob:~$ ls mysql-`date +%Y%m%d`.tarmysql-20160711.tarport1234567891011docker port :åˆ—å‡ºæŒ‡å®šçš„å®¹å™¨çš„ç«¯å£æ˜ å°„ï¼Œæˆ–è€…æŸ¥æ‰¾å°†PRIVATE_PORT NATåˆ°é¢å‘å…¬ä¼—çš„ç«¯å£ã€‚è¯­æ³•docker port [OPTIONS] CONTAINER [PRIVATE_PORT[/PROTO]]å®žä¾‹æŸ¥çœ‹å®¹å™¨mynginxçš„ç«¯å£æ˜ å°„æƒ…å†µã€‚runoob@runoob:~$ docker port mymysql3306/tcp -&gt; 0.0.0.0:3306å®¹å™¨rootfså‘½ä»¤commit123456789101112131415161718192021222324docker commit :ä»Žå®¹å™¨åˆ›å»ºä¸€ä¸ªæ–°çš„é•œåƒã€‚è¯­æ³•docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]]OPTIONSè¯´æ˜Žï¼š -a :æäº¤çš„é•œåƒä½œè€…ï¼› -c :ä½¿ç”¨DockerfileæŒ‡ä»¤æ¥åˆ›å»ºé•œåƒï¼› -m :æäº¤æ—¶çš„è¯´æ˜Žæ–‡å­—ï¼› -p :åœ¨commitæ—¶ï¼Œå°†å®¹å™¨æš‚åœã€‚å®žä¾‹å°†å®¹å™¨a404c6c174a2 ä¿å­˜ä¸ºæ–°çš„é•œåƒ,å¹¶æ·»åŠ æäº¤äººä¿¡æ¯å’Œè¯´æ˜Žä¿¡æ¯ã€‚runoob@runoob:~$ docker commit -a &quot;runoob.com&quot; -m &quot;my apache&quot; a404c6c174a2 mymysql:v1 sha256:37af1236adef1544e8886be23010b66577647a40bc02c0885a6600b33ee28057runoob@runoob:~$ docker images mymysql:v1REPOSITORY TAG IMAGE ID CREATED SIZEmymysql v1 37af1236adef 15 seconds ago 329 MBcp123456789101112131415161718192021222324docker cp :ç”¨äºŽå®¹å™¨ä¸Žä¸»æœºä¹‹é—´çš„æ•°æ®æ‹·è´ã€‚è¯­æ³•docker cp [OPTIONS] CONTAINER:SRC_PATH DEST_PATH|-docker cp [OPTIONS] SRC_PATH|- CONTAINER:DEST_PATHOPTIONSè¯´æ˜Žï¼š -L :ä¿æŒæºç›®æ ‡ä¸­çš„é“¾æŽ¥å®žä¾‹å°†ä¸»æœº/www/runoobç›®å½•æ‹·è´åˆ°å®¹å™¨96f7f14e99abçš„/wwwç›®å½•ä¸‹ã€‚docker cp /www/runoob 96f7f14e99ab:/www/å°†ä¸»æœº/www/runoobç›®å½•æ‹·è´åˆ°å®¹å™¨96f7f14e99abä¸­ï¼Œç›®å½•é‡å‘½åä¸ºwwwã€‚docker cp /www/runoob 96f7f14e99ab:/wwwå°†å®¹å™¨96f7f14e99abçš„/wwwç›®å½•æ‹·è´åˆ°ä¸»æœºçš„/tmpç›®å½•ä¸­ã€‚docker cp 96f7f14e99ab:/www /tmp/diff1234567891011121314151617docker diff : æ£€æŸ¥å®¹å™¨é‡Œæ–‡ä»¶ç»“æž„çš„æ›´æ”¹ã€‚è¯­æ³•docker diff [OPTIONS] CONTAINERå®žä¾‹æŸ¥çœ‹å®¹å™¨mymysqlçš„æ–‡ä»¶ç»“æž„æ›´æ”¹ã€‚runoob@runoob:~$ docker diff mymysqlA /logsA /mysql_dataC /runC /run/mysqldA /run/mysqld/mysqld.pidA /run/mysqld/mysqld.sockC /tmpé•œåƒä»“åº“login123456789101112131415161718192021222324docker login : ç™»é™†åˆ°ä¸€ä¸ªDockeré•œåƒä»“åº“ï¼Œå¦‚æžœæœªæŒ‡å®šé•œåƒä»“åº“åœ°å€ï¼Œé»˜è®¤ä¸ºå®˜æ–¹ä»“åº“ Docker Hubdocker logout : ç™»å‡ºä¸€ä¸ªDockeré•œåƒä»“åº“ï¼Œå¦‚æžœæœªæŒ‡å®šé•œåƒä»“åº“åœ°å€ï¼Œé»˜è®¤ä¸ºå®˜æ–¹ä»“åº“ Docker Hubè¯­æ³•docker login [OPTIONS] [SERVER]docker logout [OPTIONS] [SERVER]OPTIONSè¯´æ˜Žï¼š -u :ç™»é™†çš„ç”¨æˆ·å -p :ç™»é™†çš„å¯†ç å®žä¾‹ç™»é™†åˆ°Docker Hubdocker login -u ç”¨æˆ·å -p å¯†ç ç™»å‡ºDocker Hubdocker logoutpull1234567891011121314151617181920docker pull : ä»Žé•œåƒä»“åº“ä¸­æ‹‰å–æˆ–è€…æ›´æ–°æŒ‡å®šé•œåƒè¯­æ³•docker pull [OPTIONS] NAME[:TAG|@DIGEST]OPTIONSè¯´æ˜Žï¼š -a :æ‹‰å–æ‰€æœ‰ tagged é•œåƒ --disable-content-trust :å¿½ç•¥é•œåƒçš„æ ¡éªŒ,é»˜è®¤å¼€å¯å®žä¾‹ä»ŽDocker Hubä¸‹è½½javaæœ€æ–°ç‰ˆé•œåƒã€‚docker pull javaä»ŽDocker Hubä¸‹è½½REPOSITORYä¸ºjavaçš„æ‰€æœ‰é•œåƒã€‚docker pull -a javapush1234567891011121314docker push : å°†æœ¬åœ°çš„é•œåƒä¸Šä¼ åˆ°é•œåƒä»“åº“,è¦å…ˆç™»é™†åˆ°é•œåƒä»“åº“è¯­æ³•docker push [OPTIONS] NAME[:TAG]OPTIONSè¯´æ˜Žï¼š --disable-content-trust :å¿½ç•¥é•œåƒçš„æ ¡éªŒ,é»˜è®¤å¼€å¯å®žä¾‹ä¸Šä¼ æœ¬åœ°é•œåƒmyapache:v1åˆ°é•œåƒä»“åº“ä¸­ã€‚docker push myapache:v1search12345678910111213141516171819202122232425docker search : ä»ŽDocker HubæŸ¥æ‰¾é•œåƒè¯­æ³•docker search [OPTIONS] TERMOPTIONSè¯´æ˜Žï¼š --automated :åªåˆ—å‡º automated buildç±»åž‹çš„é•œåƒï¼› --no-trunc :æ˜¾ç¤ºå®Œæ•´çš„é•œåƒæè¿°ï¼› -s :åˆ—å‡ºæ”¶è—æ•°ä¸å°äºŽæŒ‡å®šå€¼çš„é•œåƒã€‚å®žä¾‹ä»ŽDocker HubæŸ¥æ‰¾æ‰€æœ‰é•œåƒååŒ…å«javaï¼Œå¹¶ä¸”æ”¶è—æ•°å¤§äºŽ10çš„é•œåƒrunoob@runoob:~$ docker search -s 10 javaNAME DESCRIPTION STARS OFFICIAL AUTOMATEDjava Java is a concurrent, class-based... 1037 [OK] anapsix/alpine-java Oracle Java 8 (and 7) with GLIBC ... 115 [OK]develar/java 46 [OK]isuper/java-oracle This repository contains all java... 38 [OK]lwieske/java-8 Oracle Java 8 Container - Full + ... 27 [OK]nimmis/java-centos This is docker images of CentOS 7... 13 [OK]æœ¬åœ°é•œåƒç®¡ç†images123456789101112131415161718192021222324252627282930313233343536373839404142docker images : åˆ—å‡ºæœ¬åœ°é•œåƒã€‚è¯­æ³•docker images [OPTIONS] [REPOSITORY[:TAG]]OPTIONSè¯´æ˜Žï¼š -a :åˆ—å‡ºæœ¬åœ°æ‰€æœ‰çš„é•œåƒï¼ˆå«ä¸­é—´æ˜ åƒå±‚ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿‡æ»¤æŽ‰ä¸­é—´æ˜ åƒå±‚ï¼‰ï¼› --digests :æ˜¾ç¤ºé•œåƒçš„æ‘˜è¦ä¿¡æ¯ï¼› -f :æ˜¾ç¤ºæ»¡è¶³æ¡ä»¶çš„é•œåƒï¼› --format :æŒ‡å®šè¿”å›žå€¼çš„æ¨¡æ¿æ–‡ä»¶ï¼› --no-trunc :æ˜¾ç¤ºå®Œæ•´çš„é•œåƒä¿¡æ¯ï¼› -q :åªæ˜¾ç¤ºé•œåƒIDã€‚å®žä¾‹æŸ¥çœ‹æœ¬åœ°é•œåƒåˆ—è¡¨ã€‚runoob@runoob:~$ docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEmymysql v1 37af1236adef 5 minutes ago 329 MBrunoob/ubuntu v4 1c06aa18edee 2 days ago 142.1 MB&lt;none&gt; &lt;none&gt; 5c6e1090e771 2 days ago 165.9 MBhttpd latest ed38aaffef30 11 days ago 195.1 MBalpine latest 4e38e38c8ce0 2 weeks ago 4.799 MBmongo 3.2 282fd552add6 3 weeks ago 336.1 MBredis latest 4465e4bcad80 3 weeks ago 185.7 MBphp 5.6-fpm 025041cd3aa5 3 weeks ago 456.3 MBpython 3.5 045767ddf24a 3 weeks ago 684.1 MB...åˆ—å‡ºæœ¬åœ°é•œåƒä¸­REPOSITORYä¸ºubuntuçš„é•œåƒåˆ—è¡¨ã€‚root@runoob:~# docker images ubuntuREPOSITORY TAG IMAGE ID CREATED SIZEubuntu 14.04 90d5884b1ee0 9 weeks ago 188 MBubuntu 15.10 4e3b13c8a266 3 months ago 136.3 MBrmi12345678910111213141516171819202122232425262728293031323334353637383940414243444546docker rmi : åˆ é™¤æœ¬åœ°ä¸€ä¸ªæˆ–å¤šå°‘é•œåƒã€‚è¯­æ³•docker rmi [OPTIONS] IMAGE [IMAGE...]OPTIONSè¯´æ˜Žï¼š -f :å¼ºåˆ¶åˆ é™¤ï¼› --no-prune :ä¸ç§»é™¤è¯¥é•œåƒçš„è¿‡ç¨‹é•œåƒï¼Œé»˜è®¤ç§»é™¤ï¼›å®žä¾‹å¼ºåˆ¶åˆ é™¤æœ¬åœ°é•œåƒ runoob/ubuntu:v4ã€‚root@runoob:~# docker rmi -f runoob/ubuntu:v4Untagged: runoob/ubuntu:v4Deleted: sha256:1c06aa18edee44230f93a90a7d88139235de12cd4c089d41eed8419b503072beDeleted: sha256:85feb446e89a28d58ee7d80ea5ce367eebb7cec70f0ec18aa4faa874cbd97c73prune å‘½ä»¤ç”¨æ¥åˆ é™¤ä¸å†ä½¿ç”¨çš„ docker å¯¹è±¡ã€‚åˆ é™¤æ‰€æœ‰æœªè¢« tag æ ‡è®°å’Œæœªè¢«å®¹å™¨ä½¿ç”¨çš„é•œåƒ:$ docker image pruneWARNING! This will remove all dangling images.Are you sure you want to continue? [y/N] yåˆ é™¤æ‰€æœ‰æœªè¢«å®¹å™¨ä½¿ç”¨çš„é•œåƒ:$ docker image prune -aåˆ é™¤æ‰€æœ‰åœæ­¢è¿è¡Œçš„å®¹å™¨:$ docker container pruneåˆ é™¤æ‰€æœ‰æœªè¢«æŒ‚è½½çš„å·:$ docker volume pruneåˆ é™¤æ‰€æœ‰ç½‘ç»œ:$ docker network pruneåˆ é™¤ docker æ‰€æœ‰èµ„æº:$ docker system prunetag12345678910111213docker tag : æ ‡è®°æœ¬åœ°é•œåƒï¼Œå°†å…¶å½’å…¥æŸä¸€ä»“åº“ã€‚è¯­æ³•docker tag [OPTIONS] IMAGE[:TAG] [REGISTRYHOST/][USERNAME/]NAME[:TAG]å®žä¾‹å°†é•œåƒubuntu:15.10æ ‡è®°ä¸º runoob/ubuntu:v3 é•œåƒã€‚root@runoob:~# docker tag ubuntu:15.10 runoob/ubuntu:v3root@runoob:~# docker images runoob/ubuntu:v3REPOSITORY TAG IMAGE ID CREATED SIZErunoob/ubuntu v3 4e3b13c8a266 3 months ago 136.3 MBbuild1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768docker build å‘½ä»¤ç”¨äºŽä½¿ç”¨ Dockerfile åˆ›å»ºé•œåƒã€‚è¯­æ³•docker build [OPTIONS] PATH | URL | -OPTIONSè¯´æ˜Žï¼š --build-arg=[] :è®¾ç½®é•œåƒåˆ›å»ºæ—¶çš„å˜é‡ï¼› --cpu-shares :è®¾ç½® cpu ä½¿ç”¨æƒé‡ï¼› --cpu-period :é™åˆ¶ CPU CFSå‘¨æœŸï¼› --cpu-quota :é™åˆ¶ CPU CFSé…é¢ï¼› --cpuset-cpus :æŒ‡å®šä½¿ç”¨çš„CPU idï¼› --cpuset-mems :æŒ‡å®šä½¿ç”¨çš„å†…å­˜ idï¼› --disable-content-trust :å¿½ç•¥æ ¡éªŒï¼Œé»˜è®¤å¼€å¯ï¼› -f :æŒ‡å®šè¦ä½¿ç”¨çš„Dockerfileè·¯å¾„ï¼› --force-rm :è®¾ç½®é•œåƒè¿‡ç¨‹ä¸­åˆ é™¤ä¸­é—´å®¹å™¨ï¼› --isolation :ä½¿ç”¨å®¹å™¨éš”ç¦»æŠ€æœ¯ï¼› --label=[] :è®¾ç½®é•œåƒä½¿ç”¨çš„å…ƒæ•°æ®ï¼› -m :è®¾ç½®å†…å­˜æœ€å¤§å€¼ï¼› --memory-swap :è®¾ç½®Swapçš„æœ€å¤§å€¼ä¸ºå†…å­˜+swapï¼Œ&quot;-1&quot;è¡¨ç¤ºä¸é™swapï¼› --no-cache :åˆ›å»ºé•œåƒçš„è¿‡ç¨‹ä¸ä½¿ç”¨ç¼“å­˜ï¼› --pull :å°è¯•åŽ»æ›´æ–°é•œåƒçš„æ–°ç‰ˆæœ¬ï¼› --quiet, -q :å®‰é™æ¨¡å¼ï¼ŒæˆåŠŸåŽåªè¾“å‡ºé•œåƒ IDï¼› --rm :è®¾ç½®é•œåƒæˆåŠŸåŽåˆ é™¤ä¸­é—´å®¹å™¨ï¼› --shm-size :è®¾ç½®/dev/shmçš„å¤§å°ï¼Œé»˜è®¤å€¼æ˜¯64Mï¼› --ulimit :Ulimité…ç½®ã€‚ --tag, -t: é•œåƒçš„åå­—åŠæ ‡ç­¾ï¼Œé€šå¸¸ name:tag æˆ–è€… name æ ¼å¼ï¼›å¯ä»¥åœ¨ä¸€æ¬¡æž„å»ºä¸­ä¸ºä¸€ä¸ªé•œåƒè®¾ç½®å¤šä¸ªæ ‡ç­¾ã€‚ --network: é»˜è®¤ defaultã€‚åœ¨æž„å»ºæœŸé—´è®¾ç½®RUNæŒ‡ä»¤çš„ç½‘ç»œæ¨¡å¼å®žä¾‹ä½¿ç”¨å½“å‰ç›®å½•çš„ Dockerfile åˆ›å»ºé•œåƒï¼Œæ ‡ç­¾ä¸º runoob/ubuntu:v1ã€‚docker build -t runoob/ubuntu:v1 . ä½¿ç”¨URL github.com/creack/docker-firefox çš„ Dockerfile åˆ›å»ºé•œåƒã€‚docker build github.com/creack/docker-firefoxä¹Ÿå¯ä»¥é€šè¿‡ -f Dockerfile æ–‡ä»¶çš„ä½ç½®ï¼š$ docker build -f /path/to/a/Dockerfile .åœ¨ Docker å®ˆæŠ¤è¿›ç¨‹æ‰§è¡Œ Dockerfile ä¸­çš„æŒ‡ä»¤å‰ï¼Œé¦–å…ˆä¼šå¯¹ Dockerfile è¿›è¡Œè¯­æ³•æ£€æŸ¥ï¼Œæœ‰è¯­æ³•é”™è¯¯æ—¶ä¼šè¿”å›žï¼š$ docker build -t test/myapp .Sending build context to Docker daemon 2.048 kBError response from daemon: Unknown instruction: RUNCMDhistory1234567891011121314151617181920212223docker history : æŸ¥çœ‹æŒ‡å®šé•œåƒçš„åˆ›å»ºåŽ†å²ã€‚è¯­æ³•docker history [OPTIONS] IMAGEOPTIONSè¯´æ˜Žï¼š -H :ä»¥å¯è¯»çš„æ ¼å¼æ‰“å°é•œåƒå¤§å°å’Œæ—¥æœŸï¼Œé»˜è®¤ä¸ºtrueï¼› --no-trunc :æ˜¾ç¤ºå®Œæ•´çš„æäº¤è®°å½•ï¼› -q :ä»…åˆ—å‡ºæäº¤è®°å½•IDã€‚å®žä¾‹æŸ¥çœ‹æœ¬åœ°é•œåƒrunoob/ubuntu:v3çš„åˆ›å»ºåŽ†å²ã€‚root@runoob:~# docker history runoob/ubuntu:v3IMAGE CREATED CREATED BY SIZE COMMENT4e3b13c8a266 3 months ago /bin/sh -c #(nop) CMD [&quot;/bin/bash&quot;] 0 B &lt;missing&gt; 3 months ago /bin/sh -c sed -i &apos;s/^#\s*\(deb.*universe\)$/ 1.863 kB &lt;missing&gt; 3 months ago /bin/sh -c set -xe &amp;&amp; echo &apos;#!/bin/sh&apos; &gt; /u 701 B &lt;missing&gt; 3 months ago /bin/sh -c #(nop) ADD file:43cb048516c6b80f22 136.3 MBsave12345678910111213141516171819202122232425262728293031323334docker save : å°†æŒ‡å®šé•œåƒä¿å­˜æˆ tar å½’æ¡£æ–‡ä»¶ã€‚è¯­æ³•docker save [OPTIONS] IMAGE [IMAGE...]OPTIONS è¯´æ˜Žï¼š -o :è¾“å‡ºåˆ°çš„æ–‡ä»¶ã€‚å®žä¾‹å°†é•œåƒ runoob/ubuntu:v3 ç”Ÿæˆ my_ubuntu_v3.tar æ–‡æ¡£runoob@runoob:~$ docker save -o my_ubuntu_v3.tar runoob/ubuntu:v3runoob@runoob:~$ ll my_ubuntu_v3.tar-rw------- 1 runoob runoob 142102016 Jul 11 01:37 my_ubuntu_v3.tadocker å®¹å™¨å¯¼å…¥å¯¼å‡ºæœ‰ä¸¤ç§æ–¹æ³•ï¼šä¸€ç§æ˜¯ä½¿ç”¨ save å’Œ load å‘½ä»¤ä½¿ç”¨ä¾‹å­å¦‚ä¸‹ï¼šdocker save ubuntu:load&gt;/root/ubuntu.tardocker load&lt;ubuntu.tarä¸€ç§æ˜¯ä½¿ç”¨ export å’Œ import å‘½ä»¤ä½¿ç”¨ä¾‹å­å¦‚ä¸‹ï¼šdocker export 98ca36&gt; ubuntu.tarcat ubuntu.tar | sudo docker import - ubuntu:importéœ€è¦æ³¨æ„ä¸¤ç§æ–¹æ³•ä¸å¯æ··ç”¨ã€‚load1234567891011121314151617docker load : å¯¼å…¥ä½¿ç”¨ docker save å‘½ä»¤å¯¼å‡ºçš„é•œåƒã€‚è¯­æ³•docker load [OPTIONS]OPTIONS è¯´æ˜Žï¼š -i :æŒ‡å®šå¯¼å‡ºçš„æ–‡ä»¶ã€‚ -q :ç²¾ç®€è¾“å‡ºä¿¡æ¯ã€‚å®žä¾‹å¯¼å…¥é•œåƒï¼šdocker load -i ubuntu.tardocker load &lt; ubuntu.tarimport1234567891011121314151617181920docker import : ä»Žå½’æ¡£æ–‡ä»¶ä¸­åˆ›å»ºé•œåƒã€‚è¯­æ³•docker import [OPTIONS] file|URL|- [REPOSITORY[:TAG]]OPTIONSè¯´æ˜Žï¼š -c :åº”ç”¨docker æŒ‡ä»¤åˆ›å»ºé•œåƒï¼› -m :æäº¤æ—¶çš„è¯´æ˜Žæ–‡å­—ï¼›å®žä¾‹ä»Žé•œåƒå½’æ¡£æ–‡ä»¶my_ubuntu_v3.taråˆ›å»ºé•œåƒï¼Œå‘½åä¸ºrunoob/ubuntu:v4runoob@runoob:~$ docker import my_ubuntu_v3.tar runoob/ubuntu:v4 sha256:63ce4a6d6bc3fabb95dbd6c561404a309b7bdfc4e21c1d59fe9fe4299cbfea39runoob@runoob:~$ docker images runoob/ubuntu:v4REPOSITORY TAG IMAGE ID CREATED SIZErunoob/ubuntu v4 63ce4a6d6bc3 20 seconds ago 142.1 MBinfo|versioninfo12345678910111213141516171819202122232425docker info : æ˜¾ç¤º Docker ç³»ç»Ÿä¿¡æ¯ï¼ŒåŒ…æ‹¬é•œåƒå’Œå®¹å™¨æ•°ã€‚ã€‚è¯­æ³•docker info [OPTIONS]å®žä¾‹æŸ¥çœ‹dockerç³»ç»Ÿä¿¡æ¯ã€‚$ docker infoContainers: 12Images: 41Storage Driver: aufs Root Dir: /var/lib/docker/aufs Backing Filesystem: extfs Dirs: 66 Dirperm1 Supported: falseExecution Driver: native-0.2Logging Driver: json-fileKernel Version: 3.13.0-32-genericOperating System: Ubuntu 14.04.1 LTSCPUs: 1Total Memory: 1.954 GiBName: iZ23mtq8bs1ZID: M5N4:K6WN:PUNC:73ZN:AONJ:AUHL:KSYH:2JPI:CH3K:O4MK:6OCX:5OYWversion1234567891011121314151617181920212223242526272829docker version :æ˜¾ç¤º Docker ç‰ˆæœ¬ä¿¡æ¯ã€‚è¯­æ³•docker version [OPTIONS]OPTIONSè¯´æ˜Žï¼š -f :æŒ‡å®šè¿”å›žå€¼çš„æ¨¡æ¿æ–‡ä»¶ã€‚å®žä¾‹æ˜¾ç¤º Docker ç‰ˆæœ¬ä¿¡æ¯ã€‚$ docker versionClient: Version: 1.8.2 API version: 1.20 Go version: go1.4.2 Git commit: 0a8c2e3 Built: Thu Sep 10 19:19:00 UTC 2015 OS/Arch: linux/amd64Server: Version: 1.8.2 API version: 1.20 Go version: go1.4.2 Git commit: 0a8c2e3 Built: Thu Sep 10 19:19:00 UTC 2015 OS/Arch: linux/amd64Docker èµ„æºæ±‡æ€»Dockerå®˜æ–¹è‹±æ–‡èµ„æºdockerå®˜ç½‘ï¼šhttp://www.docker.comDocker Windows å…¥é—¨ï¼šhttps://docs.docker.com/docker-for-windows/Docker CE(ç¤¾åŒºç‰ˆ) Ubuntuï¼šhttps://docs.docker.com/install/linux/docker-ce/ubuntu/Docker mac å…¥é—¨ï¼šhttps://docs.docker.com/docker-for-mac/Docker ç”¨æˆ·æŒ‡å¼•ï¼šhttps://docs.docker.com/config/daemon/Docker å®˜æ–¹åšå®¢ï¼šhttp://blog.docker.com/Docker Hub: https://hub.docker.com/Dockerå¼€æºï¼š https://www.docker.com/open-sourceDockerä¸­æ–‡èµ„æºDockerä¸­æ–‡ç½‘ç«™ï¼šhttps://www.docker-cn.com/Dockerå®‰è£…æ‰‹å†Œï¼šhttps://docs.docker-cn.com/engine/installation/Docker å›½å†…é•œåƒé˜¿é‡Œäº‘çš„åŠ é€Ÿå™¨ï¼šhttps://help.aliyun.com/document_detail/60750.htmlç½‘æ˜“åŠ é€Ÿå™¨ï¼šhttp://hub-mirror.c.163.comå®˜æ–¹ä¸­å›½åŠ é€Ÿå™¨ï¼šhttps://registry.docker-cn.comustcçš„é•œåƒï¼šhttps://docker.mirrors.ustc.edu.cndaocloudï¼šhttps://www.daocloud.io/mirror#accelerator-docï¼ˆæ³¨å†ŒåŽä½¿ç”¨ï¼‰]]></content>
      <categories>
        <category>CentOS</category>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>CentOS</tag>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä»Ž0çŽ©è½¬jQuery]]></title>
    <url>%2F2019%2F07%2F10%2F%E4%BB%8E0%E7%8E%A9%E8%BD%ACjQuery%2F</url>
    <content type="text"><![CDATA[ä¸€ã€åˆè¯†jQueryè¯¾å‰é¡»çŸ¥: å­¦ä¹ jQueryå‰å¿…é¡»å…ˆæŽŒæ¡JavaScriptjQueryè™½ç„¶å±žäºŽå‰ç«¯æŠ€æœ¯, ä½†æ˜¯å¯¹äºŽåŽç«¯äººå‘˜(è¯¸å¦‚Javaã€PHPç­‰,ä¹Ÿéœ€è¦æŽŒæ¡)1. jQueryæ˜¯ä»€ä¹ˆï¼ŸjQueryæ˜¯ä¸€æ¬¾ä¼˜ç§€çš„JavaScriptåº“ï¼Œä»Žå‘½åå¯ä»¥çœ‹å‡ºjQueryæœ€ä¸»è¦çš„ç”¨é€”æ˜¯ç”¨æ¥åšæŸ¥è¯¢ï¼ˆjQuery=js+Queryï¼‰.åœ¨jQueryå®˜æ–¹Logoä¸‹æ–¹è¿˜æœ‰ä¸€ä¸ªå‰¯æ ‡é¢˜ï¼ˆwrite less, do moreï¼‰, ä½“çŽ°äº†jQueryé™¤äº†æŸ¥è¯¢ä»¥å¤–,è¿˜èƒ½è®©æˆ‘ä»¬å¯¹HTMLæ–‡æ¡£éåŽ†å’Œæ“ä½œã€äº‹ä»¶å¤„ç†ã€åŠ¨ç”»ä»¥åŠAjaxå˜å¾—æ›´åŠ ç®€å•ä½“éªŒjQueryåŽŸç”ŸJSè®¾ç½®èƒŒæ™¯ï¼ˆå…ˆä¸è¦æ±‚çœ‹æ‡‚ä»£ç ï¼Œå…ˆçœ‹çœ‹è°æ›´çˆ½ï¼‰12345678910111213141516171819202122232425&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;01-åˆè¯†jQuery&lt;/title&gt; &lt;script type="text/javascript"&gt; window.onload = function (ev) &#123; // æŸ¥è¯¢ var div = document.getElementsByClassName("box01"); // æ“ä½œcss div[0].style.backgroundColor = "red"; &#125;; &lt;/script&gt; &lt;style type="text/css"&gt; div &#123; width: 100px; height: 100px; border: 1px solid #000000; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="box01"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;ä½¿ç”¨jQueryè®¾ç½®èƒŒæ™¯123456789101112131415161718192021222324&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;01-åˆè¯†jQuery&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(document).ready(function () &#123; // æŸ¥è¯¢ï¼Œæ“ä½œCSSä¸€æ­¥åˆ°ä½ $("div").eq(0).css('background', 'yellow'); &#125;); &lt;/script&gt; &lt;style type="text/css"&gt; div &#123; width: 100px; height: 100px; border: 1px solid #000000; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="box01"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;2. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨jQueryï¼Ÿå¼ºå¤§çš„é€‰æ‹©å™¨: æ–¹ä¾¿å¿«é€ŸæŸ¥æ‰¾DOMå…ƒç´ å¦‚ä¸Šé¢å®žä¾‹æ‰€å±•ç¤ºä¸€æ ·ï¼Œé€šè¿‡jQueryæŸ¥æ‰¾DOMå…ƒç´ è¦æ¯”åŽŸç”Ÿjså¿«æ·å¾ˆå¤šjQueryå…è®¸å¼€å‘è€…ä½¿ç”¨CSS1-CSS3å‡ ä¹Žæ‰€æœ‰çš„é€‰æ‹©å™¨,ä»¥åŠjQueryç‹¬åˆ›çš„é€‰æ‹©å™¨æ”¯æŒé“¾å¼è°ƒç”¨: å¯ä»¥é€šè¿‡.ä¸æ–­è°ƒç”¨jQueryå¯¹è±¡çš„æ–¹æ³•å¦‚ä¸Šé¢å®žä¾‹æ‰€å±•ç¤ºä¸€æ ·ï¼ŒjQueryå¯ä»¥é€šè¿‡.ï¼ˆç‚¹ï¼‰.ä¸æ–­è°ƒç”¨jQueryå¯¹è±¡çš„æ–¹æ³•ï¼Œè€ŒåŽŸç”ŸJavaScriptåˆ™ä¸ä¸€å®š12345678910111213141516171819202122232425262728293031&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;01-åˆè¯†jQuery&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; // 1.åŽŸç”ŸJavaScript var div = document.getElementsByTagName("div"); // æŠ¥é”™,å¿…é¡»åˆ†å¼€å†™ div[0].style.backgroundColor = "red".width = 200 + "px"; // div[0].style.width = 200+"px"; // 2.jQuery $(document).ready(function () &#123; // ä¸æŠ¥é”™,åŽé¢è¿˜å¯ä»¥æŽ¥ç€ç»§ç»­å†™ $("div").eq(1).css('background', 'yellow').css('width', '200px'); &#125;); &lt;/script&gt; &lt;style type="text/css"&gt; div &#123; width: 100px; height: 100px; border: 1px solid #000000; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="box01"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;éšå¼éåŽ†(è¿­ä»£): ä¸€æ¬¡æ“ä½œå¤šä¸ªå…ƒç´ 12345678910111213141516171819202122232425262728293031323334&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;01-åˆè¯†jQuery&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; // 1.åŽŸç”ŸJavaScript var div = document.getElementsByTagName("div"); // div.style.backgroundColor = "red";// æ— æ•ˆ for (var i = 0; i &lt; div.length; i++) &#123; div[i].style.backgroundColor = "red"; &#125; // 2.jQuery $(document).ready(function () &#123; // éšå¼éåŽ†(è¿­ä»£)æ‰¾åˆ°çš„æ‰€æœ‰div $("div").css('background', 'yellow'); &#125;); &lt;/script&gt; &lt;style type="text/css"&gt; div &#123; width: 100px; height: 100px; border: 1px solid #000000; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div&gt;div1&lt;/div&gt;&lt;div&gt;div2&lt;/div&gt;&lt;div&gt;div3&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;è¯»å†™åˆä¸€: è¯»æ•°æ®/å†™æ•°æ®ä½¿ç”¨æ˜¯ä¸€ä¸ªå‡½æ•°1234567891011121314151617181920212223242526272829&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;01-åˆè¯†jQuery&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(document).ready(function () &#123; // è¯»å–æ•°æ® var $tx = $("div").eq(0).text(); alert($tx); // å†™å…¥æ•°æ® $("div").eq(0).text("æ–°çš„æ•°æ®"); &#125;); &lt;/script&gt; &lt;style type="text/css"&gt; div &#123; width: 100px; height: 100px; border: 1px solid #000000; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div&gt;div1&lt;/div&gt;&lt;div&gt;div2&lt;/div&gt;&lt;div&gt;div3&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;äº‹ä»¶å¤„ç†DOMæ“ä½œ(Cå¢žUæ”¹Dåˆ )æ ·å¼æ“ä½œåŠ¨ç”»ä¸°å¯Œçš„æ’ä»¶æ”¯æŒæµè§ˆå™¨å…¼å®¹(å‰ç«¯å¼€å‘è€…ç—›ç‚¹)1.xï¼šå…¼å®¹IE678ï¼Œä½†ç›¸å¯¹å…¶å®ƒç‰ˆæœ¬æ–‡ä»¶è¾ƒå¤§ï¼Œå®˜æ–¹åªåšBUGç»´æŠ¤ï¼ŒåŠŸèƒ½ä¸å†æ–°å¢žï¼Œæœ€ç»ˆç‰ˆæœ¬ï¼š1.12.4 (2016å¹´5æœˆ20æ—¥).2.xï¼šä¸å…¼å®¹IE678ï¼Œç›¸å¯¹1.xæ–‡ä»¶è¾ƒå°ï¼Œå®˜æ–¹åªåšBUGç»´æŠ¤ï¼ŒåŠŸèƒ½ä¸å†æ–°å¢žï¼Œæœ€ç»ˆç‰ˆæœ¬ï¼š2.2.4 (2016å¹´5æœˆ20æ—¥)3.xï¼šä¸å…¼å®¹IE678ï¼Œåªæ”¯æŒæœ€æ–°çš„æµè§ˆå™¨ï¼Œå¾ˆå¤šè€çš„jQueryæ’ä»¶ä¸æ”¯æŒè¿™ä¸ªç‰ˆæœ¬ï¼Œç›¸å¯¹1.xæ–‡ä»¶è¾ƒå°ï¼Œæä¾›ä¸åŒ…å«Ajax/åŠ¨ç”»APIç‰ˆæœ¬ã€‚åº”è¯¥é€‰æ‹©å‡ ç‚¹å‡ ç‰ˆæœ¬jQuery?æŸ¥çœ‹ç™¾åº¦ç½‘é¡µæºç ä½¿ç”¨1.xæŸ¥çœ‹è…¾è®¯ç½‘é¡µæºç ä½¿ç”¨1.xæŸ¥çœ‹äº¬ä¸œç½‘é¡µæºç ä½¿ç”¨1.xç»¼ä¸Šæ‰€è¿°å­¦ä¹ 1.x,é€‰æ‹©1.xåº”è¯¥ä½¿ç”¨å¼€å‘ç‰ˆè¿˜æ˜¯ç”Ÿäº§ç‰ˆ?å¼€å‘ç‰ˆ: æ‰€æœ‰ä»£ç æ²¡æœ‰ç»è¿‡åŽ‹ç¼©,ä½“ç§¯æ›´å¤§(200-300KB)ç”Ÿäº§ç‰ˆ:æ‰€æœ‰ä»£ç ç»è¿‡åŽ‹ç¼©,æåŠæ›´å°(30-40KB)åˆå­¦è€…ä¸ºäº†æ›´å¥½çš„ç†è§£jQueryç¼–ç æ—¶ä½¿ç”¨å¼€å‘æ¿,é¡¹ç›®ä¸Šçº¿æ—¶ä¸ºäº†æå‡è®¿é—®é€Ÿåº¦ä½¿ç”¨ç”Ÿäº§ç‰ˆâ€¦â€¦3. å¦‚ä½•ä½¿ç”¨jQueryï¼Ÿä¸‹è½½jQueryåº“ä¸‹è½½åœ°å€: http://code.jquery.com/å¼•å…¥ä¸‹è½½çš„jQueryåº“12345678910111213141516171819202122232425262728&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;02&lt;/title&gt; &lt;!--&lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt;--&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; // æ³¨æ„:ä»¥ä¸‹ä¸¤ä¸ªå¼•å…¥çš„jQueryç‰ˆæœ¬ä¸åŒï¼Œå¼¹å‡ºé¡ºåºä¹Ÿä¸åŒ // å¼•å…¥çš„æ˜¯1.xç‰ˆæœ¬çš„ï¼Œåˆ™å…ˆå¼¹å‡ºjQueryå†™æ³•çš„ï¼Œç„¶åŽå†å¼¹å‡ºåŽŸç”Ÿå†™æ³•çš„ // å¼•å…¥çš„æ˜¯3.xç‰ˆæœ¬çš„ï¼Œåˆ™å…ˆå¼¹å‡ºåŽŸç”Ÿå†™æ³•çš„ï¼Œç„¶åŽå†å¼¹å‡ºjQueryå†™æ³•çš„ // 1.åŽŸç”ŸJSçš„å›ºå®šå†™æ³• window.onload = function (ev) &#123; alert('Hello World! 1'); &#125;; // 2.jQueryçš„å›ºå®šå†™æ³• $(document).ready(function () &#123; alert('Hello World! 2'); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;ç¼–å†™jQueryä»£ç 12345678910111213141516&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;01-åˆè¯†jQuery&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(document).ready(function () &#123; // æ‰€æœ‰jQueryä»£ç å†™åœ¨è¿™é‡Œé¢ alert("hello LNJ"); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;äºŒã€å…¥å£å‡½æ•°1. jQueryä¸ŽJavaScriptåŠ è½½æ¨¡å¼å¯¹æ¯”å¤šä¸ªwindow.onloadåªä¼šæ‰§è¡Œä¸€æ¬¡, åŽé¢çš„ä¼šè¦†ç›–å‰é¢çš„å¤šä¸ª$(document).ready()ä¼šæ‰§è¡Œå¤šæ¬¡,åŽé¢çš„ä¸ä¼šè¦†ç›–å‰é¢çš„ä¸ä¼šè¦†ç›–çš„æœ¬è´¨(äº†è§£,åŽé¢jQueryåŽŸç†ä¼šè¯¦ç»†è®²è§£)jQueryæ¡†æž¶æœ¬è´¨æ˜¯ä¸€ä¸ªé—­åŒ…,æ¯æ¬¡æ‰§è¡Œæˆ‘ä»¬éƒ½ä¼šç»™readyå‡½æ•°ä¼ é€’ä¸€ä¸ªæ–°çš„å‡½æ•°,ä¸åŒå‡½æ•°å†…éƒ¨çš„æ•°æ®ä¸ä¼šç›¸äº’å¹²æ‰°123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;03-jQueryå’ŒjsåŠ è½½æ¨¡å¼&lt;/title&gt; &lt;!--&lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt;--&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; /* * åŽŸç”ŸJSå’ŒjQueryå…¥å£å‡½æ•°çš„çš„åŠ è½½æ¨¡å¼ä¸åŒ * åŽŸç”ŸJSä¼šç­‰åˆ°DOMå…ƒç´ åŠ è½½å®Œæ¯•ï¼Œå¹¶ä¸”å›¾ç‰‡ä¹ŸåŠ è½½å®Œæ¯•æ‰ä¼šæ‰§è¡Œ * jQueryä¼šç­‰åˆ°DOMå…ƒç´ åŠ è½½å®Œæ¯•ï¼Œä½†æ˜¯ä¸ä¼šç­‰åˆ°å›¾ç‰‡ä¹ŸåŠ è½½å®Œæ¯•å°±ä¼šæ‰§è¡Œ */ /* window.onload = function (ev) &#123; // 1.é€šè¿‡åŽŸç”Ÿçš„JSçš„å…¥å£å‡½æ•°å¯ä»¥æ‹¿åˆ°DOMå…ƒç´  var img = document.getElementsByTagName('img')[0]; console.log(img); // å¿«æ·é”®å†™æ³•:å…ˆå†™img,ç„¶åŽå†å†™.log,æœ€åŽæŒ‰Tabé”®å°±ä¼šå‡ºæ¥ // 2.é€šè¿‡åŽŸç”Ÿçš„JSçš„å…¥å£å‡½æ•°å¯ä»¥æ‹¿åˆ°DOMå…ƒç´ çš„å®½åº¦ var width = window.getComputedStyle(img).width; console.log('onload', width); // onload 1024px &#125;; */ /* $(document).ready(function () &#123; // 1.é€šè¿‡jQueryçš„å…¥å£å‡½æ•°å¯ä»¥æ‹¿åˆ°DOMå…ƒç´  var $img = $("img")[0]; console.log($img); // 2.é€šè¿‡jQueryçš„å…¥å£å‡½æ•°ä¸å¯ä»¥æ‹¿åˆ°DOMå…ƒç´ çš„å®½åº¦ var $width = $img.width; console.log('ready', $width); // ready 0 &#125;); */ /* * åŽŸç”ŸJSå¦‚æžœç¼–å†™äº†å¤šä¸ªå…¥å£å‡½æ•°ï¼ŒåŽé¢ç¼–å†™çš„ä¼šè¦†ç›–å‰é¢ç¼–å†™çš„ * jQueryç¼–å†™äº†å¤šä¸ªå…¥å£å‡½æ•°ï¼ŒåŽé¢ç¼–å†™çš„ä¸ä¼šè¦†ç›–å‰é¢ç¼–å†™çš„ */ window.onload = function (ev) &#123; alert('Hello World! 1'); // ä¸å¼¹å‡º &#125;; window.onload = function (ev) &#123; alert('Hello World! 2'); // å¼¹å‡º &#125;; $(document).ready(function () &#123; alert('Hello World! 3'); // å¼¹å‡º &#125;); $(document).ready(function () &#123; alert('Hello World! 4'); // å¼¹å‡º &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;img src="images/é£Žé‡‡é“ƒ.jpg" alt=""&gt;&lt;/body&gt;&lt;/html&gt;window.onload$(document).ready()æ‰§è¡Œæ—¶æœºå¿…é¡»ç­‰å¾…ç½‘é¡µå…¨éƒ¨åŠ è½½å®Œæ¯•(åŒ…æ‹¬å›¾ç‰‡ç­‰),ç„¶åŽå†æ‰§è¡ŒåŒ…è£¹ä»£ç åªéœ€è¦ç­‰å¾…ç½‘é¡µä¸­çš„DOMç»“æž„åŠ è½½å®Œæ¯•,å°±èƒ½æ‰§è¡ŒåŒ…è£¹çš„ä»£ç æ‰§è¡Œæ¬¡æ•°åªèƒ½æ‰§è¡Œä¸€æ¬¡,å¦‚æžœæœ‰ç¬¬äºŒæ¬¡,é‚£ä¹ˆç¬¬ä¸€æ¬¡çš„æ‰§è¡Œä¼šè¢«è¦†ç›–å¯ä»¥æ‰§è¡Œå¤šæ¬¡,ç¬¬Næ¬¡éƒ½ä¸ä¼šè¢«ä¸Š ä¸€æ¬¡è¦†ç›–ç®€å†™æ–¹æ¡ˆæ— $(function () { });ä¸ºä»€ä¹ˆæˆ‘ä»¬èƒ½è®¿é—®$ç¬¦å·?å› ä¸º$ç¬¦å·jQueryæ¡†æž¶å¯¹å¤–æš´éœ²çš„ä¸€ä¸ªå…¨å±€å˜é‡JavaScriptä¸­å¦‚ä½•å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡?æ‰€æœ‰å…¨å±€å˜é‡æ˜¯ window å¯¹è±¡çš„å±žæ€§1234567891011function test () &#123; var customValue = 998; alert(customValue); // 1.æ²¡æœ‰å¦‚ä¸‹ä»£ç customValueå°±ä¸æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡,å‡½æ•°æ‰§è¡Œå®Œæ¯•ä¹‹åŽ // customValueä¼šè¢«è‡ªåŠ¨é‡Šæ”¾,testå‡½æ•°ä»¥å¤–çš„åœ°æ–¹è®¿é—®ä¸åˆ°customValue // 2.åŠ ä¸Šå¦‚ä¸‹ä»£ç ä¹‹åŽcustomValueå°±ä¼šå˜æˆä¸€ä¸ªå…¨å±€å˜é‡,å‡½æ•°æ‰§è¡Œå®Œæ¯•ä¹Ÿä¸ // ä¼šè¢«é‡Šæ”¾,testå‡½æ•°ä»¥å¤–çš„åœ°æ–¹å¯ä»¥è®¿é—®customValue // window.customValue = customValue;&#125;test();alert(customValue);æ‰€ä»¥jQueryæ¡†æž¶æºç å®žçŽ°1window.jQuery = window.$ = jQuery;æ‰€ä»¥æƒ³è¦ä½¿ç”¨jQueryæ¡†æž¶åªæœ‰ä¸¤ç§æ–¹å¼,ä¸€ç§æ˜¯é€šè¿‡$,ä¸€ç§æ˜¯é€šè¿‡jQueryjQueryå…¥å£å‡½æ•°çš„å…¶å®ƒç¼–å†™æ–¹å¼å¦‚ä¸‹1234567891011121314151617181920212223242526272829&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;04-jQueryå…¥å£å‡½æ•°å…¶å®ƒå†™æ³•&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; // æ–¹æ³•ä¸€ $(document).ready(function () &#123; alert('Hello World!'); &#125;); // æ–¹å¼äºŒ (æŽ¨èä½¿ç”¨è¿™ç§å†™æ³•) jQuery(document).ready(function () &#123; alert('Hello World!'); &#125;); // æ–¹å¼ä¸‰ (æŽ¨èä½¿ç”¨è¿™ç§å†™æ³•) $(function () &#123; alert('Hello World!'); &#125;); // æ–¹å¼å›› jQuery(function () &#123; alert('Hello World!'); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;2. è§£å†³$ç¬¦å·å†²çªé—®é¢˜ä¸ºä»€ä¹ˆæ˜¯window.jQuery = window.$ = jQuery;,è€Œä¸æ˜¯window.jQuery = jQuery;jQueryæ¡†æž¶ä¹‹æ‰€ä»¥æä¾›äº†jQueryè®¿é—®è¿˜æä¾›$è®¿é—®,å°±æ˜¯ä¸ºäº†æå‡å¼€å‘è€…çš„ç¼–ç æ•ˆçŽ‡$ç¬¦å·å†²çªæ€Žä¹ˆåŠž?å¾ˆå¤šjsçš„æ¡†æž¶éƒ½æä¾›äº†ç±»ä¼¼jQueryè¿™æ ·çš„ä¾¿æ·è®¿é—®æ–¹å¼,æ‰€ä»¥å¾ˆæœ‰å¯èƒ½æŸä¸€å¤©æˆ‘ä»¬åœ¨ä½¿ç”¨å¤šä¸ªæ¡†æž¶çš„æ—¶,å¤šä¸ªæ¡†æž¶ä½œè€…æä¾›çš„ä¾¿æ·è®¿é—®æ–¹å¼å†²çª(Aæ¡†æž¶é€šè¿‡$è®¿é—®,Bæ¡†æž¶ä¹Ÿé€šè¿‡â€‹$è®¿é—®)é‡Šæ”¾$ä½¿ç”¨æƒå½“ä¾¿æ·è®¿é—®ç¬¦å·å‘ç”Ÿå†²çªæ—¶,æˆ‘ä»¬å¯ä»¥é‡Šæ”¾$ä½¿ç”¨æƒ, é‡Šæ”¾ä¹‹åŽåªèƒ½ä½¿ç”¨jQueryè‡ªå®šä¹‰ä¾¿æ·è®¿é—®ç¬¦å·å½“ä¾¿æ·è®¿é—®ç¬¦å·å‘ç”Ÿå†²çªæ—¶,æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¾¿æ·è®¿é—®ç¬¦å·123456789101112131415161718192021222324252627&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;05-jQueryå†²çªé—®é¢˜&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript" src="js/test.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; // 1.é‡Šæ”¾$ç¬¦å·çš„æŽ§åˆ¶æƒ // æ³¨æ„ç‚¹ï¼šé‡Šæ”¾æ“ä½œå¿…é¡»åœ¨ç¼–å†™å…¶ä»–jQueryä»£ç ä¹‹å‰ç¼–å†™ // é‡Šæ”¾ä¹‹åŽå°±ä¸èƒ½åœ¨ä½¿ç”¨$ï¼Œæ”¹ä¸ºä½¿ç”¨jQuery jQuery.noConflict(); jQuery(document).ready(function () &#123; alert('Hello World!'); &#125;); // 2.è‡ªå®šä¹‰è®¿é—®ç¬¦å· var nl = jQuery.noConflict(); nl(document).ready(function () &#123; alert('Hello World!'); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;ä¸‰ã€æ ¸å¿ƒå‡½æ•°å’Œé™æ€æ–¹æ³•1. jQueryæ ¸å¿ƒå‡½æ•°ä»ŽjQueryæ–‡æ¡£ä¸­å¯ä»¥çœ‹å‡º,jQueryæ ¸å¿ƒå‡½æ•°ä¸€å…±3å¤§ç±»4å°ç±»jQuery(callback)å½“DOMåŠ è½½å®ŒæˆåŽæ‰§è¡Œä¼ å…¥çš„å›žè°ƒå‡½æ•°jQuery([sel,[context]])æŽ¥æ”¶ä¸€ä¸ªåŒ…å« CSS é€‰æ‹©å™¨çš„å­—ç¬¦ä¸²ï¼Œç„¶åŽç”¨è¿™ä¸ªå­—ç¬¦ä¸²åŽ»åŒ¹é…ä¸€ç»„å…ƒç´ ,å¹¶åŒ…è£…æˆjQueryå¯¹è±¡åŽŸç”ŸJSå¯¹è±¡å’ŒjQueryå¯¹è±¡ç›¸äº’è½¬æ¢1234567891011121314151617181920212223242526272829303132333435&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;&lt;/title&gt; &lt;!--&lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt;--&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; var $box = $("#box"); // $box.text("æ–°çš„æ•°æ®"); // jQueryå¯¹è±¡ä¸èƒ½ä½¿ç”¨åŽŸç”Ÿjså¯¹è±¡çš„æ–¹æ³• // $box.innerText = "æ–°çš„æ•°æ®"; // å°†jQueryå¯¹è±¡è½¬æ¢ä¸ºåŽŸç”Ÿjså¯¹è±¡ // æ³¨æ„: ä¸æ˜¯eq(0),eqå‡½æ•°è¿”å›žçš„æ˜¯jQueryç±»åž‹å¯¹è±¡,getå‡½æ•°è¿”å›žçš„æ˜¯åŽŸç”Ÿç±»åž‹å¯¹è±¡ // var box = $box.get(0); var box = $box[0]; box.innerText = "æ–°çš„æ•°æ®"; var box2 = document.getElementById("box"); // åŽŸç”Ÿjså¯¹è±¡ä¸èƒ½ä½¿ç”¨jQueryå¯¹è±¡çš„æ–¹æ³• // box2.text("æ–°çš„æ•°æ®2"); // åŽŸç”Ÿjså¯¹è±¡åªèƒ½ä½¿ç”¨åŽŸç”Ÿçš„jsæ–¹æ³• // box2.innerText = "æ–°çš„æ•°æ®2"; // å°†åŽŸç”Ÿjså¯¹è±¡è½¬æ¢ä¸ºjQueryå¯¹è±¡ var $box2 = $(box); $box2.text("æ–°çš„æ•°æ®2"); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;Tips:ä¸ºäº†æ–¹ä¾¿å¼€å‘è€…ä¹‹é—´æ²Ÿé€šå’Œé˜…è¯»,ä¸€èˆ¬æƒ…å†µä¸‹æ‰€æœ‰jQueryæ“ä½œç›¸å…³çš„å˜é‡å‰é¢åŠ ä¸Š$jQuery(html,[ownerDoc])æ ¹æ® HTML æ ‡è®°å­—ç¬¦ä¸²ï¼ŒåŠ¨æ€åˆ›å»ºDOMå…ƒç´ 1234567891011121314151617181920212223242526272829303132333435363738394041&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;06-jQueryæ ¸å¿ƒå‡½æ•°&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; // $();ä»£è¡¨jQueryçš„æ ¸å¿ƒå‡½æ•° // 1.æŽ¥æ”¶ä¸€ä¸ªå‡½æ•°,ä½œä¸ºå…¥å£å‡½æ•° $(function () &#123; alert('Hello World!'); // 2.æŽ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸² // 2.1æŽ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²é€‰æ‹©å™¨ // è¿”å›žä¸€ä¸ªjQueryå¯¹è±¡ï¼Œå¯¹è±¡ä¸­ä¿å­˜äº†æ‰¾åˆ°çš„DOMå…ƒç´  var $box1 = $(".box1"); var $box2 = $("#box2"); console.log($box1); console.log($box2); // 2.2æŽ¥æ”¶ä¸€ä¸ªä»£ç ç‰‡æ®µ // è¿”å›žä¸€ä¸ªjQueryå¯¹è±¡ï¼Œå¯¹è±¡ä¸­ä¿å­˜äº†åˆ›å»ºçš„DOMå…ƒç´  var $p = $("&lt;p&gt;æˆ‘æ˜¯p&lt;/p&gt;"); console.log($p); $box1.append($p); // 2.3æŽ¥æ”¶ä¸€ä¸ªDOMå…ƒç´  // ä¼šè¢«åŒ…è£…æˆä¸€ä¸ªjQueryå¯¹è±¡è¿”å›žç»™æˆ‘ä»¬ var span = document.getElementsByTagName('span')[0]; console.log(span); // åŽŸç”ŸDOMå…ƒç´  var $span = $(span); console.log($span); // æŠŠåŽŸç”ŸDOMå…ƒç´ åŒ…è£…æˆä¸€ä¸ªjQueryå¯¹è±¡ &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="box1"&gt;&lt;/div&gt;&lt;div id="box2"&gt;&lt;/div&gt;&lt;span&gt;æˆ‘æ˜¯span&lt;/span&gt;&lt;/body&gt;&lt;/html&gt;2. jQueryå¯¹è±¡jQueryå¯¹è±¡çš„æœ¬è´¨æ˜¯ä»€ä¹ˆ?jQueryå¯¹è±¡çš„æœ¬è´¨æ˜¯ä¸€ä¸ªä¼ªæ•°ç»„ä»€ä¹ˆæ˜¯ä¼ªæ•°ç»„?æœ‰0åˆ°length-1çš„å±žæ€§å¹¶ä¸”æœ‰lengthå±žæ€§123456789101112131415161718192021222324252627282930&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;07-jQueryå¯¹è±¡&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; /* * 1.ä»€ä¹ˆæ˜¯jQueryå¯¹è±¡ * jQueryå¯¹è±¡æ˜¯ä¸€ä¸ªä¼ªæ•°ç»„ * * 2.ä»€ä¹ˆæ˜¯ä¼ªæ•°ç»„ * ç”±0åˆ°length-1çš„å±žæ€§ï¼Œå¹¶ä¸”æœ‰lengthå±žæ€§ */ var $div = $("div"); console.log($div); var arr = [1, 3, 5]; console.log(arr); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div&gt;div1&lt;/div&gt;&lt;div&gt;div2&lt;/div&gt;&lt;div&gt;div3&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;3. jQueryé™æ€æ–¹æ³•ä»€ä¹ˆæ˜¯é™æ€æ–¹æ³•?é™æ€æ–¹æ³•å¯¹åº”çš„æ˜¯å¯¹è±¡æ–¹æ³•,å¯¹è±¡æ–¹æ³•ç”¨å®žä¾‹å¯¹è±¡è°ƒç”¨,è€Œé™æ€æ–¹æ³•ç”¨ç±»åè°ƒç”¨12345678910111213141516171819202122232425262728293031323334&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;08-é™æ€æ–¹æ³•å’Œå®žä¾‹æ–¹æ³•&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; // 1.å®šä¹‰ä¸€ä¸ªç±» function AClass() &#123; &#125;; // 2.ç»™è¿™ä¸ªç±»æ·»åŠ ä¸€ä¸ªé™æ€æ–¹æ³• // ç›´æŽ¥æ·»åŠ ç»™ç±»çš„å°±æ˜¯é™æ€æ–¹æ³• AClass.staticMthod = function () &#123; alert('staticMthod'); &#125;; // é™æ€æ–¹æ³•é€šè¿‡ç±»åè°ƒç”¨ AClass.staticMthod(); // 2.ç»™è¿™ä¸ªç±»æ·»åŠ ä¸€ä¸ªå®žä¾‹æ–¹æ³• AClass.prototype.instanceMethod = function () &#123; alert('instanceMethod'); &#125;; // å®žä¾‹æ–¹æ³•é€šè¿‡ç±»çš„å®žä¾‹è°ƒç”¨ // åˆ›å»ºä¸€ä¸ªå®žä¾‹ var a = new AClass(); a.instanceMethod(); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;jQuery.holdReady(hold)æš‚åœæˆ–è€…æ¢å¤jQuery.ready()äº‹ä»¶ä¼ å…¥trueæˆ–false12345678910111213141516171819202122232425&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;12-jQuery-holdReadyæ–¹æ³•&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; // ä½¿ç”¨$ç›´æŽ¥è°ƒç”¨,æ˜¯é™æ€æ–¹æ³• $.holdReady(true); // ä½œç”¨ï¼šæš‚åœreadyä»£ç çš„æ‰§è¡Œ $(function () &#123; alert('function'); &#125;) &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;button&gt;ç‚¹å‡»æµ‹è¯•å¼¹å‡º&lt;/button&gt;&lt;script type="text/javascript"&gt; var btn = document.getElementsByTagName('button')[0]; btn.onclick = function () &#123; alert('btn'); $.holdReady(false); // ä¸è§£é™¤çš„è¯alert('function');ä¸ä¼šå¼¹å‡º &#125;;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;$.each(object,[callback])éåŽ†å¯¹è±¡æˆ–æ•°ç»„ä¼˜ç‚¹ç»Ÿä¸€éåŽ†å¯¹è±¡å’Œæ•°ç»„çš„æ–¹å¼å›žè°ƒå‚æ•°çš„é¡ºåºæ›´ç¬¦åˆæˆ‘ä»¬çš„æ€ç»´æ¨¡å¼123456789101112131415161718192021222324252627282930313233343536373839404142434445464748&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;09-jQuery-eachæ–¹æ³•&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; var arr = [1, 3, 5, 7, 9]; var obj = &#123;0: 1, 1: 3, 2: 5, 3: 7, 4: 9, length: 5&#125;; /* * ç¬¬ä¸€ä¸ªå‚æ•°ï¼šéåŽ†åˆ°çš„å…ƒç´  * ç¬¬äºŒä¸ªå‚æ•°ï¼šå½“å‰éåŽ†åˆ°çš„ç´¢å¼• * æ³¨æ„ç‚¹ï¼šåŽŸç”Ÿçš„forEachæ–¹æ³•åªèƒ½éåŽ†æ•°ç»„ï¼Œä¸èƒ½éåŽ†ä¼ªæ•°ç»„ * */ arr.forEach(function (value, index) &#123; console.log(index, value); &#125;); // TypeError: obj.forEach is not a function /* obj.forEach(function (value, index) &#123; console.log(index, value); &#125;); */ // 1.åˆ©ç”¨jQueryçš„eaché™æ€æ–¹æ³•éåŽ†æ•°ç»„ /* * ç¬¬ä¸€ä¸ªå‚æ•°ï¼šå½“å‰éåŽ†åˆ°çš„ç´¢å¼• * ç¬¬äºŒä¸ªå‚æ•°ï¼šéåŽ†åˆ°çš„æ•°ç»„ * æ³¨æ„ç‚¹ï¼šjQueryçš„eachæ–¹æ³•å¯ä»¥éåŽ†ä¼ªæ•°ç»„ * */ $.each(arr, function (index, value) &#123; console.log(index, value); &#125;); $.each(obj, function (index, value) &#123; console.log(index, value); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;$.map(arr|obj,callback)éåŽ†å¯¹è±¡æˆ–æ•°ç»„,å°†å›žè°ƒå‡½æ•°çš„è¿”å›žå€¼ç»„æˆä¸€ä¸ªæ–°çš„æ•°ç»„è¿”å›ž12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;10-jQuery-mapæ–¹æ³•&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; var arr = [1, 3, 5, 7, 9]; var obj = &#123;0: 1, 1: 3, 2: 5, 3: 7, 4: 9, length: 5&#125;; // 1.åˆ©ç”¨åŽŸç”ŸJSçš„mapæ–¹æ³•éåŽ† /* ç¬¬ä¸€ä¸ªå‚æ•°:å½“å‰éåŽ†åˆ°çš„å…ƒç´  * ç¬¬äºŒä¸ªå‚æ•°ï¼šå½“å‰éåŽ†åˆ°çš„ç´¢å¼• * ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šå½“å‰è¢«éåŽ†çš„æ•°ç»„ * æ³¨æ„ç‚¹ï¼šå’ŒåŽŸç”Ÿçš„forEachä¸€æ ·ï¼Œä¸èƒ½éåŽ†ä¼ªæ•°ç»„ * */ arr.map(function (value, index, array) &#123; console.log(index, value, array); &#125;); // TypeError: obj.map is not a function /* obj.map(function (value, index, array) &#123; console.log(index, value, array); &#125;); */ /* ç¬¬ä¸€ä¸ªå‚æ•°:è¦éåŽ†çš„æ•°ç»„ * ç¬¬äºŒä¸ªå‚æ•°ï¼šæ¯éåŽ†ä¸€ä¸ªå…ƒç´ ä¹‹åŽæ‰§è¡Œçš„å›žè°ƒå‡½æ•° * å›žè°ƒå‡½æ•°çš„å‚æ•°ï¼š * ç¬¬ä¸€ä¸ªå‚æ•°ï¼šéåŽ†åˆ°çš„å…ƒç´  * ç¬¬äºŒä¸ªå‚æ•°ï¼šéåŽ†åˆ°çš„ç´¢å¼• * æ³¨æ„ç‚¹ï¼šå’ŒjQueryä¸­çš„eaché™æ€æ–¹æ³•ä¸€æ ·ï¼Œmapé™æ€æ–¹æ³•å¯ä»¥éåŽ†ä¼ªæ•°ç»„ * */ $.map(arr, function (value, index) &#123; console.log(index, value); &#125;); $.map(obj, function (value, index) &#123; console.log(index, value); &#125;); // jQueryä¸­çš„eaché™æ€æ–¹æ³•å’Œmapé™æ€æ–¹æ³•çš„åŒºåˆ« // eaché™æ€æ–¹æ³•é»˜è®¤çš„è¿”å›žå€¼å°±æ˜¯ï¼ŒéåŽ†è°å°±è¿”å›žè° // mapé™æ€æ–¹æ³•é»˜è®¤çš„è¿”å›žå€¼æ˜¯ä¸€ä¸ªç©ºæ•°ç»„ // eaché™æ€æ–¹æ³•ä¸æ”¯æŒåœ¨å›žè°ƒå‡½æ•°ä¸­å¯¹éåŽ†çš„æ•°ç»„è¿›è¡Œå¤„ç† // mapé™æ€æ–¹æ³•å¯ä»¥åœ¨å›žè°ƒå‡½æ•°ä¸­é€šè¿‡returnå¯¹éåŽ†çš„æ•°ç»„è¿›è¡Œå¤„ç†ï¼Œç„¶åŽç”Ÿæˆä¸€ä¸ªæ–°æ•°ç»„è¿”å›ž var res1 = $.each(arr, function (index, value) &#123; console.log(index, value); return value + index; &#125;); var res2 = $.map(arr, function (value, index) &#123; console.log(index, value); return value + index; &#125;); console.log(res1); console.log(res2); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;$.trim(str)åŽ»æŽ‰å­—ç¬¦ä¸²èµ·å§‹å’Œç»“å°¾çš„ç©ºæ ¼$.isArray(obj)åˆ¤æ–­æ˜¯å¦æ˜¯æ•°ç»„$.isFunction(obj)åˆ¤æ–­æ˜¯å¦æ˜¯å‡½æ•°$.isWindow(obj)åˆ¤æ–­æ˜¯å¦æ˜¯windowå¯¹è±¡1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;11-jQueryå…¶å®ƒé™æ€æ–¹æ³•&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; /* * $.trim(); * ä½œç”¨ï¼šåŽ»é™¤å­—ç¬¦ä¸²ä¸¤ç«¯çš„ç©ºæ ¼ * å‚æ•°ï¼šéœ€è¦åŽ»é™¤ç©ºæ ¼çš„å­—ç¬¦ä¸² * è¿”å›žå€¼ï¼šåŽ»é™¤ç©ºæ ¼ä¹‹åŽçš„å­—ç¬¦ä¸² * */ var str = '---- Hello -----'; console.log(str); var res = $.trim(str); console.log(res); // çœŸæ•°ç»„ var arr = [1, 3, 5, 7, 9]; // ä¼ªæ•°ç»„ var arrlike = &#123;0: 1, 1: 3, 2: 5, 3: 7, 4: 9, length: 5&#125;; // å¯¹è±¡ var obj = &#123;'name': 'hello', 'age': 33&#125;; // å‡½æ•° var fn = function () &#123; &#125;; // windowå¯¹è±¡ var w = window; /* * $.isWindow(); * ä½œç”¨ï¼šåˆ¤æ–­ä¼ å…¥çš„å¯¹è±¡æ˜¯å¦æ˜¯windowå¯¹è±¡ * è¿”å›žå€¼ï¼štrue/false * */ var res = $.isWindow(arr); console.log(res); /* * $.isArray(); * ä½œç”¨ï¼šåˆ¤æ–­ä¼ å…¥çš„å¯¹è±¡æ˜¯å¦æ˜¯çœŸæ•°ç»„ * è¿”å›žå€¼ï¼štrue/false * */ var res = $.isArray(arr); console.log(res); /* * $.isFunction(); * ä½œç”¨ï¼šåˆ¤æ–­ä¼ å…¥çš„å¯¹è±¡æ˜¯å¦æ˜¯ä¸€ä¸ªå‡½æ•° * è¿”å›žå€¼ï¼štrue/false * */ var res = $.isFunction(arr); console.log(res); /* * æ³¨æ„ç‚¹: jQueryæ¡†æž¶æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•° * (function (windos, undefined) &#123; * &#125;)(window); * */ var res = $.isFunction(jQuery); console.log(res); // true (function (windos, undefined) &#123; &#125;)(window); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;è¡¥å……çŸ¥è¯†ä½¿ç”¨IDEè½¯ä»¶çš„å¿«æ·é”®æ–¹ä¾¿å¼•ç”¨jqueryæ–‡ä»¶Settingsï¼ŒEditorï¼ŒLive Templatesï¼Œåœ¨å³è¾¹æ‰¾åˆ°HTML/XMLï¼Œåœ¨Abbreviationä¸­è¾“å…¥å­—æ¯ä½œä¸ºå¿«æ·é”®ï¼Œåœ¨Template textä¸­è¾“å…¥è¦å¼•ç”¨çš„jqueryä»£ç ï¼Œå·¦ä¸‹è§’è®¾ç½®æˆHTML text,ç‚¹å‡»åº”ç”¨ï¼Œä»¥åŽè¾“å…¥è¿™ä¸ªå­—æ¯åŽæŒ‰tabé”®å°±ä¼šè‡ªåŠ¨å‡ºæ¥ç›¸åº”çš„jqueryä»£ç ä½¿ç”¨å¿«æ·é”®æ‰“å¼€æµè§ˆå™¨Settingsï¼ŒAppearance&amp;Behaviorï¼ŒKeymapï¼Œæœç´¢â€œdefaultâ€ï¼Œåœ¨Otherçš„Open in deafult browserä¸­é¼ æ ‡å³é”®ï¼ŒAdd Keyboard Shortcutï¼Œç»™æ‰“å¼€é»˜è®¤æµè§ˆå™¨è®¾ç½®ä¸€ä¸ªå¿«æ·é”®ã€‚ä»¥åŽåœ¨htmlä¸­æ‰“å¼€æµè§ˆå™¨çš„è¯å°±ä¸ç”¨é¼ æ ‡ç‚¹å‡»äº†ï¼Œç›´æŽ¥æŒ‰å¿«æ·é”®å³å¯ã€‚å››ã€é€‰æ‹©å™¨1. åŸºç¡€é€‰æ‹©å™¨è§†é¢‘å‚è€ƒç¬¬åç« -CSSé€‰æ‹©å™¨é€‰æ‹©å™¨åç§°æè¿°è¿”å›žç¤ºä¾‹#ididé€‰æ‹©å™¨æ ¹æ®ç»™å®šçš„idåŒ¹é…ä¸€ä¸ªå…ƒç´ å•ä¸ªå…ƒç´ $(â€œ#boxâ€);é€‰å–idä¸ºboxå…ƒç´ .classç±»é€‰æ‹©å™¨æ ¹æ®ç»™å®šçš„ç±»ååŒ¹é…å…ƒç´ é›†åˆå…ƒç´ $(â€œ.boxâ€);é€‰å–æ‰€æœ‰ç±»åä¸ºboxå…ƒç´ elementå…ƒç´ é€‰æ‹©å™¨æ ¹æ®ç»™å®šçš„å…ƒç´ åç§°åŒ¹é…å…ƒç´ é›†åˆå…ƒç´ $(â€œpâ€);é€‰å–æ‰€æœ‰å…ƒç´ *é€šé…ç¬¦é€‰æ‹©å™¨åŒ¹é…æ‰€æœ‰å…ƒç´ é›†åˆå…ƒç´ $(â€œ*â€);é€‰å–æ‰€æœ‰å…ƒç´ selector1,selector2,selectorNå¹¶é›†é€‰æ‹©å™¨å°†æ‰€æœ‰é€‰æ‹©å™¨åŒ¹é…åˆ°çš„å…ƒç´ åˆå¹¶åŽä¸€èµ·è¿”å›žé›†åˆå…ƒç´ $(â€œdiv,p,.boxâ€);é€‰å–æ‰€æœ‰å…ƒç´ ,æ‰€æœ‰å…ƒç´ å’Œæ‰€æœ‰ç±»åä¸ºboxå…ƒç´ 2. å±‚æ¬¡é€‰æ‹©å™¨è§†é¢‘å‚è€ƒç¬¬åç« -CSSé€‰æ‹©å™¨é€‰æ‹©å™¨åç§°æè¿°è¿”å›žç¤ºä¾‹$(â€œancestor descendantâ€)åŽä»£é€‰æ‹©å™¨é€‰å–ancestorå…ƒç´ çš„æ‰€æœ‰descendantåŽä»£æ ‡ç­¾(ä¸å…‰æ˜¯å„¿å­,åŒ…æ‹¬å­™å­/é‡å­™å­ç­‰)é›†åˆå…ƒç´ $(â€œdiv spanâ€);é€‰å–å…ƒç´ é‡Œæ‰€æœ‰çš„å…ƒç´ $(â€œparent &gt; childâ€)å­å…ƒç´ é€‰æ‹©å™¨æ‰¾åˆ°é€‰å–parent å…ƒç´ ä¸­æ‰€æœ‰ç›´æŽ¥å­å…ƒç´ child(åªæœ‰å„¿å­,ä¸åŒ…æ‹¬å­™å­/é‡å­™å­ç­‰)é›†åˆå…ƒç´ $(â€œdiv&gt;spanâ€);é€‰å–å…ƒç´ ä¸‹å…ƒç´ åç§°æ˜¯çš„å­å…ƒç´ $(â€œprev + nextâ€)ç›¸é‚»å…„å¼Ÿé€‰æ‹©å™¨é€‰å–prevå…ƒç´ åŽé¢ç´§è·Ÿçš„é‚£ä¸ªnextå…ƒç´ é›†åˆå…ƒç´ $(â€œ.one+divâ€);é€‰å–ç±»åä¸ºoneçš„ä¸‹ä¸€ä¸ªåŒçº§çš„å…ƒç´ $(â€œprev ~ siblingsâ€)é€šç”¨å…„å¼Ÿé€‰æ‹©å™¨é€‰å–prevå…ƒç´ åŽé¢çš„æ‰€æœ‰nextå…ƒç´ é›†åˆå…ƒç´ $(â€œ#two~divâ€);é€‰å–idåä¸ºtwoå…ƒç´ åŽé¢æ‰€æœ‰åŒçº§çš„å…ƒç´ 3. åºé€‰æ‹©å™¨è§†é¢‘å‚è€ƒç¬¬åç« -CSSé€‰æ‹©å™¨å¦‚ä¸Šå†…å®¹ä¸å†ä¸€ä¸€èµ˜è¿°,è§‚çœ‹ç¬¬åç« -CSSé€‰æ‹©å™¨,ä½¿ç”¨æ—¶æŸ¥è¯¢æ–‡æ¡£å³å¯åšå¼€å‘æ˜¯è„‘åŠ›æ´»,æˆ‘ä»¬éœ€è¦æŽŒæ¡çš„æ˜¯è§£å†³é—®é¢˜çš„æ–¹æ³•,è€Œä¸æ˜¯æ­»è®°ç¡¬èƒŒ4. å±žæ€§é€‰æ‹©å™¨è§†é¢‘å‚è€ƒç¬¬åç« -CSSé€‰æ‹©å™¨å¦‚ä¸Šå†…å®¹ä¸å†ä¸€ä¸€èµ˜è¿°,è§‚çœ‹ç¬¬åç« -CSSé€‰æ‹©å™¨,ä½¿ç”¨æ—¶æŸ¥è¯¢æ–‡æ¡£å³å¯åšå¼€å‘æ˜¯è„‘åŠ›æ´»,æˆ‘ä»¬éœ€è¦æŽŒæ¡çš„æ˜¯è§£å†³é—®é¢˜çš„æ–¹æ³•,è€Œä¸æ˜¯æ­»è®°ç¡¬èƒŒ5. å†…å®¹è¿‡æ»¤é€‰æ‹©å™¨é€‰æ‹©å™¨æè¿°è¿”å›ž:emptyé€‰å–ä¸åŒ…å«å­å…ƒç´ æˆ–æ–‡æœ¬ä¸ºç©ºçš„å…ƒç´ é›†åˆå…ƒç´ :parenté€‰å–å«æœ‰å­å…ƒç´ æˆ–æ–‡æœ¬çš„å…ƒç´ é›†åˆå…ƒç´ :contains(text)é€‰å–å«æœ‰æ–‡æœ¬å†…å®¹ä¸ºtextçš„å…ƒç´ é›†åˆå…ƒç´ :has(selector)é€‰å–å«æœ‰é€‰æ‹©å™¨æ‰€åŒ¹é…çš„å…ƒç´ çš„å…ƒç´ é›†åˆå…ƒç´ :empty:parent:contains(text):has(selector)å’Œ:parentåŒºåˆ«,parentåªè¦æœ‰å­å…ƒç´ å°±ä¼šè¢«æ‰¾åˆ°,:has(selector)ä¸ä»…è¦æœ‰å­å…ƒç´ ,è€Œä¸”å­å…ƒç´ è¿˜å¿…é¡»æ»¡è¶³æˆ‘ä»¬çš„æ¡ä»¶1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;14-jQueryå†…å®¹é€‰æ‹©å™¨&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; // :empty // ä½œç”¨ï¼šæ‰¾åˆ°æ—¢æ²¡æœ‰æ–‡æœ¬å†…å®¹ä¹Ÿæ²¡æœ‰å­å…ƒç´ çš„æŒ‡å®šå…ƒç´  var $div = $('div:empty'); console.log($div); // :parent // ä½œç”¨ï¼šæ‰¾åˆ°æœ‰æ–‡æœ¬å†…å®¹æˆ–æœ‰å­å…ƒç´ çš„æŒ‡å®šå…ƒç´  var $div = $('div:parent'); console.log($div); // :contains(text) // ä½œç”¨ï¼šæ‰¾åˆ°åŒ…å«æŒ‡å®šæ–‡æœ¬å†…å®¹çš„æŒ‡å®šå…ƒç´  var $div = $("div:contains('æˆ‘æ˜¯div')"); console.log($div); // :has(selector) // ä½œç”¨ï¼šæ‰¾åˆ°åŒ…å«æŒ‡å®šå­å…ƒç´ çš„æŒ‡å®šå…ƒç´  var $div = $("div:has('span')"); console.log($div); &lt;/script&gt; &lt;style type="text/css"&gt; div &#123; width: 100px; height: 100px; background: greenyellow; margin-top: 5px; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;æˆ‘æ˜¯div&lt;/div&gt;&lt;div&gt;æˆ‘æ˜¯div123&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;p&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;äº”ã€å±žæ€§ç›¸å…³1. å±žæ€§å’Œå±žæ€§èŠ‚ç‚¹ä»€ä¹ˆæ˜¯å±žæ€§?å±žæ€§å°±æ˜¯å¯¹è±¡èº«ä¸Šçš„å˜é‡åªè¦å¯¹è±¡èº«ä¸Šéƒ½å¯ä»¥æ·»åŠ å±žæ€§(æ— è®ºæ˜¯è‡ªå®šä¹‰å¯¹è±¡,è¿˜æ˜¯DOMå¯¹è±¡)ä»€ä¹ˆæ˜¯å±žæ€§èŠ‚ç‚¹?åœ¨htmlä¸­ç¼–å†™çš„æ‰€æœ‰æ ‡ç­¾ï¼Œé‡Œé¢çš„å±žæ€§éƒ½æ˜¯å±žæ€§èŠ‚ç‚¹å¦‚æžœæ“ä½œå±žæ€§?æ·»åŠ æˆ–ä¿®æ”¹å±žæ€§(æ²¡æœ‰å°±ä¼šæ·»åŠ ,æœ‰å°±ä¼šä¿®æ”¹)å¯¹è±¡.å±žæ€§åç§° = å€¼;å¯¹è±¡[&quot;å±žæ€§åç§°&quot;] = å€¼;èŽ·å–å±žæ€§å¯¹è±¡.å±žæ€§åç§°å¯¹è±¡[&quot;å±žæ€§åç§°&quot;]å¦‚ä½•æ“ä½œå±žæ€§èŠ‚ç‚¹?èŽ·å–å±žæ€§èŠ‚ç‚¹DOMå¯¹è±¡.getAttribute(&quot;å±žæ€§èŠ‚ç‚¹åç§°&quot;)è®¾ç½®å±žæ€§èŠ‚ç‚¹DOMå¯¹è±¡.setAttribute(&quot;å±žæ€§èŠ‚ç‚¹åç§°&quot;, &quot;å€¼&quot;);12345678910111213141516171819202122232425262728293031323334353637383940414243444546&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;15-å±žæ€§å’Œå±žæ€§èŠ‚ç‚¹&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; /* * 1.ä»€ä¹ˆæ˜¯å±žæ€§ * å¯¹è±¡èº«ä¸Šä¿å­˜çš„å˜é‡å°±æ˜¯å±žæ€§ * 2.å¦‚ä½•æ“ä½œå±žæ€§ * è®¾ç½®ï¼šå¯¹è±¡.å±žæ€§åç§° = å€¼ * èŽ·å–ï¼šå¯¹è±¡.å±žæ€§åç§° * è®¾ç½®ï¼šå¯¹è±¡['å±žæ€§åç§°'] = å€¼ * èŽ·å–ï¼šå¯¹è±¡['å±žæ€§åç§°'] * 3.ä»€ä¹ˆæ˜¯å±žæ€§èŠ‚ç‚¹ * &lt;span name="it"&gt;&lt;/span&gt; * åœ¨ç¼–å†™htmlæ ‡ç­¾ä¸­æ·»åŠ çš„å±žæ€§å°±æ˜¯å±žæ€§èŠ‚ç‚¹ * åœ¨æµè§ˆå™¨ä¸­æ‰¾åˆ°spanè¿™ä¸ªDOMå…ƒç´ ä¹‹åŽï¼Œåœ¨attributesä¸­ä¿å­˜çš„æ‰€æœ‰å†…å®¹éƒ½æ˜¯å±žæ€§èŠ‚ç‚¹ * 4.å¦‚ä½•æ“ä½œå±žæ€§èŠ‚ç‚¹ * DOMå…ƒç´ .setAttribute('å±žæ€§åç§°','å±žæ€§å€¼'); * DOMå…ƒç´ .getAttribute('å±žæ€§åç§°'); * 5.å±žæ€§å’Œå±žæ€§èŠ‚ç‚¹æœ‰ä»€ä¹ˆåŒºåˆ« * ä»»ä½•å¯¹è±¡éƒ½æœ‰å±žæ€§ï¼Œä½†æ˜¯åªæœ‰DOMå¯¹è±¡åªæœ‰å±žæ€§èŠ‚ç‚¹ * */ function Func() &#123; var p = new Func(); p.name = 'hello'; console.log(p.name); p['age'] = 23; console.log(p['age']); var span = document.getElementsByTagName('span')[0]; console.log(span); span.setAttribute('name', 'world!'); console.log(span.getAttribute('name')); &#125; &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;span name="it"&gt;11&lt;/span&gt;&lt;/body&gt;&lt;/html&gt;2. jQueryä¸­çš„attrå’Œpropæ–¹æ³•attr(name|pro|key,val|fn)æ–¹æ³•ç”¨äºŽè®¾ç½®æˆ–èŽ·å–å±žæ€§èŠ‚ç‚¹çš„å€¼removeAttr(name)æ–¹æ³•ç”¨äºŽåˆ é™¤æŒ‡å®šå±žæ€§èŠ‚ç‚¹123456789101112131415161718192021222324252627282930313233343536&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;16-jQuery-attræ–¹æ³•&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; // 1.attr(name|pro|key,val|fn) // ä½œç”¨ï¼šèŽ·å–æˆ–è®¾ç½®å±žæ€§èŠ‚ç‚¹çš„å€¼ï¼Œå¯ä»¥ä¼ é€’ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå¯ä»¥ä¼ é€’ä¸¤ä¸ª // å¦‚æžœä¼ é€’ä¸€ä¸ªå‚æ•°ä»£è¡¨èŽ·å–å±žæ€§èŠ‚ç‚¹çš„å€¼ // å¦‚æžœä¼ é€’ä¸¤ä¸ªå‚æ•°ä»£è¡¨èŽ·å–å±žæ€§èŠ‚ç‚¹çš„å€¼ // æ³¨æ„ç‚¹ï¼šå¦‚æžœæ˜¯èŽ·å–ï¼šä¸è®ºæ‰¾åˆ°å¤šå°‘ä¸ªå…ƒç´ ï¼Œåªè¿”å›žç¬¬ä¸€ä¸ªå…ƒç´ æŒ‡å®šèŠ‚ç‚¹çš„å€¼ // å¦‚æžœæ˜¯è®¾ç½®ï¼šæ‰¾åˆ°å¤šå°‘ä¸ªå…ƒç´ å°±ä¼šè®¾ç½®å¤šå°‘ä¸ªå…ƒç´  // å¦‚æžœæ˜¯è®¾ç½®ï¼šå¦‚æžœè®¾ç½®çš„å±žæ€§èŠ‚ç‚¹ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆç³»ç»Ÿä¼šè‡ªåŠ¨æ–°å¢ž // 2.removeAttr(name) // ä½œç”¨ï¼šåˆ é™¤å±žæ€§èŠ‚ç‚¹ // æ³¨æ„ç‚¹ï¼šä¼šåˆ é™¤æ‰€æœ‰æ‰¾åˆ°å…ƒç´ æŒ‡å®šçš„å±žæ€§èŠ‚ç‚¹ $(function () &#123; // console.log($('span').attr('class')); // span1 // $('span').attr('class','box'); // $('span').attr('abc','123'); // $('span').removeAttr('class'); $('span').removeAttr('class name'); // åˆ é™¤å¤šä¸ªå±žæ€§èŠ‚ç‚¹ &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;span class="span1" name="it111"&gt;&lt;/span&gt;&lt;span class="span2" name="it222"&gt;&lt;/span&gt;&lt;/body&gt;&lt;/html&gt;prop(n|p|k,v|f)æ–¹æ³•ç”¨äºŽè®¾ç½®æˆ–è€…èŽ·å–å…ƒç´ çš„å±žæ€§å€¼removeProp(name)æ–¹æ³•attræ–¹æ³•å’Œpropæ–¹æ³•åŒºåˆ«æ—¢ç„¶æ‰€æœ‰çš„DOMå¯¹è±¡ï¼Œéƒ½æœ‰ä¸€ä¸ªattributeså±žæ€§,è€Œpropå¯ä»¥æ“ä½œå±žæ€§,æ‰€ä»¥ä¹Ÿå¯ä»¥æ“ä½œå±žæ€§èŠ‚ç‚¹å®˜æ–¹æŽ¨èåœ¨æ“ä½œå±žæ€§èŠ‚ç‚¹æ—¶,å…·æœ‰ true å’Œ false ä¸¤ä¸ªå±žæ€§çš„å±žæ€§èŠ‚ç‚¹ï¼Œå¦‚ checked, selected æˆ–è€… disabled ä½¿ç”¨prop()ï¼Œå…¶ä»–çš„ä½¿ç”¨ attr()å› ä¸ºå¦‚æžœå…·æœ‰ true å’Œ false ä¸¤ä¸ªå±žæ€§çš„å±žæ€§èŠ‚ç‚¹,å¦‚æžœæ²¡æœ‰ç¼–å†™é»˜è®¤attrè¿”å›žundefined,è€Œpropè¿”å›žfalse12345678910111213141516171819202122232425262728293031323334353637&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;17-jQuery-propæ–¹æ³•&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; // 1.prop(n|p|k,v|f) // ç‰¹ç‚¹å’Œattræ–¹æ³•ä¸€æ · // 2.removeProp(name) // ç‰¹ç‚¹å’ŒremoveAttræ–¹æ³•ä¸€æ · $(function () &#123; $('span').eq(0).prop('demo','debug'); // ç»™æŒ‡å®šDOMå…ƒç´ è®¾ç½®å±žæ€§èŠ‚ç‚¹ $('span').prop('demo'); // èŽ·å–æŒ‡å®šDOMå…ƒç´ çš„å±žæ€§èŠ‚ç‚¹ $('span').removeProp('demo'); // åˆ é™¤æŒ‡å®šDOMå…ƒç´ çš„å±žæ€§èŠ‚ç‚¹ &#125;); /* * propæ–¹æ³•ä¸ä»…èƒ½æ“ä½œå±žæ€§ï¼Œè¿˜èƒ½æ“ä½œå±žæ€§èŠ‚ç‚¹ * */ console.log($('span').prop('class')); // èŽ·å–å±žæ€§èŠ‚ç‚¹ $('span').prop('class','box'); // ä¿®æ”¹å±žæ€§èŠ‚ç‚¹ // æœ‰checked / æ— checked console.log($('input').prop('check')); // true / false console.log($('input').attr('check')); // checked / undefined &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;span class="span1" name="it111"&gt;&lt;/span&gt;&lt;span class="span2" name="it222"&gt;&lt;/span&gt;&lt;input type="checkbox" checked&gt;&lt;/body&gt;&lt;/html&gt;ç»ƒä¹ 1234567891011121314151617181920212223242526272829&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;18-attrå’Œpropç»ƒä¹ &lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; // ä½œç”¨æ˜¯åœ¨è¾“å…¥æ¡†é‡Œè¾“å…¥å›¾ç‰‡åœ°å€ï¼Œæ¯”å¦‚ï¼šimages/2.jpgï¼Œç„¶åŽç‚¹å‡»åˆ‡æ¢å›¾ç‰‡ï¼Œä¸‹æ–¹çš„å›¾ç‰‡å°±ä¼šå‘ç”Ÿå˜åŒ– $(function () &#123; // 1.ç»™æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶ var btn = document.getElementsByTagName('button')[0]; btn.onclick = function () &#123; // 2.èŽ·å–è¾“å…¥æ¡†çš„å†…å®¹ var input = document.getElementsByTagName('input')[0]; var text = input.value; // 3.ä¿®æ”¹imgçš„srcå±žæ€§èŠ‚ç‚¹çš„å€¼ $('img').attr('src', text); &#125; &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;input type="text"&gt;&lt;button&gt;åˆ‡æ¢å›¾ç‰‡&lt;/button&gt;&lt;br/&gt;&lt;img src="images/1.jpg" alt=""&gt;&lt;/body&gt;&lt;/html&gt;3. jQueryå¢žåˆ ClassjQuery CSSç±»ç›¸å…³æ–¹æ³•éƒ½æ˜¯ç”¨äºŽæ“ä½œDOMå¯¹è±¡çš„classå±žæ€§èŠ‚ç‚¹çš„å€¼addClass(class|fn)ç»™å…ƒç´ æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªç±»removeClass([class|fn])åˆ é™¤å…ƒç´ çš„ä¸€ä¸ªæˆ–å¤šä¸ªç±»toggleClass(class|fn[,sw])æ·»åŠ æˆ–åˆ é™¤ä¸€ä¸ªç±»(å­˜åœ¨å°±åˆ é™¤ä¸å­˜åœ¨å°±æ·»åŠ )1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;19-jQueryç±»æ“ä½œç›¸å…³æ–¹æ³•&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; // 1.addClass(class|fn) // ä½œç”¨ï¼šæ·»åŠ ä¸€ä¸ªç±»ï¼Œå¦‚æžœè¦æ·»åŠ å¤šä¸ªï¼Œä¸­é—´ç”¨ç©ºæ ¼éš”å¼€ // 2.removeClass([class|fn]) // ä½œç”¨ï¼šåˆ é™¤ä¸€ä¸ªç±»ï¼Œå¦‚æžœè¦åˆ é™¤å¤šä¸ªï¼Œä¸­é—´ç”¨ç©ºæ ¼éš”å¼€ // 3.toggleClass(class|fn[,sw]) // ä½œç”¨ï¼šåˆ‡æ¢ï¼Œæœ‰å°±åˆ é™¤ï¼Œæ²¡æœ‰å°±æ·»åŠ  var btns = document.getElementsByTagName('button'); btns[0].onclick = function () &#123; $('div').addClass('class1 class2'); &#125;; btns[1].onclick = function () &#123; $('div').removeClass('class1 class2'); &#125;; btns[2].onclick = function () &#123; $('div').toggleClass('class1 class2'); &#125;; &#125;); &lt;/script&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; .class1 &#123; width: 100px; height: 100px; background: red; &#125; .class2 &#123; border: 10px solid yellowgreen; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;button&gt;æ·»åŠ ç±»&lt;/button&gt;&lt;button&gt;åˆ é™¤ç±»&lt;/button&gt;&lt;button&gt;åˆ‡æ¢ç±»&lt;/button&gt;&lt;div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;4. jQueryä»£ç /æ–‡æœ¬/å€¼html([val|fn])æ·»åŠ æˆ–èŽ·å–å…ƒç´ ä¸­çš„HTMLtext([val|fn])æ·»åŠ æˆ–èŽ·å–å…ƒç´ ä¸­çš„æ–‡æœ¬textæ–¹æ³•èƒ½åšçš„htmlæ–¹æ³•éƒ½èƒ½åš,æ‰€ä»¥ä¸€èˆ¬ä½¿ç”¨htmlæ–¹æ³•å³å¯val([val|fn|arr])æ·»åŠ æˆ–èŽ·å–å…ƒç´ valueå±žæ€§çš„å€¼1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;20-jQueryæ–‡æœ¬å€¼ç›¸å…³æ“ä½œ&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; // 1.html([val|fn]) // å’ŒåŽŸç”ŸJSä¸­çš„innerHTMLä¸€æ¨¡ä¸€æ · // 2.text([val|fn]) // å’ŒåŽŸç”ŸJSä¸­çš„innerTEXTä¸€æ¨¡ä¸€æ · // 3.val([val|fn|arr]) $(function () &#123; var btns = document.getElementsByTagName('button'); btns[0].onclick = function () &#123; $('div').html('&lt;p&gt;æˆ‘æ˜¯æ®µè½&lt;span&gt;æˆ‘æ˜¯span&lt;/span&gt;&lt;/p&gt;'); &#125;; btns[1].onclick = function () &#123; console.log($('div').html()); &#125;; btns[2].onclick = function () &#123; $('div').text('&lt;p&gt;æˆ‘æ˜¯æ®µè½&lt;span&gt;æˆ‘æ˜¯span&lt;/span&gt;&lt;/p&gt;'); &#125;; btns[3].onclick = function () &#123; console.log($('div').text()); &#125;; btns[4].onclick = function () &#123; $('input').val('è¯·è¾“å…¥å†…å®¹'); &#125;; btns[5].onclick = function () &#123; console.log($('input').val()); &#125;; &#125;); &lt;/script&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; div &#123; width: 100px; height: 100px; border: 1px solid; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;button&gt;è®¾ç½®html&lt;/button&gt;&lt;button&gt;èŽ·å–html&lt;/button&gt;&lt;button&gt;è®¾ç½®text&lt;/button&gt;&lt;button&gt;èŽ·å–text&lt;/button&gt;&lt;button&gt;è®¾ç½®value&lt;/button&gt;&lt;button&gt;èŽ·å–value&lt;/button&gt;&lt;div&gt;&lt;/div&gt;&lt;br/&gt;&lt;input type="text"&gt;&lt;/body&gt;&lt;/html&gt;å…­ã€CSSæ“ä½œ1. jQueryæ“ä½œCSSæ ·å¼css(name|pro|[,val|fn])æ–¹æ³•ç”¨äºŽè®¾ç½®æˆ–èŽ·å–å…ƒç´ CSSæ ·å¼æ ¼å¼1ï¼šDOMå…ƒç´ .css(â€œæ ·å¼åç§°â€, â€œå€¼â€);æ ¼å¼2ï¼šDOMå…ƒç´ .css({â€œæ ·å¼åç§°1â€:â€å€¼1â€,â€æ ·å¼åç§°2â€:â€å€¼2â€});12345678910111213141516171819202122232425262728293031323334&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;21-jQueryæ“ä½œæ ·å¼æ–¹æ³•&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; // 1.é€ä¸ªè®¾ç½® $('div').css('width', '100px'); $('div').css('height', '100px'); $('div').css('background', 'yellow'); // 2.é“¾å¼è®¾ç½® // æ³¨æ„ç‚¹ï¼šé“¾å¼æ“ä½œå¦‚æžœå¤§äºŽä¸‰æ­¥ï¼Œå»ºè®®åˆ†å¼€ $('div').css('width', '100px').css('height', '100px').css('background', 'red'); // 3.æ‰¹é‡è®¾ç½® $('div').css(&#123; width: '100px', height: '100px', background: 'green' &#125;); // 4.èŽ·å– console.log($('div').css('width')); console.log($('div').css('height')); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;2. jQueryæ“ä½œå…ƒç´ å°ºå¯¸width([val|fn])æ–¹æ³•è®¾ç½®æˆ–èŽ·å–å…ƒç´ å®½åº¦(ç›¸å½“äºŽèŽ·å–widthå±žæ€§å€¼)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;11-jQueryæ“ä½œä½ç½®å’Œå°ºå¯¸&lt;/title&gt; &lt;style&gt; *&#123; margin: 0; padding: 0; &#125; .father&#123; width: 250px; height: 250px; background-color: red; margin-left: 50px; position: relative; &#125; .son&#123; width: 100px; height: 100px; background-color: blue; position: absolute; left: 50px; top: 50px; &#125; &lt;/style&gt; &lt;script src="ä»£ç /js/jquery-1.12.4.js"&gt;&lt;/script&gt; &lt;script&gt; $(function () &#123; $("button").eq(0).click(function () &#123; // 1.èŽ·å–å…ƒç´ å®½åº¦(ä¸åŒ…æ‹¬paddingå’Œborder)// alert($('.son').width()); &#125;); $("button").eq(1).click(function () &#123; // 2.è®¾ç½®å…ƒç´ å®½åº¦(ä¸åŒ…æ‹¬paddingå’Œborder)// $(".son").width("50px"); &#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="father"&gt; &lt;div class="son"&gt;&lt;/div&gt;&lt;/div&gt;&lt;button&gt;èŽ·å–&lt;/button&gt;&lt;button&gt;è®¾ç½®&lt;/button&gt;&lt;/body&gt;&lt;/html&gt;height([val|fn])æ–¹æ³•è®¾ç½®æˆ–èŽ·å–å…ƒç´ å®½åº¦(ç›¸å½“äºŽèŽ·å–heightå±žæ€§å€¼)ç”¨ä¸Šé¢æŒ‰é’®ä»£ç è‡ªå·±å†™,å·¥ä½œåŽéƒ½å¾—é è‡ªå·±,å¤šé”»ç‚¼è‡ªå­¦èƒ½åŠ›(å¦‚ä½•æŸ¥çœ‹æ–‡æ¡£,å¦‚ä½•ç¼–å†™æµ‹è¯•æ¡ˆä¾‹ç­‰)innerHeight()/innerWidth()ç”¨ä¸Šé¢æŒ‰é’®ä»£ç è‡ªå·±å†™,å·¥ä½œåŽéƒ½å¾—é è‡ªå·±,å¤šé”»ç‚¼è‡ªå­¦èƒ½åŠ›(å¦‚ä½•æŸ¥çœ‹æ–‡æ¡£,å¦‚ä½•ç¼–å†™æµ‹è¯•æ¡ˆä¾‹ç­‰)outerHeight/outerWidth()ç”¨ä¸Šé¢æŒ‰é’®ä»£ç è‡ªå·±å†™,å·¥ä½œåŽéƒ½å¾—é è‡ªå·±,å¤šé”»ç‚¼è‡ªå­¦èƒ½åŠ›(å¦‚ä½•æŸ¥çœ‹æ–‡æ¡£,å¦‚ä½•ç¼–å†™æµ‹è¯•æ¡ˆä¾‹ç­‰)3. jQueryæ“ä½œå…ƒç´ ä½ç½®offset([coordinates])èŽ·å–æˆ–è®¾ç½®å…ƒç´ ç›¸å¯¹çª—å£çš„åç§»ä½position()èŽ·å–ç›¸å¯¹äºŽå®ƒæœ€è¿‘çš„å…·æœ‰ç›¸å¯¹ä½ç½®(position:relativeæˆ–position:absolute)çš„çˆ¶çº§å…ƒç´ çš„è·ç¦»12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;22-jQueryå°ºå¯¸å’Œä½ç½®æ“ä½œ&lt;/title&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; .father &#123; width: 200px; height: 200px; background: yellowgreen; border: 50px solid #000000; margin-left: 50px; position: relative; &#125; .son &#123; width: 100px; height: 100px; background: gold; position: absolute; top: 50px; left: 50px; &#125; &lt;/style&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; var btns = document.getElementsByTagName('button'); // ç›‘å¬èŽ·å– btns[0].onclick = function () &#123; // èŽ·å–å…ƒç´ çš„å®½åº¦ // console.log($('.father').width()); &#125;; // ç›‘å¬è®¾ç½® btns[1].onclick = function () &#123; // è®¾ç½®å…ƒç´ çš„å®½åº¦ // $('.father').width('500px'); // $('.son').offset(&#123; // left:10 // &#125;) &#125;; // offset([coordinates]) // ä½œç”¨ï¼šèŽ·å–å…ƒç´ è·ç¦»çª—å£çš„åç§»ä½ // console.log($('.son').offset().left); // position() // ä½œç”¨ï¼šèŽ·å–å…ƒç´ è·ç¦»å®šä½å…ƒç´ çš„åç§»ä½,åªèƒ½èŽ·å–ï¼Œä¸èƒ½è®¾ç½® // $('.son').position(&#123; // left:20 // &#125;) console.log($('.son').position().left); $('.son').css(&#123; left:20, &#125;) &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="father"&gt; &lt;div class="son"&gt; &lt;/div&gt;&lt;/div&gt;&lt;button&gt;èŽ·å–&lt;/button&gt;&lt;button&gt;è®¾ç½®&lt;/button&gt;&lt;/body&gt;&lt;/html&gt;scrollTop([val])è®¾ç½®æˆ–èŽ·å–åŒ¹é…å…ƒç´ ç›¸å¯¹æ»šåŠ¨æ¡é¡¶éƒ¨çš„åç§»ã€‚scrollLeft([val])ç”¨ä¸Šé¢æŒ‰é’®ä»£ç è‡ªå·±å†™,å·¥ä½œåŽéƒ½å¾—é è‡ªå·±,å¤šé”»ç‚¼è‡ªå­¦èƒ½åŠ›(å¦‚ä½•æŸ¥çœ‹æ–‡æ¡£,å¦‚ä½•ç¼–å†™æµ‹è¯•æ¡ˆä¾‹ç­‰)12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;23-jQueryçš„scrollTopæ–¹æ³•&lt;/title&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; .scroll &#123; width: 100px; height: 100px; border: 1px solid black; overflow: auto; &#125; &lt;/style&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; var btns = document.getElementsByTagName('button'); btns[0].onclick = function () &#123; // èŽ·å–æ»šåŠ¨çš„åç§»ä½ console.log($('.scroll').scrollTop()); // èŽ·å–ç½‘é¡µæ»šåŠ¨çš„åç§»ä½ // æ³¨æ„ç‚¹ï¼šä¸ºäº†ä¿è¯æµè§ˆå™¨çš„å…¼å®¹ï¼Œéœ€è¦æŒ‰ç…§ä»¥ä¸‹å†™æ³• console.log($('html').scrollTop() + $('body').scrollTop()); &#125;; btns[1].onclick = function () &#123; // è®¾ç½®æ»šåŠ¨çš„åç§»ä½ $('.scroll').scrollTop(10); // è®¾ç½®ç½‘é¡µçš„æ»šåŠ¨åç§»ä½ // æ³¨æ„ç‚¹ï¼šä¸ºäº†ä¿è¯æµè§ˆå™¨çš„å…¼å®¹ï¼Œè®¾ç½®ç½‘é¡µæ»šåŠ¨åç§»ä½çš„æ—¶å€™éœ€è¦æŒ‰ç…§ä»¥ä¸‹å†™æ³• $('html,body').scrollTop(20) &#125;; &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="scroll"&gt; æˆ‘æ˜¯div æˆ‘æ˜¯div æˆ‘æ˜¯div æˆ‘æ˜¯div æˆ‘æ˜¯div æˆ‘æ˜¯div æˆ‘æ˜¯div æˆ‘æ˜¯div&lt;/div&gt;&lt;button&gt;èŽ·å–&lt;/button&gt;&lt;button&gt;è®¾ç½®&lt;/button&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;/body&gt;&lt;/html&gt;ä¸ƒã€äº‹ä»¶å¤„ç†1. äº‹ä»¶ç»‘å®šjQueryä¸­äº‹ä»¶ç»‘å®šæœ‰ä¸¤ç§æ–¹å¼eventName(function(){})ç»‘å®šå¯¹åº”äº‹ä»¶åçš„ç›‘å¬, ä¾‹å¦‚ï¼š$(â€˜#divâ€™).click(function(){});on(eventName, funcion(){})é€šç”¨çš„ç»‘å®šäº‹ä»¶ç›‘å¬, ä¾‹å¦‚ï¼š$(â€˜#divâ€™).on(â€˜clickâ€™, function(){});ä¼˜ç¼ºç‚¹:eventName: ç¼–ç æ–¹ä¾¿, ä½†æœ‰çš„äº‹ä»¶ç›‘å¬ä¸æ”¯æŒon: ç¼–ç ä¸æ–¹ä¾¿, ä½†æ›´é€šç”¨ä¼ä¸šå¼€å‘ä¸­å¦‚ä½•é€‰æ‹©?èƒ½ç”¨eventNameå°±ç”¨eventName, ä¸èƒ½ç”¨eventNameå°±ç”¨onç¤ºä¾‹:1234567891011121314151617181920212223242526272829303132&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;24-jQueryäº‹ä»¶ç»‘å®š&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; // jQueryä¸­æœ‰ä¸¤ç§ç»‘å®šäº‹ä»¶æ–¹å¼ // 1.eventName(fn); // ç¼–ç æ•ˆçŽ‡ç•¥é«˜,éƒ¨åˆ†äº‹ä»¶jQueryæ²¡æœ‰å®žçŽ°ï¼Œæ‰€æœ‰ä¸èƒ½æ·»åŠ  $('button').click(function () &#123; alert('hello'); &#125;); // 2.on(eventName,fn); // ç¼–ç æ•ˆçŽ‡ç•¥ä½Žï¼Œæ‰€æœ‰jsäº‹ä»¶éƒ½å¯ä»¥æ·»åŠ  $('button').on('click', function () &#123; alert('hello click'); &#125;) // æ³¨æ„ç‚¹: // å¯ä»¥å¤šæ¬¡æ·»åŠ ç›¸åŒæˆ–ä¸åŒç±»åž‹çš„äº‹ä»¶ä¸,ä¸”ä¼šè¦†ç›– &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;button&gt;æˆ‘æ˜¯æŒ‰é’®&lt;/button&gt;&lt;/body&gt;&lt;/html&gt;2. äº‹ä»¶è§£ç»‘jQueryä¸­å¯ä»¥é€šè¿‡off(eventName,function);è§£ç»‘äº‹ä»¶ç¤ºä¾‹:123456789101112131415161718192021222324252627282930313233343536373839404142&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;25-jQueryäº‹ä»¶è§£ç»‘&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; function test1() &#123; alert('test1'); &#125; function test2() &#123; alert('test2'); &#125; $('button').click(test1); $('button').click(test2); $('button').mouseleave(function () &#123; alert('mouseleave'); &#125;); $('button').mouseenter(function () &#123; alert('mouseenter'); &#125;); // offæ–¹æ³•å¦‚æžœä¸ä¼ é€’å‚æ•°ï¼Œä¼šç§»é™¤æ‰€æœ‰çš„äº‹ä»¶ // $('button').off(); // offæ–¹æ³•å¦‚æžœä¼ é€’ä¸€ä¸ªå‚æ•°ï¼Œä¼šç§»é™¤æ‰€æœ‰æŒ‡å®šç±»åž‹çš„äº‹ä»¶ // $('button').off('click'); // offæ–¹æ³•å¦‚æžœä¼ é€’ä¸¤ä¸ªå‚æ•°ï¼Œä¼šç§»é™¤æ‰€æœ‰æŒ‡å®šç±»åž‹çš„æŒ‡å®šäº‹ä»¶ // $('button').off('clickï¼Œtest1'); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;button&gt;æˆ‘æ˜¯æŒ‰é’®&lt;/button&gt;&lt;/body&gt;&lt;/html&gt;3. èŽ·å–äº‹ä»¶çš„åæ ‡å½“äº‹ä»¶è¢«è§¦å‘æ—¶,ç³»ç»Ÿä¼šå°†äº‹ä»¶å¯¹è±¡(event)ä¼ é€’ç»™å›žè°ƒå‡½æ•°,é€šè¿‡eventå¯¹è±¡æˆ‘ä»¬å°±èƒ½èŽ·å–æ—¶é—´çš„åæ ‡èŽ·å–äº‹ä»¶åæ ‡æœ‰ä¸‰ç§æ–¹å¼event.offsetX, event.offsetY ç›¸å¯¹äºŽäº‹ä»¶å…ƒç´ å·¦ä¸Šè§’event.pageX, event.pageY ç›¸å¯¹äºŽé¡µé¢çš„å·¦ä¸Šè§’event.clientX, event.clientY ç›¸å¯¹äºŽè§†å£çš„å·¦ä¸Šè§’event.pageå’Œevent.clientåŒºåˆ«ç½‘é¡µæ˜¯å¯ä»¥æ»šåŠ¨çš„,è€Œè§†å£æ˜¯å›ºå®šçš„æ‰€ä»¥æƒ³èŽ·å–è·ç¦»å¯è§†åŒºåŸŸåæ ‡é€šè¿‡event.clientæƒ³èŽ·å–è·ç¦»ç½‘é¡µå·¦ä¸Šè§’çš„åæ ‡é€šè¿‡event.clientç¤ºä¾‹ä»£ç 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;13-jQueryäº‹ä»¶ç»‘å®šå’Œè§£ç»‘&lt;/title&gt; &lt;style&gt; *&#123; margin: 0; padding: 0; &#125; .father&#123; width: 200px; height: 200px; background: red; overflow: hidden; &#125; .son&#123; width: 100px; height: 100px; background: blue; margin-top: 50px; margin-left: 50px; &#125; &lt;/style&gt; &lt;script src=&quot;../day01/ä»£ç /js/jquery-1.12.4.js&quot;&gt;&lt;/script&gt; &lt;script&gt; $(function () &#123; // èŽ·å–äº‹ä»¶çš„åæ ‡ $(&quot;.son&quot;).click(function (event) &#123; // èŽ·å–ç›¸å¯¹äºŽäº‹ä»¶å…ƒç´ å·¦ä¸Šè§’åæ ‡ console.log(event.offsetX, event.offsetY); // èŽ·å–ç›¸å¯¹äºŽè§†å£å·¦ä¸Šè§’åæ ‡ console.log(event.clientX, event.clientY); // èŽ·å–ç›¸å¯¹äºŽé¡µé¢å·¦ä¸Šè§’åæ ‡ console.log(event.pageX, event.pageY); &#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div class=&quot;father&quot;&gt; &lt;div class=&quot;son&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/body&gt;&lt;/html&gt;4. é˜»æ­¢äº‹ä»¶å†’æ³¡ä»€ä¹ˆæ˜¯äº‹ä»¶å†’æ³¡?äº‹ä»¶å†’æ³¡æ˜¯ä»Žç›®æ ‡å…ƒç´ é€çº§å‘ä¸Šä¼ æ’­åˆ°æ ¹èŠ‚ç‚¹çš„è¿‡ç¨‹å°æ˜Žå‘Šè¯‰çˆ¸çˆ¸ä»–æœ‰ä¸€ä¸ªå¥³ç¥¨,çˆ¸çˆ¸å‘Šè¯‰çˆ·çˆ·å­™å­æœ‰ä¸€ä¸ªå¥³ç¥¨,ä¸€çº§çº§å‘ä¸Šä¼ é€’å°±æ˜¯äº‹ä»¶å†’æ³¡å¦‚ä½•é˜»æ­¢äº‹ä»¶å†’æ³¡?å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨è§¦å‘ä¸€ä¸ªå…ƒç´ çš„äº‹ä»¶å¤„ç†ç¨‹åºæ—¶ï¼Œä¸å½±å“å®ƒçš„çˆ¶å…ƒç´ , æ­¤æ—¶ä¾¿å¯ä»¥ä½¿ç”¨åœæ­¢äº‹ä»¶å†’æ³¡12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;26-jQueryäº‹ä»¶å†’æ³¡å’Œé»˜è®¤è¡Œä¸º&lt;/title&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; .father &#123; width: 200px; height: 200px; background: yellowgreen; &#125; .son &#123; width: 100px; height: 100px; background: gold; &#125; &lt;/style&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; // 1.ä»€ä¹ˆæ˜¯äº‹ä»¶å†’æ³¡ // 2.å¦‚ä½•é˜»æ­¢äº‹ä»¶å†’æ³¡ // ç¬¬ä¸€ç§æ˜¯ä½¿ç”¨return false; // ç¬¬äºŒç§æ˜¯è°ƒç”¨event.stopPropagation(); $('.son').click(function (event) &#123; alert('son'); // return false; event.stopPropagation(); &#125;); $('.father').click(function () &#123; alert('father'); &#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="father"&gt; &lt;div class="son"&gt; &lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;5. é˜»æ­¢äº‹ä»¶é»˜è®¤è¡Œä¸ºä»€ä¹ˆæ˜¯é»˜è®¤è¡Œä¸º?ç½‘é¡µä¸­çš„å…ƒç´ æœ‰è‡ªå·±çš„é»˜è®¤è¡Œä¸º,ä¾‹å¦‚å•å‡»è¶…é“¾æŽ¥åŽä¼šè·³è½¬,ç‚¹å‡»æäº¤è¡¨å•æŒ‰é’®ä¼šæäº¤å¦‚ä½•é˜»æ­¢äº‹ä»¶é»˜è®¤è¡Œä¸º?å¯ä»¥ä½¿ç”¨event.preventDefault();æ–¹æ³•é˜»æ­¢äº‹ä»¶é»˜è®¤è¡Œä¸ºæ–¹æ³•123456789101112131415161718192021222324252627282930313233343536373839404142434445464748&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;26-jQueryäº‹ä»¶å†’æ³¡å’Œé»˜è®¤è¡Œä¸º&lt;/title&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; .father &#123; width: 200px; height: 200px; background: yellowgreen; &#125; .son &#123; width: 100px; height: 100px; background: gold; &#125; &lt;/style&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; // 1.ä»€ä¹ˆæ˜¯é»˜è®¤è¡Œä¸º // 2.å¦‚ä½•é˜»æ­¢é»˜è®¤è¡Œä¸º // ç¬¬ä¸€ç§æ˜¯ä½¿ç”¨return false; // ç¬¬äºŒç§æ˜¯è°ƒç”¨event.stopPropagation(); $('a').click(function (event) &#123; alert('å¼¹å‡ºæ³¨å†Œæ¡†'); // return false; event.stopPropagation(); &#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;a href="http://www.baidu.com"&gt;æˆ‘æ˜¯ç™¾åº¦&lt;/a&gt;&lt;form action="http://www.taobao.com"&gt; &lt;input type="text"&gt; &lt;input type="submit"&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;6. è‡ªåŠ¨è§¦å‘äº‹ä»¶ä»€ä¹ˆæ˜¯è‡ªåŠ¨è§¦å‘äº‹ä»¶é€šè¿‡ä»£ç æŽ§åˆ¶äº‹ä»¶, ä¸ç”¨äººä¸ºç‚¹å‡»/ç§»å…¥/ç§»é™¤ç­‰äº‹ä»¶å°±èƒ½è¢«è§¦å‘è‡ªåŠ¨è§¦å‘äº‹ä»¶æ–¹å¼$(â€œselectorâ€).trigger(â€œeventNameâ€);è§¦å‘äº‹ä»¶çš„åŒæ—¶ä¼šè§¦å‘äº‹ä»¶å†’æ³¡è§¦å‘äº‹ä»¶çš„åŒæ—¶ä¼šè§¦å‘äº‹ä»¶é»˜è®¤è¡Œä¸º$(â€œselectorâ€).triggerHandler(â€œeventNameâ€);è§¦å‘äº‹ä»¶çš„åŒæ—¶ä¸ä¼šè§¦å‘äº‹ä»¶å†’æ³¡è§¦å‘äº‹ä»¶çš„åŒæ—¶ä¸ä¼šè§¦å‘äº‹ä»¶é»˜è®¤è¡Œä¸º12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;27-jQueryäº‹ä»¶è‡ªåŠ¨è§¦å‘&lt;/title&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; .father &#123; width: 200px; height: 200px; background: yellowgreen; &#125; .son &#123; width: 100px; height: 100px; background: gold; &#125; &lt;/style&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; $('.son').click(function () &#123; alert('son'); &#125;); $('.father').click(function () &#123; alert('father'); &#125;); /* * trigger:å¦‚æžœåˆ©ç”¨triggerè‡ªåŠ¨è§¦å‘äº‹ä»¶ï¼Œä¼šè§¦å‘äº‹ä»¶å†’æ³¡ * triggerHandlerï¼šå¦‚æžœåˆ©ç”¨triggerè‡ªåŠ¨è§¦å‘äº‹ä»¶ï¼Œä¸ä¼šè§¦å‘äº‹ä»¶å†’æ³¡ */ // $('.father').trigger('click'); // $('.son').trigger('click'); // $('.father').triggerHandler('click'); // $('.son').triggerHandler('click'); /* * trigger:å¦‚æžœåˆ©ç”¨triggerè‡ªåŠ¨è§¦å‘äº‹ä»¶ï¼Œä¼šè§¦å‘é»˜è®¤è¡Œä¸º * triggerHandlerï¼šå¦‚æžœåˆ©ç”¨triggerè‡ªåŠ¨è§¦å‘äº‹ä»¶ï¼Œä¸ä¼šè§¦å‘é»˜è®¤è¡Œä¸º */ // $("input[type='submit']").click(function () &#123; // alert('submit'); // &#125;); // $("input[type='submit']").trigger('click'); // $("input[type='submit']").triggerHandler('click'); $('a').click(function () &#123; alert('a'); &#125;); // æ³¨æ„ç‚¹ï¼štriggerå’ŒtriggerHandleré’ˆå¯¹aæ ‡ç­¾çš„æ“ä½œä¸€æ ·ï¼Œä¸ä¼šè§¦å‘é»˜è®¤è¡Œä¸º // $('a').trigger('click'); // $('a').triggerHandler('click'); // ä½†æ˜¯è‹¥æƒ³aæ ‡ç­¾è‡ªåŠ¨è§¦å‘ï¼Œä¸”æœ‰é»˜è®¤è¡Œä¸º,éœ€è¦é’ˆå¯¹aæ ‡ç­¾é‡Œçš„spanå…ƒç´ è¿›è¡Œæ“ä½œ $('span').trigger('click'); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="father"&gt; &lt;div class="son"&gt; &lt;/div&gt;&lt;/div&gt;&lt;a href="http://www.baidu.com"&gt;æˆ‘æ˜¯ç™¾åº¦&lt;/a&gt;&lt;a href="http://www.baidu.com"&gt;&lt;span&gt;æˆ‘æ˜¯æœ‰é»˜è®¤è¡Œä¸ºçš„&lt;/span&gt;&lt;/a&gt;&lt;form action="http://www.taobao.com"&gt; &lt;input type="text"&gt; &lt;input type="submit"&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;7. äº‹ä»¶å‘½åç©ºé—´å’Œè‡ªå®šä¹‰äº‹ä»¶ä»€ä¹ˆæ˜¯è‡ªå®šä¹‰äº‹ä»¶è‡ªå®šä¹‰äº‹ä»¶å°±æ˜¯è‡ªå·±è™¾XXèµ·ä¸€ä¸ªä¸å­˜åœ¨çš„äº‹ä»¶åç§°æ¥æ³¨å†Œäº‹ä»¶, ç„¶åŽé€šè¿‡è¿™ä¸ªåç§°è¿˜èƒ½è§¦å‘å¯¹åº”çš„æ–¹æ³•æ‰§è¡Œ, è¿™å°±æ˜¯ä¼ è¯´ä¸­çš„è‡ªå®šä¹‰äº‹ä»¶è‡ªå®šä¹‰äº‹ä»¶çš„å‰ææ¡ä»¶1.äº‹ä»¶å¿…é¡»æ˜¯é€šè¿‡onç»‘å®šçš„2.äº‹ä»¶å¿…é¡»é€šè¿‡triggeræ¥è§¦å‘å› ä¸ºtriggeræ–¹æ³•å¯ä»¥è‡ªåŠ¨è§¦å‘å¯¹åº”åç§°çš„äº‹ä»¶,æ‰€ä»¥åªè¦äº‹ä»¶çš„åç§°å’Œä¼ é€’ç»™triggerçš„åç§°ä¸€è‡´å°±èƒ½æ‰§è¡Œå¯¹åº”çš„äº‹ä»¶æ–¹æ³•123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;28-jQueryè‡ªå®šä¹‰äº‹ä»¶&lt;/title&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; .father &#123; width: 200px; height: 200px; background: yellowgreen; &#125; .son &#123; width: 100px; height: 100px; background: gold; &#125; &lt;/style&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; /* * è‡ªå®šä¹‰äº‹ä»¶éœ€è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ * 1.äº‹ä»¶å¿…é¡»æ˜¯é€šè¿‡onç»‘å®š * 2.äº‹ä»¶å¿…é¡»é€šè¿‡triggeræ¥è§¦å‘ * * */ // $('.son').myClick(function () &#123; // alert('son'); // &#125;); // $('.son').trigger('myClick'); $('.son').on('myClick', function () &#123; alert('son'); &#125;); $('.son').trigger('myClick'); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="father"&gt; &lt;div class="son"&gt; &lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;ä»€ä¹ˆæ˜¯äº‹ä»¶å‘½åç©ºé—´ä¼—æ‰€å‘¨çŸ¥ä¸€ä¸ªå…ƒç´ å¯ä»¥ç»‘å®šå¤šä¸ªç›¸åŒç±»åž‹çš„äº‹ä»¶.ä¼ä¸šå¤šäººååŒå¼€å‘ä¸­,å¦‚æžœå¤šäººåŒæ—¶ç»™æŸä¸€ä¸ªå…ƒç´ ç»‘å®šäº†ç›¸åŒç±»åž‹çš„äº‹ä»¶,ä½†æ˜¯äº‹ä»¶å¤„ç†çš„æ–¹å¼ä¸åŒ,å°±å¯èƒ½å¼•å‘äº‹ä»¶æ··ä¹±ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜jQueryæå‡ºäº†äº‹ä»¶å‘½åç©ºé—´çš„æ¦‚å¿µäº‹ä»¶å‘½åç©ºé—´ä¸»è¦ç”¨äºŽåŒºåˆ†ç›¸åŒç±»åž‹çš„äº‹ä»¶,åŒºåˆ†ä¸åŒå‰ææ¡ä»¶ä¸‹åˆ°åº•åº”è¯¥è§¦å‘å“ªä¸ªäººç¼–å†™çš„äº‹ä»¶æ ¼å¼: â€œeventName.å‘½åç©ºé—´â€æ·»åŠ äº‹ä»¶å‘½åç©ºé—´çš„å‰ææ¡ä»¶1.äº‹ä»¶æ˜¯é€šè¿‡onæ¥ç»‘å®šçš„2.é€šè¿‡triggerè§¦å‘äº‹ä»¶æ³¨æ„ç‚¹(é¢è¯•é¢˜!!!é¢è¯•é¢˜!!!é¢è¯•é¢˜!!!):ä¸å¸¦å‘½åç©ºé—´äº‹ä»¶è¢«triggerè°ƒç”¨,ä¼šè§¦å‘å¸¦å‘½åç©ºé—´äº‹ä»¶å¸¦å‘½åç©ºé—´äº‹ä»¶è¢«triggerè°ƒç”¨,åªä¼šè§¦å‘å¸¦å‘½åç©ºé—´äº‹ä»¶ä¸‹çº§ä¸å¸¦å‘½åç©ºé—´äº‹ä»¶è¢«triggerè°ƒç”¨,ä¼šå†’æ³¡è§¦å‘ä¸Šçº§ä¸å¸¦å‘½åç©ºé—´å’Œå¸¦å‘½åç©ºé—´äº‹ä»¶ä¸‹çº§å¸¦å‘½åç©ºé—´äº‹ä»¶è¢«triggerè°ƒç”¨,ä¸ä¼šè§¦å‘ä¸Šçº§ä¸å¸¦å‘½åç©ºé—´äº‹ä»¶ä¸‹çº§å¸¦å‘½åç©ºé—´äº‹ä»¶è¢«triggerè°ƒç”¨,ä¼šè§¦å‘ä¸Šçº§å¸¦å‘½åç©ºé—´äº‹ä»¶ç¤ºä¾‹:123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;29-jQueryäº‹ä»¶å‘½åç©ºé—´&lt;/title&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; .father &#123; width: 200px; height: 200px; background: yellowgreen; &#125; .son &#123; width: 100px; height: 100px; background: gold; &#125; &lt;/style&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; /* * æƒ³è¦äº‹ä»¶çš„å‘½åç©ºé—´æœ‰æ•ˆï¼Œå¿…é¡»æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ * 1.äº‹ä»¶æ˜¯é€šè¿‡onç»‘å®šçš„ * 2.é€šè¿‡triggerè§¦å‘äº‹ä»¶ * */ $('.son').on('click.zs', function () &#123; alert('click-1'); // è‡ªåŠ¨å¼¹å‡º &#125;); $('.son').on('click.ls', function () &#123; alert('click-2'); &#125;); $('.son').trigger('click.zs'); // $('.son').trigger('click.ls'); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="father"&gt; &lt;div class="son"&gt; &lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;30-jQueryäº‹ä»¶å‘½åç©ºé—´é¢è¯•é¢˜&lt;/title&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; .father &#123; width: 200px; height: 200px; background: yellowgreen; &#125; .son &#123; width: 100px; height: 100px; background: gold; &#125; &lt;/style&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; $('.father').on('click.zs', function () &#123; alert('father click-1'); &#125;); $('.father').on('click', function () &#123; alert('father click-2'); &#125;); $('.son').on('click.zs', function () &#123; alert('son click-1'); &#125;); // 1.åˆ©ç”¨triggerè§¦å‘å­å…ƒç´ å¸¦æœ‰å‘½ä»¤ç©ºé—´çš„äº‹ä»¶ï¼Œé‚£ä¹ˆçˆ¶å…ƒç´ å¸¦ç›¸åŒå‘½åç©ºé—´çš„äº‹ä»¶ä¹Ÿä¼šè¢«è§¦å‘ï¼Œè€Œçˆ¶å…ƒç´ æ²¡æœ‰å‘½ä»¤ç©ºé—´çš„ä¸ä¼šè¢«è§¦å‘ // $('.son').trigger('click.zs'); // 2.åˆ©ç”¨triggerè§¦å‘å­å…ƒç´ ä¸å¸¦å‘½ä»¤ç©ºé—´çš„äº‹ä»¶ï¼Œé‚£ä¹ˆå­å…ƒç´ æ‰€æœ‰ç›¸åŒç±»åž‹çš„äº‹ä»¶å’Œçˆ¶å…ƒç´ æ‰€æœ‰ç›¸åŒçš„äº‹ä»¶éƒ½ä¼šè¢«è§¦å‘ $('.son').trigger('click'); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="father"&gt; &lt;div class="son"&gt; &lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;8.äº‹ä»¶å§”æ‰˜ä»€ä¹ˆæ˜¯äº‹ä»¶å§”æ‰˜ä¾‹å¦‚: å¼ ä¸‰åœ¨å¯å®¤ä¸æƒ³åŽ»é£Ÿå ‚åƒé¥­,é‚£ä¹ˆå¼ ä¸‰å¯ä»¥â€å§”æ‰˜â€æŽå››å¸®å¿™å¸¦ä¸€ä»½é¥­ä¾‹å¦‚: å¼ ä¸‰å…ˆæ‰¾æˆ¿,ä½†æ˜¯å¯¹è¦æ‰¾æˆ¿çš„åœ°ç‚¹åˆä¸ç†Ÿæ‚‰,é‚£ä¹ˆå¼ ä¸‰å¯ä»¥â€å§”æ‰˜â€ä¸­ä»‹å¸®å¿™æ‰¾æˆ¿æ‰€ä»¥å¾—å‡ºç»“è®º:äº‹ä»¶å§”æ‰˜å°±æ˜¯è¯·å…¶ä»–äººå¸®å¿™åšæˆ‘ä»¬æƒ³åšçš„äº‹åšå®Œä¹‹åŽæœ€ç»ˆçš„ç»“æžœè¿˜æ˜¯ä¼šåé¦ˆåˆ°æˆ‘ä»¬è¿™é‡Œjsä¸­äº‹ä»¶å§”æ‰˜çš„å¥½å¤„å‡å°‘ç›‘å¬æ•°é‡æ·»åŠ åˆ°é¡µé¢ä¸Šçš„äº‹ä»¶å¤„ç†ç¨‹åºæ•°é‡å°†ç›´æŽ¥å…³ç³»åˆ°é¡µé¢çš„æ•´ä½“è¿è¡Œæ€§èƒ½ï¼Œå› ä¸ºéœ€è¦ä¸æ–­çš„ä¸ŽdomèŠ‚ç‚¹è¿›è¡Œäº¤äº’ï¼Œè®¿é—®domçš„æ¬¡æ•°è¶Šå¤šï¼Œå¼•èµ·æµè§ˆå™¨é‡ç»˜ä¸Žé‡æŽ’çš„æ¬¡æ•°ä¹Ÿå°±è¶Šå¤šï¼Œå°±ä¼šå»¶é•¿æ•´ä¸ªé¡µé¢çš„äº¤äº’å°±ç»ªæ—¶é—´æ¯ä¸ªç›‘å¬çš„å‡½æ•°éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ˜¯å¯¹è±¡å°±ä¼šå ç”¨å†…å­˜ï¼Œå¯¹è±¡è¶Šå¤šï¼Œå†…å­˜å ç”¨çŽ‡å°±è¶Šå¤§ï¼Œè‡ªç„¶æ€§èƒ½å°±è¶Šå·®â€¦ â€¦æ–°å¢žå…ƒç´ è‡ªåŠ¨æœ‰äº‹ä»¶å“åº”å¤„ç†é»˜è®¤æƒ…å†µä¸‹æ–°å¢žçš„å…ƒç´ æ— æ³•å“åº”æ–°å¢žå‰æ·»åŠ çš„äº‹ä»¶jQueryä¸­å¦‚ä½•æ·»åŠ äº‹ä»¶å§”æ‰˜æ·»åŠ å‰$(â€œliâ€).clickéšå¼è¿­ä»£ç»™ç•Œé¢ä¸Šæ‰€æœ‰liéƒ½æ·»åŠ äº†clickäº‹ä»¶(ç›‘å¬æ•°é‡ä¼—å¤š)é€šè¿‡$(â€œulâ€).appendæ–°æ·»åŠ çš„liæ— æ³•å½±å“clickäº‹ä»¶æ·»åŠ åŽæ ¼å¼:$(parentSelector).delegate(childrenSelector, eventName, callback)$(â€œulâ€).delegateéšå¼è¿­ä»£æ‰€æœ‰ulæ·»åŠ äº‹ä»¶(ç›¸æ¯”å¼€å§‹è¿­ä»£li,å¿…ç„¶ulçš„ä¸ªæ•°ä¼šå°‘å¾ˆå¤š)å½“äº‹ä»¶è¢«è§¦å‘æ—¶,ç³»ç»Ÿä¼šè‡ªåŠ¨åŠ¨æ€æŸ¥æ‰¾å½“å‰æ˜¯å“ªä¸ªliè§¦å‘äº†äº‹ä»¶,æ‰€ä»¥æ–°å¢žçš„liä¹Ÿèƒ½å“åº”åˆ°äº‹ä»¶1234567891011121314151617181920212223242526272829303132333435363738&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;31-jQueryäº‹ä»¶å§”æ‰˜&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; /* * 1.ä»€ä¹ˆæ˜¯äº‹ä»¶å§”æ‰˜ * è¯·åˆ«äººå¸®å¿™åšäº‹æƒ…ï¼Œç„¶åŽå°†åšå®Œçš„ç»“æžœåé¦ˆç»™æˆ‘ä»¬ * */ $('button').click(function () &#123; $('ul').append('&lt;li&gt;æˆ‘æ˜¯æ–°å¢žçš„li&lt;/li&gt;'); &#125;); // åœ¨jQueryä¸­å¦‚æžœé€šè¿‡æ ¸å¿ƒå‡½æ•°æ‰¾åˆ°çš„å…ƒç´ ä¸æ­¢ä¸€ä¸ªï¼Œé‚£ä¹ˆåœ¨æ·»åŠ äº‹ä»¶çš„æ—¶å€™jQueryä¼šéåŽ†æ‰€æœ‰æ‰¾åˆ°çš„å…ƒç´ ï¼Œç»™æ‰€æœ‰æ‰¾åˆ°çš„å…ƒç´ æ·»åŠ äº‹ä»¶ // $('ul&gt;li').click(function () &#123; // console.log($(this).html()); // &#125;); $('ul').delegate('li','click',function () &#123; console.log($(this).html()); &#125;) &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;ul&gt; &lt;li&gt;æˆ‘æ˜¯ç¬¬1ä¸ªli&lt;/li&gt; &lt;li&gt;æˆ‘æ˜¯ç¬¬2ä¸ªli&lt;/li&gt; &lt;li&gt;æˆ‘æ˜¯ç¬¬3ä¸ªli&lt;/li&gt;&lt;/ul&gt;&lt;button&gt;æ–°å¢ž1ä¸ªli&lt;/button&gt;&lt;/body&gt;&lt;/html&gt;äº‹ä»¶å§”æ‰˜ç»ƒä¹ ç‚¹å‡»ç™»å½•æŒ‰é’®ï¼Œå‡ºçŽ°ä¸€ä¸ªç™»å½•ç•Œé¢(å…¶å®žæ˜¯ä¸ªå›¾ç‰‡),ç™»å½•ç•Œé¢å³ä¸Šè§’ä½¿ç”¨spanæ ‡ç­¾å®šä¹‰äº†å…³é—­(ç§»é™¤)æ“ä½œï¼ŒåŒæ—¶é˜»æ­¢äº†é»˜è®¤è¡Œä¸º12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;32-jQueryäº‹ä»¶å§”æ‰˜ç»ƒä¹ &lt;/title&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; html, body &#123; width: 100%; height: 100%; &#125; .mask &#123; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); position: fixed; top: 0; left: 0; &#125; .login &#123; width: 522px; height: 290px; margin: 100px auto; position: relative; &#125; .login &gt; span &#123; width: 50px; height: 50px; /*background: red;*/ /*æ˜¾ç¤ºå‡ºå…³é—­æŒ‰é’®çš„ä½ç½®*/ position: absolute; top: 0; right: 0; &#125; &lt;/style&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; $('a').click(function () &#123; var $mask = $("&lt;div class=\"mask\"&gt;\n" + " &lt;div class=\"login\"&gt;\n" + " &lt;img src=\"images/login.jpg\" alt=\"\"&gt;\n" + " &lt;span&gt;&lt;/span&gt;\n" + " &lt;/div&gt;\n" + "&lt;/div&gt;"); $('body').append($mask); $('body').delegate('.login&gt;span', 'click', function () &#123; $mask.remove(); &#125;); return false; &#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;a href="http://www.baidu.com"&gt;ç‚¹å‡»ç™»å½•&lt;/a&gt;&lt;div&gt; æˆ‘æ˜¯æ®µè½ æˆ‘æ˜¯æ®µè½ æˆ‘æ˜¯æ®µè½ æˆ‘æ˜¯æ®µè½ æˆ‘æ˜¯æ®µè½ æˆ‘æ˜¯æ®µè½ æˆ‘æ˜¯æ®µè½ æˆ‘æ˜¯æ®µè½ æˆ‘æ˜¯æ®µè½ æˆ‘æ˜¯æ®µè½&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;9.ç§»å…¥ç§»å‡ºäº‹ä»¶mouseenterå’Œmouseleaveç§»åŠ¨åˆ°å­å…ƒç´ ä¸ä¼šè§¦å‘äº‹ä»¶mouseoverå’Œmouseoutç§»åŠ¨åˆ°å­å…ƒç´ ä¼šè§¦å‘äº‹ä»¶hoverå†…å®¹ç›‘å¬ç§»å…¥å’Œç§»å‡ºå†…éƒ¨å®žçŽ°å°±æ˜¯è°ƒç”¨mouseenterå’Œmouseleave1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;33-jQueryç§»å…¥ç§»å‡ºäº‹ä»¶&lt;/title&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; .father &#123; width: 200px; height: 200px; background: yellowgreen; &#125; .son &#123; width: 100px; height: 100px; background: gold; &#125; &lt;/style&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; /* * mouseover/mouseoutäº‹ä»¶ï¼Œå­å…ƒç´ è¢«ç§»å…¥ç§»å‡ºä¹Ÿä¼šè§¦å‘çˆ¶å…ƒç´ çš„äº‹ä»¶ * */ // $(".father").mouseover(function () &#123; // console.log('fatherè¢«ç§»å…¥äº†ï¼') // &#125;); // $(".father").mouseout(function () &#123; // console.log('fatherè¢«ç§»å‡ºäº†ï¼') // &#125;); /* * mouseenter/mouseleaveäº‹ä»¶ï¼Œå­å…ƒç´ è¢«ç§»å…¥ç§»å‡ºä¸ä¼šè§¦å‘çˆ¶å…ƒç´ çš„äº‹ä»¶ * æŽ¨èå¤§å®¶ä½¿ç”¨ * */ // $(".father").mouseenter(function () &#123; // console.log('fatherè¢«ç§»å…¥äº†ï¼') // &#125;); // $(".father").mouseleave(function () &#123; // console.log('fatherè¢«ç§»å‡ºäº†ï¼') // &#125;); /* * hoveräº‹ä»¶ï¼Œç¬¬ä¸€ä¸ªå‡½æ•°æ˜¯ç›‘å¬ç§»å…¥äº‹ä»¶ï¼Œç¬¬äºŒä¸ªå‡½æ•°æ˜¯ç›‘å¬ç§»å‡ºäº‹ä»¶ï¼Œå­å…ƒç´ è¢«ç§»å…¥ç§»å‡ºä¸ä¼šè§¦å‘çˆ¶å…ƒç´ çš„äº‹ä»¶ * */ // $(".father").hover(function () &#123; // console.log('fatherè¢«ç§»å…¥äº†ï¼') // &#125;, function () &#123; // console.log('fatherè¢«ç§»å‡ºäº†ï¼') // &#125;); /* * hoveräº‹ä»¶åªç”¨ä¸€ä¸ªå‡½æ•°ï¼Œç›‘å¬ç§»å…¥å’Œç§»å‡ºäº‹ä»¶ï¼Œå­å…ƒç´ è¢«ç§»å…¥ç§»å‡ºä¸ä¼šè§¦å‘çˆ¶å…ƒç´ çš„äº‹ä»¶ * */ $(".father").hover(function () &#123; console.log('fatherè¢«ç§»å…¥ç§»å‡ºäº†ï¼'); &#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="father"&gt; &lt;div class="son"&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;10. ç§»å…¥ç§»å‡ºç»ƒä¹ ç”µå½±æŽ’è¡Œæ¦œï¼šé¼ æ ‡ç§»åŠ¨åˆ°å“ªä¸€è¡Œ,å“ªä¸€è¡Œå±•å¼€æ•ˆæžœ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;35-ç”µå½±æŽ’è¡Œæ¦œä¸‹&lt;/title&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; .box &#123; width: 300px; height: 450px; margin: 50px auto; border: 1px solid black; &#125; .box h1 &#123; font-size: 20px; line-height: 35px; color: deeppink; padding-left: 10px; border-bottom: 1px dashed #cccccc; &#125; ul li &#123; list-style: none; padding: 5px 10px; border: 1px dashed #cccccc; &#125; ul li:nth-child(-n+3) span &#123; background: deeppink; &#125; ul li span &#123; display: inline-block; width: 20px; height: 20px; background: #cccccc; text-align: center; line-height: 20px; margin-right: 10px; &#125; .content &#123; overflow: hidden; margin-top: 5px; display: none; &#125; .content img &#123; width: 80px; height: 120px; float: left; &#125; .content p &#123; width: 180px; height: 120px; float: right; font-size: 12px; line-height: 20px; &#125; .current .content &#123; display: block; &#125; &lt;/style&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; // 1.ç›‘å¬liçš„ç§»å‡ºäº‹ä»¶ // $('li').mouseenter(function () &#123; // $(this).addClass('current'); // &#125;); // 2.ç›‘å¬liçš„ç§»å‡ºäº‹ä»¶ // $('li').mouseleave(function () &#123; // $(this).removeClass('current'); // &#125;); // ä½¿ç”¨hoverç›‘å¬liçš„ç§»å…¥ç§»å‡ºäº‹ä»¶ $('li').hover(function () &#123; $(this).addClass('current'); &#125;, function () &#123; $(this).removeClass('current'); &#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="box"&gt; &lt;h1&gt;ç”µå½±æŽ’è¡Œæ¦œ&lt;/h1&gt; &lt;ul&gt; &lt;li&gt;&lt;span&gt;1&lt;/span&gt;ç”µå½±åç§° &lt;div class="content"&gt; &lt;img src="images/3.jpg" alt=""&gt; &lt;p&gt;è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç» è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç» &lt;/p&gt; &lt;/div&gt; &lt;/li&gt; &lt;li&gt;&lt;span&gt;2&lt;/span&gt;ç”µå½±åç§° &lt;div class="content"&gt; &lt;img src="images/3.jpg" alt=""&gt; &lt;p&gt;è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç» è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç» &lt;/p&gt; &lt;/div&gt; &lt;/li&gt; &lt;li&gt;&lt;span&gt;3&lt;/span&gt;ç”µå½±åç§° &lt;div class="content"&gt; &lt;img src="images/3.jpg" alt=""&gt; &lt;p&gt;è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç» è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç» &lt;/p&gt; &lt;/div&gt; &lt;/li&gt; &lt;li&gt;&lt;span&gt;4&lt;/span&gt;ç”µå½±åç§° &lt;div class="content"&gt; &lt;img src="images/3.jpg" alt=""&gt; &lt;p&gt;è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç» è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç» &lt;/p&gt; &lt;/div&gt; &lt;/li&gt; &lt;li&gt;&lt;span&gt;5&lt;/span&gt;ç”µå½±åç§° &lt;div class="content"&gt; &lt;img src="images/3.jpg" alt=""&gt; &lt;p&gt;è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç» è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç» &lt;/p&gt; &lt;/div&gt; &lt;/li&gt; &lt;li&gt;&lt;span&gt;6&lt;/span&gt;ç”µå½±åç§° &lt;div class="content"&gt; &lt;img src="images/3.jpg" alt=""&gt; &lt;p&gt;è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç» è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç»è¿™æ˜¯ä¸€æ®µæ–‡å­—ä»‹ç» &lt;/p&gt; &lt;/div&gt; &lt;/li&gt; &lt;/ul&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;ç‹¼æ€§æ³•åˆ™ï¼šè¦åŸ¹å…»å­¦ç”Ÿè¶…å¼ºçš„å­¦ä¹ èƒ½åŠ›ï¼Œä¸€å®šè¦åŸ¹å…»å­¦ç”Ÿå¯¹äºŽå®¢è§‚ä¸–ç•Œçš„å¥½å¥‡å¿ƒï¼Œç”¨å…´è¶£æ¥ä½œä¸ºä»–å­¦ä¹ çš„è€å¸ˆã€‚è¿™æ ·çš„å­¦ç”Ÿåœ¨æœªæ¥çš„äººç”Ÿé“è·¯ä¸Šï¼Œå°±èƒ½ä¸æ–­å¯¹å·¥ä½œæœ‰æ–°åˆ›å»ºå’Œæ–°çµæ„ŸTabé€‰é¡¹å¡ï¼šé¼ æ ‡ç§»åŠ¨åˆ°å“ªä¸ªé€‰é¡¹å¡å°±æ˜¾ç¤ºå“ªä¸ªé€‰é¡¹å¡å¯¹åº”çš„å›¾ç‰‡1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;37-Tabé€‰é¡¹å¡ä¸‹&lt;/title&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; .box &#123; width: 440px; height: 298px; border: 1px solid black; margin: 50px auto; &#125; .nav li &#123; list-style: none; width: 110px; height: 50px; background: orange; text-align: center; line-height: 50px; float: left; &#125; .nav .current &#123; background: #cccccc; &#125; .content li &#123; list-style: none; display: none; &#125; .content .show &#123; display: block; &#125; &lt;/style&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; // 1.ç›‘å¬é€‰é¡¹å¡çš„ç§»å…¥äº‹ä»¶ $('.nav li').mouseenter(function () &#123; // 1.1 $(this).addClass('current'); // 1.2è¿˜åŽŸå…¶ä»–å…„å¼Ÿé€‰é¡¹å¡çš„èƒŒæ™¯é¢œè‰² $(this).siblings().removeClass('current'); // 1.3èŽ·å–å½“å‰é€‰é¡¹å¡çš„ç´¢å¼• var index = $(this).index(); // 1,4æ ¹æ®ç´¢å¼•æ‰¾åˆ°å¯¹åº”çš„å›¾ç‰‡ var $li = $('.content li').eq(index); // 1.5éšè—éžå½“å‰ç´¢å¼•çš„å…¶ä»–å›¾ç‰‡ $li.siblings().removeClass('show'); // 1.6æ˜¾ç¤ºå½“å‰å¯¹åº”å›¾ç‰‡ $li.addClass('show'); &#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="box"&gt; &lt;ul class="nav"&gt; &lt;li class="current"&gt;HTML+CSS&lt;/li&gt; &lt;li&gt;jQuery&lt;/li&gt; &lt;li&gt;Cè¯­è¨€&lt;/li&gt; &lt;li&gt;Goè¯­è¨€&lt;/li&gt; &lt;/ul&gt; &lt;ul class="content"&gt; &lt;li class="show"&gt;&lt;img src="images/4-1.jpg" alt=""&gt;&lt;/li&gt; &lt;li&gt;&lt;img src="images/4-2.jpg" alt=""&gt;&lt;/li&gt; &lt;li&gt;&lt;img src="images/4-3.jpg" alt=""&gt;&lt;/li&gt; &lt;li&gt;&lt;img src="images/4-4.jpg" alt=""&gt;&lt;/li&gt; &lt;/ul&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;é¼ æ ‡ç§»å…¥åˆ°å“ªä¸ªåºå·å°±æ˜¾ç¤ºå“ªä¸ªåºå·å¯¹åº”å›¾ç‰‡123456789101112131415&lt;script type="text/javascript"&gt; $(function () &#123; // 1.ç›‘å¬ç´¢å¼•ç§»å…¥äº‹ä»¶ $(".index&gt;li").mouseenter(function () &#123; // 2.ç»™ç§»å…¥çš„ç´¢å¼•æ·»åŠ èƒŒæ™¯,å…¶å®ƒç´¢å¼•åˆ é™¤èƒŒæ™¯ $(this).addClass("cur").siblings().removeClass("cur"); // 3.æ‰¾åˆ°å½“å‰ç§»å…¥ç´¢å¼•çš„åºå· var $idx = $(this).index(); // 4.æ‰¾åˆ°åºå·å¯¹åº”çš„å›¾ç‰‡ var $li = $(".content&gt;li").eq($idx); // 5.æ˜¾ç¤ºå¯¹åº”å›¾ç‰‡,å¹¶ä¸”è®©å…¶å®ƒå›¾ç‰‡å°äº‹ $li.addClass("show").siblings().removeClass("show"); &#125;); &#125;);&lt;/script&gt;å…«ã€åŠ¨ç”»æ•ˆæžœ1.æ˜¾ç¤ºã€éšè—åŠ¨ç”»[show(s,[e],[fn]])æ˜¾ç¤ºåŠ¨ç”»å†…éƒ¨å®žçŽ°åŽŸç†æ ¹æ®å½“å‰æ“ä½œçš„å…ƒç´ æ˜¯å—çº§è¿˜æ˜¯è¡Œå†…å†³å®š, å—çº§å†…éƒ¨è°ƒç”¨display:block;,è¡Œå†…å†…éƒ¨è°ƒç”¨display:inline;[hide(s,[e],[fn]])éšè—åŠ¨ç”»toggle([spe],[eas],[fn])åˆ‡æ¢åŠ¨ç”»(æ˜¾ç¤ºå˜éšè—,éšè—å˜æ˜¾ç¤º)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; div &#123; width: 200px; height: 200px; background: red; display: none; &#125; &lt;/style&gt; &lt;title&gt;39-jQueryæ˜¾ç¤ºéšè—åŠ¨ç”»&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; $('button').eq(0).click(function () &#123; // $('div').css('display', 'block'); // åŠ¨ç”»æ•ˆæžœï¼Œå•ä½æ¯«ç§’ï¼Œå›žè°ƒå‡½æ•°:åŠ¨ç”»æ‰§è¡Œå®Œæ¯•ä¹‹åŽè°ƒç”¨ $('div').show(1000, function () &#123; alert('æ˜¾ç¤ºåŠ¨ç”»æ‰§è¡Œå®Œæ¯•'); &#125;); &#125;); $('button').eq(1).click(function () &#123; // $('div').css('display', 'none'); $('div').hide(1000, function () &#123; alert('éšè—åŠ¨ç”»æ‰§è¡Œå®Œæ¯•'); &#125;); &#125;); $('button').eq(2).click(function () &#123; $('div').toggle(1000, function () &#123; alert('åˆ‡æ¢åŠ¨ç”»æ‰§è¡Œå®Œæ¯•'); &#125;); &#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;button&gt;æ˜¾ç¤º&lt;/button&gt;&lt;button&gt;éšè—&lt;/button&gt;&lt;button&gt;åˆ‡æ¢&lt;/button&gt;&lt;div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;æ³¨æ„äº‹é¡¹:show(1000, function () {};) ç¬¬ä¸€ä¸ªå‚æ•°å•ä½æ˜¯æ¯«ç§’, 1000æ¯«ç§’ç­‰äºŽ1ç§’é»˜è®¤çš„åŠ¨ç”»æ—¶é•¿æ˜¯400æ¯«ç§’é™¤äº†æŒ‡å®šæ¯«ç§’ä»¥å¤–è¿˜å¯ä»¥æŒ‡å®šä¸‰ä¸ªé¢„è®¾å‚æ•° slowã€normalã€fastslowæœ¬è´¨æ˜¯600æ¯«ç§’normalæœ¬è´¨æ˜¯400æ¯«ç§’fastæœ¬è´¨æ˜¯200æ¯«ç§’å…¶å®ƒä¸¤ä¸ªæ–¹æ³•åŒç†å¯è¯å¯¹è”å¹¿å‘Šï¼šé¡µé¢æ»šåŠ¨æ˜¾ç¤º123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;40-å¯¹è”å¹¿å‘Š&lt;/title&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; .left &#123; float: left; position: fixed; left: 0; top: 200px; &#125; .right &#123; float: right; position: fixed; right: 0; top: 200px; &#125; img &#123; width: 200px; display: none; &#125; &lt;/style&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; // 1.ç›‘å¬ç½‘é¡µæ»šåŠ¨ $(window).scroll(function () &#123; // console.log("ç½‘é¡µæ»šåŠ¨äº†"); // console.log($("html,body").scrollTop()); // 1.1èŽ·å–ç½‘é¡µæ»šåŠ¨çš„åç§»ä½ var offset = $("html,body").scrollTop(); if (offset &gt; 500) &#123; // 1.3æ˜¾ç¤ºå¹¿å‘Š $('img').show(1000); &#125; else &#123; $('img').hide(1000); &#125; &#125;) &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;img src="images/5.jpg" alt="" class="left"&gt;&lt;img src="images/5.jpg" alt="" class="right"&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;....&lt;!-- è¿˜æœ‰å¾ˆå¤š`&lt;br/&gt;`ï¼Œç›®çš„æ˜¯é¡µé¢ä¸Šå‡ºçŽ°æ»šåŠ¨æ¡--&gt;&lt;/body&gt;&lt;/html&gt;2. å±•å¼€ã€æ”¶èµ·åŠ¨ç”»å‚æ•°ã€æ³¨æ„äº‹é¡¹å’Œæ˜¾ç¤ºéšè—åŠ¨ç”»ä¸€æ¨¡ä¸€æ ·, åªä¸è¿‡åŠ¨ç”»æ•ˆæžœä¸ä¸€æ ·è€Œå·²slideDown([s],[e],[fn])å±•å¼€åŠ¨ç”»[slideUp(s,[e],[fn]])æ”¶èµ·åŠ¨ç”»slideToggle([s],[e],[fn])åˆ‡æ¢åŠ¨ç”»(å±•å¼€å˜æ”¶èµ·,æ”¶èµ·å˜å±•å¼€)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;41-jQueryå±•å¼€å’Œæ”¶èµ·åŠ¨ç”»&lt;/title&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; div &#123; width: 100px; height: 300px; background: red; display: none; &#125; &lt;/style&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; $('button').eq(0).click(function () &#123; $('div').slideDown(1000, function () &#123; alert('å±•å¼€å®Œæ¯•') &#125;); &#125;); $('button').eq(1).click(function () &#123; $('div').slideUp(1000, function () &#123; alert('æ”¶èµ·å®Œæ¯•') &#125;); &#125;); $('button').eq(2).click(function () &#123; $('div').slideToggle(1000, function () &#123; alert('åˆ‡æ¢å®Œæ¯•') &#125;); &#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;button&gt;å±•å¼€&lt;/button&gt;&lt;button&gt;æ”¶èµ·&lt;/button&gt;&lt;button&gt;åˆ‡æ¢&lt;/button&gt;&lt;div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;ç»ƒä¹ ï¼šæŠ˜å èœå•123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; .nav &#123; list-style: none; width: 300px; margin: 100px auto; /*border: 1px solid #000000;*/ &#125; .nav &gt; li &#123; border: 1px solid #000000; line-height: 35px; border-bottom: none; text-indent: 2em; position: relative; &#125; /*æ³¨æ„ï¼šæ­¤å¤„ä¸€å®šè¦ä½¿ç”¨&gt;æ¥è¡¨ç¤ºç‰¹å®šçš„å­å…ƒç´ */ .nav &gt; li:last-child &#123; border-bottom: 1px solid #000000; border-bottom-right-radius: 10px; border-bottom-left-radius: 10px; &#125; /*æ³¨æ„ï¼šæ­¤å¤„ä¸€å®šè¦ä½¿ç”¨&gt;æ¥è¡¨ç¤ºç‰¹å®šçš„å­å…ƒç´ */ .nav &gt; li:first-child &#123; border-top-right-radius: 10px; border-top-left-radius: 10px; &#125; .nav &gt; li &gt; span &#123; /*æ­¤å¤„æ˜¯å‘å³ç®­å¤´çš„å›¾ç‰‡*/ background: url("images/arrow-right.jpg") no-repeat center center; display: inline-block; width: 32px; height: 32px; position: absolute; right: 10px; top: 3px; &#125; .sub &#123; display: none; &#125; .sub &gt; li &#123; list-style: none; background: mediumpurple; border-bottom: 1px solid white; &#125; .sub &gt; li:hover &#123; background: red; &#125; .nav &gt; .current &gt; span &#123; transform: rotate(90deg); &#125; &lt;/style&gt; &lt;title&gt;43-æŠ˜å èœå•ä¸‹&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; // 1.ç›‘å¬ä¸€çº§èœå•ç‚¹å‡»äº‹ä»¶ $(".nav&gt;li").click(function () &#123; // 1.1 æ‹¿åˆ°äºŒçº§èœå• var $sub = $(this).children('.sub'); // 1.2 è®©äºŒçº§èœå•å±•å¼€ $sub.slideDown(1000); // 1.3 æ‹¿åˆ°æ‰€æœ‰éžå½“å‰çš„äºŒçº§èœå• var otherSub = $(this).siblings().children('.sub'); // 1.4 è®©æ‰€æœ‰éžå½“å‰çš„äºŒçº§èœå•æ”¶èµ· otherSub.slideUp(1000); // 1.5 è®©è¢«ç‚¹å‡»çš„ä¸€çº§èœå•ç®­å¤´æœä¸‹ $(this).addClass('current'); // 1.6 è®©æ‰€æœ‰éžè¢«ç‚¹å‡»çš„ä¸€çº§èœå•ç®­å¤´è¿˜åŽŸ $(this).siblings().removeClass('current'); &#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;ul class="nav"&gt; &lt;li&gt;ä¸€çº§èœå•&lt;span&gt;&lt;/span&gt; &lt;ul class="sub"&gt; &lt;li&gt;äºŒçº§èœå•&lt;/li&gt; &lt;li&gt;äºŒçº§èœå•&lt;/li&gt; &lt;li&gt;äºŒçº§èœå•&lt;/li&gt; &lt;li&gt;äºŒçº§èœå•&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt;ä¸€çº§èœå•&lt;span&gt;&lt;/span&gt; &lt;ul class="sub"&gt; &lt;li&gt;äºŒçº§èœå•&lt;/li&gt; &lt;li&gt;äºŒçº§èœå•&lt;/li&gt; &lt;li&gt;äºŒçº§èœå•&lt;/li&gt; &lt;li&gt;äºŒçº§èœå•&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt;ä¸€çº§èœå•&lt;span&gt;&lt;/span&gt; &lt;ul class="sub"&gt; &lt;li&gt;äºŒçº§èœå•&lt;/li&gt; &lt;li&gt;äºŒçº§èœå•&lt;/li&gt; &lt;li&gt;äºŒçº§èœå•&lt;/li&gt; &lt;li&gt;äºŒçº§èœå•&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt;ä¸€çº§èœå•&lt;span&gt;&lt;/span&gt; &lt;ul class="sub"&gt; &lt;li&gt;äºŒçº§èœå•&lt;/li&gt; &lt;li&gt;äºŒçº§èœå•&lt;/li&gt; &lt;li&gt;äºŒçº§èœå•&lt;/li&gt; &lt;li&gt;äºŒçº§èœå•&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt;ä¸€çº§èœå•&lt;span&gt;&lt;/span&gt;&lt;/li&gt; &lt;li&gt;ä¸€çº§èœå•&lt;span&gt;&lt;/span&gt;&lt;/li&gt; &lt;li&gt;ä¸€çº§èœå•&lt;span&gt;&lt;/span&gt;&lt;/li&gt; &lt;li&gt;ä¸€çº§èœå•&lt;span&gt;&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/html&gt;ç»ƒä¹ ï¼šä¸‹æ‹‰èœå•12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;44-ä¸‹æ‹‰èœå•&lt;/title&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; .nav &#123; list-style: none; width: 300px; height: 50px; background: red; margin: 100px auto; &#125; .nav &gt; li &#123; width: 100px; height: 50px; line-height: 50px; text-align: center; float: left; &#125; .sub &#123; list-style: none; background: mediumaquamarine; display: none; &#125; &lt;/style&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; /* * åœ¨jQueryä¸­å¦‚æžœéœ€è¦æ‰§è¡ŒåŠ¨ç”»ï¼Œå»ºè®®åœ¨æ‰§è¡ŒåŠ¨ç”»ä¹‹å‰å…ˆè°ƒç”¨stopæ–¹æ³•ï¼Œç„¶åŽå†æ‰§è¡ŒåŠ¨ç”» * */ // 1.ç›‘å¬ä¸€çº§èœå•çš„ç§»å…¥äº‹ä»¶ $('.nav&gt;li').mouseenter(function () &#123; // 1.1 æ‹¿åˆ°äºŒçº§èœå• $sub = $(this).children('.sub'); // åœæ­¢å½“å‰æ­£åœ¨è¿è¡Œçš„åŠ¨ç”» $sub.stop(); // 1.2 å±•å¼€äºŒçº§èœå• $sub.slideDown(1000); &#125;); // 2.ç›‘å¬ä¸€çº§èœå•çš„ç§»é™¤äº‹ä»¶ $('.nav&gt;li').mouseleave(function () &#123; // 2.1 æ‹¿åˆ°äºŒçº§èœå• $sub = $(this).children('.sub'); // åœæ­¢å½“å‰æ­£åœ¨è¿è¡Œçš„åŠ¨ç”» $sub.stop(); // 2.2 å±•å¼€äºŒçº§èœå• $sub.slideUp(1000); &#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;ul class="nav"&gt; &lt;li&gt;ä¸€çº§èœå• &lt;ul class="sub"&gt; &lt;li&gt;äºŒçº§èœå•&lt;/li&gt; &lt;li&gt;äºŒçº§èœå•&lt;/li&gt; &lt;li&gt;äºŒçº§èœå•&lt;/li&gt; &lt;li&gt;äºŒçº§èœå•&lt;/li&gt; &lt;li&gt;äºŒçº§èœå•&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt;ä¸€çº§èœå•&lt;/li&gt; &lt;li&gt;ä¸€çº§èœå•&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/html&gt;3. æ·¡å…¥ã€æ·¡å‡ºåŠ¨ç”»å‚æ•°ã€æ³¨æ„äº‹é¡¹å’Œæ˜¾ç¤ºéšè—åŠ¨ç”»ä¸€æ¨¡ä¸€æ ·, åªä¸è¿‡åŠ¨ç”»æ•ˆæžœä¸ä¸€æ ·è€Œå·²fadeIn([s],[e],[fn])æ·¡å…¥åŠ¨ç”»fadeOut([s],[e],[fn])æ·¡å‡ºåŠ¨ç”»[fadeToggle(s,[e],[fn]])åˆ‡æ¢åŠ¨ç”»(æ˜¾ç¤ºå˜æ·¡å‡º,ä¸æ˜¾ç¤ºå˜æ·¡å…¥)[fadeTo([s],o,[e],[fn]])æ·¡å…¥åˆ°æŒ‡å®šé€æ˜Žåº¦åŠ¨ç”»å¯ä»¥é€šè¿‡ç¬¬äºŒä¸ªå‚æ•°,æ·¡å…¥åˆ°æŒ‡å®šçš„é€æ˜Žåº¦(å–å€¼èŒƒå›´0~1)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;45-jQueryæ·¡å…¥æ·¡å‡ºåŠ¨ç”»&lt;/title&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; div &#123; width: 100px; height: 100px; background: red; display: none; &#125; &lt;/style&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; $('button').eq(0).click(function () &#123; $('div').fadeIn(1000, function () &#123; alert('æ·¡å…¥å®Œæ¯•'); &#125;); &#125;); $('button').eq(1).click(function () &#123; $('div').fadeOut(1000, function () &#123; alert('æ·¡å‡ºå®Œæ¯•'); &#125;); &#125;); $('button').eq(2).click(function () &#123; $('div').fadeToggle(1000, function () &#123; alert('åˆ‡æ¢å®Œæ¯•'); &#125;); &#125;); $('button').eq(3).click(function () &#123; // ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæ·¡å…¥æ·¡å‡ºçš„ç¨‹åº¦,èŒƒå›´0~1 $('div').fadeTo(1000, 0.5, function () &#123; alert('åˆ‡æ¢å®Œæ¯•'); &#125;); &#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;button&gt;æ·¡å…¥&lt;/button&gt;&lt;button&gt;æ·¡å‡º&lt;/button&gt;&lt;button&gt;åˆ‡æ¢&lt;/button&gt;&lt;button&gt;æ·¡å…¥åˆ°&lt;/button&gt;&lt;div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;ç»ƒä¹ ï¼šå¼¹çª—å¹¿å‘Š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;46-å¼¹çª—å¹¿å‘Š&lt;/title&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; .ad &#123; position: fixed; right: 0; bottom: 0; display: none; &#125; .ad &gt; span &#123; display: inline-block; width: 30px; height: 30px; /*background: red;*/ position: absolute; top: 0; right: 0; &#125; &lt;/style&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; //1.ç›‘å¬spançš„ç›‘å¬äº‹ä»¶ $('span').click(function () &#123; $(".ad").remove(); &#125;); // 2.æ‰§è¡Œå¹¿å‘ŠåŠ¨ç”» // $('.ad').slideDown(1000,function () &#123; // $('.ad').fadeOut(1000,function () &#123; // $('.ad').fadeIn(1000); // &#125;); // &#125;); // é“¾å¼å†™æ³• $('.ad').stop().slideDown(1000).fadeOut(1000).fadeIn(1000); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="ad"&gt; &lt;img src="images/ad-pic.jpg" alt=""&gt; &lt;span&gt;&lt;/span&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;4. è‡ªå®šä¹‰åŠ¨ç”»æœ‰æ—¶å€™jQueryä¸­æä¾›çš„é›†ä¸­ç®€å•çš„å›ºå®šåŠ¨ç”»æ— æ³•æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚, æ‰€ä»¥jQueryè¿˜æä¾›äº†ä¸€ä¸ªè‡ªå®šä¹‰åŠ¨ç”»æ–¹æ³•æ¥æ»¡è¶³æˆ‘ä»¬å¤æ‚å¤šå˜çš„éœ€æ±‚animate(p,[s],[e],[fn])æ¯æ¬¡å¼€å§‹è¿åŠ¨éƒ½å¿…é¡»æ˜¯åˆå§‹ä½ç½®æˆ–è€…åˆå§‹çŠ¶æ€,å¦‚æžœæƒ³åœ¨ä¸Šä¸€æ¬¡ä½ç½®æˆ–è€…çŠ¶æ€ä¸‹å†æ¬¡è¿›è¡ŒåŠ¨ç”»å¯ä»¥ä½¿ç”¨ç´¯åŠ åŠ¨ç”»åŒæ—¶æ“ä½œå¤šä¸ªå±žæ€§,è‡ªå®šä¹‰åŠ¨ç”»ä¼šæ‰§è¡ŒåŒæ­¥åŠ¨ç”»,å¤šä¸ªè¢«æ“ä½œçš„å±žæ€§ä¸€èµ·æ‰§è¡ŒåŠ¨ç”»12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;47-jQueryè‡ªå®šä¹‰åŠ¨ç”»&lt;/title&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; div &#123; width: 100px; height: 100px; margin-top: 10px; background: red; &#125; .two &#123; background: blue; &#125; &lt;/style&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; $('button').eq(0).click(function () &#123; /* $('.one').animate(&#123; width: 500, &#125;, 1000, function () &#123; alert('è‡ªå®šä¹‰åŠ¨ç”»æ‰§è¡Œå®Œæ¯•'); &#125;); */ $('.one').animate(&#123; marginLeft: 500, &#125;, 5000, function () &#123; alert('è‡ªå®šä¹‰åŠ¨ç”»æ‰§è¡Œå®Œæ¯•'); &#125;); /* * ç¬¬ä¸€ä¸ªå‚æ•°ï¼šæŽ¥æ”¶ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥åœ¨å¯¹è±¡ä¸­ä¿®æ”¹å±žæ€§ * ç¬¬äºŒä¸ªå‚æ•°ï¼šæŒ‡å®šåŠ¨ç”»æ—¶é•¿ * ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šæŒ‡å®šåŠ¨ç”»èŠ‚å¥ï¼Œé»˜è®¤æ˜¯swing * ç¬¬å››ä¸ªå‚æ•°ï¼šæŒ‡å®šåŠ¨ç”»æ‰§è¡Œå®Œæ¯•ä¹‹åŽçš„å›žè°ƒå‡½æ•° * */ $('.two').animate(&#123; marginLeft: 500, &#125;, 5000, 'linear', function () &#123; alert('è‡ªå®šä¹‰åŠ¨ç”»æ‰§è¡Œå®Œæ¯•'); &#125;); &#125;); $('button').eq(1).click(function () &#123; $('.one').animate(&#123; // å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºåœ¨åŽŸæœ‰åŸºç¡€ä¸Šè¿›è¡Œç´¯åŠ  width: '+=100' &#125;, 1000, function () &#123; alert('è‡ªå®šä¹‰åŠ¨ç”»æ‰§è¡Œå®Œæ¯•'); &#125;); &#125;); $('button').eq(2).click(function () &#123; $('.one').animate(&#123; // å­—ç¬¦ä¸²ï¼Œhideï¼šéšè—ï¼Œtoggleï¼šåˆ‡æ¢ width: 'toggle' &#125;, 1000, function () &#123; alert('è‡ªå®šä¹‰åŠ¨ç”»æ‰§è¡Œå®Œæ¯•'); &#125;); &#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;button&gt;æ“ä½œå±žæ€§&lt;/button&gt;&lt;button&gt;ç´¯åŠ å±žæ€§&lt;/button&gt;&lt;button&gt;å…³é”®å­—&lt;/button&gt;&lt;div class="one"&gt;&lt;/div&gt;&lt;div class="two"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;ç»ƒä¹ ï¼šå›¾æ ‡ç‰¹æ•ˆ12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;49-å›¾æ ‡ç‰¹æ•ˆ&lt;/title&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; ul &#123; list-style: none; width: 400px; height: 250px; border: 1px solid #000000; margin: 100px auto; &#125; ul &gt; li &#123; width: 100px; height: 50px; margin-top: 50px; text-align: center; float: left; overflow: hidden; &#125; ul &gt; li &gt; span &#123; display: inline-block; width: 24px; height: 24px; background: url("images/1.jpg") no-repeat 0 0; position: relative; &#125; &lt;/style&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; // 1.éåŽ†æ‰€æœ‰çš„li $('li').each(function (index, value) &#123; // 1.1ç”Ÿæˆæ–°çš„å›¾ç‰‡ä½ç½® var $url = 'background: url("images/1.jpg") no-repeat 0' + (index * -24) + 'px'; // 1.2è®¾ç½®æ–°çš„å›¾ç‰‡ä½ç½® $(this).children('span').css("background", $url); &#125;); // 2.ç›‘å¬liç§»å…¥äº‹ä»¶ $('li').mouseenter(function () &#123; // 2.1å°†å›¾ç‰‡å¾€ä¸Šç§»åŠ¨ $(this).children('span').animate(&#123; top: -50 &#125;, 1000, function () &#123; // 2.2å°†å›¾ç‰‡å¾€ä¸‹ç§»åŠ¨ $(this).css('top', '50px'); // 2.3å°†å›¾ç‰‡å¤ä½ $(this).animate(&#123; top: 0 &#125;, 1000); &#125;) &#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;ul&gt; &lt;li&gt;&lt;span&gt;&lt;/span&gt; &lt;p&gt;ç™¾åº¦&lt;/p&gt;&lt;/li&gt; &lt;li&gt;&lt;span&gt;&lt;/span&gt; &lt;p&gt;ç™¾åº¦&lt;/p&gt;&lt;/li&gt; &lt;li&gt;&lt;span&gt;&lt;/span&gt; &lt;p&gt;ç™¾åº¦&lt;/p&gt;&lt;/li&gt; &lt;li&gt;&lt;span&gt;&lt;/span&gt; &lt;p&gt;ç™¾åº¦&lt;/p&gt;&lt;/li&gt; &lt;li&gt;&lt;span&gt;&lt;/span&gt; &lt;p&gt;ç™¾åº¦&lt;/p&gt;&lt;/li&gt; &lt;li&gt;&lt;span&gt;&lt;/span&gt; &lt;p&gt;ç™¾åº¦&lt;/p&gt;&lt;/li&gt; &lt;li&gt;&lt;span&gt;&lt;/span&gt; &lt;p&gt;ç™¾åº¦&lt;/p&gt;&lt;/li&gt; &lt;li&gt;&lt;span&gt;&lt;/span&gt; &lt;p&gt;ç™¾åº¦&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/html&gt;5. åŠ¨ç”»é˜Ÿåˆ—å¤šä¸ªåŠ¨ç”»æ–¹æ³•é“¾å¼ç¼–ç¨‹,ä¼šç­‰åˆ°å‰é¢çš„åŠ¨ç”»æ‰§è¡Œå®Œæ¯•å†ä¾æ¬¡æ‰§è¡ŒåŽç»­åŠ¨ç”»1234567$(&quot;div&quot;).slideDown(1000).slideUp(1000).show(1000);$(&quot;.one&quot;).slideDown(1000,function () &#123; $(&quot;.one&quot;).slideUp(1000, function () &#123; $(&quot;.one&quot;).show(1000); &#125;);&#125;);ä½†æ˜¯å¦‚æžœåŽé¢ç´§è·Ÿä¸€ä¸ªéžåŠ¨ç”»æ–¹æ³•åˆ™ä¼šè¢«ç«‹å³æ‰§è¡Œ12// ç«‹åˆ»å˜ä¸ºé»„è‰²,ç„¶åŽå†æ‰§è¡ŒåŠ¨ç”»$(&quot;.one&quot;).slideDown(1000).slideUp(1000).show(1000).css(&quot;background&quot;, &quot;yellow&quot;);å¦‚æžœæƒ³é¢œè‰²å†åŠ¨ç”»æ‰§è¡Œå®Œæ¯•ä¹‹åŽè®¾ç½®, 1.ä½¿ç”¨å›žè°ƒ 2.ä½¿ç”¨åŠ¨ç”»é˜Ÿåˆ—1234567891011$(&quot;.one&quot;).slideDown(1000,function () &#123; $(&quot;.one&quot;).slideUp(1000, function () &#123; $(&quot;.one&quot;).show(1000, function () &#123; $(&quot;.one&quot;).css(&quot;background&quot;, &quot;yellow&quot;) &#125;); &#125;);&#125;);$(&quot;.one&quot;).slideDown(1000).slideUp(1000).show(1000).queue(function () &#123; $(&quot;.one&quot;).css(&quot;background&quot;, &quot;yellow&quot;)&#125;);æ³¨æ„ç‚¹:åŠ¨ç”»é˜Ÿåˆ—æ–¹æ³•queue()åŽé¢ä¸èƒ½ç»§ç»­ç›´æŽ¥æ·»åŠ queue()å¦‚æžœæƒ³ç»§ç»­æ·»åŠ å¿…é¡»åœ¨ä¸Šä¸€ä¸ªqueue()æ–¹æ³•ä¸­next()æ–¹æ³•123456$(&quot;.one&quot;).slideDown(1000).slideUp(1000).show(1000).queue(function (next) &#123; $(&quot;.one&quot;).css(&quot;background&quot;, &quot;yellow&quot;); next(); // å…³é”®ç‚¹&#125;).queue(function () &#123; $(&quot;.one&quot;).css(&quot;width&quot;, &quot;500px&quot;)&#125;);6. åŠ¨ç”»ç›¸å…³æ–¹æ³•delay(d,[q])è®¾ç½®åŠ¨ç”»å»¶è¿Ÿæ—¶é•¿stop([c],[j])åœæ­¢æŒ‡å®šå…ƒç´ ä¸Šæ­£åœ¨æ‰§è¡Œçš„åŠ¨ç”»123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; .one &#123; width: 100px; height: 100px; background: red; &#125; .two &#123; width: 500px; height: 10px; background: blue; &#125; &lt;/style&gt; &lt;title&gt;48-jQueryçš„stopå’Œdelayæ–¹æ³•&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; $('button').eq(0).click(function () &#123; // åœ¨jQueryçš„&#123;&#125;ä¸­å¯ä»¥åŒæ—¶ä¿®æ”¹å¤šä¸ªå±žæ€§ï¼Œä¸­é—´ç”¨é€—å·éš”å¼€ï¼Œå¤šä¸ªå±žæ€§çš„åŠ¨ç”»ä¼šåŒæ—¶æ‰§è¡Œ /* $('.one').animate(&#123; width: 500, height: 500 &#125;, 1000); */ // åˆ†å¼€å†™å¯ä»¥åˆ†åˆ«æ‰§è¡Œ /* $('.one').animate(&#123; width: 500 &#125;, 1000); $('.one').animate(&#123; height: 500 &#125;, 1000); */ // ä½¿ç”¨é“¾å¼å†™æ³• // delayæ–¹æ³•çš„ä½œç”¨å°±æ˜¯ç”¨äºŽé«˜é€Ÿç³»ç»Ÿå»¶è¿Ÿæ—¶é•¿ $('.one').animate(&#123; width: 500 &#125;, 1000).delay(2000).animate(&#123; height: 500 &#125;, 1000).animate(&#123;width: 100&#125;, 1000).animate(&#123;height: 100&#125;, 1000); &#125;); $('button').eq(1).click(function () &#123; // ç«‹å³åœæ­¢å½“å‰åŠ¨ç”»ï¼Œç»§ç»­æ‰§è¡ŒåŽç»­åŠ¨ç”» // $('div').stop(); // $('div').stop(false); // $('div').stop(false,false); // ç«‹å³åœæ­¢å½“å‰åŠ¨ç”»å’ŒåŽç»­æ‰€æœ‰åŠ¨ç”» // $('div').stop(true); // $('div').stop(true,false); // ç«‹å³å®Œæˆå½“å‰çš„ï¼Œç»§ç»­æ‰§è¡ŒåŽç»­åŠ¨ç”» // $('div').stop(false,true); // ç«‹å³å®Œæˆå½“å‰çš„ï¼Œå¹¶ä¸”åœæ­¢åŽç»­æ‰€æœ‰çš„ $('div').stop(true, true); &#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;button&gt;å¼€å§‹åŠ¨ç”»&lt;/button&gt;&lt;button&gt;åœæ­¢åŠ¨ç”»&lt;/button&gt;&lt;div class="one"&gt;&lt;/div&gt;&lt;div class="two"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;ç»ƒä¹ ï¼šæ— é™å¾ªçŽ¯æ»šåŠ¨1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;51-æ— é™å¾ªçŽ¯æ»šåŠ¨ä¸‹&lt;/title&gt; &lt;style type="text/css"&gt; * &#123; margin: 0; padding: 0; &#125; div &#123; width: 600px; height: 161px; border: 1px solid #000000; margin: 100px auto; overflow: hidden; &#125; ul &#123; list-style: none; width: 1800px; height: 161px; background: black; &#125; ul &gt; li &#123; float: left; &#125; &lt;/style&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; // 0.å®šä¹‰å˜é‡ä¿å­˜åç§»ä½ var offset = 0; // 1.è®©å›¾ç‰‡æ»šåŠ¨èµ·æ¥ var timer; function autoPlay() &#123; timer = setInterval(function () &#123; offset += -10; if (offset &lt;= -1200) &#123; offset = 0; &#125; $('ul').css('marginLeft', offset) &#125;, 50); &#125; autoPlay(); // 2.ç›‘å¬liçš„ç§»å…¥å’Œç§»å‡ºäº‹ä»¶ $('li').hover(function () &#123; // åœæ­¢æ»šåŠ¨ clearInterval(timer); // ç»™éžå½“å‰é€‰ä¸­çš„æ·»åŠ è’™ç‰ˆ $(this).siblings().fadeTo(100, 0.5); // åŽ»é™¤å½“å‰é€‰ä¸­è’™ç‰ˆ $(this).fadeTo(100, 1) &#125;, function () &#123; // ç»§ç»­æ»šåŠ¨ autoPlay(); // åŽ»é™¤æ‰€æœ‰è’™ç‰ˆ $('li').fadeTo(100, 1); &#125;) &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div&gt; &lt;ul&gt; &lt;li&gt;&lt;img src="images/a.jpg" alt=""&gt;&lt;/li&gt; &lt;li&gt;&lt;img src="images/b.jpg" alt=""&gt;&lt;/li&gt; &lt;li&gt;&lt;img src="images/c.jpg" alt=""&gt;&lt;/li&gt; &lt;li&gt;&lt;img src="images/d.jpg" alt=""&gt;&lt;/li&gt; &lt;li&gt;&lt;img src="images/a.jpg" alt=""&gt;&lt;/li&gt; &lt;li&gt;&lt;img src="images/b.jpg" alt=""&gt;&lt;/li&gt; &lt;/ul&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;ä¹ã€æ–‡æ¡£å¤„ç†1. æ·»åŠ èŠ‚ç‚¹å†…éƒ¨æ’å…¥append(content|fn)appendTo(content)å°†å…ƒç´ æ·»åŠ åˆ°æŒ‡å®šå…ƒç´ å†…éƒ¨çš„æœ€åŽprepend(content|fn)prependTo(content)å°†å…ƒç´ æ·»åŠ åˆ°æŒ‡å®šå…ƒç´ å†…éƒ¨çš„æœ€å‰é¢å¤–éƒ¨æ’å…¥after(content|fn)insertAfter(content)å°†å…ƒç´ æ·»åŠ åˆ°æŒ‡å®šå…ƒç´ å¤–éƒ¨çš„åŽé¢before(content|fn)insertBefore(content)å°†å…ƒç´ æ·»åŠ åˆ°æŒ‡å®šå…ƒç´ å¤–éƒ¨çš„å‰é¢1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;52-jQueryæ·»åŠ èŠ‚ç‚¹ç›¸å…³æ–¹æ³•&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; /* å†…éƒ¨æ’å…¥ append(content|fn) ï¼šä¼šå°†å…ƒç´ æ·»åŠ åˆ°æŒ‡å®šå…ƒç´ å†…éƒ¨çš„æœ€åŽ appendTo(content) ï¼šä¼šå°†å…ƒç´ æ·»åŠ åˆ°æŒ‡å®šå…ƒç´ å†…éƒ¨çš„æœ€åŽ prepend(content|fn)ï¼šä¼šå°†å…ƒç´ æ·»åŠ åˆ°æŒ‡å®šå…ƒç´ å†…éƒ¨çš„æœ€å‰é¢ prependTo(content) ï¼šä¼šå°†å…ƒç´ æ·»åŠ åˆ°æŒ‡å®šå…ƒç´ å†…éƒ¨çš„æœ€å‰é¢ å¤–éƒ¨æ’å…¥ after(content|fn) ï¼šä¼šå°†å…ƒç´ æ·»åŠ åˆ°æŒ‡å®šå…ƒç´ å¤–éƒ¨çš„åŽé¢ before(content|fn) ï¼šä¼šå°†å…ƒç´ æ·»åŠ åˆ°æŒ‡å®šå…ƒç´ å¤–éƒ¨çš„å‰é¢ insertAfter(content) ï¼šä¼šå°†å…ƒç´ æ·»åŠ åˆ°æŒ‡å®šå…ƒç´ å¤–éƒ¨çš„åŽé¢ insertBefore(content) ï¼šä¼šå°†å…ƒç´ æ·»åŠ åˆ°æŒ‡å®šå…ƒç´ å¤–éƒ¨çš„å‰é¢ * * */ $('button').click(function () &#123; // 1.åˆ›å»ºä¸€ä¸ªèŠ‚ç‚¹ var $li = $('&lt;li&gt;æ–°å¢žçš„li&lt;/li&gt;'); // 2.æ·»åŠ èŠ‚ç‚¹ // $('ul').append($li); // $('ul').prepend($li); // æ³¨æ„ç‚¹ï¼šä½œç”¨ä¸€æ ·ä½†æ˜¯å†™æ³•ä¸ä¸€æ · // $li.appendTo('ul'); // $li.prependTo('ul'); // $('ul').after($li); // $('ul').before($li); // $li.insertAfter('ul'); $li.insertBefore('ul'); &#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;button&gt;æ·»åŠ èŠ‚ç‚¹&lt;/button&gt;&lt;ul&gt; &lt;li&gt;æˆ‘æ˜¯ç¬¬1ä¸ªli&lt;/li&gt; &lt;li&gt;æˆ‘æ˜¯ç¬¬2ä¸ªli&lt;/li&gt; &lt;li&gt;æˆ‘æ˜¯ç¬¬3ä¸ªli&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/html&gt;2. åˆ é™¤èŠ‚ç‚¹empty()åˆ é™¤æŒ‡å®šå…ƒç´ çš„å†…å®¹å’Œå­å…ƒç´ , æŒ‡å®šå…ƒç´ è‡ªèº«ä¸ä¼šè¢«åˆ é™¤remove([expr])åˆ é™¤æŒ‡å®šå…ƒç´ detach([expr])removeå’ŒdetachåŒºåˆ«removeåˆ é™¤å…ƒç´ åŽ,å…ƒç´ ä¸Šçš„äº‹ä»¶ä¼šè¢«ç§»å‡ºdetachåˆ é™¤å…ƒç´ åŽ,å…ƒç´ ä¸Šçš„äº‹ä»¶ä¼šè¢«ä¿ç•™12345678910111213141516171819202122232425262728293031323334353637&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;53-jQueryåˆ é™¤èŠ‚ç‚¹ç›¸å…³æ–¹æ³•&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; /* åˆ é™¤ remove([expr]) : åˆ é™¤æŒ‡å®šå…ƒç´  empty() : åˆ é™¤æŒ‡å®šå…ƒç´ çš„å†…å®¹å’Œå­å…ƒç´ ï¼ŒæŒ‡å®šå…ƒç´ è‡ªèº«ä¸ä¼šè¢«åˆ é™¤ detach([expr]) ï¼šç­‰ç”¨äºŽremove([expr]) * */ $('button').click(function () &#123; // $('div').remove(); $('div').empty(); &#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;button&gt;åˆ é™¤èŠ‚ç‚¹&lt;/button&gt;&lt;ul&gt; &lt;li class="item"&gt;æˆ‘æ˜¯ç¬¬1ä¸ªli&lt;/li&gt; &lt;li&gt;æˆ‘æ˜¯ç¬¬2ä¸ªli&lt;/li&gt; &lt;li class="item"&gt;æˆ‘æ˜¯ç¬¬3ä¸ªli&lt;/li&gt; &lt;li&gt;æˆ‘æ˜¯ç¬¬4ä¸ªli&lt;/li&gt; &lt;li class="item"&gt;æˆ‘æ˜¯ç¬¬5ä¸ªli&lt;/li&gt;&lt;/ul&gt;&lt;div&gt;æˆ‘æ˜¯div &lt;p&gt;æˆ‘æ˜¯ä¸€ä¸ªæ®µè½&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;3. æ›¿æ¢èŠ‚ç‚¹replaceWith(content|fn)å°†æ‰€æœ‰åŒ¹é…çš„å…ƒç´ æ›¿æ¢æˆæŒ‡å®šçš„HTMLæˆ–DOMå…ƒç´ replaceWithå‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªDOMå…ƒç´ replaceWithå‚æ•°ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªä»£ç ç‰‡æ®µreplaceAll(selector)ç”¨åŒ¹é…çš„å…ƒç´ æ›¿æ¢æŽ‰æ‰€æœ‰ selectoråŒ¹é…åˆ°çš„å…ƒç´ 12345678910111213141516171819202122232425262728293031323334&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;54-jQueryæ›¿æ¢èŠ‚ç‚¹ç›¸å…³æ–¹æ³•&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; /* æ›¿æ¢ replaceWith(content|fn) replaceAll(selector) ä½œç”¨:æ›¿æ¢æ‰€æœ‰åŒ¹é…çš„å…ƒç´ ä¸ºæŒ‡å®šçš„å…ƒç´  */ $('button').click(function () &#123; // 1.æ–°å»ºä¸€ä¸ªå…ƒç´  var $h6 = $('&lt;h6&gt;æˆ‘æ˜¯æ ‡é¢˜6&lt;/h6&gt;'); // 2.æ›¿æ¢å…ƒç´  // $('h1').replaceWith($h6); $h6.replaceAll('h1'); &#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;button&gt;æ›¿æ¢èŠ‚ç‚¹&lt;/button&gt;&lt;h1&gt;æˆ‘æ˜¯æ ‡é¢˜1&lt;/h1&gt;&lt;h1&gt;æˆ‘æ˜¯æ ‡é¢˜1&lt;/h1&gt;&lt;p&gt;æˆ‘æ˜¯æ®µè½&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;4. å¤åˆ¶èŠ‚ç‚¹[clone(Even[,deepEven]])å¤åˆ¶ä¸€ä¸ªèŠ‚ç‚¹æµ…å¤åˆ¶ä¸ä¼šå¤åˆ¶èŠ‚ç‚¹çš„äº‹ä»¶æ·±å¤åˆ¶ä¼šå¤åˆ¶èŠ‚ç‚¹çš„äº‹ä»¶12345678910111213141516171819202122232425262728293031323334353637383940414243444546&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;55-jQueryå¤åˆ¶èŠ‚ç‚¹ç›¸å…³æ–¹æ³•&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; // å¤åˆ¶ // clone([Even[,deepEven]]) // å¦‚æžœä¼ å…¥falseå°±æ˜¯æµ…å¤åˆ¶ï¼Œå¦‚æžœä¼ å…¥trueå°±æ˜¯æ·±å¤åˆ¶ // æµ…å¤åˆ¶åªä¼šå¤åˆ¶å…ƒç´ ï¼Œä¸ä¼šå¤åˆ¶å…ƒç´ çš„äº‹ä»¶ // æ·±å¤åˆ¶ä¼šå¤åˆ¶å…ƒç´ ï¼Œè€Œä¸”è¿˜ä¼šå¤åˆ¶å…ƒç´ çš„äº‹ä»¶ $('button').eq(0).click(function () &#123; // 1.æµ…å¤åˆ¶ä¸€ä¸ªå…ƒç´  var $li = $('li:first').clone(false); // 2.å°†å¤åˆ¶çš„å…ƒç´ æ·»åŠ åˆ°ulä¸­ $('ul').append($li); &#125;); $('button').eq(1).click(function () &#123; // 1.æ·±å¤åˆ¶ä¸€ä¸ªå…ƒç´  var $li = $('li:first').clone(true); // 2.å°†å¤åˆ¶çš„å…ƒç´ æ·»åŠ åˆ°ulä¸­ $('ul').append($li); &#125;); $('li').click(function () &#123; alert('li'); &#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;button&gt;æµ…å¤åˆ¶èŠ‚ç‚¹&lt;/button&gt;&lt;button&gt;æ·±å¤åˆ¶èŠ‚ç‚¹&lt;/button&gt;&lt;ul&gt; &lt;li&gt;æˆ‘æ˜¯ç¬¬1ä¸ªli&lt;/li&gt; &lt;li&gt;æˆ‘æ˜¯ç¬¬2ä¸ªli&lt;/li&gt; &lt;li&gt;æˆ‘æ˜¯ç¬¬3ä¸ªli&lt;/li&gt; &lt;li&gt;æˆ‘æ˜¯ç¬¬4ä¸ªli&lt;/li&gt; &lt;li&gt;æˆ‘æ˜¯ç¬¬5ä¸ªli&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/html&gt;5. åŒ…è£¹èŠ‚ç‚¹éƒ½è®²äº†è¿™ä¹ˆå¤šäº†, éªšå¹´åŠ¨åŠ¨æ‰‹, æŸ¥é˜…ä¸‹æ–‡æ¡£, å°è¯•ä¸‹è‡ªå­¦è¿™å‡ ä¸ªæ–¹æ³•ç¼–ç¨‹ä¸æ˜¯æ­»è®°ç¡¬èƒŒ, æ˜¯å­¦ä¼šæ‰¾åˆ°è§£å†³é—®é¢˜çš„æ€è·¯å’Œè‡ªå­¦æ–°çŸ¥è¯†çš„æ–¹æ³•6. èŠ‚ç‚¹æ“ä½œç»ƒä¹ ]]></content>
      <categories>
        <category>jQuery</category>
      </categories>
      <tags>
        <tag>jQuery</tag>
        <tag>HTML</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸ºç½‘ç«™æ·»åŠ HTTPSæ”¯æŒ]]></title>
    <url>%2F2019%2F07%2F03%2F%E4%B8%BA%E7%BD%91%E7%AB%99%E6%B7%BB%E5%8A%A0HTTPS%E6%94%AF%E6%8C%81%2F</url>
    <content type="text"><![CDATA[æ³¨ï¼šæ­¤ç‰‡å¸–å­å‚è€ƒå¦‚ä¸‹å…¶ä»–å¸–å­ï¼Œç»“åˆè‡ªèº«å®žé™…æ•´ç†è€Œæˆã€‚å‚è€ƒå¸–å­åœ°å€ï¼šï¼ˆ1ï¼‰ä¸ºç½‘ç«™æ·»åŠ httpsæ”¯æŒ https://fanzheng.org/archives/21ï¼ˆ2ï¼‰Letâ€™s Encryptï¼Œå…è´¹å¥½ç”¨çš„ HTTPS è¯ä¹¦ https://imququ.com/post/letsencrypt-certificate.htmlï¼ˆ3ï¼‰æœ¬åšå®¢ Nginx é…ç½®ä¹‹å®Œæ•´ç¯‡ https://imququ.com/post/my-nginx-conf.htmlåˆ›å»ºå¸å·é¦–å…ˆåˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œä¾‹å¦‚ï¼š/home/microblog/ssl/ï¼Œç”¨æ¥å­˜æ”¾å„ç§ä¸´æ—¶æ–‡ä»¶å’Œæœ€åŽçš„è¯ä¹¦æ–‡ä»¶ã€‚è¿›å…¥è¿™ä¸ªç›®å½•ï¼Œåˆ›å»ºä¸€ä¸ª RSA ç§é’¥ç”¨äºŽ Letâ€™s Encrypt è¯†åˆ«ä½ çš„èº«ä»½ï¼š1openssl genrsa 4096 &gt; account.keyåˆ›å»º CSR æ–‡ä»¶æŽ¥ç€å°±å¯ä»¥ç”Ÿæˆ CSRï¼ˆCertificate Signing Requestï¼Œè¯ä¹¦ç­¾åè¯·æ±‚ï¼‰æ–‡ä»¶äº†ã€‚åœ¨è¿™ä¹‹å‰ï¼Œè¿˜éœ€è¦åˆ›å»ºåŸŸåç§é’¥ï¼ˆä¸€å®šä¸è¦ä½¿ç”¨ä¸Šé¢çš„è´¦æˆ·ç§é’¥ï¼‰ï¼Œæ ¹æ®è¯ä¹¦ä¸åŒç±»åž‹ï¼ŒåŸŸåç§é’¥ä¹Ÿå¯ä»¥é€‰æ‹© RSA å’Œ ECC ä¸¤ç§ä¸åŒç±»åž‹ã€‚æˆ‘è¿™é‡‡ç”¨çš„æ˜¯RSAç±»åž‹åˆ›å»º RSA ç§é’¥ï¼ˆå…¼å®¹æ€§å¥½ï¼‰ï¼š1openssl genrsa 4096 &gt; domain.keyæœ‰äº†ç§é’¥æ–‡ä»¶ï¼Œå°±å¯ä»¥ç”Ÿæˆ CSR æ–‡ä»¶äº†ã€‚åœ¨ CSR ä¸­æŽ¨èè‡³å°‘æŠŠåŸŸåå¸¦ www å’Œä¸å¸¦ www çš„ä¸¤ç§æƒ…å†µéƒ½åŠ è¿›åŽ»ï¼Œå…¶å®ƒå­åŸŸå¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ ï¼ˆç›®å‰ä¸€å¼ è¯ä¹¦æœ€å¤šå¯ä»¥åŒ…å« 100 ä¸ªåŸŸåï¼‰ï¼šç¤ºä¾‹ï¼šopenssl req -new -sha256 -key domain.key -subj â€œ/â€œ -reqexts SAN -config &lt;(cat /etc/ssl/openssl.cnf &lt;(printf â€œ[SAN]\nsubjectAltName=DNS:yoursite.com,DNS:www.yoursite.com&quot;)) &gt; domain.csræ‰§è¡Œè¿™ä¸€æ­¥æ—¶ï¼Œå¦‚æžœæç¤ºæ‰¾ä¸åˆ° /etc/ssl/openssl.cnf æ–‡ä»¶ï¼Œè¯·çœ‹çœ‹ /usr/local/openssl/ssl/openssl.cnf æ˜¯å¦å­˜åœ¨ã€‚å¦‚æžœè¿˜æ˜¯ä¸è¡Œï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨äº¤äº’æ–¹å¼åˆ›å»º CSRï¼ˆéœ€è¦æ³¨æ„ Common Name å¿…é¡»ä¸ºä½ çš„åŸŸåï¼‰ï¼š1openssl req -new -sha256 -key domain.key -out domain.csrå®žé™…æ“ä½œï¼šopenssl req -new -sha256 -key domain.key -subj â€œ/â€œ -reqexts SAN -config &lt;(cat /usr/local/ssl/openssl.cnf &lt;(printf â€œ[SAN]\nsubjectAltName=DNS:blog.lehuoha.comâ€)) &gt; domain.csræ³¨æ„æˆ‘çš„openssl.cnfè·¯å¾„ä¸ºï¼š/usr/local/ssl/openssl.cnfï¼ŒåŸŸåæ˜¯ï¼šblog.lehuoha.comé…ç½®éªŒè¯æœåŠ¡æˆ‘ä»¬çŸ¥é“ï¼ŒCA åœ¨ç­¾å‘ DVï¼ˆDomain Validationï¼‰è¯ä¹¦æ—¶ï¼Œéœ€è¦éªŒè¯åŸŸåæ‰€æœ‰æƒã€‚ä¼ ç»Ÿ CA çš„éªŒè¯æ–¹å¼ä¸€èˆ¬æ˜¯å¾€ `admin@yoursite.comå‘éªŒè¯é‚®ä»¶ï¼Œè€Œ Let&#39;s Encrypt æ˜¯åœ¨ä½ çš„æœåŠ¡å™¨ä¸Šç”Ÿæˆä¸€ä¸ªéšæœºéªŒè¯æ–‡ä»¶ï¼Œå†é€šè¿‡åˆ›å»º CSR æ—¶æŒ‡å®šçš„åŸŸåè®¿é—®ï¼Œå¦‚æžœå¯ä»¥è®¿é—®åˆ™è¡¨æ˜Žä½ å¯¹è¿™ä¸ªåŸŸåæœ‰æŽ§åˆ¶æƒã€‚å…·ä½“æ¥è¯´ï¼Œä»–ä¼šè®¿é—®ç½‘ç«™çš„/.well-known/acme-challenge/`ç›®å½•æ¥æŸ¥çœ‹æœ‰æ²¡æœ‰ä»–è¦æ±‚çš„æ–‡ä»¶ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åªéœ€åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹åˆ›å»ºè¯¥æ–‡ä»¶å¤¹å³å¯ã€‚é¦–å…ˆåˆ›å»ºç”¨äºŽå­˜æ”¾éªŒè¯æ–‡ä»¶çš„ç›®å½•ï¼Œä¾‹å¦‚ï¼š1mkdir -p /home/microblog/.well-known/acme-challengeç„¶åŽé…ç½®ä¸€ä¸ª HTTP æœåŠ¡ï¼Œä»¥ Nginx ä¸ºä¾‹ï¼š(ç¤ºä¾‹)ï¼šå®žé™…æƒ…å†µéœ€è¦ä¿®æ”¹åŸŸåï¼Œaliasåˆ«åè·¯å¾„ï¼Œä»¥åŠlocation /{ } ä¿¡æ¯ç­‰ï¼Œè‹¥æœ‰location /{ }çš„é…ç½®å‚æ•°çš„è¯åˆ™åªéœ€è¦æ·»åŠ  rewrite ^/(.*)$ https://yoursite.com/$1 permanent;å³å¯123456789101112 server &#123; server_name www.yoursite.com yoursite.com; location ^~ /.well-known/acme-challenge/ &#123; alias /home/xxx/www/challenges/; try_files $uri =404; &#125; location / &#123; rewrite ^/(.*)$ https://yoursite.com/$1 permanent; &#125;&#125;ä»¥ä¸Šé…ç½®ä¼˜å…ˆæŸ¥æ‰¾ ~/www/challenges/ ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œå¦‚æžœæ‰¾ä¸åˆ°å°±é‡å®šå‘åˆ° HTTPS åœ°å€ã€‚è¿™ä¸ªéªŒè¯æœåŠ¡ä»¥åŽæ›´æ–°è¯ä¹¦è¿˜è¦ç”¨åˆ°ï¼Œå»ºè®®ä¸€ç›´ä¿ç•™ã€‚å®žé™…é…ç½®ï¼š12345678910111213141516171819server &#123; listen 80; server_name blog.lehuoha.com; location ^~ /.well-known/acme-challenge/ &#123; alias /home/microblog/challenges/; try_files $uri =404; &#125; location / &#123; proxy_pass http://127.0.0.1:4010; proxy_redirect off; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; rewrite ^/(.*)$ https://blog.lehuoha.com/$1 permanent; &#125;&#125;èŽ·å–ç½‘ç«™è¯ä¹¦å…ˆæŠŠ acme-tiny è„šæœ¬ä¿å­˜åˆ°ä¹‹å‰çš„ ssl ç›®å½•ï¼š1wget https://raw.githubusercontent.com/diafygi/acme-tiny/master/acme_tiny.pyæŒ‡å®šè´¦æˆ·ç§é’¥ã€CSR ä»¥åŠéªŒè¯ç›®å½•ï¼Œæ‰§è¡Œè„šæœ¬ï¼š1python acme_tiny.py --account-key ./account.key --csr ./domain.csr --acme-dir /home/microblog/challenges &gt; ./signed.crtå¦‚æžœä¸€åˆ‡æ­£å¸¸ï¼Œå½“å‰ç›®å½•ä¸‹å°±ä¼šç”Ÿæˆä¸€ä¸ª signed.crtï¼Œè¿™å°±æ˜¯ç”³è¯·å¥½çš„è¯ä¹¦æ–‡ä»¶ã€‚æžå®šç½‘ç«™è¯ä¹¦åŽï¼Œè¿˜è¦ä¸‹è½½ Letâ€™s Encrypt çš„ä¸­é—´è¯ä¹¦ã€‚æˆ‘åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­è®²è¿‡ï¼Œé…ç½® HTTPS è¯ä¹¦æ—¶æ—¢ä¸è¦æ¼æŽ‰ä¸­é—´è¯ä¹¦ï¼Œä¹Ÿä¸è¦åŒ…å«æ ¹è¯ä¹¦ã€‚åœ¨ Nginx é…ç½®ä¸­ï¼Œéœ€è¦æŠŠä¸­é—´è¯ä¹¦å’Œç½‘ç«™è¯ä¹¦åˆåœ¨ä¸€èµ·ï¼š12wget -O - https://letsencrypt.org/certs/lets-encrypt-x3-cross-signed.pem &gt; intermediate.pemcat signed.crt intermediate.pem &gt; chained.pemä¸ºäº†åŽç»­èƒ½é¡ºåˆ©å¯ç”¨ OCSP Staplingï¼Œæˆ‘ä»¬å†æŠŠæ ¹è¯ä¹¦å’Œä¸­é—´è¯ä¹¦åˆåœ¨ä¸€èµ·ï¼š12wget -O - https://letsencrypt.org/certs/isrgrootx1.pem &gt; root.pemcat intermediate.pem root.pem &gt; full_chained.pemæœ€ç»ˆï¼Œä¿®æ”¹ Nginx ä¸­æœ‰å…³è¯ä¹¦çš„é…ç½®å¹¶ reload æœåŠ¡å³å¯ï¼š(ç¤ºä¾‹)ï¼šè‹¥ä¹‹å‰é…ç½®è¿‡sslåˆ™åªéœ€è¦æ›´æ”¹è¯ä¹¦å°±è¡Œï¼Œè‹¥æœªé…ç½®è¿‡ï¼Œåˆ™éœ€è¦æ·»åŠ ç›¸å…³é…ç½®å‚æ•°12ssl_certificate ~/www/ssl/chained.pem;ssl_certificate_key ~/www/ssl/domain.key;å®žé™…æ“ä½œåŽçš„é…ç½®ä¿¡æ¯ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950server &#123; listen 443 ssl ; server_name blog.lehuoha.com; server_tokens off; ssl on; ssl_certificate /home/microblog/ssl/chained.pem; ssl_certificate_key /home/microblog/ssl/domain.key; ssl_session_timeout 1d; ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_ciphers EECDH+CHACHA20:EECDH+CHACHA20-draft:EECDH+AES128:RSA+AES128:EECDH+AES256:RSA+AES256:EECDH+3DES:RSA+3DES:!MD5; ssl_prefer_server_ciphers on; ssl_session_cache shared:SSL:50m; ssl_trusted_certificate /home/microblog/ssl/full_chained.pem; resolver 114.114.114.114 valid=300s; resolver_timeout 10s; if ($request_method !~ ^(GET|HEAD|POST|OPTIONS)$ ) &#123; return 444; &#125; location / &#123; proxy_pass http://127.0.0.1:4010; proxy_redirect off; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; &#125;&#125;server &#123; server_name blog.lehuoha.com; server_tokens off; access_log /dev/null; location ^~ /.well-known/acme-challenge/ &#123; alias /home/microblog/challenges/; try_files $uri =404; &#125; location / &#123; rewrite ^/(.*)$ https://blog.lehuoha.com/$1 permanent; &#125; &#125;é‡å¯nginxæœåŠ¡å³å¯ã€‚ç„¶åŽè®¿é—®ç½‘ç«™è¿›è¡Œæµ‹è¯•.é…ç½®è‡ªåŠ¨æ›´æ–°Letâ€™s Encrypt ç­¾å‘çš„è¯ä¹¦åªæœ‰ 90 å¤©æœ‰æ•ˆæœŸï¼ŒæŽ¨èä½¿ç”¨è„šæœ¬å®šæœŸæ›´æ–°ã€‚ä¾‹å¦‚æˆ‘å°±åˆ›å»ºäº†ä¸€ä¸ª renew_cert.sh å¹¶é€šè¿‡ chmod a+x renew_cert.sh èµ‹äºˆæ‰§è¡Œæƒé™ã€‚æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š1234567#!/bin/bashcd /home/microblog/ssl/python acme_tiny.py --account-key ./account.key --csr ./domain.csr --acme-dir /home/microblog/challenges &gt; ./signed.crt || exitwget -O - https://letsencrypt.org/certs/lets-encrypt-x3-cross-signed.pem &gt; intermediate.pemcat signed.crt intermediate.pem &gt; chained.pemservice nginx reloadcrontab ä¸­ä½¿ç”¨ç»å¯¹è·¯å¾„æ¯”è¾ƒä¿é™©ï¼Œcrontab -e åŠ å…¥ä»¥ä¸‹å†…å®¹ï¼š10 0 1 * * /home/microblog/ssl/renew_cert.sh &gt;/dev/null 2&gt;&amp;1è¿™æ ·ä»¥åŽè¯ä¹¦æ¯ä¸ªæœˆéƒ½ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œä¸€åŠ³æ°¸é€¸ã€‚å®žé™…ä¸Šï¼ŒLetâ€™s Encrypt å®˜æ–¹å°†è¯ä¹¦æœ‰æ•ˆæœŸå®šä¸º 90 å¤©ä¸€æ–¹é¢æ˜¯ä¸ºäº†æ›´å®‰å…¨ï¼Œæ›´é‡è¦çš„æ˜¯é¼“åŠ±ç”¨æˆ·é‡‡ç”¨è‡ªåŠ¨åŒ–éƒ¨ç½²æ–¹æ¡ˆã€‚]]></content>
      <categories>
        <category>python</category>
        <category>flask</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>flask</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Node.jså…¥é—¨]]></title>
    <url>%2F2019%2F07%2F03%2FNode-js%E5%85%A5%E9%97%A8%2F</url>
    <content type="text"><![CDATA[ä»€ä¹ˆæ˜¯Node.jsï¼Ÿæ¦‚è¦Node.jsæ˜¯ä¸€ä¸ªJavascriptè¿è¡ŒçŽ¯å¢ƒ(runtime)ï¼Œå‘å¸ƒäºŽ2009å¹´5æœˆï¼Œç”±Ryan Dahlå¼€å‘ï¼Œå®žè´¨æ˜¯å¯¹Chrome V8å¼•æ“Žè¿›è¡Œäº†å°è£…ã€‚Node.js çš„åŒ…ç®¡ç†å™¨ npmï¼Œæ˜¯å…¨çƒæœ€å¤§çš„å¼€æºåº“ç”Ÿæ€ç³»ç»Ÿã€‚å®˜æ–¹ç½‘ç«™https://nodejs.org/ä½¿ç”¨ç‰ˆæœ¬10.16.0 LTSåŸºç¡€çŸ¥è¯†Javascript/ES2015(ES6)Unix/Linux(Ubuntu)å¼€å‘å·¥å…·è®°äº‹æœ¬ç­‰æ–‡æœ¬ç¼–è¾‘å™¨Visual Studio Code(æŽ¨è)BracketsATOMæµè§ˆå™¨Google Chrome(æŽ¨è)FireFoxIE/edgeçº¿ç¨‹æ¨¡åž‹å’Œäº‹ä»¶å¾ªçŽ¯çŸ¥è¯†ç‚¹çº¿ç¨‹æ¨¡åž‹äº‹ä»¶å¾ªçŽ¯çº¿ç¨‹æ¨¡åž‹Apache+Tomcat(6,7,8,9)è¿è¡Œreqæ¥è¢­threadåº”å¯¹reqå¤„ç†å®ŒåŽï¼Œthreadé‡Šæ”¾çº¿ç¨‹å¤„ç†æ¨¡å¼å°±æ˜¯é‡å¤ä»¥ä¸Šä¸‰ä¸ªæ­¥éª¤ï¼Œæ¥å¤„ç†æ¥è‡ªå®¢æˆ·ç«¯çš„å„ç§è¯·æ±‚ï¼Œå½“æœ‰å¤§é‡å®¢æˆ·ç«¯çš„è¯·æ±‚æ¥è¢­æ—¶ï¼ŒæœåŠ¡å™¨æ¶ˆè€—çš„èµ„æºä¹Ÿä¼šéšä¹‹å¢žåŠ ã€‚äº‹ä»¶å¾ªçŽ¯Node.jsæœåŠ¡è¿è¡Œå¼€ä¸€ä¸ªäº‹ä»¶ç­‰å¾…å¾ªçŽ¯ï¼ˆevent-loopï¼‰reqæ¥è¢­æ”¾å…¥äº‹ä»¶å¤„ç†é˜Ÿåˆ—ä¸­ï¼Œç„¶åŽç»§ç»­ç­‰å¾…æ–°çš„reqè¯·æ±‚reqå¤„ç†å®ŒæˆåŽï¼Œè°ƒç”¨I/Oï¼Œç»“æŸreq(éžé˜»å¡žè°ƒç”¨)äº‹ä»¶å¾ªçŽ¯å¤„ç†æ¨¡å¼ä¸­ï¼Œçº¿ç¨‹ä¸ç”¨ç­‰å¾…reqå¤„ç†å®ŒåŽåœ¨è¿›è¡Œä¸‹ä¸ªreqçš„å¤„ç†ï¼Œè€Œæ˜¯å°†æ‰€æœ‰çš„reqè¯·æ±‚æ”¾å…¥åˆ°é˜Ÿåˆ—ä¹‹ä¸­ï¼Œç„¶åŽé‡‡ç”¨éžåŒæ­¥çš„æ–¹å¼ï¼Œç­‰å¾…reqå¤„ç†å®ŒåŽå†è°ƒç”¨I/Oèµ„æºï¼Œç„¶åŽç»“æŸreqã€‚ä»ŽHelloWorldå¼€å§‹çŸ¥è¯†ç‚¹Node.jsæŽ§åˆ¶å°javascriptæ–‡ä»¶å®žæˆ˜æ¼”ä¹ Node.jsæŽ§åˆ¶å°12345678910111213141516171819202122232425C:\Users\sanduÎ» npm --version # æŸ¥çœ‹npmç‰ˆæœ¬6.9.0C:\Users\sanduÎ» node --version # æŸ¥çœ‹node.jsç‰ˆæœ¬v10.16.0C:\Users\sandu Î» node # Node.jsæŽ§åˆ¶å°å…¥å£&gt; console.log('hello world!'); # è¾“å‡ºloghello world!undefined&gt; .help # æŸ¥çœ‹å‘½ä»¤å¸®åŠ©.break Sometimes you get stuck, this gets you out.clear Alias for .break.editor Enter editor mode.exit Exit the repl.help Print this help message.load Load JS from a file into the REPL session.save Save all evaluated commands in this REPL session to a file&gt; .exit # é€€å‡ºå‘½ä»¤æŽ§åˆ¶å°javascriptæ–‡ä»¶åˆ›å»ºä¸€ä¸ªheloworld.jsæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š1234console.log(&apos;hello world!&apos;);var str = &apos;hello&apos;;console.log(str);ä½¿ç”¨node.jsæ‰§è¡Œè¯¥jsæ–‡ä»¶ï¼š1234D:\node_testÎ» node helloworld.jshello world!helloéžé˜»å¡žå¤„ç†çŸ¥è¯†ç‚¹é˜»å¡žå¤„ç†(Java,Ruby,PHP,Asp.Net)éžé˜»å¡žå¤„ç†(Node.js)å®žæˆ˜æ¼”ä¹ 12345678910111213141516171819202122232425////////////////////// é˜»å¡žå¤„ç†////////////////////function updb1() &#123; var start = new Date().getTime(); while (new Date().getTime() &lt; start + 3000);&#125;updb1();//æ•°æ®åº“æ›´æ–°å®Œæ¯•åŽæ‰ä¼šæ‰§è¡Œä¸‹é¢è¿™ä¿©console.log("updb1 success.");console.log("I like javascript.");////////////////////// éžé˜»å¡žå¤„ç†////////////////////function updb2(done) &#123; setTimeout(() =&gt; &#123; done(); &#125;, 3000);&#125;updb2(function () &#123; //æ•°æ®åº“æ›´æ–°å®Œæ¯•åŽå†æ‰§è¡Œè¿™ä¸ªå›žè°ƒå‡½æ•° console.log("updb2 success.");&#125;);console.log("I like Nodejs."); // å…ˆæ‰§è¡Œè¿™ä¸ªç®€å•çš„WebæœåŠ¡å™¨çŸ¥è¯†ç‚¹httpå†…ç½®æ¨¡å—å‚ç…§æ–‡æ¡£ï¼šhttps://nodejs.org/en/about/å®žæˆ˜æ¼”ä¹ 123456789101112131415const http = require('http');const hostname = '127.0.0.1';const port = 3000;const server = http.createServer((req,res) =&gt; &#123; res.statusCode = 200; res.setHeader('Content-Type', 'text/plain'); res.end('Hello world\n');&#125;);server.listen(port,hostname,() =&gt; &#123; console.log(`Server running at http://$&#123;hostname&#125;:$&#123;port&#125;/`); &#125;);// ä½¿ç”¨æµè§ˆå™¨è®¿é—®http://127.0.0.1:3000,é¡µé¢ä¸Šå°±ä¼šå‡ºçŽ°Hello worldå¼•ç”¨å¤–éƒ¨jsæ–‡ä»¶çŸ¥è¯†ç‚¹requireï¼šå¼•ç”¨å¤–éƒ¨jsæ–‡ä»¶å®žæˆ˜æ¼”ä¹ config.js12345const config = &#123; hostname:'127.0.0.1', port:3000,&#125;;exports.config = config;myserver.js123456789101112const http = require('http');const config = require('./config.js').config;const server = http.createServer((req,res) =&gt; &#123; res.statusCode = 200; res.setHeader('Content-Type', 'text/plain'); res.end('Hello world\n');&#125;);server.listen(config.port,config.hostname,() =&gt; &#123; console.log(`Server running at http://$&#123;config.hostname&#125;:$&#123;config.port&#125;/`); &#125;);URLä¸ºæˆ‘æŒ‡å¼•æ–¹å‘çŸ¥è¯†ç‚¹req.urlï¼šè¿”å›žå®¢æˆ·ç«¯è¯·æ±‚çš„urlåœ°å€å®žæˆ˜æ¼”ä¹ 123456789101112131415161718192021222324252627const http = require('http');const hostname = '127.0.0.1';const port = 3000;const server = http.createServer((req, res) =&gt; &#123; res.statusCode = 200; res.setHeader('Content-Type', 'text/plain'); switch (req.url) &#123; case '/': res.end('helo world.'); break; case '/about': res.end('This is about page.'); break; case '/home': res.end('Welcome to my homepage!'); break; default: res.end('NotFound!'); &#125;&#125;);server.listen(port, hostname, () =&gt; &#123; console.log(`Server running at http://$&#123;hostname&#125;:$&#123;port&#125;/`);&#125;);ä½ å†™æˆ‘è¯»HTMLçŸ¥è¯†ç‚¹fsæ–‡ä»¶è¯»å†™æ¨¡å—çš„å¼•ç”¨å®žæˆ˜æ¼”ä¹ index.html12345&lt;html&gt; &lt;body&gt; &lt;h1&gt;Helo index.html!&lt;/h1&gt; &lt;/body&gt;&lt;/html&gt;myserver.js12345678910111213141516171819202122232425const http = require('http');const hostname = '127.0.0.1';const port = 3000;const fs = require('fs');const server = http.createServer((req,res) =&gt; &#123; fs.readFile(__dirname + '/index.html','utf-8',function(err,data) &#123; if (err) &#123; res.setHeader('Content-Type', 'text/plain'); res.statusCode = 400; res.end('Not Found!\n'); &#125; else &#123; res.setHeader('Content-Type', 'text/html'); res.statusCode = 200; res.end(data); // æµè§ˆå™¨ç•Œé¢ä¼šå‡ºçŽ°index.htmlæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯Hello world! &#125; &#125;);&#125;);server.listen(port,hostname,() =&gt; &#123; console.log(`Server running at http://$&#123;hostname&#125;:$&#123;port&#125;/`); &#125;);// ä¿®æ”¹index.htmlæ–‡ä»¶ä¸­çš„å†…å®¹åŽï¼Œåˆ·æ–°æµè§ˆå™¨ä¼šè‡ªåŠ¨æ›´æ–°æ˜¾ç¤ºå‡ºæ¥npmåŒ…ç®¡ç†å™¨çŸ¥è¯†ç‚¹npmçš„ä½¿ç”¨æ–¹æ³•ejsçš„å®‰è£…npmæ˜¯Node.jsé™„å¸¦çš„ç¬¬ä¸‰æ–¹è½¯ä»¶åŒ…ç®¡ç†å™¨ï¼Œå¯ä»¥ä¸ºNode.jsæä¾›æ›´å¤šçš„åŠŸèƒ½æ”¯æŒã€‚npmå®˜ç½‘https://npmjs.org/ejs(Effective JavaScript templating)http://ejs.co/å®žæˆ˜æ¼”ä¹ 123456D:\node_test// éœ€è¦package.jsonæ‰èƒ½npm installã€‚// å¯ä»¥npm initåˆå§‹åŒ–ç”Ÿæˆä¸€ä¸ªpackage.jsonã€‚// ç„¶åŽå°±å¯ä»¥æ„‰å¿«åœ°npm installäº†ã€‚Î» npm initÎ» npm install ejshello.ejs123456&lt;html&gt; &lt;title&gt;&lt;%= title %&gt;&lt;/title&gt; &lt;body&gt; &lt;%- content %&gt; &lt;/body&gt;&lt;/html&gt;ejsèƒ½å†™ç½‘é¡µï¼ŸçŸ¥è¯†ç‚¹ejsçš„ä½¿ç”¨å®žæˆ˜æ¼”ä¹ hello.ejs123456789&lt;html&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;&lt;%= title %&gt;&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;%= content %&gt;&lt;/body&gt;&lt;/html&gt;myserver.js1234567891011121314151617181920const http = require('http');const fs = require('fs');const ejs = require('ejs');var template = fs.readFileSync(__dirname + '\\hello.ejs','utf-8'); //æ³¨æ„å¼•ç”¨çš„è·¯å¾„const server = http.createServer((req, res) =&gt; &#123; var data = ejs.render(template, &#123; title: 'helo ejs', content: '&lt;strong&gt;big helo ejs.&lt;/strong&gt;' &#125;); res.setHeader('Content-Type', 'text/html'); res.statusCode = 200; res.end(data);&#125;);const hostname = '127.0.0.1';const port = 3000;server.listen(port, hostname, () =&gt; &#123; console.log(`Server running at http://$&#123;hostname&#125;:$&#123;port&#125;/`);&#125;);// ä¸çŸ¥å› ä¸ºå•¥åŽŸå› ï¼Œ&lt;strong&gt;&lt;/strong&gt;æ ‡ç­¾æ²¡ç”Ÿæ•ˆï¼Œè€Œæ˜¯åœ¨é¡µé¢ä¸Šç›´æŽ¥æ˜¾ç¤ºå‡ºæ¥äº†åšä¸ªå°è®ºå›çŸ¥è¯†ç‚¹åšä¸€ä¸ªå«æœ‰è¡¨å•çš„è®ºå›ç½‘é¡µå®žæˆ˜æ¼”ä¹ forum.ejs1234567891011121314151617181920&lt;!DOCTYPE html&gt;&lt;html lang="zh-cmn-Hans"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt; &lt;meta http-equiv="X-UA-Compatible" content="ie=edge"&gt; &lt;title&gt;å°è®ºå›&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;form action="" method="post"&gt; &lt;input type="text" name="content" id="content"&gt; &lt;input type="submit" value="æäº¤"&gt; &lt;ul&gt; &lt;% for(var i = 0; i &lt; posts.length; i++) &#123; %&gt; &lt;li&gt;&lt;%= posts[i] %&gt;&lt;/li&gt; &lt;% &#125; %&gt; &lt;/ul&gt; &lt;/form&gt;&lt;/body&gt;&lt;/html&gt;è¡¨å•çš„å¤„ç†çŸ¥è¯†ç‚¹æœåŠ¡å™¨è¡¨å•çš„å¤„ç†å®žæˆ˜æ¼”ä¹ myserver.js123456789101112131415161718192021222324252627282930313233343536373839404142434445const http = require('http');const fs = require('fs');const ejs = require('ejs');const qs = require('querystring'); //+var template = fs.readFileSync(__dirname + '/forum.ejs', 'utf-8');var posts = []; //+const server = http.createServer((req, res) =&gt; &#123; if (req.method === 'POST') &#123; //è¡¨å•æäº¤ req.data = ""; req.on("readable", function () &#123; //è¡¨å•æ•°æ®æ”¶é›† var chr = req.read(); if (chr) req.data += chr; &#125;); req.on("end", function () &#123; //è¡¨å•å¤„ç† var query = qs.parse(req.data); posts.push(query.content); showForm(posts, res); &#125;); &#125; else &#123; //è¡¨å•æ˜¾ç¤º showForm(posts, res); &#125;&#125;);const hostname = '127.0.0.1';const port = 3000;server.listen(port, hostname, () =&gt; &#123; console.log(`Server running at http://$&#123;hostname&#125;:$&#123;port&#125;/`);&#125;);function showForm(p_posts, res) &#123; var data = ejs.render(template, &#123; title: 'helo ejs', posts: p_posts &#125;); res.setHeader('Content-Type', 'text/html'); res.statusCode = 200; res.end(data);&#125;è¿žæŽ¥MongoDBçŸ¥è¯†ç‚¹mongodbé©±åŠ¨å®‰è£…node.jsè¿žæŽ¥MongoDBå®žæˆ˜æ¼”ä¹ mongodbé©±åŠ¨å®‰è£…å®˜æ–¹ç½‘ç«™ï¼šhttp://mongodb.github.io/node-mongodb-native/1$ npm install mongodb --savePSï¼šMongooseä¹Ÿæ˜¯ä¸€ä¸ªéžå¸¸ä¸é”™çš„MongoDBå­˜å–APIï¼Œä¹ŸæŽ¨èç»™æ‚¨ã€‚node.jsæ“ä½œMongoDBmongofunc.js12345678910111213141516const MongoClient = require('mongodb').MongoClient;const assert = require('assert');// Connection URLconst url = 'mongodb://127.0.0.1:27017'; // æœ¬æœºéœ€è¦äº‹å…ˆå®‰è£…å¹¶å¯åŠ¨MongoDB// Database Nameconst dbName = 'blog';// Use connect method to connect to the serverMongoClient.connect(url, &#123; useNewUrlParser: true &#125;, function (err, client) &#123; assert.equal(null, err); console.log("Connected successfully to server"); const db = client.db(dbName); client.close();&#125;);æ’å…¥MongoDBæ–‡æ¡£çŸ¥è¯†ç‚¹node.jsæ“ä½œMongoDBå®žæˆ˜æ¼”ä¹ mongofunc.js12345678910111213141516171819202122232425262728const MongoClient = require('mongodb').MongoClient;const assert = require('assert');// Connection URLconst url = 'mongodb://127.0.0.1:27017';// Database Nameconst dbName = 'blog';// Use connect method to connect to the serverMongoClient.connect(url, &#123; useNewUrlParser: true &#125;, function (err, client) &#123; assert.equal(null, err); console.log("Connected successfully to server"); const db = client.db(dbName); db.collection("posts", function (err, collection) &#123; var list = [ &#123;title:"æˆ‘çˆ±çŽ©é©¬é‡Œå¥¥", tag:"game"&#125;, &#123;title:"æˆ‘å–œæ¬¢Nodejsç¼–ç¨‹", tag:"it"&#125;, &#123;title:"æˆ‘ä¼šç”¨MongoDB", tag:"it"&#125; ]; collection.insert(list, function (err, result) &#123; assert.equal(null, err); client.close(); &#125;); &#125;);&#125;);è¯»å‡ºMongoDBæ–‡æ¡£çŸ¥è¯†ç‚¹node.jsè¯»å–MongoDBå®žæˆ˜æ¼”ä¹ mongofunc.js123456789101112131415161718192021222324const MongoClient = require('mongodb').MongoClient;const assert = require('assert');// Connection URLconst url = 'mongodb://127.0.0.1:27017';// Database Nameconst dbName = 'blog';// Use connect method to connect to the serverMongoClient.connect(url, &#123; useNewUrlParser: true &#125;, function (err, client) &#123; assert.equal(null, err); console.log("Connected successfully to server"); const db = client.db(dbName); db.collection("posts", function (err, collection) &#123; collection.find(&#123;tag:"game"&#125;).toArray(function (err, docs) &#123; assert.equal(null, err); console.log(docs); client.close(); &#125;); &#125;);&#125;);Node.jså›žè°ƒåœ°ç‹±çŸ¥è¯†ç‚¹Node.jså›žè°ƒåœ°ç‹±Promiseæ‰¿è¯ºè§£å†³å›žè°ƒåœ°ç‹±Node.jsæ˜¯éžé˜»å¡žç¼–ç¨‹ï¼Œé‚£ä¹ˆåœ¨ç¼–ç è¿‡ç¨‹ä¸­ä¼šé‡åˆ°å¾ˆå¤šçš„å›žè°ƒå‡½æ•°ï¼ˆCallbackï¼‰ï¼Œå¦‚æžœå¤šä¸ªå¤„ç†çš„å›žè°ƒå‡½æ•°åµŒå¥—åœ¨ä¸€èµ·çš„è¯ï¼Œå°±ä¼šå½¢æˆå›žè°ƒåœ°ç‹±ï¼Œè™½ç„¶å¯¹äºŽç¨‹åºçš„ç»“æžœæ²¡æœ‰ä»»ä½•å½±å“ï¼Œä½†å¯¹äºŽç¨‹åºä»£ç çš„å¯è¯»æ€§æ¥è¯´å°±æ˜¯ä¸ªåœ°ç‹±ã€‚12345678910111213//å›žè°ƒåœ°ç‹±function dbupd(sql, done) &#123; setTimeout(() =&gt; done(sql + " upd ok."), 800);&#125;dbupd("1.sql1", result =&gt; &#123; console.log(result); dbupd("2.sql2", result =&gt; &#123; console.log(result); dbupd("3.sql3", result =&gt; &#123; console.log(result); &#125;); &#125;);&#125;);Promiseè§£å†³12345678910111213141516171819202122// Promiseå‡½æ•°åµŒå¥—è§£å†³æ–¹æ³•function dbupAsync(sql) &#123; const p = new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; console.log(sql + " upd ok."); resolve(sql + ".ok"); &#125;, 800) &#125;); return p;&#125;dbupAsync("2.sql1") .then(() =&gt; dbupAsync("2.sql2")) .then(() =&gt; dbupAsync("3.sql3"));// ä»£ç æ›´åŠ ç®€æ´çš„async/awaitasync function upAllDB() &#123; const result1 = await dbupAsync("3.sql1"); const result2 = await dbupAsync("3.sql2"); const result3 = await dbupAsync("3.sql3"); console.log(result1, result2, result3);&#125;upAllDB();Promiseè§£å†³å›žæŽ‰åœ°ç‹±çŸ¥è¯†ç‚¹Promiseæ‰¿è¯ºè§£å†³å®žé™…æ¼”ç¤ºä¸€ä¸‹å›žæŽ‰åœ°ç‹±ï¼Œä»¥åŠå¦‚ä½•è§£å†³å›žæŽ‰åœ°ç‹±12345678910111213// updb1.jsæ¼”ç¤ºä¸€ä¸‹å›žæŽ‰åœ°ç‹±function dbupd(sql, done) &#123; setTimeout(() =&gt; done(sql + " upd ok."), 800);&#125;dbupd("1.sql1", result =&gt; &#123; console.log(result); dbupd("2.sql2", result =&gt; &#123; console.log(result); dbupd("3.sql3", result =&gt; &#123; console.log(result); &#125;); &#125;);&#125;);1234567891011121314151617181920212223// updb2.jsè§£å†³å›žæŽ‰åœ°ç‹±// Promiseå‡½æ•°åµŒå¥—è§£å†³æ–¹æ³•function dbupAsync(sql) &#123; const p = new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; console.log(sql + " upd ok."); resolve(sql + ".ok"); &#125;, 800) &#125;); return p;&#125;// dbupAsync("2.sql1")// .then(() =&gt; dbupAsync("2.sql2"))// .then(() =&gt; dbupAsync("3.sql3"));// ä»£ç æ›´åŠ ç®€æ´çš„async/awaitasync function upAllDB() &#123; const result1 = await dbupAsync("3.sql1"); const result2 = await dbupAsync("3.sql2"); const result3 = await dbupAsync("3.sql3"); console.log(result1, result2, result3);&#125;upAllDB();]]></content>
      <categories>
        <category>Node.js</category>
      </categories>
      <tags>
        <tag>Node.js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨Pythonçš„flaskæ¡†æž¶å¯¹æŽ¥å¾®ä¿¡å…¬ä¼—å·å¼€å‘]]></title>
    <url>%2F2019%2F06%2F26%2F%E4%BD%BF%E7%94%A8Python%E7%9A%84flask%E6%A1%86%E6%9E%B6%E5%AF%B9%E6%8E%A5%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E5%BC%80%E5%8F%91%2F</url>
    <content type="text"><![CDATA[ä½¿ç”¨è¯´æ˜Žæ‰¾ä¸€å°å…·æœ‰å…¬ç½‘IPçš„æœåŠ¡å™¨å®‰è£…python3ï¼Œæ­å»ºnginx+uwsgi+flaskçŽ¯å¢ƒpycharmä¸Šé…ç½®Deploymentï¼Œæœ¬åœ°ä»£ç ç›´æŽ¥ä¸Šä¼ åˆ°æœåŠ¡å™¨nginxé…ç½®æ–‡ä»¶ä¸­è®¾ç½®åŸŸåï¼Œé…ç½®å¥½åŸŸåè§£æžæˆ‘è¿™è¾¹çš„å®žé™…é…ç½®ï¼šåŸŸåï¼šwechat_pro.lehuoha.comè·¯å¾„ï¼š/home/wechat_pro/app.pyapp.pyæ–‡ä»¶ä»£ç (æ³¨æ„æ–‡ä»¶æƒé™)ï¼š12345678910111213#!/usr/bin/env python# -*- coding: utf-8 -*-from flask import Flaskapp = Flask(__name__)@app.route('/')def index(): return 'hello worldï¼'if __name__ == '__main__': app.run(host='0.0.0.0', port=80, debug=True)æœ€ç»ˆæ•ˆæžœæ˜¯è®¿é—®http://wechat_pro.lehuoha.comè¿™ä¸ªåŸŸåï¼Œèƒ½å¤Ÿå‡ºçŽ°app.pyæ–‡ä»¶ä¸­çš„â€œhello worldï¼â€ç¬¬ä¸‰æ­¥æ“ä½œæ­¥éª¤ï¼šåœ¨pycharmä¸­æ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œæ¯”å¦‚é¡¹ç›®åæ˜¯ï¼šwechat_proã€‚æœ¬åœ°ä¹Ÿæ­å»ºå¥½çŽ¯å¢ƒï¼Œå®‰è£…å¥½ä¾èµ–ï¼Œæ–¹ä¾¿ä½¿ç”¨frpcåœ¨æœ¬åœ°è°ƒè¯•ä½¿ç”¨åœ¨wechat_proç›®å½•ä¸‹æ–°å»ºapp.pyæ–‡ä»¶å’Œuwsgiæ–‡ä»¶å¤¹ï¼Œuwsgiæ–‡ä»¶å¤¹å­˜æ”¾ç›¸å…³çš„uwsgiæ–‡ä»¶ï¼Œå…·ä½“å‚è€ƒ&lt;&lt;nginx+uwsgi+flaskçŽ¯å¢ƒ&gt;&gt;åœ¨pycharmä¸­ï¼ŒTools-&gt;Deployment-&gt;Configurationï¼Œæ ¹æ®è¿œç¨‹é“¾æŽ¥æœåŠ¡å™¨çš„æ–¹å¼ä¸åŒï¼Œé€‰æ‹©ç›¸åº”çš„é“¾æŽ¥æ–¹å¼ï¼Œæ¯”å¦‚FTPï¼ŒSftpç­‰ï¼Œæˆ‘è¿™è¾¹é‡‡ç”¨Sftpï¼Œè¾“å…¥è¿žæŽ¥åï¼Œæ¯”å¦‚ï¼šå¼€å‘æµ‹è¯•æœåŠ¡å™¨ï¼Œåœ¨å³ä¾§è¾“å…¥å…¬ç½‘IPæœåŠ¡å™¨çš„ipåœ°å€ï¼Œè´¦å·ï¼ŒéªŒè¯æ–¹å¼é€‰æ‹©å¯†ç ï¼Œç‚¹å‡»â€œæµ‹è¯•é“¾æŽ¥â€ã€‚ç„¶åŽè®¾ç½®æœ¬åœ°ç›®å½•è·ŸæœåŠ¡å™¨ç›®å½•è·¯å¾„çš„æ˜ å°„ï¼Œç¡®ä¿æœ¬åœ°ä»£ç ä¸Šä¼ åˆ°æœåŠ¡å™¨é‡Œçš„æŒ‡å®šç›®å½•ã€‚å¾®ä¿¡å…¬ä¼—å·å¼€å‘å¯¹æŽ¥ç™»å½•å¾®ä¿¡å…¬ä¼—å¹³å°å®˜ç½‘åŽï¼Œåœ¨å…¬ä¼—å¹³å°åŽå°ç®¡ç†é¡µé¢ - å¼€å‘è€…ä¸­å¿ƒé¡µï¼Œç‚¹å‡»â€œä¿®æ”¹é…ç½®â€æŒ‰é’®ï¼Œå¡«å†™æœåŠ¡å™¨åœ°å€ï¼ˆURLï¼‰ã€Tokenå’ŒEncodingAESKeyï¼Œå…¶ä¸­URLæ˜¯å¼€å‘è€…ç”¨æ¥æŽ¥æ”¶å¾®ä¿¡æ¶ˆæ¯å’Œäº‹ä»¶çš„æŽ¥å£URLã€‚Tokenå¯ç”±å¼€å‘è€…å¯ä»¥ä»»æ„å¡«å†™ï¼Œç”¨ä½œç”Ÿæˆç­¾åï¼ˆè¯¥Tokenä¼šå’ŒæŽ¥å£URLä¸­åŒ…å«çš„Tokenè¿›è¡Œæ¯”å¯¹ï¼Œä»Žè€ŒéªŒè¯å®‰å…¨æ€§ï¼‰ã€‚EncodingAESKeyç”±å¼€å‘è€…æ‰‹åŠ¨å¡«å†™æˆ–éšæœºç”Ÿæˆï¼Œå°†ç”¨ä½œæ¶ˆæ¯ä½“åŠ è§£å¯†å¯†é’¥ã€‚åŒæ—¶ï¼Œå¼€å‘è€…å¯é€‰æ‹©æ¶ˆæ¯åŠ è§£å¯†æ–¹å¼ï¼šæ˜Žæ–‡æ¨¡å¼ã€å…¼å®¹æ¨¡å¼å’Œå®‰å…¨æ¨¡å¼ã€‚æ¨¡å¼çš„é€‰æ‹©ä¸ŽæœåŠ¡å™¨é…ç½®åœ¨æäº¤åŽéƒ½ä¼šç«‹å³ç”Ÿæ•ˆï¼Œè¯·å¼€å‘è€…è°¨æ…Žå¡«å†™åŠé€‰æ‹©ã€‚åŠ è§£å¯†æ–¹å¼çš„é»˜è®¤çŠ¶æ€ä¸ºæ˜Žæ–‡æ¨¡å¼ï¼Œé€‰æ‹©å…¼å®¹æ¨¡å¼å’Œå®‰å…¨æ¨¡å¼éœ€è¦æå‰é…ç½®å¥½ç›¸å…³åŠ è§£å¯†ä»£ç ï¼Œè¯¦æƒ…è¯·å‚è€ƒæ¶ˆæ¯ä½“ç­¾ååŠåŠ è§£å¯†éƒ¨åˆ†çš„æ–‡æ¡£ã€‚å¾®ä¿¡å…¬ä¼—å·æŽ¥å£åªæ”¯æŒ80æŽ¥å£ã€‚ç”±äºŽæ²¡æœ‰å¾®ä¿¡å…¬ä¼—å·ï¼Œæ‰€ä»¥ä½¿ç”¨æµ‹è¯•å¹³å°ã€‚æµ‹è¯•å¹³å°ç™»é™†åœ°å€ï¼š&lt; http://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login&gt;å¾®ä¿¡å¼€å‘è€…æ–‡æ¡£ç½‘å€ï¼šhttps://mp.weixin.qq.com/wiki/home/index.htmlé€šè¿‡æŸ¥çœ‹å¼€å‘è€…æ–‡æ¡£ï¼Œå¯ä»¥çŸ¥é“ï¼šå¼€å‘è€…æäº¤ä¿¡æ¯åŽï¼Œå¾®ä¿¡æœåŠ¡å™¨å°†å‘é€GETè¯·æ±‚åˆ°å¡«å†™çš„æœåŠ¡å™¨åœ°å€URLä¸Šï¼ŒGETè¯·æ±‚æºå¸¦å››ä¸ªå‚æ•°ï¼šå‚æ•°æè¿°signatureå¾®ä¿¡åŠ å¯†ç­¾åï¼Œsignatureç»“åˆäº†å¼€å‘è€…å¡«å†™çš„tokenå‚æ•°å’Œè¯·æ±‚ä¸­çš„timestampå‚æ•°ã€nonceå‚æ•°ã€‚timestampæ—¶é—´æˆ³nonceéšæœºæ•°echostréšæœºå­—ç¬¦ä¸²å¼€å‘è€…é€šè¿‡æ£€éªŒsignatureå¯¹è¯·æ±‚è¿›è¡Œæ ¡éªŒã€‚è‹¥ç¡®è®¤æ­¤æ¬¡GETè¯·æ±‚æ¥è‡ªå¾®ä¿¡æœåŠ¡å™¨ï¼Œè¯·åŽŸæ ·è¿”å›žechostrå‚æ•°å†…å®¹ï¼Œåˆ™æŽ¥å…¥ç”Ÿæ•ˆï¼Œæˆä¸ºå¼€å‘è€…æˆåŠŸï¼Œå¦åˆ™æŽ¥å…¥å¤±è´¥ã€‚é€šä¿—ç‚¹æ¥è¯´ï¼Œå°±æ˜¯å¼€å‘è€…åœ¨æŽ¥å£é…ç½®ä¿¡æ¯å¡«å†™å®ŒURLå’Œè‡ªå®šä¹‰çš„ä¸€ä¸ªTokenå€¼ä¹‹åŽï¼Œè…¾è®¯å°±ä¼šå‘é€GETè¯·æ±‚åˆ°è¿™ä¸ªæœåŠ¡å™¨çš„URLåœ°å€ä¸Šï¼Œè¿™ä¸ªGETè¯·æ±‚åŒ…å«å¦‚ä¸Šçš„å››ä¸ªå‚æ•°ã€‚å¼€å‘è€…æŽ¥æ”¶åˆ°è¿™å››ä¸ªå‚æ•°ä¹‹åŽï¼Œæ ¹æ®ä¸€å®šçš„è§„åˆ™ç”Ÿæˆä¸€ä¸ªsignatureï¼Œè·Ÿè…¾è®¯å‘è¿‡æ¥çš„signatureè¿›è¡Œå¯¹æ¯”ï¼Œä¸€è‡´çš„è¯åˆ™æŽ¥å…¥ç”Ÿæ•ˆã€‚è¿™ä¸ªä¸€å®šçš„è§„åˆ™å¦‚ä¸‹ï¼šå°†tokenã€timestampã€nonceä¸‰ä¸ªå‚æ•°è¿›è¡Œå­—å…¸åºæŽ’åºå°†ä¸‰ä¸ªå‚æ•°å­—ç¬¦ä¸²æ‹¼æŽ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œsha1åŠ å¯†å¼€å‘è€…èŽ·å¾—åŠ å¯†åŽçš„å­—ç¬¦ä¸²å¯ä¸Žsignatureå¯¹æ¯”ï¼Œæ ‡è¯†è¯¥è¯·æ±‚æ¥æºäºŽå¾®ä¿¡Pythonä»£ç å®žçŽ°ï¼ˆä»¥Flaskæ¡†æž¶ä¸ºä¾‹ï¼‰ï¼š123456789101112131415161718192021222324252627282930313233#!/usr/bin/env python# -*- coding: utf-8 -*-from flask import Flask, request, make_responseimport hashlibapp = Flask(__name__)@app.route('/')def index(): # è®¾ç½®token,å¼€å‘è€…é…ç½®ä¸­å¿ƒä½¿ç”¨ token = 'wechat_pro' # èŽ·å–å¾®ä¿¡æœåŠ¡å™¨å‘é€è¿‡æ¥çš„å‚æ•° data = request.args signature = data.get('signature') timestamp = data.get('timestamp') nonce = data.get('nonce') echostr = data.get('echostr') # å¯¹å‚æ•°è¿›è¡Œå­—å…¸æŽ’åºï¼Œæ‹¼æŽ¥å­—ç¬¦ä¸² temp = [timestamp, nonce, token] temp.sort() temp = ''.join(temp) # åŠ å¯† if (hashlib.sha1(temp.encode('utf8')).hexdigest() == signature): return echostr else: return 'error', 403if __name__ == '__main__': app.run(host='0.0.0.0', port=8000, debug=True)æ³¨æ„ï¼šæ¯”è¾ƒå¸¸è§çš„é”™è¯¯æ˜¯ï¼šTypeError: Unicode-objects must be encoded before hashingï¼Œåˆ™æ˜¯å› ä¸ºéœ€è¦æŒ‡å®šåŠ å¯†å­—ç¬¦ä¸²çš„ç¼–ç ï¼Œæ–‡ä¸­çš„temp.encode(&#39;utf8&#39;)å°±æ˜¯è§£å†³è¿™ä¸ªé”™è¯¯çš„ã€‚å½“æŽ¥å…¥ç”Ÿæ•ˆåŽï¼Œæµ‹è¯•å¹³å°ç½‘é¡µä¸Šä¼šæ˜¾ç¤ºâ€œé…ç½®æˆåŠŸâ€é—®é¢˜ï¼špython ä»£ç åœ¨åŽå°è¿è¡Œï¼Œå‡è®¾åœ¨ä»£ç ä¸­æƒ³æŸ¥çœ‹èŽ·å–åˆ°çš„æŸä¸ªå˜é‡çš„å€¼ï¼Œä½¿ç”¨print()å‡½æ•°è¾“å‡ºï¼Œä½†æ˜¯å¦‚ä½•æŸ¥çœ‹è¿™ä¸ªè¾“å‡ºå‘¢ï¼Ÿæˆ‘è¿™è¾¹çš„è§£å†³åŠžæ³•æ˜¯æœ¬åœ°è°ƒè¯•ï¼Œç„¶åŽä¸Šä¼ ä»£ç åˆ°æœåŠ¡å™¨ã€‚å…·ä½“æ¥è¯´å¦‚ä¸‹ï¼š1ã€æœ¬åœ°ä¹Ÿæ­å»ºå¥½çŽ¯å¢ƒï¼Œç›®å½•ç»“æž„è·ŸæœåŠ¡å™¨ä¸Šé¢çš„ä¸€æ ·ï¼Œä½†æ˜¯æœ¬åœ°ä»£ç ä¸­è¿è¡Œçš„ç«¯å£æ˜¯80ï¼ŒæœåŠ¡å™¨ä»£ç ä¸­æ˜¯80002ã€ä½¿ç”¨frpcçš„æ–¹å¼ï¼Œç»™æœ¬åœ°çŽ¯å¢ƒä¹Ÿé…ç½®ä¸€ä¸ªå¤–ç½‘è®¿é—®åŸŸåã€‚3ã€æµ‹è¯•å…¬ä¼—å·è¿™è¾¹é…ç½®çš„è¯ï¼Œå…ˆé…ç½®æœ¬åœ°çš„è¿™ä¸ªåŸŸåï¼Œè¿›è¡Œè°ƒè¯•æµ‹è¯•ï¼Œæ²¡é—®é¢˜çš„è¯æŠŠä»£ç ä¸­çš„ç«¯å£ä¿®æ”¹æˆ8000ï¼Œç„¶åŽä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚ç„¶åŽå†åœ¨æµ‹è¯•å…¬ä¼—å·ä¸Šä¿®æ”¹è¿™ä¸ªURLåœ°å€ä¸ºæœåŠ¡å™¨ä¸Šçš„åŸŸåã€‚4ã€æœ¬åœ°ä»£ç å†ç»“åˆGitä½¿ç”¨ï¼Œæ•ˆæžœæ›´ä½³å…¬ä¼—å·æŽ¥æ”¶ä¸Žå‘é€æ¶ˆæ¯1. æŽ¥æ”¶æ™®é€šæ¶ˆæ¯å½“æ™®é€šå¾®ä¿¡ç”¨æˆ·å‘å…¬ä¼—è´¦å·å‘æ¶ˆæ¯æ—¶ï¼Œå¾®ä¿¡æœåŠ¡å™¨å°†POSTæ¶ˆæ¯çš„XMLæ•°æ®åŒ…åˆ°å¼€å‘è€…å¡«å†™çš„URLä¸Šã€‚å¾®ä¿¡æœåŠ¡å™¨åœ¨äº”ç§’å†…æ”¶ä¸åˆ°å“åº”ä¼šæ–­æŽ‰è¿žæŽ¥ï¼Œå¹¶ä¸”é‡æ–°å‘èµ·è¯·æ±‚ï¼Œæ€»å…±é‡è¯•ä¸‰æ¬¡ã€‚å‡å¦‚æœåŠ¡å™¨æ— æ³•ä¿è¯åœ¨äº”ç§’å†…å¤„ç†å¹¶å›žå¤ï¼Œå¯ä»¥ç›´æŽ¥å›žå¤ç©ºä¸²ï¼Œå¾®ä¿¡æœåŠ¡å™¨ä¸ä¼šå¯¹æ­¤ä½œä»»ä½•å¤„ç†ï¼Œå¹¶ä¸”ä¸ä¼šå‘èµ·é‡è¯•ã€‚å„æ¶ˆæ¯ç±»åž‹çš„æŽ¨é€ä½¿ç”¨XMLæ•°æ®åŒ…ç»“æž„ï¼Œå¦‚ï¼š12345678&lt;xml&gt;&lt;ToUserName&gt;&lt;![CDATA[gh_866835093fea]]&gt;&lt;/ToUserName&gt;&lt;FromUserName&gt;&lt;![CDATA[ogdotwSc_MmEEsJs9-ABZ1QL_4r4]]&gt;&lt;/FromUserName&gt;&lt;CreateTime&gt;1478317060&lt;/CreateTime&gt;&lt;MsgType&gt;&lt;![CDATA[text]]&gt;&lt;/MsgType&gt;&lt;Content&gt;&lt;![CDATA[ä½ å¥½]]&gt;&lt;/Content&gt;&lt;MsgId&gt;6349323426230210995&lt;/MsgId&gt;&lt;/xml&gt;æ³¨æ„ï¼š&lt;![CDATA ä¸Ž ]]&gt; æ‹¬èµ·æ¥çš„æ•°æ®ä¸ä¼šè¢«xmlè§£æžå™¨è§£æžã€‚æ™®é€šæ¶ˆæ¯ç±»åˆ«æ–‡æœ¬æ¶ˆæ¯å›¾ç‰‡æ¶ˆæ¯è¯­éŸ³æ¶ˆæ¯è§†é¢‘æ¶ˆæ¯å°è§†é¢‘æ¶ˆæ¯åœ°ç†ä½ç½®æ¶ˆæ¯é“¾æŽ¥æ¶ˆæ¯æ–‡æœ¬æ¶ˆæ¯å¾®ä¿¡postè¿‡æ¥çš„æ–‡æœ¬xmlæ•°æ®æ ¼å¼å¦‚ä¸‹ï¼š12345678&lt;xml&gt; &lt;ToUserName&gt;&lt;![CDATA[toUser]]&gt;&lt;/ToUserName&gt; &lt;FromUserName&gt;&lt;![CDATA[fromUser]]&gt;&lt;/FromUserName&gt; &lt;CreateTime&gt;1348831860&lt;/CreateTime&gt; &lt;MsgType&gt;&lt;![CDATA[text]]&gt;&lt;/MsgType&gt; &lt;Content&gt;&lt;![CDATA[this is a test]]&gt;&lt;/Content&gt; &lt;MsgId&gt;1234567890123456&lt;/MsgId&gt;&lt;/xml&gt;å‚æ•°æè¿°ToUserNameå¼€å‘è€…å¾®ä¿¡å·FromUserNameå‘é€æ–¹å¸å·ï¼ˆä¸€ä¸ªOpenIDï¼‰CreateTimeæ¶ˆæ¯åˆ›å»ºæ—¶é—´ ï¼ˆæ•´åž‹ï¼‰MsgTypeæ¶ˆæ¯ç±»åž‹ï¼Œæ–‡æœ¬ä¸ºtextContentæ–‡æœ¬æ¶ˆæ¯å†…å®¹MsgIdæ¶ˆæ¯idï¼Œ64ä½æ•´åž‹2. è¢«åŠ¨å›žå¤æ¶ˆæ¯å½“ç”¨æˆ·å‘é€æ¶ˆæ¯ç»™å…¬ä¼—å·æ—¶ï¼ˆæˆ–æŸäº›ç‰¹å®šçš„ç”¨æˆ·æ“ä½œå¼•å‘çš„äº‹ä»¶æŽ¨é€æ—¶ï¼‰ï¼Œä¼šäº§ç”Ÿä¸€ä¸ªPOSTè¯·æ±‚ï¼Œå¼€å‘è€…å¯ä»¥åœ¨å“åº”åŒ…ä¸­è¿”å›žç‰¹å®šXMLç»“æž„ï¼Œæ¥å¯¹è¯¥æ¶ˆæ¯è¿›è¡Œå“åº”ï¼ˆçŽ°æ”¯æŒå›žå¤æ–‡æœ¬ã€å›¾ç‰‡ã€å›¾æ–‡ã€è¯­éŸ³ã€è§†é¢‘ã€éŸ³ä¹ï¼‰ã€‚ä¸¥æ ¼æ¥è¯´ï¼Œå‘é€è¢«åŠ¨å“åº”æ¶ˆæ¯å…¶å®žå¹¶ä¸æ˜¯ä¸€ç§æŽ¥å£ï¼Œè€Œæ˜¯å¯¹å¾®ä¿¡æœåŠ¡å™¨å‘è¿‡æ¥æ¶ˆæ¯çš„ä¸€æ¬¡å›žå¤ã€‚å‡å¦‚æœåŠ¡å™¨æ— æ³•ä¿è¯åœ¨äº”ç§’å†…å¤„ç†å¹¶å›žå¤ï¼Œå¿…é¡»åšå‡ºä¸‹è¿°å›žå¤ï¼Œè¿™æ ·å¾®ä¿¡æœåŠ¡å™¨æ‰ä¸ä¼šå¯¹æ­¤ä½œä»»ä½•å¤„ç†ï¼Œå¹¶ä¸”ä¸ä¼šå‘èµ·é‡è¯•ï¼ˆè¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨å®¢æœæ¶ˆæ¯æŽ¥å£è¿›è¡Œå¼‚æ­¥å›žå¤ï¼‰ï¼Œå¦åˆ™ï¼Œå°†å‡ºçŽ°ä¸¥é‡çš„é”™è¯¯æç¤ºã€‚è¯¦è§ä¸‹é¢è¯´æ˜Žï¼šï¼ˆæŽ¨èæ–¹å¼ï¼‰ç›´æŽ¥å›žå¤successç›´æŽ¥å›žå¤ç©ºä¸²ï¼ˆæŒ‡å­—èŠ‚é•¿åº¦ä¸º0çš„ç©ºå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯XMLç»“æž„ä½“ä¸­contentå­—æ®µçš„å†…å®¹ä¸ºç©ºï¼‰ä¸€æ—¦é‡åˆ°ä»¥ä¸‹æƒ…å†µï¼Œå¾®ä¿¡éƒ½ä¼šåœ¨å…¬ä¼—å·ä¼šè¯ä¸­ï¼Œå‘ç”¨æˆ·ä¸‹å‘ç³»ç»Ÿæç¤ºâ€œè¯¥å…¬ä¼—å·æš‚æ—¶æ— æ³•æä¾›æœåŠ¡ï¼Œè¯·ç¨åŽå†è¯•â€ï¼šå¼€å‘è€…åœ¨5ç§’å†…æœªå›žå¤ä»»ä½•å†…å®¹å¼€å‘è€…å›žå¤äº†å¼‚å¸¸æ•°æ®ï¼Œæ¯”å¦‚JSONæ•°æ®ç­‰å›žå¤çš„æ¶ˆæ¯ç±»åž‹æ–‡æœ¬æ¶ˆæ¯å›¾ç‰‡æ¶ˆæ¯è¯­éŸ³æ¶ˆæ¯è§†é¢‘æ¶ˆæ¯éŸ³ä¹æ¶ˆæ¯å›¾æ–‡æ¶ˆæ¯å›žå¤æ–‡æœ¬æ¶ˆæ¯1234567&lt;xml&gt;&lt;ToUserName&gt;&lt;![CDATA[toUser]]&gt;&lt;/ToUserName&gt;&lt;FromUserName&gt;&lt;![CDATA[fromUser]]&gt;&lt;/FromUserName&gt;&lt;CreateTime&gt;12345678&lt;/CreateTime&gt;&lt;MsgType&gt;&lt;![CDATA[text]]&gt;&lt;/MsgType&gt;&lt;Content&gt;&lt;![CDATA[ä½ å¥½]]&gt;&lt;/Content&gt;&lt;/xml&gt;å‚æ•°æ˜¯å¦å¿…é¡»æè¿°ToUserNameæ˜¯æŽ¥æ”¶æ–¹å¸å·ï¼ˆæ”¶åˆ°çš„OpenIDï¼‰FromUserNameæ˜¯å¼€å‘è€…å¾®ä¿¡å·CreateTimeæ˜¯æ¶ˆæ¯åˆ›å»ºæ—¶é—´ ï¼ˆæ•´åž‹ï¼‰MsgTypeæ˜¯æ¶ˆæ¯ç±»åž‹ï¼Œæ–‡æœ¬ä¸ºtextContentæ˜¯å›žå¤çš„æ¶ˆæ¯å†…å®¹ï¼ˆæ¢è¡Œï¼šåœ¨contentä¸­èƒ½å¤Ÿæ¢è¡Œï¼Œå¾®ä¿¡å®¢æˆ·ç«¯å°±æ”¯æŒæ¢è¡Œæ˜¾ç¤ºï¼‰3. ä»£ç å®žçŽ°è¿˜åœ¨åŽŸæ¥çš„è·¯å¾„ä¸‹ï¼Œè‹¥æ˜¯getè¯·æ±‚ï¼Œåˆ™æ˜¯è¿›è¡ŒæœåŠ¡å™¨éªŒè¯ï¼Œå‚è€ƒä¸Šä¸€æ­¥çš„å¤„ç†ã€‚è‹¥æ˜¯postè¯·æ±‚ï¼Œåˆ™è¿›ä¸€æ­¥å¤„ç†ã€‚å®žçŽ°çš„ä¸šåŠ¡é€»è¾‘ç±»ä¼¼ä¸Žâ€œé¹¦é¹‰å­¦èˆŒâ€ï¼Œç”¨æˆ·å‘ä»€ä¹ˆå†…å®¹ï¼Œæˆ‘ä»¬å°±ä¼ å›žä»€ä¹ˆå†…å®¹ã€‚è¯¦çœ‹ä»£ç ï¼š12345678910111213141516171819202122232425262728293031# æ ¹æ®è¯·æ±‚æ–¹å¼è¿›è¡Œåˆ¤æ–­if request.method == 'POST': èŽ·å–å¾®ä¿¡æœåŠ¡å™¨postè¿‡æ¥çš„xmlæ•°æ® xml = request.data # æŠŠxmlæ ¼å¼çš„æ•°æ®è¿›è¡Œå¤„ç†ï¼Œè½¬æ¢æˆå­—å…¸è¿›è¡Œå–å€¼ req = xmltodict.parse(xml)['xml'] # åˆ¤æ–­postè¿‡æ¥çš„æ•°æ®ä¸­æ•°æ®ç±»åž‹æ˜¯ä¸æ˜¯æ–‡æœ¬ if 'text' == req.get('MsgType'): # èŽ·å–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œå¼€å§‹æž„é€ è¿”å›žæ•°æ®ï¼ŒæŠŠç”¨æˆ·å‘é€çš„ä¿¡æ¯åŽŸå°ä¸åŠ¨çš„è¿”å›žè¿‡åŽ»ï¼Œå­—å…¸æ ¼å¼ resp = &#123; 'ToUserName':req.get('FromUserName'), 'FromUserName':req.get('ToUserName'), 'CreateTime':int(time.time()), 'MsgType':'text', 'Content':req.get('Content') &#125; # æŠŠæž„é€ çš„å­—å…¸è½¬æ¢æˆxmlæ ¼å¼ xml = xmltodict.unparse(&#123;'xml':resp&#125;) # print(req.get('Content')) # è¿”å›žæ•°æ® return xml else: resp = &#123; 'ToUserName': req.get('FromUserName', ''), 'FromUserName': req.get('ToUserName', ''), 'CreateTime': int(time.time()), 'MsgType': 'text', 'Content': 'I LOVE ITCAST' &#125; xml = xmltodict.unparse(&#123;'xml':resp&#125;) return xmlæ³¨æ„ï¼šQQè¡¨æƒ…å®žé™…ä¸Šæ˜¯å­—ç¬¦ä¸²è½¬ä¹‰ï¼Œä»å±žäºŽæ–‡æœ¬æ¶ˆæ¯emojiè¡¨æƒ…æœ¬è´¨æ˜¯Unicodeå­—ç¬¦ï¼Œä¹Ÿå±žäºŽæ–‡æœ¬æ¶ˆæ¯è‡ªå®šä¹‰è¡¨æƒ…ï¼šæ—¢ä¸æ˜¯æ–‡æœ¬ï¼Œä¹Ÿä¸æ˜¯å›¾ç‰‡ï¼Œè€Œæ˜¯ä¸€ç§ä¸æ”¯æŒçš„æ ¼å¼ï¼Œå¾®ä¿¡æœªæä¾›å¤„ç†è¯¥æ¶ˆæ¯çš„æŽ¥å£å®Œæ•´ä»£ç 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970#!/usr/bin/env python# -*- coding: utf-8 -*-from flask import Flask, request, make_responseimport hashlibimport xmltodictimport timeapp = Flask(__name__)@app.route('/',methods=['GET','POST'])def index(): if request.method =='GET': # è®¾ç½®token,å¼€å‘è€…é…ç½®ä¸­å¿ƒä½¿ç”¨ token = 'wechat_pro' # èŽ·å–å¾®ä¿¡æœåŠ¡å™¨å‘é€è¿‡æ¥çš„å‚æ•° data = request.args signature = data.get('signature') timestamp = data.get('timestamp') nonce = data.get('nonce') echostr = data.get('echostr') # å¯¹å‚æ•°è¿›è¡Œå­—å…¸æŽ’åºï¼Œæ‹¼æŽ¥å­—ç¬¦ä¸² temp = [timestamp, nonce, token] temp.sort() temp = ''.join(temp) # åŠ å¯† if (hashlib.sha1(temp.encode('utf8')).hexdigest() == signature): return echostr else: return 'error', 403 # æ ¹æ®è¯·æ±‚æ–¹å¼è¿›è¡Œåˆ¤æ–­ if request.method == 'POST': èŽ·å–å¾®ä¿¡æœåŠ¡å™¨postè¿‡æ¥çš„xmlæ•°æ® xml = request.data # æŠŠxmlæ ¼å¼çš„æ•°æ®è¿›è¡Œå¤„ç†ï¼Œè½¬æ¢æˆå­—å…¸è¿›è¡Œå–å€¼ req = xmltodict.parse(xml)['xml'] # åˆ¤æ–­postè¿‡æ¥çš„æ•°æ®ä¸­æ•°æ®ç±»åž‹æ˜¯ä¸æ˜¯æ–‡æœ¬ if 'text' == req.get('MsgType'): # èŽ·å–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œå¼€å§‹æž„é€ è¿”å›žæ•°æ®ï¼ŒæŠŠç”¨æˆ·å‘é€çš„ä¿¡æ¯åŽŸå°ä¸åŠ¨çš„è¿”å›žè¿‡åŽ»ï¼Œå­—å…¸æ ¼å¼ resp = &#123; 'ToUserName':req.get('FromUserName'), 'FromUserName':req.get('ToUserName'), 'CreateTime':int(time.time()), 'MsgType':'text', 'Content':req.get('Content') &#125; # æŠŠæž„é€ çš„å­—å…¸è½¬æ¢æˆxmlæ ¼å¼ xml = xmltodict.unparse(&#123;'xml':resp&#125;) # print(req.get('Content')) # è¿”å›žæ•°æ® return xml else: resp = &#123; 'ToUserName': req.get('FromUserName', ''), 'FromUserName': req.get('ToUserName', ''), 'CreateTime': int(time.time()), 'MsgType': 'text', 'Content': 'I LOVE ITCAST' &#125; xml = xmltodict.unparse(&#123;'xml':resp&#125;) return xmlif __name__ == '__main__': app.run(host='0.0.0.0', port=8000, debug=True)4. æŽ¥æ”¶å…¶ä»–æ™®é€šæ¶ˆæ¯æŽ¥æ”¶å›¾ç‰‡æ¶ˆæ¯123456789&lt;xml&gt;&lt;ToUserName&gt;&lt;![CDATA[toUser]]&gt;&lt;/ToUserName&gt;&lt;FromUserName&gt;&lt;![CDATA[fromUser]]&gt;&lt;/FromUserName&gt;&lt;CreateTime&gt;1348831860&lt;/CreateTime&gt;&lt;MsgType&gt;&lt;![CDATA[image]]&gt;&lt;/MsgType&gt;&lt;PicUrl&gt;&lt;![CDATA[this is a url]]&gt;&lt;/PicUrl&gt;&lt;MediaId&gt;&lt;![CDATA[media_id]]&gt;&lt;/MediaId&gt;&lt;MsgId&gt;1234567890123456&lt;/MsgId&gt;&lt;/xml&gt;å‚æ•°æè¿°ToUserNameå¼€å‘è€…å¾®ä¿¡å·FromUserNameå‘é€æ–¹å¸å·ï¼ˆä¸€ä¸ªOpenIDï¼‰CreateTimeæ¶ˆæ¯åˆ›å»ºæ—¶é—´ ï¼ˆæ•´åž‹ï¼‰MsgTypeimagePicUrlå›¾ç‰‡é“¾æŽ¥MediaIdå›¾ç‰‡æ¶ˆæ¯åª’ä½“idï¼Œå¯ä»¥è°ƒç”¨å¤šåª’ä½“æ–‡ä»¶ä¸‹è½½æŽ¥å£æ‹‰å–æ•°æ®ã€‚MsgIdæ¶ˆæ¯idï¼Œ64ä½æ•´åž‹æŽ¥æ”¶è§†é¢‘æ¶ˆæ¯123456789&lt;xml&gt;&lt;ToUserName&gt;&lt;![CDATA[toUser]]&gt;&lt;/ToUserName&gt;&lt;FromUserName&gt;&lt;![CDATA[fromUser]]&gt;&lt;/FromUserName&gt;&lt;CreateTime&gt;1357290913&lt;/CreateTime&gt;&lt;MsgType&gt;&lt;![CDATA[video]]&gt;&lt;/MsgType&gt;&lt;MediaId&gt;&lt;![CDATA[media_id]]&gt;&lt;/MediaId&gt;&lt;ThumbMediaId&gt;&lt;![CDATA[thumb_media_id]]&gt;&lt;/ThumbMediaId&gt;&lt;MsgId&gt;1234567890123456&lt;/MsgId&gt;&lt;/xml&gt;å‚æ•°æè¿°ToUserNameå¼€å‘è€…å¾®ä¿¡å·FromUserNameå‘é€æ–¹å¸å·ï¼ˆä¸€ä¸ªOpenIDï¼‰CreateTimeæ¶ˆæ¯åˆ›å»ºæ—¶é—´ ï¼ˆæ•´åž‹ï¼‰MsgTypeè§†é¢‘ä¸ºvideoMediaIdè§†é¢‘æ¶ˆæ¯åª’ä½“idï¼Œå¯ä»¥è°ƒç”¨å¤šåª’ä½“æ–‡ä»¶ä¸‹è½½æŽ¥å£æ‹‰å–æ•°æ®ã€‚ThumbMediaIdè§†é¢‘æ¶ˆæ¯ç¼©ç•¥å›¾çš„åª’ä½“idï¼Œå¯ä»¥è°ƒç”¨å¤šåª’ä½“æ–‡ä»¶ä¸‹è½½æŽ¥å£æ‹‰å–æ•°æ®ã€‚MsgIdæ¶ˆæ¯idï¼Œ64ä½æ•´åž‹æŽ¥æ”¶å°è§†é¢‘æ¶ˆæ¯123456789&lt;xml&gt;&lt;ToUserName&gt;&lt;![CDATA[toUser]]&gt;&lt;/ToUserName&gt;&lt;FromUserName&gt;&lt;![CDATA[fromUser]]&gt;&lt;/FromUserName&gt;&lt;CreateTime&gt;1357290913&lt;/CreateTime&gt;&lt;MsgType&gt;&lt;![CDATA[shortvideo]]&gt;&lt;/MsgType&gt;&lt;MediaId&gt;&lt;![CDATA[media_id]]&gt;&lt;/MediaId&gt;&lt;ThumbMediaId&gt;&lt;![CDATA[thumb_media_id]]&gt;&lt;/ThumbMediaId&gt;&lt;MsgId&gt;1234567890123456&lt;/MsgId&gt;&lt;/xml&gt;å‚æ•°æè¿°ToUserNameå¼€å‘è€…å¾®ä¿¡å·FromUserNameå‘é€æ–¹å¸å·ï¼ˆä¸€ä¸ªOpenIDï¼‰CreateTimeæ¶ˆæ¯åˆ›å»ºæ—¶é—´ ï¼ˆæ•´åž‹ï¼‰MsgTypeå°è§†é¢‘ä¸ºshortvideoMediaIdè§†é¢‘æ¶ˆæ¯åª’ä½“idï¼Œå¯ä»¥è°ƒç”¨å¤šåª’ä½“æ–‡ä»¶ä¸‹è½½æŽ¥å£æ‹‰å–æ•°æ®ã€‚ThumbMediaIdè§†é¢‘æ¶ˆæ¯ç¼©ç•¥å›¾çš„åª’ä½“idï¼Œå¯ä»¥è°ƒç”¨å¤šåª’ä½“æ–‡ä»¶ä¸‹è½½æŽ¥å£æ‹‰å–æ•°æ®ã€‚MsgIdæ¶ˆæ¯idï¼Œ64ä½æ•´åž‹æŽ¥æ”¶è¯­éŸ³æ¶ˆæ¯123456789&lt;xml&gt;&lt;ToUserName&gt;&lt;![CDATA[toUser]]&gt;&lt;/ToUserName&gt;&lt;FromUserName&gt;&lt;![CDATA[fromUser]]&gt;&lt;/FromUserName&gt;&lt;CreateTime&gt;1357290913&lt;/CreateTime&gt;&lt;MsgType&gt;&lt;![CDATA[voice]]&gt;&lt;/MsgType&gt;&lt;MediaId&gt;&lt;![CDATA[media_id]]&gt;&lt;/MediaId&gt;&lt;Format&gt;&lt;![CDATA[Format]]&gt;&lt;/Format&gt;&lt;MsgId&gt;1234567890123456&lt;/MsgId&gt;&lt;/xml&gt;å‚æ•°æè¿°ToUserNameå¼€å‘è€…å¾®ä¿¡å·FromUserNameå‘é€æ–¹å¸å·ï¼ˆä¸€ä¸ªOpenIDï¼‰CreateTimeæ¶ˆæ¯åˆ›å»ºæ—¶é—´ ï¼ˆæ•´åž‹ï¼‰MsgTypeè¯­éŸ³ä¸ºvoiceMediaIdè¯­éŸ³æ¶ˆæ¯åª’ä½“idï¼Œå¯ä»¥è°ƒç”¨å¤šåª’ä½“æ–‡ä»¶ä¸‹è½½æŽ¥å£æ‹‰å–æ•°æ®ã€‚Formatè¯­éŸ³æ ¼å¼ï¼Œå¦‚amrï¼Œspeexç­‰MsgIDæ¶ˆæ¯idï¼Œ64ä½æ•´åž‹è¯·æ³¨æ„ï¼Œå¼€é€šè¯­éŸ³è¯†åˆ«åŽï¼Œç”¨æˆ·æ¯æ¬¡å‘é€è¯­éŸ³ç»™å…¬ä¼—å·æ—¶ï¼Œå¾®ä¿¡ä¼šåœ¨æŽ¨é€çš„è¯­éŸ³æ¶ˆæ¯XMLæ•°æ®åŒ…ä¸­ï¼Œå¢žåŠ ä¸€ä¸ªRecongnitionå­—æ®µï¼ˆæ³¨ï¼šç”±äºŽå®¢æˆ·ç«¯ç¼“å­˜ï¼Œå¼€å‘è€…å¼€å¯æˆ–è€…å…³é—­è¯­éŸ³è¯†åˆ«åŠŸèƒ½ï¼Œå¯¹æ–°å…³æ³¨è€…ç«‹åˆ»ç”Ÿæ•ˆï¼Œå¯¹å·²å…³æ³¨ç”¨æˆ·éœ€è¦24å°æ—¶ç”Ÿæ•ˆã€‚å¼€å‘è€…å¯ä»¥é‡æ–°å…³æ³¨æ­¤å¸å·è¿›è¡Œæµ‹è¯•ï¼‰ã€‚å¼€å¯è¯­éŸ³è¯†åˆ«åŽçš„è¯­éŸ³XMLæ•°æ®åŒ…å¦‚ä¸‹ï¼š12345678910&lt;xml&gt;&lt;ToUserName&gt;&lt;![CDATA[toUser]]&gt;&lt;/ToUserName&gt;&lt;FromUserName&gt;&lt;![CDATA[fromUser]]&gt;&lt;/FromUserName&gt;&lt;CreateTime&gt;1357290913&lt;/CreateTime&gt;&lt;MsgType&gt;&lt;![CDATA[voice]]&gt;&lt;/MsgType&gt;&lt;MediaId&gt;&lt;![CDATA[media_id]]&gt;&lt;/MediaId&gt;&lt;Format&gt;&lt;![CDATA[Format]]&gt;&lt;/Format&gt;&lt;Recognition&gt;&lt;![CDATA[è…¾è®¯å¾®ä¿¡å›¢é˜Ÿ]]&gt;&lt;/Recognition&gt;&lt;MsgId&gt;1234567890123456&lt;/MsgId&gt;&lt;/xml&gt;å¤šå‡ºçš„å­—æ®µä¸­ï¼ŒFormatä¸ºè¯­éŸ³æ ¼å¼ï¼Œä¸€èˆ¬ä¸ºamrï¼ŒRecognitionä¸ºè¯­éŸ³è¯†åˆ«ç»“æžœï¼Œä½¿ç”¨UTF8ç¼–ç ã€‚5.å›žå¤å…¶ä»–æ™®é€šæ¶ˆæ¯å›žå¤å›¾ç‰‡æ¶ˆæ¯123456789&lt;xml&gt;&lt;ToUserName&gt;&lt;![CDATA[toUser]]&gt;&lt;/ToUserName&gt;&lt;FromUserName&gt;&lt;![CDATA[fromUser]]&gt;&lt;/FromUserName&gt;&lt;CreateTime&gt;12345678&lt;/CreateTime&gt;&lt;MsgType&gt;&lt;![CDATA[image]]&gt;&lt;/MsgType&gt;&lt;Image&gt;&lt;MediaId&gt;&lt;![CDATA[media_id]]&gt;&lt;/MediaId&gt;&lt;/Image&gt;&lt;/xml&gt;å‚æ•°æ˜¯å¦å¿…é¡»è¯´æ˜ŽToUserNameæ˜¯æŽ¥æ”¶æ–¹å¸å·ï¼ˆæ”¶åˆ°çš„OpenIDï¼‰FromUserNameæ˜¯å¼€å‘è€…å¾®ä¿¡å·CreateTimeæ˜¯æ¶ˆæ¯åˆ›å»ºæ—¶é—´ ï¼ˆæ•´åž‹ï¼‰MsgTypeæ˜¯imageMediaIdæ˜¯é€šè¿‡ç´ æç®¡ç†æŽ¥å£ä¸Šä¼ å¤šåª’ä½“æ–‡ä»¶ï¼Œå¾—åˆ°çš„idã€‚å›žå¤è¯­éŸ³æ¶ˆæ¯123456789&lt;xml&gt;&lt;ToUserName&gt;&lt;![CDATA[toUser]]&gt;&lt;/ToUserName&gt;&lt;FromUserName&gt;&lt;![CDATA[fromUser]]&gt;&lt;/FromUserName&gt;&lt;CreateTime&gt;12345678&lt;/CreateTime&gt;&lt;MsgType&gt;&lt;![CDATA[voice]]&gt;&lt;/MsgType&gt;&lt;Voice&gt;&lt;MediaId&gt;&lt;![CDATA[media_id]]&gt;&lt;/MediaId&gt;&lt;/Voice&gt;&lt;/xml&gt;å‚æ•°æ˜¯å¦å¿…é¡»è¯´æ˜ŽToUserNameæ˜¯æŽ¥æ”¶æ–¹å¸å·ï¼ˆæ”¶åˆ°çš„OpenIDï¼‰FromUserNameæ˜¯å¼€å‘è€…å¾®ä¿¡å·CreateTimeæ˜¯æ¶ˆæ¯åˆ›å»ºæ—¶é—´æˆ³ ï¼ˆæ•´åž‹ï¼‰MsgTypeæ˜¯è¯­éŸ³ï¼ŒvoiceMediaIdæ˜¯é€šè¿‡ç´ æç®¡ç†æŽ¥å£ä¸Šä¼ å¤šåª’ä½“æ–‡ä»¶ï¼Œå¾—åˆ°çš„idå›žå¤è§†é¢‘æ¶ˆæ¯1234567891011&lt;xml&gt;&lt;ToUserName&gt;&lt;![CDATA[toUser]]&gt;&lt;/ToUserName&gt;&lt;FromUserName&gt;&lt;![CDATA[fromUser]]&gt;&lt;/FromUserName&gt;&lt;CreateTime&gt;12345678&lt;/CreateTime&gt;&lt;MsgType&gt;&lt;![CDATA[video]]&gt;&lt;/MsgType&gt;&lt;Video&gt;&lt;MediaId&gt;&lt;![CDATA[media_id]]&gt;&lt;/MediaId&gt;&lt;Title&gt;&lt;![CDATA[title]]&gt;&lt;/Title&gt;&lt;Description&gt;&lt;![CDATA[description]]&gt;&lt;/Description&gt;&lt;/Video&gt; &lt;/xml&gt;å‚æ•°æ˜¯å¦å¿…é¡»è¯´æ˜ŽToUserNameæ˜¯æŽ¥æ”¶æ–¹å¸å·ï¼ˆæ”¶åˆ°çš„OpenIDï¼‰FromUserNameæ˜¯å¼€å‘è€…å¾®ä¿¡å·CreateTimeæ˜¯æ¶ˆæ¯åˆ›å»ºæ—¶é—´ ï¼ˆæ•´åž‹ï¼‰MsgTypeæ˜¯videoMediaIdæ˜¯é€šè¿‡ç´ æç®¡ç†æŽ¥å£ä¸Šä¼ å¤šåª’ä½“æ–‡ä»¶ï¼Œå¾—åˆ°çš„idTitleå¦è§†é¢‘æ¶ˆæ¯çš„æ ‡é¢˜Descriptionå¦è§†é¢‘æ¶ˆæ¯çš„æè¿°å¯ä»¥ä½¿ç”¨å¾®ä¿¡æä¾›çš„ç½‘é¡µè°ƒè¯•å·¥å…·è¿›è¡Œæµ‹è¯•ï¼šhttps://mp.weixin.qq.com/debug/cgi-bin/apiinfo?t=indexå…³æ³¨/å–æ¶ˆå…³æ³¨äº‹ä»¶ç”¨æˆ·åœ¨å…³æ³¨ä¸Žå–æ¶ˆå…³æ³¨å…¬ä¼—å·æ—¶ï¼Œå¾®ä¿¡ä¼šæŠŠè¿™ä¸ªäº‹ä»¶æŽ¨é€åˆ°å¼€å‘è€…å¡«å†™çš„URLã€‚å¾®ä¿¡æœåŠ¡å™¨åœ¨äº”ç§’å†…æ”¶ä¸åˆ°å“åº”ä¼šæ–­æŽ‰è¿žæŽ¥ï¼Œå¹¶ä¸”é‡æ–°å‘èµ·è¯·æ±‚ï¼Œæ€»å…±é‡è¯•ä¸‰æ¬¡ã€‚å‡å¦‚æœåŠ¡å™¨æ— æ³•ä¿è¯åœ¨äº”ç§’å†…å¤„ç†å¹¶å›žå¤ï¼Œå¯ä»¥ç›´æŽ¥å›žå¤ç©ºä¸²ï¼Œå¾®ä¿¡æœåŠ¡å™¨ä¸ä¼šå¯¹æ­¤ä½œä»»ä½•å¤„ç†ï¼Œå¹¶ä¸”ä¸ä¼šå‘èµ·é‡è¯•ã€‚1234567&lt;xml&gt;&lt;ToUserName&gt;&lt;![CDATA[toUser]]&gt;&lt;/ToUserName&gt;&lt;FromUserName&gt;&lt;![CDATA[FromUser]]&gt;&lt;/FromUserName&gt;&lt;CreateTime&gt;123456789&lt;/CreateTime&gt;&lt;MsgType&gt;&lt;![CDATA[event]]&gt;&lt;/MsgType&gt;&lt;Event&gt;&lt;![CDATA[subscribe]]&gt;&lt;/Event&gt;&lt;/xml&gt;å‚æ•°æè¿°ToUserNameå¼€å‘è€…å¾®ä¿¡å·FromUserNameå‘é€æ–¹å¸å·ï¼ˆä¸€ä¸ªOpenIDï¼‰CreateTimeæ¶ˆæ¯åˆ›å»ºæ—¶é—´ ï¼ˆæ•´åž‹ï¼‰MsgTypeæ¶ˆæ¯ç±»åž‹ï¼ŒeventEventäº‹ä»¶ç±»åž‹ï¼Œsubscribe(è®¢é˜…)ã€unsubscribe(å–æ¶ˆè®¢é˜…)ä»£ç å®žçŽ°12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576#!/usr/bin/env python# -*- coding: utf-8 -*-from flask import Flask, request, make_responseimport hashlibimport xmltodictimport timeimport requestsimport jsonapp = Flask(__name__)@app.route('/',methods=['GET','POST'])def index(): if request.method =='GET': # è®¾ç½®token,å¼€å‘è€…é…ç½®ä¸­å¿ƒä½¿ç”¨ token = 'wechat_pro' # èŽ·å–å¾®ä¿¡æœåŠ¡å™¨å‘é€è¿‡æ¥çš„å‚æ•° data = request.args signature = data.get('signature') timestamp = data.get('timestamp') nonce = data.get('nonce') echostr = data.get('echostr') # å¯¹å‚æ•°è¿›è¡Œå­—å…¸æŽ’åºï¼Œæ‹¼æŽ¥å­—ç¬¦ä¸² temp = [timestamp, nonce, token] temp.sort() temp = ''.join(temp) # åŠ å¯† if (hashlib.sha1(temp.encode('utf8')).hexdigest() == signature): return echostr else: return 'error', 403 if request.method == 'POST': xml = request.data req = xmltodict.parse(xml)['xml'] # print(req) MsgType = req.get('MsgType') if 'text' == MsgType: resp = &#123; 'ToUserName':req.get('FromUserName'), 'FromUserName':req.get('ToUserName'), 'CreateTime':int(time.time()), 'MsgType':'text', 'Content':'è¿™æ˜¯ä¸€ä¸ªæ–‡æœ¬æ¶ˆæ¯ï¼' &#125; elif 'event' == MsgType: if "subscribe" == req.get("Event"): resp = &#123; "ToUserName":req.get("FromUserName", ""), "FromUserName":req.get("ToUserName", ""), "CreateTime":int(time.time()), "MsgType":"text", "Content":u"æ„Ÿè°¢æ‚¨çš„å…³æ³¨ï¼" &#125; else: resp = None else: resp = &#123; 'ToUserName': req.get('FromUserName', ''), 'FromUserName': req.get('ToUserName', ''), 'CreateTime': int(time.time()), 'MsgType': 'text', 'Content': 'æ— æ³•è¯†åˆ«è¯¥æ¶ˆæ¯!' &#125; xml = xmltodict.unparse(&#123;'xml': resp&#125;) return xmlif __name__ == '__main__': app.run(host='0.0.0.0', port=80, debug=True)å¾®ä¿¡ç½‘é¡µæŽˆæƒçŽ°åœ¨ï¼Œæˆ‘ä»¬è¦å®žçŽ°ä¸€ä¸ªå¾®ä¿¡å†…ç½‘é¡µï¼Œé€šè¿‡å¾®ä¿¡è®¿é—®ç½‘é¡µæ—¶ï¼Œç½‘é¡µä¼šå±•ç¤ºå¾®ä¿¡ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯ã€‚å› ä¸ºæ¶‰åŠåˆ°ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯ï¼Œæ‰€ä»¥éœ€è¦æœ‰ç”¨æˆ·æŽˆæƒæ‰å¯ä»¥ã€‚å½“ç”¨æˆ·æŽˆæƒåŽï¼Œæˆ‘ä»¬çš„ç½‘é¡µæœåŠ¡å™¨ï¼ˆå¼€å‘è€…æœåŠ¡å™¨ï¼‰ä¼šæ‹¿åˆ°ç”¨æˆ·çš„â€œæŽˆæƒä¹¦â€ï¼ˆcodeï¼‰,æˆ‘ä»¬ç”¨è¿™ä¸ªcodeå‘å¾®ä¿¡æœåŠ¡å™¨é¢†å–è®¿é—®ä»¤ç‰Œï¼ˆaccecc_tokenï¼‰å’Œç”¨æˆ·çš„èº«ä»½å·ç ï¼ˆopenid)ï¼Œç„¶åŽå‡­å€Ÿaccess_tokenå’Œopenidå‘å¾®ä¿¡æœåŠ¡å™¨æå–ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯ã€‚ç¬¬ä¸€æ­¥ï¼šç”¨æˆ·åŒæ„æŽˆæƒï¼ŒèŽ·å–codeç¬¬äºŒæ­¥ï¼šé€šè¿‡codeæ¢å–ç½‘é¡µæŽˆæƒaccess_tokenç¬¬ä¸‰æ­¥ï¼šæ‹‰å–ç”¨æˆ·ä¿¡æ¯(éœ€scopeä¸º snsapi_userinfo)é‚£ä¹ˆï¼Œå¦‚ä½•æ‹¿åˆ°ç”¨æˆ·çš„æŽˆæƒcodeå‘¢ï¼ŸæŽˆæƒæ˜¯ç”±å¾®ä¿¡å‘èµ·è®©ç”¨æˆ·è¿›è¡Œç¡®è®¤ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æ˜¯å¾®ä¿¡åœ¨ä¸Žç”¨æˆ·è¿›è¡Œäº¤äº’ï¼Œæ‰€ä»¥ç”¨æˆ·åº”è¯¥å…ˆè®¿é—®å¾®ä¿¡çš„å†…å®¹ï¼Œç”¨æˆ·ç¡®è®¤åŽå†ç”±å¾®ä¿¡å°†ç”¨æˆ·å¯¼å‘åˆ°æˆ‘ä»¬çš„ç½‘é¡µé“¾æŽ¥åœ°å€ï¼Œå¹¶æºå¸¦ä¸Šcodeå‚æ•°ã€‚æˆ‘ä»¬æŠŠè¿™ä¸ªè¿‡ç¨‹å«åšç½‘é¡µå›žè°ƒï¼Œç±»ä¼¼äºŽæˆ‘ä»¬åœ¨ç¨‹åºç¼–å†™æ—¶ç”¨åˆ°çš„å›žè°ƒå‡½æ•°ï¼Œéƒ½æ˜¯å›žè°ƒçš„æ€æƒ³ã€‚1. è®¾ç½®ç½‘é¡µæŽˆæƒå›žè°ƒåŸŸååœ¨å¾®ä¿¡å…¬ä¼—å·è¯·æ±‚ç”¨æˆ·ç½‘é¡µæŽˆæƒä¹‹å‰ï¼Œå¼€å‘è€…éœ€è¦å…ˆåˆ°å…¬ä¼—å¹³å°å®˜ç½‘ä¸­çš„å¼€å‘è€…ä¸­å¿ƒé¡µé…ç½®æŽˆæƒå›žè°ƒåŸŸåã€‚è¯·æ³¨æ„ï¼Œè¿™é‡Œå¡«å†™çš„æ˜¯åŸŸåï¼ˆæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼‰ï¼Œè€Œä¸æ˜¯URLï¼Œå› æ­¤è¯·å‹¿åŠ  http:// ç­‰åè®®å¤´ï¼›æŽˆæƒå›žè°ƒåŸŸåé…ç½®è§„èŒƒä¸ºå…¨åŸŸåï¼Œæ¯”å¦‚éœ€è¦ç½‘é¡µæŽˆæƒçš„åŸŸåä¸ºï¼šwww.qq.comï¼Œé…ç½®ä»¥åŽæ­¤åŸŸåä¸‹é¢çš„é¡µé¢http://www.qq.com/music.html ã€ http://www.qq.com/login.html éƒ½å¯ä»¥è¿›è¡ŒOAuth2.0é‰´æƒã€‚ä½†http://pay.qq.com ã€ http://music.qq.com ã€ http://qq.comæ— æ³•è¿›è¡ŒOAuth2.0é‰´æƒã€‚2. ç”¨æˆ·åŒæ„æŽˆæƒï¼ŒèŽ·å–codeè®©ç”¨æˆ·è®¿é—®ä¸€ä¸‹é“¾æŽ¥åœ°å€ï¼šhttps://open.weixin.qq.com/connect/oauth2/authorize?appid=APPID&amp;redirect_uri=REDIRECT_URI&amp;response_type=code&amp;scope=SCOPE&amp;state=STATE#wechat_redirectä¸‹å›¾ä¸ºscopeç­‰äºŽsnsapi_userinfoæ—¶çš„æŽˆæƒé¡µé¢ï¼šç”¨æˆ·åŒæ„æŽˆæƒåŽå¦‚æžœç”¨æˆ·åŒæ„æŽˆæƒï¼Œé¡µé¢å°†è·³è½¬è‡³ redirect_uri/?code=CODE&amp;state=STATEã€‚è‹¥ç”¨æˆ·ç¦æ­¢æŽˆæƒï¼Œåˆ™é‡å®šå‘åŽä¸ä¼šå¸¦ä¸Šcodeå‚æ•°ï¼Œä»…ä¼šå¸¦ä¸Šstateå‚æ•°redirect_uri?state=STATE3. é€šè¿‡codeæ¢å–ç½‘é¡µæŽˆæƒaccess_tokenè¯·æ±‚æ–¹æ³•https://api.weixin.qq.com/sns/oauth2/access_token?appid=APPID&amp;secret=SECRET&amp;code=CODE&amp;grant_type=authorization_codeå‚æ•°è¯´æ˜Žè¿”å›žå€¼æ­£ç¡®æ—¶è¿”å›žçš„JSONæ•°æ®åŒ…å¦‚ä¸‹ï¼š1234567&#123; "access_token":"ACCESS_TOKEN", "expires_in":7200, "refresh_token":"REFRESH_TOKEN", "openid":"OPENID", "scope":"SCOPE"&#125;é”™è¯¯æ—¶å¾®ä¿¡ä¼šè¿”å›žJSONæ•°æ®åŒ…å¦‚ä¸‹ï¼ˆç¤ºä¾‹ä¸ºCodeæ— æ•ˆé”™è¯¯ï¼‰:1234&#123; "errcode":40029, "errmsg":"invalid code"&#125;4. æ‹‰å–ç”¨æˆ·ä¿¡æ¯(éœ€scopeä¸º snsapi_userinfo)è¯·æ±‚æ–¹æ³•https://api.weixin.qq.com/sns/userinfo?access_token=ACCESS_TOKEN&amp;openid=OPENID&amp;lang=zh_CNå‚æ•°è¯´æ˜Žè¿”å›žå€¼æ­£ç¡®æ—¶è¿”å›žçš„JSONæ•°æ®åŒ…å¦‚ä¸‹ï¼š1234567891011121314&#123; "openid":" OPENID", " nickname": NICKNAME, "sex":"1", "province":"PROVINCE" "city":"CITY", "country":"COUNTRY", "headimgurl": "http://wx.qlogo.cn/mmopen/g3MonUZtNHkdmzicIlibx6iaFqAc56vxLSUfpb6n5WKSYVY0ChQKkiaJSgQ1dZuTOgvLLrhJbERQQ4eMsv84eavHiaiceqxibJxCfHe/46", "privilege":[ "PRIVILEGE1" "PRIVILEGE2" ], "unionid": "o6_bmasdasdsad6_2sgVt7hMZOPfL"&#125;é”™è¯¯æ—¶å¾®ä¿¡ä¼šè¿”å›žJSONæ•°æ®åŒ…å¦‚ä¸‹:1234&#123; "errcode":40003, "errmsg":" invalid openid "&#125;]]></content>
      <categories>
        <category>Python</category>
        <category>flask</category>
        <category>å¾®ä¿¡å…¬ä¼—å·</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>flask</tag>
        <tag>å¾®ä¿¡å…¬ä¼—å·</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[xmlä¸ŽPythonå­—å…¸æ ¼å¼ç›¸äº’è½¬æ¢çš„ä¸¤ç§æ–¹å¼]]></title>
    <url>%2F2019%2F06%2F26%2Fxml%E4%B8%8EPython%E5%AD%97%E5%85%B8%E6%A0%BC%E5%BC%8F%E7%9B%B8%E4%BA%92%E8%BD%AC%E6%8D%A2%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[ç¬¬ä¸€ç§æ–¹å¼1. dictè½¬xml1234567891011121314151617181920212223242526272829303132def dict_to_xml(dict_data): xml = ["&lt;xml&gt;"] for k, v in dict_data.items(): xml.append("&lt;&#123;0&#125;&gt;&#123;1&#125;&lt;/&#123;0&#125;&gt;".format(k, v)) xml.append("&lt;/xml&gt;") return "".join(xml)dict_data = &#123; "ToUserName" : "gh_866835093fea", "FromUserName" : "ogdotwSc_MmEEsJs9-ABZ1QL_4r4", "CreateTime" : "1478317060", "MsgType" : "text", "Content" : "ä½ å¥½", "MsgId" : "6349323426230210995",&#125;print(dict_to_xml(dict_data))"""&lt;xml&gt;&lt;ToUserName&gt;gh_866835093fea&lt;/ToUserName&gt;&lt;FromUserName&gt;ogdotwSc_MmEEsJs9-ABZ1QL_4r4&lt;/FromUserName&gt;&lt;CreateTime&gt;1478317060&lt;/CreateTime&gt;&lt;MsgType&gt;text&lt;/MsgType&gt;&lt;Content&gt;ä½ å¥½&lt;/Content&gt;&lt;MsgId&gt;6349323426230210995&lt;/MsgId&gt;&lt;/xml&gt;""""""&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;xml&gt; &lt;ToUserName&gt;gh_866835093fea&lt;/ToUserName&gt; &lt;FromUserName&gt;ogdotwSc_MmEEsJs9-ABZ1QL_4r4&lt;/FromUserName&gt; &lt;CreateTime&gt;1478317060&lt;/CreateTime&gt; &lt;MsgType&gt;text&lt;/MsgType&gt; &lt;Content&gt;ä½ å¥½&lt;/Content&gt; &lt;MsgId&gt;6349323426230210995&lt;/MsgId&gt;&lt;/xml&gt;"""2. xmlè½¬dict12345678910111213141516171819202122def xml_to_dict(xml_data): xml_dict = &#123;&#125; root = ET.fromstring(xml_data) for child in root: xml_dict[child.tag] = child.text return xml_dictxml_data = """&lt;xml&gt; &lt;ToUserName&gt;gh_866835093fea&lt;/ToUserName&gt; &lt;FromUserName&gt;ogdotwSc_MmEEsJs9-ABZ1QL_4r4&lt;/FromUserName&gt; &lt;CreateTime&gt;1478317060&lt;/CreateTime&gt; &lt;MsgType&gt;text&lt;/MsgType&gt; &lt;Content&gt;ä½ å¥½&lt;/Content&gt; &lt;MsgId&gt;6349323426230210995&lt;/MsgId&gt;&lt;/xml&gt;"""print(xml_to_dict(xml_data))"""&#123;'ToUserName': 'gh_866835093fea', 'FromUserName': 'ogdotwSc_MmEEsJs9-ABZ1QL_4r4', 'CreateTime': '1478317060', 'MsgType': 'text', 'Content': 'ä½ å¥½', 'MsgId': '6349323426230210995'&#125;"""ç¬¬äºŒç§æ–¹å¼xmltodict æ˜¯ä¸€ä¸ªç”¨æ¥å¤„ç†xmlæ•°æ®çš„å¾ˆæ–¹ä¾¿çš„æ¨¡å—ã€‚åŒ…å«ä¸¤ä¸ªå¸¸ç”¨æ–¹æ³•parseå’Œunparsepip install xmltodict1. parse()æ–¹æ³•-xmlè½¬dictxmltodict.parse()æ–¹æ³•å¯ä»¥å°†xmlæ•°æ®è½¬ä¸ºpythonä¸­çš„dictå­—å…¸æ•°æ®ï¼š1234567891011121314151617181920212223242526272829303132333435#!/usr/bin/env python# -*- coding: utf-8 -*-import xmltodictxml_str = """&lt;xml&gt;&lt;ToUserName&gt;&lt;![CDATA[gh_866835093fea]]&gt;&lt;/ToUserName&gt;&lt;FromUserName&gt;&lt;![CDATA[ogdotwSc_MmEEsJs9-ABZ1QL_4r4]]&gt;&lt;/FromUserName&gt;&lt;CreateTime&gt;1478317060&lt;/CreateTime&gt;&lt;MsgType&gt;&lt;![CDATA[text]]&gt;&lt;/MsgType&gt;&lt;Content&gt;&lt;![CDATA[ä½ å¥½]]&gt;&lt;/Content&gt;&lt;MsgId&gt;6349323426230210995&lt;/MsgId&gt;&lt;/xml&gt; """xml_dict = xmltodict.parse(xml_str)# print(xml_dict)# OrderedDict([('xml', OrderedDict([('ToUserName', 'gh_866835093fea'), ('FromUserName', 'ogdotwSc_MmEEsJs9-ABZ1QL_4r4'), ('CreateTime', '1478317060'), ('MsgType', 'text'), ('Content', 'ä½ å¥½'), ('MsgId', '6349323426230210995')]))])# print(xml_dict['xml'])# OrderedDict([('ToUserName', 'gh_866835093fea'), ('FromUserName', 'ogdotwSc_MmEEsJs9-ABZ1QL_4r4'), ('CreateTime', '1478317060'), ('MsgType', 'text'), ('Content', 'ä½ å¥½'), ('MsgId', '6349323426230210995')])for key, val in xml_dict['xml'].items(): print(key, "=", val)"""ToUserName = gh_866835093feaFromUserName = ogdotwSc_MmEEsJs9-ABZ1QL_4r4CreateTime = 1478317060MsgType = textContent = ä½ å¥½MsgId = 6349323426230210995"""2. unparse()æ–¹æ³•-dictè½¬xmlxmltodict.unparse()æ–¹æ³•å¯ä»¥å°†å­—å…¸è½¬æ¢ä¸ºxmlå­—ç¬¦ä¸²ï¼š12345678910111213141516171819202122232425262728293031323334import xmltodictxml_dict = &#123; "xml": &#123; "ToUserName" : "gh_866835093fea", "FromUserName" : "ogdotwSc_MmEEsJs9-ABZ1QL_4r4", "CreateTime" : "1478317060", "MsgType" : "text", "Content" : u"ä½ å¥½", "MsgId" : "6349323426230210995", &#125;&#125;# xml_str = xmltodict.unparse(xml_dict)# print(xml_str)"""&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;xml&gt;&lt;ToUserName&gt;gh_866835093fea&lt;/ToUserName&gt;&lt;FromUserName&gt;ogdotwSc_MmEEsJs9-ABZ1QL_4r4&lt;/FromUserName&gt;&lt;CreateTime&gt;1478317060&lt;/CreateTime&gt;&lt;MsgType&gt;text&lt;/MsgType&gt;&lt;Content&gt;ä½ å¥½&lt;/Content&gt;&lt;MsgId&gt;6349323426230210995&lt;/MsgId&gt;&lt;/xml&gt;"""xml_str = xmltodict.unparse(xml_dict, pretty=True) # prettyè¡¨ç¤ºå‹å¥½è¾“å‡ºprint(xml_str)"""&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;xml&gt; &lt;ToUserName&gt;gh_866835093fea&lt;/ToUserName&gt; &lt;FromUserName&gt;ogdotwSc_MmEEsJs9-ABZ1QL_4r4&lt;/FromUserName&gt; &lt;CreateTime&gt;1478317060&lt;/CreateTime&gt; &lt;MsgType&gt;text&lt;/MsgType&gt; &lt;Content&gt;ä½ å¥½&lt;/Content&gt; &lt;MsgId&gt;6349323426230210995&lt;/MsgId&gt;&lt;/xml&gt;"""]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[nginx+supervisor+gunicorn+flaskéƒ¨ç½²æ•™ç¨‹]]></title>
    <url>%2F2019%2F06%2F24%2Fnginx-supervisor-gunicorn-flask%E9%83%A8%E7%BD%B2%E6%95%99%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[è¯´æ˜Žæœ¬æ–‡é‡‡ç”¨è™šæ‹ŸçŽ¯å¢ƒçš„æ–¹å¼ï¼Œæ–¹ä¾¿éƒ¨ç½²å¤šä¸ªé¡¹ç›®ã€‚1. å®‰è£…Python3æ­¤æ­¥éª¤å¯ä»¥æŸ¥çœ‹æˆ‘çš„åšå®¢ï¼šhttps://blog.ejubei.net/2019/03/14/CentOS%207.2%E5%AE%89%E8%A3%85Python3.7/æœ€ç»ˆçš„æ•ˆæžœï¼š1234567891011[root@localhost ~]# python3 -VPython 3.7.1[root@localhost ~]# pip3 -Vpip 19.1.1 from /usr/local/python3/lib/python3.7/site-packages/pip (python 3.7)[root@localhost ~]# python -VPython 2.7.5[root@localhost ~]# pip -V # é»˜è®¤python2.7æœªå®‰è£…pip-bash: pip: command not found# å®‰è£…æ–¹æ³•[root@localhost ~]# yum install epel-release[root@localhost ~]# yum install python-pip2. åˆ›å»ºé¡¹ç›®ç›®å½•ï¼Œå®‰è£…è™šæ‹ŸçŽ¯å¢ƒåˆ›å»ºé¡¹ç›®ç›®å½•ï¼Œå®‰è£…è™šæ‹ŸçŽ¯å¢ƒ[root@localhost ~]# mkdir â€“p /home/microblog &amp;&amp; cd /home/microblog &amp;&amp; python3 -m venv venvæ¿€æ´»è™šæ‹ŸçŽ¯å¢ƒï¼Œå®‰è£…é¡¹ç›®æ‰€éœ€çš„ä¾èµ–åŒ…éœ€è¦äº‹å…ˆæŠŠrequirements.txtæ”¾å…¥é¡¹ç›®æ‰€åœ¨ç›®å½•ä¸­[root@localhost microblog]# source venv/bin/activate(venv) [root@localhost microblog]# pip3 install -r requirements.txtä¸Šä¼ é¡¹ç›®ä»£ç æ¼”ç¤ºä½¿ç”¨ï¼Œæœ¬ä¾‹ç”¨ä¸€ä¸ªæœ€ç®€å•çš„flaskåº”ç”¨ï¼šmocroblog.py1234567891011#!/usr/bin/env pythonfrom flask import Flaskapp = Flask(__name__)@app.route('/')@app.route('/index')def index(): return 'Hello World!'if __name__ == '__main__': app.run(host='0.0.0.0')æµ‹è¯•1234567(venv) [root@localhost microblog]# python3 microblog.py* Serving Flask app "microblog" (lazy loading)* Environment: productionWARNING: Do not use the development server in a production environment.Use a production WSGI server instead.* Debug mode: off* Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)å†æ‰“å¼€ä¸€ä¸ªçª—å£ï¼Œè¿è¡Œï¼š1234567[root@localhost ~]# curl -i http://127.0.0.1:5000HTTP/1.0 200 OKContent-Type: text/html; charset=utf-8Content-Length: 12Server: Werkzeug/0.14.1 Python/3.7.0Date: Sat, 07 Jul 2018 03:52:31 GMTHello World!ä¸€åˆ‡æ­£å¸¸ï¼3. å®‰è£…é¡¹ç›®ä½¿ç”¨çš„webæœåŠ¡å®‰è£…nginx[root@localhost ~]# yum install nginxé»˜è®¤å®‰è£…ç›®å½•ï¼š/etc/nginxå®‰è£…supervisoræ³¨æ„ï¼šæ­¤è½¯ä»¶è¦æ±‚ç³»ç»ŸPythonç‰ˆæœ¬ä¸èƒ½é«˜äºŽ3[root@localhost ~]# yum install supervisorå®‰è£…gunicornæ³¨æ„ï¼Œè¿™ä¸ªè¦å®‰è£…åœ¨é¡¹ç›®ä½¿ç”¨çš„è™šæ‹ŸçŽ¯å¢ƒä¸­123[root@localhost nginx]# cd /home/microblog/[root@localhost microblog]# source venv/bin/activate(venv) [root@localhost microblog]# pip3 install gunicornäº”. ç›¸å…³é…ç½®æ–‡ä»¶è®¾ç½®nginxç›¸å…³é…ç½®æŠŠ/etc/nginx/nginx.confä¸­server{}å—æ³¨é‡Šï¼Œåœ¨/etc/nginx/conf.d/ç›®å½•ä¸­æ·»åŠ é¡¹ç›®ä½¿ç”¨çš„ä»¥confç»“å°¾çš„æ–‡ä»¶ï¼Œæ¯”å¦‚ï¼šm.confï¼Œå†…å®¹å¦‚ä¸‹ï¼š1234567891011121314151617181920server &#123; listen 80; #nginxç›‘å¬ç«¯å£ server_name 192.168.109.128; #åŸŸåæˆ–IP location / &#123; proxy_pass http://127.0.0.1:9000; #ç›‘å¬ä»£ç†ç«¯å£ proxy_redirect off; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; &#125;&#125;# æ£€æµ‹Nginxé…ç½®æ˜¯å¦æ­£ç¡®[root@localhost conf.d]# nginx -tnginx: the configuration file /etc/nginx/nginx.conf syntax is oknginx: configuration file /etc/nginx/nginx.conf test is successful# å¯åŠ¨Nginx[root@localhost conf.d]# systemctl start nginx.service # æŸ¥çœ‹NginxçŠ¶æ€[root@localhost conf.d]# systemctl status nginx.servicesupervisoré…ç½®é»˜è®¤é…ç½®æ–‡ä»¶ï¼š(1)/etc/supervisord.confï¼Œåœ¨è¯¥æ–‡ä»¶æœ€åŽä¸€è¡Œæœ‰è¿™æ ·çš„ä¿¡æ¯ï¼š12[include]files = supervisord.d/*.iniä¹Ÿå°±è¯´æˆ‘ä»¬åœ¨è¿™ä¸ªç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªä»¥iniç»“å°¾çš„æ–‡ä»¶å³å¯æ¯”å¦‚ï¼š/etc/supervisord.d/m.iniå…¶å†…å®¹å¦‚ä¸‹ï¼š1234567891011121314[program:microblog]directory = /home/microblogcommand = /home/microblog/venv/bin/gunicorn -b 127.0.0.1:9000 -w 2 microblog:app #ä¸€å®šè¦æ˜¯è™šæ‹ŸçŽ¯å¢ƒä¸­çš„ç»å¯¹è·¯å¾„user = rootautostart = trueautorestart = truestopasgroup = truekillasgroup = truestartsecs = 5startretries = 3redirect_stderr = truestdout_logfile_maxbytes = 20MBstdout_logfile_backups = 20stdout_logfile = /var/log/supervisord_stdout.logå¯åŠ¨ï¼šsupervisord -c /etc/supervisord.confäº”. æµ‹è¯•ä½¿ç”¨æµè§ˆå™¨è®¿é—®ï¼šipå³å¯å¾—åˆ°flaskå“åº”çš„ç»“æžœï¼Œæ³¨æ„é˜²ç«å¢™æ”¾è¡Œ80ç«¯å£å…­. å…¶ä»–è¯´æ˜Žnginx+gunicorn+flask:è¿™ç§æ¨¡å¼å°±æ˜¯ä¸ä½¿ç”¨supervisorç®¡ç†gunicornå•ç‹¬æ‰§è¡Œgunicornå‘½ä»¤ï¼šgunicorn -b 127.0.0.1:9000 microblog:appä¸ƒ. æ‰©å±•supervisorctlçš„ä½¿ç”¨supervisorctl status # æŸ¥è¯¢è¿›ç¨‹çŠ¶æ€supervisorctl stop node # å…³é—­ [program:node] çš„è¿›ç¨‹supervisorctl start node # å¯åŠ¨ [program:node] çš„è¿›ç¨‹supervisorctl restart node # é‡å¯ [program:node] çš„è¿›ç¨‹supervisorctl stop all # å…³é—­æ‰€æœ‰è¿›ç¨‹supervisorctl start all # å¯åŠ¨æ‰€æœ‰è¿›ç¨‹supervisorctl reload # é‡æ–°è¯»å–é…ç½®æ–‡ä»¶,è¯»å–æœ‰æ›´æ–°ï¼ˆå¢žåŠ ï¼‰çš„é…ç½®æ–‡ä»¶ï¼Œä¸ä¼šå¯åŠ¨æ–°æ·»åŠ çš„ç¨‹åºsupervisorctl update # é‡å¯é…ç½®æ–‡ä»¶ä¿®æ”¹è¿‡çš„ç¨‹åºå¸¸è§çš„gunicorné…ç½®[program:microblog]directory = /home/microblog; ç¨‹åºçš„å¯åŠ¨ç›®å½•command = gunicorn -c gunicorn.py wsgi:app ; å¯åŠ¨å‘½ä»¤ï¼Œå¯ä»¥çœ‹å‡ºä¸Žæ‰‹åŠ¨åœ¨å‘½ä»¤è¡Œå¯åŠ¨çš„å‘½ä»¤æ˜¯ä¸€æ ·çš„autostart = true ; åœ¨ supervisord å¯åŠ¨çš„æ—¶å€™ä¹Ÿè‡ªåŠ¨å¯åŠ¨startsecs = 5 ; å¯åŠ¨ 5 ç§’åŽæ²¡æœ‰å¼‚å¸¸é€€å‡ºï¼Œå°±å½“ä½œå·²ç»æ­£å¸¸å¯åŠ¨äº†autorestart = true ; ç¨‹åºå¼‚å¸¸é€€å‡ºåŽè‡ªåŠ¨é‡å¯startretries = 3 ; å¯åŠ¨å¤±è´¥è‡ªåŠ¨é‡è¯•æ¬¡æ•°ï¼Œé»˜è®¤æ˜¯ 3user = leon ; ç”¨å“ªä¸ªç”¨æˆ·å¯åŠ¨redirect_stderr = true ; æŠŠ stderr é‡å®šå‘åˆ° stdoutï¼Œé»˜è®¤ falsestdout_logfile_maxbytes = 20MB ; stdout æ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œé»˜è®¤ 50MBstdout_logfile_backups = 20 ; stdout æ—¥å¿—æ–‡ä»¶å¤‡ä»½æ•°; stdout æ—¥å¿—æ–‡ä»¶ï¼Œéœ€è¦æ³¨æ„å½“æŒ‡å®šç›®å½•ä¸å­˜åœ¨æ—¶æ— æ³•æ­£å¸¸å¯åŠ¨ï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨åˆ›å»ºç›®å½•ï¼ˆsupervisord ä¼šè‡ªåŠ¨åˆ›å»ºæ—¥å¿—æ–‡ä»¶ï¼‰stdout_logfile = /data/logs/usercenter_stdout.logè‹¥æ˜¯é¡¹ç›®ä¸­æ²¡æœ‰è®¾ç½®debug=Trueï¼Œåˆ™æ›´æ”¹é¡¹ç›®å†…å®¹åŽæƒ³çœ‹åˆ°æ•ˆæžœéœ€è¦é‡è½½ä¸€ä¸‹supervisoræœåŠ¡supervisorctl reloadå…¶ä»–åˆ«äººçš„é…ç½®ç½‘å€ï¼šhttps://github.com/seasonstar/bibiThis based on Ubuntu/Debianï¼Œplease skip if you had set up Python 3 environment.123456789101112131415161718192021222324# å®‰è£…python3çŽ¯å¢ƒsudo apt-get updatesudo apt-get install python3-pip python3-devsudo apt-get install build-essential libssl-dev libffi-dev python-dev#å®‰è£…virtualenvsudo pip3 install virtualenv virtualenvwrapperecho "export VIRTUALENVWRAPPER_PYTHON=/usr/bin/python3" &gt;&gt; ~/.bashrcecho "export WORKON_HOME=~/Env" &gt;&gt; ~/.bashrcecho "source /usr/local/bin/virtualenvwrapper.sh" &gt;&gt; ~/.bashrcsource ~/.bashrc# çŽ°åœ¨ä½ çš„homeç›®å½•ä¸‹æœ‰Envçš„æ–‡ä»¶å¤¹ï¼Œä½ çš„pythonè™šæ‹ŸçŽ¯å¢ƒéƒ½ä¼šåˆ›å»ºåœ¨è¿™é‡Œmkvirtualenv bibi # bibiå¯éšä¾¿æ”¹æˆä½ çš„é¡¹ç›®åworkon bibi # çŽ°åœ¨å·²è¿›å…¥é¡¹ç›®çš„ç‹¬ç«‹çŽ¯å¢ƒ# å®‰è£… mongodb ç•¥ (è¯·å®‰è£…mongodb 2.6ç‰ˆæœ¬)# å®‰è£… redis ç•¥# å®‰è£… rabbitMQ ç•¥mongod &amp; # å¯åŠ¨mongodbredis-server &amp; # å¯åŠ¨redisrabbitmq-server &amp; # å¯åŠ¨RabbitMQå®‰è£…ä¾èµ–pip3 install -r requirements.txtåˆå§‹åŒ–æ•°æ®åº“1234567python3 manage.py shell# into Python3 shell&gt;&gt;&gt; from application.models import User&gt;&gt;&gt; user = User.create(email="xxxx@xxx.com", password="xxx", name="xxxx")# email, password, nameæ”¹æˆä½ è‡ªå·±çš„&gt;&gt;&gt; user.roles.append("ADMIN")&gt;&gt;&gt; user.save()è¿è¡Œ1234# å¯åŠ¨ celerycelery -A application.cel worker -l info &amp;python3 manage.py runserveræœ¬åœ°å¯ä»¥æ‰“å¼€ http://127.0.0.1:5000/admin/éƒ¨ç½²æ–¹å¼1234# å®‰è£… supervisorsudo apt-get install supervisor# å®‰è£… gunicornpip3 install gunicornåˆ›å»ºsupervisoré…ç½®12345678910111213sudo vim /etc/supervisor/conf.d/bibi.conf[program:bibi]command=/root/Env/bibi/bin/gunicorn -w 3 -b 0.0.0.0:8080 --log-level debug "application.app:create_app()"directory=/opt/py-maybi/ ; ä½ çš„é¡¹ç›®ä»£ç ç›®å½•autostart=false ; æ˜¯å¦è‡ªåŠ¨å¯åŠ¨autorestart=false ; æ˜¯å¦è‡ªåŠ¨é‡å¯stdout_logfile=/opt/logs/gunicorn.log ; log æ—¥å¿—PS: ä¸Šé¢ -w ä¸º å¼€å¯workersæ•°ï¼Œå…¬å¼ï¼šï¼ˆç³»ç»Ÿå†…æ ¸æ•°*2 + 1)åˆ›å»ºnginxé…ç½®12345678910111213sudo vim /etc/nginx/sites-enabled/bibi.confserver &#123; listen 80; server_name bigbang.maybi.cn; # è¿™æ˜¯HOSTæœºå™¨çš„å¤–éƒ¨åŸŸåï¼Œç”¨åœ°å€ä¹Ÿè¡Œ location / &#123; proxy_pass http://127.0.0.1:8080; # è¿™é‡Œæ˜¯æŒ‡å‘ gunicorn host çš„æœåŠ¡åœ°å€ proxy_set_header Host $host; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; &#125; &#125;æŽ¥ç€å¯åŠ¨ supervisor, nginx123sudo supervisorctl reloadsudo supervisorctl start bibisudo service nginx restart]]></content>
      <categories>
        <category>CentOS</category>
        <category>Nginx</category>
        <category>supervisor</category>
        <category>gunicorn</category>
        <category>Flask</category>
      </categories>
      <tags>
        <tag>CentOS</tag>
        <tag>Nginx</tag>
        <tag>Flask</tag>
        <tag>supervisor</tag>
        <tag>gunicorn</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CentOS+Nginx+Uwsgi+Flaskéƒ¨ç½²æ•™ç¨‹]]></title>
    <url>%2F2019%2F06%2F24%2FCentOS-Nginx-Uwsgi-Flask%E9%83%A8%E7%BD%B2%E6%95%99%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[è¯´æ˜Žæœ¬æ–‡æ²¡æœ‰é‡‡ç”¨è™šæ‹ŸçŽ¯å¢ƒçš„æ–¹å¼ï¼Œè‹¥éœ€è¦éƒ¨ç½²å¤šä¸ªé¡¹ç›®ï¼Œåˆ™éœ€è¦è€ƒè™‘ä½¿ç”¨è™šæ‹ŸçŽ¯å¢ƒçš„æ–¹å¼éƒ¨ç½²ã€‚1. å®‰è£…Python3æ­¤æ­¥éª¤å¯ä»¥æŸ¥çœ‹æˆ‘çš„åšå®¢ï¼šhttps://blog.ejubei.net/2019/03/14/CentOS%207.2%E5%AE%89%E8%A3%85Python3.7/æœ€ç»ˆçš„æ•ˆæžœï¼š1234567891011[root@localhost ~]# python3 -VPython 3.7.1[root@localhost ~]# pip3 -Vpip 19.1.1 from /usr/local/python3/lib/python3.7/site-packages/pip (python 3.7)[root@localhost ~]# python -VPython 2.7.5[root@localhost ~]# pip -V # é»˜è®¤python2.7æœªå®‰è£…pip-bash: pip: command not found# å®‰è£…æ–¹æ³•[root@localhost ~]# yum install epel-release[root@localhost ~]# yum install python-pip2. ä¸Šä¼ é¡¹ç›®ä»£ç åˆ°æœåŠ¡å™¨è¿™é‡Œé‡‡ç”¨æœ€ç®€å•çš„Flaskç¨‹åºï¼š12345678910#!/usr/bin/env pythonfrom flask import Flaskapp = Flask(__name__)@app.route('/')def hello_world(): return 'Hello World!'if __name__ == '__main__': app.run(host='0.0.0.0',port=5000)1234567891011121314[root@localhost ~]# cd /home/[root@localhost home]# mkdir ysb[root@localhost home]# cd ysb/[root@localhost ysb]# cat ysb.py#!/usr/bin/env pythonfrom flask import Flaskapp = Flask(__name__)@app.route('/')def hello_world(): return 'Hello World!'if __name__ == '__main__': app.run(host='0.0.0.0',port=5000)ç¨‹åºæ–‡ä»¶æ”¾åœ¨/home/ysbç›®å½•ä¸‹ã€‚å®‰è£…ä¾èµ–åŒ…ï¼špip3 install flaskæ£€æŸ¥ç¨‹åºæ˜¯å¦æ­£å¸¸è¿è¡Œï¼špython3 ysb.py3. å®‰è£…é…ç½®uwsgiæ³¨æ„ï¼šé‡‡ç”¨pipçš„æ–¹å¼å®‰è£…ï¼Œä¸é‡‡ç”¨yumæ–¹å¼å®‰è£…ã€‚123456789101112131415161718192021222324252627# å®‰è£…uswgi[root@localhost ysb]# pip3 install uwsgi# æŸ¥çœ‹uwsgiå®‰è£…è·¯å¾„ï¼Œåˆ›å»ºè½¯è¿žæŽ¥[root@localhost ysb]# find / -name uwsgi/usr/local/python3/bin/uwsgi[root@localhost ysb]# ln -s /usr/local/python3/bin/uwsgi /usr/bin/uwsgi[root@localhost ysb]# uwsgi --version2.0.18# åˆ›å»ºå¹¶é…ç½®uwsgié…ç½®æ–‡ä»¶ï¼Œæ–°å»ºä¸“é—¨çš„ä¸€ä¸ªuwsgiç›®å½•ç”¨æ¥å­˜æ”¾ç›¸å…³æ–‡ä»¶[root@localhost ysb]# mkdir /etc/uwsgi[root@localhost uwsgi]# cat uwsgi.ini [uwsgi]socket = 127.0.0.1:5000chdir = /home/ysb/wsgi-file = app.pycallable = appprocesses = 4daemonize = /tmp/uwsgiServer.logvacuum = truelog-maxsize = 5000disable-logging = truemaster=trueuid=nginxgid=nginxpy-autoreload=1stats=/etc/uwsgi/uwsgi.statuspidfile=/etc/uwsgi/uwsgi.piduwsgi.inié…ç½®æ–‡ä»¶å‚æ•°è§£æžï¼šsocketï¼šuwsgiç›‘å¬çš„socketï¼Œå¯ä»¥ä¸ºsocketæ–‡ä»¶æˆ–ipåœ°å€+ç«¯å£å·ï¼Œåœ¨è¿™é‡ŒæŒ‡å®šä¸º127.0.0.1:5000ï¼Œè¿™æ ·å°±ä¼šç›‘å¬åˆ°ç½‘ç»œå¥—æŽ¥å­—ï¼Œè·ŸNginxé…ç½®æ–‡ä»¶ä¸­ç›‘å¬çš„ä¿æŒä¸€è‡´ã€‚è‹¥æ˜¯ä½¿ç”¨socketæ–‡ä»¶ï¼Œæ¯”å¦‚socket =/web/script/uwsgi.sockï¼Œè¿˜éœ€è¦è®¾ç½®chmod-socket = 755(socketæƒé™è®¾ç½®)chdirï¼šåœ¨appåŠ è½½å‰åˆ‡æ¢åˆ°å½“å‰ç›®å½•ï¼Œ æŒ‡å®šè¿è¡Œç›®å½•wsgi-fileï¼šä¸»ç¨‹åºæ–‡ä»¶callableï¼šä¸»ç¨‹åºä¸­çš„å˜é‡åprocessesï¼šå¼€å¯çš„è¿›ç¨‹æ•°é‡ï¼ˆå’Œworkerä½œç”¨ç›¸åŒï¼‰daemonizeï¼šä½¿è¿›ç¨‹åœ¨åŽå°è¿è¡Œï¼Œå¹¶å°†æ—¥å¿—æ‰“åˆ°æŒ‡å®šçš„æ—¥å¿—æ–‡ä»¶æˆ–è€…udpæœåŠ¡å™¨ï¼ˆä¸ä¼šå½±å“nginxæ—¥å¿—çš„è¾“å‡ºï¼‰vacuumï¼šå½“æœåŠ¡åœæ­¢çš„æ—¶å€™è‡ªåŠ¨ç§»é™¤unix Socket å’Œ Pid æ–‡ä»¶log-maxsizeï¼šè®¾ç½®æœ€å¤§æ—¥å¿—æ–‡ä»¶å¤§å°disable-loggingï¼šç¦ç”¨è¯·æ±‚æ—¥å¿—è®°å½•masterï¼šå¯åŠ¨ä¸€ä¸ªmasterè¿›ç¨‹æ¥ç®¡ç†å…¶ä»–è¿›ç¨‹ï¼Œä»¥ä¸Šè¿°é…ç½®ä¸ºä¾‹ï¼Œå…¶ä¸­çš„4ä¸ªuwsgiè¿›ç¨‹éƒ½æ˜¯è¿™ä¸ªmasterè¿›ç¨‹çš„å­è¿›ç¨‹ï¼Œå¦‚æžœkillè¿™ä¸ªmasterè¿›ç¨‹ï¼Œç›¸å½“äºŽé‡å¯æ‰€æœ‰çš„uwsgiè¿›ç¨‹uidï¼šuwsgiå¯åŠ¨ç”¨æˆ·ågidï¼šuwsgiå¯åŠ¨ç”¨æˆ·ç»„py-autoreloadï¼šç›‘æŽ§pythonæ¨¡å—mtimeæ¥è§¦å‘é‡è½½ (åªåœ¨å¼€å‘æ—¶ä½¿ç”¨)statsï¼šçŠ¶æ€æ–‡ä»¶pidfileï¼šæŒ‡å®špidæ–‡ä»¶å…¶ä»–å‚æ•°ï¼šthunder-lockï¼šåºåˆ—åŒ–æŽ¥å—çš„å†…å®¹(thunder-lock = true)enable-threadsï¼šå…è®¸ç”¨å†…åµŒçš„è¯­è¨€å¯åŠ¨çº¿ç¨‹ã€‚è¿™å°†å…è®¸ä½ åœ¨appç¨‹åºä¸­äº§ç”Ÿä¸€ä¸ªå­çº¿ç¨‹ï¼ˆenable-threads = trueï¼‰post-bufferingï¼šè®¾ç½®ç¼“å†²(post-buffering = 4096)static-mapï¼šè®¾ç½®é™æ€æ–‡ä»¶è·¯å¾„ï¼ˆstatic-map = /static=//www/wwwroot/mysite/staticï¼‰socket-timeoutï¼šä¸ºæ‰€æœ‰çš„socketæ“ä½œè®¾ç½®å†…éƒ¨è¶…æ—¶æ—¶é—´ï¼ˆé»˜è®¤4ç§’ï¼‰ï¼Œè¿™ä¸ªé…ç½®ä¼šç»“æŸé‚£äº›å¤„äºŽä¸æ´»åŠ¨çŠ¶æ€è¶…è¿‡10ç§’çš„è¿žæŽ¥ã€‚harakiriï¼šä¸€ä¸ªè¯·æ±‚èŠ±è´¹çš„æ—¶é—´è¶…è¿‡äº†è¿™ä¸ªharakiriè¶…æ—¶æ—¶é—´ï¼Œé‚£ä¹ˆè¿™ä¸ªè¯·æ±‚éƒ½ä¼šè¢«ä¸¢å¼ƒï¼Œå¹¶ä¸”å½“å‰å¤„ç†è¿™ä¸ªè¯·æ±‚çš„å·¥ä½œè¿›ç¨‹ä¼šè¢«å›žæ”¶å†åˆ©ç”¨ï¼ˆå³é‡å¯ï¼‰(harakiri = 30)buffer-sizeï¼šè®¾ç½®ç”¨äºŽuwsgiåŒ…è§£æžçš„å†…éƒ¨ç¼“å­˜åŒºå¤§å°ä¸º64kã€‚é»˜è®¤æ˜¯4kã€‚(buffer-size = 32768)listenï¼šè®¾ç½®socketçš„ç›‘å¬é˜Ÿåˆ—å¤§å°ï¼ˆé»˜è®¤ï¼š100ï¼‰(listen = 120)reload-mercyï¼šè®¾ç½®åœ¨å¹³æ»‘çš„é‡å¯ï¼ˆç›´åˆ°æŽ¥æ”¶åˆ°çš„è¯·æ±‚å¤„ç†å®Œæ‰é‡å¯ï¼‰ä¸€ä¸ªå·¥ä½œå­è¿›ç¨‹ä¸­ï¼Œç­‰å¾…è¿™ä¸ªå·¥ä½œç»“æŸçš„æœ€é•¿ç§’æ•°ã€‚è¿™ä¸ªé…ç½®ä¼šä½¿åœ¨å¹³æ»‘åœ°é‡å¯å·¥ä½œå­è¿›ç¨‹ä¸­ï¼Œå¦‚æžœå·¥ä½œè¿›ç¨‹ç»“æŸæ—¶é—´è¶…è¿‡äº†8ç§’å°±ä¼šè¢«å¼ºè¡Œç»“æŸï¼ˆå¿½ç•¥ä¹‹å‰å·²ç»æŽ¥æ”¶åˆ°çš„è¯·æ±‚è€Œç›´æŽ¥ç»“æŸï¼‰(reload-mercy = 8)max-requestsï¼šä¸ºæ¯ä¸ªå·¥ä½œè¿›ç¨‹è®¾ç½®è¯·æ±‚æ•°çš„ä¸Šé™ã€‚å½“ä¸€ä¸ªå·¥ä½œè¿›ç¨‹å¤„ç†çš„è¯·æ±‚æ•°è¾¾åˆ°è¿™ä¸ªå€¼ï¼Œé‚£ä¹ˆè¯¥å·¥ä½œè¿›ç¨‹å°±ä¼šè¢«å›žæ”¶é‡ç”¨ï¼ˆé‡å¯ï¼‰ã€‚ä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªé€‰é¡¹æ¥é»˜é»˜åœ°å¯¹æŠ—å†…å­˜æ³„æ¼(max-requests = 5000)limit-asï¼šé€šè¿‡ä½¿ç”¨POSIX/UNIXçš„setrlimit()å‡½æ•°æ¥é™åˆ¶æ¯ä¸ªuWSGIè¿›ç¨‹çš„è™šæ‹Ÿå†…å­˜ä½¿ç”¨æ•°ã€‚è¿™ä¸ªé…ç½®ä¼šé™åˆ¶uWSGIçš„è¿›ç¨‹å ç”¨è™šæ‹Ÿå†…å­˜ä¸è¶…è¿‡256Mã€‚å¦‚æžœè™šæ‹Ÿå†…å­˜å·²ç»è¾¾åˆ°256Mï¼Œå¹¶ç»§ç»­ç”³è¯·è™šæ‹Ÿå†…å­˜åˆ™ä¼šä½¿ç¨‹åºæŠ¥å†…å­˜é”™è¯¯ï¼Œæœ¬æ¬¡çš„httpè¯·æ±‚å°†è¿”å›ž500é”™è¯¯ã€‚(limit-as = 256 )4. å®‰è£…é…ç½®Nginx1234567891011121314151617181920212223# å®‰è£…Nginx[root@localhost ~]# yum install nginx# ä¿®æ”¹nginx.confé…ç½®æ–‡ä»¶# æŠŠè‡ªå¸¦çš„server&#123;&#125;å—æ³¨é‡ŠæŽ‰ï¼Œç„¶åŽåœ¨/etc/nginx/conf.d/ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªä»¥confç»“å°¾çš„æ–‡ä»¶ï¼Œæ¯”å¦‚ysb.conf[root@localhost conf.d]# cat ysb.conf server &#123; listen 80; server_name 192.168.0.139; location / &#123; include uwsgi_params; uwsgi_pass 127.0.0.1:5000; &#125;&#125;# æ£€æµ‹Nginxé…ç½®æ˜¯å¦æ­£ç¡®[root@localhost conf.d]# nginx -tnginx: the configuration file /etc/nginx/nginx.conf syntax is oknginx: configuration file /etc/nginx/nginx.conf test is successful# å¯åŠ¨Nginx[root@localhost conf.d]# systemctl start nginx.service # æŸ¥çœ‹NginxçŠ¶æ€[root@localhost conf.d]# systemctl status nginx.service5. uwsgiæ“ä½œç›¸å…³123456# å¯åŠ¨[root@localhost ysb]# uwsgi --ini uwsgi.ini# é‡å¯[root@localhost ysb]# uwsgi --reload uwsgi.pid# å…³é—­[root@localhost ysb]# uwsgi --stop uwsgi.pidä½†æ˜¯uwsgiå¯åŠ¨åŽæŠ¥é”™ï¼Œé€šè¿‡æŸ¥çœ‹logæ—¥å¿—æ–‡ä»¶å¯çŸ¥ï¼š123456789*** uWSGI is running in multiple interpreter mode ***spawned uWSGI master process (pid: 20234)spawned uWSGI worker 1 (pid: 20235, cores: 1)spawned uWSGI worker 2 (pid: 20236, cores: 1)spawned uWSGI worker 3 (pid: 20237, cores: 1)spawned uWSGI worker 4 (pid: 20238, cores: 1)bind(): Permission denied [core/socket.c line 230]...brutally killing workers...unlink(): No such file or directory [core/uwsgi.c line 1673]ç»æŽ’æŸ¥ï¼Œæ˜¯å› ä¸ºnginxç”¨æˆ·å¯¹/etc/uwsgi/ç›®å½•æ²¡æœ‰ç›¸å…³æƒé™é€ æˆçš„ã€‚(å‰ææ¡ä»¶ï¼šå·²å…³é—­SElinux)æ‰€ä»¥è¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š12[root@localhost ~]# chown -R nginx:nginx /etc/uwsgi/[root@localhost ~]# chown -R nginx:nginx /home/ysb/ç„¶åŽå†è¿è¡Œï¼š[root@localhost ~]# uwsgi --ini /etc/uwsgi/uwsgi.iniæŸ¥çœ‹çŠ¶æ€ï¼š12345[root@localhost etc]# netstat -tulnpActive Internet connections (only servers)Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 127.0.0.1:5000 0.0.0.0:* LISTEN 20970/uwsgi tcp 0 0 0.0.0.0:80 0.0.0.0:* LISTEN 19713/nginx: masterç„¶åŽç”¨æµè§ˆå™¨è®¿é—®ipåœ°å€ï¼Œå°±èƒ½å‡ºçŽ°â€™Hello World!â€™6. å¸¸è§é—®é¢˜1. è®¿é—®æµè§ˆå™¨å‡ºçŽ°502é”™è¯¯ï¼ŒæŸ¥çœ‹nginxé”™è¯¯æ—¥å¿—æç¤ºæƒé™ç¦æ­¢è€ƒè™‘å…³é—­SElinux2. è¿è¡Œuwsgiå‡ºçŽ°é”™è¯¯ï¼šbind(): Permission denied [core/socket.c line 230]è¿™æ˜¯å› ä¸ºnginxç”¨æˆ·å¯¹uwsgiæ–‡ä»¶æ²¡æœ‰ç›¸å…³æƒé™ï¼Œä¿®æ”¹å…¶æ‰€å±žç”¨æˆ·å’Œç”¨æˆ·ç»„ä¸ºnginxå³å¯]]></content>
      <categories>
        <category>CentOS</category>
        <category>Nginx</category>
        <category>uwsgi</category>
        <category>Flask</category>
      </categories>
      <tags>
        <tag>CentOS</tag>
        <tag>Nginx</tag>
        <tag>uwsgi</tag>
        <tag>Flask</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨zabbixç›‘æŽ§MySQL]]></title>
    <url>%2F2019%2F06%2F17%2F%E4%BD%BF%E7%94%A8zabbix%E7%9B%91%E6%8E%A7MySQL%2F</url>
    <content type="text"><![CDATA[è¯´æ˜Žzabbix-agentå’ŒMySQLéƒ½æ˜¯ä½¿ç”¨yumæ–¹å¼è¿›è¡Œå®‰è£…çš„ï¼Œæ‰€æœ‰è·¯å¾„éƒ½ä½¿ç”¨é»˜è®¤çš„ã€‚é…ç½®.my.cnfæ–‡ä»¶.my.cnfè¿™ä¸ªæ–‡ä»¶æ˜¯zabbixè¦æ±‚çš„ç”¨äºŽå­˜æ”¾è¿žæŽ¥mysqlæ•°æ®åº“çš„è´¦æˆ·ä¿¡æ¯çš„éšè—æ–‡ä»¶ï¼Œéœ€è¦æ‰‹åŠ¨åˆ›å»ºï¼Œå…¶å­˜æ”¾ä½ç½®å¯ä»¥è‡ªå®šä¹‰ï¼Œæ­¤æ—¶è¯¥æ–‡ä»¶ä¿å­˜è·¯å¾„å¦‚ä¸‹ï¼š/etc/zabbix/etc/.my.cnfå†…å®¹å¦‚ä¸‹ï¼š1234567891011[root@localhost etc]# vim /etc/zabbix/etc/.my.cnf[mysql] #mysqlç¨‹åºè¦ä½¿ç”¨çš„è´¦æˆ·ä¿¡æ¯host=localhostuser=zabbixpassword="xxxxx" #æ­¤å¤„çš„å¯†ç å¼ºçƒˆå»ºè®®åŠ ä¸Šå¼•å·socket=/var/lib/mysql/mysql.sock #ç¡®è®¤mysqlçš„sockæ–‡ä»¶è·¯å¾„[mysqladmin]host=localhostuser=zabbixpassword="xxxxxx"socket=/var/lib/mysql/mysql.sockæä¾›mysqlçš„userparameteré…ç½®æ–‡ä»¶zabbix-agentå·²ç»è‡ªå¸¦çš„æœ‰è¯¥æ¨¡æ¿æ–‡ä»¶äº†ï¼Œè·¯å¾„ï¼š/etc/zabbix/zabbix_agentd.d/userparameter_mysql.confæŸ¥çœ‹zabbix-agenté…ç½®æ–‡ä»¶(zabbix_agentd.conf)ä¸­æ˜¯å¦åŒ…å«è¯¥æ–‡ä»¶ï¼š12[root@localhost zabbix]# cat zabbix_agentd.conf | grep 'Include'Include=/etc/zabbix/zabbix_agentd.d/*.confä¿®æ”¹mysqlçš„userparameteré…ç½®æ–‡ä»¶å°†æ–‡ä»¶ä¸­HOME=/var/lib/zabbixæ”¹æˆHOME=/etc/zabbix/etcï¼Œè¡¨ç¤ºçš„æ˜¯.my.cnfæ–‡ä»¶æ‰€åœ¨è·¯å¾„å°†å…¶ä¸­çš„æŒ‡ä»¤éƒ¨åˆ†mysqlå’Œmysqladminæ”¹æˆç»å¯¹è·¯å¾„ï¼Œåˆ†åˆ«æ˜¯/usr/bin/mysqlå’Œ/usr/bin/mysqladminï¼Œæœ€ç»ˆæ•ˆæžœå¦‚ä¸‹ï¼š12345678910UserParameter=mysql.status[*],echo &quot;show global status where Variable_name=&apos;$1&apos;;&quot; | HOME=/etc/zabbix/etc /usr/bin/mysql -N | awk&apos;&#123;print $$2&#125;&apos;UserParameter=mysql.size[*],bash -c &apos;echo &quot;select sum($(case &quot;$3&quot; in both|&quot;&quot;) echo &quot;data_length+index_length&quot;;; data|index) echo &quot;$3_length&quot;;; free) echo &quot;data_free&quot;;; esac)) from information_schema.tables$([[ &quot;$1&quot; = &quot;all&quot; || ! &quot;$1&quot; ]] || echo &quot; where table_schema=\&quot;$1\&quot;&quot;)$([[ &quot;$2&quot; = &quot;all&quot; || ! &quot;$2&quot; ]] || echo &quot;and table_name=\&quot;$2\&quot;&quot;);&quot; | HOME=/etc/zabbix/etc /usr/bin/mysql -N&apos;UserParameter=mysql.ping,HOME=/etc/zabbix/etc /usr/bin/mysqladmin ping | grep -c aliveUserParameter=mysql.version,/usr/bin/mysql -Vé‡å¯zabbix_agentdæœåŠ¡zabbix webç»™ä¸»æœºæ·»åŠ MySQLæ¨¡æ¿é…ç½®ï¼Œä¸»æœºï¼Œç‚¹å‡»ä¸»æœºåç§°ï¼Œæ¨¡æ¿ï¼Œæ·»åŠ æ¨¡æ¿ï¼šTemplate DB MySQL]]></content>
      <categories>
        <category>CentOS</category>
        <category>Zabbix</category>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>CentOS</tag>
        <tag>MySQL</tag>
        <tag>Zabbix</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[jQueryå­¦ä¹ ]]></title>
    <url>%2F2019%2F06%2F17%2FjQuery%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[1. jqueryä»‹ç»jQueryçš„ç‰ˆæœ¬åˆ†ä¸º1.xç³»åˆ—å’Œ2.xã€3.xç³»åˆ—ï¼Œ1.xç³»åˆ—å…¼å®¹ä½Žç‰ˆæœ¬çš„æµè§ˆå™¨ï¼Œ2.xã€3.xç³»åˆ—æ”¾å¼ƒæ”¯æŒä½Žç‰ˆæœ¬æµè§ˆå™¨ï¼Œç›®å‰ä½¿ç”¨æœ€å¤šçš„æ˜¯1.xç³»åˆ—çš„ã€‚jqueryæ˜¯ä¸€ä¸ªå‡½æ•°åº“ï¼Œä¸€ä¸ªjsæ–‡ä»¶ï¼Œé¡µé¢ç”¨scriptæ ‡ç­¾å¼•å…¥è¿™ä¸ªjsæ–‡ä»¶å°±å¯ä»¥ä½¿ç”¨ã€‚1&lt;script type="text/javascript" src="jquery-3.3.1.min.js"&gt;&lt;/script&gt;jqueryçš„å£å·å’Œæ„¿æœ› Write Less, Do Moreï¼ˆå†™å¾—å°‘ï¼Œåšå¾—å¤šï¼‰ã€‚1ã€å®˜æ–¹ç½‘ç«™ http://jquery.com/2ã€ç‰ˆæœ¬ä¸‹è½½ https://code.jquery.com/2. jqueryåŠ è½½å°†èŽ·å–å…ƒç´ çš„è¯­å¥å†™åˆ°é¡µé¢å¤´éƒ¨ï¼Œä¼šå› ä¸ºå…ƒç´ è¿˜æ²¡æœ‰åŠ è½½è€Œå‡ºé”™ï¼Œjqueryæä¾›äº†readyæ–¹æ³•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®ƒçš„é€Ÿåº¦æ¯”åŽŸç”Ÿçš„ window.onload æ›´å¿«ã€‚12345678910111213141516171819202122232425262728293031323334353637&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Title&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; // åŽŸç”Ÿjså†™æ³• window.onload = function () &#123; var oDiv = document.getElementById('div1'); alert('åŽŸç”Ÿå¼¹å‡ºçš„'+oDiv); &#125;; // ready æ¯”window.onload è¦å¿«ï¼š // åŽŸå› æ˜¯ï¼Œwindow.onloadæ˜¯ç­‰æ ‡ç­¾åŠ è½½å®ŒåŽï¼Œå†æ¸²æŸ“å®Œä¹‹åŽæ‰è¿è¡Œï¼Œ // readyæ˜¯ç­‰æ ‡ç­¾åŠ è½½å®ŒåŽå°±è¿è¡Œ // jqueryå†™æ³•,readyçš„å®Œæ•´å†™æ³• $(document).ready(function () &#123; var $div = $('#idv1'); alert('jqueryå¼¹å‡ºçš„'+$div); &#125;); // jqueryå†™æ³•,readyçš„ç®€å†™å†™æ³• $(function () &#123; var $div = $('#idv1'); alert('jqueryå¼¹å‡ºçš„-2'+$div); &#125;) &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div id="div1"&gt;è¿™æ˜¯ä¸€ä¸ªdivå…ƒç´ &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;2.1 jqueryå¼•å…¥å®¹æ˜“å‡ºé”™çš„å†™æ³•123456789101112131415161718&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;!-- ä¸èƒ½ç›´æŽ¥åœ¨jqueryçš„å¼•å…¥æ ‡ç­¾é‡Œå†™jsä»£ç ï¼Œéœ€è¦å¦å¤–å†™ä¸€ä¸ªscriptæ ‡ç­¾ï¼Œåœ¨è¿™ä¸ªæ ‡ç­¾é‡Œé¢å†™jsä»£ç  --&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function()&#123; &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;div id="div1"&gt;divå…ƒç´ &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;3. jqueryé€‰æ‹©å™¨jqueryç”¨æ³•æ€æƒ³ä¸€é€‰æ‹©æŸä¸ªç½‘é¡µå…ƒç´ ï¼Œç„¶åŽå¯¹å®ƒè¿›è¡ŒæŸç§æ“ä½œ3.1 jqueryé€‰æ‹©å™¨jqueryé€‰æ‹©å™¨å¯ä»¥å¿«é€Ÿåœ°é€‰æ‹©å…ƒç´ ï¼Œé€‰æ‹©è§„åˆ™å’Œcssæ ·å¼ç›¸åŒï¼Œä½¿ç”¨lengthå±žæ€§åˆ¤æ–­æ˜¯å¦é€‰æ‹©æˆåŠŸã€‚12345$('#myId') //é€‰æ‹©idä¸ºmyIdçš„ç½‘é¡µå…ƒç´ $('.myClass') // é€‰æ‹©classä¸ºmyClassçš„å…ƒç´ $('li') //é€‰æ‹©æ‰€æœ‰çš„liå…ƒç´ $('#ul1 li span') //é€‰æ‹©idä¸ºä¸ºul1å…ƒç´ ä¸‹çš„æ‰€æœ‰liä¸‹çš„spanå…ƒç´ $('input[name=first]') // é€‰æ‹©nameå±žæ€§ç­‰äºŽfirstçš„inputå…ƒç´ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function()&#123; // ä»£æ›¿cssæ”¹å˜å…ƒç´ æ ·å¼ var $div = $('#div1'); $div.css(&#123;'color':'red'&#125;); // æ ·å¼ä½¿ç”¨pythonå­—å…¸çš„å†™æ³• // ä½¿ç”¨jqueryçš„è¯ï¼Œä¸¤ä¸ªé€‰æ‹©çš„å…ƒç´ éƒ½å‘ç”Ÿå˜åŒ– var $div2 = $('.box'); $div2.css(&#123;'color':'green'&#125;); var $li = $('.list li'); // å¸¦â€œ-â€çš„æ ·å¼å±žæ€§ï¼Œå¯ä»¥å†™æˆé©¼å³°å¼ï¼Œä¹Ÿå¯ä»¥å†™æˆåŽŸå§‹ $li.css(&#123;'background-color':'pink','color':'red'&#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;div id="div1"&gt;è¿™æ˜¯ä¸€ä¸ªdivå…ƒç´ &lt;/div&gt; &lt;div class="box"&gt;è¿™æ˜¯ç¬¬äºŒä¸ªdivå…ƒç´ &lt;/div&gt; &lt;div class="box"&gt;è¿™æ˜¯ç¬¬ä¸‰ä¸ªdivå…ƒç´ &lt;/div&gt; &lt;!-- ul.list&gt;li&#123;$&#125;*8 --&gt; &lt;ul class="list"&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;3&lt;/li&gt; &lt;li&gt;4&lt;/li&gt; &lt;li&gt;5&lt;/li&gt; &lt;li&gt;6&lt;/li&gt; &lt;li&gt;7&lt;/li&gt; &lt;li&gt;8&lt;/li&gt; &lt;/ul&gt;&lt;/body&gt;&lt;/html&gt;3.2 å¯¹é€‰æ‹©é›†è¿›è¡Œè¿‡æ»¤1234$('div').has('p'); // é€‰æ‹©åŒ…å«på…ƒç´ çš„divå…ƒç´ $('div').not('.myClass'); //é€‰æ‹©classä¸ç­‰äºŽmyClassçš„divå…ƒç´ $('div').filter('.myClass'); //é€‰æ‹©classç­‰äºŽmyClassçš„divå…ƒç´ $('div').eq(5); //é€‰æ‹©ç¬¬6ä¸ªdivå…ƒç´ 1234567891011121314151617181920212223242526272829303132333435363738&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function()&#123; /* å®Œæ•´å†™æ³• var $div = $('div'); $div.css(&#123;'backgroundColor':'gold'&#125;); */ // çœç•¥å†™æ³• $('div').css(&#123;'backgroundColor':'gold'&#125;); $('div').has('p').css(&#123;'fontSize':'30px'&#125;); $('div').eq(4).css(&#123;'textIndent':'20px'&#125;); // è¿™é‡Œé¢çš„4è¡¨ç¤ºçš„æ˜¯ä»Ž0å¼€å§‹çš„ç¬¬å››ä¸ªå…ƒç´ ï¼Œåœ¨è¿™é‡ŒæŒ‡çš„æ˜¯&lt;div&gt;5&lt;/div&gt; &#125;) &lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;div&gt;1&lt;/div&gt; &lt;div&gt; &lt;p&gt;2&lt;/p&gt; &lt;/div&gt; &lt;div&gt;3&lt;/div&gt; &lt;div&gt;4&lt;/div&gt; &lt;div&gt;5&lt;/div&gt; &lt;div&gt;6&lt;/div&gt; &lt;div&gt;7&lt;/div&gt; &lt;div&gt; &lt;span&gt;8&lt;/span&gt; &lt;span class="tip"&gt;9&lt;/span&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;3.3 é€‰æ‹©é›†è½¬ç§»12345678$('div').prev(); //é€‰æ‹©divå…ƒç´ å‰é¢ç´§æŒ¨çš„åŒè¾ˆå…ƒç´ $('div').prevAll(); //é€‰æ‹©divå…ƒç´ ä¹‹å‰æ‰€æœ‰çš„åŒè¾ˆå…ƒç´ $('div').next(); //é€‰æ‹©divå…ƒç´ åŽé¢ç´§æŒ¨çš„åŒè¾ˆå…ƒç´ $('div').nextAll(); //é€‰æ‹©divå…ƒç´ åŽé¢æ‰€æœ‰çš„åŒè¾ˆå…ƒç´ $('div').parent(); //é€‰æ‹©divçš„çˆ¶å…ƒç´ $('div').children(); //é€‰æ‹©divçš„æ‰€æœ‰å­å…ƒç´ $('div').siblings(); //é€‰æ‹©divçš„åŒçº§å…ƒç´ $('div').find('.myClass'); //é€‰æ‹©divå†…çš„classç­‰äºŽmyClassçš„å…ƒç´ 123456789101112131415161718192021222324252627282930313233&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function()&#123; /* å®Œæ•´å†™æ³• var $div = $('div'); $div.css(&#123;'backgroundColor':'gold'&#125;); */ // çœç•¥å†™æ³• $('div').eq(4).prev().css(&#123;'color':'red'&#125;); $('div').find('.tip').css(&#123;'fontSize':'30px'&#125;); &#125;) &lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;div&gt;3&lt;/div&gt; &lt;div&gt;4&lt;/div&gt; &lt;div&gt;5&lt;/div&gt; &lt;div&gt;6&lt;/div&gt; &lt;div&gt;7&lt;/div&gt; &lt;div&gt; &lt;span&gt;8&lt;/span&gt; &lt;span class="tip"&gt;9&lt;/span&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;3.4 åˆ¤æ–­æ˜¯å¦é€‰æ‹©åˆ°äº†å…ƒç´ jqueryæœ‰å®¹é”™æœºåˆ¶ï¼Œå³ä½¿æ²¡æœ‰æ‰¾åˆ°å…ƒç´ ï¼Œä¹Ÿä¸ä¼šå‡ºé”™ï¼Œå¯ä»¥ç”¨lengthå±žæ€§æ¥åˆ¤æ–­æ˜¯å¦æ‰¾åˆ°äº†å…ƒç´ ,lengthç­‰äºŽ0ï¼Œå°±æ˜¯æ²¡é€‰æ‹©åˆ°å…ƒç´ ï¼Œlengthå¤§äºŽ0ï¼Œå°±æ˜¯é€‰æ‹©åˆ°äº†å…ƒç´ ã€‚123456var $div1 = $('#div1');var $div2 = $('#div2');alert($div1.length); // å¼¹å‡º1alert($div2.length); // å¼¹å‡º0......&lt;div id="div1"&gt;è¿™æ˜¯ä¸€ä¸ªdiv&lt;/div&gt;123456789101112131415161718192021222324&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function()&#123; $div = $('#div1'); alert($div.length); // æ²¡æœ‰é€‰ä¸­å…ƒç´ ï¼Œä¹Ÿä¸ä¼šæŠ¥é”™ï¼Œç¨‹åºæ­£å¸¸è¿è¡Œ $div2 = $('#div2'); alert($div2.length); // if($div2.length&gt;0) é€šè¿‡lengthå±žæ€§æ¥åˆ¤æ–­æ˜¯å¦é€‰ä¸­äº†å…ƒç´  &#125;) &lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;div id="div1"&gt;divå…ƒç´ &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;ï¼”. jqueryæ ·å¼æ“ä½œjqueryç”¨æ³•æ€æƒ³äºŒåŒä¸€ä¸ªå‡½æ•°å®Œæˆå–å€¼å’Œèµ‹å€¼4.1 æ“ä½œè¡Œé—´æ ·å¼12345678// èŽ·å–divçš„æ ·å¼$("div").css("width");$("div").css("color");//è®¾ç½®divçš„æ ·å¼$("div").css("width","30px"); // æ²¡æœ‰ç”¨å¤§æ‹¬å·ï¼Œä¸­é—´æ˜¯é€—å·$("div").css(&#123;"width":"30px"&#125;); // ä½¿ç”¨å¤§æ‹¬å·ï¼Œä¸­é—´æ˜¯å†’å·$("div").css(&#123;fontSize:"30px",color:"red"&#125;);ç‰¹åˆ«æ³¨æ„é€‰æ‹©å™¨èŽ·å–çš„å¤šä¸ªå…ƒç´ ï¼ŒèŽ·å–ä¿¡æ¯èŽ·å–çš„æ˜¯ç¬¬ä¸€ä¸ªï¼Œæ¯”å¦‚ï¼š$(â€œdivâ€).css(â€œwidthâ€)ï¼ŒèŽ·å–çš„æ˜¯ç¬¬ä¸€ä¸ªdivçš„widthã€‚1234567891011121314151617181920212223242526272829303132&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function()&#123; var $div = $('#box'); // è¯»å–å±žæ€§å€¼ var sTr = $div.css('fontSize'); alert(sTr); // å†™å±žæ€§å€¼ $div.css(&#123;'color':'red','backgroundColor':'pink','fontSize':'20px'&#125;); /* åŽŸç”Ÿjsæ— æ³•è¯»å–è¡Œé—´æ²¡æœ‰å®šä¹‰çš„csså±žæ€§å€¼ var oDiv = document.getElementById('box'); alert(oDiv.style.fontSize); */ &#125;) &lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;div id="box"&gt;divå…ƒç´ &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;4.2 æ“ä½œæ ·å¼ç±»å1234$("#div1").addClass("divClass2") //ä¸ºidä¸ºdiv1çš„å¯¹è±¡è¿½åŠ æ ·å¼divClass2$("#div1").removeClass("divClass") //ç§»é™¤idä¸ºdiv1çš„å¯¹è±¡çš„classåä¸ºdivClassçš„æ ·å¼$("#div1").removeClass("divClass divClass2") //ç§»é™¤å¤šä¸ªæ ·å¼$("#div1").toggleClass("anotherClass") //é‡å¤åˆ‡æ¢anotherClassæ ·å¼123456789101112131415161718192021222324252627282930313233343536373839404142&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function()&#123; var $div = $('.box'); // åœ¨åŽŸæ¥æ ·å¼åçš„åŸºç¡€ä¸ŠåŠ ä¸Šâ€œbigâ€çš„æ ·å¼å $div.addClass('big'); // åœ¨åŽŸæ¥æ ·å¼åçš„åŸºç¡€ä¸ŠåŽ»æŽ‰â€œredâ€çš„æ ·å¼å $div.removeClass('red'); &#125;) &lt;/script&gt; &lt;style type="text/css"&gt; .box&#123; width:100px; height:100px; background-color:gold; &#125; .big&#123; font-size:30px; &#125; .red&#123; color:red; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="box red"&gt;divå…ƒç´ &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;5. ç»‘å®šclickäº‹ä»¶5.1 ç»™å…ƒç´ ç»‘å®šclickäº‹ä»¶123456$('#btn1').click(function()&#123; // å†…éƒ¨çš„thisæŒ‡çš„æ˜¯åŽŸç”Ÿå¯¹è±¡ // ä½¿ç”¨jqueryå¯¹è±¡ç”¨ $(this)&#125;)1234567891011121314151617181920212223242526272829303132333435363738394041424344&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function()&#123; // ç»‘å®šclickäº‹ä»¶ $('#btn').click(function()&#123; /* if($('.box').hasClass('col01'))&#123; $('.box').removeClass('col01'); &#125; else &#123; $('.box').addClass('col01'); &#125; */ // ç®€åŒ–æˆä¸‹é¢çš„å†™æ³•ï¼š $('.box').toggleClass('col01'); &#125;) &#125;) &lt;/script&gt; &lt;style type="text/css"&gt; .box&#123; width:200px; height:200px; background-color:gold; &#125; .col01&#123; background-color:green; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;input type="button" name="" value="åˆ‡æ¢æ ·å¼" id="btn"&gt; &lt;div class="box"&gt;divå…ƒç´ &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;5.2 èŽ·å–å…ƒç´ çš„ç´¢å¼•å€¼12345678910var $li = $('.list li').eq(1);alert($li.index()); // å¼¹å‡º1......&lt;ul class="list"&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;4&lt;/li&gt; &lt;li&gt;5&lt;/li&gt; &lt;li&gt;6&lt;/li&gt;&lt;/ul&gt;12345678910111213141516171819202122232425262728293031323334&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function()&#123; var $li = $('.list li'); //alert($li.length); // å¼¹å‡º 8 //alert($li.eq(3).index()); // å¼¹å‡º3 alert( $li.filter('.myli').index() ); // å¼¹å‡º4 &#125;) &lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;ul class="list"&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;3&lt;/li&gt; &lt;li&gt;4&lt;/li&gt; &lt;li class="myli"&gt;5&lt;/li&gt; &lt;li&gt;6&lt;/li&gt; &lt;li&gt;7&lt;/li&gt; &lt;li&gt;8&lt;/li&gt; &lt;/ul&gt;&lt;/body&gt;&lt;/html&gt;5.3 é€‰é¡¹å¡ç»ƒä¹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; var $btn = $('.btns input'); var $div = $('.cons div'); $btn.click(function () &#123; // this æŒ‡çš„æ˜¯åŽŸç”Ÿçš„thisï¼Œå®ƒè¡¨ç¤ºå½“å‰ç‚¹å‡»çš„å¯¹è±¡ï¼Œä½¿ç”¨jqueryçš„å¯¹è±¡éœ€è¦ç”¨$(this) // å½“å‰ç‚¹å‡»çš„æŒ‰é’®åŠ ä¸Šcurrentæ ·å¼åŽï¼Œé™¤äº†å½“å‰ï¼Œå…¶ä»–çš„æŒ‰é’®åŽ»æŽ‰currentæ ·å¼ $(this).addClass('current').siblings().removeClass('current'); //alert( $(this).index() ; //å¼¹å‡ºå½“å‰æŒ‰é’®çš„ç´¢å¼•å€¼ // å½“å‰ç‚¹å‡»çš„æŒ‰é’®å¯¹åº”ç´¢å¼•å€¼çš„divåŠ ä¸Šactiveæ ·å¼ï¼Œå…¶ä»–çš„åŽ»æŽ‰activeæ ·å¼ $div.eq($(this).index()).addClass('active').siblings().removeClass('active'); &#125;) &#125;) &lt;/script&gt; &lt;style type="text/css"&gt; .btns input &#123; width: 100px; height: 40px; background-color: #ddd; border: 0; &#125; .btns .current &#123; background-color: gold; &#125; .cons div &#123; width: 500px; height: 300px; background-color: gold; display: none; text-align: center; line-height: 300px; font-size: 30px; &#125; .cons .active &#123; display: block; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="btns"&gt; &lt;input type="button" name="" value="01" class="current"&gt; &lt;input type="button" name="" value="02"&gt; &lt;input type="button" name="" value="03"&gt;&lt;/div&gt;&lt;div class="cons"&gt; &lt;div class="active"&gt;é€‰é¡¹å¡ä¸€çš„å†…å®¹&lt;/div&gt; &lt;div&gt;é€‰é¡¹å¡äºŒçš„å†…å®¹&lt;/div&gt; &lt;div&gt;é€‰é¡¹å¡ä¸‰çš„å†…å®¹&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;6. jqueryç‰¹æ®Šæ•ˆæžœ123456789fadeIn() æ·¡å…¥fadeOut() æ·¡å‡ºfadeToggle() åˆ‡æ¢æ·¡å…¥æ·¡å‡ºhide() éšè—å…ƒç´ show() æ˜¾ç¤ºå…ƒç´ toggle() åˆ‡æ¢å…ƒç´ çš„å¯è§çŠ¶æ€slideDown() å‘ä¸‹å±•å¼€slideUp() å‘ä¸Šå·èµ·slideToggle() ä¾æ¬¡å±•å¼€æˆ–å·èµ·æŸä¸ªå…ƒç´ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; $('#btn').click(function () &#123; //$('.box').fadeIn(); //$('.box').fadeIn(1000,function()&#123; // alert('åŠ¨ç”»å®Œäº†ï¼'); //&#125;); $('.box').fadeToggle(1000,function()&#123; alert('åŠ¨ç”»å®Œäº†ï¼'); &#125;); // $('.box').show(); //$('.box').toggle(); //$('.box').slideDown(); //$('.box').slideToggle(1000, function () &#123; // alert('åŠ¨ç”»å®Œäº†') //&#125;); &#125;); &#125;) &lt;/script&gt; &lt;style type="text/css"&gt; .box &#123; width: 300px; height: 300px; background-color: gold; display: none; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;input type="button" name="" value="åŠ¨ç”»" id="btn"&gt; &lt;div class="box"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;7. jqueryé“¾å¼è°ƒç”¨jqueryå¯¹è±¡çš„æ–¹æ³•ä¼šåœ¨æ‰§è¡Œå®ŒåŽè¿”å›žè¿™ä¸ªjqueryå¯¹è±¡ï¼Œæ‰€æœ‰jqueryå¯¹è±¡çš„æ–¹æ³•å¯ä»¥è¿žèµ·æ¥å†™1234567$('#div1') // idä¸ºdiv1çš„å…ƒç´ .children('ul') //è¯¥å…ƒç´ ä¸‹é¢çš„ulå­å…ƒç´ .slideDown('fast') //é«˜åº¦ä»Žé›¶å˜åˆ°å®žé™…é«˜åº¦æ¥æ˜¾ç¤ºulå…ƒç´ .parent() //è·³åˆ°ulçš„çˆ¶å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯idä¸ºdiv1çš„å…ƒç´ .siblings() //è·³åˆ°div1å…ƒç´ å¹³çº§çš„æ‰€æœ‰å…„å¼Ÿå…ƒç´ .children('ul') //è¿™äº›å…„å¼Ÿå…ƒç´ ä¸­çš„ulå­å…ƒç´ .slideUp('fast'); //é«˜åº¦å®žé™…é«˜åº¦å˜æ¢åˆ°é›¶æ¥éšè—ulå…ƒç´ 7.1 å±‚çº§èœå•ç»ƒä¹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;å±‚çº§èœå•&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; $('.level1').click(function () &#123; //å½“å‰ç‚¹å‡»çš„å…ƒç´ ç´§æŒ¨çš„åŒè¾ˆå…ƒç´ å‘ä¸‹å±•å¼€ï¼Œå†è·³åˆ°æ­¤å…ƒç´ çš„çˆ¶çº§(li),å†è·³åˆ°æ­¤çˆ¶çº§çš„å…¶ä»–çš„åŒè¾ˆå…ƒç´ (li),é€‰æ‹©å…¶ä»–åŒè¾ˆå…ƒç´ (li)çš„å­å…ƒç´ ulï¼Œç„¶åŽå°†å®ƒå‘ä¸Šæ”¶èµ·ã€‚ // é€šè¿‡stop() å¯ä»¥ä¿®æ­£åå¤ç‚¹å‡»å¯¼è‡´çš„æŒç»­åŠ¨ç”»çš„é—®é¢˜ $(this).next().stop().slideToggle().parent().siblings().children('ul').slideUp(); &#125;); &#125;); &lt;/script&gt; &lt;style type="text/css"&gt; body &#123; font-family: 'Microsoft Yahei'; &#125; body, ul &#123; margin: 0px; padding: 0px; &#125; ul &#123; list-style: none; &#125; .menu &#123; width: 200px; margin: 20px auto 0; &#125; .menu .level1, .menu li ul a &#123; display: block; width: 200px; height: 30px; line-height: 30px; text-decoration: none; background-color: #3366cc; color: #fff; font-size: 16px; text-indent: 10px; &#125; .menu .level1 &#123; border-bottom: 1px solid #afc6f6; &#125; .menu li ul a &#123; font-size: 14px; text-indent: 20px; background-color: #7aa1ef; &#125; .menu li ul li &#123; border-bottom: 1px solid #afc6f6; &#125; .menu li ul &#123; display: none; &#125; .menu li ul.current &#123; display: block; &#125; .menu li ul li a:hover &#123; background-color: #f6b544; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;ul class="menu"&gt; &lt;li&gt; &lt;a href="#" class="level1"&gt;æ°´æžœ&lt;/a&gt; &lt;ul class="current"&gt; &lt;li&gt;&lt;a href="#"&gt;è‹¹æžœ&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;æ¢¨å­&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;è‘¡è„&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;ç«é¾™æžœ&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt; &lt;a href="#" class="level1"&gt;æµ·é²œ&lt;/a&gt; &lt;ul&gt; &lt;li&gt;&lt;a href="#"&gt;è›å­&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;æ‰‡è´&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;é¾™è™¾&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;è±¡æ‹”èšŒ&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt; &lt;a href="#" class="level1"&gt;è‚‰ç±»&lt;/a&gt; &lt;ul&gt; &lt;li&gt;&lt;a href="#"&gt;å†…è’™å¤ç¾Šè‚‰&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;è¿›å£ç‰›è‚‰&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;é‡ŽçŒªè‚‰&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt; &lt;a href="#" class="level1"&gt;è”¬èœ&lt;/a&gt; &lt;ul&gt; &lt;li&gt;&lt;a href="#"&gt;å¨ƒå¨ƒèœ&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;è¥¿çº¢æŸ¿&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;è¥¿èŠ¹&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;èƒ¡èåœ&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt; &lt;a href="#" class="level1"&gt;é€Ÿå†»&lt;/a&gt; &lt;ul&gt; &lt;li&gt;&lt;a href="#"&gt;å†°æ·‡æ·‹&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;æ¹¾ä»”ç å¤´&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;æµ·å‚&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="#"&gt;ç‰›è‚‰ä¸¸&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/html&gt;8. jqueryåŠ¨ç”»é€šè¿‡animateæ–¹æ³•å¯ä»¥è®¾ç½®å…ƒç´ æŸå±žæ€§å€¼ä¸Šçš„åŠ¨ç”»ï¼Œå¯ä»¥è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ªå±žæ€§å€¼ï¼ŒåŠ¨ç”»æ‰§è¡Œå®ŒæˆåŽä¼šæ‰§è¡Œä¸€ä¸ªå‡½æ•°ã€‚1234567891011121314$('#div1').animate(&#123; width:300, height:300&#125;,1000,'swing',function()&#123; alert('done!');&#125;);// å‚æ•°å¯ä»¥å†™æˆæ•°å­—è¡¨è¾¾å¼$('#div1').animate(&#123; width:'+=100', // æ¯æ¬¡åŠ 100 height:300&#125;,1000,'swing',function()&#123; alert('done!');&#125;);8.1 jqueryåŠ¨ç”»12345678910111213141516171819202122232425262728293031323334353637383940&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function()&#123; $('#btn').click(function()&#123; $('.box').animate(&#123;'width':600&#125;,1000,function()&#123; $('.box').animate(&#123;'height':400&#125;,1000,function()&#123; $('.box').animate(&#123;'opacity':0&#125;); // é€æ˜Žåº¦å˜æˆ0 &#125;); &#125;); &#125;); $('#btn2').click(function()&#123; $('.box2').stop().animate(&#123;'width':'+=100'&#125;); &#125;); &#125;); &lt;/script&gt; &lt;style type="text/css"&gt; .box,.box2&#123; width:100px; height:100px; background-color:gold; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;input type="button" name="" value="åŠ¨ç”»" id="btn"&gt; &lt;div class="box"&gt;&lt;/div&gt; &lt;br /&gt; &lt;br /&gt; &lt;input type="button" name="" value="åŠ¨ç”»" id="btn2"&gt; &lt;div class="box2"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;8.2 æ»‘åŠ¨é€‰é¡¹å¡123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; var $btn = $('.btns input'); var $slides = $('.cons .slides'); $btn.click(function () &#123; // this æŒ‡çš„æ˜¯åŽŸç”Ÿçš„thisï¼Œå®ƒè¡¨ç¤ºå½“å‰ç‚¹å‡»çš„å¯¹è±¡ï¼Œä½¿ç”¨jqueryçš„å¯¹è±¡éœ€è¦ç”¨$(this) // å½“å‰ç‚¹å‡»çš„æŒ‰é’®åŠ ä¸Šcurrentæ ·å¼åŽï¼Œé™¤äº†å½“å‰ï¼Œå…¶ä»–çš„æŒ‰é’®åŽ»æŽ‰currentæ ·å¼ $(this).addClass('current').siblings().removeClass('current'); $slides.stop().animate(&#123;'left': -500 * $(this).index()&#125;); &#125;) &#125;) &lt;/script&gt; &lt;style type="text/css"&gt; .btns input &#123; width: 100px; height: 40px; background-color: #ddd; border: 0; outline: none; &#125; .btns .current &#123; background-color: gold; &#125; .cons &#123; width: 500px; height: 300px; overflow: hidden; position: relative; &#125; .slides &#123; width: 1500px; height: 300px; position: absolute; left: 0; top: 0; &#125; .cons .slides div &#123; width: 500px; height: 300px; background-color: gold; text-align: center; line-height: 300px; font-size: 30px; float: left; &#125; .cons .active &#123; display: block; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="btns"&gt; &lt;input type="button" name="" value="01" class="current"&gt; &lt;input type="button" name="" value="02"&gt; &lt;input type="button" name="" value="03"&gt;&lt;/div&gt;&lt;div class="cons"&gt; &lt;div class="slides"&gt; &lt;div&gt;é€‰é¡¹å¡ä¸€çš„å†…å®¹&lt;/div&gt; &lt;div&gt;é€‰é¡¹å¡äºŒçš„å†…å®¹&lt;/div&gt; &lt;div&gt;é€‰é¡¹å¡ä¸‰çš„å†…å®¹&lt;/div&gt; &lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;9. å°ºå¯¸ç›¸å…³ã€æ»šåŠ¨äº‹ä»¶9.1 èŽ·å–å’Œè®¾ç½®å…ƒç´ çš„å°ºå¯¸1234width()ã€height() èŽ·å–å…ƒç´ widthå’Œheight innerWidth()ã€innerHeight() åŒ…æ‹¬paddingçš„widthå’Œheight outerWidth()ã€outerHeight() åŒ…æ‹¬paddingå’Œborderçš„widthå’Œheight outerWidth(true)ã€outerHeight(true) åŒ…æ‹¬paddingå’Œborderä»¥åŠmarginçš„widthå’Œheight1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function()&#123; var $div = $('.box'); // ç›’å­å†…å®¹çš„å°ºå¯¸ console.log($div.width()); console.log($div.height()); // ç›’å­å†…å®¹åŠ ä¸Špaddingçš„å°ºå¯¸ console.log($div.innerWidth()); console.log($div.innerHeight()); //ç›’å­çš„çœŸå®žå°ºå¯¸ï¼Œå†…å®¹å°ºå¯¸+padding+border console.log($div.outerWidth()); console.log($div.outerHeight()); // ç›’å­çš„çœŸå®žå°ºå¯¸å†åŠ ä¸Šmargin console.log($div.outerWidth(true)); console.log($div.outerHeight(true)); &#125;) &lt;/script&gt; &lt;style type="text/css"&gt; .box&#123; width:300px; height:200px; padding:20px; border:10px solid #000; margin:20px; background-color:gold; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="box"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;9.2 èŽ·å–å…ƒç´ ç›¸å¯¹é¡µé¢çš„ç»å¯¹ä½ç½®1offset()12345678910111213141516171819202122232425262728293031&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; var $div = $('.box'); $div.click(function () &#123; var oPos = $div.offset(); document.title = oPos.left + "|" + oPos.top; // åœ¨æ ‡é¢˜æ é¢æ˜¾ç¤ºå‡ºæ¥ console.log(oPos); &#125;); &#125;) &lt;/script&gt; &lt;style type="text/css"&gt; .box &#123; width: 200px; height: 200px; background-color: gold; margin: 50px auto 0; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="box"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;9.2-1 åŠ å…¥è´­ç‰©è½¦åŠ¨ç”»ç»ƒä¹ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; var $chart = $('.chart'); var $count = $('.chart em'); var $btn = $('.add'); var $point = $('.point'); var $w01 = $btn.outerWidth(); var $h01 = $btn.outerHeight(); var $w02 = $chart.outerWidth(); var $h02 = $chart.outerHeight(); $btn.click(function () &#123; var oPos01 = $btn.offset(); var oPos02 = $chart.offset(); $point.css(&#123;'left': oPos01.left + parseInt($w01 / 2) - 8, 'top': oPos01.top + parseInt($h01 / 2) - 8&#125;); $point.show(); $point.stop().animate(&#123; 'left': oPos02.left + parseInt($w02 / 2) - 8, 'top': oPos02.top + parseInt($h02 / 2) - 8 &#125;, 800, function () &#123; $point.hide(); var iNum = $count.html(); $count.html(parseInt(iNum) + 1); &#125;); &#125;) &#125;); &lt;/script&gt; &lt;style type="text/css"&gt; .chart &#123; width: 150px; height: 50px; border: 2px solid #000; text-align: center; line-height: 50px; float: right; margin-right: 100px; margin-top: 50px; &#125; .chart em &#123; font-style: normal; color: red; font-weight: bold; &#125; .add &#123; width: 100px; height: 50px; background-color: green; border: 0; color: #fff; float: left; margin-top: 300px; margin-left: 300px; &#125; .point &#123; width: 16px; height: 16px; background-color: red; position: fixed; left: 0; top: 0; display: none; z-index: 9999; border-radius: 50%; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="chart"&gt;è´­ç‰©è½¦&lt;em&gt;0&lt;/em&gt;&lt;/div&gt;&lt;input type="button" name="" value="åŠ å…¥è´­ç‰©è½¦" class="add"&gt;&lt;div class="point"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;9.3 èŽ·å–æµè§ˆå™¨å¯è§†åŒºå®½åº¦é«˜åº¦12$(window).width();$(window).height();9.4 èŽ·å–é¡µé¢æ–‡æ¡£çš„å®½åº¦é«˜åº¦å¦‚æžœé¡µé¢æœ‰æ»šåŠ¨æ¡ï¼Œåˆ™é¡µé¢æ–‡æ¡£çš„é«˜åº¦å¤§äºŽæµè§ˆå™¨å¯è§†åŒºé«˜åº¦12$(document).width();$(document).height();9.5 èŽ·å–é¡µé¢æ»šåŠ¨è·ç¦»12$(document).scrollTop(); $(document).scrollLeft();9.6 é¡µé¢æ»šåŠ¨äº‹ä»¶123$(window).scroll(function()&#123; ...... &#125;)9.6-1 ç½®é¡¶èœå•å’Œæ»šåŠ¨åˆ°é¡¶éƒ¨ç»ƒä¹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; $menu = $('.menu'); $menu_back = $('.menu_back'); $totop = $('.totop'); $(window).scroll(function () &#123; //console.log('abc'); var iNum = $(document).scrollTop(); //document.title = iNum; if (iNum &gt; 200) &#123; $menu.css(&#123; 'position': 'fixed', 'left': '50%', 'top': 0, 'marginLeft': -480 &#125;); $menu_back.show(); &#125; else &#123; $menu.css(&#123; 'position': 'static', 'marginLeft': 'auto' &#125;); $menu_back.hide(); &#125; if (iNum &gt; 400) &#123; $totop.fadeIn(); &#125; else &#123; $totop.fadeOut(); &#125; &#125;); $totop.click(function () &#123; $('html,body').animate(&#123;'scrollTop': 0&#125;); &#125;); &#125;) &lt;/script&gt; &lt;style type="text/css"&gt; body &#123; margin: 0; &#125; .banner &#123; width: 960px; height: 200px; background-color: cyan; margin: 0 auto; &#125; .menu &#123; width: 960px; height: 80px; background-color: gold; margin: 0 auto; text-align: center; line-height: 80px; &#125; .menu_back &#123; width: 960px; height: 80px; margin: 0 auto; display: none; &#125; p &#123; text-align: center; color: red; &#125; .totop &#123; width: 60px; height: 60px; background-color: #000; color: #fff; position: fixed; right: 20px; bottom: 50px; line-height: 60px; text-align: center; font-size: 40px; border-radius: 50%; cursor: pointer; display: none; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="banner"&gt;&lt;/div&gt;&lt;div class="menu"&gt;èœå•&lt;/div&gt;&lt;div class="menu_back"&gt;&lt;/div&gt;&lt;div class="totop"&gt;â†‘&lt;/div&gt;&lt;p&gt;æ–‡æ¡£å†…å®¹&lt;/p&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;..........&lt;/body&gt;&lt;/html&gt;10. jqueryå±žæ€§æ“ä½œ10.1 html() å–å‡ºæˆ–è®¾ç½®htmlå†…å®¹12345// å–å‡ºhtmlå†…å®¹var $htm = $('#div1').html();// è®¾ç½®htmlå†…å®¹$('#div1').html('&lt;span&gt;æ·»åŠ æ–‡å­—&lt;/span&gt;');10.2 prop() å–å‡ºæˆ–è®¾ç½®æŸä¸ªå±žæ€§çš„å€¼12345// å–å‡ºå›¾ç‰‡çš„ç»å¯¹åœ°å€åœ°å€var $src = $('#img1').prop('src');// è®¾ç½®å›¾ç‰‡çš„åœ°å€å’Œaltå±žæ€§$('#img1').prop(&#123;src: "test.jpg", alt: "Test Image" &#125;);1234567891011121314151617181920212223242526272829303132333435363738394041&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function()&#123; var $a = $('.link'); var $img = $('#img01'); var $div = $('#div1'); // è¯»å–classå±žæ€§å€¼ console.log( $a.prop('class')); // link // æ²¡æœ‰è®¾ç½®çš„å±žæ€§è¯»å–ä¸ºç©º console.log($a.prop('title')); // èŽ·å–æ˜¯å›¾ç‰‡çš„ç»å¯¹åœ°å€ console.log($img.prop('src')); //alert($img.prop('src')); // è®¾ç½®å±žæ€§ $a.prop(&#123;'href':'http://www.baidu.com','title':'ç™¾åº¦ç½‘é“¾æŽ¥'&#125;); //console.log($a.prop('title')); //è¯»å–æ ‡ç­¾å†…åŒ…å«çš„å†…å®¹ console.log($a.html()); // å†™å…¥æ ‡ç­¾çš„å†…å®¹ï¼Œä¼šä»£æ›¿åŽŸæ¥çš„å†…å®¹ $div.html('&lt;span&gt;divé‡Œé¢çš„spanå…ƒç´ &lt;/span&gt;'); // &lt;span&gt;divé‡Œé¢çš„spanå…ƒç´ &lt;/span&gt; &#125;) &lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;a href="#" class="link"&gt;è¿™æ˜¯ä¸€ä¸ªé“¾æŽ¥&lt;/a&gt; &lt;img src="images/002.jpg" id="img01" alt="æ°´æžœ"&gt; &lt;div id="div1"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;11. jqueryå¾ªçŽ¯å¯¹jqueryé€‰æ‹©çš„å¯¹è±¡é›†åˆåˆ†åˆ«è¿›è¡Œæ“ä½œï¼Œéœ€è¦ç”¨åˆ°jqueryå¾ªçŽ¯æ“ä½œï¼Œæ­¤æ—¶å¯ä»¥ç”¨å¯¹è±¡ä¸Šçš„eachæ–¹æ³•12345678910111213141516$(function () &#123; $('.list li').each(function (i) &#123; alert(i); // å¼¹å‡ºliæ ‡ç­¾é‡Œé¢çš„å€¼ // alert($(this).index()); // å¼¹å‡ºliæ ‡ç­¾é‡Œé¢çš„å€¼çš„ç´¢å¼• // alert($(this).html(i)); // å¼¹å‡ºobjectå¯¹è±¡ &#125;);&#125;);......&lt;ul class="list"&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;3&lt;/li&gt; &lt;li&gt;4&lt;/li&gt; &lt;li&gt;5&lt;/li&gt; &lt;li&gt;6&lt;/li&gt;&lt;/ul&gt;11.1 æ‰‹é£Žç´ç»ƒä¹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112&lt;!doctype html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; var $li = $('#accordion li'); $li.click(function () &#123; //alert($(this).html()); $(this).animate(&#123;'left': 21 * $(this).index()&#125;); //ç‚¹å‡»çš„liå‰é¢çš„liå‘å·¦è¿åŠ¨åˆ°å„è‡ªçš„ä½ç½® $(this).prevAll().each(function () &#123; //è¿™é‡Œçš„$(this)æŒ‡çš„æ˜¯å¾ªçŽ¯é€‰æ‹©çš„æ¯ä¸ªli $(this).animate(&#123;'left': 21 * $(this).index()&#125;); &#125;); // ç¬¬5ä¸ªliåœ¨å³è¾¹çš„leftå€¼ 727-21*1 ç­‰åŒäºŽ 727-21*(5-$(this).index()) // ç¬¬4ä¸ªliåœ¨å³è¾¹çš„leftå€¼ 727-21*2 ç­‰åŒäºŽ 727-21*(5-$(this).index()) // ç¬¬3ä¸ªliåœ¨å³è¾¹çš„leftå€¼ 727-21*3 ç­‰åŒäºŽ 727-21*(5-$(this).index()) $(this).nextAll().each(function () &#123; $(this).animate(&#123;'left': 727 - 21 * (5 - $(this).index())&#125;); &#125;); &#125;) &#125;) &lt;/script&gt; &lt;style&gt; * &#123; margin: 0; padding: 0; &#125; body &#123; font-size: 12px; &#125; #accordion &#123; width: 727px; height: 350px; margin: 100px auto 0 auto; position: relative; overflow: hidden; border: 1px solid #CCC; &#125; #accordion ul &#123; list-style: none; &#125; #accordion ul li &#123; width: 643px; height: 350px; position: absolute; background: #FFF; &#125; #accordion ul li span &#123; display: block; width: 20px; height: 350px; float: left; text-align: center; color: #FFF; padding-top: 5px; cursor: pointer; &#125; #accordion ul li img &#123; display: block; float: right; &#125; .bar01 &#123; left: 0px; &#125; .bar02 &#123; left: 643px; &#125; .bar03 &#123; left: 664px; &#125; .bar04 &#123; left: 685px; &#125; .bar05 &#123; left: 706px; &#125; .bar01 span &#123; background: #09E0B5; &#125; .bar02 span &#123; background: #3D7FBB; &#125; .bar03 span &#123; background: #5CA716; &#125; .bar04 span &#123; background: #F28B24; &#125; .bar05 span &#123; background: #7C0070; &#125; &lt;/style&gt; &lt;title&gt;æ‰‹é£Žç´æ•ˆæžœ&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;div id="accordion"&gt; &lt;ul&gt; &lt;li class="bar01"&gt;&lt;span&gt;éžæ´²æ™¯è‰²01&lt;/span&gt;&lt;img src="images/001.jpg" /&gt;&lt;/li&gt; &lt;li class="bar02"&gt;&lt;span&gt;éžæ´²æ™¯è‰²02&lt;/span&gt;&lt;img src="images/002.jpg" /&gt;&lt;/li&gt; &lt;li class="bar03"&gt;&lt;span&gt;éžæ´²æ™¯è‰²03&lt;/span&gt;&lt;img src="images/003.jpg" /&gt;&lt;/li&gt; &lt;li class="bar04"&gt;&lt;span&gt;éžæ´²æ™¯è‰²04&lt;/span&gt;&lt;img src="images/004.jpg" /&gt;&lt;/li&gt; &lt;li class="bar05"&gt;&lt;span&gt;éžæ´²æ™¯è‰²05&lt;/span&gt;&lt;img src="images/005.jpg" /&gt;&lt;/li&gt; &lt;/ul&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;12. jqueryäº‹ä»¶12.1 äº‹ä»¶å‡½æ•°åˆ—è¡¨123456789101112blur() å…ƒç´ å¤±åŽ»ç„¦ç‚¹focus() å…ƒç´ èŽ·å¾—ç„¦ç‚¹click() é¼ æ ‡å•å‡»mouseover() é¼ æ ‡è¿›å…¥ï¼ˆè¿›å…¥å­å…ƒç´ ä¹Ÿè§¦å‘ï¼‰mouseout() é¼ æ ‡ç¦»å¼€ï¼ˆç¦»å¼€å­å…ƒç´ ä¹Ÿè§¦å‘ï¼‰mouseenter() é¼ æ ‡è¿›å…¥ï¼ˆè¿›å…¥å­å…ƒç´ ä¸è§¦å‘ï¼‰mouseleave() é¼ æ ‡ç¦»å¼€ï¼ˆç¦»å¼€å­å…ƒç´ ä¸è§¦å‘ï¼‰hover() åŒæ—¶ä¸ºmouseenterå’Œmouseleaveäº‹ä»¶æŒ‡å®šå¤„ç†å‡½æ•°ready() DOMåŠ è½½å®Œæˆresize() æµè§ˆå™¨çª—å£çš„å¤§å°å‘ç”Ÿæ”¹å˜scroll() æ»šåŠ¨æ¡çš„ä½ç½®å‘ç”Ÿå˜åŒ–submit() ç”¨æˆ·é€’äº¤è¡¨å•12.2 ç»‘å®šäº‹ä»¶çš„å…¶ä»–æ–¹å¼12345$(function()&#123; $('#div1').bind('mouseover click', function(event) &#123; alert($(this).html()); &#125;);&#125;);12.3 å–æ¶ˆç»‘å®šäº‹ä»¶123456789$(function()&#123; $('#div1').bind('mouseover click', function(event) &#123; alert($(this).html()); // $(this).unbind(); $(this).unbind('mouseover'); &#125;);&#125;);12345678910111213141516171819202122232425262728293031&lt;!doctype html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; /* $(function () &#123; $("#btn").click(function () &#123; alert('clickäº‹ä»¶'); &#125;); &#125;); */ // ç‚¹å‡»æˆ–è€…é¼ æ ‡ç§»å…¥çš„æ—¶å€™éƒ½æ‰§è¡Œç»‘å®šçš„å‡½æ•° $(function () &#123; $("#btn").bind('click mouseover',function () &#123; alert('bindç»‘å®šclickäº‹ä»¶å’Œmouseoveré¼ æ ‡ç§»å…¥äº‹ä»¶'); $(this).unbind('mouseover'); &#125;); &#125;); &lt;/script&gt; &lt;title&gt;Documet&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;input type="button" name="" value="æŒ‰é’®" id="btn"&gt;&lt;/body&gt;&lt;/html&gt;12.4 ç„¦ç‚¹å’Œæäº¤äº‹ä»¶1234567891011121314151617181920212223242526272829303132333435363738&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; // åœ¨èŽ·å¾—ç„¦ç‚¹çš„æ—¶å€™åšä»€ä¹ˆäº‹æƒ… /*$('#input01').focus(function()&#123; alert('èŽ·å¾—ç„¦ç‚¹') &#125;)*/ //focus ä¸€èˆ¬ç”¨æ¥è®©inputå…ƒç´ å¼€å§‹å°±èŽ·å–ç„¦ç‚¹ï¼Œåªèƒ½æ˜¯ä¸€ä¸ªå…ƒç´ èŽ·å¾—ç„¦ç‚¹ $('#input01').focus(); $('#input01').blur(function () &#123; // èŽ·å–inputå…ƒç´ çš„valueå€¼ç”¨ val() var sVal = $(this).val(); alert(sVal); &#125;); $('#form1').submit(function () &#123; //alert('æäº¤'); // é˜»æ­¢é»˜è®¤çš„æäº¤è¡Œä¸º return false; &#125;); &#125;) &lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;form id="form1" action="http://www.baidu.com"&gt; &lt;input type="text" name="dat01" id="input01"&gt; &lt;input type="text" name="dat02" id="input02"&gt; &lt;input type="submit" name="" value="æäº¤" id="sub"&gt; &lt;/form&gt;&lt;/body&gt;&lt;/html&gt;12.5 é¼ æ ‡ç§»å…¥ç§»å‡ºäº‹ä»¶12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; // é¼ æ ‡ç§»å…¥ï¼Œç§»å…¥çš„å­å…ƒç´ ä¹Ÿä¼šè§¦å‘ $('.con').mouseover(function () &#123; alert('ç§»å…¥'); &#125;); $('.con').mouseout(function () &#123; alert('ç§»å‡º'); &#125;); // é¼ æ ‡ç§»å…¥ï¼Œç§»å…¥çš„å­å…ƒç´ ä¸ä¼šè§¦å‘ /* $('.con2').mouseenter(function()&#123; alert('ç§»å…¥'); &#125;) $('.con2').mouseleave(function()&#123; alert('ç§»å‡º'); &#125;) */ // åˆå¹¶æˆä¸‹é¢çš„å†™æ³•ï¼š $('.con2').hover(function () &#123; alert('ç§»å…¥') &#125;, function () &#123; alert('ç§»å‡º') &#125;) &#125;) &lt;/script&gt; &lt;style type="text/css"&gt; .con, .con2 &#123; width: 200px; height: 200px; background-color: gold; &#125; .box, .box2 &#123; width: 100px; height: 100px; background-color: green; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="con"&gt; &lt;div class="box"&gt;&lt;/div&gt; &lt;/div&gt; &lt;br/&gt; &lt;br/&gt; &lt;br/&gt; &lt;br/&gt; &lt;div class="con2"&gt; &lt;div class="box2"&gt;&lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;13. äº‹ä»¶å†’æ³¡13.1 ä»€ä¹ˆæ˜¯äº‹ä»¶å†’æ³¡åœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šè§¦å‘æŸç±»äº‹ä»¶ï¼ˆæ¯”å¦‚å•å‡»onclickäº‹ä»¶ï¼‰ï¼Œå¦‚æžœæ­¤å¯¹è±¡å®šä¹‰äº†æ­¤äº‹ä»¶çš„å¤„ç†ç¨‹åºï¼Œé‚£ä¹ˆæ­¤äº‹ä»¶å°±ä¼šè°ƒç”¨è¿™ä¸ªå¤„ç†ç¨‹åºï¼Œå¦‚æžœæ²¡æœ‰å®šä¹‰æ­¤äº‹ä»¶å¤„ç†ç¨‹åºæˆ–è€…äº‹ä»¶è¿”å›žtrueï¼Œé‚£ä¹ˆè¿™ä¸ªäº‹ä»¶ä¼šå‘è¿™ä¸ªå¯¹è±¡çš„çˆ¶çº§å¯¹è±¡ä¼ æ’­ï¼Œä»Žé‡Œåˆ°å¤–ï¼Œç›´è‡³å®ƒè¢«å¤„ç†ï¼ˆçˆ¶çº§å¯¹è±¡æ‰€æœ‰åŒç±»äº‹ä»¶éƒ½å°†è¢«æ¿€æ´»ï¼‰ï¼Œæˆ–è€…å®ƒåˆ°è¾¾äº†å¯¹è±¡å±‚æ¬¡çš„æœ€é¡¶å±‚ï¼Œå³documentå¯¹è±¡ï¼ˆæœ‰äº›æµè§ˆå™¨æ˜¯windowï¼‰ã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; // äº‹ä»¶å†’æ³¡ä¾æ®çš„æ˜¯æ ‡ç­¾ä¹‹é—´çš„å±‚çº§å…³ç³»ï¼Œä¸æ˜¯æ ‡ç­¾çš„ä½ç½® $('.son').click(function () &#123; alert(1); &#125;); $('.father').click(function () &#123; alert(2); &#125;); $('.grandfather').click(function () &#123; alert(3); &#125;); &#125;) &lt;/script&gt; &lt;style type="text/css"&gt; .grandfather &#123; width: 300px; height: 300px; background-color: green; position: relative; &#125; .father &#123; width: 200px; height: 200px; background-color: gold; &#125; .son &#123; width: 100px; height: 100px; background-color: red; position: absolute; left: 0; top: 400px; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="grandfather"&gt; &lt;div class="father"&gt; &lt;div class="son"&gt;&lt;/div&gt; &lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;13.2 äº‹ä»¶å†’æ³¡çš„ä½œç”¨äº‹ä»¶å†’æ³¡å…è®¸å¤šä¸ªæ“ä½œè¢«é›†ä¸­å¤„ç†ï¼ˆæŠŠäº‹ä»¶å¤„ç†å™¨æ·»åŠ åˆ°ä¸€ä¸ªçˆ¶çº§å…ƒç´ ä¸Šï¼Œé¿å…æŠŠäº‹ä»¶å¤„ç†å™¨æ·»åŠ åˆ°å¤šä¸ªå­çº§å…ƒç´ ä¸Šï¼‰ï¼Œå®ƒè¿˜å¯ä»¥è®©ä½ åœ¨å¯¹è±¡å±‚çš„ä¸åŒçº§åˆ«æ•èŽ·äº‹ä»¶ã€‚13.3 é˜»æ­¢äº‹ä»¶å†’æ³¡äº‹ä»¶å†’æ³¡æœºåˆ¶æœ‰æ—¶å€™æ˜¯ä¸éœ€è¦çš„ï¼Œéœ€è¦é˜»æ­¢æŽ‰ï¼Œé€šè¿‡ event.stopPropagation() æ¥é˜»æ­¢1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; // event æ˜¯å‘ç”Ÿäº‹ä»¶çš„æ—¶å€™çš„äº‹ä»¶å¯¹è±¡ï¼Œä½¿ç”¨çš„æ—¶å€™ï¼Œé€šè¿‡ç¬¬ä¸€ä¸ªå‚æ•°ä¼ è¿›æ¥ $('.son').click(function (event) &#123; alert(1); //é€šè¿‡eventå¯¹è±¡ä¸Šçš„stopPropagationçš„æ–¹æ³•é˜»æ­¢äº‹ä»¶å†’æ³¡ event.stopPropagation(); &#125;); $('.father').click(function () &#123; alert(2); &#125;); $('.grandfather').click(function () &#123; alert(3); &#125;); &#125;) &lt;/script&gt; &lt;style type="text/css"&gt; .grandfather &#123; width: 300px; height: 300px; background-color: green; position: relative; &#125; .father &#123; width: 200px; height: 200px; background-color: gold; &#125; .son &#123; width: 100px; height: 100px; background-color: red; position: absolute; left: 0; top: 400px; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="grandfather"&gt; &lt;div class="father"&gt; &lt;div class="son"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;13.4 é˜»æ­¢é»˜è®¤è¡Œä¸ºé˜»æ­¢è¡¨å•æäº¤123$(&apos;#form1&apos;).submit(function(event)&#123; event.preventDefault();&#125;)13.5 åˆå¹¶é˜»æ­¢æ“ä½œå®žé™…å¼€å‘ä¸­ï¼Œä¸€èˆ¬æŠŠé˜»æ­¢å†’æ³¡å’Œé˜»æ­¢é»˜è®¤è¡Œä¸ºåˆå¹¶èµ·æ¥å†™ï¼Œåˆå¹¶å†™æ³•å¯ä»¥ç”¨12345// event.stopPropagation();// event.preventDefault();// åˆå¹¶å†™æ³•ï¼šreturn false;13.6 è¯¾å ‚ç»ƒä¹ é¡µé¢å¼¹æ¡†ï¼ˆç‚¹å‡»å¼¹æ¡†å¤–å¼¹æ¡†å…³é—­ï¼‰ï¼Œåœ¨documentä¸Šç»‘å®šä¸€ä¸ªäº‹ä»¶123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; $('#btn').click(function () &#123; $('.pop_con').fadeIn(); return false; &#125;); $(document).click(function () &#123; $('.pop_con').fadeOut(); &#125;); $('.pop').click(function () &#123; return false; &#125;); $('#close').click(function () &#123; $('.pop_con').fadeOut(); &#125;); &#125;); &lt;/script&gt; &lt;style type="text/css"&gt; .pop_con &#123; display: none; &#125; .pop &#123; position: fixed; width: 500px; height: 300px; background-color: #fff; border: 3px solid #000; left: 50%; top: 50%; margin-left: -250px; margin-top: -150px; z-index: 9999; &#125; .mask &#123; position: fixed; width: 100%; height: 100%; background-color: #000; opacity: 0.3; filter: alpha(opacity=30); left: 0; top: 0; z-index: 9990; &#125; .close &#123; float: right; font-size: 30px; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;input type="button" name="" value="å¼¹å‡º" id="btn"&gt; &lt;div class="pop_con"&gt; &lt;div class="pop"&gt; å¼¹æ¡†é‡Œé¢æ–‡å­— æŠ•èµ„é‡‘é¢ï¼š&lt;input type="text" name=""&gt; &lt;a href="#" id="close" class="close"&gt;Ã—&lt;/a&gt; &lt;/div&gt; &lt;div class="mask"&gt;&lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;14. äº‹ä»¶å§”æ‰˜äº‹ä»¶å§”æ‰˜å°±æ˜¯åˆ©ç”¨å†’æ³¡çš„åŽŸç†ï¼ŒæŠŠäº‹ä»¶åŠ åˆ°çˆ¶çº§ä¸Šï¼Œé€šè¿‡åˆ¤æ–­äº‹ä»¶æ¥æºçš„å­é›†ï¼Œæ‰§è¡Œç›¸åº”çš„æ“ä½œï¼Œäº‹ä»¶å§”æ‰˜é¦–å…ˆå¯ä»¥æžå¤§å‡å°‘äº‹ä»¶ç»‘å®šæ¬¡æ•°ï¼Œæé«˜æ€§èƒ½ï¼›å…¶æ¬¡å¯ä»¥è®©æ–°åŠ å…¥çš„å­å…ƒç´ ä¹Ÿå¯ä»¥æ‹¥æœ‰ç›¸åŒçš„æ“ä½œã€‚14.1 ä¸€èˆ¬ç»‘å®šäº‹ä»¶çš„å†™æ³•1234567891011121314$(function()&#123; $ali = $('#list li'); $ali.click(function() &#123; $(this).css(&#123;background:'red'&#125;); &#125;);&#125;)...&lt;ul id="list"&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;3&lt;/li&gt; &lt;li&gt;4&lt;/li&gt; &lt;li&gt;5&lt;/li&gt;&lt;/ul&gt;14.2 äº‹ä»¶å§”æ‰˜çš„å†™æ³•1234567891011121314$(function()&#123; $list = $('#list'); $list.delegate('li', 'click', function() &#123; $(this).css(&#123;background:'red'&#125;); &#125;);&#125;)...&lt;ul id="list"&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;3&lt;/li&gt; &lt;li&gt;4&lt;/li&gt; &lt;li&gt;5&lt;/li&gt;&lt;/ul&gt;12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; /* // è¿™ä¸ªå†™æ³•ç›¸å½“äºŽç»‘å®š8æ¬¡ï¼Œæ¯”è¾ƒæŸè€—æ€§èƒ½ $('.list li').click(function()&#123; $(this).css(&#123;'backgroundColor':'red'&#125;); &#125;); */ // æ–°å»ºä¸€ä¸ªliå…ƒç´ èµ‹å€¼ç»™$liå˜é‡ //var $li = $('&lt;li&gt;9&lt;/li&gt;'); //è®©æ–°åŠ çš„liæœ‰ç›¸åŒçš„äº‹ä»¶ï¼Œéœ€è¦å•ç‹¬ç»‘å®š //$li.click(....) // æŠŠæ–°å»ºçš„liå…ƒç´ æ”¾åˆ°ulå­é›†çš„æœ€åŽé¢ //$('.list').append($li); //äº‹ä»¶å§”æ‰˜ï¼Œå°†liè¦å‘ç”Ÿçš„äº‹ä»¶å§”æ‰˜ç»™liçš„çˆ¶çº§ $('.list').delegate('li', 'click', function () &#123; //$(this) æŒ‡çš„æ˜¯å§”æ‰˜çš„å­å…ƒç´  $(this).css(&#123;'backgroundColor': 'red'&#125;); &#125;); var $li = $('&lt;li&gt;9&lt;/li&gt;'); $('.list').append($li); &#125;) &lt;/script&gt; &lt;style type="text/css"&gt; .list &#123; background-color: gold; list-style: none; padding: 10px; &#125; .list li &#123; height: 30px; background-color: green; margin: 10px; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;ul class="list"&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;3&lt;/li&gt; &lt;li&gt;4&lt;/li&gt; &lt;li&gt;5&lt;/li&gt; &lt;li&gt;6&lt;/li&gt; &lt;li&gt;7&lt;/li&gt; &lt;li&gt;8&lt;/li&gt; &lt;/ul&gt;&lt;/body&gt;&lt;/html&gt;15.jqueryå…ƒç´ èŠ‚ç‚¹æ“ä½œ15.1 åˆ›å»ºèŠ‚ç‚¹12var $div = $('&lt;div&gt;');var $div2 = $('&lt;div&gt;è¿™æ˜¯ä¸€ä¸ªdivå…ƒç´ &lt;/div&gt;');15.2 æ’å…¥èŠ‚ç‚¹1ã€append()å’ŒappendTo()ï¼šåœ¨çŽ°å­˜å…ƒç´ çš„å†…éƒ¨ï¼Œä»ŽåŽé¢æ’å…¥å…ƒç´ 1234var $span = $('&lt;span&gt;è¿™æ˜¯ä¸€ä¸ªspanå…ƒç´ &lt;/span&gt;');$('#div1').append($span);......&lt;div id="div1"&gt;&lt;/div&gt;2ã€prepend()å’ŒprependTo()ï¼šåœ¨çŽ°å­˜å…ƒç´ çš„å†…éƒ¨ï¼Œä»Žå‰é¢æ’å…¥å…ƒç´ 3ã€after()å’ŒinsertAfter()ï¼šåœ¨çŽ°å­˜å…ƒç´ çš„å¤–éƒ¨ï¼Œä»ŽåŽé¢æ’å…¥å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯åœ¨çŽ°å­˜å…ƒç´ çš„çˆ¶çº§å…ƒç´ åŽé¢æ’å…¥æ–°å…ƒç´ 4ã€before()å’ŒinsertBefore()ï¼šåœ¨çŽ°å­˜å…ƒç´ çš„å¤–éƒ¨ï¼Œä»Žå‰é¢æ’å…¥å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯åœ¨çŽ°å­˜å…ƒç´ çš„çˆ¶çº§å…ƒç´ å‰é¢æ’å…¥æ–°å…ƒç´ æ³¨æ„ï¼šå¯¹å·²æœ‰çš„èŠ‚ç‚¹è¿›è¡Œä¸Šè¿°æ“ä½œçš„è¯æ˜¯å‰ªåˆ‡å†ç²˜è´´ã€‚12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function()&#123; // æ–°å¢žèŠ‚ç‚¹æ“ä½œ // é€šè¿‡htmlçš„å­—ç¬¦ä¸²çš„æ–¹å¼æ·»åŠ èŠ‚ç‚¹æ€§èƒ½æœ€é«˜ // å¦‚ä¸‹çš„è¿™ç§æ–¹å¼ä¼šæ›¿æ¢æŽ‰åŽŸæ¥çš„ //$('#div1').html('&lt;a href="#"&gt;é“¾æŽ¥&lt;/a&gt;') // å…ˆèŽ·å–åˆ°åŽŸæ¥çš„ï¼Œç„¶åŽä½¿ç”¨+æ‹¼æŽ¥èµ·æ¥ //$('#div1').html($('#div1').html()+'&lt;a href="#"&gt;é“¾æŽ¥&lt;/a&gt;') // æ–°å»ºä¸€ä¸ªå¸¦æœ‰å±žæ€§çš„aå…ƒç´ ï¼ŒæŠŠå®ƒèµ‹å€¼ç»™$a $a = $('&lt;a href="#"&gt;é“¾æŽ¥&lt;/a&gt;'); // çˆ¶å…ƒç´ å†…çš„åŽé¢æ”¾å…¥å­å…ƒç´  // $('#div1').append($a); //å­å…ƒç´ æ”¾å…¥åˆ°çˆ¶å…ƒç´ å†…éƒ¨çš„åŽé¢ $a.appendTo($('#div1')); // å®žé™…ç»“æžœè·Ÿ$('#div1').append($a);ä¸€æ · // æ–°å»ºä¸€ä¸ªç©ºçš„aå…ƒç´  $a2 = $('&lt;a&gt;'); $('#div1').append($a2); // å®žé™…æ•ˆæžœï¼š&lt;a&gt;&lt;/a&gt; $p = $('&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªpå…ƒç´ &lt;/p&gt;'); // çˆ¶å…ƒç´ å†…çš„å‰é¢æ”¾å…¥å­å…ƒç´  //$('#div1').prepend($p); //å­å…ƒç´ æ”¾å…¥åˆ°çˆ¶å…ƒç´ å†…éƒ¨çš„å‰é¢ $p.prependTo($('#div1')); $h2 = $('&lt;h2&gt;è¿™æ˜¯ä¸€ä¸ªh2&lt;/h2&gt;'); //$('#div1').after($h2); $h2.insertAfter($('#div1')); $h3 = $('&lt;h3&gt;è¿™æ˜¯ä¸€ä¸ªh3&lt;/h3&gt;'); //$('#div1').before($h3); $h3.insertBefore($('#div1')); &#125;) &lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;div id="div1"&gt; &lt;h1&gt;è¿™æ˜¯ä¸€ä¸ªH1å…ƒç´ &lt;/h1&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;15.3 åˆ é™¤èŠ‚ç‚¹1$(&apos;#div1&apos;).remove();15.4 è¯¾å ‚ç»ƒä¹ todolist(è®¡åˆ’åˆ—è¡¨)å®žä¾‹12345678&lt;!-- aæ ‡ç­¾çš„hrefå±žæ€§ --&gt;&lt;!-- # é»˜è®¤ä¼šé“¾æŽ¥åˆ°é¡µé¢é¡¶éƒ¨ --&gt;&lt;a href="#"&gt;é“¾æŽ¥&lt;/a&gt;&lt;a href="javascript:alert('ok!');"&gt;é“¾æŽ¥&lt;/a&gt;&lt;!-- è®©é“¾æŽ¥çš„é»˜è®¤è¡Œä¸ºæ˜¯ æ‰§è¡Œjavascriptçš„ç©ºè¯­å¥ï¼Œä¹Ÿå°±æ˜¯ä»€ä¹ˆéƒ½ä¸åš --&gt;&lt;a href="javascript:;"&gt;é“¾æŽ¥&lt;/a&gt;123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;todolist&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; var $inputtxt = $('#txt1'); var $btn = $('#btn1'); var $ul = $('#list'); $btn.click(function () &#123; // èŽ·å–inputè¾“å…¥æ¡†çš„å†…å®¹ var $val = $inputtxt.val(); if ($val == "") &#123; alert('è¯·è¾“å…¥å†…å®¹'); return; &#125; var $li = $('&lt;li&gt;&lt;span&gt;' + $val + '&lt;/span&gt;&lt;a href="javascript:;" class="up"&gt; â†‘ &lt;/a&gt;&lt;a href="javascript:;" class="down"&gt; â†“ &lt;/a&gt;&lt;a href="javascript:;" class="del"&gt;åˆ é™¤&lt;/a&gt;&lt;/li&gt;'); /* var $a = $li.find('.del'); $a.click(function()&#123; $(this).parent().remove(); &#125;) */ $ul.append($li); $inputtxt.val(""); &#125;); /* $('.del').click(function()&#123; $(this).parent().remove(); &#125;) */ $ul.delegate('a', 'click', function () &#123; var $handler = $(this).prop('class'); if ($handler == 'del') &#123; $(this).parent().remove(); &#125; if ($handler == 'up') &#123; if ($(this).parent().prev().length == 0) &#123; alert('åˆ°é¡¶äº†ï¼'); return; &#125; $(this).parent().insertBefore($(this).parent().prev()); &#125; if ($handler == 'down') &#123; if ($(this).parent().next().length == 0) &#123; alert('åˆ°åº•äº†ï¼'); return; &#125; $(this).parent().insertAfter($(this).parent().next()); &#125; &#125;); &#125;); &lt;/script&gt; &lt;style type="text/css"&gt; .list_con &#123; width: 600px; margin: 50px auto 0; &#125; .inputtxt &#123; width: 550px; height: 30px; border: 1px solid #ccc; padding: 0px; text-indent: 10px; &#125; .inputbtn &#123; width: 40px; height: 32px; padding: 0px; border: 1px solid #ccc; &#125; .list &#123; margin: 0; padding: 0; list-style: none; margin-top: 20px; &#125; .list li &#123; height: 40px; line-height: 40px; border-bottom: 1px solid #ccc; &#125; .list li span &#123; float: left; &#125; .list li a &#123; float: right; text-decoration: none; margin: 0 10px; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="list_con"&gt; &lt;h2&gt;To do list&lt;/h2&gt; &lt;input type="text" name="" id="txt1" class="inputtxt"&gt; &lt;input type="button" name="" value="å¢žåŠ " id="btn1" class="inputbtn"&gt; &lt;ul id="list" class="list"&gt; &lt;li&gt;&lt;span&gt;å­¦ä¹ html&lt;/span&gt;&lt;a href="javascript:;" class="up"&gt; â†‘ &lt;/a&gt;&lt;a href="javascript:;" class="down"&gt; â†“ &lt;/a&gt;&lt;a href="javascript:;" class="del"&gt;åˆ é™¤&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;span&gt;å­¦ä¹ css&lt;/span&gt;&lt;a href="javascript:;" class="up"&gt; â†‘ &lt;/a&gt;&lt;a href="javascript:;" class="down"&gt; â†“ &lt;/a&gt;&lt;a href="javascript:;" class="del"&gt;åˆ é™¤&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;span&gt;å­¦ä¹ javascript&lt;/span&gt;&lt;a href="javascript:;" class="up"&gt; â†‘ &lt;/a&gt;&lt;a href="javascript:;" class="down"&gt; â†“ &lt;/a&gt;&lt;a href="javascript:;" class="del"&gt;åˆ é™¤&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;16. æ»šè½®äº‹ä»¶ä¸Žå‡½æ•°èŠ‚æµ16.1 jquery.mousewheelæ’ä»¶ä½¿ç”¨jqueryä¸­æ²¡æœ‰é¼ æ ‡æ»šè½®äº‹ä»¶ï¼ŒåŽŸç”Ÿjsä¸­çš„é¼ æ ‡æ»šè½®äº‹ä»¶ä¸å…¼å®¹ï¼Œå¯ä»¥ä½¿ç”¨jqueryçš„æ»šè½®äº‹ä»¶æ’ä»¶jquery.mousewheel.jsã€‚16.2 å‡½æ•°èŠ‚æµjavascriptä¸­æœ‰äº›äº‹ä»¶çš„è§¦å‘é¢‘çŽ‡éžå¸¸é«˜ï¼Œæ¯”å¦‚onresizeäº‹ä»¶(jqä¸­æ˜¯resize)ï¼Œonmousemoveäº‹ä»¶(jqä¸­æ˜¯mousemove)ä»¥åŠä¸Šé¢è¯´çš„é¼ æ ‡æ»šè½®äº‹ä»¶ï¼Œåœ¨çŸ­äº‹ä»¶å†…å¤šå¤„è§¦å‘æ‰§è¡Œç»‘å®šçš„å‡½æ•°ï¼Œå¯ä»¥å·§å¦™åœ°ä½¿ç”¨å®šæ—¶å™¨æ¥å‡å°‘è§¦å‘çš„æ¬¡æ•°ï¼Œå®žçŽ°å‡½æ•°èŠ‚æµã€‚16.3 è¯¾å ‚å®žä¾‹16.3.1 æ•´å±æ»šåŠ¨123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;æ•´é¡µæ»šåŠ¨&lt;/title&gt; &lt;link rel="stylesheet" type="text/css" href="css/test.css"&gt; &lt;script type="text/javascript" src="js/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript" src="js/jquery.mousewheel.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; var $screen = $('.pages_con'); var $pages = $('.pages'); var $len = $pages.length; var $h = $(window).height(); var $points = $('.points li'); var timer = null; var $nowscreen = 0; $pages.css(&#123;'height': $h&#125;); $pages.eq(0).addClass('moving'); $points.click(function () &#123; $nowscreen = $(this).index(); $points.eq($nowscreen).addClass('active').siblings().removeClass('active'); $screen.animate(&#123;'top': -$h * $nowscreen&#125;, 300); $pages.eq($nowscreen).addClass('moving').siblings().removeClass('moving'); &#125;); $(window).mousewheel(function (event, dat) &#123; clearTimeout(timer); timer = setTimeout(function () &#123; if (dat == -1) &#123; $nowscreen++; &#125; else &#123; $nowscreen--; &#125; if ($nowscreen &lt; 0) &#123; $nowscreen = 0; &#125; if ($nowscreen &gt; $len - 1) &#123; $nowscreen = $len - 1; &#125; $screen.animate(&#123;'top': -$h * $nowscreen&#125;, 300); $pages.eq($nowscreen).addClass('moving').siblings().removeClass('moving'); $points.eq($nowscreen).addClass('active').siblings().removeClass('active'); &#125;, 200) &#125;) &#125;) &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="pages_con"&gt; &lt;div class="pages page1"&gt; &lt;div class="main_con"&gt; &lt;div class="left_img"&gt;&lt;img src="images/001.png"&gt;&lt;/div&gt; &lt;div class="right_info"&gt; Webå‰ç«¯å¼€å‘æ˜¯ä»Žç½‘é¡µåˆ¶ä½œæ¼”å˜è€Œæ¥çš„ï¼Œåç§°ä¸Šæœ‰å¾ˆæ˜Žæ˜¾çš„æ—¶ä»£ç‰¹å¾ã€‚åœ¨äº’è”ç½‘çš„æ¼”åŒ–è¿›ç¨‹ä¸­ï¼Œç½‘é¡µåˆ¶ä½œæ˜¯Web1.0æ—¶ä»£çš„äº§ç‰©ï¼Œé‚£æ—¶ç½‘ç«™çš„ä¸»è¦å†…å®¹éƒ½æ˜¯é™æ€çš„ï¼Œç”¨æˆ·ä½¿ç”¨ç½‘ç«™çš„è¡Œä¸ºä¹Ÿä»¥æµè§ˆä¸ºä¸»ã€‚ &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="pages page2"&gt; &lt;div class="main_con"&gt; &lt;div class="right_img"&gt;&lt;img src="images/002.png"&gt;&lt;/div&gt; &lt;div class="left_info"&gt; 2005å¹´ä»¥åŽï¼Œäº’è”ç½‘è¿›å…¥Web2.0æ—¶ä»£ï¼Œå„ç§ç±»ä¼¼æ¡Œé¢è½¯ä»¶çš„Webåº”ç”¨å¤§é‡æ¶ŒçŽ°ï¼Œç½‘ç«™çš„å‰ç«¯ç”±æ­¤å‘ç”Ÿäº†ç¿»å¤©è¦†åœ°çš„å˜åŒ–ã€‚ç½‘é¡µä¸å†åªæ˜¯æ‰¿è½½å•ä¸€çš„æ–‡å­—å’Œå›¾ç‰‡ï¼Œå„ç§å¯Œåª’ä½“è®©ç½‘é¡µçš„å†…å®¹æ›´åŠ ç”ŸåŠ¨ï¼Œç½‘é¡µä¸Šè½¯ä»¶åŒ–çš„äº¤äº’å½¢å¼ä¸ºç”¨æˆ·æä¾›äº†æ›´å¥½çš„ä½¿ç”¨ä½“éªŒï¼Œè¿™äº›éƒ½æ˜¯åŸºäºŽå‰ç«¯æŠ€æœ¯å®žçŽ°çš„ã€‚ &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="pages page3"&gt; &lt;div class="main_con"&gt; &lt;div class="left_img"&gt;&lt;img src="images/004.png"&gt;&lt;/div&gt; &lt;div class="right_info"&gt; ä»¥å‰ä¼šPhotoshopå’ŒDreamweaverå°±å¯ä»¥åˆ¶ä½œç½‘é¡µï¼ŒçŽ°åœ¨åªæŽŒæ¡è¿™äº›å·²ç»è¿œè¿œä¸å¤Ÿäº†ã€‚æ— è®ºæ˜¯å¼€å‘éš¾åº¦ä¸Šï¼Œè¿˜æ˜¯å¼€å‘æ–¹å¼ä¸Šï¼ŒçŽ°åœ¨çš„ç½‘é¡µåˆ¶ä½œéƒ½æ›´æŽ¥è¿‘ä¼ ç»Ÿçš„ç½‘ç«™åŽå°å¼€å‘ï¼Œæ‰€ä»¥çŽ°åœ¨ä¸å†å«ç½‘é¡µåˆ¶ä½œï¼Œè€Œæ˜¯å«Webå‰ç«¯å¼€å‘ã€‚ &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="pages page4"&gt; &lt;div class="main_con"&gt; &lt;div class="left_img"&gt;&lt;img src="images/003.png"&gt;&lt;/div&gt; &lt;div class="right_info"&gt; Webå‰ç«¯å¼€å‘åœ¨äº§å“å¼€å‘çŽ¯èŠ‚ä¸­çš„ä½œç”¨å˜å¾—è¶Šæ¥è¶Šé‡è¦ï¼Œè€Œä¸”éœ€è¦ä¸“ä¸šçš„å‰ç«¯å·¥ç¨‹å¸ˆæ‰èƒ½åšå¥½ï¼Œè¿™æ–¹é¢çš„ä¸“ä¸šäººæ‰è¿‘å‡ å¹´æ¥å¤‡å—é’çã€‚Webå‰ç«¯å¼€å‘æ˜¯ä¸€é¡¹å¾ˆç‰¹æ®Šçš„å·¥ä½œï¼Œæ¶µç›–çš„çŸ¥è¯†é¢éžå¸¸å¹¿ï¼Œæ—¢æœ‰å…·ä½“çš„æŠ€æœ¯ï¼Œåˆæœ‰æŠ½è±¡çš„ç†å¿µã€‚ç®€å•åœ°è¯´ï¼Œå®ƒçš„ä¸»è¦èŒèƒ½å°±æ˜¯æŠŠç½‘ç«™çš„ç•Œé¢æ›´å¥½åœ°å‘ˆçŽ°ç»™ç”¨æˆ·ã€‚ &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="pages page5"&gt; &lt;div class="main_con"&gt; &lt;div class="center_img"&gt;&lt;img src="images/005.png"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/div&gt;&lt;ul class="points"&gt; &lt;li class="active"&gt;&lt;/li&gt; &lt;li&gt;&lt;/li&gt; &lt;li&gt;&lt;/li&gt; &lt;li&gt;&lt;/li&gt; &lt;li&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/html&gt;16.3.2 å¹»ç¯ç‰‡16.3.3 åˆ¶ä½œCSS3åŠ¨ç”»1234567891011121314151617181920212223242526272829303132&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/jquery-1.12.4.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function()&#123; $('#btn').click(function()&#123; $('.box').addClass('moving'); &#125;); &#125;) &lt;/script&gt; &lt;style type="text/css"&gt; .box&#123; width:200px; height:200px; background-color:gold; margin:50px auto 0; transition:all 1s ease; &#125; .moving&#123; transform:rotate(135deg); &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;input type="button" name="" value="åŠ¨ç”»" id="btn"&gt; &lt;div class="box"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;17. jsonjsonæ˜¯ JavaScript Object Notation çš„é¦–å­—æ¯ç¼©å†™ï¼Œå•è¯çš„æ„æ€æ˜¯javascriptå¯¹è±¡è¡¨ç¤ºæ³•ï¼Œè¿™é‡Œè¯´çš„jsonæŒ‡çš„æ˜¯ç±»ä¼¼äºŽjavascriptå¯¹è±¡çš„ä¸€ç§æ•°æ®æ ¼å¼ï¼Œç›®å‰è¿™ç§æ•°æ®æ ¼å¼æ¯”è¾ƒæµè¡Œï¼Œé€æ¸æ›¿æ¢æŽ‰äº†ä¼ ç»Ÿçš„xmlæ•°æ®æ ¼å¼ã€‚17.1 javascriptè‡ªå®šä¹‰å¯¹è±¡1234567var oMan = &#123; name:'tom', age:16, talk:function(s)&#123; alert('æˆ‘ä¼šè¯´'+s); &#125;&#125;17.2 jsonæ ¼å¼çš„æ•°æ®1234&#123; "name":"tom", "age":18&#125;ä¸Žjsonå¯¹è±¡ä¸åŒçš„æ˜¯ï¼Œjsonæ•°æ®æ ¼å¼çš„å±žæ€§åç§°å’Œå­—ç¬¦ä¸²å€¼éœ€è¦ç”¨åŒå¼•å·å¼•èµ·æ¥ï¼Œç”¨å•å¼•å·æˆ–è€…ä¸ç”¨å¼•å·ä¼šå¯¼è‡´è¯»å–æ•°æ®é”™è¯¯ã€‚jsonçš„å¦å¤–ä¸€ä¸ªæ•°æ®æ ¼å¼æ˜¯æ•°ç»„ï¼Œå’Œjavascriptä¸­çš„æ•°ç»„å­—é¢é‡ç›¸åŒã€‚1[&quot;tom&quot;,18,&quot;programmer&quot;]18. ajaxä¸ŽjsonpajaxæŠ€æœ¯çš„ç›®çš„æ˜¯è®©javascriptå‘é€httpè¯·æ±‚ï¼Œä¸ŽåŽå°é€šä¿¡ï¼ŒèŽ·å–æ•°æ®å’Œä¿¡æ¯ã€‚ajaxæŠ€æœ¯çš„åŽŸç†æ˜¯å®žä¾‹åŒ–xmlhttpå¯¹è±¡ï¼Œä½¿ç”¨æ­¤å¯¹è±¡ä¸ŽåŽå°é€šä¿¡ã€‚ajaxé€šä¿¡çš„è¿‡ç¨‹ä¸ä¼šå½±å“åŽç»­javascriptçš„æ‰§è¡Œï¼Œä»Žè€Œå®žçŽ°å¼‚æ­¥ã€‚åŒæ­¥å’Œå¼‚æ­¥çŽ°å®žç”Ÿæ´»ä¸­ï¼ŒåŒæ­¥æŒ‡çš„æ˜¯åŒæ—¶åšå‡ ä»¶äº‹æƒ…ï¼Œå¼‚æ­¥æŒ‡çš„æ˜¯åšå®Œä¸€ä»¶äº‹åŽå†åšå¦å¤–ä¸€ä»¶äº‹ï¼Œç¨‹åºä¸­çš„åŒæ­¥å’Œå¼‚æ­¥æ˜¯æŠŠçŽ°å®žç”Ÿæ´»ä¸­çš„æ¦‚å¿µå¯¹è°ƒï¼Œä¹Ÿå°±æ˜¯ç¨‹åºä¸­çš„å¼‚æ­¥æŒ‡çš„æ˜¯çŽ°å®žç”Ÿæ´»ä¸­çš„åŒæ­¥ï¼Œç¨‹åºä¸­çš„åŒæ­¥æŒ‡çš„æ˜¯çŽ°å®žç”Ÿæ´»ä¸­çš„å¼‚æ­¥ã€‚å±€éƒ¨åˆ·æ–°å’Œæ— åˆ·æ–°ajaxå¯ä»¥å®žçŽ°å±€éƒ¨åˆ·æ–°ï¼Œä¹Ÿå«åšæ— åˆ·æ–°ï¼Œæ— åˆ·æ–°æŒ‡çš„æ˜¯æ•´ä¸ªé¡µé¢ä¸åˆ·æ–°ï¼Œåªæ˜¯å±€éƒ¨åˆ·æ–°ï¼Œajaxå¯ä»¥è‡ªå·±å‘é€httpè¯·æ±‚ï¼Œä¸ç”¨é€šè¿‡æµè§ˆå™¨çš„åœ°å€æ ï¼Œæ‰€ä»¥é¡µé¢æ•´ä½“ä¸ä¼šåˆ·æ–°ï¼ŒajaxèŽ·å–åˆ°åŽå°æ•°æ®ï¼Œæ›´æ–°é¡µé¢æ˜¾ç¤ºæ•°æ®çš„éƒ¨åˆ†ï¼Œå°±åšåˆ°äº†é¡µé¢å±€éƒ¨åˆ·æ–°ã€‚åŒæºç­–ç•¥ajaxè¯·æ±‚çš„é¡µé¢æˆ–èµ„æºåªèƒ½æ˜¯åŒä¸€ä¸ªåŸŸä¸‹é¢çš„èµ„æºï¼Œä¸èƒ½æ˜¯å…¶ä»–åŸŸçš„èµ„æºï¼Œè¿™æ˜¯åœ¨è®¾è®¡ajaxæ—¶åŸºäºŽå®‰å…¨çš„è€ƒè™‘ã€‚ç‰¹å¾æŠ¥é”™æç¤ºï¼š123XMLHttpRequest cannot load https://www.baidu.com/. No &apos;Access-Control-Allow-Origin&apos; header is present on the requested resource. Origin &apos;null&apos; is therefore not allowed access.18.1 $.ajaxä½¿ç”¨æ–¹æ³•å¸¸ç”¨å‚æ•°ï¼š1ã€url è¯·æ±‚åœ°å€2ã€type è¯·æ±‚æ–¹å¼ï¼Œé»˜è®¤æ˜¯â€™GETâ€™ï¼Œå¸¸ç”¨çš„è¿˜æœ‰â€™POSTâ€™3ã€dataType è®¾ç½®è¿”å›žçš„æ•°æ®æ ¼å¼ï¼Œå¸¸ç”¨çš„æ˜¯â€™jsonâ€™æ ¼å¼ï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä¸ºâ€™htmlâ€™4ã€data è®¾ç½®å‘é€ç»™æœåŠ¡å™¨çš„æ•°æ®5ã€success è®¾ç½®è¯·æ±‚æˆåŠŸåŽçš„å›žè°ƒå‡½æ•°6ã€error è®¾ç½®è¯·æ±‚å¤±è´¥åŽçš„å›žè°ƒå‡½æ•°7ã€async è®¾ç½®æ˜¯å¦å¼‚æ­¥ï¼Œé»˜è®¤å€¼æ˜¯â€™trueâ€™ï¼Œè¡¨ç¤ºå¼‚æ­¥ä»¥å‰çš„å†™æ³•ï¼š123456789101112$.ajax(&#123; url: &apos;js/data.json&apos;, type: &apos;GET&apos;, dataType: &apos;json&apos;, data:&#123;&apos;aa&apos;:1&#125; success:function(data)&#123; alert(data.name); &#125;, error:function()&#123; alert(&apos;æœåŠ¡å™¨è¶…æ—¶ï¼Œè¯·é‡è¯•ï¼&apos;); &#125;&#125;);æ–°çš„å†™æ³•(æŽ¨è)ï¼š1234567891011121314$.ajax(&#123; url: &apos;js/data.json&apos;, type: &apos;GET&apos;, dataType: &apos;json&apos;, data:&#123;&apos;aa&apos;:1&#125;&#125;).done(function(data) &#123; alert(data.name);&#125;).fail(function() &#123; alert(&apos;æœåŠ¡å™¨è¶…æ—¶ï¼Œè¯·é‡è¯•ï¼&apos;);&#125;);// data.jsoné‡Œé¢çš„æ•°æ®ï¼š &#123;&quot;name&quot;:&quot;tom&quot;,&quot;age&quot;:18&#125;è¯¾å ‚ç»ƒä¹ åˆ¶ä½œé¦–é¡µç”¨æˆ·ä¿¡æ¯è¯»å–12345678910111213141516171819202122232425262728293031323334#!/usr/bin/env python#-*- coding: utf-8 -*-from flask import Flask,render_template,request,jsonifyapp = Flask(__name__)@app.route('/')def index(): return render_template('index.html')@app.route('/login',methods=['GET','POST'])def login(): if request.method == 'GET': return render_template('login.html') else: # å’Œå‰ç«¯çº¦å®šå¥½ï¼Œå‘é€ç½‘ç»œè¯·æ±‚ï¼Œä¸ç®¡ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦éªŒè¯æˆåŠŸ # æˆ‘éƒ½è¿”å›žåŒæ ·æ ¼å¼çš„jsonå¯¹è±¡ç»™ä½  # &#123;"code":200,"message":""&#125; username = request.form.get('username') password = request.form.get('password') print(username,password) data = &#123; 'username':username &#125; if username == '111' and password == '222': return jsonify(&#123;"code":200,"message":"","data":data&#125;) else: return jsonify(&#123;"code":401,"message":"ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼"&#125;)if __name__ == '__main__': app.run(debug=True)12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364// index.html&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Index&lt;/title&gt; &lt;script type="text/javascript" src="static/jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; $("#btn").click(function () &#123; var $username = $("#username").val(); var $password = $("#password").val(); var $data = &#123; "username": $username, "password": $password &#125;; $.ajax(&#123; url: "/login", type: 'POST', dataType: 'json', data: $data, &#125;) .done(function (data) &#123; if (data['code'] == 200) &#123; $("#div01").hide(); $(".div2").append(data['data']['username']); $(".div2").removeClass("div2"); &#125; &#125;) &#125;); &#125;); &lt;/script&gt; &lt;style type="text/css"&gt; .div2&#123; display: none; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;h2&gt;Index&lt;/h2&gt; &lt;div id="div01"&gt; &lt;p&gt; &lt;span&gt;ç”¨æˆ·åï¼š&lt;/span&gt; &lt;input type="text" name="username" id="username"&gt; &lt;/p&gt; &lt;p&gt; &lt;span&gt;å¯†ç ï¼š&lt;/span&gt; &lt;input type="password" name="pwd" id="password"&gt; &lt;/p&gt; &lt;button id="btn" value="submit"&gt;æäº¤&lt;/button&gt; &lt;/div&gt; &lt;div class="div2"&gt; &lt;span&gt;ç”¨æˆ·åï¼š&lt;/span&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;18.2 jsonpajaxåªèƒ½è¯·æ±‚åŒä¸€ä¸ªåŸŸä¸‹çš„æ•°æ®æˆ–èµ„æºï¼Œæœ‰æ—¶å€™éœ€è¦è·¨åŸŸè¯·æ±‚æ•°æ®ï¼Œå°±éœ€è¦ç”¨åˆ°jsonpæŠ€æœ¯ï¼Œjsonpå¯ä»¥è·¨åŸŸè¯·æ±‚æ•°æ®ï¼Œå®ƒçš„åŽŸç†ä¸»è¦æ˜¯åˆ©ç”¨äº†&lt;script&gt;æ ‡ç­¾å¯ä»¥è·¨åŸŸé“¾æŽ¥èµ„æºçš„ç‰¹æ€§ã€‚jsonpå’ŒajaxåŽŸç†å®Œå…¨ä¸ä¸€æ ·ï¼Œä¸è¿‡jqueryå°†å®ƒä»¬å°è£…æˆåŒä¸€ä¸ªå‡½æ•°ã€‚1234567891011121314$.ajax(&#123; url:'js/data.js', type:'get', dataType:'jsonp', jsonpCallback:'fnBack'&#125;).done(function(data)&#123; alert(data.name);&#125;).fail(function() &#123; alert('æœåŠ¡å™¨è¶…æ—¶ï¼Œè¯·é‡è¯•ï¼');&#125;);// data.jsé‡Œé¢çš„æ•°æ®ï¼š fnBack(&#123;"name":"tom","age":18&#125;);è¯¾å ‚å®žä¾‹èŽ·å–360æœç´¢å…³é”®è¯è”æƒ³æ•°æ®12345678910111213141516171819202122232425$(function()&#123; $(&apos;#txt01&apos;).keyup(function()&#123; var sVal = $(this).val(); $.ajax(&#123; url:&apos;https://sug.so.360.cn/suggest?&apos;, type:&apos;get&apos;, dataType:&apos;jsonp&apos;, data: &#123;word: sVal&#125; &#125;) .done(function(data)&#123; var aData = data.s; $(&apos;.list&apos;).empty(); for(var i=0;i&lt;aData.length;i++) &#123; var $li = $(&apos;&lt;li&gt;&apos;+ aData[i] +&apos;&lt;/li&gt;&apos;); $li.appendTo($(&apos;.list&apos;)); &#125; &#125;) &#125;)&#125;)//......&lt;input type=&quot;text&quot; name=&quot;&quot; id=&quot;txt01&quot;&gt;&lt;ul class=&quot;list&quot;&gt;&lt;/ul&gt;19. æœ¬åœ°å­˜å‚¨æœ¬åœ°å­˜å‚¨åˆ†ä¸ºcookieï¼Œä»¥åŠæ–°å¢žçš„localStorageå’ŒsessionStorage1ã€cookie å­˜å‚¨åœ¨æœ¬åœ°ï¼Œå®¹é‡æœ€å¤§4kï¼Œåœ¨åŒæºçš„httpè¯·æ±‚æ—¶æºå¸¦ä¼ é€’ï¼ŒæŸè€—å¸¦å®½ï¼Œå¯è®¾ç½®è®¿é—®è·¯å¾„ï¼Œåªæœ‰æ­¤è·¯å¾„åŠæ­¤è·¯å¾„çš„å­è·¯å¾„æ‰èƒ½è®¿é—®æ­¤cookieï¼Œåœ¨è®¾ç½®çš„è¿‡æœŸæ—¶é—´ä¹‹å‰æœ‰æ•ˆã€‚1234// jquery è®¾ç½®cookie$.cookie('mycookie','123',&#123;expires:7,path:'/'&#125;);// jquery èŽ·å–cookie$.cookie('mycookie');123456789101112131415161718192021&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript" src="js/jquery.cookie.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; // è®¾ç½®cookie è¿‡æœŸæ—¶é—´ä¸º7å¤©ï¼Œå­˜åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹ //$.cookie('mycookie','ok!',&#123;expires:7,path:'/'&#125;); //è¯»å–cookie var mycookie = $.cookie('mycookie'); alert(mycookie); &lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;h1&gt;æµ‹è¯•é¡µé¢&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;è¯¾å ‚å®žä¾‹åªæç¤ºä¸€æ¬¡çš„å¼¹æ¡†123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript" src="js/jquery.cookie.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; var hasread = $.cookie('hasread'); //alert(hasread); // åˆ¤æ–­æ˜¯å¦å­˜äº†cookieï¼Œæ²¡æœ‰å°±å¼¹å‡ºå¼¹æ¡† if (hasread == undefined) &#123; $('.pop_con').show(); &#125; //ç”¨æˆ·ç‚¹å‡»çŸ¥é“åŽï¼Œå­˜cookieï¼ŒæŠŠå¼¹æ¡†å…³æŽ‰ $('#user_read').click(function () &#123; $.cookie('hasread', 'read', &#123;expires: 7, path: '/'&#125;); $('.pop_con').hide(); &#125;) &#125;) &lt;/script&gt; &lt;style type="text/css"&gt; .pop_con &#123; display: none; &#125; .pop &#123; position: fixed; width: 500px; height: 300px; background-color: #fff; border: 3px solid #000; left: 50%; top: 50%; margin-left: -250px; margin-top: -150px; z-index: 9999; &#125; .mask &#123; position: fixed; width: 100%; height: 100%; background-color: #000; opacity: 0.3; filter: alpha(opacity=30); left: 0; top: 0; z-index: 9990; &#125; .close &#123; float: right; font-size: 30px; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="pop_con"&gt; &lt;div class="pop"&gt; äº²ï¼æœ¬ç½‘ç«™æœ€è¿‘æœ‰ä¼˜æƒ æ´»åŠ¨ï¼è¯·å¼ºåŠ›å…³æ³¨ï¼ &lt;a href="#" id="close" class="close"&gt;Ã—&lt;/a&gt; &lt;a href="javascript:;" id="user_read"&gt;æœ•çŸ¥é“äº†ï¼&lt;/a&gt; &lt;/div&gt; &lt;div class="mask"&gt;&lt;/div&gt;&lt;/div&gt;&lt;h1&gt;ç½‘ç«™å†…å®¹&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;2ã€localStorage å­˜å‚¨åœ¨æœ¬åœ°ï¼Œå®¹é‡ä¸º5Mæˆ–è€…æ›´å¤§ï¼Œä¸ä¼šåœ¨è¯·æ±‚æ—¶å€™æºå¸¦ä¼ é€’ï¼Œåœ¨æ‰€æœ‰åŒæºçª—å£ä¸­å…±äº«ï¼Œæ•°æ®ä¸€ç›´æœ‰æ•ˆï¼Œé™¤éžäººä¸ºåˆ é™¤ï¼Œå¯ä½œä¸ºé•¿æœŸæ•°æ®ã€‚12345678910//è®¾ç½®ï¼šlocalStorage.setItem(&quot;dat&quot;, &quot;456&quot;);localStorage.dat = &apos;456&apos;;//èŽ·å–ï¼šlocalStorage.getItem(&quot;dat&quot;);localStorage.dat//åˆ é™¤localStorage.removeItem(&quot;dat&quot;);3ã€sessionStorage å­˜å‚¨åœ¨æœ¬åœ°ï¼Œå®¹é‡ä¸º5Mæˆ–è€…æ›´å¤§ï¼Œä¸ä¼šåœ¨è¯·æ±‚æ—¶å€™æºå¸¦ä¼ é€’ï¼Œåœ¨åŒæºçš„å½“å‰çª—å£å…³é—­å‰æœ‰æ•ˆã€‚localStorage å’Œ sessionStorage åˆç§°ä¸ºWeb Storage , Web Storageæ”¯æŒäº‹ä»¶é€šçŸ¥æœºåˆ¶ï¼Œå¯ä»¥å°†æ•°æ®æ›´æ–°çš„é€šçŸ¥ç›‘å¬è€…ï¼ŒWeb Storageçš„apiæŽ¥å£ä½¿ç”¨æ›´æ–¹ä¾¿ã€‚iPhoneçš„æ— ç—•æµè§ˆä¸æ”¯æŒWeb Storageï¼Œåªèƒ½ç”¨cookieã€‚123456789101112131415161718192021222324&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript"&gt; // ä¸ç”¨åŠ è½½jQueryæ–‡ä»¶ //è®¾ç½®ï¼š localStorage.setItem("dat", "456"); localStorage.dat = '456'; //èŽ·å–ï¼š localStorage.getItem("dat"); localStorage.dat //åˆ é™¤ localStorage.removeItem("dat"); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;æµ‹è¯•webstorage&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;20. jqueryUIjQuery UIæ˜¯ä»¥ jQuery ä¸ºåŸºç¡€çš„ä»£ç åº“ã€‚åŒ…å«åº•å±‚ç”¨æˆ·äº¤äº’ã€åŠ¨ç”»ã€ç‰¹æ•ˆå’Œå¯æ›´æ¢ä¸»é¢˜çš„å¯è§†æŽ§ä»¶ã€‚æˆ‘ä»¬å¯ä»¥ç›´æŽ¥ç”¨å®ƒæ¥æž„å»ºå…·æœ‰å¾ˆå¥½äº¤äº’æ€§çš„webåº”ç”¨ç¨‹åºã€‚jqueryUI ç½‘å€http://jqueryui.com/è¯¾å ‚å®žä¾‹1ã€è®¾ç½®æ•°å€¼çš„æ»‘åŠ¨æ¡1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;drag&lt;/title&gt; &lt;script type="text/javascript" src="jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript" src="js/jquery-ui.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; $('.dragbar').draggable(&#123; // é™åˆ¶åœ¨Xè½´æ–¹å‘æ‹–åŠ¨ axis: 'x', // é™å®šåœ¨çˆ¶çº§çš„èŒƒå›´å†…æ‹–åŠ¨ containment: 'parent', //containment:[0,0,600,0] //è®¾ç½®æ‹–åŠ¨æ—¶å€™çš„é€æ˜Žåº¦ opacity: 0.6, drag: function (ev, ui) &#123; //console.log(ui.position.left); //èŽ·å–æ‹–åŠ¨çš„è·ç¦» var nowleft = ui.position.left; $('.progress').css(&#123;width: nowleft&#125;); $('.slide_count').val(parseInt(nowleft * 100 / 570)); &#125; &#125;); &#125;) &lt;/script&gt; &lt;style type="text/css"&gt; .slidebar_con &#123; width: 650px; height: 32px; margin: 50px auto 0; &#125; .slidebar &#123; width: 600px; height: 30px; border: 1px solid #ccc; float: left; position: relative; &#125; .slidebar .dragbar &#123; width: 30px; height: 30px; background-color: gold; cursor: pointer; position: absolute; left: 0; top: 0; &#125; .slidebar .progress &#123; width: 0px; height: 30px; background-color: #f0f0f0; position: absolute; left: 0; top: 0; &#125; .slide_count &#123; padding: 0; float: right; width: 40px; height: 30px; border: 1px solid #ccc; text-align: center; font-size: 16px; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="slidebar_con"&gt; &lt;div class="slidebar"&gt; &lt;div class="progress"&gt;&lt;/div&gt; &lt;div class="dragbar"&gt;&lt;/div&gt; &lt;/div&gt; &lt;input type="text" name="" value="0" class="slide_count"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;2 ã€è‡ªå®šä¹‰æ»šåŠ¨æ¡1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;è‡ªå®šä¹‰æ»šåŠ¨æ¡&lt;/title&gt; &lt;script type="text/javascript" src="jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript" src="js/jquery-ui.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function () &#123; var h = $('.paragraph').outerHeight(); //æ•´ä½“æ–‡æœ¬çš„é«˜åº¦å‡åŽ»å¤–é¢å®¹å™¨çš„é«˜åº¦ var hide = h - 500; $('.scroll_bar').draggable(&#123; axis: 'y', containment: 'parent', opacity: 0.6, drag: function (ev, ui) &#123; var nowtop = ui.position.top; var nowscroll = parseInt(nowtop / 290 * hide); $('.paragraph').css(&#123;top: -nowscroll&#125;); &#125; &#125;); &#125;) &lt;/script&gt; &lt;style type="text/css"&gt; .scroll_con &#123; width: 400px; height: 500px; border: 1px solid #ccc; margin: 50px auto 0; position: relative; overflow: hidden; &#125; .paragraph &#123; width: 360px; position: absolute; left: 0; top: 0; padding: 10px 20px; font-size: 14px; font-family: 'Microsoft Yahei'; line-height: 32px; text-indent: 2em; &#125; .scroll_bar_con &#123; width: 10px; height: 490px; position: absolute; right: 5px; top: 5px; &#125; .scroll_bar &#123; width: 10px; height: 200px; background-color: #ccc; position: absolute; left: 0; top: 0; cursor: pointer; border-radius: 5px; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="scroll_con"&gt; &lt;div class="paragraph"&gt; æŽŒæ¡HTMLæ˜¯ç½‘é¡µçš„æ ¸å¿ƒï¼Œæ˜¯ä¸€ç§åˆ¶ä½œä¸‡ç»´ç½‘é¡µé¢çš„æ ‡å‡†è¯­è¨€ï¼Œæ˜¯ä¸‡ç»´ç½‘æµè§ˆå™¨ä½¿ç”¨çš„ä¸€ç§è¯­è¨€ï¼Œå®ƒæ¶ˆé™¤äº†ä¸åŒè®¡ç®—æœºä¹‹é—´ä¿¡æ¯äº¤æµçš„éšœç¢ã€‚å› æ­¤ï¼Œå®ƒæ˜¯ç›®å‰ç½‘ç»œä¸Šåº”ç”¨æœ€ä¸ºå¹¿æ³›çš„è¯­è¨€ï¼Œä¹Ÿæ˜¯æž„æˆç½‘é¡µæ–‡æ¡£çš„ä¸»è¦è¯­è¨€ï¼Œå­¦å¥½HTMLæ˜¯æˆä¸ºWebå¼€å‘äººå‘˜çš„åŸºæœ¬æ¡ä»¶ã€‚ å­¦å¥½CSSæ˜¯ç½‘é¡µå¤–è§‚çš„é‡è¦ä¸€ç‚¹ï¼ŒCSSå¯ä»¥å¸®åŠ©æŠŠç½‘é¡µå¤–è§‚åšå¾—æ›´åŠ ç¾Žè§‚ã€‚ å­¦ä¹ JavaScriptçš„åŸºæœ¬è¯­æ³•ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨JavaScriptç¼–ç¨‹å°†ä¼šæé«˜å¼€å‘äººå‘˜çš„ä¸ªäººæŠ€èƒ½ã€‚ äº†è§£Unixå’ŒLinuxçš„åŸºæœ¬çŸ¥è¯†è™½ç„¶è¿™ä¸¤ç‚¹å¾ˆåŸºç¡€ï¼Œä½†æ˜¯å¼€å‘äººå‘˜äº†è§£Unixå’ŒLinuxçš„åŸºæœ¬çŸ¥è¯†æ˜¯æœ‰ç›Šæ— å®³çš„ã€‚ äº†è§£WebæœåŠ¡å™¨å½“ä½ å¯¹Apacheçš„åŸºæœ¬é…ç½®ï¼Œhtaccessé…ç½®æŠ€å·§æœ‰ä¸€äº›æŽŒæ¡çš„è¯ï¼Œå°†æ¥å¿…å®šå—ç›Šï¼Œè€Œä¸”è¿™æ–¹é¢çš„çŸ¥è¯†å­¦èµ·æ¥ä¹Ÿç›¸å¯¹å®¹æ˜“ã€‚ &lt;/div&gt; &lt;div class="scroll_bar_con"&gt; &lt;div class="scroll_bar"&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;3ã€ æ‹–æ‹½12345678910111213141516171819202122232425262728293031323334353637383940414243&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="jquery-3.3.1.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript" src="js/jquery-ui.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function()&#123; $('.box').draggable(&#123; // é™åˆ¶åœ¨xè½´å‘æ‹–åŠ¨ //axis:'x', // é™å®šåœ¨çˆ¶çº§çš„èŒƒå›´å†…æ‹–åŠ¨ containment:'parent', drag:function(ev,ui)&#123; //console.log(ui); //document.title = ui.position.left; $('#shownumber').val(parseInt(100*(ui.position.left/600))) &#125; &#125;); &#125;) &lt;/script&gt; &lt;style type="text/css"&gt; .con&#123; width:800px; height:200px; border:1px solid #000; margin:50px auto 0; &#125; .box&#123; width:200px; height:200px; background-color: gold; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="con"&gt; &lt;div class="box"&gt;&lt;/div&gt; &lt;/div&gt; &lt;input type="text" name="" id="shownumber"&gt;&lt;/body&gt;&lt;/html&gt;21. ç§»åŠ¨ç«¯jsäº‹ä»¶ç§»åŠ¨ç«¯çš„æ“ä½œæ–¹å¼å’ŒPCç«¯æ˜¯ä¸åŒçš„ï¼Œç§»åŠ¨ç«¯ä¸»è¦ç”¨æ‰‹æŒ‡æ“ä½œï¼Œæ‰€ä»¥æœ‰ç‰¹æ®Šçš„touchäº‹ä»¶ï¼Œtouchäº‹ä»¶åŒ…æ‹¬å¦‚ä¸‹å‡ ä¸ªäº‹ä»¶ï¼š1ã€touchstart: //æ‰‹æŒ‡æ”¾åˆ°å±å¹•ä¸Šæ—¶è§¦å‘2ã€touchmove: //æ‰‹æŒ‡åœ¨å±å¹•ä¸Šæ»‘åŠ¨å¼è§¦å‘3ã€touchend: //æ‰‹æŒ‡ç¦»å¼€å±å¹•æ—¶è§¦å‘4ã€touchcancel: //ç³»ç»Ÿå–æ¶ˆtouchäº‹ä»¶çš„æ—¶å€™è§¦å‘ï¼Œæ¯”è¾ƒå°‘ç”¨ç§»åŠ¨ç«¯ä¸€èˆ¬æœ‰ä¸‰ç§æ“ä½œï¼Œç‚¹å‡»ã€æ»‘åŠ¨ã€æ‹–åŠ¨ï¼Œè¿™ä¸‰ç§æ“ä½œä¸€èˆ¬æ˜¯ç»„åˆä½¿ç”¨ä¸Šé¢çš„å‡ ä¸ªäº‹ä»¶æ¥å®Œæˆçš„ï¼Œæ‰€æœ‰ä¸Šé¢çš„4ä¸ªäº‹ä»¶ä¸€èˆ¬å¾ˆå°‘å•ç‹¬ä½¿ç”¨ï¼Œä¸€èˆ¬æ˜¯å°è£…ä½¿ç”¨æ¥å®žçŽ°è¿™ä¸‰ç§æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨å°è£…æˆç†Ÿçš„jsåº“ã€‚22. zeptojsZeptoæ˜¯ä¸€ä¸ªè½»é‡çº§çš„é’ˆå¯¹çŽ°ä»£é«˜çº§æµè§ˆå™¨çš„JavaScriptåº“ï¼Œ å®ƒä¸Žjqueryæœ‰ç€ç±»ä¼¼çš„apiã€‚ å¦‚æžœä½ ä¼šç”¨jqueryï¼Œé‚£ä¹ˆä½ ä¹Ÿä¼šç”¨zeptoã€‚Zeptoçš„ä¸€äº›å¯é€‰åŠŸèƒ½æ˜¯ä¸“é—¨é’ˆå¯¹ç§»åŠ¨ç«¯æµè§ˆå™¨çš„ï¼›å®ƒçš„æœ€åˆç›®æ ‡æ˜¯åœ¨ç§»åŠ¨ç«¯æä¾›ä¸€ä¸ªç²¾ç®€çš„ç±»ä¼¼jqueryçš„jsåº“ã€‚zeptoå®˜ç½‘ï¼šhttp://zeptojs.com/zeptoä¸­æ–‡apiï¼šhttp://www.css88.com/doc/zeptojs_api/zeptoåŒ…å«å¾ˆå¤šæ¨¡å—ï¼Œé»˜è®¤ä¸‹è½½ç‰ˆæœ¬åŒ…å«çš„æ¨¡å—æœ‰Core, Ajax, Event, Form, IEæ¨¡å—ï¼Œå¦‚æžœè¿˜éœ€è¦å…¶ä»–çš„æ¨¡å—ï¼Œå¯ä»¥è‡ªå®šä¹‰æž„å»ºã€‚zeptoè‡ªå®šä¹‰æž„å»ºåœ°å€ï¼šhttp://github.e-sites.nl/zeptobuilder/12345678910111213141516&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script type="text/javascript" src="js/zepto.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function()&#123; alert( $('#div1').html() ); &#125;) &lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;div id="div1"&gt;è¿™æ˜¯ä¸€ä¸ªdivå…ƒç´ &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;23. swiperswiper.jsæ˜¯ä¸€æ¬¾æˆç†Ÿç¨³å®šçš„åº”ç”¨äºŽPCç«¯å’Œç§»åŠ¨ç«¯çš„æ»‘åŠ¨æ•ˆæžœæ’ä»¶ï¼Œä¸€èˆ¬ç”¨æ¥è§¦å±ç„¦ç‚¹å›¾ã€è§¦å±æ•´å±æ»šåŠ¨ç­‰æ•ˆæžœã€‚ swiperåˆ†ä¸º2.xç‰ˆæœ¬å’Œ3.xç‰ˆæœ¬ï¼Œ2.xç‰ˆæœ¬æ”¯æŒä½Žç‰ˆæœ¬æµè§ˆå™¨(IE7)ï¼Œ3.xæ”¾å¼ƒæ”¯æŒä½Žç‰ˆæœ¬æµè§ˆå™¨ï¼Œé€‚åˆåº”ç”¨åœ¨ç§»åŠ¨ç«¯ã€‚2.xç‰ˆæœ¬ä¸­æ–‡ç½‘å€ï¼šhttp://2.swiper.com.cn/3.xç‰ˆæœ¬ä¸­æ–‡ç½‘åœ°å€ï¼šhttp://www.swiper.com.cn/1. swiperä½¿ç”¨æ–¹æ³•123456789101112131415161718192021222324252627282930313233343536&lt;script type="text/javascript" src="js/swiper.min.js"&gt;&lt;/script&gt;&lt;!-- å¦‚æžœé¡µé¢å¼•ç”¨äº†jqueryæˆ–è€…zeptoï¼Œå°±å¼•ç”¨ swiper.jquery.min.js,å®ƒçš„å®¹é‡æ¯”swiper.min.js &lt;script src="path/to/swiper.jquery.min.js"&gt;&lt;/script&gt;--&gt;......&lt;link rel="stylesheet" type="text/css" href="css/swiper.min.css"&gt;......&lt;div class="swiper-container"&gt; &lt;div class="swiper-wrapper"&gt; &lt;div class="swiper-slide"&gt;slider1&lt;/div&gt; &lt;div class="swiper-slide"&gt;slider2&lt;/div&gt; &lt;div class="swiper-slide"&gt;slider3&lt;/div&gt; &lt;/div&gt; &lt;div class="swiper-pagination"&gt;&lt;/div&gt; &lt;div class="swiper-button-prev"&gt;&lt;/div&gt; &lt;div class="swiper-button-next"&gt;&lt;/div&gt;&lt;/div&gt;&lt;script&gt; var swiper = new Swiper('.swiper-container', &#123; pagination: '.swiper-pagination', prevButton: '.swiper-button-prev', nextButton: '.swiper-button-next', initialSlide :1, paginationClickable: true, loop: true, autoplay:3000, autoplayDisableOnInteraction:false&#125;);&lt;/script&gt;2. swiperä½¿ç”¨å‚æ•°1ã€initialSlideï¼šåˆå§‹ç´¢å¼•å€¼ï¼Œä»Ž0å¼€å§‹2ã€directionï¼šæ»‘åŠ¨æ–¹å‘ horizontal | vertical3ã€speedï¼šæ»‘åŠ¨é€Ÿåº¦ï¼Œå•ä½ms4ã€autoplayï¼šè®¾ç½®è‡ªåŠ¨æ’­æ”¾åŠæ’­æ”¾æ—¶é—´5ã€autoplayDisableOnInteractionï¼šç”¨æˆ·æ“ä½œswipeåŽæ˜¯å¦è¿˜è‡ªåŠ¨æ’­æ”¾ï¼Œé»˜è®¤æ˜¯trueï¼Œä¸å†è‡ªåŠ¨æ’­æ”¾6ã€paginationï¼šåˆ†é¡µåœ†ç‚¹7ã€paginationClickableï¼šåˆ†é¡µåœ†ç‚¹æ˜¯å¦ç‚¹å‡»8ã€prevButtonï¼šä¸Šä¸€é¡µç®­å¤´9ã€nextButtonï¼šä¸‹ä¸€é¡µç®­å¤´10ã€loopï¼šæ˜¯å¦é¦–å°¾è¡”æŽ¥swiperåˆ¶ä½œå®žä¾‹swiperåˆ¶ä½œç§»åŠ¨ç«¯ç„¦ç‚¹å›¾å®žä¾‹]]></content>
      <categories>
        <category>JavaScript</category>
        <category>jQuery</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
        <tag>jQuery</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[zabbixé‚®ä»¶æŠ¥è­¦]]></title>
    <url>%2F2019%2F06%2F17%2Fzabbix%E9%82%AE%E4%BB%B6%E6%8A%A5%E8%AD%A6%2F</url>
    <content type="text"><![CDATA[é‚®ä»¶æŠ¥è­¦æƒ…å†µåˆ†ç±»ç¬¬ä¸€ç§æƒ…å†µï¼šZabbixæœåŠ¡ç«¯åªæ˜¯å•çº¯çš„å‘é€æŠ¥è­¦é‚®ä»¶åˆ°æŒ‡å®šé‚®ç®±ï¼Œå‘é€æŠ¥è­¦é‚®ä»¶çš„è¿™ä¸ªé‚®ç®±è´¦å·æ˜¯ZabbixæœåŠ¡ç«¯çš„æœ¬åœ°é‚®ç®±è´¦å·ï¼ˆä¾‹å¦‚ï¼šroot@localhost.localdomainï¼‰ï¼Œåªèƒ½å‘é€ï¼Œä¸èƒ½æŽ¥æ”¶å¤–éƒ¨é‚®ä»¶ã€‚ç¬¬äºŒç§æƒ…å†µï¼šä½¿ç”¨ä¸€ä¸ªå¯ä»¥åœ¨äº’è”ç½‘ä¸Šæ­£å¸¸æ”¶å‘é‚®ä»¶çš„é‚®ç®±è´¦å·ï¼ˆä¾‹å¦‚ï¼šxxx@163.comï¼‰ï¼Œé€šè¿‡åœ¨ZabbixæœåŠ¡ç«¯ä¸­è®¾ç½®ï¼Œä½¿å…¶èƒ½å¤Ÿå‘é€æŠ¥è­¦é‚®ä»¶åˆ°æŒ‡å®šé‚®ç®±ã€‚æ­¤ä¸¤ç§æ–¹æ³•ï¼Œä¼˜å…ˆä½¿ç”¨ç¬¬ä¸€ç§æ–¹æ³•ï¼Œ(æ”¶ä»¶äººé‚®ç®±éœ€è¦æ·»åŠ ç™½åå•)ä½¿ç”¨ZabbixæœåŠ¡ç«¯æœ¬åœ°é‚®ç®±è´¦å·å‘é€é‚®ä»¶1. å®‰è£…sendmailæˆ–è€…postfix12345# ä»¥sendmailä¸ºä¾‹ï¼Œsendmailå’Œpostfixåªéœ€è¦å®‰è£…ä¸€ä¸ªå¹¶å¼€å¯æœåŠ¡å³å¯[root@localhost ~]# yum install sendmail[root@localhost ~]# systemctl start sendmail.service[root@localhost ~]# systemctl enable sendmail.service[root@localhost ~]# systemctl daemon-reload2. å®‰è£…é‚®ä»¶å‘é€å·¥å…·mailx1[root@localhost ~]# yum install mailx3. æµ‹è¯•å‘é€é‚®ä»¶1[root@localhost ~]# echo "zabbix test mail" | mail -s "zabbix" 1103324414@qq.com4. é…ç½®ZabbixæœåŠ¡ç«¯é‚®ä»¶æŠ¥è­¦ç®¡ç†ï¼ŒæŠ¥è­¦åª’ä»‹ç±»åž‹ï¼ŒæŠŠè‡ªå¸¦çš„ä¸‰ä¸ªå…¨éƒ½ç»™ç¦ç”¨ï¼Œç„¶åŽå³ä¸Šè§’â€œåˆ›å»ºåª’ä½“ç±»åž‹â€ã€‚æ³¨æ„ï¼šè‹¥ä¸Šå›¾ä¸­çš„127.0.0.1å¡«å†™æˆlocalhostçš„è¯ï¼Œå‘é€é‚®ä»¶æ—¶åˆ™ä¼šæŠ¥é”™ï¼šcannot connect to SMTP server [localhost]: cannot connect to [[localhost]:25]: [111] Connection refusedå¤‡æ³¨ï¼šSMTPæœåŠ¡å™¨å’ŒSMPT HELOå¡«å†™çš„æ˜¯Zabbixç›‘æŽ§ç«¯ä¸»æœºåç§°ï¼Œå»ºè®®ä¿®æ”¹ï¼Œå¦åˆ™ä½¿ç”¨é»˜è®¤çš„localhost.localdomainå‘é€é‚®ä»¶ä¼šè¢«å½“åšåžƒåœ¾é‚®ä»¶æ‹¦æˆªã€‚5. è®¾ç½®Zabbixç”¨æˆ·æŠ¥è­¦é‚®ç®±åœ°å€ç®¡ç†ï¼Œç”¨æˆ·ï¼Œç‚¹å‡»Adminï¼Œç‚¹å‡»æŠ¥è­¦åª’ä»‹ï¼Œç‚¹å‡»æ·»åŠ ï¼Œåœ¨ç±»åž‹ä¸­é€‰æ‹©ä¸Šä¸€æ­¥æ·»åŠ çš„åª’ä½“ç±»åž‹ï¼Œåœ¨è¿™é‡Œé€‰æ‹©ï¼šâ€œé‚®ä»¶æŠ¥è­¦â€ï¼Œåœ¨æ”¶ä»¶äººä¸­è¾“å…¥æ”¶ä»¶äººé‚®ç®±ï¼Œç„¶åŽç‚¹å‡»æ·»åŠ ã€‚5. è®¾ç½®Zabbixè§¦å‘æŠ¥è­¦çš„åŠ¨ä½œé…ç½®ï¼ŒåŠ¨ä½œï¼Œå³ä¸Šè§’åˆ›å»ºåŠ¨ä½œï¼Œå¦‚å›¾æ‰€ç¤ºï¼š1234567891011121314151617181920212223åç§°ï¼šAction-Emailé»˜è®¤æ ‡é¢˜ï¼šæ•…éšœ&#123;TRIGGER.STATUS&#125;,æœåŠ¡å™¨:&#123;HOSTNAME1&#125;å‘ç”Ÿ: &#123;TRIGGER.NAME&#125;æ•…éšœ!æ¶ˆæ¯å†…å®¹ï¼š å‘Šè­¦ä¸»æœº:&#123;HOSTNAME1&#125; å‘Šè­¦æ—¶é—´:&#123;EVENT.DATE&#125; &#123;EVENT.TIME&#125; å‘Šè­¦ç­‰çº§:&#123;TRIGGER.SEVERITY&#125; å‘Šè­¦ä¿¡æ¯: &#123;TRIGGER.NAME&#125; å‘Šè­¦é¡¹ç›®:&#123;TRIGGER.KEY1&#125; é—®é¢˜è¯¦æƒ…:&#123;ITEM.NAME&#125;:&#123;ITEM.VALUE&#125; å½“å‰çŠ¶æ€:&#123;TRIGGER.STATUS&#125;:&#123;ITEM.VALUE1&#125; äº‹ä»¶ID:&#123;EVENT.ID&#125;æ¢å¤ä¸»é¢˜ï¼šæ¢å¤&#123;TRIGGER.STATUS&#125;, æœåŠ¡å™¨:&#123;HOSTNAME1&#125;: &#123;TRIGGER.NAME&#125;å·²æ¢å¤!æ¢å¤ä¿¡æ¯ï¼š å‘Šè­¦ä¸»æœº:&#123;HOSTNAME1&#125; å‘Šè­¦æ—¶é—´:&#123;EVENT.DATE&#125; &#123;EVENT.TIME&#125; å‘Šè­¦ç­‰çº§:&#123;TRIGGER.SEVERITY&#125; å‘Šè­¦ä¿¡æ¯: &#123;TRIGGER.NAME&#125; å‘Šè­¦é¡¹ç›®:&#123;TRIGGER.KEY1&#125; é—®é¢˜è¯¦æƒ…:&#123;ITEM.NAME&#125;:&#123;ITEM.VALUE&#125; å½“å‰çŠ¶æ€:&#123;TRIGGER.STATUS&#125;:&#123;ITEM.VALUE1&#125; äº‹ä»¶ID:&#123;EVENT.ID&#125;6. æµ‹è¯•ZabbixæŠ¥è­¦12# åœæ­¢zabbix-agent[root@localhost ~]# systemctl stop zabbix-agent.serviceæŠ¥è¡¨ï¼ŒåŠ¨ä½œæ—¥å¿—ï¼š12# æ¢å¤å¯åŠ¨zabbix-agent[root@localhost ~]# systemctl start zabbix-agent.service7. é—®é¢˜éœ€è¦å…ˆé…ç½®å¥½ç›‘æŽ§ä¸»æœºï¼Œå°¤å…¶æ˜¯ç›‘æŽ§é¡¹ï¼šAgent pingï¼Œä¸ç„¶è§¦å‘åŠ¨ä½œå’Œæµ‹è¯•æŠ¥è­¦éƒ½éœ€è¦æ ¹æ®å®žé™…æƒ…å†µè€Œå®šåœ¨webç•Œé¢çœ‹åˆ°æŠ¥è­¦é‚®ä»¶å·²é€è¾¾ï¼Œä½†æ˜¯é‚®ç®±é‡Œå¹¶æ²¡æœ‰æ”¶åˆ°é‚®ä»¶ï¼Œåžƒåœ¾ç®±ä¸­ä¹Ÿæ²¡æœ‰ã€‚ä½†æ˜¯æ–‡ä»¶/var/spool/mail/rootä¸­æœ‰ç›¸åº”çš„æŠ¥é”™ä¿¡æ¯ï¼Œæš‚æ—¶ä¸çŸ¥é“å¦‚ä½•å¤„ç†ã€‚è§£å†³åŠžæ³•ï¼šå› ä¸ºè¢«æ”¶ä»¶é‚®ç®±ç»™æ‹¦æˆªäº†ï¼Œéœ€è¦æ·»åŠ å‘ä»¶äººç™½åå•æ‰èƒ½æ”¶åˆ°é‚®ä»¶ï¼šzabbix@localhost.localdomainå’Œzabbix@127.0.0.1ä½¿ç”¨å¤–éƒ¨é‚®ç®±è´¦å·å‘é€æŠ¥è­¦é‚®ä»¶è®¾ç½®ä½¿ç”¨å¤–éƒ¨é‚®ç®±è´¦å·æ—¶ï¼Œä¸éœ€è¦å¯åŠ¨sendmailæˆ–è€…postfixã€‚å¦‚æžœåœ¨sendmailæˆ–è€…postfixå¯åŠ¨çš„åŒæ—¶ä½¿ç”¨å¤–éƒ¨é‚®ç®±å‘é€æŠ¥è­¦é‚®ä»¶ï¼Œé¦–å…ˆä¼šè¯»å–å¤–éƒ¨é‚®ç®±ã€‚1. åœç”¨sendmailæˆ–è€…postfix1234# ä»¥sendmailä¸ºä¾‹ï¼Œsendmailå’Œpostfixåªéœ€è¦å®‰è£…ä¸€ä¸ªå¹¶åœç”¨æœåŠ¡å³å¯[root@localhost ~]# systemctl stop sendmail.service[root@localhost ~]# systemctl disable sendmail.service[root@localhost ~]# systemctl daemon-reload2. å®‰è£…é‚®ä»¶å‘é€å·¥å…·mailx1[root@localhost ~]# yum install mailx3. é…ç½®ZabbixæœåŠ¡ç«¯å¤–éƒ¨é‚®ç®±1234567[root@localhost ~]# vim /etc/mail.rc set sendcharsets=iso-8859-1,utf-8set from=payment@ejubei.cnset smtp=smtp.mxhichina.comset smtp-auth-user=payment@ejubei.cnset smtp-auth-password=xxxxxxxxxset smtp-auth=login4. æµ‹è¯•å‘é€é‚®ä»¶1[root@localhost ~]# echo "zabbix test mail" | mail -s "zabbix" 1103324414@qq.com5. é…ç½®ZabbixæœåŠ¡ç«¯é‚®ä»¶æŠ¥è­¦ç®¡ç†ï¼ŒæŠ¥è­¦åª’ä»‹ç±»åž‹ï¼ŒæŠŠè‡ªå¸¦çš„ä¸‰ä¸ªå…¨éƒ½ç»™ç¦ç”¨ï¼Œç„¶åŽå³ä¸Šè§’â€œåˆ›å»ºåª’ä½“ç±»åž‹â€ã€‚6. è®¾ç½®Zabbixç”¨æˆ·æŠ¥è­¦é‚®ç®±åœ°å€ç®¡ç†ï¼Œç”¨æˆ·ï¼Œç‚¹å‡»Adminï¼Œç‚¹å‡»æŠ¥è­¦åª’ä»‹ï¼Œç‚¹å‡»æ·»åŠ ï¼Œåœ¨ç±»åž‹ä¸­é€‰æ‹©ä¸Šä¸€æ­¥æ·»åŠ çš„åª’ä½“ç±»åž‹ï¼Œåœ¨è¿™é‡Œé€‰æ‹©ï¼šâ€œSendmailâ€ï¼Œåœ¨æ”¶ä»¶äººä¸­è¾“å…¥æ”¶ä»¶äººé‚®ç®±ï¼Œç„¶åŽç‚¹å‡»æ·»åŠ ã€‚7. è®¾ç½®Zabbixè§¦å‘æŠ¥è­¦çš„åŠ¨ä½œé…ç½®ï¼ŒåŠ¨ä½œï¼Œå³ä¸Šè§’åˆ›å»ºåŠ¨ä½œï¼Œå¦‚å›¾æ‰€ç¤ºï¼š1234567891011121314151617181920212223åç§°ï¼šAction-Emailé»˜è®¤æ ‡é¢˜ï¼šæ•…éšœ&#123;TRIGGER.STATUS&#125;,æœåŠ¡å™¨:&#123;HOSTNAME1&#125;å‘ç”Ÿ: &#123;TRIGGER.NAME&#125;æ•…éšœ!æ¶ˆæ¯å†…å®¹ï¼š å‘Šè­¦ä¸»æœº:&#123;HOSTNAME1&#125; å‘Šè­¦æ—¶é—´:&#123;EVENT.DATE&#125; &#123;EVENT.TIME&#125; å‘Šè­¦ç­‰çº§:&#123;TRIGGER.SEVERITY&#125; å‘Šè­¦ä¿¡æ¯: &#123;TRIGGER.NAME&#125; å‘Šè­¦é¡¹ç›®:&#123;TRIGGER.KEY1&#125; é—®é¢˜è¯¦æƒ…:&#123;ITEM.NAME&#125;:&#123;ITEM.VALUE&#125; å½“å‰çŠ¶æ€:&#123;TRIGGER.STATUS&#125;:&#123;ITEM.VALUE1&#125; äº‹ä»¶ID:&#123;EVENT.ID&#125;æ¢å¤ä¸»é¢˜ï¼šæ¢å¤&#123;TRIGGER.STATUS&#125;, æœåŠ¡å™¨:&#123;HOSTNAME1&#125;: &#123;TRIGGER.NAME&#125;å·²æ¢å¤!æ¢å¤ä¿¡æ¯ï¼š å‘Šè­¦ä¸»æœº:&#123;HOSTNAME1&#125; å‘Šè­¦æ—¶é—´:&#123;EVENT.DATE&#125; &#123;EVENT.TIME&#125; å‘Šè­¦ç­‰çº§:&#123;TRIGGER.SEVERITY&#125; å‘Šè­¦ä¿¡æ¯: &#123;TRIGGER.NAME&#125; å‘Šè­¦é¡¹ç›®:&#123;TRIGGER.KEY1&#125; é—®é¢˜è¯¦æƒ…:&#123;ITEM.NAME&#125;:&#123;ITEM.VALUE&#125; å½“å‰çŠ¶æ€:&#123;TRIGGER.STATUS&#125;:&#123;ITEM.VALUE1&#125; äº‹ä»¶ID:&#123;EVENT.ID&#125;8. æ·»åŠ ZabbixæœåŠ¡ç«¯é‚®ä»¶å‘é€è„šæœ¬123456789101112131415# æŸ¥çœ‹é»˜è®¤æƒ…å†µä¸‹è„šæœ¬å­˜æ”¾è·¯å¾„[root@localhost ~]# cat /etc/zabbix/zabbix_server.conf | grep 'alert'AlertScriptsPath=/usr/lib/zabbix/alertscripts[root@localhost ~]# cd /usr/lib/zabbix/alertscripts[root@localhost alertscripts]# vim sendmail.sh #!/bin/bashmessages=`echo $3 | tr '\r\n' '\n'`subject=`echo $2 | tr '\r\n' '\n'`echo "$&#123;messages&#125;" | mail -s "$&#123;subject&#125;" $1 &gt;&gt;/tmp/sendmail.log 2&gt;&amp;1[root@localhost ~]# chown zabbix.zabbix /usr/lib/zabbix/alertscripts/sendmail.sh[root@localhost ~]# chmod +x /usr/lib/zabbix/alertscripts/sendmail.sh[root@localhost ~]# chown zabbix.zabbix /tmp/sendmail.log9. æµ‹è¯•ZabbixæŠ¥è­¦12# åœæ­¢zabbix-agent[root@localhost ~]# systemctl stop zabbix-agent.serviceæŠ¥è¡¨ï¼ŒåŠ¨ä½œæ—¥å¿—ï¼š12# æ¢å¤å¯åŠ¨zabbix-agent[root@localhost ~]# systemctl start zabbix-agent.service10. é—®é¢˜éœ€è¦å…ˆé…ç½®å¥½ç›‘æŽ§ä¸»æœºï¼Œå°¤å…¶æ˜¯ç›‘æŽ§é¡¹ï¼šAgent pingï¼Œä¸ç„¶è§¦å‘åŠ¨ä½œå’Œæµ‹è¯•æŠ¥è­¦éƒ½éœ€è¦æ ¹æ®å®žé™…æƒ…å†µè€Œå®šè‹¥zabbixéƒ¨ç½²åœ¨é˜¿é‡Œäº‘ä¸»æœºä¸Šçš„é—®é¢˜å¤„ç†å› ä¸ºé˜¿é‡Œäº‘ä¸»æœºé»˜è®¤å±è”½25ç«¯å£ï¼Œç»æµ‹è¯•å¯ä»¥ä½¿ç”¨sslçš„465ç«¯å£ï¼Œæ‰€ä»¥æ­¤æ—¶é‡‡ç”¨ç¬¬äºŒç§æ–¹æ³•ã€‚ä½†æ˜¯å°±ç®—ä½¿ç”¨ç¬¬äºŒç§æ–¹æ³•ä¹Ÿå¾—åšä¸€äº›å…¶ä»–é¢å¤–çš„æ“ä½œï¼Œå¦åˆ™zabbixä¸Šæç¤ºé‚®ä»¶å·²é€è¾¾ï¼Œä½†æ˜¯é‚®ç®±æ”¶ä¸åˆ°é‚®ä»¶ã€‚è¿™ä¸ªé¢å¤–çš„åŠžæ³•å°±æ˜¯ä½¿ç”¨465ç«¯å£æ¥å‘é‚®ä»¶éœ€è¦ä½¿å¾—sslè¯ä¹¦è®¤è¯ã€‚1. å…³é—­å…¶å®ƒé‚®ä»¶å·¥å…·12[root@localhost ~]# systemctl stop sendmail.service[root@localhost ~]# systemctl stop postfix.service2. å®‰è£…mailx1[root@localhost ~]# yum install mailx3. æ³¨å†Œä½¿ç”¨é˜¿é‡Œäº‘ä¼ä¸šé‚®ç®±è¯¥æ­¥éª¤å®žçŽ°å®Œæˆï¼ŒæŽ¥ä¸‹æ¥çš„æ­¥éª¤éƒ½æ˜¯ä½¿ç”¨è¯¥é‚®ç®±ä½œä¸ºå‘ä»¶ç®±4. è¯·æ±‚æ•°å­—è¯ä¹¦å› ä¸ºä½¿ç”¨çš„å‘ä»¶ç®±æ˜¯é˜¿é‡Œäº‘çš„ä¼ä¸šé‚®ç®±ï¼Œæ‰€ä»¥å‘é˜¿é‡Œäº‘è¯·æ±‚è¯ä¹¦ï¼Œå…¶ä»–æ­¥éª¤æ“ä½œç±»ä¼¼ã€‚1234567891011121314[root@localhost ~]# mkdir .certs[root@localhost ~]# echo -n | openssl s_client -connect smtp.mxhichina.com:465 | sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' &gt; /root/.certs/aliyun.crt[root@localhost ~]# certutil -A -n "GeoTrust SSL CA" -t "C,," -d /root/.certs -i /root/.certs/aliyun.crt[root@localhost ~]# certutil -A -n "GeoTrust Global CA" -t "C,," -d /root/.certs -i /root/.certs/aliyun.crt[root@localhost ~]# certutil -A -n "GeoTrust SSL CA - G3" -t "Pu,Pu,Pu" -d /root/.certs/./ -i /root/.certs/aliyun.crtNotice: Trust flag u is set automatically if the private key is present.[root@localhost ~]# ls /root/.certs/aliyun.crt cert8.db key3.db secmod.db[root@localhost ~]# certutil -L -d /root/.certsCertificate Nickname Trust Attributes SSL,S/MIME,JAR/XPIGeoTrust SSL CA P,P,P5. é…ç½®/etc/mail.rc12345678set sendcharsets=iso-8859-1,utf-8set from=alram@lrcq.com.cnset smtp="smtps://smtp.mxhichina.com:465"set smtp-auth-user=alram@lrcq.com.cnset smtp-auth-password=xxxxxxxxxxxset smtp-auth=loginset ssl-verify=ignoreset nss-config-dir=/root/.certs6. å‘é€é‚®ä»¶æµ‹è¯•1[root@localhost ~]# echo "é‚®ä»¶æ­£æ–‡" | mail -s "é‚®ä»¶ä¸»é¢˜" 1103324414@qq.com7. è¯ä¹¦æƒé™å¤„ç†è¿™ä¸ªè¯ä¹¦æ–‡ä»¶æ˜¯ç»™zabbixç”¨æˆ·ä½¿ç”¨çš„ï¼Œå¦‚æžœæ˜¯åœ¨/root/.certsç›®å½•ä¸‹ï¼Œzabbixç”¨æˆ·æ— æ³•è®¿é—®ï¼Œå‘é€é‚®ä»¶æ—¶ä¼šå‡ºçŽ°ï¼šError initializing NSS: Unknown error -8015.æ­¤æ—¶éœ€è¦æŠŠè¯ä¹¦ç§»åŠ¨åˆ°zabbixç”¨æˆ·å¯ä»¥è®¿é—®ä½ çš„åœ°æ–¹ï¼Œæ¯”å¦‚ç§»åŠ¨åˆ°/etc/zabbix/ç›®å½•ä¸‹1234[root@localhost ~]# mv /root/.certs /etc/zabbix/.# ä¿®æ”¹/etc/mail.rcæ–‡ä»¶ä¸­çš„è¯ä¹¦è·¯å¾„[root@localhost ~]# vim /etc/mail.rcset nss-config-dir=/etc/zabbix/.certs8. å…¶ä»–æ“ä½œç®¡ç†ï¼ŒæŠ¥è­¦åª’ä»‹ç±»åž‹ï¼Œåˆ›å»ºåª’ä»‹ç±»åž‹é…ç½®ï¼Œç”¨æˆ·ï¼Œç‚¹å‡»â€œAdminâ€ï¼ŒæŠ¥è­¦åª’ä»‹ï¼Œæ·»åŠ å¤šæ¬¡æ·»åŠ åˆ™å¯ä»¥æ·»åŠ å¤šä¸ªæ”¶ä»¶äººé…ç½®ï¼ŒåŠ¨ä½œï¼Œåˆ›å»ºåŠ¨ä½œ]]></content>
      <categories>
        <category>CentOS</category>
        <category>Zabbix</category>
      </categories>
      <tags>
        <tag>CentOS</tag>
        <tag>Zabbix</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CentOS7 yum å®‰è£…ä¸Žé…ç½®MySQL5.7]]></title>
    <url>%2F2019%2F06%2F14%2FCentOS7%20yum%20%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AEMySQL5.7%2F</url>
    <content type="text"><![CDATA[1ã€é…ç½®YUMæº1234# å®‰è£…yumæº# yum install http://dev.mysql.com/get/mysql57-community-release-el7-8.noarch.rpm# æ£€æŸ¥mysqlæºæ˜¯å¦å®‰è£…æˆåŠŸ# yum repolist enabled | grep "mysql.*-community.*"2. å®‰è£…MySQL123456# å®‰è£…MySQL# yum install mysql-community-server# å¯åŠ¨# systemctl start mysqld# æŸ¥çœ‹çŠ¶æ€# systemctl status mysqld3. å¼€æœºå¯åŠ¨12# systemctl enable mysqld# systemctl daemon-reload4. ä¿®æ”¹rootæœ¬åœ°ç™»å½•å¯†ç mysqlå®‰è£…å®Œæˆä¹‹åŽï¼Œåœ¨/var/log/mysqld.logæ–‡ä»¶ä¸­ç»™rootç”Ÿæˆäº†ä¸€ä¸ªé»˜è®¤å¯†ç ã€‚é€šè¿‡ä¸‹é¢çš„æ–¹å¼æ‰¾åˆ°rooté»˜è®¤å¯†ç ï¼Œç„¶åŽç™»å½•mysqlè¿›è¡Œä¿®æ”¹ï¼š1234567# æŸ¥çœ‹rootå¯†ç # grep 'temporary password' /var/log/mysqld.log# ç™»å½•ä¿®æ”¹å¯†ç # mysql -u root -pALTER USER 'root'@'localhost' IDENTIFIED BY 'nicaimima!@#123';# ä¿®æ”¹å¯†ç æˆ–è€…ä½¿ç”¨set password for 'root'@'localhost'=password('nicaimima!@#123');æ³¨æ„ï¼šmysql5.7é»˜è®¤å®‰è£…äº†å¯†ç å®‰å…¨æ£€æŸ¥æ’ä»¶ï¼ˆvalidate_passwordï¼‰ï¼Œé»˜è®¤å¯†ç æ£€æŸ¥ç­–ç•¥è¦æ±‚å¯†ç å¿…é¡»åŒ…å«ï¼šå¤§å°å†™å­—æ¯ã€æ•°å­—å’Œç‰¹æ®Šç¬¦å·ï¼Œå¹¶ä¸”é•¿åº¦ä¸èƒ½å°‘äºŽ8ä½ã€‚å¦åˆ™ä¼šæç¤ºERROR 1819 (HY000): Your password does not satisfy the current policy requirementsé”™è¯¯ã€‚é€šè¿‡msyqlçŽ¯å¢ƒå˜é‡å¯ä»¥æŸ¥çœ‹å¯†ç ç­–ç•¥çš„ç›¸å…³ä¿¡æ¯ï¼š1show variables like '%password%';5. ä¿®æ”¹å¯†ç ç­–ç•¥åœ¨/etc/my.cnfæ–‡ä»¶æ·»åŠ validate_password_policyé…ç½®ï¼ŒæŒ‡å®šå¯†ç ç­–ç•¥12# é€‰æ‹©0ï¼ˆLOWï¼‰ï¼Œ1ï¼ˆMEDIUMï¼‰ï¼Œ2ï¼ˆSTRONGï¼‰å…¶ä¸­ä¸€ç§ï¼Œé€‰æ‹©2éœ€è¦æä¾›å¯†ç å­—å…¸æ–‡ä»¶validate_password_policy=0å¦‚æžœä¸éœ€è¦å¯†ç ç­–ç•¥ï¼Œæ·»åŠ my.cnfæ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ç¦ç”¨å³å¯ï¼š1validate_password = offé‡æ–°å¯åŠ¨mysqlæœåŠ¡ä½¿é…ç½®ç”Ÿæ•ˆï¼š1# systemctl restart mysqld6. æ–‡ä»¶ç›¸å…³é»˜è®¤é…ç½®æ–‡ä»¶è·¯å¾„ï¼šé…ç½®æ–‡ä»¶ï¼š/etc/my.cnfå®‰è£…è·¯å¾„ï¼š/var/lib/mysqlæ—¥å¿—æ–‡ä»¶ï¼š/var/log/mysqld.logæœåŠ¡å¯åŠ¨è„šæœ¬ï¼š/usr/lib/systemd/system/mysqld.servicesocketæ–‡ä»¶ï¼š/var/run/mysqld/mysqld.pid7. å¿˜è®°rootå¯†ç å¦‚æžœå¿˜è®°rootå¯†ç ï¼Œåˆ™æŒ‰å¦‚ä¸‹æ“ä½œæ¢å¤ï¼šç¼–è¾‘/etc/my.cnfæ–‡ä»¶ï¼Œåœ¨[mysqld]çš„æ®µä¸­åŠ ä¸Šä¸€å¥ï¼šskip-grant-tables ä¿å­˜å¹¶ä¸”é€€å‡ºã€‚123# mysql -u root -p #æ­¤æ—¶ç™»å½•ä¸éœ€è¦å¯†ç &gt;&gt;&gt; update mysql.user set authentication_string=password('nicaimima!@#123') where user='root' and Host = 'localhost';&gt;&gt;&gt; flush privileges;]]></content>
      <categories>
        <category>CentOS</category>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>CentOS</tag>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Typoraå’ŒMarkdownPad 2ä»¥åŠnextä¸»é¢˜ç›¸å…³çŸ¥è¯†]]></title>
    <url>%2F2019%2F03%2F29%2FTypora%E5%92%8CMarkdownPad%202%E4%BB%A5%E5%8F%8Anext%E4%B8%BB%E9%A2%98%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%2F</url>
    <content type="text"><![CDATA[MarkdownPad 2ä¼˜ç‚¹ï¼šå¯ä»¥ä¸Šä¼ æœ¬åœ°å›¾ç‰‡åˆ°ç½‘ç»œ,åœ¨mdæ–‡ä»¶ä¸­å›¾ç‰‡ä½¿ç”¨çš„æ˜¯ä¸Šä¼ åŽçš„ç½‘ç»œå›¾ç‰‡è·¯å¾„ç¼ºç‚¹ï¼šæ— æ³•ä½¿ç”¨æœ¬åœ°è·¯å¾„çš„å›¾ç‰‡æ— æ³•é¢„è§ˆä¸Šä¼ åŽçš„ç½‘ç»œå›¾ç‰‡åœ¨Nextä¸»é¢˜ä¸­ï¼Œé»˜è®¤é‡‡ç”¨çš„è·¯å¾„éƒ½æ˜¯themes/ä¸»é¢˜å/sourceï¼Œä½¿ç”¨æœ¬åœ°ç›¸å¯¹è·¯å¾„å›¾ç‰‡åœ°å€æ ¼å¼ï¼š![](/image/1.png) ï¼Œä¹Ÿå°±æ˜¯ï¼šthemes/next/source/image/1.pngã€‚æ³¨æ„ï¼šå›¾ç‰‡ç›¸å¯¹è·¯å¾„å¼€å¤´æ˜¯/Typoraä¼˜ç‚¹ï¼šå¯ä»¥ä½¿ç”¨æœ¬åœ°è·¯å¾„çš„å›¾ç‰‡ï¼Œè·¯å¾„æ˜¯ä»¥å½“å‰æ–‡ä»¶æ‰€åœ¨è·¯å¾„ä¸ºæ ¹ç›®å½•ï¼Œé‡‡ç”¨æ­¤ç§æ–¹å¼çš„å›¾ç‰‡å¯ä»¥é¢„è§ˆåŠŸèƒ½é½å…¨ç­‰ç¼ºç‚¹ï¼šæ— æ³•æŠŠæœ¬åœ°å›¾ç‰‡ä¸Šä¼ åˆ°ç½‘ç»œï¼Œè¿›è€Œä½¿ç”¨ä¸Šä¼ åŽçš„ç½‘ç»œå›¾ç‰‡è·¯å¾„ã€‚ä½†æ˜¯å¯ä»¥ç›´æŽ¥ä½¿ç”¨ç½‘ç»œä¸­çš„å›¾ç‰‡è·¯å¾„ã€‚è·Ÿhextä¸»é¢˜ç›¸ç»“åˆä½¿ç”¨çš„è¯ï¼Œå›¾ç‰‡é€”å¾„è‹¥æ˜¯ç›¸å¯¹äºŽåšå®¢æ ¹ç›®å½•çš„è¯ï¼Œå¯ä»¥åœ¨è½¯ä»¶ä¸­é¢„è§ˆã€‚ä½†æ˜¯åœ¨ç½‘ç«™ä¸Šæ— æ³•è®¿é—®è¯¥å›¾ç‰‡ã€‚ä»¥themes/ä¸»é¢˜å/sourceä¸ºæ ¹ç›®å½•çš„è¯ï¼Œæ— æ³•åœ¨è½¯ä»¶ä¸­é¢„è§ˆï¼Œä½†æ˜¯ä¸Šä¼ åˆ°ç½‘ç«™åŽå¯ä»¥æ˜¾ç¤ºå‡ºè¯¥å›¾ç‰‡ã€‚ç»“è®ºï¼šMarkdownPad 2å¯ä»¥ä¸Šä¼ æœ¬åœ°å›¾ç‰‡åˆ°ç½‘è·¯è·¯å¾„ä½¿ç”¨ï¼Œä½†æ˜¯æ— æ³•é¢„è§ˆï¼Œåœ¨Typoraä¸­ä¹Ÿä¸èƒ½é¢„è§ˆï¼Œä¸Šä¼ çš„åšå®¢ç½‘ç«™å¯ä»¥ä½¿ç”¨Typoraä¸èƒ½ä¸Šä¼ æœ¬åœ°å›¾ç‰‡åˆ°ç½‘è·¯è·¯å¾„ä½¿ç”¨MarkdownPad 2ä½¿ç”¨ç¬¬ä¸‰æ–¹å›¾ç‰‡ç½‘ç»œè·¯å¾„å¯ä»¥é¢„è§ˆTyporaèƒ½é¢„è§ˆæœ¬åœ°è·¯å¾„çš„å›¾ç‰‡å’Œä½¿ç”¨ç¬¬ä¸‰æ–¹å›¾ç‰‡ç½‘ç»œè·¯å¾„çš„å›¾ç‰‡ä»¥åŽç¼–å†™mdæ–‡ä»¶ä½¿ç”¨å›¾ç‰‡çš„è¯ï¼Œä¼˜å…ˆæŠŠå›¾ç‰‡ä¸Šä¼ åˆ°ç¬¬ä¸‰æ–¹ç½‘ç»œé‡Œï¼Œç„¶åŽå†å¼•ç”¨å›¾ç‰‡é“¾æŽ¥åœ°å€ã€‚]]></content>
      <categories>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>hexo</tag>
        <tag>Typora</tag>
        <tag>MarkdownPad 2</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Markdownç”¨æ³•æ±‡æ€»]]></title>
    <url>%2F2019%2F03%2F29%2FMarkdown%E7%94%A8%E6%B3%95%E6%B1%87%E6%80%BB%2F</url>
    <content type="text"><![CDATA[[TOC]Markdownæ˜¯ä»€ä¹ˆMarkdwon æ˜¯ä¸€ç§è½»é‡çº§ æ ‡è®°è¯­è¨€ï¼Œå®ƒä»¥çº¯æ–‡æœ¬å½¢å¼ï¼ˆæ˜“è¯»ã€æ˜“å†™ã€æ˜“æ›´æ”¹ï¼‰ç¼–å†™æ–‡æ¡£ï¼Œå¹¶æœ€ç»ˆä»¥HTLMæ ¼å¼å‘å¸ƒã€‚Markdownä¹Ÿå¯ä»¥ç†è§£ä¸ºå°†ä»¥ MARKDOWNè¯­æ³•ç¼–å†™çš„è¯­è¨€è½¬æ¢æˆHTMLå†…å®¹çš„å·¥å…·ã€‚ä¸ºä»€ä¹ˆè¦ä½¿ç”¨Markdownå®ƒæ˜¯æ˜“è¯»ï¼ˆçœ‹èµ·æ¥èˆ’æœðŸ˜Œï¼‰ã€æ˜“å†™ï¼ˆè¯­æ³•ç®€å•ï¼‰ã€æ˜“æ›´æ”¹ï¼ˆçº¯æ–‡æœ¬ï¼‰ã€‚å¤„å¤„ä½“çŽ°ç€æžç®€ä¸»ä¹‰çš„å½±å­å…¼å®¹HTML,å¯ä»¥è½¬æ¢ä¸ºHTMLæ ¼å¼å‘å¸ƒè·¨å¹³å°ä½¿ç”¨è¶Šæ¥è¶Šå¤šçš„ç½‘ç«™æ”¯æŒMarkdownæ›´æ–¹ä¾¿æ¸…æ™°çš„ç»„ç»‡ä½ çš„ç”µå­é‚®ä»¶æ‘†è„±Word,txtï¼ï¼ï¼å¿«æ·é”®åŠ ç²— Ctrl + Bæ–œä½“ Ctrl + Iå¼•ç”¨ Ctrl + Qæ’å…¥é“¾æŽ¥ Ctrl + Læ’å…¥ä»£ç  Ctrl + Kæ’å…¥å›¾ç‰‡ Ctrl + Gæå‡æ ‡é¢˜ Ctrl + Hæœ‰åºåˆ—è¡¨ Ctrl + Oæ— åºåˆ—è¡¨ Ctrl + Uæ¨ªçº¿ Ctrl + Ræ’¤é”€ Ctrl + Zé‡åš Ctrl + YåŸºæœ¬è¯­æ³•å¯¹å­—ä½“è®¾ç½®æ–œä½“ã€ç²—ä½“ã€åˆ é™¤çº¿è¿™é‡Œæ˜¯æ–‡å­—è¿™é‡Œæ˜¯æ–‡å­—è¿™é‡Œæ˜¯æ–‡å­—è¿™é‡Œæ˜¯æ–‡å­—è¿™é‡Œæ˜¯æ–‡å­—è¿™é‡Œæ˜¯æ–‡å­—åˆ†çº§æ ‡é¢˜æœ‰å¦‚ä¸‹ä¸¤ç§å†™æ³•:å†™æ³•1:# ä¸€çº§æ ‡é¢˜ ## äºŒçº§æ ‡é¢˜ ### ä¸‰çº§æ ‡é¢˜ #### å››çº§æ ‡é¢˜ ##### äº”çº§æ ‡é¢˜ ###### å…­çº§æ ‡é¢˜ å†™æ³•2:ä¸€çº§æ ‡é¢˜ == äºŒçº§æ ‡é¢˜ -- é“¾æŽ¥æ’å…¥æœ¬åœ°å›¾ç‰‡é“¾æŽ¥è¯­æ³•è§„èŒƒ,æœ‰ä¸¤ç§å†™æ³•:1![å›¾ç‰‡alt](å›¾ç‰‡åœ°å€ &apos;å›¾ç‰‡title&apos;)å›¾ç‰‡altå°±æ˜¯æ˜¾ç¤ºåœ¨å›¾ç‰‡ä¸‹é¢çš„æ–‡å­—ï¼Œç›¸å½“äºŽå¯¹å›¾ç‰‡å†…å®¹çš„è§£é‡Šã€‚ å›¾ç‰‡titleæ˜¯å›¾ç‰‡çš„æ ‡é¢˜ï¼Œå½“é¼ æ ‡ç§»åˆ°å›¾ç‰‡ä¸Šæ—¶æ˜¾ç¤ºçš„å†…å®¹ altå’Œtitleå¯åŠ å¯ä¸åŠ  æ³¨ï¼šMarkdown ä¸èƒ½è®¾ç½®å›¾ç‰‡å¤§å°ï¼Œå¦‚æžœå¿…é¡»è®¾ç½®åˆ™åº”ä½¿ç”¨HTMLæ ‡è®°1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677`&lt;img src=&apos;/markdown_images/yunwuyue.jpg&apos;&gt;``æ’å…¥åŒçº§ç›®å½•ä¸‹çš„å›¾ç‰‡: ![äº‘æ— æœˆ](/markdown_images/yunwuyue.jpg &quot;ç¾Žå¥³&quot;) `![äº‘æ— æœˆ](/markdown_images/yunwuyue.jpg &quot;ç¾Žå¥³&quot;) `æ’å…¥ä¸‹ä¸€çº§ç›®å½•ä¸‹çš„å›¾ç‰‡: ![é£Žé‡‡é“ƒ](/markdown_images/next_image/fengcailing.jpg)`![é£Žé‡‡é“ƒ](/markdown_images/next_image/fengcailing.jpg)### æ’å…¥ç½‘ç»œå›¾ç‰‡è¯­æ³•è§„èŒƒ:`![å›¾ç‰‡æè¿°](å›¾ç‰‡è·¯å¾„)` æ³¨æ„:å›¾ç‰‡æè¿°å¯ä»¥ä¸å†™`ç¤ºä¾‹: ![](http://i1.gbimg.cn/zt/2018/04/20/gjqt3x2018y20m/myc36x/images/y_img/y_14_e.jpg)`![](http://i1.gbimg.cn/zt/2018/04/20/gjqt3x2018y20m/myc36x/images/y_img/y_14_e.jpg)### è‡ªåŠ¨è¿žæŽ¥Markdownä¸­åªè¦æ˜¯ç”¨`&lt;&gt;`åŒ…èµ·æ¥çš„å°±ä¼šè‡ªåŠ¨æŠŠå®ƒè½¬æˆé“¾æŽ¥ã€‚ä¹Ÿå¯ä»¥ç›´æŽ¥å†™ï¼Œä¹Ÿæ˜¯å¯ä»¥æ˜¾ç¤ºæˆé“¾æŽ¥å½¢å¼çš„https://blog.ejubei.net&lt;https://blog.ejubei.net&gt;![](/markdown_images/004.png)### è¶…é“¾æŽ¥ è¯­æ³•: [è¶…é“¾æŽ¥å](è¶…é“¾æŽ¥åœ°å€ &quot;è¶…é“¾æŽ¥title&quot;) titleå¯åŠ å¯ä¸åŠ ç¤ºä¾‹:[ç®€ä¹¦](http://jianshu.com)[ç™¾åº¦](http://baidu.com)## åˆ†å‰²çº¿åœ¨ä¸€è¡Œä¸­ç”¨ä¸‰ä¸ªä»¥ä¸Šçš„æ˜Ÿå·(*)ã€å‡å·(-)ã€åº•çº¿(_)æ¥å»ºç«‹ä¸€ä¸ªåˆ†éš”çº¿ï¼Œè¡Œå†…ä¸èƒ½æœ‰å…¶ä»–ä¸œè¥¿,ä¹Ÿå¯ä»¥åœ¨æ˜Ÿå·æˆ–æ˜¯å‡å·ä¸­é—´æ’å…¥ç©ºæ ¼. **** ---- ____![](/markdown_images/005.png)## æ®µè½æ®µè½çš„å‰åŽè¦æœ‰ç©ºè¡Œï¼Œæ‰€è°“çš„ç©ºè¡Œæ˜¯æŒ‡æ²¡æœ‰æ–‡å­—å†…å®¹ã€‚è‹¥æƒ³åœ¨æ®µå†…å¼ºåˆ¶æ¢è¡Œçš„æ–¹å¼æ˜¯ä½¿ç”¨ä¸¤ä¸ªä»¥ä¸Šç©ºæ ¼åŠ ä¸Šå›žè½¦ï¼ˆå¼•ç”¨ä¸­æ¢è¡Œçœç•¥å›žè½¦ï¼‰## ä»£ç å—æ’å…¥ç¨‹åºä»£ç çš„æ–¹å¼æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯åˆ©ç”¨ç¼©è¿›(tab), å¦ä¸€ç§æ˜¯åˆ©ç”¨è‹±æ–‡â€œ\`â€ç¬¦å·ï¼ˆä¸€èˆ¬åœ¨ESCé”®ä¸‹æ–¹ï¼Œå’Œ~åŒä¸€ä¸ªé”®ï¼‰åŒ…è£¹ä»£ç ã€‚### ç¼©è¿›ç¼©è¿› 4 ä¸ªç©ºæ ¼æˆ–æ˜¯ 1 ä¸ªåˆ¶è¡¨ç¬¦ inputPath = sys.argv[1] for input_file in glob.glob(os.path.join(inputPath,&apos;*.txt&apos;)): with open(input_file, &apos;r&apos;, newline=&apos;&apos;) as filereader: for row in filereader: print(&quot;&#123;&#125;&quot;.format(row.strip()))![](/markdown_images/006.png)### è¡Œå†…å¼å¦‚æžœåœ¨ä¸€ä¸ªè¡Œå†…éœ€è¦å¼•ç”¨ä»£ç ï¼Œåªè¦ç”¨åå¼•å·â€œ\`â€å¼•èµ·æ¥å°±å¥½### å¤šè¡Œä»£ç å—ä¸Žè¯­æ³•é«˜äº®åœ¨éœ€è¦é«˜äº®çš„ä»£ç å—çš„å‰ä¸€è¡ŒåŠåŽä¸€è¡Œä½¿ç”¨ä¸‰ä¸ªå•åå¼•å·â€œ\`â€åŒ…è£¹ä»£ç è¯­æ³•é«˜äº®åœ¨ ```åŽé¢åŠ ä¸Šç©ºæ ¼å’Œè¯­è¨€åç§°å³å¯```pythoninputPath = sys.argv[1]for input_file in glob.glob(os.path.join(inputPath,&apos;*.txt&apos;)): with open(input_file, &apos;r&apos;, newline=&apos;&apos;) as filereader: for row in filereader: print(&quot;&#123;&#125;&quot;.format(row.strip()))ä»£ç å—é‡Œé¢åŒ…å«htmlä»£ç åœ¨ä»£ç åŒºå—é‡Œé¢ï¼Œ &amp; ã€ &lt; å’Œ &gt; ä¼šè‡ªåŠ¨è½¬æˆ HTML å®žä½“ï¼Œåªéœ€è¦å¤åˆ¶è´´ä¸Šï¼Œå‰©ä¸‹çš„ Markdown éƒ½ä¼šå¸®ä½ å¤„ç†ã€‚1234567891011&lt;h4&gt;å¸¦æœ‰æ™®é€šçš„è¾¹æ¡†ï¼š&lt;/h4&gt;&lt;table border="1"&gt; &lt;tr&gt; &lt;td&gt;First&lt;/td&gt; &lt;td&gt;Row&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Second&lt;/td&gt; &lt;td&gt;Row&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;å¼•ç”¨åœ¨è¢«å¼•ç”¨çš„æ–‡æœ¬å‰åŠ ä¸Š&gt;ç¬¦å·ï¼Œä»¥åŠä¸€ä¸ªç©ºæ ¼å°±å¯ä»¥äº†ï¼Œå¦‚æžœåªè¾“å…¥äº†ä¸€ä¸ª&gt;ç¬¦å·ä¼šäº§ç”Ÿä¸€ä¸ªç©ºç™½çš„å¼•ç”¨.åŸºæœ¬ä½¿ç”¨è¿™æ˜¯ä¸€ä¸ªå¼•ç”¨è¿™æ˜¯å¦ä¸€ä¸ªå¼•ç”¨è¿™æ˜¯ç¬¬ä¸‰ä¸ªå¼•ç”¨åµŒå¥—å¼•ç”¨å¼•ç”¨1å¼•ç”¨2å¼•ç”¨3å¼•ç”¨3å¼•ç”¨2å¼•ç”¨1å¼•ç”¨å…¶å®ƒè¦ç´ å¼•ç”¨çš„åŒºå—å†…ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–çš„ Markdown è¯­æ³•ï¼ŒåŒ…æ‹¬æ ‡é¢˜ã€åˆ—è¡¨ã€ä»£ç åŒºå—ç­‰åˆ—è¡¨æ— åºåˆ—è¡¨ä½¿ç”¨ *ï¼Œ+ï¼Œ- è¡¨ç¤ºæ— åºåˆ—è¡¨,ç¬¦å·åŽé¢ä¸€å®šè¦æœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œèµ·åˆ°ç¼©è¿›çš„ä½œç”¨æ— åºåˆ—è¡¨1æ— åºåˆ—è¡¨2æ— åºåˆ—è¡¨1æ— åºåˆ—è¡¨2æ— åºåˆ—è¡¨1æ— åºåˆ—è¡¨2æœ‰åºåˆ—è¡¨ä½¿ç”¨æ•°å­—å’Œä¸€ä¸ªè‹±æ–‡å¥ç‚¹è¡¨ç¤ºæœ‰åºåˆ—è¡¨,è‹±æ–‡å¥ç‚¹åŽé¢ä¸€å®šè¦æœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œèµ·åˆ°ç¼©è¿›çš„ä½œç”¨1.æ­£å¸¸æ˜¾ç¤º(ç‚¹åŽé¢æ²¡æœ‰åŠ ç©ºæ ¼)æœ‰åºåˆ—è¡¨1æœ‰åºåˆ—è¡¨2æ— åºåˆ—è¡¨å’Œæœ‰åºåˆ—è¡¨åŒæ—¶ä½¿ç”¨åˆ—è¡¨å’Œå…¶å®ƒè¦ç´ æ··åˆä½¿ç”¨åˆ—è¡¨ä¸å…‰å¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–çš„ Markdown è¯­æ³•ï¼ŒåŒ…æ‹¬æ ‡é¢˜ã€å¼•ç”¨ã€ä»£ç åŒºå—ç­‰.æ³¨æ„äº‹é¡¹ï¼š(1) åŠ ç²—æ•ˆæžœä¸èƒ½ç›´æŽ¥ç”¨äºŽåˆ—è¡¨æ ‡é¢˜é‡Œé¢ï¼Œä½†æ˜¯å¯ä»¥åµŒå¥—åœ¨åˆ—è¡¨é‡Œé¢æ··åˆä½¿ç”¨ã€‚(2) åˆ—è¡¨ä¸­åŒ…å«ä»£ç å—ï¼ˆå‰é¢åŠ 2ä¸ªtabæˆ–è€…8ä¸ªç©ºæ ¼ï¼Œå¹¶ä¸”éœ€è¦ç©ºä¸€è¡Œï¼Œå¦åˆ™ä¸æ˜¾ç¤ºï¼‰ã€‚æ³¨æ„äº‹é¡¹åœ¨ä½¿ç”¨åˆ—è¡¨æ—¶ï¼Œåªè¦æ˜¯æ•°å­—åŽé¢åŠ ä¸Šè‹±æ–‡çš„ç‚¹ï¼Œå°±ä¼šæ— æ„é—´äº§ç”Ÿåˆ—è¡¨ï¼Œæ¯”å¦‚2017.12.30 è¿™æ—¶å€™æƒ³è¡¨è¾¾çš„æ˜¯æ—¥æœŸï¼Œæœ‰äº›è½¯ä»¶æŠŠå®ƒè¢«è¯¯è®¤ä¸ºæ˜¯åˆ—è¡¨ã€‚è§£å†³æ–¹å¼ï¼šåœ¨æ¯ä¸ªç‚¹å‰é¢åŠ ä¸Š\å°±å¯ä»¥äº†ã€‚è¡¨æ ¼è¯­æ³•è§„åˆ™:-é»˜è®¤å·¦å¯¹é½:-å·¦å¯¹é½-:å³å¯¹é½:-:å±…ä¸­å¯¹é½å…¶ä¸­ï¼Œ-è¡¨ç¤ºåˆ—è¡¨å®½åº¦çš„æƒé‡ï¼Œæ¯”å¦‚â€“æ˜¯-å®½åº¦çš„ä¸¤å€ç¤ºä¾‹:|è¡¨å¤´|è¡¨å¤´|è¡¨å¤´||â€”|â€”-|â€”||å†…å®¹|å†…å®¹|å†…å®¹||å†…å®¹|å†…å®¹|å†…å®¹|å…¶ä¸­,ç¬¬äºŒè¡Œåˆ†å‰²è¡¨å¤´å’Œå†…å®¹ã€‚æœ‰ä¸€ä¸ªå°±è¡Œï¼Œä¸ºäº†å¯¹é½ï¼Œå¤šåŠ äº†å‡ ä¸ªæ–‡å­—é»˜è®¤å±…å·¦123å§“å|å¹´é¾„|ç­çº§-|-|-|å°æ˜Ž|12|ä¸€å¹´çº§å§“åå¹´é¾„ç­çº§å°æ˜Ž12ä¸€å¹´çº§è¡¨æ ¼å¯¹é½æ–¹å¼ï¼šå±…ä¸­å¯¹é½123å§“å|å¹´é¾„|ç­çº§:-:|:-:|:-:|å°æ˜Ž|12|ä¸€å¹´çº§å§“åå¹´é¾„ç­çº§å°æ˜Ž12ä¸€å¹´çº§å°æŠ€å·§:ç½‘ç«™Tables Generator: http://www.tablesgenerator.com/,åœ¨çº¿åˆ¶ä½œè¡¨æ ¼å¹¶ç”Ÿæˆè¯¥è¡¨æ ¼ç›¸åº”çš„LaTexä»£ç ã€HTMLä»£ç ã€Markdownä»£ç ã€Textä»£ç ï¼Œåªéœ€å¤åˆ¶è¿™äº›ä»£ç åˆ°æœ¬Markdownç¼–è¾‘å™¨é‡Œä¾¿å¯ä»¥ç”Ÿæˆç›¸åº”çš„è¡¨æ ¼å­—ä½“ä¸Šã€ä¸‹æ ‡è¯­æ³•12è¿™æ˜¯^ä¸Šæ ‡æ–‡å­—^è¿™æ˜¯~ä¸‹æ ‡æ–‡å­—~è¿™æ˜¯^ä¸Šæ ‡æ–‡å­—^è¿™æ˜¯~ä¸‹æ ‡æ–‡å­—~æ³¨é‡Šæ³¨é‡Šæ˜¯ç»™è‡ªå·±çœ‹çš„ï¼Œé¢„è§ˆæ—¶ä¹Ÿä¸ä¼šå‡ºçŽ°ï¼Œå½“ç„¶å‘å¸ƒå‡ºåŽ»åˆ«äººä¹Ÿä¸ä¼šçœ‹è§ã€‚1&lt;!--æ³¨é‡Š--&gt;å¸¸ç”¨æŠ€å·§æ¢è¡Œæ–¹æ³•1: è¿žç»­ä¸¤ä¸ªä»¥ä¸Šç©ºæ ¼+å›žè½¦æ–¹æ³•2ï¼šä½¿ç”¨htmlè¯­è¨€æ¢è¡Œæ ‡ç­¾ï¼š&lt;br&gt;ç¼©è¿›å­—ç¬¦ä¸æ–­è¡Œçš„ç©ºç™½æ ¼ &nbsp; æˆ– &#160;åŠè§’çš„ç©ºæ ¼ &ensp; æˆ– &#8194;å…¨è§’çš„ç©ºæ ¼ &emsp; æˆ– &#8195;æ‰“å‡ºç‰¹æ®Šç¬¦å·å¯¹äºŽ Markdown ä¸­çš„è¯­æ³•ç¬¦å·ï¼Œå‰é¢åŠ åæ–œçº¿\å³å¯æ˜¾ç¤ºç¬¦å·æœ¬èº«å…¶ä»–ç‰¹æ®Šå­—ç¬¦å­—ç¬¦å¯¹åº”çš„Unicodeç ï¼Œå¯ä»¥çœ‹è¿™ä¸ªç½‘ç«™ï¼šhttps://unicode-table.com/cn/å­—ä½“/å­—å·/é¢œè‰²Markdownæœ¬èº«æ˜¯ä¸æ”¯æŒä¿®æ”¹å­—ä½“ã€å­—å·ä¸Žé¢œè‰²ç­‰åŠŸèƒ½çš„,ä¸è¿‡å¯ä»¥ä½¿ç”¨å†…åµŒHTMLçš„æ–¹æ³•æ¥å®žçŽ°ç¤ºä¾‹ä»£ç å¦‚ä¸‹:12&lt;font face=&quot;å¾®è½¯é›…é»‘&quot; color=&quot;red&quot; size=&quot;6&quot;&gt;å­—ä½“åŠå­—ä½“é¢œè‰²å’Œå¤§å°&lt;/font&gt;&lt;font color=&quot;#0000ff&quot;&gt;å­—ä½“é¢œè‰²&lt;/font&gt;å®žé™…æ•ˆæžœ:å­—ä½“åŠå­—ä½“é¢œè‰²å’Œå¤§å°å­—ä½“é¢œè‰²size: è§„å®šæ–‡æœ¬çš„å°ºå¯¸å¤§å°.èŒƒå›´æ˜¯1-7,æµè§ˆå™¨é»˜è®¤å€¼æ˜¯3.RGBé¢œè‰²æŸ¥è¯¢å¯¹ç…§è¡¨: https://www.114la.com/other/rgb.htmæ–‡æœ¬å¯¹é½æ–¹å¼123&lt;p align=&quot;left&quot;&gt;å±…å·¦æ–‡æœ¬&lt;/p&gt;&lt;p align=&quot;center&quot;&gt;å±…ä¸­æ–‡æœ¬&lt;/p&gt;&lt;p align=&quot;right&quot;&gt;å±…å³æ–‡æœ¬&lt;/p&gt;å±…å·¦æ–‡æœ¬å±…ä¸­æ–‡æœ¬å±…å³æ–‡æœ¬ä¸‹åˆ’çº¿1&lt;u&gt;ä¸‹åˆ’çº¿æ–‡æœ¬&lt;/u&gt;ä¸‹åˆ’çº¿æ–‡æœ¬é“¾æŽ¥çš„é«˜çº§æ“ä½œè¡Œå†…å¼è¿™æ˜¯è¡Œå†…å¼:å•Šå“ˆå†…å®¹ç›®å½•åœ¨æ®µè½ä¸­å¡«å†™ [TOC] ä»¥æ˜¾ç¤ºå…¨æ–‡å†…å®¹çš„ç›®å½•ç»“gitå†æ–‡ç« å¼€å¤´åŠ ä¸Šè¿™ä¸ªçš„è¯ï¼Œä¼šæœ‰å…¨æ–‡å†…å®¹çš„ç›®å½•ç»“æž„ï¼Œæ­¤æ—¶ä½¿ç”¨Typoraè½¯ä»¶å¯¼å‡ºè¯¥æ–‡ä»¶ä¸ºPDFæ ¼å¼æ—¶ï¼Œä¼šåŠ ä¸Šä¹¦ç­¾åŠŸèƒ½ã€‚é”šç‚¹é”šç‚¹å…¶å®žå°±æ˜¯é¡µå†…è¶…é“¾æŽ¥ã€‚æ¯”å¦‚è¿™é‡Œå†™ä¸‹ä¸€ä¸ªé”šç‚¹ï¼Œç‚¹å‡»å›žåˆ°ç›®å½•ï¼Œå°±èƒ½è·³è½¬åˆ°ç›®å½•ã€‚ åœ¨ç›®å½•ä¸­ç‚¹å‡»è¿™ä¸€èŠ‚ï¼Œå°±èƒ½è·³è¿‡æ¥ã€‚è¯­æ³•è¯´æ˜Žï¼šåœ¨ä½ å‡†å¤‡è·³è½¬åˆ°çš„æŒ‡å®šæ ‡é¢˜åŽæ’å…¥é”šç‚¹ï¼Œç„¶åŽåœ¨æ–‡æ¡£çš„å…¶å®ƒåœ°æ–¹å†™ä¸Šè¿žæŽ¥åˆ°é”šç‚¹çš„é“¾æŽ¥ã€‚æ³¨è„šè„šæ³¨ä¸ºå…ˆå®šä¹‰ï¼ŒåŽä½¿ç”¨:å®šä¹‰æ ¼å¼ï¼š[^å®šä¹‰å]: å®šä¹‰å†…å®¹ä½¿ç”¨æ ¼å¼ï¼šç›´æŽ¥åœ¨éœ€è¦å®šä¹‰çš„æ–‡æœ¬å†…å®¹åŽé¢åŠ ä¸Š[ ^å®šä¹‰å]ä¾‹å¦‚ï¼š12ç”Ÿæˆä¸€ä¸ªè„šæ³¨[^footnote]ã€‚[^footnote]: è¿™é‡Œæ˜¯è„šæ³¨çš„å†…å®¹ã€‚ï¼ˆæ³¨æ„ï¼š[^footnote]åŽçš„åŒå¼•å·æ˜¯åœ¨è‹±æ–‡è¾“å…¥ä¸‹è¾“å…¥çš„ï¼‰æ³¨ï¼š(1) è„šæ³¨è‡ªåŠ¨è¢«æ¬è¿åˆ°æœ€åŽé¢ï¼Œè¯·åˆ°æ–‡ç« æœ«å°¾æŸ¥çœ‹ï¼Œå¹¶ä¸”è„šæ³¨åŽæ–¹çš„é“¾æŽ¥å¯ä»¥ç›´æŽ¥è·³è½¬å›žåˆ°åŠ æ³¨çš„åœ°æ–¹ã€‚(2) ä¸æ”¯æŒé”šç‚¹çš„è½¯ä»¶ï¼Œå¯ä»¥ç”¨æ³¨è„šå®žçŽ°é¡µé¢å†…éƒ¨çš„è·³è½¬ã€‚(3) ç‚¹å‡»è„šæ³¨å¯ç›´æŽ¥åˆ°è¾¾åº•éƒ¨è„šæ³¨æ³¨é‡Šå¤„èƒŒæ™¯è‰²Markdownæœ¬èº«ä¸æ”¯æŒèƒŒæ™¯è‰²è®¾ç½®ï¼Œéœ€è¦é‡‡ç”¨å†…ç½®htmlçš„æ–¹å¼å®žçŽ°ï¼šå€ŸåŠ© table, tr, td ç­‰è¡¨æ ¼æ ‡ç­¾çš„bgcolor å±žæ€§æ¥å®žçŽ°èƒŒæ™¯è‰²çš„åŠŸèƒ½ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š1&lt;table&gt;&lt;tr&gt;&lt;td bgcolor=green&gt;èƒŒæ™¯è‰²æ˜¯ï¼šgreen&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;èƒŒæ™¯è‰²æ˜¯ï¼šgreenemojiè¡¨æƒ…ç¬¦å·emojiè¡¨æƒ…ä½¿ç”¨:EMOJICODE:çš„æ ¼å¼è¯¦ç»†åˆ—è¡¨å¯è§: https://www.webpagefx.com/tools/emoji-cheat-sheet/123:sunglasses::musical_note::gift_heart::sunglasses::musical_note::gift_heart:è½¬ä¹‰é«˜ç«¯ç”¨æ³•ä½¿ç”¨LaTexæ•°å­¦å…¬å¼LaTeX[^LaTeXè¯´æ˜Ž]çš„æ•°å­¦å…¬å¼æœ‰ä¸¤ç§ï¼šè¡Œå†…å…¬å¼å’Œå—çº§å…¬å¼è¡Œå†…å…¬å¼æ”¾åœ¨æ–‡ä¸­ä¸Žå…¶ä»–æ–‡å­—æ··ç¼–ï¼Œå—çº§å…¬å¼å•ç‹¬æˆè¡Œ,éƒ½ä½¿ç”¨ç¾Žå…ƒç¬¦å·è¿›è¡Œæ ‡è®°æ˜¾ç¤ºã€‚ç®€å•è§„åˆ™ï¼š1ã€LaTexå…¬å¼ç”±$ç¬¦å·å¼€å§‹ï¼Œç”±$ç»“æŸï¼›2ã€ç©ºæ ¼ï¼šLaTeXä¸­ç©ºæ ¼ç”¨æ¥éš”å¼€å•è¯(è‹±è¯­ä¸€ç±»å­—æ¯æ–‡å­—)ï¼Œå¤šä¸ªç©ºæ ¼ç­‰æ•ˆäºŽä¸€ä¸ªç©ºæ ¼ï¼›å¯¹ä¸­æ–‡æ²¡æœ‰ä½œç”¨ã€‚3ã€æ¢è¡Œï¼šç”¨æŽ§åˆ¶å‘½ä»¤â€œ\â€,æˆ–â€œ \newlineâ€.ã€‚4ã€åˆ†æ®µï¼šç”¨æŽ§åˆ¶å‘½ä»¤â€œ\parâ€ æˆ–ç©ºå‡ºä¸€è¡Œã€‚5ã€æ¢é¡µï¼šç”¨æŽ§åˆ¶å‘½ä»¤â€œ\newpageâ€æˆ–â€œ\clearpageâ€ ã€‚6ã€ç‰¹æ®ŠæŽ§åˆ¶å­—ç¬¦ï¼š#ï¼Œ$, %, &amp;, - ,{, }, ^, ~ è¦æƒ³è¾“å‡ºè¿™äº›æŽ§åˆ¶ç¬¦ç”¨ä¸‹åˆ—å‘½ä»¤ï¼š\# \$ \% \&amp; \- \{ \} \^{} \~{}â€‹$\backslashâ€‹$è¡¨ç¤º&#39;\&#39;è¡Œå†…å…¬å¼æ ‡è®°æ–¹æ³•ï¼šä½¿ç”¨ä¸€å¯¹ç¾Žå…ƒç¬¦å·åŒ…å›´èµ·æ¥ï¼Œ$è¡Œå†…å…¬å¼$ï¼Œä¾‹å¦‚ï¼š1è¿™æ˜¯ä¸€ä¸ªè¡Œå†…å…¬å¼ï¼ˆ$\sqrt&#123;x^2&#123;2&#125;&#125;$ï¼‰è¿™æ˜¯ä¸€ä¸ªè¡Œå†…å…¬å¼ï¼ˆ$\sqrt{x^{2}}â€‹$ï¼‰å—çº§å…¬å¼ä½¿ç”¨ä¸¤å¯¹â€œ$$â€ç¬¦å·å¼•ç”¨å…¬å¼ï¼šâ€‹$$å…¬å¼$$1è¿™æ˜¯ä¸€ä¸ªå—çº§å…¬å¼($$\frac&#123;1+x&#125;&#123;2^x&#125;$$)è¿™æ˜¯ä¸€ä¸ªå—çº§å…¬å¼($$\frac{1+x}{2^x}$$)ä¸Šæ ‡å’Œä¸‹æ ‡^è¡¨ç¤ºä¸Šæ ‡, _è¡¨ç¤ºä¸‹æ ‡. å¦‚æžœä¸Šä¸‹æ ‡çš„å†…å®¹å¤šäºŽä¸€ä¸ªå­—ç¬¦ï¼Œè¦ç”¨{}æŠŠè¿™äº›å†…å®¹æ‹¬èµ·æ¥å½“æˆä¸€ä¸ªæ€»ä½“ã€‚ä¸Šä¸‹æ ‡æ˜¯èƒ½å¤ŸåµŒå¥—çš„ï¼Œä¹Ÿèƒ½å¤ŸåŒä¸€æ—¶å€™ä½¿ç”¨ã€‚ï¼ˆæ³¨ï¼šåœ¨å®žé™…å®žçŽ°å…¬å¼æ—¶ï¼Œä¸‹åˆ—â€œæ•ˆæžœâ€ä¸€æ åº”ç”¨$ç¬¦å·åŒ…å›´èµ·æ¥ï¼‰ã€‚ä¸Š/ä¸‹æ ‡è¯­æ³•æ•ˆæžœä¸Šæ ‡10^{x+2}$10^{x+2}$ä¸‹æ ‡y=2x_1 + 3x_2$y=2x_1 + 3x_2$åµŒå¥—y=2x_1^2 + 3x_2^4$y=2x_1^2 + 3x_2^4$å¦å¤–ï¼Œå‡è®¾è¦åœ¨å·¦å³ä¸¤è¾¹éƒ½æœ‰ä¸Šä¸‹æ ‡ã€‚èƒ½å¤Ÿç”¨\sidesetå‘½ä»¤ã€‚å¦‚ï¼š$\sideset{^1_2}{^3_4}\bigotimes$æ•ˆæžœ:$\sideset{^1_2}{^3_4}\bigotimes$åˆ†æ•°æ–¹æ³•1ï¼š\frac{åˆ†å­}{åˆ†æ¯}ï¼ˆè‹¥åˆ†å­åˆ†æ¯éƒ½æ˜¯å•æ•°ï¼Œåˆ™å¤§æ‹¬å·å¯ä»¥çœç•¥ï¼‰æ–¹æ³•2ï¼šåˆ†å­ \over åˆ†æ¯åˆ†æ•°è¯­æ³•æ•ˆæžœæ–¹æ³•1\frac{x+1}{3x}$\frac{x+1}{3x}$æ–¹æ³•22x_1 + 3x_2\over x_2 + x_3$2x_1 + 3x_2\over x_2 + x_3$å„ç±»æ‹¬å·()ã€[]å’Œ|èƒ½å¤Ÿç›´æŽ¥è¡¨ç¤ºè‡ªå·±ã€‚è€Œ{}æœ¬æ¥ç”¨äºŽåˆ†ç»„ã€‚å› æ­¤é¡»è¦ç”¨{ }æ¥è¡¨ç¤ºè‡ªèº«ï¼Œä¹Ÿèƒ½å¤Ÿä½¿ç”¨\lbrace å’Œ\rbraceæ¥è¡¨ç¤ºã€‚å…¶ä»–æ‹¬å·è§ä»¥ä¸‹è¡¨ã€‚å¦‚ï¼š\{[2x - (1 + \frac{7}{3x})] - 6y\}æ•ˆæžœï¼š${[2xâˆ’(1 + \frac{7}{3x})]âˆ’6y}â€‹$æ³¨æ„ï¼šåŽŸå§‹ç¬¦å·å¹¶ä¸ä¼šéšç€å…¬å¼å¤§å°ç¼©æ”¾ã€‚æœ‰æ—¶å€™æˆ‘ä»¬æƒ³è¦æ‹¬å·å’Œåˆ†éš”ç¬¦æ˜¾ç¤ºçš„å¤§ç‚¹ã€‚æ¯”æ–¹ä¸Šé¢æ ·ä¾‹ä¸­å¸Œæœ›æ‹¬å·èƒ½æŠŠæ•´ä¸ªåˆ†æ•°éƒ½åŒ…ä½ï¼Œé‚£ä¹ˆèƒ½å¤Ÿç”¨\leftå’Œ\rightæ ‡è®°ï¼Œå®žçŽ°è‡ªé€‚åº”è°ƒæ•´ã€‚ï¼ˆæ”¾åœ¨éœ€è¦é€‚åº”çš„æ‹¬å·çš„å‰é¢ï¼‰å¦‚ï¼š$\left\{[2x - (1 + \frac{7}{3x})] - 6y\right\}$æ•ˆæžœï¼š$\left{[2x - (1 + \frac{7}{3x})] - 6y\right}â€‹$\leftå’Œ\rightæ ‡è®°èƒ½åº”ç”¨çš„æ‹¬å·éžå¸¸å¤šï¼šæ‹¬å·åè¯­æ³•æ•ˆæžœå°æ‹¬å·\left(x+2\right)$\left(x+2\right)$ä¸­æ‹¬å·\left[2x + (5 + 6y)\right]$\left[2x + (5 + 6y)\right]$å¤§æ‹¬å·\left{[2x - (1 + \frac{7}{3x})] - 6y\right}$\lbrace[2x - (1 + \frac{7}{3x})] - 6y\rbrace$å°–æ‹¬å·\left\langle3 + 4x\right\rangle$\left\langle3 + 4x\right\rangle$å‘ä¸Šå–æ•´\left\lceil1 + 2x\right\rceil$\left\lceil1 + 2x\right\rceil $å‘ä¸‹å–æ•´\left\lfloor2 + 3x\right\rfloor$\left\lfloor2 + 3x\right\rfloor$æ ¹å·æ ¹å·å¼€æ–¹ä½¿ç”¨\sqrtæ ‡è®°ï¼Œè¯­æ³•æ ¼å¼ä¾‹å¦‚ä»¥ä¸‹ï¼š \sqrt[å¼€æ–¹æ¬¡æ•°ï¼Œé»˜äººä¸º2]{å¼€æ–¹å› å­}æ ¹å·è¯­æ³•æ•ˆæžœç¤ºä¾‹1\sqrt[3]{1 + \frac{1+x}{2+3x}}$\sqrt[3]{1 + \frac{1+x}{2+3x}}$ç¤ºä¾‹2\sqrt{8}$\sqrt{8}$çœç•¥å·æ•°å­¦å…¬å¼ä¸­å¸¸è§çš„çœç•¥å·æœ‰ä¸¤ç§ã€‚\ldotsè¡¨ç¤ºä¸Žæ–‡æœ¬åº•çº¿å¯¹é½çš„çœç•¥å·ï¼Œ\cdotsè¡¨ç¤ºä¸Žæ–‡æœ¬ä¸­çº¿å¯¹é½çš„çœç•¥å·ã€‚å¦‚ï¼šçœç•¥å·è¯­æ³•æ•ˆæžœä¸Žæ–‡æœ¬ä¸­çº¿å¯¹é½f(x_1, x_2, \cdots, x_n) = x_1^2 + x_2^2 + \cdots + x_n^2$f(x_1, x_2, \cdots, x_n) = x_1^2 + x_2^2 + \cdots + x_n^2$ä¸Žæ–‡æœ¬åº•çº¿å¯¹é½x_1x_2x_3\ldots$ x_1x_2x_3\ldots$æ³¨æ„ï¼š\ldotå’Œ\cdotèƒ½å¤Ÿè¡¨ç¤ºä¸Žæ–‡æœ¬åº•çº¿å’Œä¸­çº¿å¯¹é½çš„å•ä¸ªç‚¹ã€‚æ•°å­¦çŸ¢é‡çŸ¢é‡ç”¨\vecæ ‡è®°å®žçŽ°,è¯­æ³•æ ¼å¼ï¼š\vec{çŸ¢é‡å€¼}ï¼Œå¦‚ä¸‹ï¼šçŸ¢é‡è¯­æ³•æ•ˆæžœç¤ºä¾‹1\vec{a}\cdot\vec{b} = \vec{ab}$\vec{a}\cdot\vec{b} = \vec{ab}$å­—ç¬¦é—´éš”é€šå¸¸MathJaxé€šè¿‡å†…éƒ¨ç­–ç•¥è‡ªå·±ç®¡ç†å…¬å¼å†…éƒ¨çš„ç©ºé—´ï¼Œå› æ­¤aï¸¹ï¸¹bä¸Žaï¸¹ï¸¹ï¸¹ï¸¹ï¸¹bï¼ˆï¸¹è¡¨ç¤ºç©ºæ ¼ï¼‰éƒ½ä¼šæ˜¾ç¤ºä¸ºabã€‚å› æ­¤ï¼Œèƒ½å¤Ÿé€šè¿‡åœ¨abé—´æ·»åŠ \ç©ºæ ¼æˆ–\;æ·»åŠ äº›è®¸é—´éš™ï¼Œ\quad ä¸Ž \qquad ä¼šæ·»åŠ æ›´å¤§çš„é—´éš™ï¼Œå¦‚ä¸‹ï¼šé—´éš”è¯­æ³•æ•ˆæžœç¤ºä¾‹1a\ b$a\ b$ç¤ºä¾‹2a\;b$a\;b$ç¤ºä¾‹3a\quad b$a\quad b$ç¤ºä¾‹4a\qquad b$a\qquad b$å¸Œè…Šå­—æ¯åºå·LaTexä»£ç ç»“æžœä¸­æ–‡å1\alpha$\alpha$é˜¿å°”æ³•2\beta$\beta$è´å¡”3\gamma$\gamma$ä¼½é©¬4\delta$\delta$å¾·å°”å¡”5\zeta$\zeta$æ³½å¡”6\eta$\eta$ä¼Šå¡”7\theta$\theta$è¥¿å¡”8\iota$\iota$çº¦å¡”9\kappa$\kappa$å¡å¸•10\lambda$\lambda$å…°å§†è¾¾11\mu$\mu$ç¼ª12\nu$\nu$çº½13\xi$\xi$å…‹è¥¿14\omicron$\omicron$æ¬§ç±³å…‹éš†15\pi$\pi$æ´¾16\rho$\rho$æŸ”17\sigma$\sigma$è¥¿æ ¼çŽ›18\tau$\tau $é™¶19\upsilon$\upsilon$å®‡æ™®è¥¿éš†20\phi$\phi$å¼—çˆ±21\chi$\chi$å¡22\psi$\psi$æ™®èµ›23\omega$\omega$æ¬§ç±³ä¼½24\varepsilon$\varepsilon$å¼‚ä½“25\varkappa$\varkappa$å¼‚ä½“26\vartheta$\vartheta$å¼‚ä½“27\varpi$\varpi$å¼‚ä½“28\varrao$\varrao$å¼‚ä½“29\varsigma$\varsigma$å¼‚ä½“30\varphi$\varphi$å¼‚ä½“ç‰¹æ®Šå­—ç¬¦11.1 å…³ç³»è¿ç®—ç¬¦Â±: \pmÃ—: \timesÃ·: \divâˆ£: \midâˆ¤: \nmidâ‹…: \cdotâˆ˜: \circâˆ—: \astâ¨€: \bigodotâ¨‚: \bigotimesâ‰¤: \leqâ‰¥: \geqâ‰ : \neqâ‰ˆ: \approxâ‰¡: \equivâˆ‘: \sumâˆ: \prodâˆ: \coprod11.2 é›†åˆè¿ç®—ç¬¦âˆ…: \emptysetâˆˆ: \inâˆ‰: \notinâŠ‚: \subsetâŠƒ: \supsetâŠ†: \subseteqâŠ‡: \supseteqâ‹‚: \bigcapâ‹ƒ: \bigcupâ‹: \bigveeâ¨„: \biguplusâ¨†: \bigsqcup11.3 å¯¹æ•°è¿ç®—ç¬¦log: \logln: \lnlg: \lg11.4 ä¸‰è§’è¿ç®—ç¬¦âŠ¥: \botâˆ : \angle30âˆ˜: \30^circsin: \sincos: \costan: \tancot: \cotsec: \seccsc:\csc11.5 å¾®ç§¯åˆ†è¿ç®—ç¬¦â€²: \primeâˆ«: \intâˆ¬: \iintâˆ­: \iiintâˆ¬âˆ¬: \iiiintâˆ®: \ointlim: \limâˆž: \inftyâˆ‡:\nabla11.6 é€»è¾‘è¿ç®—ç¬¦y^: \hat{y}11.7 è¿žçº¿ç¬¦å·$\overline{a+b+c+d}$: \overline{a+b+c+d}$\underline{a+b+c+d}$ : \underline{a+b+c+d}$\overbrace{a+\underbrace{b+c}{1.0} + d}^{2.0}$: \overbrace{a+\underbrace{b+c}{1.0} + d}^{2.0}11.7 ç®­å¤´ç¬¦å·â†‘: \uparrowâ†“: \downarrowâ‡‘: \Uparrowâ‡“: \Downarrowâ†’: \rightarrowâ†: \leftarrowâ‡’: \Rightarrowâ‡: \LeftarrowâŸ¶: \longrightarrowâŸµ: \longleftarrowâŸ¹: \LongrightarrowâŸ¸: \Longleftarrowç»¼åˆä¸Šé¢çš„ç¬¦å·è¯­è¨€ï¼Œæœ‰å¦‚ä¸‹å‡ ä¸ªç»¼åˆçš„ä¾‹å­ï¼š$ \sum_{i=0}^n\frac{1}{i^2} $: \sum_{i=0}^n\frac{1}{i^2}$ \prod_{i=0}^n\frac{1}{i^2} â€‹$: \prod_{i=0}^n\frac{1}{i^2}$ \int_0^1 x^2{\rm d}x $: \int_0^1 x^2{\rm d}x$ \lim_{n\rightarrow + \infty}\frac{1}{n(n+1)} $æµç¨‹å›¾ä¸»è¦çš„è¯­æ³•ä¸º name=&gt;type: describeï¼Œå…¶ä¸­ type ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š1.å¼€å§‹å’Œç»“æŸï¼šstart end2.è¾“å…¥è¾“å‡ºï¼šinputoutput3.æ“ä½œï¼šoperation4.æ¡ä»¶ï¼šcondition5.å­ç¨‹åºï¼šsubroutine123456789101112131415st=&gt;start: Start|past:&gt;http://www.google.com[blank]e=&gt;end: End:&gt;http://www.google.comop1=&gt;operation: My Operation|pastop2=&gt;operation: Stuff|currentsub1=&gt;subroutine: My Subroutine|invalidcond=&gt;condition: Yes or No?|approved:&gt;http://www.baidu.comc2=&gt;condition: Good idea|rejectedio=&gt;inputoutput: catch something...|requestst-&gt;op1(right)-&gt;condcond(yes, right)-&gt;c2cond(no)-&gt;sub1(left)-&gt;op1c2(yes)-&gt;io-&gt;ec2(no)-&gt;op2-&gt;e123456789101112131415st=&gt;start: Start|past:&gt;http://www.google.com[blank]e=&gt;end: End:&gt;http://www.google.comop1=&gt;operation: My Operation|pastop2=&gt;operation: Stuff|currentsub1=&gt;subroutine: My Subroutine|invalidcond=&gt;condition: Yes or No?|approved:&gt;http://www.baidu.comc2=&gt;condition: Good idea|rejectedio=&gt;inputoutput: catch something...|requestst-&gt;op1(right)-&gt;condcond(yes, right)-&gt;c2cond(no)-&gt;sub1(left)-&gt;op1c2(yes)-&gt;io-&gt;ec2(no)-&gt;op2-&gt;eè¯­æ³•å‚è€ƒ: https://link.jianshu.com/?t=https://github.com/adrai/flowchart.jsä»»åŠ¡åˆ—è¡¨12- [] æœªå¤„ç†çš„äº‹æƒ…- [x] å·²å¤„ç†çš„äº‹æƒ…æœªå¤„ç†çš„äº‹æƒ…å·²å¤„ç†çš„äº‹æƒ…æ³¨:ç‚¹å‡»æ–¹æ¡†,æ˜¾ç¤ºçš„æ˜¯å¯¹å·,ä½†æ˜¯æºç é‡Œæ˜¾ç¤ºçš„æ˜¯å·®å·ç»˜åˆ¶ åºåˆ—å›¾1234Title:è¿žæŽ¥å»ºç«‹çš„è¿‡ç¨‹å®¢æˆ·ä¸»æœº-&gt;æœåŠ¡å™¨ä¸»æœº: è¿žæŽ¥è¯·æ±‚ï¼ˆSYN=1,seq=client_isnï¼‰ æœåŠ¡å™¨ä¸»æœº-&gt;å®¢æˆ·ä¸»æœº: æŽˆäºˆè¿žæŽ¥ï¼ˆSYN=1,seq=client_isnï¼‰\n ack=client_isn+1å®¢æˆ·ä¸»æœº-&gt;æœåŠ¡å™¨ä¸»æœº: ç¡®è®¤ï¼ˆSYN=0,seq=client_isn+1ï¼‰\nack=server_isn+11234Title:è¿žæŽ¥å»ºç«‹çš„è¿‡ç¨‹å®¢æˆ·ä¸»æœº-&gt;æœåŠ¡å™¨ä¸»æœº: è¿žæŽ¥è¯·æ±‚ï¼ˆSYN=1,seq=client_isnï¼‰ æœåŠ¡å™¨ä¸»æœº-&gt;å®¢æˆ·ä¸»æœº: æŽˆäºˆè¿žæŽ¥ï¼ˆSYN=1,seq=client_isnï¼‰\n ack=client_isn+1å®¢æˆ·ä¸»æœº-&gt;æœåŠ¡å™¨ä¸»æœº: ç¡®è®¤ï¼ˆSYN=0,seq=client_isn+1ï¼‰\nack=server_isn+1123456789101112title: åºåˆ—å›¾sequence(ç¤ºä¾‹)participant Aparticipant Bparticipant Cnote left of A: Aå·¦ä¾§è¯´æ˜Žnote over B: è¦†ç›–Bçš„è¯´æ˜Žnote right of C: Cå³ä¾§è¯´æ˜ŽA-&gt;A:è‡ªå·±åˆ°è‡ªå·±A-&gt;B:å®žçº¿å®žç®­å¤´A--&gt;C:è™šçº¿å®žç®­å¤´B-&gt;&gt;C:å®žçº¿è™šç®­å¤´B--&gt;&gt;A:è™šçº¿è™šç®­å¤´123456789101112title: åºåˆ—å›¾sequence(ç¤ºä¾‹)participant Aparticipant Bparticipant Cnote left of A: Aå·¦ä¾§è¯´æ˜Žnote over B: è¦†ç›–Bçš„è¯´æ˜Žnote right of C: Cå³ä¾§è¯´æ˜ŽA-&gt;A:è‡ªå·±åˆ°è‡ªå·±A-&gt;B:å®žçº¿å®žç®­å¤´A--&gt;C:è™šçº¿å®žç®­å¤´B-&gt;&gt;C:å®žçº¿è™šç®­å¤´B--&gt;&gt;A:è™šçº¿è™šç®­å¤´1234567891011121314ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§å…³é”®è¯: title, å®šä¹‰è¯¥åºåˆ—å›¾çš„æ ‡é¢˜ participant, å®šä¹‰æ—¶åºå›¾ä¸­çš„å¯¹è±¡ note, å®šä¹‰å¯¹æ—¶åºå›¾ä¸­çš„éƒ¨åˆ†è¯´æ˜Ž &#123;actor&#125;, è¡¨ç¤ºæ—¶åºå›¾ä¸­çš„å…·ä½“å¯¹è±¡ï¼ˆåç§°è‡ªå®šä¹‰ï¼‰å…¶ä¸­é’ˆå¯¹noteçš„æ–¹ä½æŽ§åˆ¶ä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ç§å…³é”®è¯ï¼š left of, è¡¨ç¤ºå½“å‰å¯¹è±¡çš„å·¦ä¾§ right of, è¡¨ç¤ºå½“å‰å¯¹è±¡çš„å³ä¾§ over, è¡¨ç¤ºè¦†ç›–åœ¨å½“å‰å¯¹è±¡ï¼ˆä»¬ï¼‰çš„ä¸Šé¢å…¶ä¸­é’ˆå¯¹&#123;actor&#125;çš„ç®­å¤´åˆ†ä¸ºä»¥ä¸‹å‡ ç§ï¼š -&gt; è¡¨ç¤ºå®žçº¿å®žç®­å¤´ â€“&gt; è¡¨ç¤ºè™šçº¿å®žç®­å¤´ -&gt;&gt; è¡¨ç¤ºå®žçº¿è™šç®­å¤´ â€“&gt;&gt; è¡¨ç¤ºè™šçº¿è™šç®­å¤´è¯­æ³•å‚è€ƒ: https://link.jianshu.com/?t=https://bramp.github.io/js-sequence-diagrams/ç»˜åˆ¶ ç”˜ç‰¹å›¾1234567graph TDclient1--&gt;|read / write|SVN((SVN server))client2--&gt;|read only|SVNclient3--&gt;|read / write|SVNclient4--&gt;|read only|SVNclient5(...)--&gt;SVNSVN---|store the data|sharedrive1234567graph TDclient1--&gt;|read / write|SVN((SVN server))client2--&gt;|read only|SVNclient3--&gt;|read / write|SVNclient4--&gt;|read only|SVNclient5(...)--&gt;SVNSVN---|store the data|sharedriveè¯­æ³•å‚è€ƒ: https://link.jianshu.com/?t=http://knsv.github.io/mermaidMarkdowå·¥å…·TyporaMarkdownPad 2[^LaTeXè¯´æ˜Ž]: LaTeXï¼ˆLATEXï¼ŒéŸ³è¯‘â€œæ‹‰æ³°èµ«â€ï¼‰æ˜¯ä¸€ç§åŸºäºŽÎ¤Î•Î§çš„æŽ’ç‰ˆç³»ç»Ÿï¼Œç”±ç¾Žå›½è®¡ç®—æœºå­¦å®¶èŽ±æ–¯åˆ©Â·å…°ä¼¯ç‰¹ï¼ˆLeslie Lamportï¼‰åœ¨20ä¸–çºª80å¹´ä»£åˆæœŸå¼€å‘ï¼Œåˆ©ç”¨è¿™ç§æ ¼å¼ï¼Œå³ä½¿ä½¿ç”¨è€…æ²¡æœ‰æŽ’ç‰ˆå’Œç¨‹åºè®¾è®¡çš„çŸ¥è¯†ä¹Ÿå¯ä»¥å……åˆ†å‘æŒ¥ç”±TeXæ‰€æä¾›çš„å¼ºå¤§åŠŸèƒ½ï¼Œèƒ½åœ¨å‡ å¤©ï¼Œç”šè‡³å‡ å°æ—¶å†…ç”Ÿæˆå¾ˆå¤šå…·æœ‰ä¹¦ç±è´¨é‡çš„å°åˆ·å“ã€‚å¯¹äºŽç”Ÿæˆå¤æ‚è¡¨æ ¼å’Œæ•°å­¦å…¬å¼ï¼Œè¿™ä¸€ç‚¹è¡¨çŽ°å¾—å°¤ä¸ºçªå‡ºã€‚å› æ­¤å®ƒéžå¸¸é€‚ç”¨äºŽç”Ÿæˆé«˜å°åˆ·è´¨é‡çš„ç§‘æŠ€å’Œæ•°å­¦ç±»æ–‡æ¡£ã€‚è¿™ä¸ªç³»ç»ŸåŒæ ·é€‚ç”¨äºŽç”Ÿæˆä»Žç®€å•çš„ä¿¡ä»¶åˆ°å®Œæ•´ä¹¦ç±çš„æ‰€æœ‰å…¶ä»–ç§ç±»çš„æ–‡æ¡£ã€‚]]></content>
      <categories>
        <category>Markdown</category>
      </categories>
      <tags>
        <tag>Markdown</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨Pythonçš„camelotè¯†åˆ«pdfæ–‡ä»¶ä¸­çš„è¡¨æ ¼æ•°æ®]]></title>
    <url>%2F2019%2F03%2F25%2F%E4%BD%BF%E7%94%A8Python%E7%9A%84camelot%E8%AF%86%E5%88%ABpdf%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E8%A1%A8%E6%A0%BC%E6%95%B0%E6%8D%AE%2F</url>
    <content type="text"><![CDATA[Camelot æ˜¯ ä¸€ä¸ªpythonåº“ï¼Œå®ƒä½¿ä»»ä½•äººéƒ½å¯ä»¥è½»æ¾åœ°ä»Žpdfæ–‡ä»¶ä¸­æå–è¡¨ä¸ªæ•°æ®.Note : æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨ Excalibur, å®ƒæ˜¯ä¸€ä¸ªå›¾å½¢åŒ–ç•Œé¢çš„å·¥å…·,ä¾èµ–äºŽCamelot !å®˜æ–¹æ–‡æ¡£åœ°å€å®˜æ–¹æ–‡æ¡£åœ°å€: https://camelot-py.readthedocs.io/en/latest/ GitHubåœ°å€: https://github.com/socialcopsdev/camelot ç”¨æ³•ç¤ºä¾‹å¦‚ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹, ä»ŽPDFæ–‡ä»¶ä¸­è§£æžå‡ºè¡¨æ ¼æ•°æ®, ç¤ºä¾‹æ–‡ä»¶.1234567891011121314151617&gt;&gt;&gt; import camelot&gt;&gt;&gt; tables = camelot.read_pdf('foo.pdf')&gt;&gt;&gt; tables&lt;TableList n=1&gt;&gt;&gt;&gt; tables.export('foo.csv', f='csv', compress=True) # json, excel, html&gt;&gt;&gt; tables[0]&lt;Table shape=(7, 7)&gt;&gt;&gt;&gt; tables[0].parsing_report&#123; 'accuracy': 99.02, 'whitespace': 12.24, 'order': 1, 'page': 1&#125;&gt;&gt;&gt; tables[0].to_csv('foo.csv') # to_json, to_excel, to_html&gt;&gt;&gt; tables[0].df # get a pandas DataFrame!&gt;&gt;&gt; tables[0].data # ä»¥åˆ—è¡¨çš„å½¢å¼èŽ·å–è¡¨æ ¼æ•°æ®123456789101112131415161718192021[ [&apos;&apos;, &apos;2017 å¹´&apos;, &apos;2016 å¹´&apos;, &apos;&apos;, &apos;æœ¬å¹´æ¯”ä¸Šå¹´\nå¢žå‡&apos;, &apos;2015 å¹´&apos;, &apos;&apos;], [&apos;&apos;, &apos;&apos;, &apos;è°ƒæ•´å‰&apos;, &apos;è°ƒæ•´åŽ&apos;, &apos;è°ƒæ•´åŽ&apos;, &apos;è°ƒæ•´å‰&apos;, &apos;è°ƒæ•´åŽ&apos;], [&apos;è¥ä¸šæ”¶å…¥&apos;, &apos;1,193,226,06\n2.36&apos;, &apos;906,122,990.\n80&apos;, &apos;1,071,240,37\n1.27&apos;, &apos;11.39%&apos;, &apos;982,793,002.\n23&apos;, &apos;1,145,518,27\n0.78&apos;], [&apos;å½’å±žäºŽä¸Šå¸‚å…¬å¸è‚¡ä¸œçš„å‡€\nåˆ©æ¶¦&apos;, &apos;70,933,068.0\n9&apos;, &apos;32,767,864.6\n5&apos;, &apos;47,832,706.4\n2&apos;, &apos;48.29%&apos;, &apos;18,617,579.8\n2&apos;, &apos;22,222,610.2\n9&apos;], [&apos;å½’å±žäºŽä¸Šå¸‚å…¬å¸è‚¡ä¸œçš„æ‰£\né™¤éžç»å¸¸æ€§æŸç›Šçš„å‡€åˆ©æ¶¦&apos;, &apos;42,889,116.5\n4&apos;, &apos;20,805,256.6\n9&apos;, &apos;22,714,450.2\n9&apos;, &apos;88.82%&apos;, &apos;2,936,489.29&apos;, &apos;-1,318,104.2\n0&apos;], [&apos;ç»è¥æ´»åŠ¨äº§ç”Ÿçš„çŽ°é‡‘æµé‡\nå‡€é¢&apos;, &apos;129,194,493.\n34&apos;, &apos;1,033,605,92\n6.50&apos;, &apos;417,168,711.\n36&apos;, &apos;-69.03%&apos;, &apos;336,741,518.\n42&apos;, &apos;336,741,518.\n42&apos;], [&apos;åŸºæœ¬æ¯è‚¡æ”¶ç›Šï¼ˆå…ƒ/è‚¡ï¼‰&apos;, &apos;0.27&apos;, &apos;0.13&apos;, &apos;0.23&apos;, &apos;17.39%&apos;, &apos;0.07&apos;, &apos;0.14&apos;], [&apos;ç¨€é‡Šæ¯è‚¡æ”¶ç›Šï¼ˆå…ƒ/è‚¡ï¼‰&apos;, &apos;0.27&apos;, &apos;0.13&apos;, &apos;0.23&apos;, &apos;17.39%&apos;, &apos;0.07&apos;, &apos;0.14&apos;], [&apos;åŠ æƒå¹³å‡å‡€èµ„äº§æ”¶ç›ŠçŽ‡&apos;, &apos;2.83%&apos;, &apos;2.16%&apos;, &apos;3.62%&apos;, &apos;-0.79%&apos;, &apos;1.83%&apos;, &apos;1.98%&apos;], [&apos;&apos;, &apos;2017 å¹´æœ«&apos;, &apos;2016 å¹´æœ«&apos;, &apos;&apos;, &apos;æœ¬å¹´æœ«æ¯”ä¸Š\nå¹´æœ«å¢žå‡&apos;, &apos;2015 å¹´æœ«&apos;, &apos;&apos;], [&apos;&apos;, &apos;&apos;, &apos;è°ƒæ•´å‰&apos;, &apos;è°ƒæ•´åŽ&apos;, &apos;è°ƒæ•´åŽ&apos;, &apos;è°ƒæ•´å‰&apos;, &apos;è°ƒæ•´åŽ&apos;], [&apos;èµ„äº§æ€»é¢&apos;, &apos;4,584,871,87\n8.81&apos;, &apos;4,424,575,99\n3.01&apos;, &apos;4,615,713,51\n4.63&apos;, &apos;-0.67%&apos;, &apos;3,215,996,96\n2.67&apos;, &apos;3,533,474,80\n2.10&apos;], [&apos;å½’å±žäºŽä¸Šå¸‚å…¬å¸è‚¡ä¸œçš„å‡€\nèµ„äº§&apos;, &apos;2,532,952,52\n3.50&apos;, &apos;2,484,273,56\n7.08&apos;, &apos;2,467,102,37\n1.21&apos;, &apos;2.67%&apos;, &apos;1,026,408,12\n9.95&apos;, &apos;1,110,355,83\n3.68&apos;]]å®‰è£…ä»¥Windowsç³»ç»Ÿä¸ºä¾‹,å…¶ä»–ç³»ç»Ÿçš„å®‰è£…å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£åœ°å€1. å®‰è£…ä¾èµ–æ ¹æ®ç³»ç»Ÿç‰ˆæœ¬çš„ä¸åŒä»¥åŠä½¿ç”¨çš„Pythonç‰ˆæœ¬,ä¸‹è½½ç›¸åº”çš„ä¾èµ–åŒ…å¹¶å®‰è£… Tkinterä¸‹è½½åœ°å€: https://www.activestate.com/products/activetcl/downloads/ ghostscriptä¸‹è½½åœ°å€: https://www.ghostscript.com/download.html 2. æ ¡éªŒä¾èµ–åŒ…12345æ‰“å¼€pythonå‘½ä»¤è¡Œçª—å£,è¾“å…¥ä¸‹æ–¹ä»£ç ,è‹¥æ— æŠ¥é”™,åˆ™tkinterä¾èµ–åŒ…å®‰è£…æˆåŠŸ&gt;&gt;&gt; import tkinteræ‰“å¼€cmdå‘½ä»¤è¡Œçª—å£,è¾“å…¥ä¸‹æ–¹ä»£ç ,è‹¥æ— æŠ¥é”™,æ­£å¸¸æ˜¾ç¤ºå‡ºghostscriptçš„ç‰ˆæœ¬ä¿¡æ¯,åˆ™ghostscriptä¾èµ–åŒ…å®‰è£…æˆåŠŸC:\&gt; gswin64c.exe -versionæ³¨æ„:è‹¥æç¤ºæ‰¾ä¸åˆ°å‘½ä»¤,å¯æŠŠè¯¥è½¯ä»¶çš„æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨è·¯å¾„æ·»åŠ åˆ°çŽ¯å¢ƒå˜é‡ä¸­3.å®‰è£…Camelotcamelotæ”¯æŒä»¥ä¸‹Pythonç‰ˆæœ¬: 2.7, 3.5 and 3.6ä½¿ç”¨Anacondaè¿›è¡Œå®‰è£…1$ conda install -c conda-forge camelot-pyä½¿ç”¨pipè¿›è¡Œå®‰è£…1$ pip install camelot-py[cv]æºç å®‰è£…123$ git clone https://www.github.com/socialcopsdev/camelot$ cd camelot$ pip install ".[cv]"ä½¿ç”¨1. å¯¼å…¥æ¨¡å—1&gt;&gt;&gt; import camelot2. è¯»å–PDFæ–‡ä»¶123&gt;&gt;&gt; tables = camelot.read_pdf('foo.pdf')&gt;&gt;&gt; tables&lt;TableList n=1&gt;è§£æžè¡¨æ ¼æ•°æ®æœ‰ä¸¤ç§æ–¹å¼,Latticeå’Œstream,é»˜è®¤æ˜¯Latticeæ–¹å¼,ç”¨flavor=â€™streamâ€™å¯ä»¥ä¿®æ”¹è§£æžæ–¹å¼.123&gt;&gt;&gt; tables = camelot.read_pdf('foo.pdf',flavor='stream')&gt;&gt;&gt; tables&lt;TableList n=1&gt;é»˜è®¤è¯»å–ç¬¬ä¸€é¡µçš„è¡¨æ ¼.è‹¥æ˜¯æœ‰è¡¨æ ¼,ä¼šæŠŠè¯¥é¡µçš„è¡¨æ ¼æ•°æ®å­˜å‚¨åˆ°TableListå¯¹è±¡ä¸­,ç„¶åŽå¯ä»¥ä½¿ç”¨ç´¢å¼•çš„æ–¹å¼é€ä¸ªèŽ·å–è¡¨æ ¼æ•°æ®.ç´¢å¼•ä»Ž0å¼€å§‹.3. æŸ¥çœ‹è¡¨æ ¼æ ·å¼12&gt;&gt;&gt; tables[0]&lt;Table shape=(7, 7)&gt;4. æŸ¥çœ‹è¡¨æ ¼ä¿¡æ¯1234567&gt;&gt;&gt; print tables[0].parsing_report&#123; 'accuracy': 99.02, 'whitespace': 12.24, 'order': 1, 'page': 1&#125;5. ä»¥DataFrameå½¢å¼èŽ·å–è¡¨æ ¼æ•°æ®1&gt;&gt;&gt; tables[0].df6. å¯¼å‡ºè¡¨æ ¼æ•°æ®123&gt;&gt;&gt; tables[0].to_csv('foo.csv') # to_json(), to_excel() to_html() or to_sqlite()æˆ–&gt;&gt;&gt; tables.export('foo.csv', f='csv')7. åˆ†é¡µæ•°æ®1&gt;&gt;&gt; camelot.read_pdf('your.pdf', pages='1,2,3') # pages=1,4-10,20-30 or pages=1,4-10,20-end8. è¯»å–æœ‰å¯†ç çš„æ–‡ä»¶1&gt;&gt;&gt; tables = camelot.read_pdf('foo.pdf', password='userpass')9. è¯»å–æœ‰èƒŒæ™¯é¢œè‰²çš„æ–‡ä»¶1&gt;&gt;&gt; tables = camelot.read_pdf('background_lines.pdf', process_background=True)10. èŽ·å–è¡¨æ ¼æ ·å¼å…ˆå®‰è£…ä¾èµ–: $ pip install camelot-py[plot]æ ·å¼æ€»å…±æœ‰ä»¥ä¸‹å‡ ç§:â€˜textâ€™â€˜gridâ€™â€˜contourâ€™â€˜lineâ€™â€˜jointâ€™â€˜textedgeâ€™å…¶ä¸­: â€˜lineâ€™å’Œ â€˜jointâ€™ ä»…é€‚ç”¨äºŽLattice, â€˜textedgeâ€™ä»…é€‚ç”¨äºŽStream.12&gt;&gt;&gt; camelot.plot(tables[0], kind='text')&gt;&gt;&gt; plt.show()11. Specify table areas1&gt;&gt;&gt; tables = camelot.read_pdf('table_areas.pdf', flavor='stream', table_areas=['316,499,566,337'])12. Specify table regions1&gt;&gt;&gt; tables = camelot.read_pdf('table_regions.pdf', table_regions=['170,370,560,270'])13. Split text along separators1&gt;&gt;&gt; tables = camelot.read_pdf('column_separators.pdf', flavor='stream', columns=['72,95,209,327,442,529,566,606,683'], split_text=True)14. Strip characters from text1&gt;&gt;&gt; tables = camelot.read_pdf('12s0324.pdf', flavor='stream', strip_text=' .\n')15. å…¶ä»–åŠŸèƒ½è¯¦ç»†è¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£API Reference1. Main Interface1234567891011121314151617181920212223242526272829303132333435363738394041424344camelot.read_pdf(filepath, pages=&apos;1&apos;, password=None, flavor=&apos;lattice&apos;, suppress_stdout=False, layout_kwargs=&#123;&#125;, **kwargs)Read PDF and return extracted tables.Note: kwargs annotated with ^ can only be used with flavor=â€™streamâ€™ and kwargs annotated with * can only be used with flavor=â€™latticeâ€™.Parameters: filepath (str) â€“ Filepath or URL of the PDF file. pages (str, optional (default: &apos;1&apos;)) â€“ Comma-separated page numbers. Example: â€˜1,3,4â€™ or â€˜1,4-endâ€™ or â€˜allâ€™. password (str, optional (default: None)) â€“ Password for decryption. flavor (str (default: &apos;lattice&apos;)) â€“ The parsing method to use (â€˜latticeâ€™ or â€˜streamâ€™). Lattice is used by default. suppress_stdout (bool, optional (default: True)) â€“ Print all logs and warnings. layout_kwargs (dict, optional (default: &#123;&#125;)) â€“ A dict of pdfminer.layout.LAParams kwargs. table_areas (list, optional (default: None)) â€“ List of table area strings of the form x1,y1,x2,y2 where (x1, y1) -&gt; left-top and (x2, y2) -&gt; right-bottom in PDF coordinate space. columns^ (list, optional (default: None)) â€“ List of column x-coordinates strings where the coordinates are comma-separated. split_text (bool, optional (default: False)) â€“ Split text that spans across multiple cells. flag_size (bool, optional (default: False)) â€“ Flag text based on font size. Useful to detect super/subscripts. Adds &lt;s&gt;&lt;/s&gt; around flagged text. strip_text (str, optional (default: &apos;&apos;)) â€“ Characters that should be stripped from a string before assigning it to a cell. row_tol^ (int, optional (default: 2)) â€“ Tolerance parameter used to combine text vertically, to generate rows. column_tol^ (int, optional (default: 0)) â€“ Tolerance parameter used to combine text horizontally, to generate columns. process_background* (bool, optional (default: False)) â€“ Process background lines. line_scale* (int, optional (default: 15)) â€“ Line size scaling factor. The larger the value the smaller the detected lines. Making it very large will lead to text being detected as lines. copy_text* (list, optional (default: None)) â€“ &#123;â€˜hâ€™, â€˜vâ€™&#125; Direction in which text in a spanning cell will be copied over. shift_text* (list, optional (default: [&apos;l&apos;, &apos;t&apos;])) â€“ &#123;â€˜lâ€™, â€˜râ€™, â€˜tâ€™, â€˜bâ€™&#125; Direction in which text in a spanning cell will flow. line_tol* (int, optional (default: 2)) â€“ Tolerance parameter used to merge close vertical and horizontal lines. joint_tol* (int, optional (default: 2)) â€“ Tolerance parameter used to decide whether the detected lines and points lie close to each other. threshold_blocksize* (int, optional (default: 15)) â€“ Size of a pixel neighborhood that is used to calculate a threshold value for the pixel: 3, 5, 7, and so on. For more information, refer OpenCVâ€™s adaptiveThreshold. threshold_constant* (int, optional (default: -2)) â€“ Constant subtracted from the mean or weighted mean. Normally, it is positive but may be zero or negative as well. For more information, refer OpenCVâ€™s adaptiveThreshold. iterations* (int, optional (default: 0)) â€“ Number of times for erosion/dilation is applied. For more information, refer OpenCVâ€™s dilate. resolution* (int, optional (default: 300)) â€“ Resolution used for PDF to PNG conversion.Returns: tablesReturn type: camelot.core.TableList2. Lower-Level Classes123456789101112131415class camelot.handlers.PDFHandler(filepath, pages=&apos;1&apos;, password=None) Handles all operations like temp directory creation, splitting file into single page PDFs, parsing each PDF and then removing the temp directory. Parameters: filepath (str) â€“ Filepath or URL of the PDF file. pages (str, optional (default: &apos;1&apos;)) â€“ Comma-separated page numbers. Example: â€˜1,3,4â€™ or â€˜1,4-endâ€™ or â€˜allâ€™. password (str, optional (default: None)) â€“ Password for decryption. parse(flavor=&apos;lattice&apos;, suppress_stdout=False, layout_kwargs=&#123;&#125;, **kwargs) Extracts tables by calling parser.get_tables on all single page PDFs. Parameters: flavor (str (default: &apos;lattice&apos;)) â€“ The parsing method to use (â€˜latticeâ€™ or â€˜streamâ€™). Lattice is used by default. suppress_stdout (str (default: False)) â€“ Suppress logs and warnings. layout_kwargs (dict, optional (default: &#123;&#125;)) â€“ A dict of pdfminer.layout.LAParams kwargs. kwargs (dict) â€“ See camelot.read_pdf kwargs. Returns:tables â€“ List of tables found in PDF. Return type: camelot.core.TableList12345678910111213class camelot.parsers.Stream(table_regions=None, table_areas=None, columns=None, split_text=False, flag_size=False, strip_text=&apos;&apos;, edge_tol=50, row_tol=2, column_tol=0, **kwargs) Stream method of parsing looks for spaces between text to parse the table. If you want to specify columns when specifying multiple table areas, make sure that the length of both lists are equal. Parameters: table_regions (list, optional (default: None)) â€“ List of page regions that may contain tables of the form x1,y1,x2,y2 where (x1, y1) -&gt; left-top and (x2, y2) -&gt; right-bottom in PDF coordinate space. table_areas (list, optional (default: None)) â€“ List of table area strings of the form x1,y1,x2,y2 where (x1, y1) -&gt; left-top and (x2, y2) -&gt; right-bottom in PDF coordinate space. columns (list, optional (default: None)) â€“ List of column x-coordinates strings where the coordinates are comma-separated. split_text (bool, optional (default: False)) â€“ Split text that spans across multiple cells. flag_size (bool, optional (default: False)) â€“ Flag text based on font size. Useful to detect super/subscripts. Adds &lt;s&gt;&lt;/s&gt; around flagged text. strip_text (str, optional (default: &apos;&apos;)) â€“ Characters that should be stripped from a string before assigning it to a cell. edge_tol (int, optional (default: 50)) â€“ Tolerance parameter for extending textedges vertically. row_tol (int, optional (default: 2)) â€“ Tolerance parameter used to combine text vertically, to generate rows. column_tol (int, optional (default: 0)) â€“ Tolerance parameter used to combine text horizontally, to generate columns.12345678910111213141516171819202122232425262728class camelot.parsers.Lattice(table_regions=None, table_areas=None, process_background=False, line_scale=15, copy_text=None, shift_text=[&apos;l&apos;, &apos;t&apos;], split_text=False, flag_size=False, strip_text=&apos;&apos;, line_tol=2, joint_tol=2, threshold_blocksize=15, threshold_constant=-2, iterations=0, resolution=300, **kwargs) Lattice method of parsing looks for lines between text to parse the table. Parameters: table_regions (list, optional (default: None)) â€“ List of page regions that may contain tables of the form x1,y1,x2,y2 where (x1, y1) -&gt; left-top and (x2, y2) -&gt; right-bottom in PDF coordinate space. table_areas (list, optional (default: None)) â€“ List of table area strings of the form x1,y1,x2,y2 where (x1, y1) -&gt; left-top and (x2, y2) -&gt; right-bottom in PDF coordinate space. process_background (bool, optional (default: False)) â€“ Process background lines. line_scale (int, optional (default: 15)) â€“ Line size scaling factor. The larger the value the smaller the detected lines. Making it very large will lead to text being detected as lines. copy_text (list, optional (default: None)) â€“ &#123;â€˜hâ€™, â€˜vâ€™&#125; Direction in which text in a spanning cell will be copied over. shift_text (list, optional (default: [&apos;l&apos;, &apos;t&apos;])) â€“ &#123;â€˜lâ€™, â€˜râ€™, â€˜tâ€™, â€˜bâ€™&#125; Direction in which text in a spanning cell will flow. split_text (bool, optional (default: False)) â€“ Split text that spans across multiple cells. flag_size (bool, optional (default: False)) â€“ Flag text based on font size. Useful to detect super/subscripts. Adds &lt;s&gt;&lt;/s&gt; around flagged text. strip_text (str, optional (default: &apos;&apos;)) â€“ Characters that should be stripped from a string before assigning it to a cell. line_tol (int, optional (default: 2)) â€“ Tolerance parameter used to merge close vertical and horizontal lines. joint_tol (int, optional (default: 2)) â€“ Tolerance parameter used to decide whether the detected lines and points lie close to each other. threshold_blocksize (int, optional (default: 15)) â€“ Size of a pixel neighborhood that is used to calculate a threshold value for the pixel: 3, 5, 7, and so on. For more information, refer OpenCVâ€™s adaptiveThreshold. threshold_constant (int, optional (default: -2)) â€“ Constant subtracted from the mean or weighted mean. Normally, it is positive but may be zero or negative as well. For more information, refer OpenCVâ€™s adaptiveThreshold. iterations (int, optional (default: 0)) â€“ Number of times for erosion/dilation is applied. For more information, refer OpenCVâ€™s dilate. resolution (int, optional (default: 300)) â€“ Resolution used for PDF to PNG conversion.3. Lower-Lower-Level Classes123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293class camelot.core.TableList(tables)[source] Defines a list of camelot.core.Table objects. Each table can be accessed using its index. n int â€“ Number of tables in the list. export(path, f=&apos;csv&apos;, compress=False)[source] Exports the list of tables to specified file format. Parameters: path (str) â€“ Output filepath. f (str) â€“ File format. Can be csv, json, excel, html and sqlite. compress (bool) â€“ Whether or not to add files to a ZIP archive.class camelot.core.Table(cols, rows)[source] Defines a table with coordinates relative to a left-bottom origin. (PDF coordinate space) Parameters: cols (list) â€“ List of tuples representing column x-coordinates in increasing order. rows (list) â€“ List of tuples representing row y-coordinates in decreasing order. df pandas.DataFrame shape tuple â€“ Shape of the table. accuracy float â€“ Accuracy with which text was assigned to the cell. whitespace float â€“ Percentage of whitespace in the table. order int â€“ Table number on PDF page. page int â€“ PDF page number. data Returns two-dimensional list of strings in table. parsing_report Returns a parsing report with %accuracy, %whitespace, table number on page and page number. set_all_edges()[source] Sets all table edges to True. set_border()[source] Sets table border edges to True. set_edges(vertical, horizontal, joint_tol=2)[source] Sets a cellâ€™s edges to True depending on whether the cellâ€™s coordinates overlap with the lineâ€™s coordinates within a tolerance. Parameters: vertical (list) â€“ List of detected vertical lines. horizontal (list) â€“ List of detected horizontal lines. set_span()[source] Sets a cellâ€™s hspan or vspan attribute to True depending on whether the cell spans horizontally or vertically. to_csv(path, **kwargs)[source] Writes Table to a comma-separated values (csv) file. For kwargs, check pandas.DataFrame.to_csv(). Parameters: path (str) â€“ Output filepath. to_excel(path, **kwargs)[source] Writes Table to an Excel file. For kwargs, check pandas.DataFrame.to_excel(). Parameters: path (str) â€“ Output filepath. to_html(path, **kwargs)[source] Writes Table to an HTML file. For kwargs, check pandas.DataFrame.to_html(). Parameters: path (str) â€“ Output filepath. to_json(path, **kwargs)[source] Writes Table to a JSON file. For kwargs, check pandas.DataFrame.to_json(). Parameters: path (str) â€“ Output filepath. to_sqlite(path, **kwargs)[source] Writes Table to sqlite database. For kwargs, check pandas.DataFrame.to_sql(). Parameters: path (str) â€“ Output filepath. class camelot.core.Cell(x1, y1, x2, y2)[source] Defines a cell in a table with coordinates relative to a left-bottom origin. (PDF coordinate space) Parameters: x1 (float) â€“ x-coordinate of left-bottom point. y1 (float) â€“ y-coordinate of left-bottom point. x2 (float) â€“ x-coordinate of right-top point. y2 (float) â€“ y-coordinate of right-top point. lb tuple â€“ Tuple representing left-bottom coordinates. lt tuple â€“ Tuple representing left-top coordinates. rb tuple â€“ Tuple representing right-bottom coordinates. rt tuple â€“ Tuple representing right-top coordinates. left bool â€“ Whether or not cell is bounded on the left. right bool â€“ Whether or not cell is bounded on the right. top bool â€“ Whether or not cell is bounded on the top. bottom bool â€“ Whether or not cell is bounded on the bottom. hspan bool â€“ Whether or not cell spans horizontally. vspan bool â€“ Whether or not cell spans vertically. text string â€“ Text assigned to cell.]]></content>
      <categories>
        <category>pdf</category>
      </categories>
      <tags>
        <tag>Pyhton</tag>
        <tag>pdf</tag>
      </tags>
  </entry>
</search>
